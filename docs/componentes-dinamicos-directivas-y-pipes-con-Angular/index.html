<!DOCTYPE html><html lang="es"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>Componentes dinámicos, directivas y pipes con Angular | Academia Binaria</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="El sistema de componentes de Angular te permite reutilizar pequeñas unidades para montar grandes y complejas interfaces. Eso es bueno porque la capa de presentación se come la mayor parte del tiempo d"><meta name="keywords" content="Angular,Angular8,Tutorial,Avanzado,Template"><meta property="og:type" content="article"><meta property="og:title" content="Componentes dinámicos, directivas y pipes con Angular"><meta property="og:url" content="https://academia-binaria.com/componentes-dinamicos-directivas-y-pipes-con-Angular/index.html"><meta property="og:site_name" content="Academia Binaria"><meta property="og:description" content="El sistema de componentes de Angular te permite reutilizar pequeñas unidades para montar grandes y complejas interfaces. Eso es bueno porque la capa de presentación se come la mayor parte del tiempo d"><meta property="og:locale" content="es"><meta property="og:image" content="https://academia-binaria.com/css/images/angular-13_template.png"><meta property="og:updated_time" content="2019-10-09T10:45:38.700Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Componentes dinámicos, directivas y pipes con Angular"><meta name="twitter:description" content="El sistema de componentes de Angular te permite reutilizar pequeñas unidades para montar grandes y complejas interfaces. Eso es bueno porque la capa de presentación se come la mayor parte del tiempo d"><meta name="twitter:image" content="https://academia-binaria.com/css/images/angular-13_template.png"><link rel="alternate" href="http://eepurl.com/b3p7fb" title="Academia Binaria" type="application/atom+xml"><link rel="icon" href="/css/images/favicon.ico"><link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/libs/open-sans/styles.css"><link rel="stylesheet" href="/libs/source-code-pro/styles.css"><link rel="stylesheet" href="/css/style.css"><script src="/libs/jquery/2.1.3/jquery.min.js"></script><script type="text/javascript">!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-66674029-1","auto"),ga("send","pageview")</script><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-2476046955705301",enable_page_level_ads:!0})</script></head></html><body><div id="container"><header id="header"><div id="header-main" class="header-inner"><div class="outer"><a href="/" id="logo"><i class="logo"></i> <span class="site-title">Academia Binaria</span></a><nav id="main-nav"><a class="main-nav-link" href="/cursos">Cursos Online</a></nav><nav id="sub-nav"><div class="profile" id="profile-nav"><a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://www.gravatar.com/avatar/c6ea942080cef8be6ff80ca095e718b8"> <i class="fa fa-caret-down"></i></a></div></nav><div id="search-form-wrap"><form class="search-form"><input type="text" class="ins-search-input search-form-input" placeholder="Buscar"> <button type="submit" class="search-form-submit"></button></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="escribe..."> <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Entradas",PAGES:"Páginas",CATEGORIES:"Categorias",TAGS:"Etiquetas",UNTITLED:"(Untitled)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script></div></div></div><div id="main-nav-mobile" class="header-sub header-inner"><table class="menu outer"><tr><td><a class="main-nav-link" href="/cursos">Cursos Online</a></td><td><div class="search-form"><input type="text" class="ins-search-input search-form-input" placeholder="Buscar"></div></td></tr></table></div></header><div class="outer"><aside id="profile"><div class="inner profile-inner"><div class="base-info profile-block"><img id="avatar" src="https://www.gravatar.com/avatar/c6ea942080cef8be6ff80ca095e718b8?s=128"><h2 id="name">Alberto Basalo</h2><h3 id="title">Formador y Consultor</h3><span id="location"><i class="fa fa-map-marker"></i>A Coruña, Spain</span> <a id="follow" target="_blank" href="https://twitter.com/albertobasalo">SEGUIR</a></div><div class="article-info profile-block"><a href="https://angular.builders" style="align-content:center"><img src="/css/images/angular.builders_cuadrado.png" width="100%" height="auto" alt="Angular.Builders"></a></div><div class="profile-block social-links"><table><tr><td><a href="https://github.com/AcademiaBinaria" target="_blank" title="github" class="tooltip"><i class="fa fa-github"></i></a></td><td><a href="https://twitter.com/albertobasalo" target="_blank" title="twitter" class="tooltip"><i class="fa fa-twitter"></i></a></td><td><a href="https://www.facebook.com/Agora.Binaria.SL/" target="_blank" title="facebook" class="tooltip"><i class="fa fa-facebook"></i></a></td><td><a href="http://eepurl.com/b3p7fb" target="_blank" title="rss" class="tooltip"><i class="fa fa-rss"></i></a></td></tr></table></div></div></aside><section id="main"><article id="post-componentes-dinamicos-directivas-y-pipes-con-Angular" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">Componentes dinámicos, directivas y pipes con Angular</h1><div class="article-meta"><div class="article-date"><i class="fa fa-calendar"></i> <a href="/componentes-dinamicos-directivas-y-pipes-con-Angular/"><time datetime="2019-09-13T12:27:09.000Z" itemprop="datePublished">13-09-2019</time></a></div><div class="article-category"><i class="fa fa-folder"></i> <a class="article-category-link" href="/categories/Tutorial/">Tutorial</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tutorial/Angular/">Angular</a></div><div class="article-tag"><i class="fa fa-tag"></i> <a class="tag-link" href="/tag/Angular/">Angular</a>, <a class="tag-link" href="/tag/Angular8/">Angular8</a>, <a class="tag-link" href="/tag/Avanzado/">Avanzado</a>, <a class="tag-link" href="/tag/Template/">Template</a>, <a class="tag-link" href="/tag/Tutorial/">Tutorial</a></div></div></header><div class="article-entry" itemprop="articleBody"><p><img src="/images/tutorial-angular-13_template.png" alt="componentes-dinamicos-directivas-y-pipes-con-Angular"></p><p>El sistema de componentes de Angular te permite reutilizar pequeñas unidades para montar grandes y complejas interfaces. Eso es bueno porque la capa de presentación se <em>come</em> la mayor parte del tiempo de desarrollo. Pero podemos ir más allá.</p><blockquote><p>Podemos crear componentes con estructura fija y contenido dinámico. Podemos dar funcionalidad extra mediante directivas y podemos crear pipes para transformar la presentación.</p></blockquote><p>Y todo esto de una forma sencilla y familiar usando el CLI. No hay excusa para no reutilizar código en la capa de presentación. <em>Don’t repeat Yourself!</em>.</p><a id="more"></a><p>Partiendo de la aplicación tal como quedó en <a href="../deteccion-del-cambio-en-Angular/">Detección del cambio en Angular</a>. Al finalizar tendrás una aplicación que muestra información sobre productos de manera flexible y al gusto del programador.</p><blockquote><p>Código asociado a este tutorial en <em>GitHub</em>: <a href="https://github.com/AcademiaBinaria/angular-boss" target="_blank" rel="noopener">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id="Tabla-de-Contenido"><a href="#Tabla-de-Contenido" class="headerlink" title="Tabla de Contenido:"></a>Tabla de Contenido:</h2><p><a href="./#1-Plantillas-de-contenido-dinamico">1. Plantillas de contenido dinámico.</a></p><p><a href="./#2-Atributos-custom-con-Directivas">2. Atributos custom con Directivas.</a></p><p><a href="./#3-Funciones-de-transformacion-con-Pipes">3. Funciones de transformación con Pipes.</a></p><hr><h1 id="1-Plantillas-de-contenido-dinamico"><a href="#1-Plantillas-de-contenido-dinamico" class="headerlink" title="1 Plantillas de contenido dinámico"></a>1 Plantillas de contenido dinámico</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">As</span> <span class="attr">a:</span> <span class="string">customer,</span></span><br><span class="line">  <span class="string">I</span> <span class="attr">want:</span> <span class="string">to</span> <span class="string">see</span> <span class="string">a</span> <span class="string">product</span> <span class="string">card</span> <span class="string">with</span> <span class="string">price</span> <span class="string">in</span> <span class="string">euros</span></span><br><span class="line">  <span class="string">so</span> <span class="attr">that:</span> <span class="string">i</span> <span class="string">can</span> <span class="string">decide</span> <span class="string">to</span> <span class="string">purchase</span> <span class="string">it</span> <span class="string">or</span> <span class="string">not</span></span><br><span class="line"></span><br><span class="line"><span class="string">As</span> <span class="attr">a:</span> <span class="string">seller,</span></span><br><span class="line">  <span class="string">I</span> <span class="attr">want:</span> <span class="string">to</span> <span class="string">see</span> <span class="string">a</span> <span class="string">product</span> <span class="string">card</span> <span class="string">with</span> <span class="string">stock</span></span><br><span class="line">  <span class="string">so</span> <span class="attr">that:</span> <span class="string">I</span> <span class="string">can</span> <span class="string">ask</span> <span class="string">for</span> <span class="string">more</span> <span class="string">or</span> <span class="string">not</span></span><br></pre></td></tr></table></figure><p>En muchas ocasiones tenemos que presentar la misma información pero con ligeros cambios. Por ejemplo una vista a veces con unos botones a veces con un texto.</p><p>En otras ocasiones mostramos información muy diferente pero con la misma estructura. Por ejemplo páginas de búsqueda; pueden ser de productos, clientes, tareas… pero siempre con la parte de filtro y la del listado.</p><p>Algunas veces se puede resolver con un <code>*ngIf</code>. Pero hay ocasiones que donde la técnica del <code>ng-content</code> te puede ser mucho más útil. Como ejemplo voy a crear un componente base para mostrar una ficha de producto. Después usaré esa plantilla para <em>rellenarla</em> según las especificaciones de cada pantalla.</p><hr><h2 id="1-1-Un-componente-comun"><a href="#1-1-Un-componente-comun" class="headerlink" title="1.1 Un componente común"></a>1.1 Un componente común</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng g c product-template --project=products --module=products.module.ts --<span class="built_in">export</span></span><br></pre></td></tr></table></figure><blockquote><p>La visión del comprador y del vendedor es parecida. Mantenemos estructura, inyectamos contenido.</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">article</span> <span class="attr">style</span>=<span class="string">"margin: 5px; padding: 5px; border: 2px; border-style: solid;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line">      &#123;&#123; product.description &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ng-content</span> <span class="attr">select</span>=<span class="string">"main"</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-content</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span> <span class="attr">style</span>=<span class="string">"margin-top: 5px"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ng-content</span> <span class="attr">select</span>=<span class="string">".actions"</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-content</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">article</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La directiva <code>ngContent</code> permite crear <em>slots</em> para incrustar contenido a voluntad del consumidor. Cada <em>slot</em> se identifica mediante un <code>select=&quot;css-selector&quot;</code>.</p><p>Los selectores pueden referirse a elementos <em>html</em>, clases <em>css</em> o identificadores. En la práctica es como dejar unos sitios en los que inyectar contenido. Y para referirse a esos sitios les damos un nombre selector.</p><hr><h2 id="1-2-Implementaciones-distintas"><a href="#1-2-Implementaciones-distintas" class="headerlink" title="1.2 Implementaciones distintas"></a>1.2 Implementaciones distintas</h2><p>A partir de aquí podría haber múltiples componentes que usasen la misma plantilla. Voy a mostrar uno de ejemplo.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng g c catalog/product --project=shop</span><br></pre></td></tr></table></figure><p>La etiqueta <code>&lt;main&gt;</code> y el atributo <code>class=&quot;actions&quot;</code> son usados para seleccionar los slots en los que serán inyectados. Por lo demás el componente <code>ab-products-product-template</code> se comporta como cualquier otro pudiendo recibir argumentos…</p><p><code>apps\shop\src\app\catalog\catalog.component.html</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ab-products-product-template</span> [<span class="attr">product</span>]=<span class="string">"product"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      &#123;&#123; product.brand &#125;&#125; - &#123;&#123; product.category &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      Price: &#123;&#123; product.price &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"actions"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> (<span class="attr">clic</span>)=<span class="string">"buy.next()"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">style</span>=<span class="string">"background-color:coral; padding: 5px"</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>Buy me!<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ab-products-product-template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La idea es que bajo <strong>una misma estructura puedas crear distintas implementaciones</strong> y así mantener una coherencia visual o simplemente no repetir código.</p><h1 id="2-Atributos-custom-con-Directivas"><a href="#2-Atributos-custom-con-Directivas" class="headerlink" title="2 Atributos custom con Directivas"></a>2 Atributos custom con Directivas</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">As</span> <span class="attr">a:</span> <span class="string">seller,</span></span><br><span class="line">  <span class="string">I</span> <span class="attr">want:</span> <span class="string">to</span> <span class="string">see</span> <span class="string">a</span> <span class="string">green</span> <span class="string">mark</span> <span class="string">on</span> <span class="string">products</span> <span class="string">with</span> <span class="string">stock</span></span><br><span class="line">  <span class="string">so</span> <span class="attr">that:</span> <span class="string">I</span> <span class="string">know</span> <span class="string">I</span> <span class="string">don't</span> <span class="string">do</span> <span class="string">need</span> <span class="string">to</span> <span class="string">refill</span></span><br><span class="line"></span><br><span class="line"><span class="string">As</span> <span class="attr">a:</span> <span class="string">seller,</span></span><br><span class="line">  <span class="string">I</span> <span class="attr">want:</span> <span class="string">to</span> <span class="string">see</span> <span class="string">a</span> <span class="string">red</span> <span class="string">mark</span> <span class="string">on</span> <span class="string">products</span> <span class="string">with</span> <span class="string">out</span> <span class="string">stock</span></span><br><span class="line">  <span class="string">so</span> <span class="attr">that:</span> <span class="string">I</span> <span class="string">know</span> <span class="string">I</span> <span class="string">need</span> <span class="string">to</span> <span class="string">refill</span></span><br></pre></td></tr></table></figure><h2 id="2-1-Generacion-de-directivas"><a href="#2-1-Generacion-de-directivas" class="headerlink" title="2.1 Generación de directivas"></a>2.1 Generación de directivas</h2><p>Primero la definición. Si los componentes nos permite crear nuevas etiquetas en <em>html</em>, las directivas nos permiten crear atributos. Se usan para dar <strong>funcionalidad extra a los elementos</strong> estándar o no de las aplicaciones.</p><p>La forma de crearlas es mediante el CLI. En este caso con el comando <code>directive</code>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng g directive out-of-stock --project=products --export</span><br></pre></td></tr></table></figure><p>EL resultado es una clase con su propio decorador <code>@Directive</code> en el que asignamos su selector. Es decir el nombre del atributo que podremos usar. El convenio es utilizar el prefijo y el propio nombre de directiva en <em>camel case</em>.</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Directive</span>(&#123;</span><br><span class="line">  selector: <span class="string">'[abProductsOutOfStock]'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> OutOfStockDirective &#123;</span><br><span class="line">  <span class="keyword">private</span> minimalStock = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Input</span>()</span><br><span class="line">  <span class="keyword">set</span> abProductsOutOfStock(stock: <span class="built_in">number</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> color = stock &lt;= <span class="keyword">this</span>.minimalStock ? <span class="string">'MistyRose'</span> : <span class="string">'Aquamarine'</span>;</span><br><span class="line">    <span class="keyword">this</span>.el.nativeElement.style.backgroundColor = color;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> el: ElementRef</span>) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>En la implementación ya puedes hacer lo que te parezca. Es muy habitual que las directivas se usen para manipular el elemento nativo al que se aplican. Por eso casi siempre solicitarás la inyección de un puntero a dicho elemento: el de la dependencia de tipo <code>ElementRef</code> que viene en el <em>core</em> de Angular.</p><p>A partir de ahí ya puedes hacer lo necesario manipulando el <em>html</em> tanto en el constructor como en respuesta a cambios o durante la entrada de atributos.</p><hr><h2 id="2-2-Consumo-de-directivas"><a href="#2-2-Consumo-de-directivas" class="headerlink" title="2.2 Consumo de directivas"></a>2.2 Consumo de directivas</h2><p>Usarlas es todavía más sencillo. Una vez exportadas e importadas como cualquier otro artificio Angular, ya puedes asignarlas como atributo a las etiquetas de tus plantillas.</p><p><code>apps\shop\src\app\catalog\product\product.component.html</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">abProductsOutOfStock</span>]=<span class="string">"product.stock"</span>&gt;</span></span><br><span class="line">  Stock: &#123;&#123; product.stock &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Algunas, como este caso, reciben valores. Otras simplemente actúan una vez asignadas. De nuevo la idea es que <strong>todas las manipulaciones de bajo nivel se <em>escondan</em> en las directivas</strong> y que los controladores de nuestros componentes queden limpios y desacoplados de la capa de presentación.</p><h1 id="3-Funciones-de-transformacion-con-Pipes"><a href="#3-Funciones-de-transformacion-con-Pipes" class="headerlink" title="3 Funciones de transformación con Pipes"></a>3 Funciones de transformación con Pipes</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">As</span> <span class="attr">a:</span> <span class="string">customer,</span></span><br><span class="line">  <span class="string">I</span> <span class="attr">want:</span> <span class="string">to</span> <span class="string">see</span> <span class="string">a</span> <span class="string">product</span> <span class="string">price</span> <span class="string">also</span> <span class="string">in</span> <span class="string">dollars</span></span><br><span class="line">  <span class="string">so</span> <span class="attr">that:</span> <span class="string">I</span> <span class="string">can</span> <span class="string">compare</span> <span class="string">prices</span></span><br><span class="line"><span class="string">As</span> <span class="attr">a:</span> <span class="string">customer,</span></span><br><span class="line">  <span class="string">I</span> <span class="attr">want:</span> <span class="string">to</span> <span class="string">see</span> <span class="string">a</span> <span class="string">product</span> <span class="string">price</span> <span class="string">also</span> <span class="string">in</span> <span class="string">pounds</span></span><br><span class="line">  <span class="string">so</span> <span class="attr">that:</span> <span class="string">I</span> <span class="string">can</span> <span class="string">compare</span> <span class="string">prices</span></span><br></pre></td></tr></table></figure><p>En este caso lo que queremos es transformar un dato de nuestro modelo antes de presentarlo en pantalla. Para ello seguro que has usado algún <code>pipe</code> de Angular desde el primer día que empezaste a programar.</p><h2 id="3-1-Generacion-de-pipes"><a href="#3-1-Generacion-de-pipes" class="headerlink" title="3.1 Generación de pipes"></a>3.1 Generación de pipes</h2><p>Pero ahora vamos a generar nuestros propios <em>pipes</em>. Una vez más usaremos el CLI con su comando específico para este caso:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng g pipe exRate --project=products --export</span><br></pre></td></tr></table></figure><p>Al igual que los componentes y que las directivas, los <em>pipes</em> tienen un nombre como clase y un nombre en su decorador para ser usados desde fuera.</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pipe</span>(&#123;</span><br><span class="line">  name: <span class="string">'exRate'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> ExRatePipe <span class="keyword">implements</span> PipeTransform &#123;</span><br><span class="line">  <span class="keyword">private</span> readonly euroDollars = <span class="number">1.13</span>;</span><br><span class="line">  <span class="keyword">private</span> readonly ratesApi = <span class="string">'https://api.exchangeratesapi.io/latest?symbols='</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> transform(euros: <span class="built_in">number</span>, symbol: <span class="built_in">string</span>): <span class="built_in">number</span> | Observable&lt;<span class="built_in">number</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (!symbol) &#123;</span><br><span class="line">      <span class="keyword">return</span> euros * <span class="keyword">this</span>.euroDollars;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.getOnlineRates$(symbol).pipe(map(<span class="function"><span class="params">rate</span> =&gt;</span> euros * rate));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>La clase tienen que implementar la interfaz <code>PipeTransform</code> que obliga a tener un método público <code>transform(value: any):any</code>. En este método definimos nuestra función de transformación.</p><p>La única salvedad es incidir en que sea lo más ligera posible pues se ejecuta en cada uso y repintado. Por ejemplo yo aquí necesito un servicio asíncrono, y para no penalizar demasiado el rendimiento, le aplico el operador <code>shareReplay</code> para que actúe como una caché.</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> getOnlineRates$(symbol: <span class="built_in">string</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> ratesUrl = <span class="keyword">this</span>.ratesApi + symbol;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.httpClient.get&lt;<span class="built_in">any</span>&gt;(ratesUrl).pipe(</span><br><span class="line">    shareReplay(<span class="number">1</span>),</span><br><span class="line">    refCount(),</span><br><span class="line">    map(<span class="function"><span class="params">resp</span> =&gt;</span> resp.rates[symbol])</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-2-Consumo-de-pipes"><a href="#3-2-Consumo-de-pipes" class="headerlink" title="3.2 Consumo de pipes"></a>3.2 Consumo de pipes</h2><p>La parte del consumo es la más simple. Se trata de invocar a la transformación pasándole los atributos necesarios y volver a transformar o utilizar directamente el resultado.</p><p><code>apps\shop\src\app\catalog\product\product.component.html</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  $&#123;&#123; product.price | exRate | number:'1.0-0'&#125;&#125;</span><br><span class="line">  &#123;&#123; product.price | exRate:'GBP' | async | number:'1.0-0'&#125;&#125; £</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y con esto ya tenemos tres nuevas maneras de reutilizar código y dar nuevas capacidades a la parte de presentación. Pero en este tutorial de formación <a href="../tag/Avanzado/">avanzada en Angular</a> volvemos de nuevo a las profundidades del modelo y la gestión de datos empezando con el <a href="../flujo-reactivo-unidireccional-con-Angular-y-RxJs">Flujo reactivo unidireccional con Angular y RxJs</a>. Todos esos detalles se tratan en el <a href="https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders" target="_blank" rel="noopener">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br>– <cite>Saludos, Alberto Basalo</cite></p></blockquote></div><footer class="article-footer"><div class="share-container"></div><a data-url="https://academia-binaria.com/componentes-dinamicos-directivas-y-pipes-con-Angular/" data-id="ck0qtfayy000hrws3to7utm62" class="article-share-link"><i class="fa fa-share"></i>Compartir</a><script>!function(n){"undefined"!=typeof __SHARE_BUTTON_BINDED__&&__SHARE_BUTTON_BINDED__||(__SHARE_BUTTON_BINDED__=!0,n("body").on("click",function(){n(".article-share-box.on").removeClass("on")}).on("click",".article-share-link",function(t){t.stopPropagation();var e,a=n(this),o=a.attr("data-url"),i=encodeURIComponent(o),r="article-share-box-"+a.attr("data-id"),s=a.offset();if(n("#"+r).length){if((e=n("#"+r)).hasClass("on"))return void e.removeClass("on")}else{var l=['<div id="'+r+'" class="article-share-box">','<input class="article-share-input" value="'+o+'">','<div class="article-share-links">','<a href="https://twitter.com/intent/tweet?url='+i+'" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>','<a href="https://www.facebook.com/sharer.php?u='+i+'" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>','<a href="http://pinterest.com/pin/create/button/?url='+i+'" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>','<a href="https://plus.google.com/share?url='+i+'" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',"</div>","</div>"].join("");e=n(l),n("body").append(e)}n(".article-share-box.on").hide(),e.css({top:s.top+25,left:s.left}).addClass("on")}).on("click",".article-share-box",function(t){t.stopPropagation()}).on("click",".article-share-box-input",function(){n(this).select()}).on("click",".article-share-box-link",function(t){t.preventDefault(),t.stopPropagation(),window.open(this.href,"article-share-box-window-"+Date.now(),"width=500,height=450")}))}(jQuery)</script></footer></div><nav id="article-nav"><a href="/deteccion-del-cambio-en-Angular/" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">Anterior</strong><div class="article-nav-title">Detección del cambio en Angular</div></a><a href="/flujo-reactivo-unidireccional-con-Angular-y-RxJs/" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">Siguiente</strong><div class="article-nav-title">Redux, flujo reactivo unidireccional con Angular y RxJs</div></a></nav><p><a href="https://www.trainingit.es/curso-angular-basico/?promo=angular.builders">Código promo para: Curso online de introducción a Angular</a></p><hr><p><a href="https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders">Código promo para: Curso online avanzado con Angular</a></p><a href="https://angular.builders"><img src="/css/images/angular.builders.png" alt="Angular.Builders"></a><hr></article></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">Recientes</h3><div class="widget"><ul id="recent-post"><li><div class="item-thumbnail"><a href="/velocidad-y-seo-con-el-ssr-de-angular-universal/" class="thumbnail"><span style="background-image:url(/css/images/angular-17_ssr.png)" alt="Velocidad y SEO con el SSR de Angular Universal" class="thumbnail-image"></span></a></div><div class="item-inner"><p class="item-category"><a class="article-category-link" href="/categories/Tutorial/">Tutorial</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tutorial/Angular/">Angular</a></p><p class="item-title"><a href="/velocidad-y-seo-con-el-ssr-de-angular-universal/" class="title">Velocidad y SEO con el SSR de Angular Universal</a></p><p class="item-date"><time datetime="2019-10-09T11:50:27.000Z" itemprop="datePublished">09-10-2019</time></p></div></li><li><div class="item-thumbnail"><a href="/pwa-entre-la-web-y-las-apps-con-angular/" class="thumbnail"><span style="background-image:url(/css/images/angular-16_pwa.png)" alt="PWA, Entre la web y las apps con Angular" class="thumbnail-image"></span></a></div><div class="item-inner"><p class="item-category"><a class="article-category-link" href="/categories/Tutorial/">Tutorial</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tutorial/Angular/">Angular</a></p><p class="item-title"><a href="/pwa-entre-la-web-y-las-apps-con-angular/" class="title">PWA, Entre la web y las apps con Angular</a></p><p class="item-date"><time datetime="2019-10-03T17:50:27.000Z" itemprop="datePublished">03-10-2019</time></p></div></li><li><div class="item-thumbnail"><a href="/el-patron-redux-con-ngrx-en-angular/" class="thumbnail"><span style="background-image:url(/css/images/angular-15_ngrx.png)" alt="El patrón Redux con NgRx en Angular" class="thumbnail-image"></span></a></div><div class="item-inner"><p class="item-category"><a class="article-category-link" href="/categories/Tutorial/">Tutorial</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tutorial/Angular/">Angular</a></p><p class="item-title"><a href="/el-patron-redux-con-ngrx-en-angular/" class="title">El patrón Redux con NgRx en Angular</a></p><p class="item-date"><time datetime="2019-09-25T11:08:50.000Z" itemprop="datePublished">25-09-2019</time></p></div></li><li><div class="item-thumbnail"><a href="/base-aplicacion-angular/" class="thumbnail"><span style="background-image:url(/css/images/angular-1_base.png)" alt="Base para una aplicación Angular" class="thumbnail-image"></span></a></div><div class="item-inner"><p class="item-category"><a class="article-category-link" href="/categories/Tutorial/">Tutorial</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tutorial/Angular/">Angular</a></p><p class="item-title"><a href="/base-aplicacion-angular/" class="title">Base para una aplicación Angular</a></p><p class="item-date"><time datetime="2019-09-23T11:57:00.000Z" itemprop="datePublished">23-09-2019</time></p></div></li><li><div class="item-thumbnail"><a href="/hola-angular-cli/" class="thumbnail"><span style="background-image:url(/css/images/angular-0_cli.png)" alt="Hola Angular CLI" class="thumbnail-image"></span></a></div><div class="item-inner"><p class="item-category"><a class="article-category-link" href="/categories/Tutorial/">Tutorial</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Tutorial/Angular/">Angular</a></p><p class="item-title"><a href="/hola-angular-cli/" class="title">Hola Angular CLI</a></p><p class="item-date"><time datetime="2019-09-23T10:54:00.000Z" itemprop="datePublished">23-09-2019</time></p></div></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">Categorias</h3><div class="widget"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Tutorial/">Tutorial</a><span class="category-list-count">18</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Tutorial/Angular/">Angular</a><span class="category-list-count">18</span></li></ul></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">Nube de etiquetas</h3><div class="widget tagcloud"><a href="/tag/Angular/" style="font-size:20px">Angular</a> <a href="/tag/Angular2/" style="font-size:17.5px">Angular2</a> <a href="/tag/Angular7/" style="font-size:10px">Angular7</a> <a href="/tag/Angular8/" style="font-size:18.75px">Angular8</a> <a href="/tag/AngularJS/" style="font-size:10px">AngularJS</a> <a href="/tag/Avanzado/" style="font-size:15px">Avanzado</a> <a href="/tag/BackEnd/" style="font-size:10px">BackEnd</a> <a href="/tag/CLI/" style="font-size:11.25px">CLI</a> <a href="/tag/ChangeDetection/" style="font-size:10px">ChangeDetection</a> <a href="/tag/Components/" style="font-size:10px">Components</a> <a href="/tag/Cypress/" style="font-size:10px">Cypress</a> <a href="/tag/DI/" style="font-size:10px">DI</a> <a href="/tag/Forms/" style="font-size:10px">Forms</a> <a href="/tag/FrontEnd/" style="font-size:10px">FrontEnd</a> <a href="/tag/Introduccion/" style="font-size:16.25px">Introducción</a> <a href="/tag/Jest/" style="font-size:10px">Jest</a> <a href="/tag/MongoDB/" style="font-size:10px">MongoDB</a> <a href="/tag/NgRx/" style="font-size:10px">NgRx</a> <a href="/tag/NodeJS/" style="font-size:13.75px">NodeJS</a> <a href="/tag/Nx/" style="font-size:11.25px">Nx</a> <a href="/tag/Observables/" style="font-size:13.75px">Observables</a> <a href="/tag/Opinion/" style="font-size:12.5px">Opinión</a> <a href="/tag/PWA/" style="font-size:10px">PWA</a> <a href="/tag/Redux/" style="font-size:11.25px">Redux</a> <a href="/tag/Routing/" style="font-size:10px">Routing</a> <a href="/tag/RxJS/" style="font-size:10px">RxJS</a> <a href="/tag/RxJs/" style="font-size:10px">RxJs</a> <a href="/tag/SPA/" style="font-size:10px">SPA</a> <a href="/tag/SSR/" style="font-size:10px">SSR</a> <a href="/tag/Servicios/" style="font-size:10px">Servicios</a> <a href="/tag/Template/" style="font-size:10px">Template</a> <a href="/tag/Test/" style="font-size:10px">Test</a> <a href="/tag/Tutorial/" style="font-size:20px">Tutorial</a> <a href="/tag/TypeScript/" style="font-size:10px">TypeScript</a> <a href="/tag/Universal/" style="font-size:10px">Universal</a> <a href="/tag/http/" style="font-size:11.25px">http</a> <a href="/tag/material/" style="font-size:10px">material</a> <a href="/tag/reactiveForms/" style="font-size:10px">reactiveForms</a></div></div><div class="widget-wrap widget-list"><h3 class="widget-title">Links</h3><div class="widget"><ul><li><a href="https://www.trainingit.es/curso-angular-basico/?promo=angular.builders">Intro</a></li><li><a href="https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders">Avanzado</a></li><li><a href="https://www.trainingit.es/curso-typescript/?promo=meetup10&af=abasalo">TypeScript</a></li><li><a href="http://referral.pluralsight.com/mQe488E">PluralSight</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">Archivos</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">octubre 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">septiembre 2019</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">marzo 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">febrero 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">enero 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">marzo 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">mayo 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">abril 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">marzo 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">enero 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">agosto 2015</a><span class="archive-list-count">1</span></li></ul></div></div><div id="toTop" class="fa fa-angle-up"></div><div><a href="https://angular.builders" style="align-content:center"><img src="/css/images/angular.builders.png" width="100%" height="auto" alt="Angular.Builders"></a></div></aside></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner">&copy; 2019 Developed by <a target="_blank" href="http://agorabinaria.com">Ágora Binaria</a>.</div></div></footer><script src="/js/main.js"></script><script src="//load.sumome.com/" data-sumo-site-id="24f3eb649e85fa1f7db20b7fa344f42f381f65f8f86f7028766c55d313e73eb5" async></script></div></body>