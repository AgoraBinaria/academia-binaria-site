{"meta":{"version":1,"warehouse":"3.0.2"},"models":{"Asset":[{"_id":"source/images/10-projects-dependency.png","path":"images/10-projects-dependency.png","modified":0,"renderable":0},{"_id":"source/images/11-projects-dependency.png","path":"images/11-projects-dependency.png","modified":0,"renderable":0},{"_id":"source/images/12-class-dependency.png","path":"images/12-class-dependency.png","modified":0,"renderable":0},{"_id":"source/images/12-projects-dependency.png","path":"images/12-projects-dependency.png","modified":0,"renderable":0},{"_id":"source/images/13-class-dependency.png","path":"images/13-class-dependency.png","modified":0,"renderable":0},{"_id":"source/images/13-projects-dependency.png","path":"images/13-projects-dependency.png","modified":0,"renderable":0},{"_id":"source/images/change-detection.jpg","path":"images/change-detection.jpg","modified":0,"renderable":0},{"_id":"source/images/draw-horse.jpeg","path":"images/draw-horse.jpeg","modified":0,"renderable":0},{"_id":"source/images/ng2-Arbol-de-componentes.jpg","path":"images/ng2-Arbol-de-componentes.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2-Arbol-de-dependencias.jpg","path":"images/ng2-Arbol-de-dependencias.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2-Component-DataFlow.jpg","path":"images/ng2-Component-DataFlow.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2-DI-component-directive.jpg","path":"images/ng2-DI-component-directive.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2-DI-component-service.jpg","path":"images/ng2-DI-component-service.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2-Flujo-de-datos.jpg","path":"images/ng2-Flujo-de-datos.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2Component--1-.jpg","path":"images/ng2Component--1-.jpg","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-5_inject.png","path":"images/tutorial-angular-5_inject.png","modified":0,"renderable":0},{"_id":"source/images/Redux.png","path":"images/Redux.png","modified":0,"renderable":0},{"_id":"source/images/pedidos_ms.PNG","path":"images/pedidos_ms.PNG","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-18_i18n.png","path":"images/tutorial-angular-18_i18n.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-19_elements.png","path":"images/tutorial-angular-19_elements.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-6_http.png","path":"images/tutorial-angular-6_http.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-8_reactive.png","path":"images/tutorial-angular-8_reactive.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-7_watch.png","path":"images/tutorial-angular-7_watch.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-13_template.png","path":"images/tutorial-angular-13_template.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-2_spa.png","path":"images/tutorial-angular-2_spa.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-3_data.png","path":"images/tutorial-angular-3_data.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-4_flow.png","path":"images/tutorial-angular-4_flow.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/icarus/source/js/insight.js","path":"js/insight.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-0_cli.png","path":"images/tutorial-angular-0_cli.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-10_monorepo.png","path":"images/tutorial-angular-10_monorepo.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-11_test.png","path":"images/tutorial-angular-11_test.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-16_pwa.png","path":"images/tutorial-angular-16_pwa.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-9_material.png","path":"images/tutorial-angular-9_material.png","modified":0,"renderable":0},{"_id":"source/images/light-new-year-s-eve-fireworks-sylvester-40663.jpg","path":"images/light-new-year-s-eve-fireworks-sylvester-40663.jpg","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-12_change.png","path":"images/tutorial-angular-12_change.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-14_redux.png","path":"images/tutorial-angular-14_redux.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-15_ngrx.png","path":"images/tutorial-angular-15_ngrx.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-1_base.png","path":"images/tutorial-angular-1_base.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-0_cli.png","path":"css/images/angular-0_cli.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-10_monorepo.png","path":"css/images/angular-10_monorepo.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-11_test.png","path":"css/images/angular-11_test.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-12_change.png","path":"css/images/angular-12_change.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-13_template.png","path":"css/images/angular-13_template.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-14_redux.png","path":"css/images/angular-14_redux.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-15_ngrx.png","path":"css/images/angular-15_ngrx.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-16_pwa.png","path":"css/images/angular-16_pwa.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-17_ssr.png","path":"css/images/angular-17_ssr.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-19_elements.png","path":"css/images/angular-19_elements.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-1_base.png","path":"css/images/angular-1_base.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-18_i18n.png","path":"css/images/angular-18_i18n.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-2_spa.png","path":"css/images/angular-2_spa.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-3_data.png","path":"css/images/angular-3_data.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-4_flow.png","path":"css/images/angular-4_flow.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-5_inject.png","path":"css/images/angular-5_inject.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-6_http.png","path":"css/images/angular-6_http.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-7_watch.png","path":"css/images/angular-7_watch.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-8_reactive.png","path":"css/images/angular-8_reactive.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-9_material.png","path":"css/images/angular-9_material.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular.builders.png","path":"css/images/angular.builders.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular_18_i18n.png","path":"css/images/angular_18_i18n.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/avatar.jpg","path":"css/images/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular.jpg","path":"css/images/angular.jpg","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/thumb-default-small.png","path":"css/images/thumb-default-small.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/justified-gallery/justifiedGallery.min.css","path":"libs/justified-gallery/justifiedGallery.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/justified-gallery/jquery.justifiedGallery.min.js","path":"libs/justified-gallery/jquery.justifiedGallery.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/styles.css","path":"libs/open-sans/styles.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/source-code-pro/styles.css","path":"libs/source-code-pro/styles.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/logo.png","path":"css/images/logo.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/typescript.jpg","path":"css/images/typescript.jpg","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.css","path":"libs/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.min.css","path":"libs/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css","path":"libs/lightgallery/css/lg-fb-comment-box.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css.map","path":"libs/lightgallery/css/lg-fb-comment-box.css.map","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.min.css","path":"libs/lightgallery/css/lg-fb-comment-box.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css","path":"libs/lightgallery/css/lg-transitions.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css.map","path":"libs/lightgallery/css/lg-transitions.css.map","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.min.css","path":"libs/lightgallery/css/lg-transitions.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css","path":"libs/lightgallery/css/lightgallery.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css.map","path":"libs/lightgallery/css/lightgallery.css.map","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.min.css","path":"libs/lightgallery/css/lightgallery.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.eot","path":"libs/lightgallery/fonts/lg.eot","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.svg","path":"libs/lightgallery/fonts/lg.svg","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.ttf","path":"libs/lightgallery/fonts/lg.ttf","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.woff","path":"libs/lightgallery/fonts/lg.woff","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/loading.gif","path":"libs/lightgallery/img/loading.gif","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/vimeo-play.png","path":"libs/lightgallery/img/vimeo-play.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/video-play.png","path":"libs/lightgallery/img/video-play.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/youtube-play.png","path":"libs/lightgallery/img/youtube-play.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.js","path":"libs/lightgallery/js/lg-autoplay.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.min.js","path":"libs/lightgallery/js/lg-autoplay.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.js","path":"libs/lightgallery/js/lg-fullscreen.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.min.js","path":"libs/lightgallery/js/lg-fullscreen.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.js","path":"libs/lightgallery/js/lg-hash.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.min.js","path":"libs/lightgallery/js/lg-hash.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.js","path":"libs/lightgallery/js/lg-pager.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.min.js","path":"libs/lightgallery/js/lg-pager.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.js","path":"libs/lightgallery/js/lg-share.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.min.js","path":"libs/lightgallery/js/lg-share.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.js","path":"libs/lightgallery/js/lg-thumbnail.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.min.js","path":"libs/lightgallery/js/lg-thumbnail.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.js","path":"libs/lightgallery/js/lg-video.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.js","path":"libs/lightgallery/js/lg-zoom.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.min.js","path":"libs/lightgallery/js/lg-video.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.min.js","path":"libs/lightgallery/js/lg-zoom.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.js","path":"libs/lightgallery/js/lightgallery.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.min.js","path":"libs/lightgallery/js/lightgallery.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","path":"libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","path":"libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","path":"libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/favicon.ico","path":"css/images/favicon.ico","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff","path":"libs/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff2","path":"libs/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/jquery/2.1.3/jquery.min.js","path":"libs/jquery/2.1.3/jquery.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.eot","path":"libs/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.ttf","path":"libs/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/FontAwesome.otf","path":"libs/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular.builders_cuadrado.png","path":"css/images/angular.builders_cuadrado.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-17_ssr.png","path":"images/tutorial-angular-17_ssr.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.svg","path":"libs/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/Angular_Bootcamp_Cruise.png","path":"css/images/Angular_Bootcamp_Cruise.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/Angular_Bootcamp.png","path":"css/images/Angular_Bootcamp.png","modified":0,"renderable":1}],"Cache":[{"_id":"themes/icarus/icarus.txt","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1525337765886},{"_id":"themes/icarus/LICENSE","hash":"73ed09aa00f7bda6319fc7d5b722fb40e0c2017e","modified":1525337765871},{"_id":"themes/icarus/_config.yml","hash":"c661a8ab2d47c1cbb88d800322ae2a203a870226","modified":1599817597345},{"_id":"themes/icarus/README.md","hash":"c2407cbda23f087be719d6dc3f7207a8e01ffd73","modified":1525337765871},{"_id":"themes/icarus/_config.yml.example","hash":"73af4425442660d8cd491115a13d2a14c52f59cc","modified":1525337765886},{"_id":"themes/icarus/package.json","hash":"c156985c2689895a228188a29ceaae8f7d0bb34f","modified":1525337766058},{"_id":"source/.DS_Store","hash":"39d94912a63ec708e3af99df0204f2b60fb1105d","modified":1525337765754},{"_id":"source/404.md","hash":"ed869e21a6ac3f026e7f38aab1e2bbf374e19444","modified":1525337765754},{"_id":"source/angular_9-original-clean.md","hash":"ad2c14d922b00c72cc534aae8fdab90ada41af89","modified":1581954184055},{"_id":"source/angular_9-translate.md","hash":"b3c722ce979e97ec9a021a58a00fa946cb7dd5c2","modified":1582042764730},{"_id":"themes/icarus/languages/en.yml","hash":"2b888a89957e07f440452a12ef338af979abb4c6","modified":1525337765902},{"_id":"themes/icarus/languages/es.yml","hash":"aff832ad099fdeac148c643360df44d0a7f59874","modified":1525337765902},{"_id":"themes/icarus/languages/fr.yml","hash":"7b386bf21226433cb7da7989aba07ce33da5b359","modified":1525337765902},{"_id":"themes/icarus/languages/id.yml","hash":"83021037b6dad8dd48f48e3b4a822d07d56fc272","modified":1525337765902},{"_id":"themes/icarus/languages/ja.yml","hash":"e13df67ba3666c0d95d60c081e41fb86f6f48663","modified":1525337765902},{"_id":"themes/icarus/languages/ko.yml","hash":"5e6e5b5d20c940cf0be26957f3a3f6a141f338e0","modified":1525337765902},{"_id":"themes/icarus/languages/pt-BR.yml","hash":"3cf767f94766ac3a93d6efb9ef954e20d16b2b44","modified":1525337765902},{"_id":"themes/icarus/languages/ru.yml","hash":"7423608a9608766ab5998d6b8d3e8d76b792e30e","modified":1525337765902},{"_id":"themes/icarus/languages/tr.yml","hash":"50d94b21e1838db1214f6874f4f81b47c8c521db","modified":1525337765917},{"_id":"themes/icarus/languages/zh-CN.yml","hash":"fdce6e6716768cfac9355c4e88a05260efeeae1c","modified":1525337765917},{"_id":"themes/icarus/languages/zh-TW.yml","hash":"646a7ef3e85481b013ffb2f4d9f9a8900f092d73","modified":1525337765917},{"_id":"themes/icarus/layout/archive.ejs","hash":"6a4adb703df447a754225fa665e679816e432ea2","modified":1525337765917},{"_id":"themes/icarus/layout/categories.ejs","hash":"7be3918bcfb9f04b5213aeda4ad19c952128bee3","modified":1525337765917},{"_id":"themes/icarus/layout/category.ejs","hash":"1d407f9176db84e83062c52ad4755aaea9e74401","modified":1525337765917},{"_id":"themes/icarus/layout/index.ejs","hash":"c329f4598a0af4d8678ba789fdc84fcdf10122de","modified":1525337765996},{"_id":"themes/icarus/layout/layout.ejs","hash":"b37ed400e1416964b45ff7d0fa64417d2172962a","modified":1525337766011},{"_id":"themes/icarus/layout/page.ejs","hash":"50170783bac99946ae8af483920568de9b2d9801","modified":1525337766011},{"_id":"themes/icarus/layout/post.ejs","hash":"50170783bac99946ae8af483920568de9b2d9801","modified":1525337766011},{"_id":"themes/icarus/layout/tag.ejs","hash":"f6c220d4e5c231028bc71ddc11aec97d7b5a9943","modified":1525337766042},{"_id":"themes/icarus/layout/tags.ejs","hash":"2a5b11bdf0dbf7300e11eae34bba00490ed77a0f","modified":1525337766042},{"_id":"themes/icarus/scripts/meta.js","hash":"2e5ac0cb9c90c072ca4b33e88f1892e954935ab7","modified":1525337766058},{"_id":"themes/icarus/scripts/thumbnail.js","hash":"4a7385e533f3567758bc995a8be5eb3e7839ac9c","modified":1525337766058},{"_id":"source/Contacto/index.md","hash":"8d3f82ba692c2e9e02bbb6c7184ebe3772cd210d","modified":1525337765754},{"_id":"source/Cookies/index.md","hash":"910a9c77e0b6b83065878febc522fba888491234","modified":1525337765769},{"_id":"source/Cursos/_old_index.md","hash":"6e08f944b7ed227418d8b2c85d96a364e2bc2667","modified":1553069720885},{"_id":"source/Cursos/angular-basic.md","hash":"ae7c13358e4d3e97abd543f86054e0384ef7ed9d","modified":1568219190079},{"_id":"source/Cursos/angular-business.md","hash":"3934d3ed329e57123e27583a26c17ce239a52e72","modified":1568219190066},{"_id":"source/Cursos/index.md","hash":"63bbecc158d8e1d7b99d48b1eebf26116a98afbd","modified":1582557680636},{"_id":"source/Noticias-Junio-2016/index.md","hash":"1189d0847c6c149b8e4fb81516f4865ca2bf6fed","modified":1525337765769},{"_id":"source/Promociones/index.md","hash":"f632b70d1a3924a0335fdc734366a31c1d8bc1cd","modified":1525337765769},{"_id":"source/_posts/Node-6-0-0-actualizacion-con-nvm.md","hash":"b817fe493340291ff7296a7905b8b72a0f96db7c","modified":1562856756427},{"_id":"source/_posts/Para-que-puedo-usar-NodeJS.md","hash":"996914b2c4071c5b793efbd1882469a5779a2e81","modified":1562856756427},{"_id":"source/_posts/Soluciones-BackEnd-2016.md","hash":"2ce02cb5e4aad50d54c8c55b23698fbdf86ec905","modified":1562856822502},{"_id":"source/_posts/Soluciones-FrontEnd-2016.md","hash":"15accef29481686ca3e967aade9849365285b3b5","modified":1562856795296},{"_id":"source/_posts/TypeScript-programa-en-el-front-igual-que-en-el-back.md","hash":"da2060ceb3a10fff69ce61a338bdb86e4f98849d","modified":1562856822502},{"_id":"source/_posts/angular9.md","hash":"7220326e4cef5a0de72fb4e84aef4123b4af9d51","modified":1582558449788},{"_id":"source/_posts/ng-10-nx-mono-repositorios-en-Angular.md","hash":"f1754cb7727d4fc82c5cdf07cb1d35152a0399ce","modified":1569237634965},{"_id":"source/_posts/ng-11-tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular.md","hash":"a0fc29d3e3358bf4562a7dd4371b60e91dfcd510","modified":1603785553151},{"_id":"source/_posts/ng-12-Deteccion-del-cambio-en-Angular.md","hash":"08611becfd9406924480ec38418530882f3e9b7a","modified":1571235781020},{"_id":"source/_posts/ng-13-Componentes-dinamicos-directivas-y-pipes-con-Angular.md","hash":"16baa45c66c7274434c1ff5bf516856ac2214853","modified":1571235781021},{"_id":"source/_posts/ng-14-Flujo reactivo unidireccional con Angular y RxJs.md","hash":"ca2d976555dda0fd7b575d6b2d76af8b80fcf97d","modified":1571235781023},{"_id":"source/_posts/ng-15-El-patron-Redux-con-NgRx-en-Angular.md","hash":"dc9b40bb457b939ba82f1272635d82f63a83faa8","modified":1571235781024},{"_id":"source/_posts/ng-16-PWA-Entre-la-web-y-las-apps-con-Angular.md","hash":"c7c0c7cd8aca7669e765c398b7d8f1cc40a45045","modified":1571235781026},{"_id":"source/_posts/ng-17-velocidad-y-seo-con-el-ssr-de-angular-universal.md","hash":"d70445f8fc0d864595a9f36e3e911353d95cc214","modified":1571235781028},{"_id":"source/_posts/ng-18-internacionalizacion-y-puesta-en-produccion-con-Angular.md","hash":"fa1b1bb5b698f35c1593763b38351ff5b3dd2984","modified":1572257374693},{"_id":"source/_posts/ng-19-Elementos Angular para los Web Components.md","hash":"8be93812e4ca2d1bb5562a080a7cd19bf1a2dfcf","modified":1572280199402},{"_id":"source/_posts/ng-3-Formularios-tablas-y-modelos-de-datos-en-Angular.md","hash":"6b08c31c5e3c73560be05a28073d236e1d5eb5f5","modified":1586954201003},{"_id":"source/_posts/ng-4-Flujo-de-datos-entre-componentes-Angular.md","hash":"29b440d3f1dd2633e07718c50d0c2ccc3572f5a7","modified":1587038766435},{"_id":"source/_posts/ng-5-Servicios-inyectables-en-Angular.md","hash":"0c05fbe4b51d2f884b40cb3e00bea0ba8bfbb727","modified":1587112528074},{"_id":"source/_posts/ng-6-comunicaciones-http-en-angular.md","hash":"1c2a89c72a8d00df5d0cd41188a1d3feb67a6994","modified":1587288990336},{"_id":"source/_posts/ng-7-Vigilancia-y-seguridad-en-Angular.md","hash":"770ca27445a0fbe36a9a1116ff37d179cae68cc6","modified":1587288990387},{"_id":"source/_posts/ng-8-Formularios-reactivos-con-Angular.md","hash":"c3d18346d872ed8d5b5d330044e715ebda63f1f1","modified":1571235781036},{"_id":"source/_posts/ng-9-Material-Design-y-CLI-de-Angular.md","hash":"6356b1e59fc444240cbd15ef8aa0dbdf5f3234ad","modified":1571235781038},{"_id":"source/_posts/ng_0-Hola-Angular-CLI.md","hash":"0391eead0440a1f9e92f1da1d4516523a774c8db","modified":1586769545228},{"_id":"source/_posts/ng_1-Base-aplicacion-Angular.md","hash":"bf61462feab7be06b3f783eadc592a617fa8b222","modified":1586946884898},{"_id":"source/_posts/ng_2-Paginas-y-rutas-Angular-SPA.md","hash":"55a4c322389d9000ec2bfe23cc121de1aaf4e6f4","modified":1586864286875},{"_id":"source/_posts/npm-de-instalador-a-publicador.md","hash":"a63c7015f4602ad57a5a5603564bad985681b446","modified":1562856756432},{"_id":"source/_posts/temp.txt","hash":"d82d37c2d5422e2521693d7ee4d75b7e8c4959c7","modified":1536925828653},{"_id":"source/images/10-projects-dependency.png","hash":"05aa9816c520bcbee12b267c5635e61ee990ef9f","modified":1564647859652},{"_id":"source/images/11-projects-dependency.png","hash":"328588f3e93749fdceb24bc898bd23f63391b584","modified":1564647978345},{"_id":"source/images/12-class-dependency.png","hash":"41e598b1f619cd59bf931ae0988c9ee6fe66ba2d","modified":1564675148091},{"_id":"source/images/12-projects-dependency.png","hash":"4456a09bade67f87e690a380f7acecc3f59cbe75","modified":1564673758778},{"_id":"source/images/13-class-dependency.png","hash":"ce409f5b00733eaa6a47b13ed5e3df4d8f77726b","modified":1564760646511},{"_id":"source/images/13-projects-dependency.png","hash":"160ee55cb4860cb32a9f7783bdeb59414abb846b","modified":1564760650385},{"_id":"source/images/change-detection.jpg","hash":"38e2ad8769de570d9fb8f33567d8e9807283bb01","modified":1568212717990},{"_id":"source/images/draw-horse.jpeg","hash":"9b7c94d3a9417ee722955dd3bc8462de1ecb62d0","modified":1564568463447},{"_id":"source/images/ng2-Arbol-de-componentes.jpg","hash":"ddf926766408af4ce8c65d3de3d5ff0270a0121b","modified":1525337765801},{"_id":"source/images/ng2-Arbol-de-dependencias.jpg","hash":"e474811bca4569fc209680fcb7f7fc432b60af99","modified":1525337765801},{"_id":"source/images/ng2-Component-DataFlow.jpg","hash":"0032c08ed4f67fc294781b6acb472f50f17ed0f2","modified":1525337765801},{"_id":"source/images/ng2-DI-component-directive.jpg","hash":"ed32320793c7b4c608bcb55d8bdc63ba40dde3fc","modified":1525337765801},{"_id":"source/images/ng2-DI-component-service.jpg","hash":"36febb9d7dbdc6fa87d03d7b5c0ad28adfbcf130","modified":1525337765801},{"_id":"source/images/ng2-Flujo-de-datos.jpg","hash":"e8a401ea27c0d850170a310ee8ce5db233cd3214","modified":1525337765801},{"_id":"source/images/ng2Component--1-.jpg","hash":"4f3a1732800a40410e7b34cb733633866d2dccaf","modified":1525337765801},{"_id":"source/images/tutorial-angular-5_inject.png","hash":"6c973db275b9201fa39c30a7e45a5a16e419808d","modified":1536577315653},{"_id":"source/scaffolds/draft.md","hash":"b14e9fa1e21c75482dd3f05d27705719a2cb47f1","modified":1525337765855},{"_id":"source/scaffolds/page.md","hash":"892cedeb7b62a73e72a3b369daf2bc63dfee47dc","modified":1525337765871},{"_id":"source/scaffolds/post.md","hash":"c569840f0ea232daf0865c3bc8f7ef63b235be62","modified":1525337765871},{"_id":"source/images/Redux.png","hash":"5824bf36b4472131be0381fadaa7e540280fa33c","modified":1568904408616},{"_id":"source/images/pedidos_ms.PNG","hash":"87bfe70ad301e5eb261f9289eceb66ba0ad263a9","modified":1547047499788},{"_id":"source/images/tutorial-angular-18_i18n.png","hash":"9e2fa00fa1f8d0c1880eb8659e1b4714b29b434b","modified":1571235781053},{"_id":"source/images/tutorial-angular-19_elements.png","hash":"55eb695dd934f607f61f2f84a33d8d5194427902","modified":1572257374699},{"_id":"source/images/tutorial-angular-6_http.png","hash":"ad9a952719b98cd7aa14820172e70a9697b497fd","modified":1536915878153},{"_id":"source/images/tutorial-angular-8_reactive.png","hash":"efd001decaa557eb69d70bc7be7931c78362ff00","modified":1537778302204},{"_id":"source/images/tutorial-angular-7_watch.png","hash":"ba0564cd624db724dab51a4b9f4c920e527fa37a","modified":1537177186055},{"_id":"themes/icarus/_source/about/index.md","hash":"3c9b7a6853bfcdd019317c95f2aa33829b269cbc","modified":1525337765886},{"_id":"themes/icarus/_source/categories/index.md","hash":"62fe9cd3a09f7971c8bfb84f18ed7863f84cb30a","modified":1525337765886},{"_id":"themes/icarus/_source/tags/index.md","hash":"f913370f50299b9b8b4cfd73fbdd5c07f4950549","modified":1525337765886},{"_id":"themes/icarus/layout/comment/changyan.ejs","hash":"67b9c24a2973bb208e183ce46201d3c209a1bd4a","modified":1525337765933},{"_id":"themes/icarus/layout/comment/counter.ejs","hash":"f744b41f3cc258e2a5a6df6abf6cf9ba9f05c19c","modified":1525337765933},{"_id":"themes/icarus/layout/comment/disqus.ejs","hash":"b83fd91a30ca2bd62e2d43ae48e0523e0e1994c0","modified":1525337765933},{"_id":"themes/icarus/layout/comment/duoshuo.ejs","hash":"adc024b7205e934e64c98a5b912c41117a4425bd","modified":1525337765933},{"_id":"themes/icarus/layout/comment/facebook.ejs","hash":"6a53104fc01fd4a7a34b46c2828e76d02cacb0dd","modified":1525337765933},{"_id":"themes/icarus/layout/comment/gitment.ejs","hash":"c7998209b9a766eeba6976dd4bdffb1f87469358","modified":1525337765949},{"_id":"themes/icarus/layout/comment/index.ejs","hash":"7269156a9d99b238f6394b4e7e52d0439e774eb3","modified":1525337765949},{"_id":"themes/icarus/layout/comment/isso.ejs","hash":"b3dd067a6099f0e088f3374d37b8a726bafe15e5","modified":1525337765949},{"_id":"themes/icarus/layout/comment/livere.ejs","hash":"d2d0d8113a5a7d2cddf1d8ce067e07d40874e56c","modified":1525337765949},{"_id":"themes/icarus/layout/comment/scripts.ejs","hash":"063f997bad70768fa3a7f954830b51893b2d48da","modified":1525337765949},{"_id":"themes/icarus/layout/comment/valine.ejs","hash":"0ea90a606f0d386a5ae0da83c0501cbb25319fde","modified":1525337765949},{"_id":"themes/icarus/layout/comment/youyan.ejs","hash":"b4c49b97b757d01ba0c4e16f9862a2ec05f37b1f","modified":1525337765964},{"_id":"themes/icarus/layout/common/article.ejs","hash":"dbeeb10d4a6f2d3b5dfdae945f906ee6154b9742","modified":1583345172460},{"_id":"themes/icarus/layout/common/footer.ejs","hash":"39970201c684e19eba4d3db6db192e78bb695d66","modified":1525337765964},{"_id":"themes/icarus/layout/common/head.ejs","hash":"0df5bb7c34937154c16d0a7598913d236585db3c","modified":1556811885819},{"_id":"themes/icarus/layout/common/header.ejs","hash":"c75d5c3e956f70b0b82552f1e3f5749f0229ddd7","modified":1525337765964},{"_id":"themes/icarus/layout/common/profile.ejs","hash":"ddefab99a240babda44b8a02b07ea096bb921753","modified":1599818668912},{"_id":"themes/icarus/layout/common/scripts.ejs","hash":"7be8d835b664085758f0ea550e3180c05de6f2b7","modified":1525337765996},{"_id":"themes/icarus/layout/common/sidebar.ejs","hash":"8142fbd4ab67a5db8a9783e2e6daad6834024c61","modified":1599817527232},{"_id":"themes/icarus/layout/common/thumbnail.ejs","hash":"b80d8733a620be64a6f7d73f0b012a986755fd91","modified":1525337765996},{"_id":"themes/icarus/layout/common/timeline.ejs","hash":"a2ba07bd70a82a80df71133dc0cea1248a1e3b3e","modified":1525337765996},{"_id":"themes/icarus/layout/plugin/baidu-analytics.ejs","hash":"3218b9f6345aaa537f742ab4781bd27a3f40c378","modified":1525337766011},{"_id":"themes/icarus/layout/plugin/google-analytics.ejs","hash":"760a8f9ee9b81f6eb27a5f2c8c5159b220a88a74","modified":1525337766011},{"_id":"themes/icarus/layout/plugin/scripts.ejs","hash":"2a41940ab86d3f7b095436b56ea304689c2b5121","modified":1525337766011},{"_id":"themes/icarus/layout/search/baidu.ejs","hash":"8cc6f6e601b14d310f20eaf29dc55d6c60ab4ee4","modified":1525337766027},{"_id":"themes/icarus/layout/search/index-mobile.ejs","hash":"8e2e28b37a908f60e4953bf9175a7af329d15d40","modified":1525337766027},{"_id":"themes/icarus/layout/search/index.ejs","hash":"fb1ac5d6b44dbc96cbef7ecdbb6397c3d4fe3e0f","modified":1525337766027},{"_id":"themes/icarus/layout/search/insight.ejs","hash":"21ec59e4534ac2417d6b215b6cfe3825245ad340","modified":1525337766027},{"_id":"themes/icarus/layout/search/swiftype.ejs","hash":"cce9c44180d9490f45b30b8f052ac82675a9d66a","modified":1525337766027},{"_id":"themes/icarus/layout/share/addtoany.ejs","hash":"b79f714da69c121729a136df0c94c09a85966d44","modified":1525337766027},{"_id":"themes/icarus/layout/share/bdshare.ejs","hash":"d2a0826700c51d9edaf21fa6cbb047b5127cec8a","modified":1525337766027},{"_id":"themes/icarus/layout/share/default.ejs","hash":"8532f15f400dbc7c1e89ab26972fc4e404001849","modified":1525337766042},{"_id":"themes/icarus/layout/share/index.ejs","hash":"52c094140d19e7e2fce57fe43968b2bd86aa4ef0","modified":1525337766042},{"_id":"themes/icarus/layout/share/jiathis.ejs","hash":"442abbc0fe5cab4171179257d172150f2a789638","modified":1525337766042},{"_id":"themes/icarus/layout/widget/archive.ejs","hash":"d6412cd574744f994f16e3a70ce29a71b449133a","modified":1525337766042},{"_id":"themes/icarus/layout/widget/category.ejs","hash":"81c6c0a3450e1ab56a725bb953a5021a07c0e212","modified":1525337766042},{"_id":"themes/icarus/layout/widget/links.ejs","hash":"23d637daed63e86ec7c4a12f5a48908905ed7819","modified":1525337766042},{"_id":"themes/icarus/layout/widget/recent_posts.ejs","hash":"7767972b9d0cba456f0e0cff1b96b516936414ea","modified":1525337766042},{"_id":"themes/icarus/layout/widget/tag.ejs","hash":"cf8a87b0573c9ff11d82ca5edb86267f77e11589","modified":1525337766058},{"_id":"themes/icarus/layout/widget/tagcloud.ejs","hash":"a4b28996e0e7df2e582387455c02f5c33f691bbd","modified":1525337766058},{"_id":"themes/icarus/source/css/_extend.styl","hash":"c18c58c67f49b8afe92fa8852ff7e203ce5958de","modified":1525337766058},{"_id":"themes/icarus/source/css/_variables.styl","hash":"da60cf824c9e905aca1f002e417a3c61864b6883","modified":1525337766136},{"_id":"themes/icarus/source/css/style.styl","hash":"4dc397810fe188ac58166754b667f1891c1518c0","modified":1525337766152},{"_id":"themes/icarus/source/js/insight.js","hash":"691bc7ce086b55b360bb6ec517b2ad6e53ebadc7","modified":1525337766152},{"_id":"themes/icarus/source/js/main.js","hash":"aaea695ac93046f3024db7634baf6f4400f4920c","modified":1535976312066},{"_id":"source/images/tutorial-angular-13_template.png","hash":"36fcc8ea820e68d1a6f62ae84ba6fafbfcb746a4","modified":1568363474250},{"_id":"source/images/tutorial-angular-2_spa.png","hash":"01f90e62f3ad81b990b47b96fc5fdfb3354e1433","modified":1535970976294},{"_id":"source/images/tutorial-angular-3_data.png","hash":"7e963d68e8c6015ebd95d560203ae63165232ccf","modified":1535971203834},{"_id":"source/images/tutorial-angular-4_flow.png","hash":"4484fdf085e6361a070d09ef059f2b0570ab83f6","modified":1536140866612},{"_id":"source/images/tutorial-angular-0_cli.png","hash":"0f7ab5648cb3b0ee99d0c52bdf8186dfe7b9986a","modified":1535970798589},{"_id":"source/images/tutorial-angular-10_monorepo.png","hash":"7102f1df6829b462c50e20d588d05a2c39c15899","modified":1562858140959},{"_id":"source/images/tutorial-angular-11_test.png","hash":"29b4f8736ddaf8c7bc41fc1a7840d086025f943c","modified":1564642536332},{"_id":"source/images/tutorial-angular-16_pwa.png","hash":"4fcca7fe1f8e483d1712e04ffd856a8f5bb4eac2","modified":1571235781046},{"_id":"source/images/tutorial-angular-9_material.png","hash":"04134304478eab6bf7335950deec1d76ca404f81","modified":1552496734141},{"_id":"themes/icarus/layout/common/post/banner.ejs","hash":"431b445dfa5dec4b710069c7f1b5fae3f0a907a5","modified":1525337765964},{"_id":"themes/icarus/layout/common/post/category.ejs","hash":"96f999573eb908f7129a1c09e486d46d630c0a7d","modified":1525337765980},{"_id":"themes/icarus/layout/common/post/date.ejs","hash":"fc90dbfc227563029ece7cff13585083b62935bc","modified":1525337765980},{"_id":"themes/icarus/layout/common/post/gallery.ejs","hash":"6ca8a8c45794a4e10aaac0da85db71b43e5a72ce","modified":1535976257417},{"_id":"themes/icarus/layout/common/post/nav.ejs","hash":"1800d1fa5cc689dcbdc1f58296521e9eb2b53e21","modified":1564649361028},{"_id":"themes/icarus/layout/common/post/tag.ejs","hash":"7df16851b35da0ea09f7323bdbfb977198823f4c","modified":1525337765980},{"_id":"themes/icarus/layout/common/post/title.ejs","hash":"3620e4dad9c7f9c31efd4ad6cf5872cfb9d418c2","modified":1525337765980},{"_id":"themes/icarus/source/css/_partial/article.styl","hash":"acd8966e8f986baca6659ad7418dce13860898a8","modified":1525337766136},{"_id":"themes/icarus/source/css/_partial/archive.styl","hash":"4dd216a147dd65ddc37521fe8a1a01aa929aeea5","modified":1525337766121},{"_id":"themes/icarus/source/css/_partial/comment.styl","hash":"7fc8a32cf235d0a977d9ff0c49263c0541025222","modified":1525337766136},{"_id":"themes/icarus/source/css/_partial/footer.styl","hash":"06c2c9029ebfb16880a203c218657048a83a3e4b","modified":1525337766136},{"_id":"themes/icarus/source/css/_partial/header.styl","hash":"d0109f33d279a3456317c342d84633ffe08a8b10","modified":1525337766136},{"_id":"themes/icarus/source/css/_partial/insight.styl","hash":"8a84868a13c7edb733347655b33dc169c682e8b8","modified":1525337766136},{"_id":"themes/icarus/source/css/_partial/profile.styl","hash":"7eed2cec34bd182c390bf042b56d41f7f2793a2c","modified":1525337766136},{"_id":"themes/icarus/source/css/_partial/sidebar.styl","hash":"fb211c3c747565e6fa2304f436b42d14ef84d71a","modified":1525337766136},{"_id":"themes/icarus/source/css/_partial/timeline.styl","hash":"ba1ea8a87ca7c667f0d3cc40033b52bdf168fbdd","modified":1525337766136},{"_id":"themes/icarus/source/css/_highlight/agate.styl","hash":"c01db6c4e7648b217048a8deefeee189688a9290","modified":1525337766058},{"_id":"themes/icarus/source/css/_highlight/androidstudio.styl","hash":"b0923fe15d0b5eb24d3c6236cb2fc30ee14a4c56","modified":1525337766058},{"_id":"themes/icarus/source/css/_highlight/arduino-light.styl","hash":"591962bfc758a521b4cb907750c19a1a2423b4d5","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/arta.styl","hash":"3bc322455f657aa29f455f91009034af08cdc65c","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/ascetic.styl","hash":"ca087a3c70998c7ac6b0b42d5cf7a653b8707591","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-cave-dark.styl","hash":"a6b1960d8a3b39d035e06ce92af4f00a259b5c56","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-cave-light.styl","hash":"f47de0b9d66617728f68096ed48371dd6bb9e67a","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-dune-dark.styl","hash":"68021a92fd7d6895426d0cc7f0929aa95633d742","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-dune-light.styl","hash":"657fe215931fd06e21b56374df699a94890f7ab4","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-estuary-dark.styl","hash":"6c051f034c229c49ffc9a2ec96c032441b0c6586","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-estuary-light.styl","hash":"2b416a0567a53aa0fa8898b196ddd44315c1a5f3","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-forest-dark.styl","hash":"15559324ee3a5f9bf6724ec9606f6f2e16cdc24d","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-forest-light.styl","hash":"8d7c7242974aa2454fa792c5d7a47c5f9632355a","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-heath-dark.styl","hash":"bf62cafe316eb874f1f43679957dc3add4fbea34","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-heath-light.styl","hash":"c1db353e8613607580d40b12ddc162d029560576","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-lakeside-dark.styl","hash":"64ab6ab93a092a890d3d0fdeb23e4b6a2d0f2887","modified":1525337766074},{"_id":"themes/icarus/source/css/_highlight/atelier-lakeside-light.styl","hash":"8659eaae6a0c2e00b4b9199803e50adf4ff0128d","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/atelier-plateau-dark.styl","hash":"8a6c187afcd60152306c003e1a5903e57d9428dd","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/atelier-plateau-light.styl","hash":"96181544eeadc5b0749229f11607e7c01f81e078","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/atelier-savanna-dark.styl","hash":"5261a100e84cf34f4752c24dfaddfa05c7be96f7","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/atelier-savanna-light.styl","hash":"8a5207a0c30262a0bf5e1a41411a306f7a89a7e7","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/atelier-seaside-dark.styl","hash":"434b7f0bdd5f91bf79d5b4ca46820db4a8e10166","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/atelier-seaside-light.styl","hash":"08e2df313c272d5c70c93e713639663c168180d0","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/atelier-sulphurpool-dark.styl","hash":"fa0cccd0f0dc015218cf8c1bba0b53c8c9383135","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/atelier-sulphurpool-light.styl","hash":"add3d88c9d12567dcfae7a8e49984d119fc72227","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/brown-paper.styl","hash":"d14846542a26b75fd26df5b5df6c5493733f73f6","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/codepen-embed.styl","hash":"7432ce9edb047b6382d28c82054a7e2a77e476c3","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/color-brewer.styl","hash":"9c4905eab730d0b389e6972e907057577f7e25f1","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/dark.styl","hash":"df4c1dc05567ad0812d0cd3133cb2a2a5fd23c04","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/darkula.styl","hash":"3c943561a885092286ec8db14e9177036bf8d21f","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/docco.styl","hash":"7bd3389ce16d20488ab336d557056cc703c921c7","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/far.styl","hash":"5989aea14ccd0153d17ee19b3e125dae06c75f3c","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/foundation.styl","hash":"28c59a31467c33bd51cbf3b6085782c2a724ff6c","modified":1525337766089},{"_id":"themes/icarus/source/css/_highlight/github-gist.styl","hash":"71f4b0fca91a587e6eba15a5306dca963bb8f441","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/github.styl","hash":"a84eb710b302006120c3e7f8ca18f9e6fbc231c3","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/googlecode.styl","hash":"7f5082ae008925a23eb713f160773fe647eb3ff7","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/grayscale.styl","hash":"c83804abe39faebd80f8f4ff64fbd7137674cb1c","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/highlightjs.styl","hash":"fd796a58c5d4590cda67c998187933788d45f30a","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/hopscotch.styl","hash":"7ec8d75a9c9d58f65868ea64289873302d3fad5e","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/hybrid.styl","hash":"d3ee1bcefc94f5f87a2b76a689f4c31594501d07","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/idea.styl","hash":"e284c1760e8da0848f56cd5601d867ceeb0192d7","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/index.styl","hash":"36c44375229613a5bb9ee84a8e90214978070439","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/ir-black.styl","hash":"c59db73998af32ce8419a5d2d335bcc9cfbaae45","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/kimbie.dark.styl","hash":"3b998c640eeb2c6192fee24bc78b4137de475dd7","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/kimbie.light.styl","hash":"e901738455ec9a1bddde7b62bbd8595de6033e1e","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/magula.styl","hash":"ab179306c12a1cf2949482beaca328e379ef034a","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/mono-blue.styl","hash":"14fb8678739b77f35771b6d63101ddbf1e7a9fbc","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/monokai-sublime.styl","hash":"32955f699687b5fc2e4072804cb90925912d3c7c","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/monokai.styl","hash":"8489fc71bedefa8f271808126296fce6381f9e04","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/obsidian.styl","hash":"8145db8ec349548f09d91d7a05c00c83ff84d146","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/paraiso-dark.styl","hash":"50f1cee8a5b3b165b4184ead0a99dc564b62ef4f","modified":1525337766105},{"_id":"themes/icarus/source/css/_highlight/pojoaque.jpg","hash":"c5fe6533b88b21f8d90d3d03954c6b29baa67791","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/paraiso-light.styl","hash":"e428e8202b01e83b0f018a96058d806e7f4c76bf","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/pojoaque.styl","hash":"d9f4b35c9f6115029600a8a023b559013e2b4e75","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/railscasts.styl","hash":"1ff800d9b6de464fafe591682cc48bf983202758","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/rainbow.styl","hash":"516c7080d64b12730357358dee2adc42c43c4516","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/school-book.styl","hash":"186c37e9c39e65aa291cce3317e35904693598d1","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/solarized-dark.styl","hash":"577458d1f6c02bc42e312066bf7dd7e427cab057","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/solarized-light.styl","hash":"bb04944fc06c12ecd7b56ad933dbedde60c2259a","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/sunburst.styl","hash":"482bbb2bc461b22e9d6ce55f0f84767e1cfae99a","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night-blue.styl","hash":"eeafa86697c857c4e9a84ad48c0d56a7154997a3","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night-bright.styl","hash":"f3cd5ed391d40265e36fcd9f7daced52773fb886","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night-eighties.styl","hash":"1cd947f3d414fa5c1435caea509f27c99f6dc5b3","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night.styl","hash":"b2a175caa23631f764b2f6fe2bac9739f5f5e078","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/tomorrow.styl","hash":"502335f0fac07ed74ca78207bcf3ef8dd2252cf6","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/vs.styl","hash":"14fbb0c43af440a290280b26968c8a5c0786b27f","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/xcode.styl","hash":"5fa8999c7f807c1aae29c7a1cdf681678576fb69","modified":1525337766121},{"_id":"themes/icarus/source/css/_highlight/zenburn.styl","hash":"6908313d2666d31fc9d8658fd7e8dda3de2bb596","modified":1525337766121},{"_id":"themes/icarus/source/css/_util/grid.styl","hash":"866fc18d6368c4131b03601a15af7703a9a42b61","modified":1525337766136},{"_id":"themes/icarus/source/css/_util/mixin.styl","hash":"3f8730ec2b1b582ba93b14f0e50a41fbbce52755","modified":1525337766136},{"_id":"themes/icarus/source/css/images/angular-0_cli.png","hash":"3426c1558f871f64b531a13dc85416f38446967d","modified":1536577764554},{"_id":"themes/icarus/source/css/images/angular-10_monorepo.png","hash":"41d8ef7a7f07b19cdd6446baa42d42ca034aaaf5","modified":1562858250533},{"_id":"themes/icarus/source/css/images/angular-11_test.png","hash":"e55cdd34f94c6ba7a09c1a3a775da197cdad54fe","modified":1564642558473},{"_id":"themes/icarus/source/css/images/angular-12_change.png","hash":"a074af521514c1ad4af33662f05e66e8183549c2","modified":1564674373935},{"_id":"themes/icarus/source/css/images/angular-13_template.png","hash":"8c06958d2eaedf90665189301b6e58c11192b46b","modified":1568362726658},{"_id":"themes/icarus/source/css/images/angular-14_redux.png","hash":"b215f1248ef2ecd69d138a58f95f9e1462dcdda2","modified":1568652738169},{"_id":"themes/icarus/source/css/images/angular-15_ngrx.png","hash":"fb88794c1c66472d3217061cbb1db7f4a4df8ea1","modified":1571235781054},{"_id":"themes/icarus/source/css/images/angular-16_pwa.png","hash":"e0cc18d27a36fbb07494d342ef66b50ace3a3f8b","modified":1571235781056},{"_id":"themes/icarus/source/css/images/angular-17_ssr.png","hash":"33af35075ed876b4bd8ec54db0acd97563002f76","modified":1571235781057},{"_id":"themes/icarus/source/css/images/angular-19_elements.png","hash":"91d1ec46cf17d1a8054469eea3036b4be940d583","modified":1572257374702},{"_id":"themes/icarus/source/css/images/angular-1_base.png","hash":"ccf5bc5a6c3c6cc995d240bd11334d2a773612fd","modified":1536577741031},{"_id":"themes/icarus/source/css/images/angular-18_i18n.png","hash":"208c88907557d36e83dbb9de94559554775f71d2","modified":1572257374701},{"_id":"themes/icarus/source/css/images/angular-2_spa.png","hash":"2373e59391c1fff21dbe71f5086cbab63c563efe","modified":1536577682762},{"_id":"themes/icarus/source/css/images/angular-3_data.png","hash":"14e44451e3bbbd4f75a211616787a9e2a2c0c87c","modified":1536577631237},{"_id":"themes/icarus/source/css/images/angular-4_flow.png","hash":"44814f98c95e46a866b51cce8589388f72d5a2ee","modified":1536577582120},{"_id":"themes/icarus/source/css/images/angular-5_inject.png","hash":"aa4a32e4439fba549391fc3eb9fdd067fbea0111","modified":1536577521540},{"_id":"themes/icarus/source/css/images/angular-6_http.png","hash":"02dd0b7f55fb6c41eb6f9f9f64d873db2261a6be","modified":1536915887721},{"_id":"themes/icarus/source/css/images/angular-7_watch.png","hash":"bdd11b0a68a362b35a2c935895d776a579e0f288","modified":1537177222337},{"_id":"themes/icarus/source/css/images/angular-8_reactive.png","hash":"6de03afae8a8354e4bc0b0427621dbaccb26f403","modified":1537778311425},{"_id":"themes/icarus/source/css/images/angular-9_material.png","hash":"f45b79fbb5c3cc310c0df994efed934a387a3874","modified":1552496734143},{"_id":"themes/icarus/source/css/images/angular.builders.png","hash":"47c6b8ea65bca8f9db8ae63d9129d6c179f7c2ea","modified":1563870245113},{"_id":"themes/icarus/source/css/images/angular_18_i18n.png","hash":"8c987411fdf942c0f3d87987b5fbbbc9354a19f2","modified":1571235781058},{"_id":"themes/icarus/source/css/images/avatar.jpg","hash":"6d461314157540948b0b35d63fe9dda8c2fa4665","modified":1525337766152},{"_id":"themes/icarus/source/css/images/angular.jpg","hash":"6bf224d00bb2f792e52fbe936ac5abf2aa1332c0","modified":1525337766152},{"_id":"themes/icarus/source/css/images/thumb-default-small.png","hash":"e8403b97ed9251f9f5207765b0ce796c5000b4ba","modified":1525337766152},{"_id":"themes/icarus/source/libs/justified-gallery/justifiedGallery.min.css","hash":"45fa2fad51cecfc41107dbd4637450b746a7cbc3","modified":1525337766183},{"_id":"themes/icarus/source/libs/justified-gallery/jquery.justifiedGallery.min.js","hash":"1c7fd3bd976f671ba396ad4dbbb7157006243bf5","modified":1525337766183},{"_id":"themes/icarus/source/libs/open-sans/styles.css","hash":"08c8c7eeaf34cb2f8c3312a3ce2e96b58ce2b4c0","modified":1525337766246},{"_id":"themes/icarus/source/libs/source-code-pro/styles.css","hash":"6335d719343cca455152ad71a1aaed9868339236","modified":1525337766246},{"_id":"source/images/light-new-year-s-eve-fireworks-sylvester-40663.jpg","hash":"6a113f77c9df70e22fea4f03851797cc6e298667","modified":1582127391142},{"_id":"source/images/tutorial-angular-12_change.png","hash":"8fac09f82d3fb8a9afaddd547653040605ce145e","modified":1564675436847},{"_id":"source/images/tutorial-angular-14_redux.png","hash":"6576136bb7fe92b1415a71064c75cf116f110f70","modified":1568653079810},{"_id":"source/images/tutorial-angular-15_ngrx.png","hash":"32fe748e5c2f5ed47ecdc15240dc6fcf93805a2e","modified":1571235781044},{"_id":"source/images/tutorial-angular-1_base.png","hash":"fd0fb70cc95d61f24978b0d4a13da675639aaa4b","modified":1535970910201},{"_id":"themes/icarus/source/css/images/logo.png","hash":"3ea04c5059266f2614f2fe37ebd81b6e8acb8a3c","modified":1525337766152},{"_id":"themes/icarus/source/css/images/typescript.jpg","hash":"f49a461df54b6d5eb9c14d921d7ee8689b10ec22","modified":1525337766152},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.css","hash":"bf188c224998b995d0119cfd18fade22e53f573c","modified":1525337766167},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.min.css","hash":"bd7c2763e15e568bdccc85e38432d79f65f8d9a1","modified":1525337766167},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css","hash":"10c9630e41bb8d6bb7f75a3bfe8cdb33451ed7ba","modified":1525337766183},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css.map","hash":"5281d2cfb0ef278940c4860ea9aa7ef86d3dbc8d","modified":1525337766183},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.min.css","hash":"05830fadb8454f39dcc98c8686eb4d5c24b71fc0","modified":1525337766183},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css","hash":"2866c3f1eda31ed34485ff3511bcfb706d78ac56","modified":1525337766183},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css.map","hash":"6ee19f99bca3ecf2fa0d6f07fb5c200db07ddd11","modified":1525337766183},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.min.css","hash":"5c22e2073a4c96d6212c72135391b599e8d1359f","modified":1525337766183},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css","hash":"d26b528a13ee1ef245bdb0aa3db149be3fe9cba6","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css.map","hash":"91788030e3c7107b6b4bf50a82d4309368850488","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.min.css","hash":"c9a2e19c932b56f4a2ce30c98910d10b74edb38a","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.eot","hash":"54caf05a81e33d7bf04f2e420736ce6f1de5f936","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.svg","hash":"3480f00d284c812d623ed16a9e0ead3fb964c72e","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.ttf","hash":"f6421c0c397311ae09f9257aa58bcd5e9720f493","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.woff","hash":"3048de344dd5cad4624e0127e58eaae4b576f574","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/img/loading.gif","hash":"607810444094b8619fa4efa6273bc2a7e38dd4b4","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/img/vimeo-play.png","hash":"6190254f2804904a4a1fa1eb390dfd334e416992","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/img/video-play.png","hash":"3ea484cdc04d2e4547f80cbf80001dcf248c94ef","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/img/youtube-play.png","hash":"fea6df9d9d43151f9c9d15f000adb30eb3e26fc4","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.js","hash":"ba52bd55c0ab647e277c42b0e48a0ac25cbd3099","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.min.js","hash":"44203a1490749aff6aba9784868b6c888d3fb86e","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.js","hash":"6369e9704550f4207fa798dc6018da1d259fd318","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.min.js","hash":"a5c468d260e3a8e68c9026aa2b5f31ce1860b8bf","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.js","hash":"8a026dc31f912cbd3b8a110bb87984b372661f65","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.min.js","hash":"fbdbcb46ae9fd668ba5e4dce5635c040359e3359","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.js","hash":"562f883ba3a5e8ea570fd5d0c40afe527938c026","modified":1525337766199},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.min.js","hash":"ec662f97ed5a15c2bd8cf87d5c93cd9a6b4df07a","modified":1525337766214},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.js","hash":"b000585441e9bff2f5b7c538d623b698d48049a6","modified":1525337766214},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.min.js","hash":"afe725882964c87a148ac6ab54955cb0da0974c4","modified":1525337766214},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.js","hash":"99fe3cc63161f0d678360a939fbd54c5d1c11eeb","modified":1525337766214},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.min.js","hash":"e570807e2786a0acb393c1195c820a660312fffe","modified":1525337766214},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.js","hash":"11c8509a3e398cb8c2a32ff559ccdda6d9d71740","modified":1525337766214},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.js","hash":"69a127964e508699f5f13467dd1b58fbf04bcca9","modified":1525337766214},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.min.js","hash":"050e7684bfbb133bed5375938fe0021f1fa88f7f","modified":1525337766214},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.min.js","hash":"8daabc26ceadc43741904b99db7e01bfababbd04","modified":1525337766214},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.js","hash":"6d424527be45ff4deedd198e195fdeb74f1c6567","modified":1525337766214},{"_id":"themes/icarus/source/libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","hash":"e0350190d720a8fec0557ab47b318ec4e4486448","modified":1525337766214},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.min.js","hash":"dc9c6447d3574fcba3868c35bb48e0bed9be6b7e","modified":1525337766214},{"_id":"themes/icarus/source/libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","hash":"2c5b039b57f62625e88226a938679ec937431ad1","modified":1525337766214},{"_id":"themes/icarus/source/libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","hash":"c4248ea800bd5608344ce163f5658b57e7ef9410","modified":1525337766214},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","hash":"22413bb8bfb78608c1e25aa1ed5c1f38557df79f","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","hash":"63eb74ef040aade256f2274a7f31a914edddb0ea","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","hash":"328a22fe3eec71ad9e5ece4d67dd62e79dab6b7f","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","hash":"4dc6d7174ea6d89f4c45e43e1bfc3e03d8ffebaf","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","hash":"415eee05976ab8b2471602a5ddb78a6c58fc21aa","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","hash":"a0b0c389cf46d63c850e61fed572485ff0b68183","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","hash":"c5f29fed6632efe0aa83318369f0d8c4061b775b","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","hash":"be201d32a9aa5d186723ebb3c538be691aa8c53a","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","hash":"afc44700053c9a28f9ab26f6aec4862ac1d0795d","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","hash":"113978181dcac77baecef6115a9121d8f6e4fc3a","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","hash":"5067c81462c15422853c94d21a1726865a61634f","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","hash":"b366f2fda2e524eb5ef50058eefff249a3b96e6c","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","hash":"d22904914469be735490e3c8cb093c7862896dd5","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","hash":"ae80fb3cd16339aa7b5da280ab53975523dcaac2","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","hash":"b85efde42fa3a03c32b1d31c6cd74c622fc7916c","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","hash":"e75607ba1417181397c700775b84303d5a2957b9","modified":1525337766230},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","hash":"d0b40a7848703556c6631f24e961a98ca5829255","modified":1525337766246},{"_id":"themes/icarus/source/libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","hash":"be365eca44760ce3fc9b377c43d4634958479c69","modified":1525337766246},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","hash":"942addaec4d3a60af33947a84a3d85f926015947","modified":1525337766246},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","hash":"b0e0bb5ef78db8b15d430d0b9be9d4329289a310","modified":1525337766246},{"_id":"themes/icarus/source/css/images/favicon.ico","hash":"eaf485c235ca3d83faf3d38064a6e0f1df3d14fa","modified":1534174777336},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff","hash":"6d7e6a5fc802b13694d8820fc0138037c0977d2e","modified":1525337766183},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff2","hash":"97e438cc545714309882fbceadbf344fcaddcec5","modified":1525337766183},{"_id":"themes/icarus/source/libs/jquery/2.1.3/jquery.min.js","hash":"17a740d68a1c330876c198b6a4d9319f379f3af2","modified":1525337766183},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.eot","hash":"965ce8f688fedbeed504efd498bc9c1622d12362","modified":1525337766167},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.ttf","hash":"61d8d967807ef12598d81582fa95b9f600c3ee01","modified":1525337766183},{"_id":"themes/icarus/source/libs/font-awesome/fonts/FontAwesome.otf","hash":"1b22f17fdc38070de50e6d1ab3a32da71aa2d819","modified":1525337766167},{"_id":"themes/icarus/source/css/images/angular.builders_cuadrado.png","hash":"c6ff75091e1be21bd66201d8140f51efb6aca175","modified":1563870246819},{"_id":"source/images/tutorial-angular-17_ssr.png","hash":"7032b7bcf7b37a4a9f1faf62d72e93eb8573cb0b","modified":1571235781051},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.svg","hash":"964e8dac2cee79c4b49b5bc300675773f6518812","modified":1525337766167},{"_id":"public/images/10-projects-dependency.png","hash":"50e06392969e81cb1d0ccee2bb081468abfbf37d","modified":1582558228644},{"_id":"public/images/11-projects-dependency.png","hash":"911ad572b0f88b91e7a9c8ea5154c6acd573fe8a","modified":1582558228644},{"_id":"public/images/12-class-dependency.png","hash":"090b9f9ea2e16dcd84893419aef76a49ffa5ca77","modified":1582558228644},{"_id":"public/images/13-class-dependency.png","hash":"767f139a86d8e9dfc7e9df5a5c94855c5e121cb4","modified":1582558228645},{"_id":"public/images/13-projects-dependency.png","hash":"241c853b667234c17e1e361d09d38b3372e8fac4","modified":1582558228645},{"_id":"public/images/change-detection.jpg","hash":"f68ec145e8d8436a777dedff3256f51b115b01f0","modified":1582558228645},{"_id":"public/images/ng2-Arbol-de-componentes.jpg","hash":"981461824a8b8c4be309e0f45b2f6e77b0ce3975","modified":1582558228645},{"_id":"public/images/ng2-Arbol-de-dependencias.jpg","hash":"4aa93110fbb2a84d15436432b103b369368411b9","modified":1582558228645},{"_id":"public/images/ng2-Component-DataFlow.jpg","hash":"b9a22cc89d665491b54e2d0e7a94bd6b19a11aa2","modified":1582558228645},{"_id":"public/images/ng2-DI-component-directive.jpg","hash":"55f9382deef44c734bf892571df3127f88871939","modified":1582558228645},{"_id":"public/images/ng2-DI-component-service.jpg","hash":"3e387e0e2b3b2bd40004b569f83cd2b74f3363e4","modified":1582558228645},{"_id":"public/images/ng2-Flujo-de-datos.jpg","hash":"b791adc0f1322b16145d23e2479fc0a1b95f5846","modified":1582558228646},{"_id":"public/images/ng2Component--1-.jpg","hash":"8e13a6985d532c4413ab8253d8e37edc3b2fcc7f","modified":1582558228646},{"_id":"public/images/tutorial-angular-5_inject.png","hash":"3dad3f82be4c3b7a47ff1bc40ae02590fb72bb56","modified":1582558228646},{"_id":"public/images/Redux.png","hash":"f2c65fea8a7e0d094089d9b396d151bb05707c9b","modified":1582558228646},{"_id":"public/images/pedidos_ms.PNG","hash":"0f029e34d708727a07c5cf29b76f739bcba45c76","modified":1582558228646},{"_id":"public/images/tutorial-angular-18_i18n.png","hash":"cd1b8f2513ef6de9605813180024006000434137","modified":1582558228646},{"_id":"public/images/tutorial-angular-19_elements.png","hash":"ccafe52077f447d2c2e62b3bcb9cdca592135769","modified":1582558228646},{"_id":"public/images/tutorial-angular-6_http.png","hash":"f9c72bf0deff3712524b6a0eff49fd60019f07e6","modified":1582558228647},{"_id":"public/images/tutorial-angular-8_reactive.png","hash":"621a29537d48cda980f8ede1270d0d2e902b341c","modified":1582558228647},{"_id":"public/images/tutorial-angular-7_watch.png","hash":"91d34a0dd059c403189fa3632a243e97d1ca06c6","modified":1582558228647},{"_id":"public/images/tutorial-angular-13_template.png","hash":"be97ed05d8cbc130e2f417e222a168c9661033db","modified":1582558228647},{"_id":"public/images/tutorial-angular-2_spa.png","hash":"c9ea2498d6334762fca7f491935fa45ae1e12675","modified":1582558228648},{"_id":"public/images/tutorial-angular-3_data.png","hash":"865bafd69f3fad2cb86c5ef2da66007a18360606","modified":1582558228648},{"_id":"public/images/tutorial-angular-4_flow.png","hash":"4a1a58487affa6e836dfecde1e0d21553aeed035","modified":1582558228648},{"_id":"public/images/tutorial-angular-0_cli.png","hash":"0b15754c7bd374a893b2ae1f04e629419b77fcd2","modified":1582558228648},{"_id":"public/images/tutorial-angular-10_monorepo.png","hash":"24ba64b432657f310c8aaa805515b057737f3fb1","modified":1582558228648},{"_id":"public/images/tutorial-angular-11_test.png","hash":"6d323e90c9a0589fec247b1d6f3e17744c9b88f5","modified":1582558228649},{"_id":"public/images/tutorial-angular-16_pwa.png","hash":"146490314f83d77ec8953b9ce7fc70ab99545554","modified":1582558228649},{"_id":"public/images/tutorial-angular-9_material.png","hash":"cbb67315f980af2771cde4deaa17341f9d327ddf","modified":1582558228649},{"_id":"public/images/light-new-year-s-eve-fireworks-sylvester-40663.jpg","hash":"1de27d29c03a751bc41c7ad9638e48e7886570a1","modified":1582558228649},{"_id":"public/images/tutorial-angular-12_change.png","hash":"0c5c5058371d6bd43058b6d9cd2e6457e1a5d406","modified":1582558228649},{"_id":"public/images/tutorial-angular-14_redux.png","hash":"ebec71c20203d1e3bab8cc7448c9e7a700160c54","modified":1582558228650},{"_id":"public/images/tutorial-angular-15_ngrx.png","hash":"38dd7f5377ffe9c256063cd9fb7a9776396c0fba","modified":1582558228650},{"_id":"public/images/tutorial-angular-1_base.png","hash":"733a3755501bd93af49e963b65002e2f05790ea6","modified":1582558228650},{"_id":"public/css/images/angular-0_cli.png","hash":"f76c60732d5c1949d28499c7790aff8c5c0a4838","modified":1582558228650},{"_id":"public/css/images/angular-10_monorepo.png","hash":"752b3e8f7a5f6c440b1d83533abe523bfeb055df","modified":1582558228651},{"_id":"public/css/images/angular-11_test.png","hash":"4bb3634f258a2a641b953045459b63faa039c561","modified":1582558228651},{"_id":"public/css/images/angular-12_change.png","hash":"3759cbe2cc08ce9e6de52e6804ff70be47e165ad","modified":1582558228651},{"_id":"public/css/images/angular-13_template.png","hash":"25f25375bf6767d3cc413dfbbdd80d54b038d4b0","modified":1582558228651},{"_id":"public/css/images/angular-14_redux.png","hash":"cbf8ab0ec57d0bd2cfb01a93b86903144661e4b6","modified":1582558228651},{"_id":"public/css/images/angular-15_ngrx.png","hash":"b4f9e0de9617c0011dfb7ee6e411d78e07d46d93","modified":1582558228651},{"_id":"public/css/images/angular-16_pwa.png","hash":"1bc78c870df6b7620c5d40a00489d790b5776b0a","modified":1582558228651},{"_id":"public/css/images/angular-17_ssr.png","hash":"f52badc2fb8eacdbc4998295b37b210b6d50ea9e","modified":1582558228651},{"_id":"public/css/images/angular-19_elements.png","hash":"c807aef5af0a083b4b22bf17e9bf1d73a1435140","modified":1582558228651},{"_id":"public/css/images/angular-1_base.png","hash":"fb71a1fca4f50b1e7fe7af0deac4bd09bc3a87d3","modified":1582558228651},{"_id":"public/css/images/angular-18_i18n.png","hash":"479705bb9c07887be4dac1776c904409c53bcbb6","modified":1582558228651},{"_id":"public/css/images/angular-2_spa.png","hash":"339ff8549c88a8c26a79d7b0b6d92947792d3ccf","modified":1582558228652},{"_id":"public/css/images/angular-3_data.png","hash":"66d3af6a40a7a0d1b57aec8275223fa84dcf5c79","modified":1582558228652},{"_id":"public/css/images/angular-4_flow.png","hash":"61c81d8980240105c15a085d6b9bded74fdd4ad3","modified":1582558228652},{"_id":"public/css/images/angular-5_inject.png","hash":"e5214d29c3123b4b993a7f0b5012aa09979645ef","modified":1582558228652},{"_id":"public/css/images/angular-6_http.png","hash":"5e41adeae5cb206e5a13ee7e1578528fe65e3ffb","modified":1582558228652},{"_id":"public/css/images/angular-7_watch.png","hash":"a554b06b830a246aa710878258e970111473257e","modified":1582558228652},{"_id":"public/css/images/angular-8_reactive.png","hash":"905818fc5d768340e64f2cc45e72c64233736569","modified":1582558228652},{"_id":"public/css/images/angular-9_material.png","hash":"d0ae8fe3865ee3d6edc924ecd9c17284596f7852","modified":1582558228652},{"_id":"public/css/images/angular.builders.png","hash":"1a17b0b730a318d10c28cbd937fd31e2747c158e","modified":1582558228652},{"_id":"public/css/images/angular_18_i18n.png","hash":"6eda0d455655650e501307b7e372b8a5165eb2bd","modified":1582558228652},{"_id":"public/css/images/avatar.jpg","hash":"f5cce34d891789ed4982cd8ebc64ad8d4f402e38","modified":1582558228652},{"_id":"public/css/images/angular.jpg","hash":"6e341e706f0b6f27dc9ba93efe56621409e4304f","modified":1582558228652},{"_id":"public/css/images/thumb-default-small.png","hash":"e63874a08229a3031c407915ca448ca9d3ab234f","modified":1582558228652},{"_id":"public/css/images/logo.png","hash":"ac0fa5cf38f9211089dce5486a3ae7d666dc5db1","modified":1582558228653},{"_id":"public/css/images/typescript.jpg","hash":"eb636fe8bea5b21d8f92b430c6492166ff21e30f","modified":1582558228653},{"_id":"public/libs/lightgallery/fonts/lg.svg","hash":"0d20ced713d03f14fb4966e984c6ab4b12694591","modified":1582558228653},{"_id":"public/libs/lightgallery/img/loading.gif","hash":"66532a70bf3f0b148846ea98ae20f0577a7cf99a","modified":1582558228653},{"_id":"public/css/images/angular.builders_cuadrado.png","hash":"02f110bc3f32c3e5e193334accecd0a8f0a361a3","modified":1582558228653},{"_id":"public/images/tutorial-angular-17_ssr.png","hash":"339c09b3aaa00df8aad48c4298187d18f62d1bec","modified":1582558228653},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.svg","hash":"6aea5705bf22ea3815773da476d3f6e8fadb9c26","modified":1582558228653},{"_id":"public/sitemap.xml","hash":"2ffa5a0b997f9cc705256ec9905bfacc77022940","modified":1603785699289},{"_id":"public/content.json","hash":"a7f3b8836afb31f69dc9511bbe8aa9d4cf573d30","modified":1603785699289},{"_id":"public/archives/2015/index.html","hash":"b4bbf83e5ba00eba99261f8783af9fa8a5198873","modified":1599819028637},{"_id":"public/archives/2015/08/index.html","hash":"8254bd698b375ca0794a7efe2ea5e7f127090072","modified":1599819028637},{"_id":"public/archives/2016/01/index.html","hash":"2c9ea08750048af818b97e415f702b88bdcce68c","modified":1599819028637},{"_id":"public/archives/2016/03/index.html","hash":"2a976772ca381ad4396d7bce98364e053c7ab8d4","modified":1599819028637},{"_id":"public/archives/2016/04/index.html","hash":"7288d2faac499fcb47a3e08df802371ae97d8083","modified":1599819028637},{"_id":"public/archives/2016/05/index.html","hash":"0117f06f56248f97d5bdbfead1188045176acd17","modified":1599819028637},{"_id":"public/archives/2017/index.html","hash":"b6539ce7c036624d47c2d4b43a19382549c7c047","modified":1599819028637},{"_id":"public/archives/2017/03/index.html","hash":"fb0d2b4f56342a2d6dfdaff3908a63bac0821f23","modified":1599819028637},{"_id":"public/archives/2020/index.html","hash":"5b093adada90a890ceed834e6e46592e526944f7","modified":1599819028644},{"_id":"public/archives/2020/02/index.html","hash":"ee90b2a0045cc75b6911ca9a718de8615695d24f","modified":1599819028637},{"_id":"public/categories/Angular/index.html","hash":"90ac51c2feadb5564d2db6567d7a05dc0c705860","modified":1599819028639},{"_id":"public/tag/BackEnd/index.html","hash":"83241e2ac6613919c53d631025806ed0b1871a45","modified":1599819028637},{"_id":"public/tag/MongoDB/index.html","hash":"0a1523cb99fd431f12a5cce246773212d15c64fe","modified":1599819028637},{"_id":"public/tag/FrontEnd/index.html","hash":"27d95c3247be1c018584b2e2858be0575a0c0a09","modified":1599819028637},{"_id":"public/tag/AngularJS/index.html","hash":"99088de707b3bcb6a1a13a49d0dc2867e7b7898c","modified":1599819028638},{"_id":"public/tag/TypeScript/index.html","hash":"f569483c610ffaf75b4f651cf4b25dd1e72a13ae","modified":1599819028637},{"_id":"public/tag/Angular9/index.html","hash":"8d8d9e5403c0928d933752ffb07a2f744103e7e8","modified":1599819028645},{"_id":"public/tag/Ivy/index.html","hash":"6150e035be374b5564d4a5308c9ed1893a49bbbb","modified":1599819028638},{"_id":"public/tag/Avanzado/page/2/index.html","hash":"a71bac1daf9942ebf178720b4c9cbba290a02ded","modified":1599819028638},{"_id":"public/404.html","hash":"f760bf66dfa40cf3e685d97895015a0dc49faed5","modified":1599819028639},{"_id":"public/angular_9-original-clean.html","hash":"f90bfbcce8cf631cdbe0230ff4c388b4a6d3a14d","modified":1599819028639},{"_id":"public/angular_9-translate.html","hash":"1f58496383b80f9de52aa17194aa5d60947a3577","modified":1599819028639},{"_id":"public/cookies.html","hash":"fbeb23ce39d9b4bcb285d085f48465436d0b44b4","modified":1599819028639},{"_id":"public/cursos/angular-basic.html","hash":"1c3265b2ca6905e24194562d149767f6bc96da42","modified":1599819028639},{"_id":"public/contacto.html","hash":"9511785cad7a47379f1903ba84a8e8b511ce77a2","modified":1599819028640},{"_id":"public/cursos/angular-business.html","hash":"647fa69821863d5a89f90f7cdf3c852bda849922","modified":1599819028640},{"_id":"public/cursos.html","hash":"d6f2a2099d44e07eb3b975630ec05b4facd3e07a","modified":1599819028640},{"_id":"public/noticias-junio-16.html","hash":"6df792188a032ac177eb6e31a57b010929def626","modified":1599819028640},{"_id":"public/promociones.html","hash":"9d57a0eab1fe677ca177b3f3c9e59e2d5d533d88","modified":1599819028640},{"_id":"public/scaffolds/draft.html","hash":"f9e7d8fbe67beb11ef810af9820edc47c57baa4b","modified":1599819028640},{"_id":"public/scaffolds/post.html","hash":"9d224a09d7c58b5e246b9247ce2da04af0ba5b36","modified":1599819028641},{"_id":"public/scaffolds/page.html","hash":"4bf0e503690184fd882f0cb24316582e3232926a","modified":1599819028641},{"_id":"public/un-vistazo-a-las-caractersticas-principales-en-el-lanzamiento-de-Angular-Ivy-versin-9/index.html","hash":"150a8e7ed8debe0da6481eaa8134d80258f852f9","modified":1599819028642},{"_id":"public/elementos-Angular-para-los-Web-Components/index.html","hash":"6bb9241d6a0b8559a2974bc588af12192bad9607","modified":1599819028642},{"_id":"public/internacionalizacion-y-puesta-en-produccion-con-Angular/index.html","hash":"c4fd8aa66b0ff961f92c71aed6f7634197987e98","modified":1599819028642},{"_id":"public/velocidad-y-seo-con-el-ssr-de-angular-universal/index.html","hash":"71b4ced9f80b31d4ca88ab35091c6a0ff9742ad6","modified":1599819028642},{"_id":"public/pwa-entre-la-web-y-las-apps-con-angular/index.html","hash":"ab956eb2d352071f767930d49d142a70ccb86708","modified":1599819028642},{"_id":"public/el-patron-redux-con-ngrx-en-angular/index.html","hash":"32680b5f5393066453a0c27fcfca9afc84cabf46","modified":1599819028642},{"_id":"public/base-aplicacion-angular/index.html","hash":"fd9e51766af770e963da955bfb2f9070f3f6f796","modified":1599819028642},{"_id":"public/hola-angular-cli/index.html","hash":"35372f8b0abffa5fce7de86f9e05eed82b1fed2c","modified":1599819028642},{"_id":"public/flujo-reactivo-unidireccional-con-Angular-y-RxJs/index.html","hash":"fff2cb57d506394d1f7e7b95c91d59feb01a828f","modified":1599819028642},{"_id":"public/componentes-dinamicos-directivas-y-pipes-con-Angular/index.html","hash":"0de9d76d71b8607c67c7281c18ec6c2ad3f6d324","modified":1599819028643},{"_id":"public/deteccion-del-cambio-en-Angular/index.html","hash":"3cbf040c6b3d9d02a49d93ba325d55eb4c605ea9","modified":1599819028643},{"_id":"public/tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular/index.html","hash":"109dc8813f74a7aff793c2bf610042b985ba22c3","modified":1603785699293},{"_id":"public/nx-mono-repositorios-en-Angular/index.html","hash":"73352c07aca7990ab181b68ea8a9b02656ceae6f","modified":1599819028643},{"_id":"public/Material-Design-y-CLI-de-Angular/index.html","hash":"eda9e06d13da772c1bfe98b542849fe81ccf8df2","modified":1599819028643},{"_id":"public/formularios-reactivos-con-Angular/index.html","hash":"683780195426fb0b568927f2fb01401c22ec7e0b","modified":1599819028643},{"_id":"public/vigilancia-y-seguridad-en-Angular/index.html","hash":"a1b056cb61aea43df0af2e680aeec38ea7200968","modified":1599819028641},{"_id":"public/comunicaciones-http-en-Angular/index.html","hash":"859a8abe2bc45b4261c180cb44eda4ce5c2980ac","modified":1599819028641},{"_id":"public/servicios-inyectables-en-Angular/index.html","hash":"2dd6feb5aa4e942b6e52a2cacdf0edb3b5ee42f4","modified":1599819028641},{"_id":"public/flujo-de-datos-entre-componentes-angular/index.html","hash":"aeb3e8fc281a5153bb27c0fc9b498051b43a5b84","modified":1599819028641},{"_id":"public/formularios-tablas-y-modelos-de-datos-en-angular/index.html","hash":"a950824ee3dfc006314c3a1f3ca463e7a5a8c499","modified":1599819028641},{"_id":"public/paginas-y-rutas-angular-spa/index.html","hash":"373cad6975b42326b07fa1c137d0030ed6e7c3ec","modified":1599819028642},{"_id":"public/typescript-programa-en-el-front-igual-que-en-el-back/index.html","hash":"2ec4142b5dc3ece10f1d0b3f156ded5e54d25e66","modified":1599819028643},{"_id":"public/node-6-0-0-actualizacion-con-nvm/index.html","hash":"7499ea25c4d7661d09df388d64f35924028c4a80","modified":1599819028643},{"_id":"public/npm-de-instalador-a-publicador/index.html","hash":"f5a86a43ff6d1645b460c346f2e1f5e1ea63258e","modified":1599819028643},{"_id":"public/soluciones-frontend-2016/index.html","hash":"8edb164e8816cfb4ccd4412f5cac1ea188cb1b14","modified":1599819028643},{"_id":"public/soluciones-backend-2016/index.html","hash":"5dfb38d8a96f831ce5c390765f72f75055b259f5","modified":1599819028643},{"_id":"public/para-que-puedo-usar-nodejs/index.html","hash":"e5b47393a2d213a4c7707fead652a3375833fda8","modified":1599819028643},{"_id":"public/archives/index.html","hash":"071a89d46b48e9dec8da1b52a12a862dd585afe2","modified":1599819028644},{"_id":"public/archives/page/2/index.html","hash":"7adb7157ff3501e143a924ce901c69ab6fd4c6d3","modified":1599819028644},{"_id":"public/archives/page/3/index.html","hash":"73d2c1590194efbb10d2ee38ca7f457eb5d73499","modified":1599819028644},{"_id":"public/archives/2016/index.html","hash":"226ba1b09b9bc8e867d8761d606dcd9075d7d104","modified":1599819028644},{"_id":"public/archives/2019/index.html","hash":"62da491db9a06273b252bc82c96b020268a67904","modified":1599819028644},{"_id":"public/archives/2019/page/2/index.html","hash":"0dc8ebed84e98fb5b9e51bdfc2214181d313fa3b","modified":1599819028644},{"_id":"public/archives/2019/01/index.html","hash":"8e009efb30ed2df6fe23cf5dc77ab2385b1d3452","modified":1583600228166},{"_id":"public/archives/2019/02/index.html","hash":"16b0bc28b701356011b0ded2c6cf464240c5391f","modified":1587112585406},{"_id":"public/archives/2019/03/index.html","hash":"60fbba822829dabbd8ebd38208f6a240ad0e00bf","modified":1599819028644},{"_id":"public/archives/2019/09/index.html","hash":"ed2fc58d0c251d909c116a6d4ee3b5e9e683a2b1","modified":1599819028644},{"_id":"public/archives/2019/10/index.html","hash":"c9bcc1fcad232a7302b8c07f7682ea05316ac37a","modified":1599819028644},{"_id":"public/categories/Tutorial/index.html","hash":"a244df28d7f0fd03f98d3df883e4825c4f064e83","modified":1599819028648},{"_id":"public/categories/Tutorial/page/2/index.html","hash":"0c28718feb57b4b55c2bc333d86a65410e38d483","modified":1599819028648},{"_id":"public/categories/Tutorial/Angular/index.html","hash":"a0f40ff83532731f9e6e12cb06b7cfb200f09a7c","modified":1599819028648},{"_id":"public/categories/Tutorial/Angular/page/2/index.html","hash":"65dd33549118fbf55f5bd9d05c5386052ceb93b8","modified":1599819028648},{"_id":"public/index.html","hash":"728c28b34bd68e174abbdca66baa6fc1a5beb2a8","modified":1599819028644},{"_id":"public/page/2/index.html","hash":"ce6396a2ccd2c21fe5cc4ce3b62fbcc691adf58e","modified":1599819028644},{"_id":"public/page/3/index.html","hash":"ee2351a5da537259d0fe026909b373655b64b8bc","modified":1599819028645},{"_id":"public/page/4/index.html","hash":"304872ec84d0a42bccc18fae96afe21ce2e5abec","modified":1599819028645},{"_id":"public/page/5/index.html","hash":"35a630143f73d1c7e666b2b2e6b0e97410ed3851","modified":1599819028645},{"_id":"public/page/6/index.html","hash":"9434ea71fea765e2503fd646c75061977e00800c","modified":1599819028645},{"_id":"public/tag/NodeJS/index.html","hash":"c9f52ccf9cda6c36e76bd9626c02c216883fb93d","modified":1599819028645},{"_id":"public/tag/Introduccion/index.html","hash":"fd53ef0ed52f38c4e7393710481ae2a30a0d78af","modified":1599819028645},{"_id":"public/tag/Introduccion/page/2/index.html","hash":"a5f138e1e0fa85d939932e95fc136efc502c85d9","modified":1599819028645},{"_id":"public/tag/Opinion/index.html","hash":"c5ccb86002acd1a86c8f780acd3f70fadbd921a3","modified":1599819028645},{"_id":"public/tag/Angular/index.html","hash":"6b091df9be8880d0e85f4245a73a43ae8bbd93a8","modified":1599819028645},{"_id":"public/tag/Angular/page/2/index.html","hash":"e3a50e918a718d35e44de3da90922c93c81a1ef9","modified":1599819028645},{"_id":"public/tag/Angular/page/3/index.html","hash":"8c8ac98a34d807ca2b93f7bd441fad88bd319038","modified":1599819028645},{"_id":"public/tag/Angular8/index.html","hash":"4e6e74a216a1bb63ffba131d9cc212b32d77923c","modified":1599819028646},{"_id":"public/tag/Angular8/page/2/index.html","hash":"f34c5e1e248a1d7da1ac5023ae2e481fa4a7f80a","modified":1599819028646},{"_id":"public/tag/Nx/index.html","hash":"e176a5b0c9cc2c5b59980098a0f13822aa1b03f0","modified":1599819028646},{"_id":"public/tag/Tutorial/index.html","hash":"dfe6d67f45d28d0e3dabec44c1b63bbaa7701ba4","modified":1599819028646},{"_id":"public/tag/Tutorial/page/2/index.html","hash":"eb55521c5e5d605a361dd281463daa298ae7837a","modified":1599819028646},{"_id":"public/tag/Avanzado/index.html","hash":"4da106eb71bc3f78efbcb3f43398d47cd0830419","modified":1599819028646},{"_id":"public/tag/Test/index.html","hash":"735f73ef67435140b39cee164960bf109409a408","modified":1599819028646},{"_id":"public/tag/Jest/index.html","hash":"69a546f2ef7c08382bc456d1bbad728718eba4f2","modified":1599819028646},{"_id":"public/tag/Cypress/index.html","hash":"214fb7d79ba5c17eb7d31ae87ecbe860d1e4c9e0","modified":1599819028646},{"_id":"public/tag/ChangeDetection/index.html","hash":"ae5b095bc9e848b72a8974f2a0ae90cfd70580ed","modified":1599819028646},{"_id":"public/tag/Observables/index.html","hash":"ce44dfaa109125ecd7099196edbbcd7d9875a2b2","modified":1599819028646},{"_id":"public/tag/Template/index.html","hash":"d2a09ef5ac238a0e39f370e318349caa8de72333","modified":1599819028638},{"_id":"public/tag/Redux/index.html","hash":"033e038516d5988205d8c50c041c3566d6c7bd5c","modified":1599819028646},{"_id":"public/tag/RxJs/index.html","hash":"d1670cd4821740ee81a3a67e9016436aa1132490","modified":1599819028646},{"_id":"public/tag/Angular2/index.html","hash":"d141aeff8a463dd1e1c2be2a00618b9bb0119619","modified":1599819028646},{"_id":"public/tag/Angular2/page/2/index.html","hash":"40664e4bcdab62ef93df54b83c0060316a961bf6","modified":1599819028646},{"_id":"public/tag/NgRx/index.html","hash":"f6479f6a9b65beaaa04dd7d754be52c3734074de","modified":1599819028646},{"_id":"public/tag/Universal/index.html","hash":"f97ebbedd7ce0aaf2dc0372ee66cfeae7a420cff","modified":1599819028647},{"_id":"public/tag/SSR/index.html","hash":"8b3a16136f8b01994cc2a714fd9927c76b1446da","modified":1599819028647},{"_id":"public/tag/i18n/index.html","hash":"919b3bdb3431934ab7c66fef0aef5c6c8ee5dabe","modified":1599819028647},{"_id":"public/tag/Elements/index.html","hash":"e2cb1ae0c5dfee7090ad00da622782ead572d7f3","modified":1599819028647},{"_id":"public/tag/WebComponents/index.html","hash":"6a5a1418e8934f3d5ded76acc5c298ba1c78fd47","modified":1599819028647},{"_id":"public/tag/Forms/index.html","hash":"1b3fba0faaac2bbadd568edb96146fbea79f7056","modified":1599819028647},{"_id":"public/tag/Components/index.html","hash":"935f5ff6fb5b997625d32090012d1407728d4acb","modified":1599819028648},{"_id":"public/tag/Servicios/index.html","hash":"91fe92080839040fef05b410235d84d38e00dab2","modified":1599819028648},{"_id":"public/tag/DI/index.html","hash":"6ad4d239c8cffedf11ddd32ccd68b41aa6424b5f","modified":1599819028638},{"_id":"public/tag/http/index.html","hash":"c2014335ed42620ae0b8c87ff3709aa53a2de5db","modified":1599819028648},{"_id":"public/tag/RxJS/index.html","hash":"f42d0fcd82734e29567a115ca92d892791c4dd7b","modified":1599819028648},{"_id":"public/tag/reactiveForms/index.html","hash":"51f2d2c522d7b3f09c023361ab9159de90e0e325","modified":1599819028638},{"_id":"public/tag/Angular7/index.html","hash":"bd1552314f9caeb0a0facdf49bc8ba08ca7c3165","modified":1599819028638},{"_id":"public/tag/material/index.html","hash":"6860eb2708f428f03e576ed441eb2c58c8ac1be7","modified":1599819028638},{"_id":"public/tag/CLI/index.html","hash":"811d6f227d8ce9fffbefa6cd8f71ee186b55c8ca","modified":1599819028648},{"_id":"public/tag/SPA/index.html","hash":"e7da57e26ec9ad08ba08361e00411a2a6e49650e","modified":1599819028639},{"_id":"public/tag/Routing/index.html","hash":"38ffaf63a10c7ca373e5b42267850965bfdc8d4b","modified":1599819028638},{"_id":"public/tag/PWA/index.html","hash":"765832b9aa3997f39cfa16d91f47d7acb36c44c7","modified":1599819028638},{"_id":"public/images/12-projects-dependency.png","hash":"4456a09bade67f87e690a380f7acecc3f59cbe75","modified":1582558228859},{"_id":"public/libs/lightgallery/css/lg-fb-comment-box.css.map","hash":"5281d2cfb0ef278940c4860ea9aa7ef86d3dbc8d","modified":1582558228859},{"_id":"public/libs/lightgallery/css/lg-transitions.css.map","hash":"6ee19f99bca3ecf2fa0d6f07fb5c200db07ddd11","modified":1582558228860},{"_id":"public/libs/lightgallery/css/lightgallery.css.map","hash":"91788030e3c7107b6b4bf50a82d4309368850488","modified":1582558228860},{"_id":"public/libs/lightgallery/fonts/lg.eot","hash":"54caf05a81e33d7bf04f2e420736ce6f1de5f936","modified":1582558228860},{"_id":"public/libs/lightgallery/fonts/lg.ttf","hash":"f6421c0c397311ae09f9257aa58bcd5e9720f493","modified":1582558228860},{"_id":"public/libs/lightgallery/fonts/lg.woff","hash":"3048de344dd5cad4624e0127e58eaae4b576f574","modified":1582558228861},{"_id":"public/libs/lightgallery/img/video-play.png","hash":"3ea484cdc04d2e4547f80cbf80001dcf248c94ef","modified":1582558228861},{"_id":"public/libs/lightgallery/img/vimeo-play.png","hash":"6190254f2804904a4a1fa1eb390dfd334e416992","modified":1582558228861},{"_id":"public/libs/lightgallery/img/youtube-play.png","hash":"fea6df9d9d43151f9c9d15f000adb30eb3e26fc4","modified":1582558228861},{"_id":"public/libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","hash":"e0350190d720a8fec0557ab47b318ec4e4486448","modified":1582558228861},{"_id":"public/libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","hash":"2c5b039b57f62625e88226a938679ec937431ad1","modified":1582558228862},{"_id":"public/libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","hash":"c4248ea800bd5608344ce163f5658b57e7ef9410","modified":1582558228862},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","hash":"22413bb8bfb78608c1e25aa1ed5c1f38557df79f","modified":1582558228863},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","hash":"63eb74ef040aade256f2274a7f31a914edddb0ea","modified":1582558228863},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","hash":"328a22fe3eec71ad9e5ece4d67dd62e79dab6b7f","modified":1582558228863},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","hash":"4dc6d7174ea6d89f4c45e43e1bfc3e03d8ffebaf","modified":1582558228864},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","hash":"415eee05976ab8b2471602a5ddb78a6c58fc21aa","modified":1582558228864},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","hash":"a0b0c389cf46d63c850e61fed572485ff0b68183","modified":1582558228864},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","hash":"c5f29fed6632efe0aa83318369f0d8c4061b775b","modified":1582558228864},{"_id":"public/libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","hash":"be201d32a9aa5d186723ebb3c538be691aa8c53a","modified":1582558228865},{"_id":"public/libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","hash":"afc44700053c9a28f9ab26f6aec4862ac1d0795d","modified":1582558228865},{"_id":"public/libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","hash":"113978181dcac77baecef6115a9121d8f6e4fc3a","modified":1582558228865},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","hash":"5067c81462c15422853c94d21a1726865a61634f","modified":1582558228866},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","hash":"b366f2fda2e524eb5ef50058eefff249a3b96e6c","modified":1582558228866},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","hash":"d22904914469be735490e3c8cb093c7862896dd5","modified":1582558228866},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","hash":"ae80fb3cd16339aa7b5da280ab53975523dcaac2","modified":1582558228866},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","hash":"b85efde42fa3a03c32b1d31c6cd74c622fc7916c","modified":1582558228866},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","hash":"e75607ba1417181397c700775b84303d5a2957b9","modified":1582558228866},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","hash":"d0b40a7848703556c6631f24e961a98ca5829255","modified":1582558228866},{"_id":"public/libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","hash":"be365eca44760ce3fc9b377c43d4634958479c69","modified":1582558228866},{"_id":"public/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","hash":"942addaec4d3a60af33947a84a3d85f926015947","modified":1582558228866},{"_id":"public/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","hash":"b0e0bb5ef78db8b15d430d0b9be9d4329289a310","modified":1582558228867},{"_id":"public/images/draw-horse.jpeg","hash":"9b7c94d3a9417ee722955dd3bc8462de1ecb62d0","modified":1582558231734},{"_id":"public/css/images/favicon.ico","hash":"eaf485c235ca3d83faf3d38064a6e0f1df3d14fa","modified":1582558231734},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.woff","hash":"6d7e6a5fc802b13694d8820fc0138037c0977d2e","modified":1582558231735},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.woff2","hash":"97e438cc545714309882fbceadbf344fcaddcec5","modified":1582558231735},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.eot","hash":"965ce8f688fedbeed504efd498bc9c1622d12362","modified":1582558231735},{"_id":"public/libs/font-awesome/fonts/FontAwesome.otf","hash":"1b22f17fdc38070de50e6d1ab3a32da71aa2d819","modified":1582558231735},{"_id":"public/js/insight.js","hash":"1f3065c16ca33cd3768c1082c2a306fab25c5829","modified":1582558231779},{"_id":"public/js/main.js","hash":"1637a63b30d1ca9bcf2be3e7584ad491d9cd9914","modified":1582558231779},{"_id":"public/libs/justified-gallery/justifiedGallery.min.css","hash":"13fbcba5e97aa88b748d94d3efc4718475279907","modified":1582558231779},{"_id":"public/libs/open-sans/styles.css","hash":"84cd5aaa2f93a70da5304b8cfef6c9892ecd40ec","modified":1582558231780},{"_id":"public/libs/source-code-pro/styles.css","hash":"0cddee03d83de49c9ec47c799b1136d08d3187ed","modified":1582558231780},{"_id":"public/libs/lightgallery/css/lg-fb-comment-box.css","hash":"81846a8175c096454286c6659b5acd530e610ec8","modified":1582558231780},{"_id":"public/libs/lightgallery/css/lg-fb-comment-box.min.css","hash":"05830fadb8454f39dcc98c8686eb4d5c24b71fc0","modified":1582558231780},{"_id":"public/libs/lightgallery/js/lg-autoplay.min.js","hash":"d845741bcaf961579622880eb2a445257efad1ac","modified":1582558231780},{"_id":"public/libs/lightgallery/js/lg-autoplay.js","hash":"d78075c9f4605717b916d6ee76997db0af74943a","modified":1582558231780},{"_id":"public/libs/lightgallery/js/lg-fullscreen.js","hash":"22ceb1248a5d19add69f2d1e4f7dba688d5f6f58","modified":1582558231780},{"_id":"public/libs/lightgallery/js/lg-hash.js","hash":"3a8b634c001fdaa3ee336b2e8f2156a3e80224f0","modified":1582558231780},{"_id":"public/libs/lightgallery/js/lg-fullscreen.min.js","hash":"b6b9e4022700b7faf2a5a175ba44a3bd938fdd20","modified":1582558231780},{"_id":"public/libs/lightgallery/js/lg-pager.js","hash":"0ade7ecad16b59578e9cb39e1d5ae9d4e13afd25","modified":1582558231780},{"_id":"public/libs/lightgallery/js/lg-hash.min.js","hash":"43f1e1e720ab0e241c19b83aa26bd6848eab8edc","modified":1582558231780},{"_id":"public/libs/lightgallery/js/lg-pager.min.js","hash":"25caa6ff65b1c6dee09941e795ae2633bdbab211","modified":1582558231780},{"_id":"public/libs/lightgallery/js/lg-share.js","hash":"1403ae89d922b8fc609165d21c8b80dd9237e33e","modified":1582558231780},{"_id":"public/libs/lightgallery/js/lg-share.min.js","hash":"39c615f07c5d3aaa65a2c3068a30fdd6dd5c372d","modified":1582558231781},{"_id":"public/libs/lightgallery/js/lg-thumbnail.js","hash":"6812ad2ff56a86609a9fd9a30e16fd3b52589af1","modified":1582558231781},{"_id":"public/libs/lightgallery/js/lg-thumbnail.min.js","hash":"18dd7d2909d1bfd6852f031d03e774b4428c512b","modified":1582558231781},{"_id":"public/libs/lightgallery/js/lg-video.js","hash":"f78227128ac5a8412deeb37e4045908e073e3875","modified":1582558231781},{"_id":"public/libs/lightgallery/js/lg-zoom.js","hash":"76e60fb3add979bc8245321357305c151d698bf6","modified":1582558231781},{"_id":"public/libs/lightgallery/js/lg-video.min.js","hash":"032c001ab045a69856f9c3ed4a2a3bf12a8e310f","modified":1582558231781},{"_id":"public/libs/lightgallery/js/lg-zoom.min.js","hash":"15b49f9728439819ece15e4295cce254c87a4f45","modified":1582558231781},{"_id":"public/css/style.css","hash":"f79de7642d4cd04654fcc3cc11600f86cb51626f","modified":1582558231781},{"_id":"public/libs/justified-gallery/jquery.justifiedGallery.min.js","hash":"b2683e7a872bc109b1756a65188a37cef7d0bd5c","modified":1582558231781},{"_id":"public/libs/font-awesome/css/font-awesome.css","hash":"f9ae1cab2f0ceeea9e8dd0df2e9792e4f08fb107","modified":1582558231781},{"_id":"public/libs/font-awesome/css/font-awesome.min.css","hash":"7cd5a3384333f95c3d37d9488ad82cd6c4b03761","modified":1582558231781},{"_id":"public/libs/lightgallery/css/lg-transitions.css","hash":"7e856f16b01b19a8bdb3bfbd7d2304d330ee0066","modified":1582558231781},{"_id":"public/libs/lightgallery/css/lg-transitions.min.css","hash":"5c22e2073a4c96d6212c72135391b599e8d1359f","modified":1582558231781},{"_id":"public/libs/lightgallery/css/lightgallery.css","hash":"18795fa809cc5371461f85ca3830fa4b9cfb7acd","modified":1582558231782},{"_id":"public/libs/lightgallery/css/lightgallery.min.css","hash":"c9a2e19c932b56f4a2ce30c98910d10b74edb38a","modified":1582558231782},{"_id":"public/libs/lightgallery/js/lightgallery.js","hash":"d4d06d82c4110eb241df46d22944febe4874d4f2","modified":1582558231782},{"_id":"public/libs/lightgallery/js/lightgallery.min.js","hash":"956ef9b706755318da69ad0b5d7786339d831251","modified":1582558231782},{"_id":"public/libs/jquery/2.1.3/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1582558231782},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.ttf","hash":"61d8d967807ef12598d81582fa95b9f600c3ee01","modified":1582558231782},{"_id":"public/post-sitemap.xml","hash":"df02ecf4911d4d242ed31daad47e42b2a87f0bcc","modified":1603785699288},{"_id":"public/page-sitemap.xml","hash":"b6327175aedd503d48b817e49147b2681ede573d","modified":1599819028631},{"_id":"public/category-sitemap.xml","hash":"8cedd44f10d4e430be7a71930c190d6ac33edf28","modified":1603785699288},{"_id":"public/tag-sitemap.xml","hash":"e0a1f7f714baff7956742b9a31699ea7323f2cb6","modified":1603785699288},{"_id":"public/sitemap.xsl","hash":"4321fa69dc1b8811d32b7a1478e5603e038cea1a","modified":1599819028631},{"_id":"public/archives/2020/03/index.html","hash":"871477c0659d8cd70de4854242f432f1c2a6da52","modified":1599819028644},{"_id":"source/_posts/___ng_2-Paginas-y-rutas-Angular-SPA copy.txt","hash":"7fbbbcb2ca560dec0b6066a6d6861c0a78e7b06d","modified":1583599933922},{"_id":"source/_posts/___ng-3-Formularios-tablas-y-modelos-de-datos-en-Angular copy.txt","hash":"6c9dc61b538fe35a81973d591d06cc36c1b79b98","modified":1583858771311},{"_id":"public/archives/2020/04/index.html","hash":"3cdceab315a600e8a9629253c7fadd2af60ff91b","modified":1599819028644},{"_id":"source/_posts/___ng-6-comunicaciones-http-en-angular copy.txt","hash":"cd67fc629191eb7a9d0ef237d515a2fad1932006","modified":1587201100157},{"_id":"source/_posts/___ng-7-Vigilancia-y-seguridad-en-Angular copy.txt","hash":"a190ab8231b2fd90ce6a63e822c25b97e29e29e4","modified":1587287723369},{"_id":"themes/icarus/source/css/images/Angular_Bootcamp_Cruise.png","hash":"0cf253e7fab5f3c5c2708becba8cbd240208a0a4","modified":1599818107114},{"_id":"themes/icarus/source/css/images/Angular_Bootcamp.png","hash":"d1532ba5e0a01190a7fee3b5b13a14c0cbe83e73","modified":1599818823186},{"_id":"public/css/images/Angular_Bootcamp_Cruise.png","hash":"78b6d1f4629f8d011ee0fc9a6a2901d837b7ecbf","modified":1599819028631},{"_id":"public/css/images/Angular_Bootcamp.png","hash":"637a2c59a335b5a2c4f3b0c0e893b0769bce5a75","modified":1599819028631}],"Category":[{"name":"Angular","_id":"ck70mab2o0015bss3sd2qmzln"},{"name":"Tutorial","_id":"ck70mab2r0017bss3er8mlt2u"},{"name":"Angular","parent":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab61005tbss3lc7oeupq"}],"Data":[],"Page":[{"layout":"page","title":"404 No encontrado","comments":0,"_content":"\n> Lo sentimos, la ruta no se ha encontrado.\n> Por favor, dirgete al [inicio del blog](../)\n> -- <cite>El equipo de Academia Binaria</cite>\n\n---\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","source":"404.md","raw":"---\npermalink: /404.html\nlayout: page\ntitle: 404 No encontrado\ncomments: false\n---\n\n> Lo sentimos, la ruta no se ha encontrado.\n> Por favor, dirgete al [inicio del blog](../)\n> -- <cite>El equipo de Academia Binaria</cite>\n\n---\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","date":"2018-05-03T08:56:05.754Z","updated":"2018-05-03T08:56:05.754Z","path":"/404.html","_id":"ck70maaxq0000bss3g49xplfw","content":"<blockquote><p>Lo sentimos, la ruta no se ha encontrado.<br>Por favor, dirgete al <a href=\"../\">inicio del blog</a><br> <cite>El equipo de Academia Binaria</cite></p></blockquote><hr><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"","more":"<blockquote><p>Lo sentimos, la ruta no se ha encontrado.<br>Por favor, dirgete al <a href=\"../\">inicio del blog</a><br> <cite>El equipo de Academia Binaria</cite></p></blockquote><hr><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"_content":"# A look at major features in the Angular Ivy version 9release\n\n\n[post editor](https://admin.indepth.dev/ghost/#/editor/post/5e2f4cae430b1e0c3681c749)\n\n[Lars Gyrup Brink Nielsen](https://indepth.dev/author/layzee/)06 February, 20209 min read\n\n![A look at major features in the Angular Ivy version 9release](./A%20look%20at%20major%20features%20in%20the%20Angular%20Ivy%20version%209%C2%A0release%20-%20Angular%20INDEPTH_files/light-new-year-s-eve-fireworks-sylvester-40663.jpg)\n\nCover photo by [Pixabay](https://www.pexels.com/photo/light-new-year-s-eve-fireworks-sylvester-40663/) on Pexels.\n\nAOT everywhere, dynamic globalisation, strict mode, Bazel, and much more.\n\n*(Yes, Angular Ivy version 9 is now released!)*\n\n## Ivy is enabled by default[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#ivy-is-enabled-by-default)\n\n\nIn previous versions of Angular, we had to opt-in to Ivy. In version 9, we instead have to opt-out of Ivy if we want to fall back to View Engine. This is possible in both versions 9 and 10 to ensure a smoother transition from View Engine to Ivy.\n\nLibraries *can* be AOT-compiled, but this is not recommended. The Angular team has a View Engine-to-Ivy migration plan which recommends only publishing JIT-compiled View Engine-compatible libraries for Angular version 9. The Angular compatibility compiler will upgrade View Engine-compatible libraries to Ivy when installed in an Angular Ivy application project.\n\n[Learn about library compatibility and the View Engine-to-Ivy transition plan in The Angular Ivy guide for library authors](https://indepth.dev/the-angular-ivy-guide-for-library-authors/).\n\n``` {.language-json}\n// tsconfig.json\n{\n  \"angularCompilerOptions\": {\n    \"enableIvy\": false\n  }\n}\n```\n\n``` {.language-typescript}\n// polyfills.ts\n// Only used in multilingual Ivy applications\n// import '@angular/localize/init';\n```\n\n*Listing 1. Opting out of Ivy to fall back to View Engine.*\n\nIf you experience problems with Ivy in your application or any of the libraries you depend on, you can opt out of Ivy and fall back to View Engine by clearing the `enableIvy` Angular compiler option and disabling `@angular/localize` as seen in Listing 1.\n\nOpting out of Ivy in a server environment is a bit trickier. [Follow the official guide to opt out of Ivy when using server-side rendering](https://angular.io/guide/ivy#using-ssr-without-ivy).\n\n## The principle of locality[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#the-principle-of-locality)\n\n\nTo compile a component in View Engine, Angular needs information about all its declarable dependencies, their declarable dependencies, and so on. This means that Angular libraries cannot be AOT-compiled using View Engine.\n\nTo compile a component in Ivy, Angular only needs information about the component itself, except for the name and package name of its declarable dependencies. Most notably, Ivy doesnt need metadata of any declarable dependencies to compile a component.\n\nThe principle of locality means that in general we will see faster build times.\n\n### Lazy-loaded components[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#lazy-loaded-components)\n\n`entryComponents` declarations are deprecated as they are no longer needed. Any Ivy component can be lazy loaded and dynamically rendered.\n\nThis means that we can now lazy load and render a component without routing or Angular modules. However, in practice we have to use component render modules or feature render modules to link a components template to its declarable dependencies.\n\nLibraries that are only used by a lazy loaded component are even bundled in lazy-loaded chunks.\n\n## Improvements to differential loading[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improvements-to-differential-loading)\n\nWhen differential loading was introduced in Angular version 8, the build process was run once for the ES5 bundle and once for the ES2015+ bundle.\n\nIn Angular version 9, an ES2015+ bundle is output first. That bundle is then transpiled to a separate ES5 bundle. This way, we dont have to go through a full build process twice.\n\n## AOT compilation everywhere[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#aot-compilation-everywhere)\n\n\nAOT is enabled by default in builds, the development server and even in tests. Previously, AOT compilation was significantly slower than JIT compilation so JIT was used for development and testing. With the build and rebuild time improvements in Ivy, AOT-compilation now has a great developer experience.\n\nWhen we used JIT compilation in some phases of our process and only AOT compilation in the final build, errors were detected only when doing production builds or worse, at runtime.\n\n## Bundle sizes[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#bundle-sizes)\n\nIvy can enable smaller bundles because it uses the Ivy Instruction Set which is a set of tree-shakable runtime rendering instructions. Our bundles will only include the rendering instructions we use in our projects.\n\nThis is great for use cases such as microfrontends, Angular Elements and web apps where Angular is not controlling the entire document.\n\nHowever, the difference in our bundle sizes between View Engine and Ivy will vary based on the size of our application and the 3rd party libraries we use. In general:\n\n-   Small and simple applications will see a considerable bundle size decrease.\n-   Complex applications will see an increase in the main bundle, but a decrease in lazy loaded bundle sizes.\n\nThis means a considerable combined bundle size decrease for big applications, but could mean an overall increase in bundle size for medium-sized applications. In both cases, the main bundles size will probably increase which is bad for the initial page load time.\n\n## Globalisation[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#globalisation)\n\nLocales (number formatting, date formatting, and other regional settings) can be dynamically loaded at runtime instead of having to be registered at compile time.\n\n``` {.language-typescript}\n// main.ts\nimport '@angular/localize/init';\n\nimport { loadTranslations } from '@angular/localize';\n\nloadTranslations({\n  '8374172394781134519': 'Hello, {$username}! Welcome to {$appName}.',\n});\n```\n\n*Listing 2. Dynamically loading translations.*\n\nAs seen in Listing 2, translated texts can also be dynamically loaded at runtime instead of being part of our bundles.\n\nThe translated texts could be loaded from a database or a file.\n\n### Multiple languages from a single application bundle[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#multiple-languages-from-a-single-application-bundle)\n\nTo change language, we have to restart the application, but we dont have to serve a different application bundle.\n\nThis means that we canwith some setupsupport multiple languages with a single application bundle on a single hostname.\n\n### Compile time inlining[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#compile-time-inlining)\n\nA localised application will now only be compiled once. Instead of multiple builds to produce a bundle per language, a bundle per language is produced by replacing `$localize` placeholders with translated texts.\n\nWe now need to add the package `@angular/localize` to support localisation (multiple languages). The good news is that we no longer have to include Angulars localisation code in our bundles if we only have a single language.\n\nIf we dont use localised templates, the `i18n*` Ivy instructions are tree shaked from our bundle.\n\n### Localisable texts in component models and services[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#localisable-texts-in-component-models-and-services)\n\n``` {.language-typescript}\n// app.component.ts\n@Component({\n  template: '{{ title }}'\n})\nexport class AppComponent {\n  title = $localize`Welcome to MyApp`;\n}\n```\n\n*Listing 3. A translation text placeholder in a component model.*\n\nA new internationalisation feature is that we can also include placeholders for translated texts in our component models as seen in Listing 3. Previously, this was only possible in templates.\n\n## Additional provider scopes[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#additional-provider-scopes)\n\nWe have always had Angular module scope for providers. Angular version 6 introduced the `'root'` provider scope and tree-shakable providers both for root and Angular module scope providers.\n\nAngular version 9 introduces the `'platform'` and `'any'` provider scopes. Platform-scoped providers can be shared between multiple Angular applications in the same document. The `'any'` provider scope will share a provider per module injector. For example one service instance for the eagerly loaded main bundle and one service instance for each lazy loaded Angular module.\n\n## Improved developer experience[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-developer-experience)\n\nIvy enables the Angular Language Service to support additional checks while developing. This is a big improvement to the developer experience.\n\n### File path checks[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#file-path-checks)\n\nThe Angular Language Service continuously verifies component stylesheet and template paths.\n\n### Template type checks[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#template-type-checks)\n\nTemplates are type checked, according to the template type checking mode as described in the Strict mode section. Member names and types are verified, even in embedded views. What previously resulted in runtime errors are now detected while developing and building.\n\n## New debugging API in development mode[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#new-debugging-api-in-development-mode)\n\n`ng.probe` has been replaced with a new debugging API in development mode. The most notable functions are `ng.applyChanges` and `ng.getComponent`.\n\n## Strict mode[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-mode)\n\n### Strict workspace schematic[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-workspace-schematic)\n\nThe `ng new` workspace schematic now supports the `--strict` flag which defaults to off (`false`).\n\n``` {.language-bash}\nng new my-app --strict\n```\n\nWhen enabled, this parameter adds a few strict TypeScript compiler checks as seen in Listing 4.\n\n``` {.language-json}\n// tsconfig.json\n{\n  \"compilerOptions\": {\n    \"noImplicitAny\": true,\n    \"noImplicitReturns\": true,\n    \"noImplicitThis\": true,\n    \"noFallthroughCasesInSwitch\": true,\n    \"strictNullChecks\": true\n  }\n}\n```\n\n*Listing 4. TypeScript compiler options enabled in a strict Angular workspace.*\n\nCuriously enough, this doesnt add the same options as if we would simply set `\"strict\": true` in the `compilerOptions` object. Lets compare the Angular workspace strict option to the TypeScript compiler strict option.\n\nBoth have these options in common:\n\n-   `noImplicitAny`\n-   `noImplicitThis`\n-   `strictNullChecks`\n\nThe strict Angular workspace option additionally sets these options:\n\n-   `noImplicitReturns`\n-   `noFallthroughCasesInSwitch`\n\nwhile the strict TypeScript compiler option additionally sets these options:\n\n-   `alwaysStrict`\n-   `strictBindCallApply`\n-   `strictFunctionTypes`\n-   `strictPropertyInitialization`\n\nWhats more, the strict Angular workspace option doesnt set template type checking to the new strict mode, only the previous full mode.\n\n### Strict template type checking[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-template-type-checking)\n\nWe have had the option to enable template type checking since Angular version 5 by setting `\"fullTemplateTypeCheck\": true` in the `angularCompilerOptions` object.\n\nIvy introduces strict template type checking as seen in Listing 5. When this new Angular compiler option is set, the value of`fullTemplateTypeCheck` is ignored.\n\n``` {.language-typescript}\n// tsconfig.json\n{\n  \"angularCompilerOptions\": {\n    \"strictTemplates\": true\n  }\n}\n```\n\n*Listing 5. Enable strict template type checking.*\n\nThe strict template type checking verifies the types of property bindings and respects the `strictNullChecks` option. It also checks the types of template references to directives and components, including generic types. Template context variables types are also checked which is great for `NgFor` loops. The `$event` type is checked for event bindings and animations. Even the type of native DOM elements is verified with strict template type checking.\n\nThese extra checks can lead to errors and false positives under certain circumstance, for eaxmple when using libraries that are not compiled with `strictNullChecks`. To address this, strict template type checking has options to opt-out and tweak the checks. For example, `strictTemplates` is actually a shorthand for 8 different Angular compiler options.\n\n## Improved component and directive class inheritance[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-component-and-directive-class-inheritance)\n\nSelectorless base classes are now supported for directives and components. Some metadata is now inherited from base component and directive classes. This makes it easier to extend for example Angular Components and Angular Router directives.\n\n## Latest TypeScript versions[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#latest-typescript-versions)\n\nTypeScript versions 3.6 and 3.7 are supported in Angular version 9. Previous TypeScript versions are no longer supported. Refer to Table 1 to compare TypeScript compatibility between all Angular versions.\n\n[view raw](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support.csv) [angular-cli-node-js-typescript-support.csv](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv) hosted with  by [GitHub](https://github.com/)\n\n*Table 1. Angular CLI, Angular, Node.js and TypeScript compatibility table.*[*Open in new tab*](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3)*.*\n\nTypeScript version 3.6 introduces these and other features:\n\n-   Unicode support for identifiers in modern targets\n-   Improved developer experience for promises\n-   Stricter type checking of generators\n\nTypeScript version 3.7 introduces these and other features that we can use with Angular version 9:\n\n-   Optional chaining operator (`?.`) similar to the safe navigation operator for Angular templates\n-   Nullish coalescing operator (`??`)\n-   Assertion functions (`assert parameterName is typeName` and `asserts parameterName`)\n-   Top-level `await`\n-   Improved recursive type aliases\n-   Improved developer experience for functions such as function truthy checks\n\n## Improved server-side rendering with Angular Universal[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-server-side-rendering-with-angular-universal)\n\nAngular Universal version 9 is released with a Node.js Express development server to provide a realistic environment during development.\n\nAlso part of this release is an Angular CLI builder to prerender static routes using `guess-parser`, inspired by `angular-prerender`. We can pass a routes file to prerender dynamic routes (routes with parameters).\n\n### How do I get started?[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#how-do-i-get-started)\n\nWe can add Angular Universal using the command `ng add @nguniversal/express-engine`. We can then use the builder command `ng run myapp:serve-ssr` to start the server-side rendering development server with live reload. Similarly, we can use `ng run myapp:prerender` to detect static and dynamic routes and prerender them.\n\n## Improved styling experience[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-styling-experience)\n\nStyling in Angular Ivy has been reworked. Combining static HTML classes with `NgStyle` and `NgClass` directives is now fully supported and easier to reason about.\n\n### CSS Custom Properties support[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#css-custom-properties-support)\n\nAs part of the Ivy styling rewrite, binding CSS Custom Properties is now supported.\n\nAn example binding looks like this:\n\n    <div [style.--my-var]=\"myProperty || 'any value'\"></div>\n\nCSS Custom Properties have scope, so this CSS property would be scoped to the components DOM.\n\n## Stable Bazel release as opt-in option[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#stable-bazel-release-as-opt-in-option)\n\nBazel version 2.1 is an opt-in build automation tool for Angular version 9.\n\n### How do I get started?[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#how-do-i-get-started-1)\n\nTo enable Bazel, use `ng add @angular/bazel` or use the `@angular/bazel` schematics collection when generating an Angular workspace.\n\nMake sure to follow [the Bazel installation guide](https://docs.bazel.build/versions/2.0.0/install.html) for your operating system.\n\n## Angular Components[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#angular-components)\n\nAngular version 9 comes with official components for YouTube and Google Maps. A clipboard directive and service are added to the Angular CDK.\n\n## Testing[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#testing)\n\nThe biggest surprise of the Angular version 9 release is the many improvements to testing. Long-standing performance issues are resolved, types are improved and new concepts are introduced.\n\n[Learn about major features and improvements for testing in \"Next-level testing in Angular Ivy version 9\"](https://indepth.dev/next-level-testing-in-angular-ivy-version-9/).\n\n>>>>>>>>>>>>> translated\n\n## Conclusion[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#conclusion)\n\nOne of the most important goals has been to keep backwards compatibility between Ivy and View Engine as much as possible.\n\nOf course, Angular version 9 also includes bugfixes, deprecations, and breaking changes. Ivy also addresses some long-standing issues that we did not cover in this article.\n\nAngular Ivy is an enabler for features to come. As we have discussed in this article, Ivy has already given us benefits for different use cases. However, the best features are to come in future versions of Angular. Which of the possible features that will be delivered in Angular versions 10 and 11, that is still to be decided.\n\nWe only discussed what is part of the public, stable Angular version 9 APIs. A few experimental APIs are part of this release, such as `renderComponent`, `markDirty`, and `detectChanges`. However, they are still subject to change.\n\nWith the deprecation of entry component declarations and lazy loaded components using render modules, we are one step closer to [tree-shakable components and optional Angular modules](https://indepth.dev/angular-revisited-tree-shakable-components-and-optional-ngmodules/).\n\n[Component features](https://indepth.dev/component-features-with-angular-ivy/) are also part of this release, but only exposed for internal use by Ivy.\n\nThe Angular Ivy version 9 release gives us improvements for bundling, testing, the developer experience, tooling, debugging, and type checking. Quite a good collection of features.\n\n## Related resources[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#related-resources)\n\n### Lazy loaded components[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#lazy-loaded-components-1)\n\n[Learn about render modules in my talk Angular revisited: Tree-shakable components and optional NgModules](https://youtu.be/DA3efofhpq4).\n\n[Learn how to lazy load components in Lazy load components in Angular by Kevin Kreuzer](https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8).\n\n### Template type checking[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#template-type-checking)\n\n[Read the official guide on Angular template type checking to learn the details of troubleshooting and configuration](https://angular.io/guide/template-typecheck#troubleshooting-template-errors).\n\n### Globalisation[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#globalisation-1)\n\n[Manfred Steyer discusses lazy-loading locales in \"Lazy Loading Locales with Angular\"](https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/).\n\n[Cdric Exbrayat discusses Ivy globalisation in \"Internationalization with @angular/localize\"](https://blog.ninja-squad.com/2019/12/10/angular-localize/).\n\n### Additional provider scopes[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#additional-provider-scopes-1)\n\nLearn about the `'any'` and `'platform'` provider scopes in [Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler](https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb).\n\n### New debugging API[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#new-debugging-api)\n\n[Read about the full debugging API in the official documentation](https://angular.io/api/core/global).\n\n### Angular Universal version 9[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#angular-universal-version-9)\n\nThese two articles goes into the details of Angular Universal version 9:\n\n-   [Angular Universal v9: Whats New ? by Mark Pieszak](https://trilon.io/blog/angular-universal-v9-whats-new)\n-   [Angular v9 & Universal: SSR and prerendering out of the box! by Sam Vloeberghs](https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1)\n\nLearn about `angular-prerender`, the library that inspired these new Angular Universal features in [Prerender Angular Apps with a single Command by Christoph Guttandin](https://media-codings.com/articles/prerender-angular-apps-with-a-single-command).\n\n### CSS Custom Properties binding[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#css-custom-properties-binding)\n\n[See this tweet and demo by Alexey Zuev to see CSS Custom Properties bindings in action](https://twitter.com/yurzui/status/1221159415820275717).\n\n## Peer reviewers[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#peer-reviewers)\n\nIts always helpful to have a second opinion on our work or even just catch silly errors. For this article I had the pleasure of being reviewed by:\n\n-   [Christoph Guttandin](https://twitter.com/chrisguttandin)\n-   [Evgeny Fedorenko](https://indepth.dev/author/evgeny/)\n-   [Santosh Yadav](https://dev.to/santoshyadav198613)\n\nLars Gyrup Brink Nielsen\n\n","source":"angular_9-original-clean.md","raw":"# A look at major features in the Angular Ivy version 9release\n\n\n[post editor](https://admin.indepth.dev/ghost/#/editor/post/5e2f4cae430b1e0c3681c749)\n\n[Lars Gyrup Brink Nielsen](https://indepth.dev/author/layzee/)06 February, 20209 min read\n\n![A look at major features in the Angular Ivy version 9release](./A%20look%20at%20major%20features%20in%20the%20Angular%20Ivy%20version%209%C2%A0release%20-%20Angular%20INDEPTH_files/light-new-year-s-eve-fireworks-sylvester-40663.jpg)\n\nCover photo by [Pixabay](https://www.pexels.com/photo/light-new-year-s-eve-fireworks-sylvester-40663/) on Pexels.\n\nAOT everywhere, dynamic globalisation, strict mode, Bazel, and much more.\n\n*(Yes, Angular Ivy version 9 is now released!)*\n\n## Ivy is enabled by default[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#ivy-is-enabled-by-default)\n\n\nIn previous versions of Angular, we had to opt-in to Ivy. In version 9, we instead have to opt-out of Ivy if we want to fall back to View Engine. This is possible in both versions 9 and 10 to ensure a smoother transition from View Engine to Ivy.\n\nLibraries *can* be AOT-compiled, but this is not recommended. The Angular team has a View Engine-to-Ivy migration plan which recommends only publishing JIT-compiled View Engine-compatible libraries for Angular version 9. The Angular compatibility compiler will upgrade View Engine-compatible libraries to Ivy when installed in an Angular Ivy application project.\n\n[Learn about library compatibility and the View Engine-to-Ivy transition plan in The Angular Ivy guide for library authors](https://indepth.dev/the-angular-ivy-guide-for-library-authors/).\n\n``` {.language-json}\n// tsconfig.json\n{\n  \"angularCompilerOptions\": {\n    \"enableIvy\": false\n  }\n}\n```\n\n``` {.language-typescript}\n// polyfills.ts\n// Only used in multilingual Ivy applications\n// import '@angular/localize/init';\n```\n\n*Listing 1. Opting out of Ivy to fall back to View Engine.*\n\nIf you experience problems with Ivy in your application or any of the libraries you depend on, you can opt out of Ivy and fall back to View Engine by clearing the `enableIvy` Angular compiler option and disabling `@angular/localize` as seen in Listing 1.\n\nOpting out of Ivy in a server environment is a bit trickier. [Follow the official guide to opt out of Ivy when using server-side rendering](https://angular.io/guide/ivy#using-ssr-without-ivy).\n\n## The principle of locality[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#the-principle-of-locality)\n\n\nTo compile a component in View Engine, Angular needs information about all its declarable dependencies, their declarable dependencies, and so on. This means that Angular libraries cannot be AOT-compiled using View Engine.\n\nTo compile a component in Ivy, Angular only needs information about the component itself, except for the name and package name of its declarable dependencies. Most notably, Ivy doesnt need metadata of any declarable dependencies to compile a component.\n\nThe principle of locality means that in general we will see faster build times.\n\n### Lazy-loaded components[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#lazy-loaded-components)\n\n`entryComponents` declarations are deprecated as they are no longer needed. Any Ivy component can be lazy loaded and dynamically rendered.\n\nThis means that we can now lazy load and render a component without routing or Angular modules. However, in practice we have to use component render modules or feature render modules to link a components template to its declarable dependencies.\n\nLibraries that are only used by a lazy loaded component are even bundled in lazy-loaded chunks.\n\n## Improvements to differential loading[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improvements-to-differential-loading)\n\nWhen differential loading was introduced in Angular version 8, the build process was run once for the ES5 bundle and once for the ES2015+ bundle.\n\nIn Angular version 9, an ES2015+ bundle is output first. That bundle is then transpiled to a separate ES5 bundle. This way, we dont have to go through a full build process twice.\n\n## AOT compilation everywhere[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#aot-compilation-everywhere)\n\n\nAOT is enabled by default in builds, the development server and even in tests. Previously, AOT compilation was significantly slower than JIT compilation so JIT was used for development and testing. With the build and rebuild time improvements in Ivy, AOT-compilation now has a great developer experience.\n\nWhen we used JIT compilation in some phases of our process and only AOT compilation in the final build, errors were detected only when doing production builds or worse, at runtime.\n\n## Bundle sizes[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#bundle-sizes)\n\nIvy can enable smaller bundles because it uses the Ivy Instruction Set which is a set of tree-shakable runtime rendering instructions. Our bundles will only include the rendering instructions we use in our projects.\n\nThis is great for use cases such as microfrontends, Angular Elements and web apps where Angular is not controlling the entire document.\n\nHowever, the difference in our bundle sizes between View Engine and Ivy will vary based on the size of our application and the 3rd party libraries we use. In general:\n\n-   Small and simple applications will see a considerable bundle size decrease.\n-   Complex applications will see an increase in the main bundle, but a decrease in lazy loaded bundle sizes.\n\nThis means a considerable combined bundle size decrease for big applications, but could mean an overall increase in bundle size for medium-sized applications. In both cases, the main bundles size will probably increase which is bad for the initial page load time.\n\n## Globalisation[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#globalisation)\n\nLocales (number formatting, date formatting, and other regional settings) can be dynamically loaded at runtime instead of having to be registered at compile time.\n\n``` {.language-typescript}\n// main.ts\nimport '@angular/localize/init';\n\nimport { loadTranslations } from '@angular/localize';\n\nloadTranslations({\n  '8374172394781134519': 'Hello, {$username}! Welcome to {$appName}.',\n});\n```\n\n*Listing 2. Dynamically loading translations.*\n\nAs seen in Listing 2, translated texts can also be dynamically loaded at runtime instead of being part of our bundles.\n\nThe translated texts could be loaded from a database or a file.\n\n### Multiple languages from a single application bundle[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#multiple-languages-from-a-single-application-bundle)\n\nTo change language, we have to restart the application, but we dont have to serve a different application bundle.\n\nThis means that we canwith some setupsupport multiple languages with a single application bundle on a single hostname.\n\n### Compile time inlining[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#compile-time-inlining)\n\nA localised application will now only be compiled once. Instead of multiple builds to produce a bundle per language, a bundle per language is produced by replacing `$localize` placeholders with translated texts.\n\nWe now need to add the package `@angular/localize` to support localisation (multiple languages). The good news is that we no longer have to include Angulars localisation code in our bundles if we only have a single language.\n\nIf we dont use localised templates, the `i18n*` Ivy instructions are tree shaked from our bundle.\n\n### Localisable texts in component models and services[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#localisable-texts-in-component-models-and-services)\n\n``` {.language-typescript}\n// app.component.ts\n@Component({\n  template: '{{ title }}'\n})\nexport class AppComponent {\n  title = $localize`Welcome to MyApp`;\n}\n```\n\n*Listing 3. A translation text placeholder in a component model.*\n\nA new internationalisation feature is that we can also include placeholders for translated texts in our component models as seen in Listing 3. Previously, this was only possible in templates.\n\n## Additional provider scopes[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#additional-provider-scopes)\n\nWe have always had Angular module scope for providers. Angular version 6 introduced the `'root'` provider scope and tree-shakable providers both for root and Angular module scope providers.\n\nAngular version 9 introduces the `'platform'` and `'any'` provider scopes. Platform-scoped providers can be shared between multiple Angular applications in the same document. The `'any'` provider scope will share a provider per module injector. For example one service instance for the eagerly loaded main bundle and one service instance for each lazy loaded Angular module.\n\n## Improved developer experience[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-developer-experience)\n\nIvy enables the Angular Language Service to support additional checks while developing. This is a big improvement to the developer experience.\n\n### File path checks[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#file-path-checks)\n\nThe Angular Language Service continuously verifies component stylesheet and template paths.\n\n### Template type checks[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#template-type-checks)\n\nTemplates are type checked, according to the template type checking mode as described in the Strict mode section. Member names and types are verified, even in embedded views. What previously resulted in runtime errors are now detected while developing and building.\n\n## New debugging API in development mode[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#new-debugging-api-in-development-mode)\n\n`ng.probe` has been replaced with a new debugging API in development mode. The most notable functions are `ng.applyChanges` and `ng.getComponent`.\n\n## Strict mode[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-mode)\n\n### Strict workspace schematic[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-workspace-schematic)\n\nThe `ng new` workspace schematic now supports the `--strict` flag which defaults to off (`false`).\n\n``` {.language-bash}\nng new my-app --strict\n```\n\nWhen enabled, this parameter adds a few strict TypeScript compiler checks as seen in Listing 4.\n\n``` {.language-json}\n// tsconfig.json\n{\n  \"compilerOptions\": {\n    \"noImplicitAny\": true,\n    \"noImplicitReturns\": true,\n    \"noImplicitThis\": true,\n    \"noFallthroughCasesInSwitch\": true,\n    \"strictNullChecks\": true\n  }\n}\n```\n\n*Listing 4. TypeScript compiler options enabled in a strict Angular workspace.*\n\nCuriously enough, this doesnt add the same options as if we would simply set `\"strict\": true` in the `compilerOptions` object. Lets compare the Angular workspace strict option to the TypeScript compiler strict option.\n\nBoth have these options in common:\n\n-   `noImplicitAny`\n-   `noImplicitThis`\n-   `strictNullChecks`\n\nThe strict Angular workspace option additionally sets these options:\n\n-   `noImplicitReturns`\n-   `noFallthroughCasesInSwitch`\n\nwhile the strict TypeScript compiler option additionally sets these options:\n\n-   `alwaysStrict`\n-   `strictBindCallApply`\n-   `strictFunctionTypes`\n-   `strictPropertyInitialization`\n\nWhats more, the strict Angular workspace option doesnt set template type checking to the new strict mode, only the previous full mode.\n\n### Strict template type checking[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-template-type-checking)\n\nWe have had the option to enable template type checking since Angular version 5 by setting `\"fullTemplateTypeCheck\": true` in the `angularCompilerOptions` object.\n\nIvy introduces strict template type checking as seen in Listing 5. When this new Angular compiler option is set, the value of`fullTemplateTypeCheck` is ignored.\n\n``` {.language-typescript}\n// tsconfig.json\n{\n  \"angularCompilerOptions\": {\n    \"strictTemplates\": true\n  }\n}\n```\n\n*Listing 5. Enable strict template type checking.*\n\nThe strict template type checking verifies the types of property bindings and respects the `strictNullChecks` option. It also checks the types of template references to directives and components, including generic types. Template context variables types are also checked which is great for `NgFor` loops. The `$event` type is checked for event bindings and animations. Even the type of native DOM elements is verified with strict template type checking.\n\nThese extra checks can lead to errors and false positives under certain circumstance, for eaxmple when using libraries that are not compiled with `strictNullChecks`. To address this, strict template type checking has options to opt-out and tweak the checks. For example, `strictTemplates` is actually a shorthand for 8 different Angular compiler options.\n\n## Improved component and directive class inheritance[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-component-and-directive-class-inheritance)\n\nSelectorless base classes are now supported for directives and components. Some metadata is now inherited from base component and directive classes. This makes it easier to extend for example Angular Components and Angular Router directives.\n\n## Latest TypeScript versions[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#latest-typescript-versions)\n\nTypeScript versions 3.6 and 3.7 are supported in Angular version 9. Previous TypeScript versions are no longer supported. Refer to Table 1 to compare TypeScript compatibility between all Angular versions.\n\n[view raw](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support.csv) [angular-cli-node-js-typescript-support.csv](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv) hosted with  by [GitHub](https://github.com/)\n\n*Table 1. Angular CLI, Angular, Node.js and TypeScript compatibility table.*[*Open in new tab*](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3)*.*\n\nTypeScript version 3.6 introduces these and other features:\n\n-   Unicode support for identifiers in modern targets\n-   Improved developer experience for promises\n-   Stricter type checking of generators\n\nTypeScript version 3.7 introduces these and other features that we can use with Angular version 9:\n\n-   Optional chaining operator (`?.`) similar to the safe navigation operator for Angular templates\n-   Nullish coalescing operator (`??`)\n-   Assertion functions (`assert parameterName is typeName` and `asserts parameterName`)\n-   Top-level `await`\n-   Improved recursive type aliases\n-   Improved developer experience for functions such as function truthy checks\n\n## Improved server-side rendering with Angular Universal[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-server-side-rendering-with-angular-universal)\n\nAngular Universal version 9 is released with a Node.js Express development server to provide a realistic environment during development.\n\nAlso part of this release is an Angular CLI builder to prerender static routes using `guess-parser`, inspired by `angular-prerender`. We can pass a routes file to prerender dynamic routes (routes with parameters).\n\n### How do I get started?[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#how-do-i-get-started)\n\nWe can add Angular Universal using the command `ng add @nguniversal/express-engine`. We can then use the builder command `ng run myapp:serve-ssr` to start the server-side rendering development server with live reload. Similarly, we can use `ng run myapp:prerender` to detect static and dynamic routes and prerender them.\n\n## Improved styling experience[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-styling-experience)\n\nStyling in Angular Ivy has been reworked. Combining static HTML classes with `NgStyle` and `NgClass` directives is now fully supported and easier to reason about.\n\n### CSS Custom Properties support[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#css-custom-properties-support)\n\nAs part of the Ivy styling rewrite, binding CSS Custom Properties is now supported.\n\nAn example binding looks like this:\n\n    <div [style.--my-var]=\"myProperty || 'any value'\"></div>\n\nCSS Custom Properties have scope, so this CSS property would be scoped to the components DOM.\n\n## Stable Bazel release as opt-in option[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#stable-bazel-release-as-opt-in-option)\n\nBazel version 2.1 is an opt-in build automation tool for Angular version 9.\n\n### How do I get started?[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#how-do-i-get-started-1)\n\nTo enable Bazel, use `ng add @angular/bazel` or use the `@angular/bazel` schematics collection when generating an Angular workspace.\n\nMake sure to follow [the Bazel installation guide](https://docs.bazel.build/versions/2.0.0/install.html) for your operating system.\n\n## Angular Components[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#angular-components)\n\nAngular version 9 comes with official components for YouTube and Google Maps. A clipboard directive and service are added to the Angular CDK.\n\n## Testing[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#testing)\n\nThe biggest surprise of the Angular version 9 release is the many improvements to testing. Long-standing performance issues are resolved, types are improved and new concepts are introduced.\n\n[Learn about major features and improvements for testing in \"Next-level testing in Angular Ivy version 9\"](https://indepth.dev/next-level-testing-in-angular-ivy-version-9/).\n\n>>>>>>>>>>>>> translated\n\n## Conclusion[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#conclusion)\n\nOne of the most important goals has been to keep backwards compatibility between Ivy and View Engine as much as possible.\n\nOf course, Angular version 9 also includes bugfixes, deprecations, and breaking changes. Ivy also addresses some long-standing issues that we did not cover in this article.\n\nAngular Ivy is an enabler for features to come. As we have discussed in this article, Ivy has already given us benefits for different use cases. However, the best features are to come in future versions of Angular. Which of the possible features that will be delivered in Angular versions 10 and 11, that is still to be decided.\n\nWe only discussed what is part of the public, stable Angular version 9 APIs. A few experimental APIs are part of this release, such as `renderComponent`, `markDirty`, and `detectChanges`. However, they are still subject to change.\n\nWith the deprecation of entry component declarations and lazy loaded components using render modules, we are one step closer to [tree-shakable components and optional Angular modules](https://indepth.dev/angular-revisited-tree-shakable-components-and-optional-ngmodules/).\n\n[Component features](https://indepth.dev/component-features-with-angular-ivy/) are also part of this release, but only exposed for internal use by Ivy.\n\nThe Angular Ivy version 9 release gives us improvements for bundling, testing, the developer experience, tooling, debugging, and type checking. Quite a good collection of features.\n\n## Related resources[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#related-resources)\n\n### Lazy loaded components[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#lazy-loaded-components-1)\n\n[Learn about render modules in my talk Angular revisited: Tree-shakable components and optional NgModules](https://youtu.be/DA3efofhpq4).\n\n[Learn how to lazy load components in Lazy load components in Angular by Kevin Kreuzer](https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8).\n\n### Template type checking[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#template-type-checking)\n\n[Read the official guide on Angular template type checking to learn the details of troubleshooting and configuration](https://angular.io/guide/template-typecheck#troubleshooting-template-errors).\n\n### Globalisation[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#globalisation-1)\n\n[Manfred Steyer discusses lazy-loading locales in \"Lazy Loading Locales with Angular\"](https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/).\n\n[Cdric Exbrayat discusses Ivy globalisation in \"Internationalization with @angular/localize\"](https://blog.ninja-squad.com/2019/12/10/angular-localize/).\n\n### Additional provider scopes[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#additional-provider-scopes-1)\n\nLearn about the `'any'` and `'platform'` provider scopes in [Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler](https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb).\n\n### New debugging API[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#new-debugging-api)\n\n[Read about the full debugging API in the official documentation](https://angular.io/api/core/global).\n\n### Angular Universal version 9[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#angular-universal-version-9)\n\nThese two articles goes into the details of Angular Universal version 9:\n\n-   [Angular Universal v9: Whats New ? by Mark Pieszak](https://trilon.io/blog/angular-universal-v9-whats-new)\n-   [Angular v9 & Universal: SSR and prerendering out of the box! by Sam Vloeberghs](https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1)\n\nLearn about `angular-prerender`, the library that inspired these new Angular Universal features in [Prerender Angular Apps with a single Command by Christoph Guttandin](https://media-codings.com/articles/prerender-angular-apps-with-a-single-command).\n\n### CSS Custom Properties binding[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#css-custom-properties-binding)\n\n[See this tweet and demo by Alexey Zuev to see CSS Custom Properties bindings in action](https://twitter.com/yurzui/status/1221159415820275717).\n\n## Peer reviewers[\\#](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#peer-reviewers)\n\nIts always helpful to have a second opinion on our work or even just catch silly errors. For this article I had the pleasure of being reviewed by:\n\n-   [Christoph Guttandin](https://twitter.com/chrisguttandin)\n-   [Evgeny Fedorenko](https://indepth.dev/author/evgeny/)\n-   [Santosh Yadav](https://dev.to/santoshyadav198613)\n\nLars Gyrup Brink Nielsen\n\n","date":"2020-02-17T15:43:04.055Z","updated":"2020-02-17T15:43:04.055Z","path":"angular_9-original-clean.html","title":"","comments":1,"layout":"page","_id":"ck70maaxs0001bss31nrjy6fk","content":"<h1 id=\"A-look-at-major-features-in-the-Angular-Ivy-version-9-release\"><a href=\"#A-look-at-major-features-in-the-Angular-Ivy-version-9-release\" class=\"headerlink\" title=\"A look at major features in the Angular Ivy version 9 release\"></a>A look at major features in the Angular Ivy version 9 release</h1><p><a href=\"https://admin.indepth.dev/ghost/#/editor/post/5e2f4cae430b1e0c3681c749\" target=\"_blank\" rel=\"noopener\">post editor</a></p><p><a href=\"https://indepth.dev/author/layzee/\" target=\"_blank\" rel=\"noopener\">Lars Gyrup Brink Nielsen</a>06 February, 20209 min read</p><p><img src=\"./A%20look%20at%20major%20features%20in%20the%20Angular%20Ivy%20version%209%C2%A0release%20-%20Angular%20INDEPTH_files/light-new-year-s-eve-fireworks-sylvester-40663.jpg\" alt=\"A look at major features in the Angular Ivy version 9 release\"></p><p>Cover photo by <a href=\"https://www.pexels.com/photo/light-new-year-s-eve-fireworks-sylvester-40663/\" target=\"_blank\" rel=\"noopener\">Pixabay</a> on Pexels.</p><p>AOT everywhere, dynamic globalisation, strict mode, Bazel, and much more.</p><p><em>(Yes, Angular Ivy version 9 is now released!)</em></p><h2 id=\"Ivy-is-enabled-by-default\"><a href=\"#Ivy-is-enabled-by-default\" class=\"headerlink\" title=\"Ivy is enabled by default#\"></a>Ivy is enabled by default<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#ivy-is-enabled-by-default\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>In previous versions of Angular, we had to opt-in to Ivy. In version 9, we instead have to opt-out of Ivy if we want to fall back to View Engine. This is possible in both versions 9 and 10 to ensure a smoother transition from View Engine to Ivy.</p><p>Libraries <em>can</em> be AOT-compiled, but this is not recommended. The Angular team has a View Engine-to-Ivy migration plan which recommends only publishing JIT-compiled View Engine-compatible libraries for Angular version 9. The Angular compatibility compiler will upgrade View Engine-compatible libraries to Ivy when installed in an Angular Ivy application project.</p><p><a href=\"https://indepth.dev/the-angular-ivy-guide-for-library-authors/\" target=\"_blank\" rel=\"noopener\">Learn about library compatibility and the View Engine-to-Ivy transition plan in The Angular Ivy guide for library authors</a>.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;angularCompilerOptions&quot;: &#123;</span><br><span class=\"line\">    &quot;enableIvy&quot;: false</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// polyfills.ts</span><br><span class=\"line\">// Only used in multilingual Ivy applications</span><br><span class=\"line\">// import &apos;@angular/localize/init&apos;;</span><br></pre></td></tr></table></figure><p><em>Listing 1. Opting out of Ivy to fall back to View Engine.</em></p><p>If you experience problems with Ivy in your application or any of the libraries you depend on, you can opt out of Ivy and fall back to View Engine by clearing the <code>enableIvy</code> Angular compiler option and disabling <code>@angular/localize</code> as seen in Listing 1.</p><p>Opting out of Ivy in a server environment is a bit trickier. <a href=\"https://angular.io/guide/ivy#using-ssr-without-ivy\" target=\"_blank\" rel=\"noopener\">Follow the official guide to opt out of Ivy when using server-side rendering</a>.</p><h2 id=\"The-principle-of-locality\"><a href=\"#The-principle-of-locality\" class=\"headerlink\" title=\"The principle of locality#\"></a>The principle of locality<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#the-principle-of-locality\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>To compile a component in View Engine, Angular needs information about all its declarable dependencies, their declarable dependencies, and so on. This means that Angular libraries cannot be AOT-compiled using View Engine.</p><p>To compile a component in Ivy, Angular only needs information about the component itself, except for the name and package name of its declarable dependencies. Most notably, Ivy doesnt need metadata of any declarable dependencies to compile a component.</p><p>The principle of locality means that in general we will see faster build times.</p><h3 id=\"Lazy-loaded-components\"><a href=\"#Lazy-loaded-components\" class=\"headerlink\" title=\"Lazy-loaded components#\"></a>Lazy-loaded components<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#lazy-loaded-components\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><code>entryComponents</code> declarations are deprecated as they are no longer needed. Any Ivy component can be lazy loaded and dynamically rendered.</p><p>This means that we can now lazy load and render a component without routing or Angular modules. However, in practice we have to use component render modules or feature render modules to link a components template to its declarable dependencies.</p><p>Libraries that are only used by a lazy loaded component are even bundled in lazy-loaded chunks.</p><h2 id=\"Improvements-to-differential-loading\"><a href=\"#Improvements-to-differential-loading\" class=\"headerlink\" title=\"Improvements to differential loading#\"></a>Improvements to differential loading<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improvements-to-differential-loading\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>When differential loading was introduced in Angular version 8, the build process was run once for the ES5 bundle and once for the ES2015+ bundle.</p><p>In Angular version 9, an ES2015+ bundle is output first. That bundle is then transpiled to a separate ES5 bundle. This way, we dont have to go through a full build process twice.</p><h2 id=\"AOT-compilation-everywhere\"><a href=\"#AOT-compilation-everywhere\" class=\"headerlink\" title=\"AOT compilation everywhere#\"></a>AOT compilation everywhere<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#aot-compilation-everywhere\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>AOT is enabled by default in builds, the development server and even in tests. Previously, AOT compilation was significantly slower than JIT compilation so JIT was used for development and testing. With the build and rebuild time improvements in Ivy, AOT-compilation now has a great developer experience.</p><p>When we used JIT compilation in some phases of our process and only AOT compilation in the final build, errors were detected only when doing production builds or worse, at runtime.</p><h2 id=\"Bundle-sizes\"><a href=\"#Bundle-sizes\" class=\"headerlink\" title=\"Bundle sizes#\"></a>Bundle sizes<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#bundle-sizes\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Ivy can enable smaller bundles because it uses the Ivy Instruction Set which is a set of tree-shakable runtime rendering instructions. Our bundles will only include the rendering instructions we use in our projects.</p><p>This is great for use cases such as microfrontends, Angular Elements and web apps where Angular is not controlling the entire document.</p><p>However, the difference in our bundle sizes between View Engine and Ivy will vary based on the size of our application and the 3rd party libraries we use. In general:</p><ul><li>Small and simple applications will see a considerable bundle size decrease.</li><li>Complex applications will see an increase in the main bundle, but a decrease in lazy loaded bundle sizes.</li></ul><p>This means a considerable combined bundle size decrease for big applications, but could mean an overall increase in bundle size for medium-sized applications. In both cases, the main bundles size will probably increase which is bad for the initial page load time.</p><h2 id=\"Globalisation\"><a href=\"#Globalisation\" class=\"headerlink\" title=\"Globalisation#\"></a>Globalisation<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#globalisation\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Locales (number formatting, date formatting, and other regional settings) can be dynamically loaded at runtime instead of having to be registered at compile time.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// main.ts</span><br><span class=\"line\">import &apos;@angular/localize/init&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">import &#123; loadTranslations &#125; from &apos;@angular/localize&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">loadTranslations(&#123;</span><br><span class=\"line\">  &apos;8374172394781134519&apos;: &apos;Hello, &#123;$username&#125;! Welcome to &#123;$appName&#125;.&apos;,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p><em>Listing 2. Dynamically loading translations.</em></p><p>As seen in Listing 2, translated texts can also be dynamically loaded at runtime instead of being part of our bundles.</p><p>The translated texts could be loaded from a database or a file.</p><h3 id=\"Multiple-languages-from-a-single-application-bundle\"><a href=\"#Multiple-languages-from-a-single-application-bundle\" class=\"headerlink\" title=\"Multiple languages from a single application bundle#\"></a>Multiple languages from a single application bundle<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#multiple-languages-from-a-single-application-bundle\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>To change language, we have to restart the application, but we dont have to serve a different application bundle.</p><p>This means that we canwith some setupsupport multiple languages with a single application bundle on a single hostname.</p><h3 id=\"Compile-time-inlining\"><a href=\"#Compile-time-inlining\" class=\"headerlink\" title=\"Compile time inlining#\"></a>Compile time inlining<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#compile-time-inlining\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>A localised application will now only be compiled once. Instead of multiple builds to produce a bundle per language, a bundle per language is produced by replacing <code>$localize</code> placeholders with translated texts.</p><p>We now need to add the package <code>@angular/localize</code> to support localisation (multiple languages). The good news is that we no longer have to include Angulars localisation code in our bundles if we only have a single language.</p><p>If we dont use localised templates, the <code>i18n*</code> Ivy instructions are tree shaked from our bundle.</p><h3 id=\"Localisable-texts-in-component-models-and-services\"><a href=\"#Localisable-texts-in-component-models-and-services\" class=\"headerlink\" title=\"Localisable texts in component models and services#\"></a>Localisable texts in component models and services<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#localisable-texts-in-component-models-and-services\" target=\"_blank\" rel=\"noopener\">#</a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// app.component.ts</span><br><span class=\"line\">@Component(&#123;</span><br><span class=\"line\">  template: &apos;&#123;&#123; title &#125;&#125;&apos;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">export class AppComponent &#123;</span><br><span class=\"line\">  title = $localize`Welcome to MyApp`;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listing 3. A translation text placeholder in a component model.</em></p><p>A new internationalisation feature is that we can also include placeholders for translated texts in our component models as seen in Listing 3. Previously, this was only possible in templates.</p><h2 id=\"Additional-provider-scopes\"><a href=\"#Additional-provider-scopes\" class=\"headerlink\" title=\"Additional provider scopes#\"></a>Additional provider scopes<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#additional-provider-scopes\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>We have always had Angular module scope for providers. Angular version 6 introduced the <code>&#39;root&#39;</code> provider scope and tree-shakable providers both for root and Angular module scope providers.</p><p>Angular version 9 introduces the <code>&#39;platform&#39;</code> and <code>&#39;any&#39;</code> provider scopes. Platform-scoped providers can be shared between multiple Angular applications in the same document. The <code>&#39;any&#39;</code> provider scope will share a provider per module injector. For example one service instance for the eagerly loaded main bundle and one service instance for each lazy loaded Angular module.</p><h2 id=\"Improved-developer-experience\"><a href=\"#Improved-developer-experience\" class=\"headerlink\" title=\"Improved developer experience#\"></a>Improved developer experience<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-developer-experience\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Ivy enables the Angular Language Service to support additional checks while developing. This is a big improvement to the developer experience.</p><h3 id=\"File-path-checks\"><a href=\"#File-path-checks\" class=\"headerlink\" title=\"File path checks#\"></a>File path checks<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#file-path-checks\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>The Angular Language Service continuously verifies component stylesheet and template paths.</p><h3 id=\"Template-type-checks\"><a href=\"#Template-type-checks\" class=\"headerlink\" title=\"Template type checks#\"></a>Template type checks<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#template-type-checks\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>Templates are type checked, according to the template type checking mode as described in the Strict mode section. Member names and types are verified, even in embedded views. What previously resulted in runtime errors are now detected while developing and building.</p><h2 id=\"New-debugging-API-in-development-mode\"><a href=\"#New-debugging-API-in-development-mode\" class=\"headerlink\" title=\"New debugging API in development mode#\"></a>New debugging API in development mode<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#new-debugging-api-in-development-mode\" target=\"_blank\" rel=\"noopener\">#</a></h2><p><code>ng.probe</code> has been replaced with a new debugging API in development mode. The most notable functions are <code>ng.applyChanges</code> and <code>ng.getComponent</code>.</p><h2 id=\"Strict-mode\"><a href=\"#Strict-mode\" class=\"headerlink\" title=\"Strict mode#\"></a>Strict mode<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-mode\" target=\"_blank\" rel=\"noopener\">#</a></h2><h3 id=\"Strict-workspace-schematic\"><a href=\"#Strict-workspace-schematic\" class=\"headerlink\" title=\"Strict workspace schematic#\"></a>Strict workspace schematic<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-workspace-schematic\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>The <code>ng new</code> workspace schematic now supports the <code>--strict</code> flag which defaults to off (<code>false</code>).</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new my-app --strict</span><br></pre></td></tr></table></figure><p>When enabled, this parameter adds a few strict TypeScript compiler checks as seen in Listing 4.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;compilerOptions&quot;: &#123;</span><br><span class=\"line\">    &quot;noImplicitAny&quot;: true,</span><br><span class=\"line\">    &quot;noImplicitReturns&quot;: true,</span><br><span class=\"line\">    &quot;noImplicitThis&quot;: true,</span><br><span class=\"line\">    &quot;noFallthroughCasesInSwitch&quot;: true,</span><br><span class=\"line\">    &quot;strictNullChecks&quot;: true</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listing 4. TypeScript compiler options enabled in a strict Angular workspace.</em></p><p>Curiously enough, this doesnt add the same options as if we would simply set <code>&quot;strict&quot;: true</code> in the <code>compilerOptions</code> object. Lets compare the Angular workspace strict option to the TypeScript compiler strict option.</p><p>Both have these options in common:</p><ul><li><code>noImplicitAny</code></li><li><code>noImplicitThis</code></li><li><code>strictNullChecks</code></li></ul><p>The strict Angular workspace option additionally sets these options:</p><ul><li><code>noImplicitReturns</code></li><li><code>noFallthroughCasesInSwitch</code></li></ul><p>while the strict TypeScript compiler option additionally sets these options:</p><ul><li><code>alwaysStrict</code></li><li><code>strictBindCallApply</code></li><li><code>strictFunctionTypes</code></li><li><code>strictPropertyInitialization</code></li></ul><p>Whats more, the strict Angular workspace option doesnt set template type checking to the new strict mode, only the previous full mode.</p><h3 id=\"Strict-template-type-checking\"><a href=\"#Strict-template-type-checking\" class=\"headerlink\" title=\"Strict template type checking#\"></a>Strict template type checking<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-template-type-checking\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>We have had the option to enable template type checking since Angular version 5 by setting <code>&quot;fullTemplateTypeCheck&quot;: true</code> in the <code>angularCompilerOptions</code> object.</p><p>Ivy introduces strict template type checking as seen in Listing 5. When this new Angular compiler option is set, the value of<code>fullTemplateTypeCheck</code> is ignored.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;angularCompilerOptions&quot;: &#123;</span><br><span class=\"line\">    &quot;strictTemplates&quot;: true</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listing 5. Enable strict template type checking.</em></p><p>The strict template type checking verifies the types of property bindings and respects the <code>strictNullChecks</code> option. It also checks the types of template references to directives and components, including generic types. Template context variables types are also checked which is great for <code>NgFor</code> loops. The <code>$event</code> type is checked for event bindings and animations. Even the type of native DOM elements is verified with strict template type checking.</p><p>These extra checks can lead to errors and false positives under certain circumstance, for eaxmple when using libraries that are not compiled with <code>strictNullChecks</code>. To address this, strict template type checking has options to opt-out and tweak the checks. For example, <code>strictTemplates</code> is actually a shorthand for 8 different Angular compiler options.</p><h2 id=\"Improved-component-and-directive-class-inheritance\"><a href=\"#Improved-component-and-directive-class-inheritance\" class=\"headerlink\" title=\"Improved component and directive class inheritance#\"></a>Improved component and directive class inheritance<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-component-and-directive-class-inheritance\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Selectorless base classes are now supported for directives and components. Some metadata is now inherited from base component and directive classes. This makes it easier to extend for example Angular Components and Angular Router directives.</p><h2 id=\"Latest-TypeScript-versions\"><a href=\"#Latest-TypeScript-versions\" class=\"headerlink\" title=\"Latest TypeScript versions#\"></a>Latest TypeScript versions<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#latest-typescript-versions\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>TypeScript versions 3.6 and 3.7 are supported in Angular version 9. Previous TypeScript versions are no longer supported. Refer to Table 1 to compare TypeScript compatibility between all Angular versions.</p><p><a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support.csv\" target=\"_blank\" rel=\"noopener\">view raw</a> <a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv\" target=\"_blank\" rel=\"noopener\">angular-cli-node-js-typescript-support.csv</a> hosted with  by <a href=\"https://github.com/\" target=\"_blank\" rel=\"noopener\">GitHub</a></p><p><em>Table 1. Angular CLI, Angular, Node.js and TypeScript compatibility table.</em><a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3\" target=\"_blank\" rel=\"noopener\"><em>Open in new tab</em></a><em>.</em></p><p>TypeScript version 3.6 introduces these and other features:</p><ul><li>Unicode support for identifiers in modern targets</li><li>Improved developer experience for promises</li><li>Stricter type checking of generators</li></ul><p>TypeScript version 3.7 introduces these and other features that we can use with Angular version 9:</p><ul><li>Optional chaining operator (<code>?.</code>) similar to the safe navigation operator for Angular templates</li><li>Nullish coalescing operator (<code>??</code>)</li><li>Assertion functions (<code>assert parameterName is typeName</code> and <code>asserts parameterName</code>)</li><li>Top-level <code>await</code></li><li>Improved recursive type aliases</li><li>Improved developer experience for functions such as function truthy checks</li></ul><h2 id=\"Improved-server-side-rendering-with-Angular-Universal\"><a href=\"#Improved-server-side-rendering-with-Angular-Universal\" class=\"headerlink\" title=\"Improved server-side rendering with Angular Universal#\"></a>Improved server-side rendering with Angular Universal<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-server-side-rendering-with-angular-universal\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Angular Universal version 9 is released with a Node.js Express development server to provide a realistic environment during development.</p><p>Also part of this release is an Angular CLI builder to prerender static routes using <code>guess-parser</code>, inspired by <code>angular-prerender</code>. We can pass a routes file to prerender dynamic routes (routes with parameters).</p><h3 id=\"How-do-I-get-started\"><a href=\"#How-do-I-get-started\" class=\"headerlink\" title=\"How do I get started?#\"></a>How do I get started?<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#how-do-i-get-started\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>We can add Angular Universal using the command <code>ng add @nguniversal/express-engine</code>. We can then use the builder command <code>ng run myapp:serve-ssr</code> to start the server-side rendering development server with live reload. Similarly, we can use <code>ng run myapp:prerender</code> to detect static and dynamic routes and prerender them.</p><h2 id=\"Improved-styling-experience\"><a href=\"#Improved-styling-experience\" class=\"headerlink\" title=\"Improved styling experience#\"></a>Improved styling experience<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-styling-experience\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Styling in Angular Ivy has been reworked. Combining static HTML classes with <code>NgStyle</code> and <code>NgClass</code> directives is now fully supported and easier to reason about.</p><h3 id=\"CSS-Custom-Properties-support\"><a href=\"#CSS-Custom-Properties-support\" class=\"headerlink\" title=\"CSS Custom Properties support#\"></a>CSS Custom Properties support<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#css-custom-properties-support\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>As part of the Ivy styling rewrite, binding CSS Custom Properties is now supported.</p><p>An example binding looks like this:</p><pre><code>&lt;div [style.--my-var]=&quot;myProperty || &apos;any value&apos;&quot;&gt;&lt;/div&gt;</code></pre><p>CSS Custom Properties have scope, so this CSS property would be scoped to the components DOM.</p><h2 id=\"Stable-Bazel-release-as-opt-in-option\"><a href=\"#Stable-Bazel-release-as-opt-in-option\" class=\"headerlink\" title=\"Stable Bazel release as opt-in option#\"></a>Stable Bazel release as opt-in option<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#stable-bazel-release-as-opt-in-option\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Bazel version 2.1 is an opt-in build automation tool for Angular version 9.</p><h3 id=\"How-do-I-get-started-1\"><a href=\"#How-do-I-get-started-1\" class=\"headerlink\" title=\"How do I get started?#\"></a>How do I get started?<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#how-do-i-get-started-1\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>To enable Bazel, use <code>ng add @angular/bazel</code> or use the <code>@angular/bazel</code> schematics collection when generating an Angular workspace.</p><p>Make sure to follow <a href=\"https://docs.bazel.build/versions/2.0.0/install.html\" target=\"_blank\" rel=\"noopener\">the Bazel installation guide</a> for your operating system.</p><h2 id=\"Angular-Components\"><a href=\"#Angular-Components\" class=\"headerlink\" title=\"Angular Components#\"></a>Angular Components<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#angular-components\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Angular version 9 comes with official components for YouTube and Google Maps. A clipboard directive and service are added to the Angular CDK.</p><h2 id=\"Testing\"><a href=\"#Testing\" class=\"headerlink\" title=\"Testing#\"></a>Testing<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#testing\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>The biggest surprise of the Angular version 9 release is the many improvements to testing. Long-standing performance issues are resolved, types are improved and new concepts are introduced.</p><p><a href=\"https://indepth.dev/next-level-testing-in-angular-ivy-version-9/\" target=\"_blank\" rel=\"noopener\">Learn about major features and improvements for testing in Next-level testing in Angular Ivy version 9</a>.</p><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><p>translated</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion#\"></a>Conclusion<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#conclusion\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>One of the most important goals has been to keep backwards compatibility between Ivy and View Engine as much as possible.</p><p>Of course, Angular version 9 also includes bugfixes, deprecations, and breaking changes. Ivy also addresses some long-standing issues that we did not cover in this article.</p><p>Angular Ivy is an enabler for features to come. As we have discussed in this article, Ivy has already given us benefits for different use cases. However, the best features are to come in future versions of Angular. Which of the possible features that will be delivered in Angular versions 10 and 11, that is still to be decided.</p><p>We only discussed what is part of the public, stable Angular version 9 APIs. A few experimental APIs are part of this release, such as <code>renderComponent</code>, <code>markDirty</code>, and <code>detectChanges</code>. However, they are still subject to change.</p><p>With the deprecation of entry component declarations and lazy loaded components using render modules, we are one step closer to <a href=\"https://indepth.dev/angular-revisited-tree-shakable-components-and-optional-ngmodules/\" target=\"_blank\" rel=\"noopener\">tree-shakable components and optional Angular modules</a>.</p><p><a href=\"https://indepth.dev/component-features-with-angular-ivy/\" target=\"_blank\" rel=\"noopener\">Component features</a> are also part of this release, but only exposed for internal use by Ivy.</p><p>The Angular Ivy version 9 release gives us improvements for bundling, testing, the developer experience, tooling, debugging, and type checking. Quite a good collection of features.</p><h2 id=\"Related-resources\"><a href=\"#Related-resources\" class=\"headerlink\" title=\"Related resources#\"></a>Related resources<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#related-resources\" target=\"_blank\" rel=\"noopener\">#</a></h2><h3 id=\"Lazy-loaded-components-1\"><a href=\"#Lazy-loaded-components-1\" class=\"headerlink\" title=\"Lazy loaded components#\"></a>Lazy loaded components<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#lazy-loaded-components-1\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><a href=\"https://youtu.be/DA3efofhpq4\" target=\"_blank\" rel=\"noopener\">Learn about render modules in my talk Angular revisited: Tree-shakable components and optional NgModules</a>.</p><p><a href=\"https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8\" target=\"_blank\" rel=\"noopener\">Learn how to lazy load components in Lazy load components in Angular by Kevin Kreuzer</a>.</p><h3 id=\"Template-type-checking\"><a href=\"#Template-type-checking\" class=\"headerlink\" title=\"Template type checking#\"></a>Template type checking<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#template-type-checking\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><a href=\"https://angular.io/guide/template-typecheck#troubleshooting-template-errors\" target=\"_blank\" rel=\"noopener\">Read the official guide on Angular template type checking to learn the details of troubleshooting and configuration</a>.</p><h3 id=\"Globalisation-1\"><a href=\"#Globalisation-1\" class=\"headerlink\" title=\"Globalisation#\"></a>Globalisation<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#globalisation-1\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><a href=\"https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/\" target=\"_blank\" rel=\"noopener\">Manfred Steyer discusses lazy-loading locales in Lazy Loading Locales with Angular</a>.</p><p><a href=\"https://blog.ninja-squad.com/2019/12/10/angular-localize/\" target=\"_blank\" rel=\"noopener\">Cdric Exbrayat discusses Ivy globalisation in Internationalization with @angular/localize</a>.</p><h3 id=\"Additional-provider-scopes-1\"><a href=\"#Additional-provider-scopes-1\" class=\"headerlink\" title=\"Additional provider scopes#\"></a>Additional provider scopes<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#additional-provider-scopes-1\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>Learn about the <code>&#39;any&#39;</code> and <code>&#39;platform&#39;</code> provider scopes in <a href=\"https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb\" target=\"_blank\" rel=\"noopener\">Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler</a>.</p><h3 id=\"New-debugging-API\"><a href=\"#New-debugging-API\" class=\"headerlink\" title=\"New debugging API#\"></a>New debugging API<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#new-debugging-api\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><a href=\"https://angular.io/api/core/global\" target=\"_blank\" rel=\"noopener\">Read about the full debugging API in the official documentation</a>.</p><h3 id=\"Angular-Universal-version-9\"><a href=\"#Angular-Universal-version-9\" class=\"headerlink\" title=\"Angular Universal version 9#\"></a>Angular Universal version 9<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#angular-universal-version-9\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>These two articles goes into the details of Angular Universal version 9:</p><ul><li><a href=\"https://trilon.io/blog/angular-universal-v9-whats-new\" target=\"_blank\" rel=\"noopener\">Angular Universal v9: Whats New ? by Mark Pieszak</a></li><li><a href=\"https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1\" target=\"_blank\" rel=\"noopener\">Angular v9 &amp; Universal: SSR and prerendering out of the box! by Sam Vloeberghs</a></li></ul><p>Learn about <code>angular-prerender</code>, the library that inspired these new Angular Universal features in <a href=\"https://media-codings.com/articles/prerender-angular-apps-with-a-single-command\" target=\"_blank\" rel=\"noopener\">Prerender Angular Apps with a single Command by Christoph Guttandin</a>.</p><h3 id=\"CSS-Custom-Properties-binding\"><a href=\"#CSS-Custom-Properties-binding\" class=\"headerlink\" title=\"CSS Custom Properties binding#\"></a>CSS Custom Properties binding<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#css-custom-properties-binding\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><a href=\"https://twitter.com/yurzui/status/1221159415820275717\" target=\"_blank\" rel=\"noopener\">See this tweet and demo by Alexey Zuev to see CSS Custom Properties bindings in action</a>.</p><h2 id=\"Peer-reviewers\"><a href=\"#Peer-reviewers\" class=\"headerlink\" title=\"Peer reviewers#\"></a>Peer reviewers<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#peer-reviewers\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Its always helpful to have a second opinion on our work or even just catch silly errors. For this article I had the pleasure of being reviewed by:</p><ul><li><a href=\"https://twitter.com/chrisguttandin\" target=\"_blank\" rel=\"noopener\">Christoph Guttandin</a></li><li><a href=\"https://indepth.dev/author/evgeny/\" target=\"_blank\" rel=\"noopener\">Evgeny Fedorenko</a></li><li><a href=\"https://dev.to/santoshyadav198613\" target=\"_blank\" rel=\"noopener\">Santosh Yadav</a></li></ul><p>Lars Gyrup Brink Nielsen</p>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"A-look-at-major-features-in-the-Angular-Ivy-version-9-release\"><a href=\"#A-look-at-major-features-in-the-Angular-Ivy-version-9-release\" class=\"headerlink\" title=\"A look at major features in the Angular Ivy version 9 release\"></a>A look at major features in the Angular Ivy version 9 release</h1><p><a href=\"https://admin.indepth.dev/ghost/#/editor/post/5e2f4cae430b1e0c3681c749\" target=\"_blank\" rel=\"noopener\">post editor</a></p><p><a href=\"https://indepth.dev/author/layzee/\" target=\"_blank\" rel=\"noopener\">Lars Gyrup Brink Nielsen</a>06 February, 20209 min read</p><p><img src=\"./A%20look%20at%20major%20features%20in%20the%20Angular%20Ivy%20version%209%C2%A0release%20-%20Angular%20INDEPTH_files/light-new-year-s-eve-fireworks-sylvester-40663.jpg\" alt=\"A look at major features in the Angular Ivy version 9 release\"></p><p>Cover photo by <a href=\"https://www.pexels.com/photo/light-new-year-s-eve-fireworks-sylvester-40663/\" target=\"_blank\" rel=\"noopener\">Pixabay</a> on Pexels.</p><p>AOT everywhere, dynamic globalisation, strict mode, Bazel, and much more.</p><p><em>(Yes, Angular Ivy version 9 is now released!)</em></p><h2 id=\"Ivy-is-enabled-by-default\"><a href=\"#Ivy-is-enabled-by-default\" class=\"headerlink\" title=\"Ivy is enabled by default#\"></a>Ivy is enabled by default<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#ivy-is-enabled-by-default\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>In previous versions of Angular, we had to opt-in to Ivy. In version 9, we instead have to opt-out of Ivy if we want to fall back to View Engine. This is possible in both versions 9 and 10 to ensure a smoother transition from View Engine to Ivy.</p><p>Libraries <em>can</em> be AOT-compiled, but this is not recommended. The Angular team has a View Engine-to-Ivy migration plan which recommends only publishing JIT-compiled View Engine-compatible libraries for Angular version 9. The Angular compatibility compiler will upgrade View Engine-compatible libraries to Ivy when installed in an Angular Ivy application project.</p><p><a href=\"https://indepth.dev/the-angular-ivy-guide-for-library-authors/\" target=\"_blank\" rel=\"noopener\">Learn about library compatibility and the View Engine-to-Ivy transition plan in The Angular Ivy guide for library authors</a>.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;angularCompilerOptions&quot;: &#123;</span><br><span class=\"line\">    &quot;enableIvy&quot;: false</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// polyfills.ts</span><br><span class=\"line\">// Only used in multilingual Ivy applications</span><br><span class=\"line\">// import &apos;@angular/localize/init&apos;;</span><br></pre></td></tr></table></figure><p><em>Listing 1. Opting out of Ivy to fall back to View Engine.</em></p><p>If you experience problems with Ivy in your application or any of the libraries you depend on, you can opt out of Ivy and fall back to View Engine by clearing the <code>enableIvy</code> Angular compiler option and disabling <code>@angular/localize</code> as seen in Listing 1.</p><p>Opting out of Ivy in a server environment is a bit trickier. <a href=\"https://angular.io/guide/ivy#using-ssr-without-ivy\" target=\"_blank\" rel=\"noopener\">Follow the official guide to opt out of Ivy when using server-side rendering</a>.</p><h2 id=\"The-principle-of-locality\"><a href=\"#The-principle-of-locality\" class=\"headerlink\" title=\"The principle of locality#\"></a>The principle of locality<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#the-principle-of-locality\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>To compile a component in View Engine, Angular needs information about all its declarable dependencies, their declarable dependencies, and so on. This means that Angular libraries cannot be AOT-compiled using View Engine.</p><p>To compile a component in Ivy, Angular only needs information about the component itself, except for the name and package name of its declarable dependencies. Most notably, Ivy doesnt need metadata of any declarable dependencies to compile a component.</p><p>The principle of locality means that in general we will see faster build times.</p><h3 id=\"Lazy-loaded-components\"><a href=\"#Lazy-loaded-components\" class=\"headerlink\" title=\"Lazy-loaded components#\"></a>Lazy-loaded components<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#lazy-loaded-components\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><code>entryComponents</code> declarations are deprecated as they are no longer needed. Any Ivy component can be lazy loaded and dynamically rendered.</p><p>This means that we can now lazy load and render a component without routing or Angular modules. However, in practice we have to use component render modules or feature render modules to link a components template to its declarable dependencies.</p><p>Libraries that are only used by a lazy loaded component are even bundled in lazy-loaded chunks.</p><h2 id=\"Improvements-to-differential-loading\"><a href=\"#Improvements-to-differential-loading\" class=\"headerlink\" title=\"Improvements to differential loading#\"></a>Improvements to differential loading<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improvements-to-differential-loading\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>When differential loading was introduced in Angular version 8, the build process was run once for the ES5 bundle and once for the ES2015+ bundle.</p><p>In Angular version 9, an ES2015+ bundle is output first. That bundle is then transpiled to a separate ES5 bundle. This way, we dont have to go through a full build process twice.</p><h2 id=\"AOT-compilation-everywhere\"><a href=\"#AOT-compilation-everywhere\" class=\"headerlink\" title=\"AOT compilation everywhere#\"></a>AOT compilation everywhere<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#aot-compilation-everywhere\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>AOT is enabled by default in builds, the development server and even in tests. Previously, AOT compilation was significantly slower than JIT compilation so JIT was used for development and testing. With the build and rebuild time improvements in Ivy, AOT-compilation now has a great developer experience.</p><p>When we used JIT compilation in some phases of our process and only AOT compilation in the final build, errors were detected only when doing production builds or worse, at runtime.</p><h2 id=\"Bundle-sizes\"><a href=\"#Bundle-sizes\" class=\"headerlink\" title=\"Bundle sizes#\"></a>Bundle sizes<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#bundle-sizes\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Ivy can enable smaller bundles because it uses the Ivy Instruction Set which is a set of tree-shakable runtime rendering instructions. Our bundles will only include the rendering instructions we use in our projects.</p><p>This is great for use cases such as microfrontends, Angular Elements and web apps where Angular is not controlling the entire document.</p><p>However, the difference in our bundle sizes between View Engine and Ivy will vary based on the size of our application and the 3rd party libraries we use. In general:</p><ul><li>Small and simple applications will see a considerable bundle size decrease.</li><li>Complex applications will see an increase in the main bundle, but a decrease in lazy loaded bundle sizes.</li></ul><p>This means a considerable combined bundle size decrease for big applications, but could mean an overall increase in bundle size for medium-sized applications. In both cases, the main bundles size will probably increase which is bad for the initial page load time.</p><h2 id=\"Globalisation\"><a href=\"#Globalisation\" class=\"headerlink\" title=\"Globalisation#\"></a>Globalisation<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#globalisation\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Locales (number formatting, date formatting, and other regional settings) can be dynamically loaded at runtime instead of having to be registered at compile time.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// main.ts</span><br><span class=\"line\">import &apos;@angular/localize/init&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">import &#123; loadTranslations &#125; from &apos;@angular/localize&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">loadTranslations(&#123;</span><br><span class=\"line\">  &apos;8374172394781134519&apos;: &apos;Hello, &#123;$username&#125;! Welcome to &#123;$appName&#125;.&apos;,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p><em>Listing 2. Dynamically loading translations.</em></p><p>As seen in Listing 2, translated texts can also be dynamically loaded at runtime instead of being part of our bundles.</p><p>The translated texts could be loaded from a database or a file.</p><h3 id=\"Multiple-languages-from-a-single-application-bundle\"><a href=\"#Multiple-languages-from-a-single-application-bundle\" class=\"headerlink\" title=\"Multiple languages from a single application bundle#\"></a>Multiple languages from a single application bundle<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#multiple-languages-from-a-single-application-bundle\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>To change language, we have to restart the application, but we dont have to serve a different application bundle.</p><p>This means that we canwith some setupsupport multiple languages with a single application bundle on a single hostname.</p><h3 id=\"Compile-time-inlining\"><a href=\"#Compile-time-inlining\" class=\"headerlink\" title=\"Compile time inlining#\"></a>Compile time inlining<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#compile-time-inlining\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>A localised application will now only be compiled once. Instead of multiple builds to produce a bundle per language, a bundle per language is produced by replacing <code>$localize</code> placeholders with translated texts.</p><p>We now need to add the package <code>@angular/localize</code> to support localisation (multiple languages). The good news is that we no longer have to include Angulars localisation code in our bundles if we only have a single language.</p><p>If we dont use localised templates, the <code>i18n*</code> Ivy instructions are tree shaked from our bundle.</p><h3 id=\"Localisable-texts-in-component-models-and-services\"><a href=\"#Localisable-texts-in-component-models-and-services\" class=\"headerlink\" title=\"Localisable texts in component models and services#\"></a>Localisable texts in component models and services<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#localisable-texts-in-component-models-and-services\" target=\"_blank\" rel=\"noopener\">#</a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// app.component.ts</span><br><span class=\"line\">@Component(&#123;</span><br><span class=\"line\">  template: &apos;&#123;&#123; title &#125;&#125;&apos;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">export class AppComponent &#123;</span><br><span class=\"line\">  title = $localize`Welcome to MyApp`;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listing 3. A translation text placeholder in a component model.</em></p><p>A new internationalisation feature is that we can also include placeholders for translated texts in our component models as seen in Listing 3. Previously, this was only possible in templates.</p><h2 id=\"Additional-provider-scopes\"><a href=\"#Additional-provider-scopes\" class=\"headerlink\" title=\"Additional provider scopes#\"></a>Additional provider scopes<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#additional-provider-scopes\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>We have always had Angular module scope for providers. Angular version 6 introduced the <code>&#39;root&#39;</code> provider scope and tree-shakable providers both for root and Angular module scope providers.</p><p>Angular version 9 introduces the <code>&#39;platform&#39;</code> and <code>&#39;any&#39;</code> provider scopes. Platform-scoped providers can be shared between multiple Angular applications in the same document. The <code>&#39;any&#39;</code> provider scope will share a provider per module injector. For example one service instance for the eagerly loaded main bundle and one service instance for each lazy loaded Angular module.</p><h2 id=\"Improved-developer-experience\"><a href=\"#Improved-developer-experience\" class=\"headerlink\" title=\"Improved developer experience#\"></a>Improved developer experience<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-developer-experience\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Ivy enables the Angular Language Service to support additional checks while developing. This is a big improvement to the developer experience.</p><h3 id=\"File-path-checks\"><a href=\"#File-path-checks\" class=\"headerlink\" title=\"File path checks#\"></a>File path checks<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#file-path-checks\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>The Angular Language Service continuously verifies component stylesheet and template paths.</p><h3 id=\"Template-type-checks\"><a href=\"#Template-type-checks\" class=\"headerlink\" title=\"Template type checks#\"></a>Template type checks<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#template-type-checks\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>Templates are type checked, according to the template type checking mode as described in the Strict mode section. Member names and types are verified, even in embedded views. What previously resulted in runtime errors are now detected while developing and building.</p><h2 id=\"New-debugging-API-in-development-mode\"><a href=\"#New-debugging-API-in-development-mode\" class=\"headerlink\" title=\"New debugging API in development mode#\"></a>New debugging API in development mode<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#new-debugging-api-in-development-mode\" target=\"_blank\" rel=\"noopener\">#</a></h2><p><code>ng.probe</code> has been replaced with a new debugging API in development mode. The most notable functions are <code>ng.applyChanges</code> and <code>ng.getComponent</code>.</p><h2 id=\"Strict-mode\"><a href=\"#Strict-mode\" class=\"headerlink\" title=\"Strict mode#\"></a>Strict mode<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-mode\" target=\"_blank\" rel=\"noopener\">#</a></h2><h3 id=\"Strict-workspace-schematic\"><a href=\"#Strict-workspace-schematic\" class=\"headerlink\" title=\"Strict workspace schematic#\"></a>Strict workspace schematic<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-workspace-schematic\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>The <code>ng new</code> workspace schematic now supports the <code>--strict</code> flag which defaults to off (<code>false</code>).</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new my-app --strict</span><br></pre></td></tr></table></figure><p>When enabled, this parameter adds a few strict TypeScript compiler checks as seen in Listing 4.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;compilerOptions&quot;: &#123;</span><br><span class=\"line\">    &quot;noImplicitAny&quot;: true,</span><br><span class=\"line\">    &quot;noImplicitReturns&quot;: true,</span><br><span class=\"line\">    &quot;noImplicitThis&quot;: true,</span><br><span class=\"line\">    &quot;noFallthroughCasesInSwitch&quot;: true,</span><br><span class=\"line\">    &quot;strictNullChecks&quot;: true</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listing 4. TypeScript compiler options enabled in a strict Angular workspace.</em></p><p>Curiously enough, this doesnt add the same options as if we would simply set <code>&quot;strict&quot;: true</code> in the <code>compilerOptions</code> object. Lets compare the Angular workspace strict option to the TypeScript compiler strict option.</p><p>Both have these options in common:</p><ul><li><code>noImplicitAny</code></li><li><code>noImplicitThis</code></li><li><code>strictNullChecks</code></li></ul><p>The strict Angular workspace option additionally sets these options:</p><ul><li><code>noImplicitReturns</code></li><li><code>noFallthroughCasesInSwitch</code></li></ul><p>while the strict TypeScript compiler option additionally sets these options:</p><ul><li><code>alwaysStrict</code></li><li><code>strictBindCallApply</code></li><li><code>strictFunctionTypes</code></li><li><code>strictPropertyInitialization</code></li></ul><p>Whats more, the strict Angular workspace option doesnt set template type checking to the new strict mode, only the previous full mode.</p><h3 id=\"Strict-template-type-checking\"><a href=\"#Strict-template-type-checking\" class=\"headerlink\" title=\"Strict template type checking#\"></a>Strict template type checking<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#strict-template-type-checking\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>We have had the option to enable template type checking since Angular version 5 by setting <code>&quot;fullTemplateTypeCheck&quot;: true</code> in the <code>angularCompilerOptions</code> object.</p><p>Ivy introduces strict template type checking as seen in Listing 5. When this new Angular compiler option is set, the value of<code>fullTemplateTypeCheck</code> is ignored.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;angularCompilerOptions&quot;: &#123;</span><br><span class=\"line\">    &quot;strictTemplates&quot;: true</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listing 5. Enable strict template type checking.</em></p><p>The strict template type checking verifies the types of property bindings and respects the <code>strictNullChecks</code> option. It also checks the types of template references to directives and components, including generic types. Template context variables types are also checked which is great for <code>NgFor</code> loops. The <code>$event</code> type is checked for event bindings and animations. Even the type of native DOM elements is verified with strict template type checking.</p><p>These extra checks can lead to errors and false positives under certain circumstance, for eaxmple when using libraries that are not compiled with <code>strictNullChecks</code>. To address this, strict template type checking has options to opt-out and tweak the checks. For example, <code>strictTemplates</code> is actually a shorthand for 8 different Angular compiler options.</p><h2 id=\"Improved-component-and-directive-class-inheritance\"><a href=\"#Improved-component-and-directive-class-inheritance\" class=\"headerlink\" title=\"Improved component and directive class inheritance#\"></a>Improved component and directive class inheritance<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-component-and-directive-class-inheritance\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Selectorless base classes are now supported for directives and components. Some metadata is now inherited from base component and directive classes. This makes it easier to extend for example Angular Components and Angular Router directives.</p><h2 id=\"Latest-TypeScript-versions\"><a href=\"#Latest-TypeScript-versions\" class=\"headerlink\" title=\"Latest TypeScript versions#\"></a>Latest TypeScript versions<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#latest-typescript-versions\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>TypeScript versions 3.6 and 3.7 are supported in Angular version 9. Previous TypeScript versions are no longer supported. Refer to Table 1 to compare TypeScript compatibility between all Angular versions.</p><p><a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support.csv\" target=\"_blank\" rel=\"noopener\">view raw</a> <a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv\" target=\"_blank\" rel=\"noopener\">angular-cli-node-js-typescript-support.csv</a> hosted with  by <a href=\"https://github.com/\" target=\"_blank\" rel=\"noopener\">GitHub</a></p><p><em>Table 1. Angular CLI, Angular, Node.js and TypeScript compatibility table.</em><a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3\" target=\"_blank\" rel=\"noopener\"><em>Open in new tab</em></a><em>.</em></p><p>TypeScript version 3.6 introduces these and other features:</p><ul><li>Unicode support for identifiers in modern targets</li><li>Improved developer experience for promises</li><li>Stricter type checking of generators</li></ul><p>TypeScript version 3.7 introduces these and other features that we can use with Angular version 9:</p><ul><li>Optional chaining operator (<code>?.</code>) similar to the safe navigation operator for Angular templates</li><li>Nullish coalescing operator (<code>??</code>)</li><li>Assertion functions (<code>assert parameterName is typeName</code> and <code>asserts parameterName</code>)</li><li>Top-level <code>await</code></li><li>Improved recursive type aliases</li><li>Improved developer experience for functions such as function truthy checks</li></ul><h2 id=\"Improved-server-side-rendering-with-Angular-Universal\"><a href=\"#Improved-server-side-rendering-with-Angular-Universal\" class=\"headerlink\" title=\"Improved server-side rendering with Angular Universal#\"></a>Improved server-side rendering with Angular Universal<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-server-side-rendering-with-angular-universal\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Angular Universal version 9 is released with a Node.js Express development server to provide a realistic environment during development.</p><p>Also part of this release is an Angular CLI builder to prerender static routes using <code>guess-parser</code>, inspired by <code>angular-prerender</code>. We can pass a routes file to prerender dynamic routes (routes with parameters).</p><h3 id=\"How-do-I-get-started\"><a href=\"#How-do-I-get-started\" class=\"headerlink\" title=\"How do I get started?#\"></a>How do I get started?<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#how-do-i-get-started\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>We can add Angular Universal using the command <code>ng add @nguniversal/express-engine</code>. We can then use the builder command <code>ng run myapp:serve-ssr</code> to start the server-side rendering development server with live reload. Similarly, we can use <code>ng run myapp:prerender</code> to detect static and dynamic routes and prerender them.</p><h2 id=\"Improved-styling-experience\"><a href=\"#Improved-styling-experience\" class=\"headerlink\" title=\"Improved styling experience#\"></a>Improved styling experience<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#improved-styling-experience\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Styling in Angular Ivy has been reworked. Combining static HTML classes with <code>NgStyle</code> and <code>NgClass</code> directives is now fully supported and easier to reason about.</p><h3 id=\"CSS-Custom-Properties-support\"><a href=\"#CSS-Custom-Properties-support\" class=\"headerlink\" title=\"CSS Custom Properties support#\"></a>CSS Custom Properties support<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#css-custom-properties-support\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>As part of the Ivy styling rewrite, binding CSS Custom Properties is now supported.</p><p>An example binding looks like this:</p><pre><code>&lt;div [style.--my-var]=&quot;myProperty || &apos;any value&apos;&quot;&gt;&lt;/div&gt;</code></pre><p>CSS Custom Properties have scope, so this CSS property would be scoped to the components DOM.</p><h2 id=\"Stable-Bazel-release-as-opt-in-option\"><a href=\"#Stable-Bazel-release-as-opt-in-option\" class=\"headerlink\" title=\"Stable Bazel release as opt-in option#\"></a>Stable Bazel release as opt-in option<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#stable-bazel-release-as-opt-in-option\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Bazel version 2.1 is an opt-in build automation tool for Angular version 9.</p><h3 id=\"How-do-I-get-started-1\"><a href=\"#How-do-I-get-started-1\" class=\"headerlink\" title=\"How do I get started?#\"></a>How do I get started?<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#how-do-i-get-started-1\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>To enable Bazel, use <code>ng add @angular/bazel</code> or use the <code>@angular/bazel</code> schematics collection when generating an Angular workspace.</p><p>Make sure to follow <a href=\"https://docs.bazel.build/versions/2.0.0/install.html\" target=\"_blank\" rel=\"noopener\">the Bazel installation guide</a> for your operating system.</p><h2 id=\"Angular-Components\"><a href=\"#Angular-Components\" class=\"headerlink\" title=\"Angular Components#\"></a>Angular Components<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#angular-components\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Angular version 9 comes with official components for YouTube and Google Maps. A clipboard directive and service are added to the Angular CDK.</p><h2 id=\"Testing\"><a href=\"#Testing\" class=\"headerlink\" title=\"Testing#\"></a>Testing<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#testing\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>The biggest surprise of the Angular version 9 release is the many improvements to testing. Long-standing performance issues are resolved, types are improved and new concepts are introduced.</p><p><a href=\"https://indepth.dev/next-level-testing-in-angular-ivy-version-9/\" target=\"_blank\" rel=\"noopener\">Learn about major features and improvements for testing in Next-level testing in Angular Ivy version 9</a>.</p><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><p>translated</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion#\"></a>Conclusion<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#conclusion\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>One of the most important goals has been to keep backwards compatibility between Ivy and View Engine as much as possible.</p><p>Of course, Angular version 9 also includes bugfixes, deprecations, and breaking changes. Ivy also addresses some long-standing issues that we did not cover in this article.</p><p>Angular Ivy is an enabler for features to come. As we have discussed in this article, Ivy has already given us benefits for different use cases. However, the best features are to come in future versions of Angular. Which of the possible features that will be delivered in Angular versions 10 and 11, that is still to be decided.</p><p>We only discussed what is part of the public, stable Angular version 9 APIs. A few experimental APIs are part of this release, such as <code>renderComponent</code>, <code>markDirty</code>, and <code>detectChanges</code>. However, they are still subject to change.</p><p>With the deprecation of entry component declarations and lazy loaded components using render modules, we are one step closer to <a href=\"https://indepth.dev/angular-revisited-tree-shakable-components-and-optional-ngmodules/\" target=\"_blank\" rel=\"noopener\">tree-shakable components and optional Angular modules</a>.</p><p><a href=\"https://indepth.dev/component-features-with-angular-ivy/\" target=\"_blank\" rel=\"noopener\">Component features</a> are also part of this release, but only exposed for internal use by Ivy.</p><p>The Angular Ivy version 9 release gives us improvements for bundling, testing, the developer experience, tooling, debugging, and type checking. Quite a good collection of features.</p><h2 id=\"Related-resources\"><a href=\"#Related-resources\" class=\"headerlink\" title=\"Related resources#\"></a>Related resources<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#related-resources\" target=\"_blank\" rel=\"noopener\">#</a></h2><h3 id=\"Lazy-loaded-components-1\"><a href=\"#Lazy-loaded-components-1\" class=\"headerlink\" title=\"Lazy loaded components#\"></a>Lazy loaded components<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#lazy-loaded-components-1\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><a href=\"https://youtu.be/DA3efofhpq4\" target=\"_blank\" rel=\"noopener\">Learn about render modules in my talk Angular revisited: Tree-shakable components and optional NgModules</a>.</p><p><a href=\"https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8\" target=\"_blank\" rel=\"noopener\">Learn how to lazy load components in Lazy load components in Angular by Kevin Kreuzer</a>.</p><h3 id=\"Template-type-checking\"><a href=\"#Template-type-checking\" class=\"headerlink\" title=\"Template type checking#\"></a>Template type checking<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#template-type-checking\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><a href=\"https://angular.io/guide/template-typecheck#troubleshooting-template-errors\" target=\"_blank\" rel=\"noopener\">Read the official guide on Angular template type checking to learn the details of troubleshooting and configuration</a>.</p><h3 id=\"Globalisation-1\"><a href=\"#Globalisation-1\" class=\"headerlink\" title=\"Globalisation#\"></a>Globalisation<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#globalisation-1\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><a href=\"https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/\" target=\"_blank\" rel=\"noopener\">Manfred Steyer discusses lazy-loading locales in Lazy Loading Locales with Angular</a>.</p><p><a href=\"https://blog.ninja-squad.com/2019/12/10/angular-localize/\" target=\"_blank\" rel=\"noopener\">Cdric Exbrayat discusses Ivy globalisation in Internationalization with @angular/localize</a>.</p><h3 id=\"Additional-provider-scopes-1\"><a href=\"#Additional-provider-scopes-1\" class=\"headerlink\" title=\"Additional provider scopes#\"></a>Additional provider scopes<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#additional-provider-scopes-1\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>Learn about the <code>&#39;any&#39;</code> and <code>&#39;platform&#39;</code> provider scopes in <a href=\"https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb\" target=\"_blank\" rel=\"noopener\">Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler</a>.</p><h3 id=\"New-debugging-API\"><a href=\"#New-debugging-API\" class=\"headerlink\" title=\"New debugging API#\"></a>New debugging API<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#new-debugging-api\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><a href=\"https://angular.io/api/core/global\" target=\"_blank\" rel=\"noopener\">Read about the full debugging API in the official documentation</a>.</p><h3 id=\"Angular-Universal-version-9\"><a href=\"#Angular-Universal-version-9\" class=\"headerlink\" title=\"Angular Universal version 9#\"></a>Angular Universal version 9<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#angular-universal-version-9\" target=\"_blank\" rel=\"noopener\">#</a></h3><p>These two articles goes into the details of Angular Universal version 9:</p><ul><li><a href=\"https://trilon.io/blog/angular-universal-v9-whats-new\" target=\"_blank\" rel=\"noopener\">Angular Universal v9: Whats New ? by Mark Pieszak</a></li><li><a href=\"https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1\" target=\"_blank\" rel=\"noopener\">Angular v9 &amp; Universal: SSR and prerendering out of the box! by Sam Vloeberghs</a></li></ul><p>Learn about <code>angular-prerender</code>, the library that inspired these new Angular Universal features in <a href=\"https://media-codings.com/articles/prerender-angular-apps-with-a-single-command\" target=\"_blank\" rel=\"noopener\">Prerender Angular Apps with a single Command by Christoph Guttandin</a>.</p><h3 id=\"CSS-Custom-Properties-binding\"><a href=\"#CSS-Custom-Properties-binding\" class=\"headerlink\" title=\"CSS Custom Properties binding#\"></a>CSS Custom Properties binding<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#css-custom-properties-binding\" target=\"_blank\" rel=\"noopener\">#</a></h3><p><a href=\"https://twitter.com/yurzui/status/1221159415820275717\" target=\"_blank\" rel=\"noopener\">See this tweet and demo by Alexey Zuev to see CSS Custom Properties bindings in action</a>.</p><h2 id=\"Peer-reviewers\"><a href=\"#Peer-reviewers\" class=\"headerlink\" title=\"Peer reviewers#\"></a>Peer reviewers<a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/#peer-reviewers\" target=\"_blank\" rel=\"noopener\">#</a></h2><p>Its always helpful to have a second opinion on our work or even just catch silly errors. For this article I had the pleasure of being reviewed by:</p><ul><li><a href=\"https://twitter.com/chrisguttandin\" target=\"_blank\" rel=\"noopener\">Christoph Guttandin</a></li><li><a href=\"https://indepth.dev/author/evgeny/\" target=\"_blank\" rel=\"noopener\">Evgeny Fedorenko</a></li><li><a href=\"https://dev.to/santoshyadav198613\" target=\"_blank\" rel=\"noopener\">Santosh Yadav</a></li></ul><p>Lars Gyrup Brink Nielsen</p>"},{"_content":"> Ayudita conceptual...\n>> https://www.campusmvp.es/recursos/post/angular-9-ya-esta-aqui-y-estas-son-sus-novedades.aspx\n\n# Un vistazo a las caractersticas principales en el lanzamiento de Angular Ivy versin 9\n\n[editor de publicaciones](https://admin.indepth.dev/ghost/#/editor/post/5e2f4cae430b1e0c3681c749)\n\n[Lars Gyrup Brink Nielsen](https://indepth.dev/author/layzee/) 06 de febrero de 2020 9 min de lectura\n\nMUCHO y en todas partes, globalizacin dinmica, modo estricto, Bazel y mucho ms.\n\n* (S, ahora se ha lanzado Angular Ivy versin 9) *\n\n## Ivy est habilitado por defecto\n\nEn versiones anteriores de Angular, tuvimos que optar por Ivy. En la versin 9, tenemos que optar por no participar en Ivy si queremos recurrir a View Engine. Esto es posible en ambas versiones 9 y 10 para garantizar una transicin ms fluida de View Engine a Ivy.\n\nLas libreras *se pueden* compilar AOT, pero no es recomendable. El equipo de Angular tiene un plan de migracin de View Engine a Ivy que recomienda publicar solo libreras compatibles con View Engine compiladas con JIT para Angular versin 9. El compilador de compatibilidad Angular actualizar las libreras compatibles con View Engine a Ivy cuando se instalen en una aplicacin Angular Ivy.\n\n[Obtn informacin sobre la compatibilidad de la biblioteca y el plan de transicin de View Engine-to-Ivy en \"La gua de Angular Ivy para autores de libreras\"](https://indepth.dev/the-angular-ivy-guide-for-library-authors/) .\n\n```json\n// tsconfig.json\n{\n\"angularCompilerOptions\": {\n\"enableIvy\": false\n}\n}\n```\n\n```typescript\n// polyfills.ts\n// Solo se usa en aplicaciones multilinges de Ivy\n// import '@angular/localize/init';\n```\n\n*Listado 1. Optar por no usar Ivy para recurrir a View Engine.*\n\nSi tienes problemas con Ivy en tu aplicacin, o en cualquiera de las libreras de las que depende, puedes optar por salir de Ivy y recurrir a View Engine. Hazlo desactivando la opcin del compilador angular `enableIvy` y deshabilitando` @angular/localize` como se ve en Listado 1.\n\nOptar por evitar Ivy en un entorno de servidor es un poco ms complicado. [Sigue la gua oficial para darte de baja de Ivy cuando uses la renderizacin del lado del servidor](https://angular.io/guide/ivy#using-ssr-without-ivy).\n\n## El principio de localidad\n\nAntes, para compilar un componente en View Engine, Angular necesitaba informacin sobre todas sus dependencias declaradas. Esto significa que las libreras Angular no se pueden compilar AOT usando View Engine.\n\nAhora para compilar un componente en Ivy, Angular solo necesita informacin sobre el componente en s. Pero, Ivy no necesita metadatos de ninguna dependencia declarable para compilar un componente.\n\nEl principio de localidad significa que, en general, veremos tiempos de construccin ms rpidos.\n\n### Componentes con carga diferida\n\nLas declaraciones `entryComponents` estn en desuso porque ya no son necesarias. Cualquier componente Ivy puede cargarse de forma diferida y renderizarse dinmicamente.\n\nEsto significa que ahora podemos cargar de forma diferida y renderizar un componente sin enrutamiento o mdulos Angular. Sin embargo, en la prctica an tenemos que usar mdulos para renderizar componentes o mdulos funcionales para vincular la plantilla de un componente a sus dependencias.\n\nLas libreras que solo son utilizadas por un componente con carga diferida se agrupan en fragmentos con carga diferida.\n\n## Mejoras en la carga diferencial\n\nCuando se introdujo la carga diferencial en Angular versin 8, el proceso de compilacin se ejecutaba una vez para el paquete ES5 y otra vez para el paquete ES2015+.\n\nEn Angular versin 9, primero se emite un paquete ES2015+. Ese paquete se transfiere a un paquete ES5 separado. De esta manera, no tenemos que pasar por un proceso de compilacin completo dos veces.\n\n## Compilacin AOT en todas partes\n\nAOT est habilitado de forma predeterminada en las compilaciones, el servidor de desarrollo e incluso en las pruebas. Anteriormente, la compilacin AOT era significativamente ms lenta que la compilacin JIT, por lo que JIT se usaba para el desarrollo y las pruebas. Con las mejoras de tiempo de construccin y reconstruccin en Ivy, la compilacin AOT ahora ofrece una gran experiencia al desarrollador.\n\nCuando utilizbamos la compilacin JIT en desarrollo y solo la compilacin AOT en la compilacin final, algunos errores se detectaban solo al hacer compilaciones de produccin o, peor an, en tiempo de ejecucin.\n\n## Tamaos de paquete\n\nIvy puede habilitar paquetes ms pequeos porque usa el _Ivy Instruction Set_, que es un conjunto de instrucciones de representacin de tiempo de ejecucin potencialmente **tree-shakable**. Nuestros paquetes solo incluirn las instrucciones de renderizado que realmente usamos en nuestros proyectos.\n\nEsto es ideal para casos de uso como _microfrontends_, Angular Elements y aplicaciones web donde Angular no controla todo el documento.\n\nSin embargo, la diferencia en los tamaos de nuestros paquetes entre View Engine e Ivy variar segn el tamao de nuestra aplicacin y las libreras de terceros que utilizamos. En general:\n\n- Las aplicaciones pequeas y simples vern una disminucin considerable del peso del paquete.\n- Las aplicaciones complejas vern un aumento en el fichero principal, pero una disminucin en los tamaos de paquetes con carga diferida.\n\nEsto significa una disminucin considerable del tamao de descarga combinada para aplicaciones grandes, pero podra significar un aumento en el peso total para aplicaciones medianas. En ambos casos, el tamao del paquete principal probablemente aumentar, lo que es malo para el tiempo de carga inicial de la pgina.\n\n## Globalizacin\n\nLas configuraciones regionales (formato de nmero, formato de fecha y otras configuraciones regionales) se pueden cargar dinmicamente en tiempo de ejecucin en lugar de tener que registrarse en tiempo de compilacin.\n\n```typescript\n// main.ts\nimport '@angular/localize/init';\n\nimport { loadTranslations } from '@angular/localize';\n\nloadTranslations ({\n'8374172394781134519': 'Hola, {$nombre de usuario}! Bienvenido a {$appName}. ',\n});\n```\n\n*Listado 2. Carga dinmica de traducciones.*\n\nComo se ve en el Listado 2, los textos traducidos tambin se pueden cargar dinmicamente en tiempo de ejecucin en lugar de ser parte de nuestros paquetes.\n\nLos textos traducidos pueden cargarse desde una base de datos o un archivo.\n\n### Mltiples idiomas desde un nico paquete de aplicaciones\n\nPara cambiar el idioma, tenemos que reiniciar la aplicacin, pero no tenemos que servir un fichero de aplicaciones diferente.\n\nEsto significa que podemos, con alguna configuracin, admitir varios idiomas con un solo paquete de aplicaciones en un solo nombre de host.\n\n### Tiempo de compilacin en lnea\n\nUna aplicacin localizada ahora solo se compilar una vez. En lugar de mltiples compilaciones para producir un paquete por idioma, se produce un paquete por idioma reemplazando los marcadores de posicin `$localize` con textos traducidos.\n\nAhora  hay que agregar el paquete `@angular/localize` para posibilitar la localizacin (varios idiomas). La buena noticia es que ya no tenemos que incluir el cdigo de localizacin de Angular en nuestros paquetes si solo tenemos un idioma.\n\nSi no usamos plantillas localizadas, las instrucciones de Ivy `i18n *` se sacan del paquete principal.\n\n### Textos localizables en modelos de componentes y servicios\n\n```typescript\n// app.component.ts\n@Component({\n  template: '{{ title }}'\n})\nexport class AppComponent {\n  title = $localize`Welcome to MyApp`;\n}\n```\n\n*Listado 3. Un marcador de posicin de texto de traduccin en un modelo de componente.*\n\nUna nueva caracterstica de internacionalizacin es que tambin podemos incluir marcadores de posicin para textos traducidos en el contenido de nuestros modelos como se ve en el Listado 3. Anteriormente, esto solo era posible en las plantillas.\n\n## mbitos adicionales de proveedores de dependencias\n\nSiempre hemos tenido alcance de mdulo para los proveedores de inyeccin de servicios. La versin Angular 6 introdujo el alcance `'root'` y los proveedores _tree-shakable_, tanto para los proveedores de alcance desde el mdulo raz como desde mdulos inferiores.\n\nLa versin angular 9 presenta los nuevos mbitos de proveedor `'platform'` y `'any'`. Los proveedores con mbito de `'platform'` se pueden compartir entre mltiples aplicaciones Angular en el mismo documento. El alcance del proveedor `'any'` compartir un proveedor por inyector de mdulo. Por ejemplo, una instancia de servicio para el paquete principal cargado por adelantado y una instancia de servicio para cada mdulo cargado con retraso.\n\n## Experiencia mejorada del desarrollador\n\nIvy permite que _Angular Language Service_ admita comprobaciones adicionales durante el desarrollo. Esta es una gran mejora para la experiencia del desarrollador.\n\n### Comprobaciones de ruta de archivo\n\n_Angular Language Service_ verifica continuamente la hoja de estilo de componentes y las rutas de plantilla.\n\n### Verificaciones de tipo de plantilla\n\nLas plantillas se verifican por tipo, de acuerdo con el modo de verificacin de tipo de plantilla como se describe ms abajo en la seccin \"Modo estricto\". Los nombres y tipos de miembros se verifican, incluso en vistas incrustadas. Lo que anteriormente resultaba en errores de tiempo de ejecucin ahora se detecta durante el desarrollo y la construccin.\n\n## Nueva API de depuracin en modo de desarrollo\n\n`ng.probe` ha sido reemplazado por una nueva API de depuracin en modo de desarrollo. Las funciones ms notables son `ng.applyChanges` y` ng.getComponent`.\n\n## Modo estricto\n\n### Esquema estricto del espacio de trabajo\n\nEl comando `ng new` ahora es compatible con el indicador` --strict` que por defecto est desactivado (`false`).\n\n```bash\nng new my-app --strict\n```\n\nCuando est habilitado, este parmetro agrega algunas comprobaciones estrictas del compilador TypeScript como se ve en el Listado 4.\n\n```json\n// tsconfig.json\n{\n\"compilerOptions\": {\n\"noImplicitAny\": true,\n\"noImplicitReturns\": true,\n\"noImplicitThis\": true,\n\"noFallthroughCasesInSwitch\": true,\n\"strictlyNullChecks\": true\n}\n}\n```\n\n*Listado 4. Opciones del compilador TypeScript habilitadas en un estricto espacio de trabajo angular.*\n\nCuriosamente, esto no agrega las mismas opciones que si simplemente estableciramos `\"strict\": true` en el objeto `compilerOptions`. Comparemos la opcin estricta del workscpace Angular con la opcin estricta del compilador TypeScript.\n\nAmbos tienen estas opciones en comn:\n\n- `noImplicitAny`\n- `noImplicitThis`\n- `strictlyNullChecks`\n\nLa opcin estricta de Angular establece adems estas opciones:\n\n- `noImplicitReturns`\n- `noFallthroughCasesInSwitch`\n\nmientras que la opcin estricta del compilador TypeScript establece adicionalmente estas opciones:\n\n- `alwaysStrict`\n- `strictlyBindCallApply`\n- `strictlyFunctionTypes`\n- `estrictoPropertyInitialization`\n\nAdems, la opcin de Angular no establece la comprobacin del tipo de plantilla en el nuevo modo estricto, lo deja en el modo `'full'` anterior.\n\n### Verificacin estricta del tipo de plantilla\n\nHemos tenido la opcin de habilitar la verificacin del tipo de plantilla desde Angular versin 5 configurando `\"fullTemplateTypeCheck\": true` en el objeto` angularCompilerOptions`.\n\nIvy presenta una estricta comprobacin del tipo de plantilla como se ve en el Listado 5. Cuando se establece esta nueva opcin del compilador Angular, se ignora el valor de `fullTemplateTypeCheck`.\n\n```typescript\n// tsconfig.json\n{\n\"angularCompilerOptions\": {\n\"strictlyTemplates\": true\n}\n}\n```\n\n*Listado 5. Habilita la comprobacin estricta del tipo de plantilla.*\n\nLa comprobacin de tipo de plantilla estricta verifica los tipos de enlaces de propiedades y respeta la opcin `stricNullChecks`. Tambin verifica los tipos de referencias de plantilla a directivas y componentes, incluidos los tipos genricos. Tambin se verifican los tipos de variables de contexto de plantilla, lo cual es excelente para los bucles 'NgFor'. El tipo `$ event` est marcado para enlaces de eventos y animaciones. Incluso el tipo de elementos DOM nativos se verifica con una comprobacin estricta del tipo de plantilla.\n\nEstas comprobaciones adicionales pueden conducir a errores y falsos positivos bajo ciertas circunstancias. Por ejemplo, cuando se usan libreras que no estn compiladas con `strictNullChecks`. Para abordar esto, la verificacin estricta del tipo de plantilla tiene opciones para optar por no participar y ajustar los controles. Por ejemplo, `strictTemplates` es en realidad una atajo de 8 opciones de compilador Angular.\n\n## Herencia de clase de componente y directiva mejorada\n\nLas clases base sin selector ahora son compatibles con directivas y componentes. Algunos metadatos ahora se heredan de componentes base y clases directivas. Esto hace que sea ms fcil extender, por ejemplo, las directivas Angular Components y Angular Router.\n\n## ltimas versiones de TypeScript\n\nLas versiones de TypeScript 3.6 y 3.7 son compatibles con la versin angular 9. Las versiones anteriores de TypeScript ya no son compatibles. Consulta la Tabla 1 para comparar la compatibilidad de TypeScript entre todas las versiones Angular.\n\n[ver sin formato](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support -cs-type-script-node-type-script-code-node-code-node-type. csv](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv) alojado con  por [GitHub](https://github.com/)\n\n*Tabla 1. Tabla de compatibilidad de CLI angular, Angular, Node.js y TypeScript.* [*Abrir en una pestaa nueva*](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3)*\n\nTypeScript versin 3.6 presenta estas y otras caractersticas:\n\n- Soporte Unicode para identificadores en destinos modernos\n- Experiencia de desarrollador mejorada para promesas\n- Comprobacin de tipo ms estricto de generadores\n\nTypeScript versin 3.7 presenta estas y otras caractersticas que podemos usar con Angular versin 9:\n\n- Operador de encadenamiento opcional (`?.`) similar al operador de navegacin segura para plantillas Angular\n- Operador de unin con nulos (`??`)\n- Funciones de afirmacin de pruebas (`assert parameterName is typeName` y `asserts parameterName`)\n- `await` de primer nivel\n- Alias de tipo recursivo mejorado\n- Mejora de la experiencia del desarrollador para funciones de comprobaciones\n\n## Generacin mejorada del lado del servidor con Angular Universal\n\nAngular Universal versin 9 se lanza con un servidor de desarrollo Node.js Express para proporcionar un entorno realista durante el desarrollo.\n\nTambin parte de este lanzamiento es un constructor del CLI para pre-renderizar rutas estticas usando `guess-parser`, inspirado en `angular-prerender`. Podemos pasar un archivo de rutas para renderizar rutas dinmicas (rutas con parmetros).\n\n### Cmo empiezo?\n\nPodemos agregar Angular Universal usando el comando `ng add @nguniversal/express-engine`. Luego podemos usar el comando del constructor `ng run myapp:serve-ssr` para iniciar el servidor de desarrollo de renderizado del lado del servidor con recarga en vivo. De manera similar, podemos usar `ng run myapp:prerender` para detectar rutas estticas y dinmicas y pre renderizarlas.\n\n## Experiencia de clases y estilo mejorada\n\nAl aplicacin de estilo en Angular Ivy ha sido reelaborado. La combinacin de clases HTML estticas con las directivas `NgStyle` y` NgClass` es ahora totalmente compatible y ms fcil de entender.\n\n### Soporte de propiedades personalizadas de CSS\n\nComo parte de la reescritura del estilo Ivy, ahora se admiten las propiedades personalizadas de CSS enlazadas.\n\nUn ejemplo de enlace css puede ser as:\n\n```html\n<div [style.--my-var]=\"myProperty || 'any value'\"></div>\n```\n\nLas propiedades personalizadas de CSS tienen control de alcance, por lo que esta propiedad de CSS se limitara al DOM del componente.\n\n## Lanzamiento estable de Bazel como opcin de suscripcin\n\nBazel versin 2.1 es una herramienta de automatizacin de compilacin opcional para Angular versin 9.\n\n### Cmo empiezo?\n\nPara habilitar Bazel, usa `ng add @angular/bazel` o la coleccin de esquemas `@angular/bazel` cuando generes un espacio de trabajo Angular.\n\nAsegrate de seguir [la gua de instalacin de Bazel](https://docs.bazel.build/versions/2.0.0/install.html) para tu sistema operativo.\n\n## Componentes Angular\n\nLa versin Angular 9 viene con componentes oficiales para YouTube y Google Maps. Se agreg una directiva y un servicio de portapapeles al Angular CDK.\n\n## Pruebas\n\nLa mayor sorpresa de la versin Angular versin 9 son las muchas mejoras en las pruebas. Se resuelven problemas de rendimiento, se mejoran los tipos y se introducen nuevos conceptos.\n\n[Obtn informacin sobre las principales caractersticas y mejoras para las pruebas en \"Pruebas de siguiente nivel en Angular Ivy versin 9\"](https://indepth.dev/next-level-testing-in-angular-ivy-version-9/).\n\n## Conclusin\n\nUno de los objetivos ms importantes ha sido mantener la compatibilidad hacia atrs entre Ivy y View Engine tanto como fue posible.\n\nPor supuesto, la versin Angular 9 tambin incluye correcciones de errores, temas obsoletos y cambios importantes. Ivy tambin aborda algunos problemas de antiguos que no cubrimos en este artculo.\n\nAngular Ivy es un facilitador para las caractersticas que estn por venir. Como hemos discutido en este artculo, Ivy ya nos ha dado beneficios para diferentes casos de uso. Sin embargo, las mejores caractersticas llegarn en futuras versiones de Angular. Cul de las posibles caractersticas que se entregarn en las versiones 10 y 11 de Angular est por decidir?\n\nSolo discutimos qu es parte de las API pblicas y estables de Angular versin 9. Algunas API experimentales son parte de esta versin, como `renderComponent`,` markDirty` y `detectChanges`. Sin embargo, todava estn sujetos a cambios.\n\nCon la retirada de las declaraciones de componentes de entrada y los componentes con carga diferida utilizando mdulos de representacin, estamos un paso ms cerca de [componentes que se pueden eliminar del rbol y mdulos Angular opcionales](https://indepth.dev/angular-revisited-tree-shakable-components- y-opcional-ngmodules /).\n\n[Los componentes de funcionalidad](https://indepth.dev/component-features-with-angular-ivy/) tambin forman parte de esta versin, pero solo estn expuestos para uso interno de Ivy.\n\nLa versin de Angular Ivy versin 9 nos brinda mejoras para el empaquetamiento, las pruebas, la experiencia del desarrollador, las herramientas, la depuracin y la verificacin de tipos. Toda una buena coleccin de caractersticas.\n\n## Recursos relacionados\n\n### Componentes con carga lenta\n\n[Informacin sobre los mdulos de presentacin en la charla \"Angular revisited: Tree-shakable components and optional NgModules\"](https://youtu.be/DA3efofhpq4).\n\n[Aprende a usar los componentes de carga diferida en \"Lazy load components in Angular\" por Kevin Kreuzer](https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8).\n\n### Comprobacin de tipos en plantillas\n\n[Lee la gua oficial sobre la verificacin de tipos en plantillas Angular para conocer los detalles de la resolucin de problemas y la configuracin](https://angular.io/guide/template-typecheck#troubleshooting-template-errors).\n\n### Globalizacin\n\n[Manfred Steyer analiza las configuraciones regionales de carga diferida en \"Lazy Loading Locales with Angular\"](https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/).\n\n[Cdric Exbrayat analiza la globalizacin de Ivy en \"Internationalization with @angular/localize\"](https://blog.ninja-squad.com/2019/12/10/angular-localize/).\n\n### mbitos adicionales de proveedor de dependencias\n\nObtn informacin sobre los mbitos de proveedor de `'any'` y `'platform'` en [Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler](https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb).\n\n### Nueva API de depuracin\n[Lee sobre la API de depuracin completa en la documentacin oficial](https://angular.io/api/core/global).\n\n### Angular Universal versin 9\n\nEstos dos artculos entran en detalles de Angular Universal versin 9:\n\n-   [Angular Universal v9: Whats New ? by Mark Pieszak](https://trilon.io/blog/angular-universal-v9-whats-new)\n-   [Angular v9 & Universal: SSR and prerendering out of the box! by Sam Vloeberghs](https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1)\n\nAprende sobre `angular-prerender`, la biblioteca que inspir estas nuevas caractersticas de Angular Universal en [Prerender Angular Apps with a single Command by Christoph Guttandin](https://media-codings.com/articles/prerender-angular-apps-with-a-single-command).\n\n### Enlace de propiedades personalizadas de CSS\n\n[Mira este tweet y la demostracin de Alexey Zuev para ver los enlaces de Propiedades personalizadas de CSS en accin](https://twitter.com/yurzui/status/1221159415820275717).\n\n## Revisores\n\nSiempre es til tener una segunda opinin sobre nuestro trabajo o incluso detectar errores tontos. Para este artculo tuve el placer de ser revisado por:\n\n-   [Christoph Guttandin](https://twitter.com/chrisguttandin)\n-   [Evgeny Fedorenko](https://indepth.dev/author/evgeny/)\n-   [Santosh Yadav](https://dev.to/santoshyadav198613)\n\nLars Gyrup Brink Nielsen","source":"angular_9-translate.md","raw":"> Ayudita conceptual...\n>> https://www.campusmvp.es/recursos/post/angular-9-ya-esta-aqui-y-estas-son-sus-novedades.aspx\n\n# Un vistazo a las caractersticas principales en el lanzamiento de Angular Ivy versin 9\n\n[editor de publicaciones](https://admin.indepth.dev/ghost/#/editor/post/5e2f4cae430b1e0c3681c749)\n\n[Lars Gyrup Brink Nielsen](https://indepth.dev/author/layzee/) 06 de febrero de 2020 9 min de lectura\n\nMUCHO y en todas partes, globalizacin dinmica, modo estricto, Bazel y mucho ms.\n\n* (S, ahora se ha lanzado Angular Ivy versin 9) *\n\n## Ivy est habilitado por defecto\n\nEn versiones anteriores de Angular, tuvimos que optar por Ivy. En la versin 9, tenemos que optar por no participar en Ivy si queremos recurrir a View Engine. Esto es posible en ambas versiones 9 y 10 para garantizar una transicin ms fluida de View Engine a Ivy.\n\nLas libreras *se pueden* compilar AOT, pero no es recomendable. El equipo de Angular tiene un plan de migracin de View Engine a Ivy que recomienda publicar solo libreras compatibles con View Engine compiladas con JIT para Angular versin 9. El compilador de compatibilidad Angular actualizar las libreras compatibles con View Engine a Ivy cuando se instalen en una aplicacin Angular Ivy.\n\n[Obtn informacin sobre la compatibilidad de la biblioteca y el plan de transicin de View Engine-to-Ivy en \"La gua de Angular Ivy para autores de libreras\"](https://indepth.dev/the-angular-ivy-guide-for-library-authors/) .\n\n```json\n// tsconfig.json\n{\n\"angularCompilerOptions\": {\n\"enableIvy\": false\n}\n}\n```\n\n```typescript\n// polyfills.ts\n// Solo se usa en aplicaciones multilinges de Ivy\n// import '@angular/localize/init';\n```\n\n*Listado 1. Optar por no usar Ivy para recurrir a View Engine.*\n\nSi tienes problemas con Ivy en tu aplicacin, o en cualquiera de las libreras de las que depende, puedes optar por salir de Ivy y recurrir a View Engine. Hazlo desactivando la opcin del compilador angular `enableIvy` y deshabilitando` @angular/localize` como se ve en Listado 1.\n\nOptar por evitar Ivy en un entorno de servidor es un poco ms complicado. [Sigue la gua oficial para darte de baja de Ivy cuando uses la renderizacin del lado del servidor](https://angular.io/guide/ivy#using-ssr-without-ivy).\n\n## El principio de localidad\n\nAntes, para compilar un componente en View Engine, Angular necesitaba informacin sobre todas sus dependencias declaradas. Esto significa que las libreras Angular no se pueden compilar AOT usando View Engine.\n\nAhora para compilar un componente en Ivy, Angular solo necesita informacin sobre el componente en s. Pero, Ivy no necesita metadatos de ninguna dependencia declarable para compilar un componente.\n\nEl principio de localidad significa que, en general, veremos tiempos de construccin ms rpidos.\n\n### Componentes con carga diferida\n\nLas declaraciones `entryComponents` estn en desuso porque ya no son necesarias. Cualquier componente Ivy puede cargarse de forma diferida y renderizarse dinmicamente.\n\nEsto significa que ahora podemos cargar de forma diferida y renderizar un componente sin enrutamiento o mdulos Angular. Sin embargo, en la prctica an tenemos que usar mdulos para renderizar componentes o mdulos funcionales para vincular la plantilla de un componente a sus dependencias.\n\nLas libreras que solo son utilizadas por un componente con carga diferida se agrupan en fragmentos con carga diferida.\n\n## Mejoras en la carga diferencial\n\nCuando se introdujo la carga diferencial en Angular versin 8, el proceso de compilacin se ejecutaba una vez para el paquete ES5 y otra vez para el paquete ES2015+.\n\nEn Angular versin 9, primero se emite un paquete ES2015+. Ese paquete se transfiere a un paquete ES5 separado. De esta manera, no tenemos que pasar por un proceso de compilacin completo dos veces.\n\n## Compilacin AOT en todas partes\n\nAOT est habilitado de forma predeterminada en las compilaciones, el servidor de desarrollo e incluso en las pruebas. Anteriormente, la compilacin AOT era significativamente ms lenta que la compilacin JIT, por lo que JIT se usaba para el desarrollo y las pruebas. Con las mejoras de tiempo de construccin y reconstruccin en Ivy, la compilacin AOT ahora ofrece una gran experiencia al desarrollador.\n\nCuando utilizbamos la compilacin JIT en desarrollo y solo la compilacin AOT en la compilacin final, algunos errores se detectaban solo al hacer compilaciones de produccin o, peor an, en tiempo de ejecucin.\n\n## Tamaos de paquete\n\nIvy puede habilitar paquetes ms pequeos porque usa el _Ivy Instruction Set_, que es un conjunto de instrucciones de representacin de tiempo de ejecucin potencialmente **tree-shakable**. Nuestros paquetes solo incluirn las instrucciones de renderizado que realmente usamos en nuestros proyectos.\n\nEsto es ideal para casos de uso como _microfrontends_, Angular Elements y aplicaciones web donde Angular no controla todo el documento.\n\nSin embargo, la diferencia en los tamaos de nuestros paquetes entre View Engine e Ivy variar segn el tamao de nuestra aplicacin y las libreras de terceros que utilizamos. En general:\n\n- Las aplicaciones pequeas y simples vern una disminucin considerable del peso del paquete.\n- Las aplicaciones complejas vern un aumento en el fichero principal, pero una disminucin en los tamaos de paquetes con carga diferida.\n\nEsto significa una disminucin considerable del tamao de descarga combinada para aplicaciones grandes, pero podra significar un aumento en el peso total para aplicaciones medianas. En ambos casos, el tamao del paquete principal probablemente aumentar, lo que es malo para el tiempo de carga inicial de la pgina.\n\n## Globalizacin\n\nLas configuraciones regionales (formato de nmero, formato de fecha y otras configuraciones regionales) se pueden cargar dinmicamente en tiempo de ejecucin en lugar de tener que registrarse en tiempo de compilacin.\n\n```typescript\n// main.ts\nimport '@angular/localize/init';\n\nimport { loadTranslations } from '@angular/localize';\n\nloadTranslations ({\n'8374172394781134519': 'Hola, {$nombre de usuario}! Bienvenido a {$appName}. ',\n});\n```\n\n*Listado 2. Carga dinmica de traducciones.*\n\nComo se ve en el Listado 2, los textos traducidos tambin se pueden cargar dinmicamente en tiempo de ejecucin en lugar de ser parte de nuestros paquetes.\n\nLos textos traducidos pueden cargarse desde una base de datos o un archivo.\n\n### Mltiples idiomas desde un nico paquete de aplicaciones\n\nPara cambiar el idioma, tenemos que reiniciar la aplicacin, pero no tenemos que servir un fichero de aplicaciones diferente.\n\nEsto significa que podemos, con alguna configuracin, admitir varios idiomas con un solo paquete de aplicaciones en un solo nombre de host.\n\n### Tiempo de compilacin en lnea\n\nUna aplicacin localizada ahora solo se compilar una vez. En lugar de mltiples compilaciones para producir un paquete por idioma, se produce un paquete por idioma reemplazando los marcadores de posicin `$localize` con textos traducidos.\n\nAhora  hay que agregar el paquete `@angular/localize` para posibilitar la localizacin (varios idiomas). La buena noticia es que ya no tenemos que incluir el cdigo de localizacin de Angular en nuestros paquetes si solo tenemos un idioma.\n\nSi no usamos plantillas localizadas, las instrucciones de Ivy `i18n *` se sacan del paquete principal.\n\n### Textos localizables en modelos de componentes y servicios\n\n```typescript\n// app.component.ts\n@Component({\n  template: '{{ title }}'\n})\nexport class AppComponent {\n  title = $localize`Welcome to MyApp`;\n}\n```\n\n*Listado 3. Un marcador de posicin de texto de traduccin en un modelo de componente.*\n\nUna nueva caracterstica de internacionalizacin es que tambin podemos incluir marcadores de posicin para textos traducidos en el contenido de nuestros modelos como se ve en el Listado 3. Anteriormente, esto solo era posible en las plantillas.\n\n## mbitos adicionales de proveedores de dependencias\n\nSiempre hemos tenido alcance de mdulo para los proveedores de inyeccin de servicios. La versin Angular 6 introdujo el alcance `'root'` y los proveedores _tree-shakable_, tanto para los proveedores de alcance desde el mdulo raz como desde mdulos inferiores.\n\nLa versin angular 9 presenta los nuevos mbitos de proveedor `'platform'` y `'any'`. Los proveedores con mbito de `'platform'` se pueden compartir entre mltiples aplicaciones Angular en el mismo documento. El alcance del proveedor `'any'` compartir un proveedor por inyector de mdulo. Por ejemplo, una instancia de servicio para el paquete principal cargado por adelantado y una instancia de servicio para cada mdulo cargado con retraso.\n\n## Experiencia mejorada del desarrollador\n\nIvy permite que _Angular Language Service_ admita comprobaciones adicionales durante el desarrollo. Esta es una gran mejora para la experiencia del desarrollador.\n\n### Comprobaciones de ruta de archivo\n\n_Angular Language Service_ verifica continuamente la hoja de estilo de componentes y las rutas de plantilla.\n\n### Verificaciones de tipo de plantilla\n\nLas plantillas se verifican por tipo, de acuerdo con el modo de verificacin de tipo de plantilla como se describe ms abajo en la seccin \"Modo estricto\". Los nombres y tipos de miembros se verifican, incluso en vistas incrustadas. Lo que anteriormente resultaba en errores de tiempo de ejecucin ahora se detecta durante el desarrollo y la construccin.\n\n## Nueva API de depuracin en modo de desarrollo\n\n`ng.probe` ha sido reemplazado por una nueva API de depuracin en modo de desarrollo. Las funciones ms notables son `ng.applyChanges` y` ng.getComponent`.\n\n## Modo estricto\n\n### Esquema estricto del espacio de trabajo\n\nEl comando `ng new` ahora es compatible con el indicador` --strict` que por defecto est desactivado (`false`).\n\n```bash\nng new my-app --strict\n```\n\nCuando est habilitado, este parmetro agrega algunas comprobaciones estrictas del compilador TypeScript como se ve en el Listado 4.\n\n```json\n// tsconfig.json\n{\n\"compilerOptions\": {\n\"noImplicitAny\": true,\n\"noImplicitReturns\": true,\n\"noImplicitThis\": true,\n\"noFallthroughCasesInSwitch\": true,\n\"strictlyNullChecks\": true\n}\n}\n```\n\n*Listado 4. Opciones del compilador TypeScript habilitadas en un estricto espacio de trabajo angular.*\n\nCuriosamente, esto no agrega las mismas opciones que si simplemente estableciramos `\"strict\": true` en el objeto `compilerOptions`. Comparemos la opcin estricta del workscpace Angular con la opcin estricta del compilador TypeScript.\n\nAmbos tienen estas opciones en comn:\n\n- `noImplicitAny`\n- `noImplicitThis`\n- `strictlyNullChecks`\n\nLa opcin estricta de Angular establece adems estas opciones:\n\n- `noImplicitReturns`\n- `noFallthroughCasesInSwitch`\n\nmientras que la opcin estricta del compilador TypeScript establece adicionalmente estas opciones:\n\n- `alwaysStrict`\n- `strictlyBindCallApply`\n- `strictlyFunctionTypes`\n- `estrictoPropertyInitialization`\n\nAdems, la opcin de Angular no establece la comprobacin del tipo de plantilla en el nuevo modo estricto, lo deja en el modo `'full'` anterior.\n\n### Verificacin estricta del tipo de plantilla\n\nHemos tenido la opcin de habilitar la verificacin del tipo de plantilla desde Angular versin 5 configurando `\"fullTemplateTypeCheck\": true` en el objeto` angularCompilerOptions`.\n\nIvy presenta una estricta comprobacin del tipo de plantilla como se ve en el Listado 5. Cuando se establece esta nueva opcin del compilador Angular, se ignora el valor de `fullTemplateTypeCheck`.\n\n```typescript\n// tsconfig.json\n{\n\"angularCompilerOptions\": {\n\"strictlyTemplates\": true\n}\n}\n```\n\n*Listado 5. Habilita la comprobacin estricta del tipo de plantilla.*\n\nLa comprobacin de tipo de plantilla estricta verifica los tipos de enlaces de propiedades y respeta la opcin `stricNullChecks`. Tambin verifica los tipos de referencias de plantilla a directivas y componentes, incluidos los tipos genricos. Tambin se verifican los tipos de variables de contexto de plantilla, lo cual es excelente para los bucles 'NgFor'. El tipo `$ event` est marcado para enlaces de eventos y animaciones. Incluso el tipo de elementos DOM nativos se verifica con una comprobacin estricta del tipo de plantilla.\n\nEstas comprobaciones adicionales pueden conducir a errores y falsos positivos bajo ciertas circunstancias. Por ejemplo, cuando se usan libreras que no estn compiladas con `strictNullChecks`. Para abordar esto, la verificacin estricta del tipo de plantilla tiene opciones para optar por no participar y ajustar los controles. Por ejemplo, `strictTemplates` es en realidad una atajo de 8 opciones de compilador Angular.\n\n## Herencia de clase de componente y directiva mejorada\n\nLas clases base sin selector ahora son compatibles con directivas y componentes. Algunos metadatos ahora se heredan de componentes base y clases directivas. Esto hace que sea ms fcil extender, por ejemplo, las directivas Angular Components y Angular Router.\n\n## ltimas versiones de TypeScript\n\nLas versiones de TypeScript 3.6 y 3.7 son compatibles con la versin angular 9. Las versiones anteriores de TypeScript ya no son compatibles. Consulta la Tabla 1 para comparar la compatibilidad de TypeScript entre todas las versiones Angular.\n\n[ver sin formato](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support -cs-type-script-node-type-script-code-node-code-node-type. csv](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv) alojado con  por [GitHub](https://github.com/)\n\n*Tabla 1. Tabla de compatibilidad de CLI angular, Angular, Node.js y TypeScript.* [*Abrir en una pestaa nueva*](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3)*\n\nTypeScript versin 3.6 presenta estas y otras caractersticas:\n\n- Soporte Unicode para identificadores en destinos modernos\n- Experiencia de desarrollador mejorada para promesas\n- Comprobacin de tipo ms estricto de generadores\n\nTypeScript versin 3.7 presenta estas y otras caractersticas que podemos usar con Angular versin 9:\n\n- Operador de encadenamiento opcional (`?.`) similar al operador de navegacin segura para plantillas Angular\n- Operador de unin con nulos (`??`)\n- Funciones de afirmacin de pruebas (`assert parameterName is typeName` y `asserts parameterName`)\n- `await` de primer nivel\n- Alias de tipo recursivo mejorado\n- Mejora de la experiencia del desarrollador para funciones de comprobaciones\n\n## Generacin mejorada del lado del servidor con Angular Universal\n\nAngular Universal versin 9 se lanza con un servidor de desarrollo Node.js Express para proporcionar un entorno realista durante el desarrollo.\n\nTambin parte de este lanzamiento es un constructor del CLI para pre-renderizar rutas estticas usando `guess-parser`, inspirado en `angular-prerender`. Podemos pasar un archivo de rutas para renderizar rutas dinmicas (rutas con parmetros).\n\n### Cmo empiezo?\n\nPodemos agregar Angular Universal usando el comando `ng add @nguniversal/express-engine`. Luego podemos usar el comando del constructor `ng run myapp:serve-ssr` para iniciar el servidor de desarrollo de renderizado del lado del servidor con recarga en vivo. De manera similar, podemos usar `ng run myapp:prerender` para detectar rutas estticas y dinmicas y pre renderizarlas.\n\n## Experiencia de clases y estilo mejorada\n\nAl aplicacin de estilo en Angular Ivy ha sido reelaborado. La combinacin de clases HTML estticas con las directivas `NgStyle` y` NgClass` es ahora totalmente compatible y ms fcil de entender.\n\n### Soporte de propiedades personalizadas de CSS\n\nComo parte de la reescritura del estilo Ivy, ahora se admiten las propiedades personalizadas de CSS enlazadas.\n\nUn ejemplo de enlace css puede ser as:\n\n```html\n<div [style.--my-var]=\"myProperty || 'any value'\"></div>\n```\n\nLas propiedades personalizadas de CSS tienen control de alcance, por lo que esta propiedad de CSS se limitara al DOM del componente.\n\n## Lanzamiento estable de Bazel como opcin de suscripcin\n\nBazel versin 2.1 es una herramienta de automatizacin de compilacin opcional para Angular versin 9.\n\n### Cmo empiezo?\n\nPara habilitar Bazel, usa `ng add @angular/bazel` o la coleccin de esquemas `@angular/bazel` cuando generes un espacio de trabajo Angular.\n\nAsegrate de seguir [la gua de instalacin de Bazel](https://docs.bazel.build/versions/2.0.0/install.html) para tu sistema operativo.\n\n## Componentes Angular\n\nLa versin Angular 9 viene con componentes oficiales para YouTube y Google Maps. Se agreg una directiva y un servicio de portapapeles al Angular CDK.\n\n## Pruebas\n\nLa mayor sorpresa de la versin Angular versin 9 son las muchas mejoras en las pruebas. Se resuelven problemas de rendimiento, se mejoran los tipos y se introducen nuevos conceptos.\n\n[Obtn informacin sobre las principales caractersticas y mejoras para las pruebas en \"Pruebas de siguiente nivel en Angular Ivy versin 9\"](https://indepth.dev/next-level-testing-in-angular-ivy-version-9/).\n\n## Conclusin\n\nUno de los objetivos ms importantes ha sido mantener la compatibilidad hacia atrs entre Ivy y View Engine tanto como fue posible.\n\nPor supuesto, la versin Angular 9 tambin incluye correcciones de errores, temas obsoletos y cambios importantes. Ivy tambin aborda algunos problemas de antiguos que no cubrimos en este artculo.\n\nAngular Ivy es un facilitador para las caractersticas que estn por venir. Como hemos discutido en este artculo, Ivy ya nos ha dado beneficios para diferentes casos de uso. Sin embargo, las mejores caractersticas llegarn en futuras versiones de Angular. Cul de las posibles caractersticas que se entregarn en las versiones 10 y 11 de Angular est por decidir?\n\nSolo discutimos qu es parte de las API pblicas y estables de Angular versin 9. Algunas API experimentales son parte de esta versin, como `renderComponent`,` markDirty` y `detectChanges`. Sin embargo, todava estn sujetos a cambios.\n\nCon la retirada de las declaraciones de componentes de entrada y los componentes con carga diferida utilizando mdulos de representacin, estamos un paso ms cerca de [componentes que se pueden eliminar del rbol y mdulos Angular opcionales](https://indepth.dev/angular-revisited-tree-shakable-components- y-opcional-ngmodules /).\n\n[Los componentes de funcionalidad](https://indepth.dev/component-features-with-angular-ivy/) tambin forman parte de esta versin, pero solo estn expuestos para uso interno de Ivy.\n\nLa versin de Angular Ivy versin 9 nos brinda mejoras para el empaquetamiento, las pruebas, la experiencia del desarrollador, las herramientas, la depuracin y la verificacin de tipos. Toda una buena coleccin de caractersticas.\n\n## Recursos relacionados\n\n### Componentes con carga lenta\n\n[Informacin sobre los mdulos de presentacin en la charla \"Angular revisited: Tree-shakable components and optional NgModules\"](https://youtu.be/DA3efofhpq4).\n\n[Aprende a usar los componentes de carga diferida en \"Lazy load components in Angular\" por Kevin Kreuzer](https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8).\n\n### Comprobacin de tipos en plantillas\n\n[Lee la gua oficial sobre la verificacin de tipos en plantillas Angular para conocer los detalles de la resolucin de problemas y la configuracin](https://angular.io/guide/template-typecheck#troubleshooting-template-errors).\n\n### Globalizacin\n\n[Manfred Steyer analiza las configuraciones regionales de carga diferida en \"Lazy Loading Locales with Angular\"](https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/).\n\n[Cdric Exbrayat analiza la globalizacin de Ivy en \"Internationalization with @angular/localize\"](https://blog.ninja-squad.com/2019/12/10/angular-localize/).\n\n### mbitos adicionales de proveedor de dependencias\n\nObtn informacin sobre los mbitos de proveedor de `'any'` y `'platform'` en [Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler](https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb).\n\n### Nueva API de depuracin\n[Lee sobre la API de depuracin completa en la documentacin oficial](https://angular.io/api/core/global).\n\n### Angular Universal versin 9\n\nEstos dos artculos entran en detalles de Angular Universal versin 9:\n\n-   [Angular Universal v9: Whats New ? by Mark Pieszak](https://trilon.io/blog/angular-universal-v9-whats-new)\n-   [Angular v9 & Universal: SSR and prerendering out of the box! by Sam Vloeberghs](https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1)\n\nAprende sobre `angular-prerender`, la biblioteca que inspir estas nuevas caractersticas de Angular Universal en [Prerender Angular Apps with a single Command by Christoph Guttandin](https://media-codings.com/articles/prerender-angular-apps-with-a-single-command).\n\n### Enlace de propiedades personalizadas de CSS\n\n[Mira este tweet y la demostracin de Alexey Zuev para ver los enlaces de Propiedades personalizadas de CSS en accin](https://twitter.com/yurzui/status/1221159415820275717).\n\n## Revisores\n\nSiempre es til tener una segunda opinin sobre nuestro trabajo o incluso detectar errores tontos. Para este artculo tuve el placer de ser revisado por:\n\n-   [Christoph Guttandin](https://twitter.com/chrisguttandin)\n-   [Evgeny Fedorenko](https://indepth.dev/author/evgeny/)\n-   [Santosh Yadav](https://dev.to/santoshyadav198613)\n\nLars Gyrup Brink Nielsen","date":"2020-02-18T16:19:24.730Z","updated":"2020-02-18T16:19:24.730Z","path":"angular_9-translate.html","title":"","comments":1,"layout":"page","_id":"ck70maaxt0002bss34kjk51gf","content":"<blockquote><p>Ayudita conceptual</p><blockquote><p><a href=\"https://www.campusmvp.es/recursos/post/angular-9-ya-esta-aqui-y-estas-son-sus-novedades.aspx\" target=\"_blank\" rel=\"noopener\">https://www.campusmvp.es/recursos/post/angular-9-ya-esta-aqui-y-estas-son-sus-novedades.aspx</a></p></blockquote></blockquote><h1 id=\"Un-vistazo-a-las-caracteristicas-principales-en-el-lanzamiento-de-Angular-Ivy-version-9\"><a href=\"#Un-vistazo-a-las-caracteristicas-principales-en-el-lanzamiento-de-Angular-Ivy-version-9\" class=\"headerlink\" title=\"Un vistazo a las caractersticas principales en el lanzamiento de Angular Ivy versin 9\"></a>Un vistazo a las caractersticas principales en el lanzamiento de Angular Ivy versin 9</h1><p><a href=\"https://admin.indepth.dev/ghost/#/editor/post/5e2f4cae430b1e0c3681c749\" target=\"_blank\" rel=\"noopener\">editor de publicaciones</a></p><p><a href=\"https://indepth.dev/author/layzee/\" target=\"_blank\" rel=\"noopener\">Lars Gyrup Brink Nielsen</a> 06 de febrero de 2020 9 min de lectura</p><p>MUCHO y en todas partes, globalizacin dinmica, modo estricto, Bazel y mucho ms.</p><ul><li>(S, ahora se ha lanzado Angular Ivy versin 9) *</li></ul><h2 id=\"Ivy-esta-habilitado-por-defecto\"><a href=\"#Ivy-esta-habilitado-por-defecto\" class=\"headerlink\" title=\"Ivy est habilitado por defecto\"></a>Ivy est habilitado por defecto</h2><p>En versiones anteriores de Angular, tuvimos que optar por Ivy. En la versin 9, tenemos que optar por no participar en Ivy si queremos recurrir a View Engine. Esto es posible en ambas versiones 9 y 10 para garantizar una transicin ms fluida de View Engine a Ivy.</p><p>Las libreras <em>se pueden</em> compilar AOT, pero no es recomendable. El equipo de Angular tiene un plan de migracin de View Engine a Ivy que recomienda publicar solo libreras compatibles con View Engine compiladas con JIT para Angular versin 9. El compilador de compatibilidad Angular actualizar las libreras compatibles con View Engine a Ivy cuando se instalen en una aplicacin Angular Ivy.</p><p><a href=\"https://indepth.dev/the-angular-ivy-guide-for-library-authors/\" target=\"_blank\" rel=\"noopener\">Obtn informacin sobre la compatibilidad de la biblioteca y el plan de transicin de View Engine-to-Ivy en La gua de Angular Ivy para autores de libreras</a> .</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"attr\">\"angularCompilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"attr\">\"enableIvy\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// polyfills.ts</span></span><br><span class=\"line\"><span class=\"comment\">// Solo se usa en aplicaciones multilinges de Ivy</span></span><br><span class=\"line\"><span class=\"comment\">// import '@angular/localize/init';</span></span><br></pre></td></tr></table></figure><p><em>Listado 1. Optar por no usar Ivy para recurrir a View Engine.</em></p><p>Si tienes problemas con Ivy en tu aplicacin, o en cualquiera de las libreras de las que depende, puedes optar por salir de Ivy y recurrir a View Engine. Hazlo desactivando la opcin del compilador angular <code>enableIvy</code> y deshabilitando<code>@angular/localize</code> como se ve en Listado 1.</p><p>Optar por evitar Ivy en un entorno de servidor es un poco ms complicado. <a href=\"https://angular.io/guide/ivy#using-ssr-without-ivy\" target=\"_blank\" rel=\"noopener\">Sigue la gua oficial para darte de baja de Ivy cuando uses la renderizacin del lado del servidor</a>.</p><h2 id=\"El-principio-de-localidad\"><a href=\"#El-principio-de-localidad\" class=\"headerlink\" title=\"El principio de localidad\"></a>El principio de localidad</h2><p>Antes, para compilar un componente en View Engine, Angular necesitaba informacin sobre todas sus dependencias declaradas. Esto significa que las libreras Angular no se pueden compilar AOT usando View Engine.</p><p>Ahora para compilar un componente en Ivy, Angular solo necesita informacin sobre el componente en s. Pero, Ivy no necesita metadatos de ninguna dependencia declarable para compilar un componente.</p><p>El principio de localidad significa que, en general, veremos tiempos de construccin ms rpidos.</p><h3 id=\"Componentes-con-carga-diferida\"><a href=\"#Componentes-con-carga-diferida\" class=\"headerlink\" title=\"Componentes con carga diferida\"></a>Componentes con carga diferida</h3><p>Las declaraciones <code>entryComponents</code> estn en desuso porque ya no son necesarias. Cualquier componente Ivy puede cargarse de forma diferida y renderizarse dinmicamente.</p><p>Esto significa que ahora podemos cargar de forma diferida y renderizar un componente sin enrutamiento o mdulos Angular. Sin embargo, en la prctica an tenemos que usar mdulos para renderizar componentes o mdulos funcionales para vincular la plantilla de un componente a sus dependencias.</p><p>Las libreras que solo son utilizadas por un componente con carga diferida se agrupan en fragmentos con carga diferida.</p><h2 id=\"Mejoras-en-la-carga-diferencial\"><a href=\"#Mejoras-en-la-carga-diferencial\" class=\"headerlink\" title=\"Mejoras en la carga diferencial\"></a>Mejoras en la carga diferencial</h2><p>Cuando se introdujo la carga diferencial en Angular versin 8, el proceso de compilacin se ejecutaba una vez para el paquete ES5 y otra vez para el paquete ES2015+.</p><p>En Angular versin 9, primero se emite un paquete ES2015+. Ese paquete se transfiere a un paquete ES5 separado. De esta manera, no tenemos que pasar por un proceso de compilacin completo dos veces.</p><h2 id=\"Compilacion-AOT-en-todas-partes\"><a href=\"#Compilacion-AOT-en-todas-partes\" class=\"headerlink\" title=\"Compilacin AOT en todas partes\"></a>Compilacin AOT en todas partes</h2><p>AOT est habilitado de forma predeterminada en las compilaciones, el servidor de desarrollo e incluso en las pruebas. Anteriormente, la compilacin AOT era significativamente ms lenta que la compilacin JIT, por lo que JIT se usaba para el desarrollo y las pruebas. Con las mejoras de tiempo de construccin y reconstruccin en Ivy, la compilacin AOT ahora ofrece una gran experiencia al desarrollador.</p><p>Cuando utilizbamos la compilacin JIT en desarrollo y solo la compilacin AOT en la compilacin final, algunos errores se detectaban solo al hacer compilaciones de produccin o, peor an, en tiempo de ejecucin.</p><h2 id=\"Tamanos-de-paquete\"><a href=\"#Tamanos-de-paquete\" class=\"headerlink\" title=\"Tamaos de paquete\"></a>Tamaos de paquete</h2><p>Ivy puede habilitar paquetes ms pequeos porque usa el <em>Ivy Instruction Set</em>, que es un conjunto de instrucciones de representacin de tiempo de ejecucin potencialmente <strong>tree-shakable</strong>. Nuestros paquetes solo incluirn las instrucciones de renderizado que realmente usamos en nuestros proyectos.</p><p>Esto es ideal para casos de uso como <em>microfrontends</em>, Angular Elements y aplicaciones web donde Angular no controla todo el documento.</p><p>Sin embargo, la diferencia en los tamaos de nuestros paquetes entre View Engine e Ivy variar segn el tamao de nuestra aplicacin y las libreras de terceros que utilizamos. En general:</p><ul><li>Las aplicaciones pequeas y simples vern una disminucin considerable del peso del paquete.</li><li>Las aplicaciones complejas vern un aumento en el fichero principal, pero una disminucin en los tamaos de paquetes con carga diferida.</li></ul><p>Esto significa una disminucin considerable del tamao de descarga combinada para aplicaciones grandes, pero podra significar un aumento en el peso total para aplicaciones medianas. En ambos casos, el tamao del paquete principal probablemente aumentar, lo que es malo para el tiempo de carga inicial de la pgina.</p><h2 id=\"Globalizacion\"><a href=\"#Globalizacion\" class=\"headerlink\" title=\"Globalizacin\"></a>Globalizacin</h2><p>Las configuraciones regionales (formato de nmero, formato de fecha y otras configuraciones regionales) se pueden cargar dinmicamente en tiempo de ejecucin en lugar de tener que registrarse en tiempo de compilacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// main.ts</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'@angular/localize/init'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; loadTranslations &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/localize'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">loadTranslations (&#123;</span><br><span class=\"line\"><span class=\"string\">'8374172394781134519'</span>: <span class=\"string\">'Hola, &#123;$nombre de usuario&#125;! Bienvenido a &#123;$appName&#125;. '</span>,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p><em>Listado 2. Carga dinmica de traducciones.</em></p><p>Como se ve en el Listado 2, los textos traducidos tambin se pueden cargar dinmicamente en tiempo de ejecucin en lugar de ser parte de nuestros paquetes.</p><p>Los textos traducidos pueden cargarse desde una base de datos o un archivo.</p><h3 id=\"Multiples-idiomas-desde-un-unico-paquete-de-aplicaciones\"><a href=\"#Multiples-idiomas-desde-un-unico-paquete-de-aplicaciones\" class=\"headerlink\" title=\"Mltiples idiomas desde un nico paquete de aplicaciones\"></a>Mltiples idiomas desde un nico paquete de aplicaciones</h3><p>Para cambiar el idioma, tenemos que reiniciar la aplicacin, pero no tenemos que servir un fichero de aplicaciones diferente.</p><p>Esto significa que podemos, con alguna configuracin, admitir varios idiomas con un solo paquete de aplicaciones en un solo nombre de host.</p><h3 id=\"Tiempo-de-compilacion-en-linea\"><a href=\"#Tiempo-de-compilacion-en-linea\" class=\"headerlink\" title=\"Tiempo de compilacin en lnea\"></a>Tiempo de compilacin en lnea</h3><p>Una aplicacin localizada ahora solo se compilar una vez. En lugar de mltiples compilaciones para producir un paquete por idioma, se produce un paquete por idioma reemplazando los marcadores de posicin <code>$localize</code> con textos traducidos.</p><p>Ahora hay que agregar el paquete <code>@angular/localize</code> para posibilitar la localizacin (varios idiomas). La buena noticia es que ya no tenemos que incluir el cdigo de localizacin de Angular en nuestros paquetes si solo tenemos un idioma.</p><p>Si no usamos plantillas localizadas, las instrucciones de Ivy <code>i18n *</code> se sacan del paquete principal.</p><h3 id=\"Textos-localizables-en-modelos-de-componentes-y-servicios\"><a href=\"#Textos-localizables-en-modelos-de-componentes-y-servicios\" class=\"headerlink\" title=\"Textos localizables en modelos de componentes y servicios\"></a>Textos localizables en modelos de componentes y servicios</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.component.ts</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  template: <span class=\"string\">'&#123;&#123; title &#125;&#125;'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;</span><br><span class=\"line\">  title = $localize<span class=\"string\">`Welcome to MyApp`</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 3. Un marcador de posicin de texto de traduccin en un modelo de componente.</em></p><p>Una nueva caracterstica de internacionalizacin es que tambin podemos incluir marcadores de posicin para textos traducidos en el contenido de nuestros modelos como se ve en el Listado 3. Anteriormente, esto solo era posible en las plantillas.</p><h2 id=\"Ambitos-adicionales-de-proveedores-de-dependencias\"><a href=\"#Ambitos-adicionales-de-proveedores-de-dependencias\" class=\"headerlink\" title=\"mbitos adicionales de proveedores de dependencias\"></a>mbitos adicionales de proveedores de dependencias</h2><p>Siempre hemos tenido alcance de mdulo para los proveedores de inyeccin de servicios. La versin Angular 6 introdujo el alcance <code>&#39;root&#39;</code> y los proveedores <em>tree-shakable</em>, tanto para los proveedores de alcance desde el mdulo raz como desde mdulos inferiores.</p><p>La versin angular 9 presenta los nuevos mbitos de proveedor <code>&#39;platform&#39;</code> y <code>&#39;any&#39;</code>. Los proveedores con mbito de <code>&#39;platform&#39;</code> se pueden compartir entre mltiples aplicaciones Angular en el mismo documento. El alcance del proveedor <code>&#39;any&#39;</code> compartir un proveedor por inyector de mdulo. Por ejemplo, una instancia de servicio para el paquete principal cargado por adelantado y una instancia de servicio para cada mdulo cargado con retraso.</p><h2 id=\"Experiencia-mejorada-del-desarrollador\"><a href=\"#Experiencia-mejorada-del-desarrollador\" class=\"headerlink\" title=\"Experiencia mejorada del desarrollador\"></a>Experiencia mejorada del desarrollador</h2><p>Ivy permite que <em>Angular Language Service</em> admita comprobaciones adicionales durante el desarrollo. Esta es una gran mejora para la experiencia del desarrollador.</p><h3 id=\"Comprobaciones-de-ruta-de-archivo\"><a href=\"#Comprobaciones-de-ruta-de-archivo\" class=\"headerlink\" title=\"Comprobaciones de ruta de archivo\"></a>Comprobaciones de ruta de archivo</h3><p><em>Angular Language Service</em> verifica continuamente la hoja de estilo de componentes y las rutas de plantilla.</p><h3 id=\"Verificaciones-de-tipo-de-plantilla\"><a href=\"#Verificaciones-de-tipo-de-plantilla\" class=\"headerlink\" title=\"Verificaciones de tipo de plantilla\"></a>Verificaciones de tipo de plantilla</h3><p>Las plantillas se verifican por tipo, de acuerdo con el modo de verificacin de tipo de plantilla como se describe ms abajo en la seccin Modo estricto. Los nombres y tipos de miembros se verifican, incluso en vistas incrustadas. Lo que anteriormente resultaba en errores de tiempo de ejecucin ahora se detecta durante el desarrollo y la construccin.</p><h2 id=\"Nueva-API-de-depuracion-en-modo-de-desarrollo\"><a href=\"#Nueva-API-de-depuracion-en-modo-de-desarrollo\" class=\"headerlink\" title=\"Nueva API de depuracin en modo de desarrollo\"></a>Nueva API de depuracin en modo de desarrollo</h2><p><code>ng.probe</code> ha sido reemplazado por una nueva API de depuracin en modo de desarrollo. Las funciones ms notables son <code>ng.applyChanges</code> y<code>ng.getComponent</code>.</p><h2 id=\"Modo-estricto\"><a href=\"#Modo-estricto\" class=\"headerlink\" title=\"Modo estricto\"></a>Modo estricto</h2><h3 id=\"Esquema-estricto-del-espacio-de-trabajo\"><a href=\"#Esquema-estricto-del-espacio-de-trabajo\" class=\"headerlink\" title=\"Esquema estricto del espacio de trabajo\"></a>Esquema estricto del espacio de trabajo</h3><p>El comando <code>ng new</code> ahora es compatible con el indicador<code>--strict</code> que por defecto est desactivado (<code>false</code>).</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new my-app --strict</span><br></pre></td></tr></table></figure><p>Cuando est habilitado, este parmetro agrega algunas comprobaciones estrictas del compilador TypeScript como se ve en el Listado 4.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"attr\">\"compilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitAny\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitReturns\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitThis\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noFallthroughCasesInSwitch\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"strictlyNullChecks\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 4. Opciones del compilador TypeScript habilitadas en un estricto espacio de trabajo angular.</em></p><p>Curiosamente, esto no agrega las mismas opciones que si simplemente estableciramos <code>&quot;strict&quot;: true</code> en el objeto <code>compilerOptions</code>. Comparemos la opcin estricta del workscpace Angular con la opcin estricta del compilador TypeScript.</p><p>Ambos tienen estas opciones en comn:</p><ul><li><code>noImplicitAny</code></li><li><code>noImplicitThis</code></li><li><code>strictlyNullChecks</code></li></ul><p>La opcin estricta de Angular establece adems estas opciones:</p><ul><li><code>noImplicitReturns</code></li><li><code>noFallthroughCasesInSwitch</code></li></ul><p>mientras que la opcin estricta del compilador TypeScript establece adicionalmente estas opciones:</p><ul><li><code>alwaysStrict</code></li><li><code>strictlyBindCallApply</code></li><li><code>strictlyFunctionTypes</code></li><li><code>estrictoPropertyInitialization</code></li></ul><p>Adems, la opcin de Angular no establece la comprobacin del tipo de plantilla en el nuevo modo estricto, lo deja en el modo <code>&#39;full&#39;</code> anterior.</p><h3 id=\"Verificacion-estricta-del-tipo-de-plantilla\"><a href=\"#Verificacion-estricta-del-tipo-de-plantilla\" class=\"headerlink\" title=\"Verificacin estricta del tipo de plantilla\"></a>Verificacin estricta del tipo de plantilla</h3><p>Hemos tenido la opcin de habilitar la verificacin del tipo de plantilla desde Angular versin 5 configurando <code>&quot;fullTemplateTypeCheck&quot;: true</code> en el objeto<code>angularCompilerOptions</code>.</p><p>Ivy presenta una estricta comprobacin del tipo de plantilla como se ve en el Listado 5. Cuando se establece esta nueva opcin del compilador Angular, se ignora el valor de <code>fullTemplateTypeCheck</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// tsconfig.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"string\">\"angularCompilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"string\">\"strictlyTemplates\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 5. Habilita la comprobacin estricta del tipo de plantilla.</em></p><p>La comprobacin de tipo de plantilla estricta verifica los tipos de enlaces de propiedades y respeta la opcin <code>stricNullChecks</code>. Tambin verifica los tipos de referencias de plantilla a directivas y componentes, incluidos los tipos genricos. Tambin se verifican los tipos de variables de contexto de plantilla, lo cual es excelente para los bucles NgFor. El tipo <code>$ event</code> est marcado para enlaces de eventos y animaciones. Incluso el tipo de elementos DOM nativos se verifica con una comprobacin estricta del tipo de plantilla.</p><p>Estas comprobaciones adicionales pueden conducir a errores y falsos positivos bajo ciertas circunstancias. Por ejemplo, cuando se usan libreras que no estn compiladas con <code>strictNullChecks</code>. Para abordar esto, la verificacin estricta del tipo de plantilla tiene opciones para optar por no participar y ajustar los controles. Por ejemplo, <code>strictTemplates</code> es en realidad una atajo de 8 opciones de compilador Angular.</p><h2 id=\"Herencia-de-clase-de-componente-y-directiva-mejorada\"><a href=\"#Herencia-de-clase-de-componente-y-directiva-mejorada\" class=\"headerlink\" title=\"Herencia de clase de componente y directiva mejorada\"></a>Herencia de clase de componente y directiva mejorada</h2><p>Las clases base sin selector ahora son compatibles con directivas y componentes. Algunos metadatos ahora se heredan de componentes base y clases directivas. Esto hace que sea ms fcil extender, por ejemplo, las directivas Angular Components y Angular Router.</p><h2 id=\"Ultimas-versiones-de-TypeScript\"><a href=\"#Ultimas-versiones-de-TypeScript\" class=\"headerlink\" title=\"ltimas versiones de TypeScript\"></a>ltimas versiones de TypeScript</h2><p>Las versiones de TypeScript 3.6 y 3.7 son compatibles con la versin angular 9. Las versiones anteriores de TypeScript ya no son compatibles. Consulta la Tabla 1 para comparar la compatibilidad de TypeScript entre todas las versiones Angular.</p><p>[ver sin formato](<a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support\" target=\"_blank\" rel=\"noopener\">https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support</a> -cs-type-script-node-type-script-code-node-code-node-type. csv](<a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv\" target=\"_blank\" rel=\"noopener\">https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv</a>) alojado con  por <a href=\"https://github.com/\" target=\"_blank\" rel=\"noopener\">GitHub</a></p><p><em>Tabla 1. Tabla de compatibilidad de CLI angular, Angular, Node.js y TypeScript.</em> <a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3\" target=\"_blank\" rel=\"noopener\"><em>Abrir en una pestaa nueva</em></a>*</p><p>TypeScript versin 3.6 presenta estas y otras caractersticas:</p><ul><li>Soporte Unicode para identificadores en destinos modernos</li><li>Experiencia de desarrollador mejorada para promesas</li><li>Comprobacin de tipo ms estricto de generadores</li></ul><p>TypeScript versin 3.7 presenta estas y otras caractersticas que podemos usar con Angular versin 9:</p><ul><li>Operador de encadenamiento opcional (<code>?.</code>) similar al operador de navegacin segura para plantillas Angular</li><li>Operador de unin con nulos (<code>??</code>)</li><li>Funciones de afirmacin de pruebas (<code>assert parameterName is typeName</code> y <code>asserts parameterName</code>)</li><li><code>await</code> de primer nivel</li><li>Alias de tipo recursivo mejorado</li><li>Mejora de la experiencia del desarrollador para funciones de comprobaciones</li></ul><h2 id=\"Generacion-mejorada-del-lado-del-servidor-con-Angular-Universal\"><a href=\"#Generacion-mejorada-del-lado-del-servidor-con-Angular-Universal\" class=\"headerlink\" title=\"Generacin mejorada del lado del servidor con Angular Universal\"></a>Generacin mejorada del lado del servidor con Angular Universal</h2><p>Angular Universal versin 9 se lanza con un servidor de desarrollo Node.js Express para proporcionar un entorno realista durante el desarrollo.</p><p>Tambin parte de este lanzamiento es un constructor del CLI para pre-renderizar rutas estticas usando <code>guess-parser</code>, inspirado en <code>angular-prerender</code>. Podemos pasar un archivo de rutas para renderizar rutas dinmicas (rutas con parmetros).</p><h3 id=\"Como-empiezo\"><a href=\"#Como-empiezo\" class=\"headerlink\" title=\"Cmo empiezo?\"></a>Cmo empiezo?</h3><p>Podemos agregar Angular Universal usando el comando <code>ng add @nguniversal/express-engine</code>. Luego podemos usar el comando del constructor <code>ng run myapp:serve-ssr</code> para iniciar el servidor de desarrollo de renderizado del lado del servidor con recarga en vivo. De manera similar, podemos usar <code>ng run myapp:prerender</code> para detectar rutas estticas y dinmicas y pre renderizarlas.</p><h2 id=\"Experiencia-de-clases-y-estilo-mejorada\"><a href=\"#Experiencia-de-clases-y-estilo-mejorada\" class=\"headerlink\" title=\"Experiencia de clases y estilo mejorada\"></a>Experiencia de clases y estilo mejorada</h2><p>Al aplicacin de estilo en Angular Ivy ha sido reelaborado. La combinacin de clases HTML estticas con las directivas <code>NgStyle</code> y<code>NgClass</code> es ahora totalmente compatible y ms fcil de entender.</p><h3 id=\"Soporte-de-propiedades-personalizadas-de-CSS\"><a href=\"#Soporte-de-propiedades-personalizadas-de-CSS\" class=\"headerlink\" title=\"Soporte de propiedades personalizadas de CSS\"></a>Soporte de propiedades personalizadas de CSS</h3><p>Como parte de la reescritura del estilo Ivy, ahora se admiten las propiedades personalizadas de CSS enlazadas.</p><p>Un ejemplo de enlace css puede ser as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">style.--my-var</span>]=<span class=\"string\">\"myProperty || 'any value'\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Las propiedades personalizadas de CSS tienen control de alcance, por lo que esta propiedad de CSS se limitara al DOM del componente.</p><h2 id=\"Lanzamiento-estable-de-Bazel-como-opcion-de-suscripcion\"><a href=\"#Lanzamiento-estable-de-Bazel-como-opcion-de-suscripcion\" class=\"headerlink\" title=\"Lanzamiento estable de Bazel como opcin de suscripcin\"></a>Lanzamiento estable de Bazel como opcin de suscripcin</h2><p>Bazel versin 2.1 es una herramienta de automatizacin de compilacin opcional para Angular versin 9.</p><h3 id=\"Como-empiezo-1\"><a href=\"#Como-empiezo-1\" class=\"headerlink\" title=\"Cmo empiezo?\"></a>Cmo empiezo?</h3><p>Para habilitar Bazel, usa <code>ng add @angular/bazel</code> o la coleccin de esquemas <code>@angular/bazel</code> cuando generes un espacio de trabajo Angular.</p><p>Asegrate de seguir <a href=\"https://docs.bazel.build/versions/2.0.0/install.html\" target=\"_blank\" rel=\"noopener\">la gua de instalacin de Bazel</a> para tu sistema operativo.</p><h2 id=\"Componentes-Angular\"><a href=\"#Componentes-Angular\" class=\"headerlink\" title=\"Componentes Angular\"></a>Componentes Angular</h2><p>La versin Angular 9 viene con componentes oficiales para YouTube y Google Maps. Se agreg una directiva y un servicio de portapapeles al Angular CDK.</p><h2 id=\"Pruebas\"><a href=\"#Pruebas\" class=\"headerlink\" title=\"Pruebas\"></a>Pruebas</h2><p>La mayor sorpresa de la versin Angular versin 9 son las muchas mejoras en las pruebas. Se resuelven problemas de rendimiento, se mejoran los tipos y se introducen nuevos conceptos.</p><p><a href=\"https://indepth.dev/next-level-testing-in-angular-ivy-version-9/\" target=\"_blank\" rel=\"noopener\">Obtn informacin sobre las principales caractersticas y mejoras para las pruebas en Pruebas de siguiente nivel en Angular Ivy versin 9</a>.</p><h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusin\"></a>Conclusin</h2><p>Uno de los objetivos ms importantes ha sido mantener la compatibilidad hacia atrs entre Ivy y View Engine tanto como fue posible.</p><p>Por supuesto, la versin Angular 9 tambin incluye correcciones de errores, temas obsoletos y cambios importantes. Ivy tambin aborda algunos problemas de antiguos que no cubrimos en este artculo.</p><p>Angular Ivy es un facilitador para las caractersticas que estn por venir. Como hemos discutido en este artculo, Ivy ya nos ha dado beneficios para diferentes casos de uso. Sin embargo, las mejores caractersticas llegarn en futuras versiones de Angular. Cul de las posibles caractersticas que se entregarn en las versiones 10 y 11 de Angular est por decidir?</p><p>Solo discutimos qu es parte de las API pblicas y estables de Angular versin 9. Algunas API experimentales son parte de esta versin, como <code>renderComponent</code>,<code>markDirty</code> y <code>detectChanges</code>. Sin embargo, todava estn sujetos a cambios.</p><p>Con la retirada de las declaraciones de componentes de entrada y los componentes con carga diferida utilizando mdulos de representacin, estamos un paso ms cerca de [componentes que se pueden eliminar del rbol y mdulos Angular opcionales](<a href=\"https://indepth.dev/angular-revisited-tree-shakable-components-\" target=\"_blank\" rel=\"noopener\">https://indepth.dev/angular-revisited-tree-shakable-components-</a> y-opcional-ngmodules /).</p><p><a href=\"https://indepth.dev/component-features-with-angular-ivy/\" target=\"_blank\" rel=\"noopener\">Los componentes de funcionalidad</a> tambin forman parte de esta versin, pero solo estn expuestos para uso interno de Ivy.</p><p>La versin de Angular Ivy versin 9 nos brinda mejoras para el empaquetamiento, las pruebas, la experiencia del desarrollador, las herramientas, la depuracin y la verificacin de tipos. Toda una buena coleccin de caractersticas.</p><h2 id=\"Recursos-relacionados\"><a href=\"#Recursos-relacionados\" class=\"headerlink\" title=\"Recursos relacionados\"></a>Recursos relacionados</h2><h3 id=\"Componentes-con-carga-lenta\"><a href=\"#Componentes-con-carga-lenta\" class=\"headerlink\" title=\"Componentes con carga lenta\"></a>Componentes con carga lenta</h3><p><a href=\"https://youtu.be/DA3efofhpq4\" target=\"_blank\" rel=\"noopener\">Informacin sobre los mdulos de presentacin en la charla Angular revisited: Tree-shakable components and optional NgModules</a>.</p><p><a href=\"https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8\" target=\"_blank\" rel=\"noopener\">Aprende a usar los componentes de carga diferida en Lazy load components in Angular por Kevin Kreuzer</a>.</p><h3 id=\"Comprobacion-de-tipos-en-plantillas\"><a href=\"#Comprobacion-de-tipos-en-plantillas\" class=\"headerlink\" title=\"Comprobacin de tipos en plantillas\"></a>Comprobacin de tipos en plantillas</h3><p><a href=\"https://angular.io/guide/template-typecheck#troubleshooting-template-errors\" target=\"_blank\" rel=\"noopener\">Lee la gua oficial sobre la verificacin de tipos en plantillas Angular para conocer los detalles de la resolucin de problemas y la configuracin</a>.</p><h3 id=\"Globalizacion-1\"><a href=\"#Globalizacion-1\" class=\"headerlink\" title=\"Globalizacin\"></a>Globalizacin</h3><p><a href=\"https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/\" target=\"_blank\" rel=\"noopener\">Manfred Steyer analiza las configuraciones regionales de carga diferida en Lazy Loading Locales with Angular</a>.</p><p><a href=\"https://blog.ninja-squad.com/2019/12/10/angular-localize/\" target=\"_blank\" rel=\"noopener\">Cdric Exbrayat analiza la globalizacin de Ivy en Internationalization with @angular/localize</a>.</p><h3 id=\"Ambitos-adicionales-de-proveedor-de-dependencias\"><a href=\"#Ambitos-adicionales-de-proveedor-de-dependencias\" class=\"headerlink\" title=\"mbitos adicionales de proveedor de dependencias\"></a>mbitos adicionales de proveedor de dependencias</h3><p>Obtn informacin sobre los mbitos de proveedor de <code>&#39;any&#39;</code> y <code>&#39;platform&#39;</code> en <a href=\"https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb\" target=\"_blank\" rel=\"noopener\">Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler</a>.</p><h3 id=\"Nueva-API-de-depuracion\"><a href=\"#Nueva-API-de-depuracion\" class=\"headerlink\" title=\"Nueva API de depuracin\"></a>Nueva API de depuracin</h3><p><a href=\"https://angular.io/api/core/global\" target=\"_blank\" rel=\"noopener\">Lee sobre la API de depuracin completa en la documentacin oficial</a>.</p><h3 id=\"Angular-Universal-version-9\"><a href=\"#Angular-Universal-version-9\" class=\"headerlink\" title=\"Angular Universal versin 9\"></a>Angular Universal versin 9</h3><p>Estos dos artculos entran en detalles de Angular Universal versin 9:</p><ul><li><a href=\"https://trilon.io/blog/angular-universal-v9-whats-new\" target=\"_blank\" rel=\"noopener\">Angular Universal v9: Whats New ? by Mark Pieszak</a></li><li><a href=\"https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1\" target=\"_blank\" rel=\"noopener\">Angular v9 &amp; Universal: SSR and prerendering out of the box! by Sam Vloeberghs</a></li></ul><p>Aprende sobre <code>angular-prerender</code>, la biblioteca que inspir estas nuevas caractersticas de Angular Universal en <a href=\"https://media-codings.com/articles/prerender-angular-apps-with-a-single-command\" target=\"_blank\" rel=\"noopener\">Prerender Angular Apps with a single Command by Christoph Guttandin</a>.</p><h3 id=\"Enlace-de-propiedades-personalizadas-de-CSS\"><a href=\"#Enlace-de-propiedades-personalizadas-de-CSS\" class=\"headerlink\" title=\"Enlace de propiedades personalizadas de CSS\"></a>Enlace de propiedades personalizadas de CSS</h3><p><a href=\"https://twitter.com/yurzui/status/1221159415820275717\" target=\"_blank\" rel=\"noopener\">Mira este tweet y la demostracin de Alexey Zuev para ver los enlaces de Propiedades personalizadas de CSS en accin</a>.</p><h2 id=\"Revisores\"><a href=\"#Revisores\" class=\"headerlink\" title=\"Revisores\"></a>Revisores</h2><p>Siempre es til tener una segunda opinin sobre nuestro trabajo o incluso detectar errores tontos. Para este artculo tuve el placer de ser revisado por:</p><ul><li><a href=\"https://twitter.com/chrisguttandin\" target=\"_blank\" rel=\"noopener\">Christoph Guttandin</a></li><li><a href=\"https://indepth.dev/author/evgeny/\" target=\"_blank\" rel=\"noopener\">Evgeny Fedorenko</a></li><li><a href=\"https://dev.to/santoshyadav198613\" target=\"_blank\" rel=\"noopener\">Santosh Yadav</a></li></ul><p>Lars Gyrup Brink Nielsen</p>","site":{"data":{}},"excerpt":"","more":"<blockquote><p>Ayudita conceptual</p><blockquote><p><a href=\"https://www.campusmvp.es/recursos/post/angular-9-ya-esta-aqui-y-estas-son-sus-novedades.aspx\" target=\"_blank\" rel=\"noopener\">https://www.campusmvp.es/recursos/post/angular-9-ya-esta-aqui-y-estas-son-sus-novedades.aspx</a></p></blockquote></blockquote><h1 id=\"Un-vistazo-a-las-caracteristicas-principales-en-el-lanzamiento-de-Angular-Ivy-version-9\"><a href=\"#Un-vistazo-a-las-caracteristicas-principales-en-el-lanzamiento-de-Angular-Ivy-version-9\" class=\"headerlink\" title=\"Un vistazo a las caractersticas principales en el lanzamiento de Angular Ivy versin 9\"></a>Un vistazo a las caractersticas principales en el lanzamiento de Angular Ivy versin 9</h1><p><a href=\"https://admin.indepth.dev/ghost/#/editor/post/5e2f4cae430b1e0c3681c749\" target=\"_blank\" rel=\"noopener\">editor de publicaciones</a></p><p><a href=\"https://indepth.dev/author/layzee/\" target=\"_blank\" rel=\"noopener\">Lars Gyrup Brink Nielsen</a> 06 de febrero de 2020 9 min de lectura</p><p>MUCHO y en todas partes, globalizacin dinmica, modo estricto, Bazel y mucho ms.</p><ul><li>(S, ahora se ha lanzado Angular Ivy versin 9) *</li></ul><h2 id=\"Ivy-esta-habilitado-por-defecto\"><a href=\"#Ivy-esta-habilitado-por-defecto\" class=\"headerlink\" title=\"Ivy est habilitado por defecto\"></a>Ivy est habilitado por defecto</h2><p>En versiones anteriores de Angular, tuvimos que optar por Ivy. En la versin 9, tenemos que optar por no participar en Ivy si queremos recurrir a View Engine. Esto es posible en ambas versiones 9 y 10 para garantizar una transicin ms fluida de View Engine a Ivy.</p><p>Las libreras <em>se pueden</em> compilar AOT, pero no es recomendable. El equipo de Angular tiene un plan de migracin de View Engine a Ivy que recomienda publicar solo libreras compatibles con View Engine compiladas con JIT para Angular versin 9. El compilador de compatibilidad Angular actualizar las libreras compatibles con View Engine a Ivy cuando se instalen en una aplicacin Angular Ivy.</p><p><a href=\"https://indepth.dev/the-angular-ivy-guide-for-library-authors/\" target=\"_blank\" rel=\"noopener\">Obtn informacin sobre la compatibilidad de la biblioteca y el plan de transicin de View Engine-to-Ivy en La gua de Angular Ivy para autores de libreras</a> .</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"attr\">\"angularCompilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"attr\">\"enableIvy\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// polyfills.ts</span></span><br><span class=\"line\"><span class=\"comment\">// Solo se usa en aplicaciones multilinges de Ivy</span></span><br><span class=\"line\"><span class=\"comment\">// import '@angular/localize/init';</span></span><br></pre></td></tr></table></figure><p><em>Listado 1. Optar por no usar Ivy para recurrir a View Engine.</em></p><p>Si tienes problemas con Ivy en tu aplicacin, o en cualquiera de las libreras de las que depende, puedes optar por salir de Ivy y recurrir a View Engine. Hazlo desactivando la opcin del compilador angular <code>enableIvy</code> y deshabilitando<code>@angular/localize</code> como se ve en Listado 1.</p><p>Optar por evitar Ivy en un entorno de servidor es un poco ms complicado. <a href=\"https://angular.io/guide/ivy#using-ssr-without-ivy\" target=\"_blank\" rel=\"noopener\">Sigue la gua oficial para darte de baja de Ivy cuando uses la renderizacin del lado del servidor</a>.</p><h2 id=\"El-principio-de-localidad\"><a href=\"#El-principio-de-localidad\" class=\"headerlink\" title=\"El principio de localidad\"></a>El principio de localidad</h2><p>Antes, para compilar un componente en View Engine, Angular necesitaba informacin sobre todas sus dependencias declaradas. Esto significa que las libreras Angular no se pueden compilar AOT usando View Engine.</p><p>Ahora para compilar un componente en Ivy, Angular solo necesita informacin sobre el componente en s. Pero, Ivy no necesita metadatos de ninguna dependencia declarable para compilar un componente.</p><p>El principio de localidad significa que, en general, veremos tiempos de construccin ms rpidos.</p><h3 id=\"Componentes-con-carga-diferida\"><a href=\"#Componentes-con-carga-diferida\" class=\"headerlink\" title=\"Componentes con carga diferida\"></a>Componentes con carga diferida</h3><p>Las declaraciones <code>entryComponents</code> estn en desuso porque ya no son necesarias. Cualquier componente Ivy puede cargarse de forma diferida y renderizarse dinmicamente.</p><p>Esto significa que ahora podemos cargar de forma diferida y renderizar un componente sin enrutamiento o mdulos Angular. Sin embargo, en la prctica an tenemos que usar mdulos para renderizar componentes o mdulos funcionales para vincular la plantilla de un componente a sus dependencias.</p><p>Las libreras que solo son utilizadas por un componente con carga diferida se agrupan en fragmentos con carga diferida.</p><h2 id=\"Mejoras-en-la-carga-diferencial\"><a href=\"#Mejoras-en-la-carga-diferencial\" class=\"headerlink\" title=\"Mejoras en la carga diferencial\"></a>Mejoras en la carga diferencial</h2><p>Cuando se introdujo la carga diferencial en Angular versin 8, el proceso de compilacin se ejecutaba una vez para el paquete ES5 y otra vez para el paquete ES2015+.</p><p>En Angular versin 9, primero se emite un paquete ES2015+. Ese paquete se transfiere a un paquete ES5 separado. De esta manera, no tenemos que pasar por un proceso de compilacin completo dos veces.</p><h2 id=\"Compilacion-AOT-en-todas-partes\"><a href=\"#Compilacion-AOT-en-todas-partes\" class=\"headerlink\" title=\"Compilacin AOT en todas partes\"></a>Compilacin AOT en todas partes</h2><p>AOT est habilitado de forma predeterminada en las compilaciones, el servidor de desarrollo e incluso en las pruebas. Anteriormente, la compilacin AOT era significativamente ms lenta que la compilacin JIT, por lo que JIT se usaba para el desarrollo y las pruebas. Con las mejoras de tiempo de construccin y reconstruccin en Ivy, la compilacin AOT ahora ofrece una gran experiencia al desarrollador.</p><p>Cuando utilizbamos la compilacin JIT en desarrollo y solo la compilacin AOT en la compilacin final, algunos errores se detectaban solo al hacer compilaciones de produccin o, peor an, en tiempo de ejecucin.</p><h2 id=\"Tamanos-de-paquete\"><a href=\"#Tamanos-de-paquete\" class=\"headerlink\" title=\"Tamaos de paquete\"></a>Tamaos de paquete</h2><p>Ivy puede habilitar paquetes ms pequeos porque usa el <em>Ivy Instruction Set</em>, que es un conjunto de instrucciones de representacin de tiempo de ejecucin potencialmente <strong>tree-shakable</strong>. Nuestros paquetes solo incluirn las instrucciones de renderizado que realmente usamos en nuestros proyectos.</p><p>Esto es ideal para casos de uso como <em>microfrontends</em>, Angular Elements y aplicaciones web donde Angular no controla todo el documento.</p><p>Sin embargo, la diferencia en los tamaos de nuestros paquetes entre View Engine e Ivy variar segn el tamao de nuestra aplicacin y las libreras de terceros que utilizamos. En general:</p><ul><li>Las aplicaciones pequeas y simples vern una disminucin considerable del peso del paquete.</li><li>Las aplicaciones complejas vern un aumento en el fichero principal, pero una disminucin en los tamaos de paquetes con carga diferida.</li></ul><p>Esto significa una disminucin considerable del tamao de descarga combinada para aplicaciones grandes, pero podra significar un aumento en el peso total para aplicaciones medianas. En ambos casos, el tamao del paquete principal probablemente aumentar, lo que es malo para el tiempo de carga inicial de la pgina.</p><h2 id=\"Globalizacion\"><a href=\"#Globalizacion\" class=\"headerlink\" title=\"Globalizacin\"></a>Globalizacin</h2><p>Las configuraciones regionales (formato de nmero, formato de fecha y otras configuraciones regionales) se pueden cargar dinmicamente en tiempo de ejecucin en lugar de tener que registrarse en tiempo de compilacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// main.ts</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'@angular/localize/init'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; loadTranslations &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/localize'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">loadTranslations (&#123;</span><br><span class=\"line\"><span class=\"string\">'8374172394781134519'</span>: <span class=\"string\">'Hola, &#123;$nombre de usuario&#125;! Bienvenido a &#123;$appName&#125;. '</span>,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p><em>Listado 2. Carga dinmica de traducciones.</em></p><p>Como se ve en el Listado 2, los textos traducidos tambin se pueden cargar dinmicamente en tiempo de ejecucin en lugar de ser parte de nuestros paquetes.</p><p>Los textos traducidos pueden cargarse desde una base de datos o un archivo.</p><h3 id=\"Multiples-idiomas-desde-un-unico-paquete-de-aplicaciones\"><a href=\"#Multiples-idiomas-desde-un-unico-paquete-de-aplicaciones\" class=\"headerlink\" title=\"Mltiples idiomas desde un nico paquete de aplicaciones\"></a>Mltiples idiomas desde un nico paquete de aplicaciones</h3><p>Para cambiar el idioma, tenemos que reiniciar la aplicacin, pero no tenemos que servir un fichero de aplicaciones diferente.</p><p>Esto significa que podemos, con alguna configuracin, admitir varios idiomas con un solo paquete de aplicaciones en un solo nombre de host.</p><h3 id=\"Tiempo-de-compilacion-en-linea\"><a href=\"#Tiempo-de-compilacion-en-linea\" class=\"headerlink\" title=\"Tiempo de compilacin en lnea\"></a>Tiempo de compilacin en lnea</h3><p>Una aplicacin localizada ahora solo se compilar una vez. En lugar de mltiples compilaciones para producir un paquete por idioma, se produce un paquete por idioma reemplazando los marcadores de posicin <code>$localize</code> con textos traducidos.</p><p>Ahora hay que agregar el paquete <code>@angular/localize</code> para posibilitar la localizacin (varios idiomas). La buena noticia es que ya no tenemos que incluir el cdigo de localizacin de Angular en nuestros paquetes si solo tenemos un idioma.</p><p>Si no usamos plantillas localizadas, las instrucciones de Ivy <code>i18n *</code> se sacan del paquete principal.</p><h3 id=\"Textos-localizables-en-modelos-de-componentes-y-servicios\"><a href=\"#Textos-localizables-en-modelos-de-componentes-y-servicios\" class=\"headerlink\" title=\"Textos localizables en modelos de componentes y servicios\"></a>Textos localizables en modelos de componentes y servicios</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.component.ts</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  template: <span class=\"string\">'&#123;&#123; title &#125;&#125;'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;</span><br><span class=\"line\">  title = $localize<span class=\"string\">`Welcome to MyApp`</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 3. Un marcador de posicin de texto de traduccin en un modelo de componente.</em></p><p>Una nueva caracterstica de internacionalizacin es que tambin podemos incluir marcadores de posicin para textos traducidos en el contenido de nuestros modelos como se ve en el Listado 3. Anteriormente, esto solo era posible en las plantillas.</p><h2 id=\"Ambitos-adicionales-de-proveedores-de-dependencias\"><a href=\"#Ambitos-adicionales-de-proveedores-de-dependencias\" class=\"headerlink\" title=\"mbitos adicionales de proveedores de dependencias\"></a>mbitos adicionales de proveedores de dependencias</h2><p>Siempre hemos tenido alcance de mdulo para los proveedores de inyeccin de servicios. La versin Angular 6 introdujo el alcance <code>&#39;root&#39;</code> y los proveedores <em>tree-shakable</em>, tanto para los proveedores de alcance desde el mdulo raz como desde mdulos inferiores.</p><p>La versin angular 9 presenta los nuevos mbitos de proveedor <code>&#39;platform&#39;</code> y <code>&#39;any&#39;</code>. Los proveedores con mbito de <code>&#39;platform&#39;</code> se pueden compartir entre mltiples aplicaciones Angular en el mismo documento. El alcance del proveedor <code>&#39;any&#39;</code> compartir un proveedor por inyector de mdulo. Por ejemplo, una instancia de servicio para el paquete principal cargado por adelantado y una instancia de servicio para cada mdulo cargado con retraso.</p><h2 id=\"Experiencia-mejorada-del-desarrollador\"><a href=\"#Experiencia-mejorada-del-desarrollador\" class=\"headerlink\" title=\"Experiencia mejorada del desarrollador\"></a>Experiencia mejorada del desarrollador</h2><p>Ivy permite que <em>Angular Language Service</em> admita comprobaciones adicionales durante el desarrollo. Esta es una gran mejora para la experiencia del desarrollador.</p><h3 id=\"Comprobaciones-de-ruta-de-archivo\"><a href=\"#Comprobaciones-de-ruta-de-archivo\" class=\"headerlink\" title=\"Comprobaciones de ruta de archivo\"></a>Comprobaciones de ruta de archivo</h3><p><em>Angular Language Service</em> verifica continuamente la hoja de estilo de componentes y las rutas de plantilla.</p><h3 id=\"Verificaciones-de-tipo-de-plantilla\"><a href=\"#Verificaciones-de-tipo-de-plantilla\" class=\"headerlink\" title=\"Verificaciones de tipo de plantilla\"></a>Verificaciones de tipo de plantilla</h3><p>Las plantillas se verifican por tipo, de acuerdo con el modo de verificacin de tipo de plantilla como se describe ms abajo en la seccin Modo estricto. Los nombres y tipos de miembros se verifican, incluso en vistas incrustadas. Lo que anteriormente resultaba en errores de tiempo de ejecucin ahora se detecta durante el desarrollo y la construccin.</p><h2 id=\"Nueva-API-de-depuracion-en-modo-de-desarrollo\"><a href=\"#Nueva-API-de-depuracion-en-modo-de-desarrollo\" class=\"headerlink\" title=\"Nueva API de depuracin en modo de desarrollo\"></a>Nueva API de depuracin en modo de desarrollo</h2><p><code>ng.probe</code> ha sido reemplazado por una nueva API de depuracin en modo de desarrollo. Las funciones ms notables son <code>ng.applyChanges</code> y<code>ng.getComponent</code>.</p><h2 id=\"Modo-estricto\"><a href=\"#Modo-estricto\" class=\"headerlink\" title=\"Modo estricto\"></a>Modo estricto</h2><h3 id=\"Esquema-estricto-del-espacio-de-trabajo\"><a href=\"#Esquema-estricto-del-espacio-de-trabajo\" class=\"headerlink\" title=\"Esquema estricto del espacio de trabajo\"></a>Esquema estricto del espacio de trabajo</h3><p>El comando <code>ng new</code> ahora es compatible con el indicador<code>--strict</code> que por defecto est desactivado (<code>false</code>).</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new my-app --strict</span><br></pre></td></tr></table></figure><p>Cuando est habilitado, este parmetro agrega algunas comprobaciones estrictas del compilador TypeScript como se ve en el Listado 4.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"attr\">\"compilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitAny\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitReturns\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitThis\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noFallthroughCasesInSwitch\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"strictlyNullChecks\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 4. Opciones del compilador TypeScript habilitadas en un estricto espacio de trabajo angular.</em></p><p>Curiosamente, esto no agrega las mismas opciones que si simplemente estableciramos <code>&quot;strict&quot;: true</code> en el objeto <code>compilerOptions</code>. Comparemos la opcin estricta del workscpace Angular con la opcin estricta del compilador TypeScript.</p><p>Ambos tienen estas opciones en comn:</p><ul><li><code>noImplicitAny</code></li><li><code>noImplicitThis</code></li><li><code>strictlyNullChecks</code></li></ul><p>La opcin estricta de Angular establece adems estas opciones:</p><ul><li><code>noImplicitReturns</code></li><li><code>noFallthroughCasesInSwitch</code></li></ul><p>mientras que la opcin estricta del compilador TypeScript establece adicionalmente estas opciones:</p><ul><li><code>alwaysStrict</code></li><li><code>strictlyBindCallApply</code></li><li><code>strictlyFunctionTypes</code></li><li><code>estrictoPropertyInitialization</code></li></ul><p>Adems, la opcin de Angular no establece la comprobacin del tipo de plantilla en el nuevo modo estricto, lo deja en el modo <code>&#39;full&#39;</code> anterior.</p><h3 id=\"Verificacion-estricta-del-tipo-de-plantilla\"><a href=\"#Verificacion-estricta-del-tipo-de-plantilla\" class=\"headerlink\" title=\"Verificacin estricta del tipo de plantilla\"></a>Verificacin estricta del tipo de plantilla</h3><p>Hemos tenido la opcin de habilitar la verificacin del tipo de plantilla desde Angular versin 5 configurando <code>&quot;fullTemplateTypeCheck&quot;: true</code> en el objeto<code>angularCompilerOptions</code>.</p><p>Ivy presenta una estricta comprobacin del tipo de plantilla como se ve en el Listado 5. Cuando se establece esta nueva opcin del compilador Angular, se ignora el valor de <code>fullTemplateTypeCheck</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// tsconfig.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"string\">\"angularCompilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"string\">\"strictlyTemplates\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 5. Habilita la comprobacin estricta del tipo de plantilla.</em></p><p>La comprobacin de tipo de plantilla estricta verifica los tipos de enlaces de propiedades y respeta la opcin <code>stricNullChecks</code>. Tambin verifica los tipos de referencias de plantilla a directivas y componentes, incluidos los tipos genricos. Tambin se verifican los tipos de variables de contexto de plantilla, lo cual es excelente para los bucles NgFor. El tipo <code>$ event</code> est marcado para enlaces de eventos y animaciones. Incluso el tipo de elementos DOM nativos se verifica con una comprobacin estricta del tipo de plantilla.</p><p>Estas comprobaciones adicionales pueden conducir a errores y falsos positivos bajo ciertas circunstancias. Por ejemplo, cuando se usan libreras que no estn compiladas con <code>strictNullChecks</code>. Para abordar esto, la verificacin estricta del tipo de plantilla tiene opciones para optar por no participar y ajustar los controles. Por ejemplo, <code>strictTemplates</code> es en realidad una atajo de 8 opciones de compilador Angular.</p><h2 id=\"Herencia-de-clase-de-componente-y-directiva-mejorada\"><a href=\"#Herencia-de-clase-de-componente-y-directiva-mejorada\" class=\"headerlink\" title=\"Herencia de clase de componente y directiva mejorada\"></a>Herencia de clase de componente y directiva mejorada</h2><p>Las clases base sin selector ahora son compatibles con directivas y componentes. Algunos metadatos ahora se heredan de componentes base y clases directivas. Esto hace que sea ms fcil extender, por ejemplo, las directivas Angular Components y Angular Router.</p><h2 id=\"Ultimas-versiones-de-TypeScript\"><a href=\"#Ultimas-versiones-de-TypeScript\" class=\"headerlink\" title=\"ltimas versiones de TypeScript\"></a>ltimas versiones de TypeScript</h2><p>Las versiones de TypeScript 3.6 y 3.7 son compatibles con la versin angular 9. Las versiones anteriores de TypeScript ya no son compatibles. Consulta la Tabla 1 para comparar la compatibilidad de TypeScript entre todas las versiones Angular.</p><p>[ver sin formato](<a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support\" target=\"_blank\" rel=\"noopener\">https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support</a> -cs-type-script-node-type-script-code-node-code-node-type. csv](<a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv\" target=\"_blank\" rel=\"noopener\">https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv</a>) alojado con  por <a href=\"https://github.com/\" target=\"_blank\" rel=\"noopener\">GitHub</a></p><p><em>Tabla 1. Tabla de compatibilidad de CLI angular, Angular, Node.js y TypeScript.</em> <a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3\" target=\"_blank\" rel=\"noopener\"><em>Abrir en una pestaa nueva</em></a>*</p><p>TypeScript versin 3.6 presenta estas y otras caractersticas:</p><ul><li>Soporte Unicode para identificadores en destinos modernos</li><li>Experiencia de desarrollador mejorada para promesas</li><li>Comprobacin de tipo ms estricto de generadores</li></ul><p>TypeScript versin 3.7 presenta estas y otras caractersticas que podemos usar con Angular versin 9:</p><ul><li>Operador de encadenamiento opcional (<code>?.</code>) similar al operador de navegacin segura para plantillas Angular</li><li>Operador de unin con nulos (<code>??</code>)</li><li>Funciones de afirmacin de pruebas (<code>assert parameterName is typeName</code> y <code>asserts parameterName</code>)</li><li><code>await</code> de primer nivel</li><li>Alias de tipo recursivo mejorado</li><li>Mejora de la experiencia del desarrollador para funciones de comprobaciones</li></ul><h2 id=\"Generacion-mejorada-del-lado-del-servidor-con-Angular-Universal\"><a href=\"#Generacion-mejorada-del-lado-del-servidor-con-Angular-Universal\" class=\"headerlink\" title=\"Generacin mejorada del lado del servidor con Angular Universal\"></a>Generacin mejorada del lado del servidor con Angular Universal</h2><p>Angular Universal versin 9 se lanza con un servidor de desarrollo Node.js Express para proporcionar un entorno realista durante el desarrollo.</p><p>Tambin parte de este lanzamiento es un constructor del CLI para pre-renderizar rutas estticas usando <code>guess-parser</code>, inspirado en <code>angular-prerender</code>. Podemos pasar un archivo de rutas para renderizar rutas dinmicas (rutas con parmetros).</p><h3 id=\"Como-empiezo\"><a href=\"#Como-empiezo\" class=\"headerlink\" title=\"Cmo empiezo?\"></a>Cmo empiezo?</h3><p>Podemos agregar Angular Universal usando el comando <code>ng add @nguniversal/express-engine</code>. Luego podemos usar el comando del constructor <code>ng run myapp:serve-ssr</code> para iniciar el servidor de desarrollo de renderizado del lado del servidor con recarga en vivo. De manera similar, podemos usar <code>ng run myapp:prerender</code> para detectar rutas estticas y dinmicas y pre renderizarlas.</p><h2 id=\"Experiencia-de-clases-y-estilo-mejorada\"><a href=\"#Experiencia-de-clases-y-estilo-mejorada\" class=\"headerlink\" title=\"Experiencia de clases y estilo mejorada\"></a>Experiencia de clases y estilo mejorada</h2><p>Al aplicacin de estilo en Angular Ivy ha sido reelaborado. La combinacin de clases HTML estticas con las directivas <code>NgStyle</code> y<code>NgClass</code> es ahora totalmente compatible y ms fcil de entender.</p><h3 id=\"Soporte-de-propiedades-personalizadas-de-CSS\"><a href=\"#Soporte-de-propiedades-personalizadas-de-CSS\" class=\"headerlink\" title=\"Soporte de propiedades personalizadas de CSS\"></a>Soporte de propiedades personalizadas de CSS</h3><p>Como parte de la reescritura del estilo Ivy, ahora se admiten las propiedades personalizadas de CSS enlazadas.</p><p>Un ejemplo de enlace css puede ser as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">style.--my-var</span>]=<span class=\"string\">\"myProperty || 'any value'\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Las propiedades personalizadas de CSS tienen control de alcance, por lo que esta propiedad de CSS se limitara al DOM del componente.</p><h2 id=\"Lanzamiento-estable-de-Bazel-como-opcion-de-suscripcion\"><a href=\"#Lanzamiento-estable-de-Bazel-como-opcion-de-suscripcion\" class=\"headerlink\" title=\"Lanzamiento estable de Bazel como opcin de suscripcin\"></a>Lanzamiento estable de Bazel como opcin de suscripcin</h2><p>Bazel versin 2.1 es una herramienta de automatizacin de compilacin opcional para Angular versin 9.</p><h3 id=\"Como-empiezo-1\"><a href=\"#Como-empiezo-1\" class=\"headerlink\" title=\"Cmo empiezo?\"></a>Cmo empiezo?</h3><p>Para habilitar Bazel, usa <code>ng add @angular/bazel</code> o la coleccin de esquemas <code>@angular/bazel</code> cuando generes un espacio de trabajo Angular.</p><p>Asegrate de seguir <a href=\"https://docs.bazel.build/versions/2.0.0/install.html\" target=\"_blank\" rel=\"noopener\">la gua de instalacin de Bazel</a> para tu sistema operativo.</p><h2 id=\"Componentes-Angular\"><a href=\"#Componentes-Angular\" class=\"headerlink\" title=\"Componentes Angular\"></a>Componentes Angular</h2><p>La versin Angular 9 viene con componentes oficiales para YouTube y Google Maps. Se agreg una directiva y un servicio de portapapeles al Angular CDK.</p><h2 id=\"Pruebas\"><a href=\"#Pruebas\" class=\"headerlink\" title=\"Pruebas\"></a>Pruebas</h2><p>La mayor sorpresa de la versin Angular versin 9 son las muchas mejoras en las pruebas. Se resuelven problemas de rendimiento, se mejoran los tipos y se introducen nuevos conceptos.</p><p><a href=\"https://indepth.dev/next-level-testing-in-angular-ivy-version-9/\" target=\"_blank\" rel=\"noopener\">Obtn informacin sobre las principales caractersticas y mejoras para las pruebas en Pruebas de siguiente nivel en Angular Ivy versin 9</a>.</p><h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusin\"></a>Conclusin</h2><p>Uno de los objetivos ms importantes ha sido mantener la compatibilidad hacia atrs entre Ivy y View Engine tanto como fue posible.</p><p>Por supuesto, la versin Angular 9 tambin incluye correcciones de errores, temas obsoletos y cambios importantes. Ivy tambin aborda algunos problemas de antiguos que no cubrimos en este artculo.</p><p>Angular Ivy es un facilitador para las caractersticas que estn por venir. Como hemos discutido en este artculo, Ivy ya nos ha dado beneficios para diferentes casos de uso. Sin embargo, las mejores caractersticas llegarn en futuras versiones de Angular. Cul de las posibles caractersticas que se entregarn en las versiones 10 y 11 de Angular est por decidir?</p><p>Solo discutimos qu es parte de las API pblicas y estables de Angular versin 9. Algunas API experimentales son parte de esta versin, como <code>renderComponent</code>,<code>markDirty</code> y <code>detectChanges</code>. Sin embargo, todava estn sujetos a cambios.</p><p>Con la retirada de las declaraciones de componentes de entrada y los componentes con carga diferida utilizando mdulos de representacin, estamos un paso ms cerca de [componentes que se pueden eliminar del rbol y mdulos Angular opcionales](<a href=\"https://indepth.dev/angular-revisited-tree-shakable-components-\" target=\"_blank\" rel=\"noopener\">https://indepth.dev/angular-revisited-tree-shakable-components-</a> y-opcional-ngmodules /).</p><p><a href=\"https://indepth.dev/component-features-with-angular-ivy/\" target=\"_blank\" rel=\"noopener\">Los componentes de funcionalidad</a> tambin forman parte de esta versin, pero solo estn expuestos para uso interno de Ivy.</p><p>La versin de Angular Ivy versin 9 nos brinda mejoras para el empaquetamiento, las pruebas, la experiencia del desarrollador, las herramientas, la depuracin y la verificacin de tipos. Toda una buena coleccin de caractersticas.</p><h2 id=\"Recursos-relacionados\"><a href=\"#Recursos-relacionados\" class=\"headerlink\" title=\"Recursos relacionados\"></a>Recursos relacionados</h2><h3 id=\"Componentes-con-carga-lenta\"><a href=\"#Componentes-con-carga-lenta\" class=\"headerlink\" title=\"Componentes con carga lenta\"></a>Componentes con carga lenta</h3><p><a href=\"https://youtu.be/DA3efofhpq4\" target=\"_blank\" rel=\"noopener\">Informacin sobre los mdulos de presentacin en la charla Angular revisited: Tree-shakable components and optional NgModules</a>.</p><p><a href=\"https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8\" target=\"_blank\" rel=\"noopener\">Aprende a usar los componentes de carga diferida en Lazy load components in Angular por Kevin Kreuzer</a>.</p><h3 id=\"Comprobacion-de-tipos-en-plantillas\"><a href=\"#Comprobacion-de-tipos-en-plantillas\" class=\"headerlink\" title=\"Comprobacin de tipos en plantillas\"></a>Comprobacin de tipos en plantillas</h3><p><a href=\"https://angular.io/guide/template-typecheck#troubleshooting-template-errors\" target=\"_blank\" rel=\"noopener\">Lee la gua oficial sobre la verificacin de tipos en plantillas Angular para conocer los detalles de la resolucin de problemas y la configuracin</a>.</p><h3 id=\"Globalizacion-1\"><a href=\"#Globalizacion-1\" class=\"headerlink\" title=\"Globalizacin\"></a>Globalizacin</h3><p><a href=\"https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/\" target=\"_blank\" rel=\"noopener\">Manfred Steyer analiza las configuraciones regionales de carga diferida en Lazy Loading Locales with Angular</a>.</p><p><a href=\"https://blog.ninja-squad.com/2019/12/10/angular-localize/\" target=\"_blank\" rel=\"noopener\">Cdric Exbrayat analiza la globalizacin de Ivy en Internationalization with @angular/localize</a>.</p><h3 id=\"Ambitos-adicionales-de-proveedor-de-dependencias\"><a href=\"#Ambitos-adicionales-de-proveedor-de-dependencias\" class=\"headerlink\" title=\"mbitos adicionales de proveedor de dependencias\"></a>mbitos adicionales de proveedor de dependencias</h3><p>Obtn informacin sobre los mbitos de proveedor de <code>&#39;any&#39;</code> y <code>&#39;platform&#39;</code> en <a href=\"https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb\" target=\"_blank\" rel=\"noopener\">Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler</a>.</p><h3 id=\"Nueva-API-de-depuracion\"><a href=\"#Nueva-API-de-depuracion\" class=\"headerlink\" title=\"Nueva API de depuracin\"></a>Nueva API de depuracin</h3><p><a href=\"https://angular.io/api/core/global\" target=\"_blank\" rel=\"noopener\">Lee sobre la API de depuracin completa en la documentacin oficial</a>.</p><h3 id=\"Angular-Universal-version-9\"><a href=\"#Angular-Universal-version-9\" class=\"headerlink\" title=\"Angular Universal versin 9\"></a>Angular Universal versin 9</h3><p>Estos dos artculos entran en detalles de Angular Universal versin 9:</p><ul><li><a href=\"https://trilon.io/blog/angular-universal-v9-whats-new\" target=\"_blank\" rel=\"noopener\">Angular Universal v9: Whats New ? by Mark Pieszak</a></li><li><a href=\"https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1\" target=\"_blank\" rel=\"noopener\">Angular v9 &amp; Universal: SSR and prerendering out of the box! by Sam Vloeberghs</a></li></ul><p>Aprende sobre <code>angular-prerender</code>, la biblioteca que inspir estas nuevas caractersticas de Angular Universal en <a href=\"https://media-codings.com/articles/prerender-angular-apps-with-a-single-command\" target=\"_blank\" rel=\"noopener\">Prerender Angular Apps with a single Command by Christoph Guttandin</a>.</p><h3 id=\"Enlace-de-propiedades-personalizadas-de-CSS\"><a href=\"#Enlace-de-propiedades-personalizadas-de-CSS\" class=\"headerlink\" title=\"Enlace de propiedades personalizadas de CSS\"></a>Enlace de propiedades personalizadas de CSS</h3><p><a href=\"https://twitter.com/yurzui/status/1221159415820275717\" target=\"_blank\" rel=\"noopener\">Mira este tweet y la demostracin de Alexey Zuev para ver los enlaces de Propiedades personalizadas de CSS en accin</a>.</p><h2 id=\"Revisores\"><a href=\"#Revisores\" class=\"headerlink\" title=\"Revisores\"></a>Revisores</h2><p>Siempre es til tener una segunda opinin sobre nuestro trabajo o incluso detectar errores tontos. Para este artculo tuve el placer de ser revisado por:</p><ul><li><a href=\"https://twitter.com/chrisguttandin\" target=\"_blank\" rel=\"noopener\">Christoph Guttandin</a></li><li><a href=\"https://indepth.dev/author/evgeny/\" target=\"_blank\" rel=\"noopener\">Evgeny Fedorenko</a></li><li><a href=\"https://dev.to/santoshyadav198613\" target=\"_blank\" rel=\"noopener\">Santosh Yadav</a></li></ul><p>Lars Gyrup Brink Nielsen</p>"},{"title":"Cookies","id":9,"updated":"2016-04-18T13:48:28.000Z","date":"2016-04-14T12:29:58.000Z","_content":"\nUtilizamos cookies para facilitar el uso de nuestra pgina web. \n\nLas cookies son pequeos ficheros de texto que su navegador almacena en el disco duro de su ordenador y que son necesarias para navegar por nuestra pgina web. \n\nLas utilizamos para entender mejor la manera en la que se usa nuestra pgina web y de esta manera poder mejorar consecuentemente el proceso de navegacin. Las cookies son el referente que nos indica, por ejemplo, si una pgina de nuestra web ha sido vista con\nanterioridad, o si su visita es nueva o recurrente. \n\nLas cookies que utilizamos no almacenan dato personal alguno, ni ningn tipo de informacin que pueda identificarle. \n\nEn caso de no querer recibir cookies, por favor configure su navegador de Internet para que las borre del disco duro de su ordenador, las bloquee o le avise en caso de instalacin de las mismas. ","source":"Cookies/index.md","raw":"---\ntitle: Cookies\npermalink: cookies\nid: 9\nupdated: '2016-04-18 15:48:28'\ndate: 2016-04-14 14:29:58\n---\n\nUtilizamos cookies para facilitar el uso de nuestra pgina web. \n\nLas cookies son pequeos ficheros de texto que su navegador almacena en el disco duro de su ordenador y que son necesarias para navegar por nuestra pgina web. \n\nLas utilizamos para entender mejor la manera en la que se usa nuestra pgina web y de esta manera poder mejorar consecuentemente el proceso de navegacin. Las cookies son el referente que nos indica, por ejemplo, si una pgina de nuestra web ha sido vista con\nanterioridad, o si su visita es nueva o recurrente. \n\nLas cookies que utilizamos no almacenan dato personal alguno, ni ningn tipo de informacin que pueda identificarle. \n\nEn caso de no querer recibir cookies, por favor configure su navegador de Internet para que las borre del disco duro de su ordenador, las bloquee o le avise en caso de instalacin de las mismas. ","path":"cookies.html","comments":1,"layout":"page","_id":"ck70mab0j0003bss3qkxl6uky","content":"<p>Utilizamos cookies para facilitar el uso de nuestra pgina web.</p><p>Las cookies son pequeos ficheros de texto que su navegador almacena en el disco duro de su ordenador y que son necesarias para navegar por nuestra pgina web.</p><p>Las utilizamos para entender mejor la manera en la que se usa nuestra pgina web y de esta manera poder mejorar consecuentemente el proceso de navegacin. Las cookies son el referente que nos indica, por ejemplo, si una pgina de nuestra web ha sido vista con<br>anterioridad, o si su visita es nueva o recurrente.</p><p>Las cookies que utilizamos no almacenan dato personal alguno, ni ningn tipo de informacin que pueda identificarle.</p><p>En caso de no querer recibir cookies, por favor configure su navegador de Internet para que las borre del disco duro de su ordenador, las bloquee o le avise en caso de instalacin de las mismas.</p>","site":{"data":{}},"excerpt":"","more":"<p>Utilizamos cookies para facilitar el uso de nuestra pgina web.</p><p>Las cookies son pequeos ficheros de texto que su navegador almacena en el disco duro de su ordenador y que son necesarias para navegar por nuestra pgina web.</p><p>Las utilizamos para entender mejor la manera en la que se usa nuestra pgina web y de esta manera poder mejorar consecuentemente el proceso de navegacin. Las cookies son el referente que nos indica, por ejemplo, si una pgina de nuestra web ha sido vista con<br>anterioridad, o si su visita es nueva o recurrente.</p><p>Las cookies que utilizamos no almacenan dato personal alguno, ni ningn tipo de informacin que pueda identificarle.</p><p>En caso de no querer recibir cookies, por favor configure su navegador de Internet para que las borre del disco duro de su ordenador, las bloquee o le avise en caso de instalacin de las mismas.</p>"},{"title":"Cursos Online de introduccin a Angular","updated":"2019-04-24T12:07:39.000Z","date":"2019-03-20T09:07:39.000Z","_content":"\n[Angular Basic: Curso de introduccin desde cero al desarrollo con Angular.](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders)\n\n## [0 - Hola Angular CLI](../hola-angular-cli)\n\n### 0.1 Angular y el CLI\n\n- Instalacin de Angular CLI 7\n- Crear y ejecutar aplicaciones Angular\n\n### 0.2 Estructura de una aplicacin Angular\n\n- Ficheros y carpetas principales\n- Edicin de un Hola Mundo\n\n### 0.3 Configuracin\n\n- Configurar el CLI\n- Configurar el Workflow\n- Configurar la aplicacin\n\n### 0.4 Angular y su ecosistema\n\n- Extensiones de Visual Studio\n- Configurar Prettier\n- Ecosistema de terceros\n\n## [1 - Base para una aplicacin Angular](../base-aplicacion-angular)\n\n### 1.1 - Mdulos\n\n- Anatoma de un mdulo\n- Generacin de mdulos\n\n### 1.2 - Componentes\n\n- Anatoma de un componente\n- Generacin de componentes\n\n### 1.3 - Visibilidad entre componentes\n\n- Componentes pblicos y privados\n- Importacin y exportacin entre mdulos\n\n### 1.4 - Transitividad y Organizacin\n\n- Transitividad en una cadena de mdulos\n- Organizacin de la aplicacin en mdulos\n\n## [2 - Pginas y rutas SPA](../paginas-y-rutas-angular-spa)\n\n### 2.1 Rutas\n\n- RouterModule\n- Router Outlet\n- Router Link\n\n### 2.2 Lazy Loading\n\n- Webpack y los bundles por ruta\n- El enrutador delegado\n- Navegacin\n\n### 2.3 Rutas anidadas\n\n- Children\n- RouterOutlet anidado\n\n### 2.4 Parmetros\n\n- Variables en la ruta\n- ActivatedRoute\n\n## [3 - Formularios, tablas y modelos de datos](../formularios-tablas-y-modelos-de-datos-en-angular)\n\n### 3.1 Binding\n\n- Base\n- Directivas\n\n### 3.2 Doble Binding\n\n- NgModel\n- Form\n\n### 3.3 Estructuras\n\n- ngFor\n- ngIf\n\n### 3.4 Modelo y controlador\n\n- Interfaces y modelos\n- ViewModel en el controlador\n\n## [4 - Flujo de datos entre componentes](../flujo-de-datos-entre-componentes-angular)\n\n### 4.1 Comunicacin entre componentes\n\n- Necesidad de comunicacin\n- Escenarios\n\n### 4.2 Contenedor / Presentadores\n\n- El patrn Contenedor / Presentadores\n- El contenedor\n- Envo hacia el presentador con @Input()\n- Respuesta del presentador con @Output()\n\n### 4.3 Otras comunicaciones\n\n- Comunicacin entre distintas pginas\n- Comunicacin entre estructuras desacopladas\n\n## [5 - Servicios inyectables](../servicios-inyectables-en-Angular)\n\n### 5.1 Inyeccin de dependencias\n\n- Generacin de servicios\n- Consumo de dependencias\n\n### 5.2 Inversin del control\n\n- Interface y servicio base\n- Implementaciones\n- Provisin manual\n- Factora\n\n## [6 - Comunicaciones http](../comunicaciones-http-en-Angular)\n\n### 6.1 El servicio HttpClient\n\n- Importacin y declaracin de servicios\n- Obtencin de datos\n- Envo de datos\n- Actualizacin de datos\n\n### 6.2 Observables\n\n- Async\n- pipe\n- operators\n\n### 6.3 Interceptores\n\n- La interfaz HttpInterceptor\n- Inversin del control va token\n- Un auditor de llamadas\n\n## [7 - Vigilancia y seguridad](../vigilancia-y-seguridad-en-Angular)\n\n### 7.1 Observables para monitorizar datos\n\n- Productores de observables\n- Un Store de notificaciones\n- Desacoplados pero conectados\n\n### 7.2 Interceptores para gestionar errores\n\n- El operador catchError\n- Gestin centralizada de errores\n\n### 7.3 Un notificador de problemas\n\n- Emisin mediante el Store\n- Recepcin desacoplada del interceptor\n\n## [8 - Formularios reactivos](formularios-reactivos-con-Angular)\n\n### 8.1 Desacople entre vista y modelo\n\n- Form builder\n- Form control\n- Form view\n\n### 8.2 Validacin y estados\n\n- Validadores predefinidos y personalizados\n- Estados de cambio y validacin\n\n### 8.3 Un gestor de credenciales\n\n- Deteccin y redireccin de intrusos\n- Almacenamiento y uso del token\n\n## [9 - Material Design y CLI](../Material-Design-y-CLI-de-Angular)\n\n### 9.1 Repositorio multi-proyecto\n\n- Carpetas src y projects\n- Compilacin multi - proyecto\n\n### 9.2 Instalacin y configuracin de Material\n\n- Agregar dependencias con schematics\n- Estilos, iconos y temas bsicos\n\n### 9.3 Componentes bsicos\n\n- Navegacin y layout\n- Componentes bsicos\n\n[Empieza ya!](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders)\n\n[Contenido detallado Angular Business](../cursos/angular-business)","source":"Cursos/angular-basic.md","raw":"---\ntitle: Cursos Online de introduccin a Angular\npermalink: cursos/angular-basic\nupdated: '2019-04-24 14:07:39'\ndate: 2019-03-20 10:07:39\n---\n\n[Angular Basic: Curso de introduccin desde cero al desarrollo con Angular.](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders)\n\n## [0 - Hola Angular CLI](../hola-angular-cli)\n\n### 0.1 Angular y el CLI\n\n- Instalacin de Angular CLI 7\n- Crear y ejecutar aplicaciones Angular\n\n### 0.2 Estructura de una aplicacin Angular\n\n- Ficheros y carpetas principales\n- Edicin de un Hola Mundo\n\n### 0.3 Configuracin\n\n- Configurar el CLI\n- Configurar el Workflow\n- Configurar la aplicacin\n\n### 0.4 Angular y su ecosistema\n\n- Extensiones de Visual Studio\n- Configurar Prettier\n- Ecosistema de terceros\n\n## [1 - Base para una aplicacin Angular](../base-aplicacion-angular)\n\n### 1.1 - Mdulos\n\n- Anatoma de un mdulo\n- Generacin de mdulos\n\n### 1.2 - Componentes\n\n- Anatoma de un componente\n- Generacin de componentes\n\n### 1.3 - Visibilidad entre componentes\n\n- Componentes pblicos y privados\n- Importacin y exportacin entre mdulos\n\n### 1.4 - Transitividad y Organizacin\n\n- Transitividad en una cadena de mdulos\n- Organizacin de la aplicacin en mdulos\n\n## [2 - Pginas y rutas SPA](../paginas-y-rutas-angular-spa)\n\n### 2.1 Rutas\n\n- RouterModule\n- Router Outlet\n- Router Link\n\n### 2.2 Lazy Loading\n\n- Webpack y los bundles por ruta\n- El enrutador delegado\n- Navegacin\n\n### 2.3 Rutas anidadas\n\n- Children\n- RouterOutlet anidado\n\n### 2.4 Parmetros\n\n- Variables en la ruta\n- ActivatedRoute\n\n## [3 - Formularios, tablas y modelos de datos](../formularios-tablas-y-modelos-de-datos-en-angular)\n\n### 3.1 Binding\n\n- Base\n- Directivas\n\n### 3.2 Doble Binding\n\n- NgModel\n- Form\n\n### 3.3 Estructuras\n\n- ngFor\n- ngIf\n\n### 3.4 Modelo y controlador\n\n- Interfaces y modelos\n- ViewModel en el controlador\n\n## [4 - Flujo de datos entre componentes](../flujo-de-datos-entre-componentes-angular)\n\n### 4.1 Comunicacin entre componentes\n\n- Necesidad de comunicacin\n- Escenarios\n\n### 4.2 Contenedor / Presentadores\n\n- El patrn Contenedor / Presentadores\n- El contenedor\n- Envo hacia el presentador con @Input()\n- Respuesta del presentador con @Output()\n\n### 4.3 Otras comunicaciones\n\n- Comunicacin entre distintas pginas\n- Comunicacin entre estructuras desacopladas\n\n## [5 - Servicios inyectables](../servicios-inyectables-en-Angular)\n\n### 5.1 Inyeccin de dependencias\n\n- Generacin de servicios\n- Consumo de dependencias\n\n### 5.2 Inversin del control\n\n- Interface y servicio base\n- Implementaciones\n- Provisin manual\n- Factora\n\n## [6 - Comunicaciones http](../comunicaciones-http-en-Angular)\n\n### 6.1 El servicio HttpClient\n\n- Importacin y declaracin de servicios\n- Obtencin de datos\n- Envo de datos\n- Actualizacin de datos\n\n### 6.2 Observables\n\n- Async\n- pipe\n- operators\n\n### 6.3 Interceptores\n\n- La interfaz HttpInterceptor\n- Inversin del control va token\n- Un auditor de llamadas\n\n## [7 - Vigilancia y seguridad](../vigilancia-y-seguridad-en-Angular)\n\n### 7.1 Observables para monitorizar datos\n\n- Productores de observables\n- Un Store de notificaciones\n- Desacoplados pero conectados\n\n### 7.2 Interceptores para gestionar errores\n\n- El operador catchError\n- Gestin centralizada de errores\n\n### 7.3 Un notificador de problemas\n\n- Emisin mediante el Store\n- Recepcin desacoplada del interceptor\n\n## [8 - Formularios reactivos](formularios-reactivos-con-Angular)\n\n### 8.1 Desacople entre vista y modelo\n\n- Form builder\n- Form control\n- Form view\n\n### 8.2 Validacin y estados\n\n- Validadores predefinidos y personalizados\n- Estados de cambio y validacin\n\n### 8.3 Un gestor de credenciales\n\n- Deteccin y redireccin de intrusos\n- Almacenamiento y uso del token\n\n## [9 - Material Design y CLI](../Material-Design-y-CLI-de-Angular)\n\n### 9.1 Repositorio multi-proyecto\n\n- Carpetas src y projects\n- Compilacin multi - proyecto\n\n### 9.2 Instalacin y configuracin de Material\n\n- Agregar dependencias con schematics\n- Estilos, iconos y temas bsicos\n\n### 9.3 Componentes bsicos\n\n- Navegacin y layout\n- Componentes bsicos\n\n[Empieza ya!](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders)\n\n[Contenido detallado Angular Business](../cursos/angular-business)","path":"cursos/angular-basic.html","comments":1,"layout":"page","_id":"ck70mab0q0005bss32x95ubsz","content":"<p><a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Angular Basic: Curso de introduccin desde cero al desarrollo con Angular.</a></p><h2 id=\"0-Hola-Angular-CLI\"><a href=\"#0-Hola-Angular-CLI\" class=\"headerlink\" title=\"0 - Hola Angular CLI\"></a><a href=\"../hola-angular-cli\">0 - Hola Angular CLI</a></h2><h3 id=\"0-1-Angular-y-el-CLI\"><a href=\"#0-1-Angular-y-el-CLI\" class=\"headerlink\" title=\"0.1 Angular y el CLI\"></a>0.1 Angular y el CLI</h3><ul><li>Instalacin de Angular CLI 7</li><li>Crear y ejecutar aplicaciones Angular</li></ul><h3 id=\"0-2-Estructura-de-una-aplicacion-Angular\"><a href=\"#0-2-Estructura-de-una-aplicacion-Angular\" class=\"headerlink\" title=\"0.2 Estructura de una aplicacin Angular\"></a>0.2 Estructura de una aplicacin Angular</h3><ul><li>Ficheros y carpetas principales</li><li>Edicin de un Hola Mundo</li></ul><h3 id=\"0-3-Configuracion\"><a href=\"#0-3-Configuracion\" class=\"headerlink\" title=\"0.3 Configuracin\"></a>0.3 Configuracin</h3><ul><li>Configurar el CLI</li><li>Configurar el Workflow</li><li>Configurar la aplicacin</li></ul><h3 id=\"0-4-Angular-y-su-ecosistema\"><a href=\"#0-4-Angular-y-su-ecosistema\" class=\"headerlink\" title=\"0.4 Angular y su ecosistema\"></a>0.4 Angular y su ecosistema</h3><ul><li>Extensiones de Visual Studio</li><li>Configurar Prettier</li><li>Ecosistema de terceros</li></ul><h2 id=\"1-Base-para-una-aplicacion-Angular\"><a href=\"#1-Base-para-una-aplicacion-Angular\" class=\"headerlink\" title=\"1 - Base para una aplicacin Angular\"></a><a href=\"../base-aplicacion-angular\">1 - Base para una aplicacin Angular</a></h2><h3 id=\"1-1-Modulos\"><a href=\"#1-1-Modulos\" class=\"headerlink\" title=\"1.1 - Mdulos\"></a>1.1 - Mdulos</h3><ul><li>Anatoma de un mdulo</li><li>Generacin de mdulos</li></ul><h3 id=\"1-2-Componentes\"><a href=\"#1-2-Componentes\" class=\"headerlink\" title=\"1.2 - Componentes\"></a>1.2 - Componentes</h3><ul><li>Anatoma de un componente</li><li>Generacin de componentes</li></ul><h3 id=\"1-3-Visibilidad-entre-componentes\"><a href=\"#1-3-Visibilidad-entre-componentes\" class=\"headerlink\" title=\"1.3 - Visibilidad entre componentes\"></a>1.3 - Visibilidad entre componentes</h3><ul><li>Componentes pblicos y privados</li><li>Importacin y exportacin entre mdulos</li></ul><h3 id=\"1-4-Transitividad-y-Organizacion\"><a href=\"#1-4-Transitividad-y-Organizacion\" class=\"headerlink\" title=\"1.4 - Transitividad y Organizacin\"></a>1.4 - Transitividad y Organizacin</h3><ul><li>Transitividad en una cadena de mdulos</li><li>Organizacin de la aplicacin en mdulos</li></ul><h2 id=\"2-Paginas-y-rutas-SPA\"><a href=\"#2-Paginas-y-rutas-SPA\" class=\"headerlink\" title=\"2 - Pginas y rutas SPA\"></a><a href=\"../paginas-y-rutas-angular-spa\">2 - Pginas y rutas SPA</a></h2><h3 id=\"2-1-Rutas\"><a href=\"#2-1-Rutas\" class=\"headerlink\" title=\"2.1 Rutas\"></a>2.1 Rutas</h3><ul><li>RouterModule</li><li>Router Outlet</li><li>Router Link</li></ul><h3 id=\"2-2-Lazy-Loading\"><a href=\"#2-2-Lazy-Loading\" class=\"headerlink\" title=\"2.2 Lazy Loading\"></a>2.2 Lazy Loading</h3><ul><li>Webpack y los bundles por ruta</li><li>El enrutador delegado</li><li>Navegacin</li></ul><h3 id=\"2-3-Rutas-anidadas\"><a href=\"#2-3-Rutas-anidadas\" class=\"headerlink\" title=\"2.3 Rutas anidadas\"></a>2.3 Rutas anidadas</h3><ul><li>Children</li><li>RouterOutlet anidado</li></ul><h3 id=\"2-4-Parametros\"><a href=\"#2-4-Parametros\" class=\"headerlink\" title=\"2.4 Parmetros\"></a>2.4 Parmetros</h3><ul><li>Variables en la ruta</li><li>ActivatedRoute</li></ul><h2 id=\"3-Formularios-tablas-y-modelos-de-datos\"><a href=\"#3-Formularios-tablas-y-modelos-de-datos\" class=\"headerlink\" title=\"3 - Formularios, tablas y modelos de datos\"></a><a href=\"../formularios-tablas-y-modelos-de-datos-en-angular\">3 - Formularios, tablas y modelos de datos</a></h2><h3 id=\"3-1-Binding\"><a href=\"#3-1-Binding\" class=\"headerlink\" title=\"3.1 Binding\"></a>3.1 Binding</h3><ul><li>Base</li><li>Directivas</li></ul><h3 id=\"3-2-Doble-Binding\"><a href=\"#3-2-Doble-Binding\" class=\"headerlink\" title=\"3.2 Doble Binding\"></a>3.2 Doble Binding</h3><ul><li>NgModel</li><li>Form</li></ul><h3 id=\"3-3-Estructuras\"><a href=\"#3-3-Estructuras\" class=\"headerlink\" title=\"3.3 Estructuras\"></a>3.3 Estructuras</h3><ul><li>ngFor</li><li>ngIf</li></ul><h3 id=\"3-4-Modelo-y-controlador\"><a href=\"#3-4-Modelo-y-controlador\" class=\"headerlink\" title=\"3.4 Modelo y controlador\"></a>3.4 Modelo y controlador</h3><ul><li>Interfaces y modelos</li><li>ViewModel en el controlador</li></ul><h2 id=\"4-Flujo-de-datos-entre-componentes\"><a href=\"#4-Flujo-de-datos-entre-componentes\" class=\"headerlink\" title=\"4 - Flujo de datos entre componentes\"></a><a href=\"../flujo-de-datos-entre-componentes-angular\">4 - Flujo de datos entre componentes</a></h2><h3 id=\"4-1-Comunicacion-entre-componentes\"><a href=\"#4-1-Comunicacion-entre-componentes\" class=\"headerlink\" title=\"4.1 Comunicacin entre componentes\"></a>4.1 Comunicacin entre componentes</h3><ul><li>Necesidad de comunicacin</li><li>Escenarios</li></ul><h3 id=\"4-2-Contenedor-Presentadores\"><a href=\"#4-2-Contenedor-Presentadores\" class=\"headerlink\" title=\"4.2 Contenedor / Presentadores\"></a>4.2 Contenedor / Presentadores</h3><ul><li>El patrn Contenedor / Presentadores</li><li>El contenedor</li><li>Envo hacia el presentador con @Input()</li><li>Respuesta del presentador con @Output()</li></ul><h3 id=\"4-3-Otras-comunicaciones\"><a href=\"#4-3-Otras-comunicaciones\" class=\"headerlink\" title=\"4.3 Otras comunicaciones\"></a>4.3 Otras comunicaciones</h3><ul><li>Comunicacin entre distintas pginas</li><li>Comunicacin entre estructuras desacopladas</li></ul><h2 id=\"5-Servicios-inyectables\"><a href=\"#5-Servicios-inyectables\" class=\"headerlink\" title=\"5 - Servicios inyectables\"></a><a href=\"../servicios-inyectables-en-Angular\">5 - Servicios inyectables</a></h2><h3 id=\"5-1-Inyeccion-de-dependencias\"><a href=\"#5-1-Inyeccion-de-dependencias\" class=\"headerlink\" title=\"5.1 Inyeccin de dependencias\"></a>5.1 Inyeccin de dependencias</h3><ul><li>Generacin de servicios</li><li>Consumo de dependencias</li></ul><h3 id=\"5-2-Inversion-del-control\"><a href=\"#5-2-Inversion-del-control\" class=\"headerlink\" title=\"5.2 Inversin del control\"></a>5.2 Inversin del control</h3><ul><li>Interface y servicio base</li><li>Implementaciones</li><li>Provisin manual</li><li>Factora</li></ul><h2 id=\"6-Comunicaciones-http\"><a href=\"#6-Comunicaciones-http\" class=\"headerlink\" title=\"6 - Comunicaciones http\"></a><a href=\"../comunicaciones-http-en-Angular\">6 - Comunicaciones http</a></h2><h3 id=\"6-1-El-servicio-HttpClient\"><a href=\"#6-1-El-servicio-HttpClient\" class=\"headerlink\" title=\"6.1 El servicio HttpClient\"></a>6.1 El servicio HttpClient</h3><ul><li>Importacin y declaracin de servicios</li><li>Obtencin de datos</li><li>Envo de datos</li><li>Actualizacin de datos</li></ul><h3 id=\"6-2-Observables\"><a href=\"#6-2-Observables\" class=\"headerlink\" title=\"6.2 Observables\"></a>6.2 Observables</h3><ul><li>Async</li><li>pipe</li><li>operators</li></ul><h3 id=\"6-3-Interceptores\"><a href=\"#6-3-Interceptores\" class=\"headerlink\" title=\"6.3 Interceptores\"></a>6.3 Interceptores</h3><ul><li>La interfaz HttpInterceptor</li><li>Inversin del control va token</li><li>Un auditor de llamadas</li></ul><h2 id=\"7-Vigilancia-y-seguridad\"><a href=\"#7-Vigilancia-y-seguridad\" class=\"headerlink\" title=\"7 - Vigilancia y seguridad\"></a><a href=\"../vigilancia-y-seguridad-en-Angular\">7 - Vigilancia y seguridad</a></h2><h3 id=\"7-1-Observables-para-monitorizar-datos\"><a href=\"#7-1-Observables-para-monitorizar-datos\" class=\"headerlink\" title=\"7.1 Observables para monitorizar datos\"></a>7.1 Observables para monitorizar datos</h3><ul><li>Productores de observables</li><li>Un Store de notificaciones</li><li>Desacoplados pero conectados</li></ul><h3 id=\"7-2-Interceptores-para-gestionar-errores\"><a href=\"#7-2-Interceptores-para-gestionar-errores\" class=\"headerlink\" title=\"7.2 Interceptores para gestionar errores\"></a>7.2 Interceptores para gestionar errores</h3><ul><li>El operador catchError</li><li>Gestin centralizada de errores</li></ul><h3 id=\"7-3-Un-notificador-de-problemas\"><a href=\"#7-3-Un-notificador-de-problemas\" class=\"headerlink\" title=\"7.3 Un notificador de problemas\"></a>7.3 Un notificador de problemas</h3><ul><li>Emisin mediante el Store</li><li>Recepcin desacoplada del interceptor</li></ul><h2 id=\"8-Formularios-reactivos\"><a href=\"#8-Formularios-reactivos\" class=\"headerlink\" title=\"8 - Formularios reactivos\"></a><a href=\"formularios-reactivos-con-Angular\">8 - Formularios reactivos</a></h2><h3 id=\"8-1-Desacople-entre-vista-y-modelo\"><a href=\"#8-1-Desacople-entre-vista-y-modelo\" class=\"headerlink\" title=\"8.1 Desacople entre vista y modelo\"></a>8.1 Desacople entre vista y modelo</h3><ul><li>Form builder</li><li>Form control</li><li>Form view</li></ul><h3 id=\"8-2-Validacion-y-estados\"><a href=\"#8-2-Validacion-y-estados\" class=\"headerlink\" title=\"8.2 Validacin y estados\"></a>8.2 Validacin y estados</h3><ul><li>Validadores predefinidos y personalizados</li><li>Estados de cambio y validacin</li></ul><h3 id=\"8-3-Un-gestor-de-credenciales\"><a href=\"#8-3-Un-gestor-de-credenciales\" class=\"headerlink\" title=\"8.3 Un gestor de credenciales\"></a>8.3 Un gestor de credenciales</h3><ul><li>Deteccin y redireccin de intrusos</li><li>Almacenamiento y uso del token</li></ul><h2 id=\"9-Material-Design-y-CLI\"><a href=\"#9-Material-Design-y-CLI\" class=\"headerlink\" title=\"9 - Material Design y CLI\"></a><a href=\"../Material-Design-y-CLI-de-Angular\">9 - Material Design y CLI</a></h2><h3 id=\"9-1-Repositorio-multi-proyecto\"><a href=\"#9-1-Repositorio-multi-proyecto\" class=\"headerlink\" title=\"9.1 Repositorio multi-proyecto\"></a>9.1 Repositorio multi-proyecto</h3><ul><li>Carpetas src y projects</li><li>Compilacin multi - proyecto</li></ul><h3 id=\"9-2-Instalacion-y-configuracion-de-Material\"><a href=\"#9-2-Instalacion-y-configuracion-de-Material\" class=\"headerlink\" title=\"9.2 Instalacin y configuracin de Material\"></a>9.2 Instalacin y configuracin de Material</h3><ul><li>Agregar dependencias con schematics</li><li>Estilos, iconos y temas bsicos</li></ul><h3 id=\"9-3-Componentes-basicos\"><a href=\"#9-3-Componentes-basicos\" class=\"headerlink\" title=\"9.3 Componentes bsicos\"></a>9.3 Componentes bsicos</h3><ul><li>Navegacin y layout</li><li>Componentes bsicos</li></ul><p><a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Empieza ya!</a></p><p><a href=\"../cursos/angular-business\">Contenido detallado Angular Business</a></p>","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Angular Basic: Curso de introduccin desde cero al desarrollo con Angular.</a></p><h2 id=\"0-Hola-Angular-CLI\"><a href=\"#0-Hola-Angular-CLI\" class=\"headerlink\" title=\"0 - Hola Angular CLI\"></a><a href=\"../hola-angular-cli\">0 - Hola Angular CLI</a></h2><h3 id=\"0-1-Angular-y-el-CLI\"><a href=\"#0-1-Angular-y-el-CLI\" class=\"headerlink\" title=\"0.1 Angular y el CLI\"></a>0.1 Angular y el CLI</h3><ul><li>Instalacin de Angular CLI 7</li><li>Crear y ejecutar aplicaciones Angular</li></ul><h3 id=\"0-2-Estructura-de-una-aplicacion-Angular\"><a href=\"#0-2-Estructura-de-una-aplicacion-Angular\" class=\"headerlink\" title=\"0.2 Estructura de una aplicacin Angular\"></a>0.2 Estructura de una aplicacin Angular</h3><ul><li>Ficheros y carpetas principales</li><li>Edicin de un Hola Mundo</li></ul><h3 id=\"0-3-Configuracion\"><a href=\"#0-3-Configuracion\" class=\"headerlink\" title=\"0.3 Configuracin\"></a>0.3 Configuracin</h3><ul><li>Configurar el CLI</li><li>Configurar el Workflow</li><li>Configurar la aplicacin</li></ul><h3 id=\"0-4-Angular-y-su-ecosistema\"><a href=\"#0-4-Angular-y-su-ecosistema\" class=\"headerlink\" title=\"0.4 Angular y su ecosistema\"></a>0.4 Angular y su ecosistema</h3><ul><li>Extensiones de Visual Studio</li><li>Configurar Prettier</li><li>Ecosistema de terceros</li></ul><h2 id=\"1-Base-para-una-aplicacion-Angular\"><a href=\"#1-Base-para-una-aplicacion-Angular\" class=\"headerlink\" title=\"1 - Base para una aplicacin Angular\"></a><a href=\"../base-aplicacion-angular\">1 - Base para una aplicacin Angular</a></h2><h3 id=\"1-1-Modulos\"><a href=\"#1-1-Modulos\" class=\"headerlink\" title=\"1.1 - Mdulos\"></a>1.1 - Mdulos</h3><ul><li>Anatoma de un mdulo</li><li>Generacin de mdulos</li></ul><h3 id=\"1-2-Componentes\"><a href=\"#1-2-Componentes\" class=\"headerlink\" title=\"1.2 - Componentes\"></a>1.2 - Componentes</h3><ul><li>Anatoma de un componente</li><li>Generacin de componentes</li></ul><h3 id=\"1-3-Visibilidad-entre-componentes\"><a href=\"#1-3-Visibilidad-entre-componentes\" class=\"headerlink\" title=\"1.3 - Visibilidad entre componentes\"></a>1.3 - Visibilidad entre componentes</h3><ul><li>Componentes pblicos y privados</li><li>Importacin y exportacin entre mdulos</li></ul><h3 id=\"1-4-Transitividad-y-Organizacion\"><a href=\"#1-4-Transitividad-y-Organizacion\" class=\"headerlink\" title=\"1.4 - Transitividad y Organizacin\"></a>1.4 - Transitividad y Organizacin</h3><ul><li>Transitividad en una cadena de mdulos</li><li>Organizacin de la aplicacin en mdulos</li></ul><h2 id=\"2-Paginas-y-rutas-SPA\"><a href=\"#2-Paginas-y-rutas-SPA\" class=\"headerlink\" title=\"2 - Pginas y rutas SPA\"></a><a href=\"../paginas-y-rutas-angular-spa\">2 - Pginas y rutas SPA</a></h2><h3 id=\"2-1-Rutas\"><a href=\"#2-1-Rutas\" class=\"headerlink\" title=\"2.1 Rutas\"></a>2.1 Rutas</h3><ul><li>RouterModule</li><li>Router Outlet</li><li>Router Link</li></ul><h3 id=\"2-2-Lazy-Loading\"><a href=\"#2-2-Lazy-Loading\" class=\"headerlink\" title=\"2.2 Lazy Loading\"></a>2.2 Lazy Loading</h3><ul><li>Webpack y los bundles por ruta</li><li>El enrutador delegado</li><li>Navegacin</li></ul><h3 id=\"2-3-Rutas-anidadas\"><a href=\"#2-3-Rutas-anidadas\" class=\"headerlink\" title=\"2.3 Rutas anidadas\"></a>2.3 Rutas anidadas</h3><ul><li>Children</li><li>RouterOutlet anidado</li></ul><h3 id=\"2-4-Parametros\"><a href=\"#2-4-Parametros\" class=\"headerlink\" title=\"2.4 Parmetros\"></a>2.4 Parmetros</h3><ul><li>Variables en la ruta</li><li>ActivatedRoute</li></ul><h2 id=\"3-Formularios-tablas-y-modelos-de-datos\"><a href=\"#3-Formularios-tablas-y-modelos-de-datos\" class=\"headerlink\" title=\"3 - Formularios, tablas y modelos de datos\"></a><a href=\"../formularios-tablas-y-modelos-de-datos-en-angular\">3 - Formularios, tablas y modelos de datos</a></h2><h3 id=\"3-1-Binding\"><a href=\"#3-1-Binding\" class=\"headerlink\" title=\"3.1 Binding\"></a>3.1 Binding</h3><ul><li>Base</li><li>Directivas</li></ul><h3 id=\"3-2-Doble-Binding\"><a href=\"#3-2-Doble-Binding\" class=\"headerlink\" title=\"3.2 Doble Binding\"></a>3.2 Doble Binding</h3><ul><li>NgModel</li><li>Form</li></ul><h3 id=\"3-3-Estructuras\"><a href=\"#3-3-Estructuras\" class=\"headerlink\" title=\"3.3 Estructuras\"></a>3.3 Estructuras</h3><ul><li>ngFor</li><li>ngIf</li></ul><h3 id=\"3-4-Modelo-y-controlador\"><a href=\"#3-4-Modelo-y-controlador\" class=\"headerlink\" title=\"3.4 Modelo y controlador\"></a>3.4 Modelo y controlador</h3><ul><li>Interfaces y modelos</li><li>ViewModel en el controlador</li></ul><h2 id=\"4-Flujo-de-datos-entre-componentes\"><a href=\"#4-Flujo-de-datos-entre-componentes\" class=\"headerlink\" title=\"4 - Flujo de datos entre componentes\"></a><a href=\"../flujo-de-datos-entre-componentes-angular\">4 - Flujo de datos entre componentes</a></h2><h3 id=\"4-1-Comunicacion-entre-componentes\"><a href=\"#4-1-Comunicacion-entre-componentes\" class=\"headerlink\" title=\"4.1 Comunicacin entre componentes\"></a>4.1 Comunicacin entre componentes</h3><ul><li>Necesidad de comunicacin</li><li>Escenarios</li></ul><h3 id=\"4-2-Contenedor-Presentadores\"><a href=\"#4-2-Contenedor-Presentadores\" class=\"headerlink\" title=\"4.2 Contenedor / Presentadores\"></a>4.2 Contenedor / Presentadores</h3><ul><li>El patrn Contenedor / Presentadores</li><li>El contenedor</li><li>Envo hacia el presentador con @Input()</li><li>Respuesta del presentador con @Output()</li></ul><h3 id=\"4-3-Otras-comunicaciones\"><a href=\"#4-3-Otras-comunicaciones\" class=\"headerlink\" title=\"4.3 Otras comunicaciones\"></a>4.3 Otras comunicaciones</h3><ul><li>Comunicacin entre distintas pginas</li><li>Comunicacin entre estructuras desacopladas</li></ul><h2 id=\"5-Servicios-inyectables\"><a href=\"#5-Servicios-inyectables\" class=\"headerlink\" title=\"5 - Servicios inyectables\"></a><a href=\"../servicios-inyectables-en-Angular\">5 - Servicios inyectables</a></h2><h3 id=\"5-1-Inyeccion-de-dependencias\"><a href=\"#5-1-Inyeccion-de-dependencias\" class=\"headerlink\" title=\"5.1 Inyeccin de dependencias\"></a>5.1 Inyeccin de dependencias</h3><ul><li>Generacin de servicios</li><li>Consumo de dependencias</li></ul><h3 id=\"5-2-Inversion-del-control\"><a href=\"#5-2-Inversion-del-control\" class=\"headerlink\" title=\"5.2 Inversin del control\"></a>5.2 Inversin del control</h3><ul><li>Interface y servicio base</li><li>Implementaciones</li><li>Provisin manual</li><li>Factora</li></ul><h2 id=\"6-Comunicaciones-http\"><a href=\"#6-Comunicaciones-http\" class=\"headerlink\" title=\"6 - Comunicaciones http\"></a><a href=\"../comunicaciones-http-en-Angular\">6 - Comunicaciones http</a></h2><h3 id=\"6-1-El-servicio-HttpClient\"><a href=\"#6-1-El-servicio-HttpClient\" class=\"headerlink\" title=\"6.1 El servicio HttpClient\"></a>6.1 El servicio HttpClient</h3><ul><li>Importacin y declaracin de servicios</li><li>Obtencin de datos</li><li>Envo de datos</li><li>Actualizacin de datos</li></ul><h3 id=\"6-2-Observables\"><a href=\"#6-2-Observables\" class=\"headerlink\" title=\"6.2 Observables\"></a>6.2 Observables</h3><ul><li>Async</li><li>pipe</li><li>operators</li></ul><h3 id=\"6-3-Interceptores\"><a href=\"#6-3-Interceptores\" class=\"headerlink\" title=\"6.3 Interceptores\"></a>6.3 Interceptores</h3><ul><li>La interfaz HttpInterceptor</li><li>Inversin del control va token</li><li>Un auditor de llamadas</li></ul><h2 id=\"7-Vigilancia-y-seguridad\"><a href=\"#7-Vigilancia-y-seguridad\" class=\"headerlink\" title=\"7 - Vigilancia y seguridad\"></a><a href=\"../vigilancia-y-seguridad-en-Angular\">7 - Vigilancia y seguridad</a></h2><h3 id=\"7-1-Observables-para-monitorizar-datos\"><a href=\"#7-1-Observables-para-monitorizar-datos\" class=\"headerlink\" title=\"7.1 Observables para monitorizar datos\"></a>7.1 Observables para monitorizar datos</h3><ul><li>Productores de observables</li><li>Un Store de notificaciones</li><li>Desacoplados pero conectados</li></ul><h3 id=\"7-2-Interceptores-para-gestionar-errores\"><a href=\"#7-2-Interceptores-para-gestionar-errores\" class=\"headerlink\" title=\"7.2 Interceptores para gestionar errores\"></a>7.2 Interceptores para gestionar errores</h3><ul><li>El operador catchError</li><li>Gestin centralizada de errores</li></ul><h3 id=\"7-3-Un-notificador-de-problemas\"><a href=\"#7-3-Un-notificador-de-problemas\" class=\"headerlink\" title=\"7.3 Un notificador de problemas\"></a>7.3 Un notificador de problemas</h3><ul><li>Emisin mediante el Store</li><li>Recepcin desacoplada del interceptor</li></ul><h2 id=\"8-Formularios-reactivos\"><a href=\"#8-Formularios-reactivos\" class=\"headerlink\" title=\"8 - Formularios reactivos\"></a><a href=\"formularios-reactivos-con-Angular\">8 - Formularios reactivos</a></h2><h3 id=\"8-1-Desacople-entre-vista-y-modelo\"><a href=\"#8-1-Desacople-entre-vista-y-modelo\" class=\"headerlink\" title=\"8.1 Desacople entre vista y modelo\"></a>8.1 Desacople entre vista y modelo</h3><ul><li>Form builder</li><li>Form control</li><li>Form view</li></ul><h3 id=\"8-2-Validacion-y-estados\"><a href=\"#8-2-Validacion-y-estados\" class=\"headerlink\" title=\"8.2 Validacin y estados\"></a>8.2 Validacin y estados</h3><ul><li>Validadores predefinidos y personalizados</li><li>Estados de cambio y validacin</li></ul><h3 id=\"8-3-Un-gestor-de-credenciales\"><a href=\"#8-3-Un-gestor-de-credenciales\" class=\"headerlink\" title=\"8.3 Un gestor de credenciales\"></a>8.3 Un gestor de credenciales</h3><ul><li>Deteccin y redireccin de intrusos</li><li>Almacenamiento y uso del token</li></ul><h2 id=\"9-Material-Design-y-CLI\"><a href=\"#9-Material-Design-y-CLI\" class=\"headerlink\" title=\"9 - Material Design y CLI\"></a><a href=\"../Material-Design-y-CLI-de-Angular\">9 - Material Design y CLI</a></h2><h3 id=\"9-1-Repositorio-multi-proyecto\"><a href=\"#9-1-Repositorio-multi-proyecto\" class=\"headerlink\" title=\"9.1 Repositorio multi-proyecto\"></a>9.1 Repositorio multi-proyecto</h3><ul><li>Carpetas src y projects</li><li>Compilacin multi - proyecto</li></ul><h3 id=\"9-2-Instalacion-y-configuracion-de-Material\"><a href=\"#9-2-Instalacion-y-configuracion-de-Material\" class=\"headerlink\" title=\"9.2 Instalacin y configuracin de Material\"></a>9.2 Instalacin y configuracin de Material</h3><ul><li>Agregar dependencias con schematics</li><li>Estilos, iconos y temas bsicos</li></ul><h3 id=\"9-3-Componentes-basicos\"><a href=\"#9-3-Componentes-basicos\" class=\"headerlink\" title=\"9.3 Componentes bsicos\"></a>9.3 Componentes bsicos</h3><ul><li>Navegacin y layout</li><li>Componentes bsicos</li></ul><p><a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Empieza ya!</a></p><p><a href=\"../cursos/angular-business\">Contenido detallado Angular Business</a></p>"},{"title":"Contacto","id":4,"updated":"2017-02-14T08:21:50.000Z","date":"2015-09-16T11:52:52.000Z","_content":"\n<div>\nVivimos en la nube y nos relacionamos contigo en cualquier sitio desde <b>A Corua, Espaa.</b>\n</div>\n<p/>\n<div>\nSi quieres <b>visitarnos</b> ven a:\n</div>\n\n<hr/>\n\n<div itemscope itemtype=\"http://schema.org/LocalBusiness\">  \n  <h4><span itemprop=\"name\">gora Binaria S.L</span></h4>\n  <span itemprop=\"description\"> Factora de software y academia de programadores.</span>\n  <p/>\n  <div itemprop=\"address\" itemscope itemtype=\"http://schema.org/PostalAddress\">\n    <span itemprop=\"streetAddress\">Av. Primera C10. Edif Abanca Innova</span>\n    CP:<span itemprop=\"postalCode\">15190</span>\n    <p/>\n    <span itemprop=\"addressLocality\">A Corua</span>,\n    <span itemprop=\"addressCountry\">Espaa</span>\n  </div>\n  Telefno: <span itemprop=\"telephone\"><a href=\"tel:+34 609884782\">+34 609884782</a></span>\n  <p/>\n  Email: <span itemprop=\"email\">info(at)agorabinaria.com</span>\n</div>\n\n<hr />\n\n<p>Para temas comerciales de cursos presenciales con <strong>Vita Digital S.L.</strong>:  </p>\n\n<blockquote>\n  <p> Email: <span itemprop=\"email\">vitae(at)vitaedigital.com</span> </p>\n  <p> Web: <span itemprop=\"web\"><a href=\"http://www.vitaedigital.com/\">http://www.vitaedigital.com/</a></span> </p>\n  \n</blockquote>","source":"Contacto/index.md","raw":"---\ntitle: Contacto\npermalink: contacto\nid: 4\nupdated: '2017-02-14 09:21:50'\ndate: 2015-09-16 13:52:52\n---\n\n<div>\nVivimos en la nube y nos relacionamos contigo en cualquier sitio desde <b>A Corua, Espaa.</b>\n</div>\n<p/>\n<div>\nSi quieres <b>visitarnos</b> ven a:\n</div>\n\n<hr/>\n\n<div itemscope itemtype=\"http://schema.org/LocalBusiness\">  \n  <h4><span itemprop=\"name\">gora Binaria S.L</span></h4>\n  <span itemprop=\"description\"> Factora de software y academia de programadores.</span>\n  <p/>\n  <div itemprop=\"address\" itemscope itemtype=\"http://schema.org/PostalAddress\">\n    <span itemprop=\"streetAddress\">Av. Primera C10. Edif Abanca Innova</span>\n    CP:<span itemprop=\"postalCode\">15190</span>\n    <p/>\n    <span itemprop=\"addressLocality\">A Corua</span>,\n    <span itemprop=\"addressCountry\">Espaa</span>\n  </div>\n  Telefno: <span itemprop=\"telephone\"><a href=\"tel:+34 609884782\">+34 609884782</a></span>\n  <p/>\n  Email: <span itemprop=\"email\">info(at)agorabinaria.com</span>\n</div>\n\n<hr />\n\n<p>Para temas comerciales de cursos presenciales con <strong>Vita Digital S.L.</strong>:  </p>\n\n<blockquote>\n  <p> Email: <span itemprop=\"email\">vitae(at)vitaedigital.com</span> </p>\n  <p> Web: <span itemprop=\"web\"><a href=\"http://www.vitaedigital.com/\">http://www.vitaedigital.com/</a></span> </p>\n  \n</blockquote>","path":"contacto.html","comments":1,"layout":"page","_id":"ck70mab0s0007bss3hjvguayg","content":"<div>Vivimos en la nube y nos relacionamos contigo en cualquier sitio desde <b>A Corua, Espaa.</b></div><p><div>Si quieres <b>visitarnos</b> ven a:</div><hr><div itemscope=\"\" itemtype=\"http://schema.org/LocalBusiness\"><h4><span itemprop=\"name\">gora Binaria S.L</span></h4><span itemprop=\"description\">Factora de software y academia de programadores.</span><p><div itemprop=\"address\" itemscope=\"\" itemtype=\"http://schema.org/PostalAddress\"><span itemprop=\"streetAddress\">Av. Primera C10. Edif Abanca Innova</span> CP:<span itemprop=\"postalCode\">15190</span><p><span itemprop=\"addressLocality\">A Corua</span>, <span itemprop=\"addressCountry\">Espaa</span></p></div>Telefno: <span itemprop=\"telephone\"><a href=\"tel:+34 609884782\" target=\"_blank\" rel=\"noopener\">+34 609884782</a></span></p><p>Email: <span itemprop=\"email\">info(at)agorabinaria.com</span></p></div><hr></p><p>Para temas comerciales de cursos presenciales con <strong>Vita Digital S.L.</strong>:</p><blockquote><p>Email: <span itemprop=\"email\">vitae(at)vitaedigital.com</span></p><p>Web: <span itemprop=\"web\"><a href=\"http://www.vitaedigital.com/\" target=\"_blank\" rel=\"noopener\">http://www.vitaedigital.com/</a></span></p></blockquote>","site":{"data":{}},"excerpt":"","more":"<div>Vivimos en la nube y nos relacionamos contigo en cualquier sitio desde <b>A Corua, Espaa.</b></div><p><div>Si quieres <b>visitarnos</b> ven a:</div><hr><div itemscope=\"\" itemtype=\"http://schema.org/LocalBusiness\"><h4><span itemprop=\"name\">gora Binaria S.L</span></h4><span itemprop=\"description\">Factora de software y academia de programadores.</span><p><div itemprop=\"address\" itemscope=\"\" itemtype=\"http://schema.org/PostalAddress\"><span itemprop=\"streetAddress\">Av. Primera C10. Edif Abanca Innova</span> CP:<span itemprop=\"postalCode\">15190</span><p><span itemprop=\"addressLocality\">A Corua</span>, <span itemprop=\"addressCountry\">Espaa</span></p></div>Telefno: <span itemprop=\"telephone\"><a href=\"tel:+34 609884782\" target=\"_blank\" rel=\"noopener\">+34 609884782</a></span></p><p>Email: <span itemprop=\"email\">info(at)agorabinaria.com</span></p></div><hr></p><p>Para temas comerciales de cursos presenciales con <strong>Vita Digital S.L.</strong>:</p><blockquote><p>Email: <span itemprop=\"email\">vitae(at)vitaedigital.com</span></p><p>Web: <span itemprop=\"web\"><a href=\"http://www.vitaedigital.com/\" target=\"_blank\" rel=\"noopener\">http://www.vitaedigital.com/</a></span></p></blockquote>"},{"title":"Cursos Online Avanzado de Angular","updated":"2019-04-24T12:07:39.000Z","date":"2019-03-20T09:07:39.000Z","_content":"\n[Implantacin de buenas prcticas en desarrollos empresariales con Angular.](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders)\n\n# Angular Business\n\n## 0 - Repositorios profesionales con Nx\n\n### 0.1 Nx y el CLI\n\n- Instalacin de Nx y CLI\n- Crear y configurar un workspace\n\n### 0.1 Estructura de un workspace\n\n- Apps\n- Libs\n\n### 0.2 Proyectos\n\n- Frontend webs\n- Backend Apis\n\n### 0.3 Libreras\n\n- 4.1 Libreras en TypeScript\n- 4.2 Libreras de Angular\n\n## 1 - Testing de aplicaciones\n\n### 1.1 Tipos de tests\n\n- Integracin o e2e\n- Unitarios\n\n### 1.2 Test de Integracin con Cypress\n\n- Cypress\n- Test e2e\n\n### 1.3 Test Unitarios con Jest\n\n- Jest\n- Test unitarios\n\n## 2 - Deteccin del cambio en Angular\n\n### 2.1 Estrategias de deteccin del cambio\n\n- Default\n- OnPush\n\n### 2.2 Tcnicas OnPush\n\n- DetectChanges\n- Async\n- Inmutable\n\n### 2.3 Optimizacin\n\n- OnPush es ms ligero\n- Async, CDR y clone detectan los cambios\n\n\n## 3 - Componentes dinmicos, directivas y pipes\n\n### 3.1 Plantillas de contenido dinmico\n\n- Un componente comn\n- Implementaciones distintas\n\n### 3.2 Atributos custom con Directivas\n\n- Generacin de directivas\n- Consumo de directivas\n\n### 3.2 Funciones de transformacin con Pipes\n\n- Generacin de pipes\n- Consumo de pipes\n\n\n## 4 - Redux con observables\n\n### 4.1 Arquitectura del patrn Redux\n\n- Principios de Redux\n- Elementos de Redux\n\n### 4.2 Implementacin de un Store con RxJs\n\n- El Store observable\n- El envo de acciones\n- La funcin reductora de estado\n- La seleccin de suscripciones\n\n## 5 - Redux con NgRx\n\n### 5.1 Instalacin y configuracin\n\n - Instalacin de NgRx\n - Registro y configuracin\n - Router y DevTools\n\n### 5.2 Actions\n\n - Create\n - Dispatch\n\n### 5.3 State reducer\n\n - State\n - Create function\n - Register in Store\n\n### 5.4 Selectors\n\n - Create selector\n - Selecting data\n - Fachadas\n\n### 5.5 Effects\n\n - Install\n - Efecto bsico\n - Api async effects\n - More Api async effects\n\n## 6 - Deploy Progressive Web Apps\n\n### 6.1 Angular Service Worker con el CLI\n\n - Instalacin\n - Modificaciones automticas\n - Paquetes recomendados\n\n### 6.2 Configuracin de cach\n\n - Assets\n - API\n\n### 6.3 Actualizaciones y notificaciones\n\n - Actualizacin de versiones\n - Notificaciones Push\n\n### 6.4 Shell\n\n - Una animacin para amenizar la carga\n\n> WIP\n\n## 7 - Server Side Rendering\n\n### 7.1 Angular Universal\n### 7.2 Despliegue con Node Express\n### 7.3 Variantes: shell y pre-rendering\n\n## 8 - Internacionalizacin y puesta en produccin\n\n### 8.1 Traducciones\n### 8.2 Adaptaciones culturales de tiempo y moneda\n### 8.3 Otras consideraciones para aplicaciones en produccin.\n\n## 9 - Web Components\n\n### 9.1 Desarrollo en Angular\n### 9.2 Consumo en cualquier framework\n\n[Mejora ya!](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/)\n\n[Contenido detallado Angular Basic](../cursos/angular-basic)\n","source":"Cursos/angular-business.md","raw":"---\ntitle: Cursos Online Avanzado de Angular\npermalink: cursos/angular-business\nupdated: '2019-04-24 14:07:39'\ndate: 2019-03-20 10:07:39\n---\n\n[Implantacin de buenas prcticas en desarrollos empresariales con Angular.](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders)\n\n# Angular Business\n\n## 0 - Repositorios profesionales con Nx\n\n### 0.1 Nx y el CLI\n\n- Instalacin de Nx y CLI\n- Crear y configurar un workspace\n\n### 0.1 Estructura de un workspace\n\n- Apps\n- Libs\n\n### 0.2 Proyectos\n\n- Frontend webs\n- Backend Apis\n\n### 0.3 Libreras\n\n- 4.1 Libreras en TypeScript\n- 4.2 Libreras de Angular\n\n## 1 - Testing de aplicaciones\n\n### 1.1 Tipos de tests\n\n- Integracin o e2e\n- Unitarios\n\n### 1.2 Test de Integracin con Cypress\n\n- Cypress\n- Test e2e\n\n### 1.3 Test Unitarios con Jest\n\n- Jest\n- Test unitarios\n\n## 2 - Deteccin del cambio en Angular\n\n### 2.1 Estrategias de deteccin del cambio\n\n- Default\n- OnPush\n\n### 2.2 Tcnicas OnPush\n\n- DetectChanges\n- Async\n- Inmutable\n\n### 2.3 Optimizacin\n\n- OnPush es ms ligero\n- Async, CDR y clone detectan los cambios\n\n\n## 3 - Componentes dinmicos, directivas y pipes\n\n### 3.1 Plantillas de contenido dinmico\n\n- Un componente comn\n- Implementaciones distintas\n\n### 3.2 Atributos custom con Directivas\n\n- Generacin de directivas\n- Consumo de directivas\n\n### 3.2 Funciones de transformacin con Pipes\n\n- Generacin de pipes\n- Consumo de pipes\n\n\n## 4 - Redux con observables\n\n### 4.1 Arquitectura del patrn Redux\n\n- Principios de Redux\n- Elementos de Redux\n\n### 4.2 Implementacin de un Store con RxJs\n\n- El Store observable\n- El envo de acciones\n- La funcin reductora de estado\n- La seleccin de suscripciones\n\n## 5 - Redux con NgRx\n\n### 5.1 Instalacin y configuracin\n\n - Instalacin de NgRx\n - Registro y configuracin\n - Router y DevTools\n\n### 5.2 Actions\n\n - Create\n - Dispatch\n\n### 5.3 State reducer\n\n - State\n - Create function\n - Register in Store\n\n### 5.4 Selectors\n\n - Create selector\n - Selecting data\n - Fachadas\n\n### 5.5 Effects\n\n - Install\n - Efecto bsico\n - Api async effects\n - More Api async effects\n\n## 6 - Deploy Progressive Web Apps\n\n### 6.1 Angular Service Worker con el CLI\n\n - Instalacin\n - Modificaciones automticas\n - Paquetes recomendados\n\n### 6.2 Configuracin de cach\n\n - Assets\n - API\n\n### 6.3 Actualizaciones y notificaciones\n\n - Actualizacin de versiones\n - Notificaciones Push\n\n### 6.4 Shell\n\n - Una animacin para amenizar la carga\n\n> WIP\n\n## 7 - Server Side Rendering\n\n### 7.1 Angular Universal\n### 7.2 Despliegue con Node Express\n### 7.3 Variantes: shell y pre-rendering\n\n## 8 - Internacionalizacin y puesta en produccin\n\n### 8.1 Traducciones\n### 8.2 Adaptaciones culturales de tiempo y moneda\n### 8.3 Otras consideraciones para aplicaciones en produccin.\n\n## 9 - Web Components\n\n### 9.1 Desarrollo en Angular\n### 9.2 Consumo en cualquier framework\n\n[Mejora ya!](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/)\n\n[Contenido detallado Angular Basic](../cursos/angular-basic)\n","path":"cursos/angular-business.html","comments":1,"layout":"page","_id":"ck70mab0u0009bss344dc2br8","content":"<p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Implantacin de buenas prcticas en desarrollos empresariales con Angular.</a></p><h1 id=\"Angular-Business\"><a href=\"#Angular-Business\" class=\"headerlink\" title=\"Angular Business\"></a>Angular Business</h1><h2 id=\"0-Repositorios-profesionales-con-Nx\"><a href=\"#0-Repositorios-profesionales-con-Nx\" class=\"headerlink\" title=\"0 - Repositorios profesionales con Nx\"></a>0 - Repositorios profesionales con Nx</h2><h3 id=\"0-1-Nx-y-el-CLI\"><a href=\"#0-1-Nx-y-el-CLI\" class=\"headerlink\" title=\"0.1 Nx y el CLI\"></a>0.1 Nx y el CLI</h3><ul><li>Instalacin de Nx y CLI</li><li>Crear y configurar un workspace</li></ul><h3 id=\"0-1-Estructura-de-un-workspace\"><a href=\"#0-1-Estructura-de-un-workspace\" class=\"headerlink\" title=\"0.1 Estructura de un workspace\"></a>0.1 Estructura de un workspace</h3><ul><li>Apps</li><li>Libs</li></ul><h3 id=\"0-2-Proyectos\"><a href=\"#0-2-Proyectos\" class=\"headerlink\" title=\"0.2 Proyectos\"></a>0.2 Proyectos</h3><ul><li>Frontend webs</li><li>Backend Apis</li></ul><h3 id=\"0-3-Librerias\"><a href=\"#0-3-Librerias\" class=\"headerlink\" title=\"0.3 Libreras\"></a>0.3 Libreras</h3><ul><li>4.1 Libreras en TypeScript</li><li>4.2 Libreras de Angular</li></ul><h2 id=\"1-Testing-de-aplicaciones\"><a href=\"#1-Testing-de-aplicaciones\" class=\"headerlink\" title=\"1 - Testing de aplicaciones\"></a>1 - Testing de aplicaciones</h2><h3 id=\"1-1-Tipos-de-tests\"><a href=\"#1-1-Tipos-de-tests\" class=\"headerlink\" title=\"1.1 Tipos de tests\"></a>1.1 Tipos de tests</h3><ul><li>Integracin o e2e</li><li>Unitarios</li></ul><h3 id=\"1-2-Test-de-Integracion-con-Cypress\"><a href=\"#1-2-Test-de-Integracion-con-Cypress\" class=\"headerlink\" title=\"1.2 Test de Integracin con Cypress\"></a>1.2 Test de Integracin con Cypress</h3><ul><li>Cypress</li><li>Test e2e</li></ul><h3 id=\"1-3-Test-Unitarios-con-Jest\"><a href=\"#1-3-Test-Unitarios-con-Jest\" class=\"headerlink\" title=\"1.3 Test Unitarios con Jest\"></a>1.3 Test Unitarios con Jest</h3><ul><li>Jest</li><li>Test unitarios</li></ul><h2 id=\"2-Deteccion-del-cambio-en-Angular\"><a href=\"#2-Deteccion-del-cambio-en-Angular\" class=\"headerlink\" title=\"2 - Deteccin del cambio en Angular\"></a>2 - Deteccin del cambio en Angular</h2><h3 id=\"2-1-Estrategias-de-deteccion-del-cambio\"><a href=\"#2-1-Estrategias-de-deteccion-del-cambio\" class=\"headerlink\" title=\"2.1 Estrategias de deteccin del cambio\"></a>2.1 Estrategias de deteccin del cambio</h3><ul><li>Default</li><li>OnPush</li></ul><h3 id=\"2-2-Tecnicas-OnPush\"><a href=\"#2-2-Tecnicas-OnPush\" class=\"headerlink\" title=\"2.2 Tcnicas OnPush\"></a>2.2 Tcnicas OnPush</h3><ul><li>DetectChanges</li><li>Async</li><li>Inmutable</li></ul><h3 id=\"2-3-Optimizacion\"><a href=\"#2-3-Optimizacion\" class=\"headerlink\" title=\"2.3 Optimizacin\"></a>2.3 Optimizacin</h3><ul><li>OnPush es ms ligero</li><li>Async, CDR y clone detectan los cambios</li></ul><h2 id=\"3-Componentes-dinamicos-directivas-y-pipes\"><a href=\"#3-Componentes-dinamicos-directivas-y-pipes\" class=\"headerlink\" title=\"3 - Componentes dinmicos, directivas y pipes\"></a>3 - Componentes dinmicos, directivas y pipes</h2><h3 id=\"3-1-Plantillas-de-contenido-dinamico\"><a href=\"#3-1-Plantillas-de-contenido-dinamico\" class=\"headerlink\" title=\"3.1 Plantillas de contenido dinmico\"></a>3.1 Plantillas de contenido dinmico</h3><ul><li>Un componente comn</li><li>Implementaciones distintas</li></ul><h3 id=\"3-2-Atributos-custom-con-Directivas\"><a href=\"#3-2-Atributos-custom-con-Directivas\" class=\"headerlink\" title=\"3.2 Atributos custom con Directivas\"></a>3.2 Atributos custom con Directivas</h3><ul><li>Generacin de directivas</li><li>Consumo de directivas</li></ul><h3 id=\"3-2-Funciones-de-transformacion-con-Pipes\"><a href=\"#3-2-Funciones-de-transformacion-con-Pipes\" class=\"headerlink\" title=\"3.2 Funciones de transformacin con Pipes\"></a>3.2 Funciones de transformacin con Pipes</h3><ul><li>Generacin de pipes</li><li>Consumo de pipes</li></ul><h2 id=\"4-Redux-con-observables\"><a href=\"#4-Redux-con-observables\" class=\"headerlink\" title=\"4 - Redux con observables\"></a>4 - Redux con observables</h2><h3 id=\"4-1-Arquitectura-del-patron-Redux\"><a href=\"#4-1-Arquitectura-del-patron-Redux\" class=\"headerlink\" title=\"4.1 Arquitectura del patrn Redux\"></a>4.1 Arquitectura del patrn Redux</h3><ul><li>Principios de Redux</li><li>Elementos de Redux</li></ul><h3 id=\"4-2-Implementacion-de-un-Store-con-RxJs\"><a href=\"#4-2-Implementacion-de-un-Store-con-RxJs\" class=\"headerlink\" title=\"4.2 Implementacin de un Store con RxJs\"></a>4.2 Implementacin de un Store con RxJs</h3><ul><li>El Store observable</li><li>El envo de acciones</li><li>La funcin reductora de estado</li><li>La seleccin de suscripciones</li></ul><h2 id=\"5-Redux-con-NgRx\"><a href=\"#5-Redux-con-NgRx\" class=\"headerlink\" title=\"5 - Redux con NgRx\"></a>5 - Redux con NgRx</h2><h3 id=\"5-1-Instalacion-y-configuracion\"><a href=\"#5-1-Instalacion-y-configuracion\" class=\"headerlink\" title=\"5.1 Instalacin y configuracin\"></a>5.1 Instalacin y configuracin</h3><ul><li>Instalacin de NgRx</li><li>Registro y configuracin</li><li>Router y DevTools</li></ul><h3 id=\"5-2-Actions\"><a href=\"#5-2-Actions\" class=\"headerlink\" title=\"5.2 Actions\"></a>5.2 Actions</h3><ul><li>Create</li><li>Dispatch</li></ul><h3 id=\"5-3-State-reducer\"><a href=\"#5-3-State-reducer\" class=\"headerlink\" title=\"5.3 State reducer\"></a>5.3 State reducer</h3><ul><li>State</li><li>Create function</li><li>Register in Store</li></ul><h3 id=\"5-4-Selectors\"><a href=\"#5-4-Selectors\" class=\"headerlink\" title=\"5.4 Selectors\"></a>5.4 Selectors</h3><ul><li>Create selector</li><li>Selecting data</li><li>Fachadas</li></ul><h3 id=\"5-5-Effects\"><a href=\"#5-5-Effects\" class=\"headerlink\" title=\"5.5 Effects\"></a>5.5 Effects</h3><ul><li>Install</li><li>Efecto bsico</li><li>Api async effects</li><li>More Api async effects</li></ul><h2 id=\"6-Deploy-Progressive-Web-Apps\"><a href=\"#6-Deploy-Progressive-Web-Apps\" class=\"headerlink\" title=\"6 - Deploy Progressive Web Apps\"></a>6 - Deploy Progressive Web Apps</h2><h3 id=\"6-1-Angular-Service-Worker-con-el-CLI\"><a href=\"#6-1-Angular-Service-Worker-con-el-CLI\" class=\"headerlink\" title=\"6.1 Angular Service Worker con el CLI\"></a>6.1 Angular Service Worker con el CLI</h3><ul><li>Instalacin</li><li>Modificaciones automticas</li><li>Paquetes recomendados</li></ul><h3 id=\"6-2-Configuracion-de-cache\"><a href=\"#6-2-Configuracion-de-cache\" class=\"headerlink\" title=\"6.2 Configuracin de cach\"></a>6.2 Configuracin de cach</h3><ul><li>Assets</li><li>API</li></ul><h3 id=\"6-3-Actualizaciones-y-notificaciones\"><a href=\"#6-3-Actualizaciones-y-notificaciones\" class=\"headerlink\" title=\"6.3 Actualizaciones y notificaciones\"></a>6.3 Actualizaciones y notificaciones</h3><ul><li>Actualizacin de versiones</li><li>Notificaciones Push</li></ul><h3 id=\"6-4-Shell\"><a href=\"#6-4-Shell\" class=\"headerlink\" title=\"6.4 Shell\"></a>6.4 Shell</h3><ul><li>Una animacin para amenizar la carga</li></ul><blockquote><p>WIP</p></blockquote><h2 id=\"7-Server-Side-Rendering\"><a href=\"#7-Server-Side-Rendering\" class=\"headerlink\" title=\"7 - Server Side Rendering\"></a>7 - Server Side Rendering</h2><h3 id=\"7-1-Angular-Universal\"><a href=\"#7-1-Angular-Universal\" class=\"headerlink\" title=\"7.1 Angular Universal\"></a>7.1 Angular Universal</h3><h3 id=\"7-2-Despliegue-con-Node-Express\"><a href=\"#7-2-Despliegue-con-Node-Express\" class=\"headerlink\" title=\"7.2 Despliegue con Node Express\"></a>7.2 Despliegue con Node Express</h3><h3 id=\"7-3-Variantes-shell-y-pre-rendering\"><a href=\"#7-3-Variantes-shell-y-pre-rendering\" class=\"headerlink\" title=\"7.3 Variantes: shell y pre-rendering\"></a>7.3 Variantes: shell y pre-rendering</h3><h2 id=\"8-Internacionalizacion-y-puesta-en-produccion\"><a href=\"#8-Internacionalizacion-y-puesta-en-produccion\" class=\"headerlink\" title=\"8 - Internacionalizacin y puesta en produccin\"></a>8 - Internacionalizacin y puesta en produccin</h2><h3 id=\"8-1-Traducciones\"><a href=\"#8-1-Traducciones\" class=\"headerlink\" title=\"8.1 Traducciones\"></a>8.1 Traducciones</h3><h3 id=\"8-2-Adaptaciones-culturales-de-tiempo-y-moneda\"><a href=\"#8-2-Adaptaciones-culturales-de-tiempo-y-moneda\" class=\"headerlink\" title=\"8.2 Adaptaciones culturales de tiempo y moneda\"></a>8.2 Adaptaciones culturales de tiempo y moneda</h3><h3 id=\"8-3-Otras-consideraciones-para-aplicaciones-en-produccion\"><a href=\"#8-3-Otras-consideraciones-para-aplicaciones-en-produccion\" class=\"headerlink\" title=\"8.3 Otras consideraciones para aplicaciones en produccin.\"></a>8.3 Otras consideraciones para aplicaciones en produccin.</h3><h2 id=\"9-Web-Components\"><a href=\"#9-Web-Components\" class=\"headerlink\" title=\"9 - Web Components\"></a>9 - Web Components</h2><h3 id=\"9-1-Desarrollo-en-Angular\"><a href=\"#9-1-Desarrollo-en-Angular\" class=\"headerlink\" title=\"9.1 Desarrollo en Angular\"></a>9.1 Desarrollo en Angular</h3><h3 id=\"9-2-Consumo-en-cualquier-framework\"><a href=\"#9-2-Consumo-en-cualquier-framework\" class=\"headerlink\" title=\"9.2 Consumo en cualquier framework\"></a>9.2 Consumo en cualquier framework</h3><p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/\" target=\"_blank\" rel=\"noopener\">Mejora ya!</a></p><p><a href=\"../cursos/angular-basic\">Contenido detallado Angular Basic</a></p>","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Implantacin de buenas prcticas en desarrollos empresariales con Angular.</a></p><h1 id=\"Angular-Business\"><a href=\"#Angular-Business\" class=\"headerlink\" title=\"Angular Business\"></a>Angular Business</h1><h2 id=\"0-Repositorios-profesionales-con-Nx\"><a href=\"#0-Repositorios-profesionales-con-Nx\" class=\"headerlink\" title=\"0 - Repositorios profesionales con Nx\"></a>0 - Repositorios profesionales con Nx</h2><h3 id=\"0-1-Nx-y-el-CLI\"><a href=\"#0-1-Nx-y-el-CLI\" class=\"headerlink\" title=\"0.1 Nx y el CLI\"></a>0.1 Nx y el CLI</h3><ul><li>Instalacin de Nx y CLI</li><li>Crear y configurar un workspace</li></ul><h3 id=\"0-1-Estructura-de-un-workspace\"><a href=\"#0-1-Estructura-de-un-workspace\" class=\"headerlink\" title=\"0.1 Estructura de un workspace\"></a>0.1 Estructura de un workspace</h3><ul><li>Apps</li><li>Libs</li></ul><h3 id=\"0-2-Proyectos\"><a href=\"#0-2-Proyectos\" class=\"headerlink\" title=\"0.2 Proyectos\"></a>0.2 Proyectos</h3><ul><li>Frontend webs</li><li>Backend Apis</li></ul><h3 id=\"0-3-Librerias\"><a href=\"#0-3-Librerias\" class=\"headerlink\" title=\"0.3 Libreras\"></a>0.3 Libreras</h3><ul><li>4.1 Libreras en TypeScript</li><li>4.2 Libreras de Angular</li></ul><h2 id=\"1-Testing-de-aplicaciones\"><a href=\"#1-Testing-de-aplicaciones\" class=\"headerlink\" title=\"1 - Testing de aplicaciones\"></a>1 - Testing de aplicaciones</h2><h3 id=\"1-1-Tipos-de-tests\"><a href=\"#1-1-Tipos-de-tests\" class=\"headerlink\" title=\"1.1 Tipos de tests\"></a>1.1 Tipos de tests</h3><ul><li>Integracin o e2e</li><li>Unitarios</li></ul><h3 id=\"1-2-Test-de-Integracion-con-Cypress\"><a href=\"#1-2-Test-de-Integracion-con-Cypress\" class=\"headerlink\" title=\"1.2 Test de Integracin con Cypress\"></a>1.2 Test de Integracin con Cypress</h3><ul><li>Cypress</li><li>Test e2e</li></ul><h3 id=\"1-3-Test-Unitarios-con-Jest\"><a href=\"#1-3-Test-Unitarios-con-Jest\" class=\"headerlink\" title=\"1.3 Test Unitarios con Jest\"></a>1.3 Test Unitarios con Jest</h3><ul><li>Jest</li><li>Test unitarios</li></ul><h2 id=\"2-Deteccion-del-cambio-en-Angular\"><a href=\"#2-Deteccion-del-cambio-en-Angular\" class=\"headerlink\" title=\"2 - Deteccin del cambio en Angular\"></a>2 - Deteccin del cambio en Angular</h2><h3 id=\"2-1-Estrategias-de-deteccion-del-cambio\"><a href=\"#2-1-Estrategias-de-deteccion-del-cambio\" class=\"headerlink\" title=\"2.1 Estrategias de deteccin del cambio\"></a>2.1 Estrategias de deteccin del cambio</h3><ul><li>Default</li><li>OnPush</li></ul><h3 id=\"2-2-Tecnicas-OnPush\"><a href=\"#2-2-Tecnicas-OnPush\" class=\"headerlink\" title=\"2.2 Tcnicas OnPush\"></a>2.2 Tcnicas OnPush</h3><ul><li>DetectChanges</li><li>Async</li><li>Inmutable</li></ul><h3 id=\"2-3-Optimizacion\"><a href=\"#2-3-Optimizacion\" class=\"headerlink\" title=\"2.3 Optimizacin\"></a>2.3 Optimizacin</h3><ul><li>OnPush es ms ligero</li><li>Async, CDR y clone detectan los cambios</li></ul><h2 id=\"3-Componentes-dinamicos-directivas-y-pipes\"><a href=\"#3-Componentes-dinamicos-directivas-y-pipes\" class=\"headerlink\" title=\"3 - Componentes dinmicos, directivas y pipes\"></a>3 - Componentes dinmicos, directivas y pipes</h2><h3 id=\"3-1-Plantillas-de-contenido-dinamico\"><a href=\"#3-1-Plantillas-de-contenido-dinamico\" class=\"headerlink\" title=\"3.1 Plantillas de contenido dinmico\"></a>3.1 Plantillas de contenido dinmico</h3><ul><li>Un componente comn</li><li>Implementaciones distintas</li></ul><h3 id=\"3-2-Atributos-custom-con-Directivas\"><a href=\"#3-2-Atributos-custom-con-Directivas\" class=\"headerlink\" title=\"3.2 Atributos custom con Directivas\"></a>3.2 Atributos custom con Directivas</h3><ul><li>Generacin de directivas</li><li>Consumo de directivas</li></ul><h3 id=\"3-2-Funciones-de-transformacion-con-Pipes\"><a href=\"#3-2-Funciones-de-transformacion-con-Pipes\" class=\"headerlink\" title=\"3.2 Funciones de transformacin con Pipes\"></a>3.2 Funciones de transformacin con Pipes</h3><ul><li>Generacin de pipes</li><li>Consumo de pipes</li></ul><h2 id=\"4-Redux-con-observables\"><a href=\"#4-Redux-con-observables\" class=\"headerlink\" title=\"4 - Redux con observables\"></a>4 - Redux con observables</h2><h3 id=\"4-1-Arquitectura-del-patron-Redux\"><a href=\"#4-1-Arquitectura-del-patron-Redux\" class=\"headerlink\" title=\"4.1 Arquitectura del patrn Redux\"></a>4.1 Arquitectura del patrn Redux</h3><ul><li>Principios de Redux</li><li>Elementos de Redux</li></ul><h3 id=\"4-2-Implementacion-de-un-Store-con-RxJs\"><a href=\"#4-2-Implementacion-de-un-Store-con-RxJs\" class=\"headerlink\" title=\"4.2 Implementacin de un Store con RxJs\"></a>4.2 Implementacin de un Store con RxJs</h3><ul><li>El Store observable</li><li>El envo de acciones</li><li>La funcin reductora de estado</li><li>La seleccin de suscripciones</li></ul><h2 id=\"5-Redux-con-NgRx\"><a href=\"#5-Redux-con-NgRx\" class=\"headerlink\" title=\"5 - Redux con NgRx\"></a>5 - Redux con NgRx</h2><h3 id=\"5-1-Instalacion-y-configuracion\"><a href=\"#5-1-Instalacion-y-configuracion\" class=\"headerlink\" title=\"5.1 Instalacin y configuracin\"></a>5.1 Instalacin y configuracin</h3><ul><li>Instalacin de NgRx</li><li>Registro y configuracin</li><li>Router y DevTools</li></ul><h3 id=\"5-2-Actions\"><a href=\"#5-2-Actions\" class=\"headerlink\" title=\"5.2 Actions\"></a>5.2 Actions</h3><ul><li>Create</li><li>Dispatch</li></ul><h3 id=\"5-3-State-reducer\"><a href=\"#5-3-State-reducer\" class=\"headerlink\" title=\"5.3 State reducer\"></a>5.3 State reducer</h3><ul><li>State</li><li>Create function</li><li>Register in Store</li></ul><h3 id=\"5-4-Selectors\"><a href=\"#5-4-Selectors\" class=\"headerlink\" title=\"5.4 Selectors\"></a>5.4 Selectors</h3><ul><li>Create selector</li><li>Selecting data</li><li>Fachadas</li></ul><h3 id=\"5-5-Effects\"><a href=\"#5-5-Effects\" class=\"headerlink\" title=\"5.5 Effects\"></a>5.5 Effects</h3><ul><li>Install</li><li>Efecto bsico</li><li>Api async effects</li><li>More Api async effects</li></ul><h2 id=\"6-Deploy-Progressive-Web-Apps\"><a href=\"#6-Deploy-Progressive-Web-Apps\" class=\"headerlink\" title=\"6 - Deploy Progressive Web Apps\"></a>6 - Deploy Progressive Web Apps</h2><h3 id=\"6-1-Angular-Service-Worker-con-el-CLI\"><a href=\"#6-1-Angular-Service-Worker-con-el-CLI\" class=\"headerlink\" title=\"6.1 Angular Service Worker con el CLI\"></a>6.1 Angular Service Worker con el CLI</h3><ul><li>Instalacin</li><li>Modificaciones automticas</li><li>Paquetes recomendados</li></ul><h3 id=\"6-2-Configuracion-de-cache\"><a href=\"#6-2-Configuracion-de-cache\" class=\"headerlink\" title=\"6.2 Configuracin de cach\"></a>6.2 Configuracin de cach</h3><ul><li>Assets</li><li>API</li></ul><h3 id=\"6-3-Actualizaciones-y-notificaciones\"><a href=\"#6-3-Actualizaciones-y-notificaciones\" class=\"headerlink\" title=\"6.3 Actualizaciones y notificaciones\"></a>6.3 Actualizaciones y notificaciones</h3><ul><li>Actualizacin de versiones</li><li>Notificaciones Push</li></ul><h3 id=\"6-4-Shell\"><a href=\"#6-4-Shell\" class=\"headerlink\" title=\"6.4 Shell\"></a>6.4 Shell</h3><ul><li>Una animacin para amenizar la carga</li></ul><blockquote><p>WIP</p></blockquote><h2 id=\"7-Server-Side-Rendering\"><a href=\"#7-Server-Side-Rendering\" class=\"headerlink\" title=\"7 - Server Side Rendering\"></a>7 - Server Side Rendering</h2><h3 id=\"7-1-Angular-Universal\"><a href=\"#7-1-Angular-Universal\" class=\"headerlink\" title=\"7.1 Angular Universal\"></a>7.1 Angular Universal</h3><h3 id=\"7-2-Despliegue-con-Node-Express\"><a href=\"#7-2-Despliegue-con-Node-Express\" class=\"headerlink\" title=\"7.2 Despliegue con Node Express\"></a>7.2 Despliegue con Node Express</h3><h3 id=\"7-3-Variantes-shell-y-pre-rendering\"><a href=\"#7-3-Variantes-shell-y-pre-rendering\" class=\"headerlink\" title=\"7.3 Variantes: shell y pre-rendering\"></a>7.3 Variantes: shell y pre-rendering</h3><h2 id=\"8-Internacionalizacion-y-puesta-en-produccion\"><a href=\"#8-Internacionalizacion-y-puesta-en-produccion\" class=\"headerlink\" title=\"8 - Internacionalizacin y puesta en produccin\"></a>8 - Internacionalizacin y puesta en produccin</h2><h3 id=\"8-1-Traducciones\"><a href=\"#8-1-Traducciones\" class=\"headerlink\" title=\"8.1 Traducciones\"></a>8.1 Traducciones</h3><h3 id=\"8-2-Adaptaciones-culturales-de-tiempo-y-moneda\"><a href=\"#8-2-Adaptaciones-culturales-de-tiempo-y-moneda\" class=\"headerlink\" title=\"8.2 Adaptaciones culturales de tiempo y moneda\"></a>8.2 Adaptaciones culturales de tiempo y moneda</h3><h3 id=\"8-3-Otras-consideraciones-para-aplicaciones-en-produccion\"><a href=\"#8-3-Otras-consideraciones-para-aplicaciones-en-produccion\" class=\"headerlink\" title=\"8.3 Otras consideraciones para aplicaciones en produccin.\"></a>8.3 Otras consideraciones para aplicaciones en produccin.</h3><h2 id=\"9-Web-Components\"><a href=\"#9-Web-Components\" class=\"headerlink\" title=\"9 - Web Components\"></a>9 - Web Components</h2><h3 id=\"9-1-Desarrollo-en-Angular\"><a href=\"#9-1-Desarrollo-en-Angular\" class=\"headerlink\" title=\"9.1 Desarrollo en Angular\"></a>9.1 Desarrollo en Angular</h3><h3 id=\"9-2-Consumo-en-cualquier-framework\"><a href=\"#9-2-Consumo-en-cualquier-framework\" class=\"headerlink\" title=\"9.2 Consumo en cualquier framework\"></a>9.2 Consumo en cualquier framework</h3><p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/\" target=\"_blank\" rel=\"noopener\">Mejora ya!</a></p><p><a href=\"../cursos/angular-basic\">Contenido detallado Angular Basic</a></p>"},{"title":"Cursos Online de Angular","updated":"2019-03-20T09:07:39.000Z","date":"2019-03-20T09:07:39.000Z","_content":"\n[Angular Bsico, descuento de 25 euros](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders)\n[Angular Avanzado, descuento de 30 euros](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders)\n\n### [Contenido detallado Angular Basic](cursos/angular-basic)\n### [Contenido detallado Angular Business](cursos/angular-business)\n\n> Cursos con lecciones en video, chat de preguntas, tutoras y prcticas corregidas.\n> -- <cite>Te espero, Alberto Basalo</cite>\n\n# Angular Basic\n\n[Introduccin desde cero al desarrollo con Angular.](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders)\n\n#### 0 - Hola Angular CLI\n#### 1 - Base para una aplicacin Angular\n\n#### 2 - Pginas y rutas SPA\n#### 3 - Formularios, tablas y modelos de datos\n\n#### 4 - Flujo de datos entre componentes\n#### 5 - Servicios inyectables\n\n#### 6 - Comunicaciones http\n#### 7 - Vigilancia y seguridad\n\n#### 8 - Formularios reactivos\n#### 9 - Material Design y CLI\n\n[Empieza ya!](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders)\n[Contenido detallado Angular Basic](cursos/angular-basic)\n---\n\n# Angular Business\n\n[Implantacin de buenas prcticas en desarrollos empresariales con Angular.](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders)\n\n#### 0 - Repositorios profesionales con Nx\n#### 1 - Testing de aplicaciones con Cypress y Jest\n\n#### 2 - Deteccin del cambio en Angular\n#### 3 - Componentes dinmicos, directivas y pipes\n\n#### 4 - Redux con observables RxJs\n#### 5 - Redux con NgRx\n\n#### 6 - Deploy Progressive Web Apps\n#### 7 - Server Side Rendering\n\n#### 8 - Internacionalizacin y puesta en produccin\n#### 9 - Web Components\n\n[Mejora ya!](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/)\n[Contenido detallado Angular Business](cursos/angular-business)\n\n> Con diploma acreditativo, bolsa de trabajo y bonificables por Fundae.\n> -- <cite>Aprende online con Alberto Basalo</cite>\n\n[Angular Basic: Curso de introduccin desde cero al desarrollo con Angular.](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders)\n\n[Angular Business: Curso de implantacin de buenas prcticas en desarrollos empresariales con Angular.](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/)","source":"Cursos/index.md","raw":"---\ntitle: Cursos Online de Angular\npermalink: cursos\nupdated: '2019-03-20 10:07:39'\ndate: 2019-03-20 10:07:39\n---\n\n[Angular Bsico, descuento de 25 euros](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders)\n[Angular Avanzado, descuento de 30 euros](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders)\n\n### [Contenido detallado Angular Basic](cursos/angular-basic)\n### [Contenido detallado Angular Business](cursos/angular-business)\n\n> Cursos con lecciones en video, chat de preguntas, tutoras y prcticas corregidas.\n> -- <cite>Te espero, Alberto Basalo</cite>\n\n# Angular Basic\n\n[Introduccin desde cero al desarrollo con Angular.](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders)\n\n#### 0 - Hola Angular CLI\n#### 1 - Base para una aplicacin Angular\n\n#### 2 - Pginas y rutas SPA\n#### 3 - Formularios, tablas y modelos de datos\n\n#### 4 - Flujo de datos entre componentes\n#### 5 - Servicios inyectables\n\n#### 6 - Comunicaciones http\n#### 7 - Vigilancia y seguridad\n\n#### 8 - Formularios reactivos\n#### 9 - Material Design y CLI\n\n[Empieza ya!](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders)\n[Contenido detallado Angular Basic](cursos/angular-basic)\n---\n\n# Angular Business\n\n[Implantacin de buenas prcticas en desarrollos empresariales con Angular.](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders)\n\n#### 0 - Repositorios profesionales con Nx\n#### 1 - Testing de aplicaciones con Cypress y Jest\n\n#### 2 - Deteccin del cambio en Angular\n#### 3 - Componentes dinmicos, directivas y pipes\n\n#### 4 - Redux con observables RxJs\n#### 5 - Redux con NgRx\n\n#### 6 - Deploy Progressive Web Apps\n#### 7 - Server Side Rendering\n\n#### 8 - Internacionalizacin y puesta en produccin\n#### 9 - Web Components\n\n[Mejora ya!](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/)\n[Contenido detallado Angular Business](cursos/angular-business)\n\n> Con diploma acreditativo, bolsa de trabajo y bonificables por Fundae.\n> -- <cite>Aprende online con Alberto Basalo</cite>\n\n[Angular Basic: Curso de introduccin desde cero al desarrollo con Angular.](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders)\n\n[Angular Business: Curso de implantacin de buenas prcticas en desarrollos empresariales con Angular.](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/)","path":"cursos.html","comments":1,"layout":"page","_id":"ck70mab0x000bbss3qr3bsosn","content":"<p><a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Angular Bsico, descuento de 25 euros</a><br><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Angular Avanzado, descuento de 30 euros</a></p><h3 id=\"Contenido-detallado-Angular-Basic\"><a href=\"#Contenido-detallado-Angular-Basic\" class=\"headerlink\" title=\"Contenido detallado Angular Basic\"></a><a href=\"cursos/angular-basic\">Contenido detallado Angular Basic</a></h3><h3 id=\"Contenido-detallado-Angular-Business\"><a href=\"#Contenido-detallado-Angular-Business\" class=\"headerlink\" title=\"Contenido detallado Angular Business\"></a><a href=\"cursos/angular-business\">Contenido detallado Angular Business</a></h3><blockquote><p>Cursos con lecciones en video, chat de preguntas, tutoras y prcticas corregidas.<br> <cite>Te espero, Alberto Basalo</cite></p></blockquote><h1 id=\"Angular-Basic\"><a href=\"#Angular-Basic\" class=\"headerlink\" title=\"Angular Basic\"></a>Angular Basic</h1><p><a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Introduccin desde cero al desarrollo con Angular.</a></p><h4 id=\"0-Hola-Angular-CLI\"><a href=\"#0-Hola-Angular-CLI\" class=\"headerlink\" title=\"0 - Hola Angular CLI\"></a>0 - Hola Angular CLI</h4><h4 id=\"1-Base-para-una-aplicacion-Angular\"><a href=\"#1-Base-para-una-aplicacion-Angular\" class=\"headerlink\" title=\"1 - Base para una aplicacin Angular\"></a>1 - Base para una aplicacin Angular</h4><h4 id=\"2-Paginas-y-rutas-SPA\"><a href=\"#2-Paginas-y-rutas-SPA\" class=\"headerlink\" title=\"2 - Pginas y rutas SPA\"></a>2 - Pginas y rutas SPA</h4><h4 id=\"3-Formularios-tablas-y-modelos-de-datos\"><a href=\"#3-Formularios-tablas-y-modelos-de-datos\" class=\"headerlink\" title=\"3 - Formularios, tablas y modelos de datos\"></a>3 - Formularios, tablas y modelos de datos</h4><h4 id=\"4-Flujo-de-datos-entre-componentes\"><a href=\"#4-Flujo-de-datos-entre-componentes\" class=\"headerlink\" title=\"4 - Flujo de datos entre componentes\"></a>4 - Flujo de datos entre componentes</h4><h4 id=\"5-Servicios-inyectables\"><a href=\"#5-Servicios-inyectables\" class=\"headerlink\" title=\"5 - Servicios inyectables\"></a>5 - Servicios inyectables</h4><h4 id=\"6-Comunicaciones-http\"><a href=\"#6-Comunicaciones-http\" class=\"headerlink\" title=\"6 - Comunicaciones http\"></a>6 - Comunicaciones http</h4><h4 id=\"7-Vigilancia-y-seguridad\"><a href=\"#7-Vigilancia-y-seguridad\" class=\"headerlink\" title=\"7 - Vigilancia y seguridad\"></a>7 - Vigilancia y seguridad</h4><h4 id=\"8-Formularios-reactivos\"><a href=\"#8-Formularios-reactivos\" class=\"headerlink\" title=\"8 - Formularios reactivos\"></a>8 - Formularios reactivos</h4><h4 id=\"9-Material-Design-y-CLI\"><a href=\"#9-Material-Design-y-CLI\" class=\"headerlink\" title=\"9 - Material Design y CLI\"></a>9 - Material Design y CLI</h4><p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Empieza ya!</a><br><a href=\"cursos/angular-basic\">Contenido detallado Angular Basic</a></p><hr><h1 id=\"Angular-Business\"><a href=\"#Angular-Business\" class=\"headerlink\" title=\"Angular Business\"></a>Angular Business</h1><p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Implantacin de buenas prcticas en desarrollos empresariales con Angular.</a></p><h4 id=\"0-Repositorios-profesionales-con-Nx\"><a href=\"#0-Repositorios-profesionales-con-Nx\" class=\"headerlink\" title=\"0 - Repositorios profesionales con Nx\"></a>0 - Repositorios profesionales con Nx</h4><h4 id=\"1-Testing-de-aplicaciones-con-Cypress-y-Jest\"><a href=\"#1-Testing-de-aplicaciones-con-Cypress-y-Jest\" class=\"headerlink\" title=\"1 - Testing de aplicaciones con Cypress y Jest\"></a>1 - Testing de aplicaciones con Cypress y Jest</h4><h4 id=\"2-Deteccion-del-cambio-en-Angular\"><a href=\"#2-Deteccion-del-cambio-en-Angular\" class=\"headerlink\" title=\"2 - Deteccin del cambio en Angular\"></a>2 - Deteccin del cambio en Angular</h4><h4 id=\"3-Componentes-dinamicos-directivas-y-pipes\"><a href=\"#3-Componentes-dinamicos-directivas-y-pipes\" class=\"headerlink\" title=\"3 - Componentes dinmicos, directivas y pipes\"></a>3 - Componentes dinmicos, directivas y pipes</h4><h4 id=\"4-Redux-con-observables-RxJs\"><a href=\"#4-Redux-con-observables-RxJs\" class=\"headerlink\" title=\"4 - Redux con observables RxJs\"></a>4 - Redux con observables RxJs</h4><h4 id=\"5-Redux-con-NgRx\"><a href=\"#5-Redux-con-NgRx\" class=\"headerlink\" title=\"5 - Redux con NgRx\"></a>5 - Redux con NgRx</h4><h4 id=\"6-Deploy-Progressive-Web-Apps\"><a href=\"#6-Deploy-Progressive-Web-Apps\" class=\"headerlink\" title=\"6 - Deploy Progressive Web Apps\"></a>6 - Deploy Progressive Web Apps</h4><h4 id=\"7-Server-Side-Rendering\"><a href=\"#7-Server-Side-Rendering\" class=\"headerlink\" title=\"7 - Server Side Rendering\"></a>7 - Server Side Rendering</h4><h4 id=\"8-Internacionalizacion-y-puesta-en-produccion\"><a href=\"#8-Internacionalizacion-y-puesta-en-produccion\" class=\"headerlink\" title=\"8 - Internacionalizacin y puesta en produccin\"></a>8 - Internacionalizacin y puesta en produccin</h4><h4 id=\"9-Web-Components\"><a href=\"#9-Web-Components\" class=\"headerlink\" title=\"9 - Web Components\"></a>9 - Web Components</h4><p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/\" target=\"_blank\" rel=\"noopener\">Mejora ya!</a><br><a href=\"cursos/angular-business\">Contenido detallado Angular Business</a></p><blockquote><p>Con diploma acreditativo, bolsa de trabajo y bonificables por Fundae.<br> <cite>Aprende online con Alberto Basalo</cite></p></blockquote><p><a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Angular Basic: Curso de introduccin desde cero al desarrollo con Angular.</a></p><p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/\" target=\"_blank\" rel=\"noopener\">Angular Business: Curso de implantacin de buenas prcticas en desarrollos empresariales con Angular.</a></p>","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Angular Bsico, descuento de 25 euros</a><br><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Angular Avanzado, descuento de 30 euros</a></p><h3 id=\"Contenido-detallado-Angular-Basic\"><a href=\"#Contenido-detallado-Angular-Basic\" class=\"headerlink\" title=\"Contenido detallado Angular Basic\"></a><a href=\"cursos/angular-basic\">Contenido detallado Angular Basic</a></h3><h3 id=\"Contenido-detallado-Angular-Business\"><a href=\"#Contenido-detallado-Angular-Business\" class=\"headerlink\" title=\"Contenido detallado Angular Business\"></a><a href=\"cursos/angular-business\">Contenido detallado Angular Business</a></h3><blockquote><p>Cursos con lecciones en video, chat de preguntas, tutoras y prcticas corregidas.<br> <cite>Te espero, Alberto Basalo</cite></p></blockquote><h1 id=\"Angular-Basic\"><a href=\"#Angular-Basic\" class=\"headerlink\" title=\"Angular Basic\"></a>Angular Basic</h1><p><a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Introduccin desde cero al desarrollo con Angular.</a></p><h4 id=\"0-Hola-Angular-CLI\"><a href=\"#0-Hola-Angular-CLI\" class=\"headerlink\" title=\"0 - Hola Angular CLI\"></a>0 - Hola Angular CLI</h4><h4 id=\"1-Base-para-una-aplicacion-Angular\"><a href=\"#1-Base-para-una-aplicacion-Angular\" class=\"headerlink\" title=\"1 - Base para una aplicacin Angular\"></a>1 - Base para una aplicacin Angular</h4><h4 id=\"2-Paginas-y-rutas-SPA\"><a href=\"#2-Paginas-y-rutas-SPA\" class=\"headerlink\" title=\"2 - Pginas y rutas SPA\"></a>2 - Pginas y rutas SPA</h4><h4 id=\"3-Formularios-tablas-y-modelos-de-datos\"><a href=\"#3-Formularios-tablas-y-modelos-de-datos\" class=\"headerlink\" title=\"3 - Formularios, tablas y modelos de datos\"></a>3 - Formularios, tablas y modelos de datos</h4><h4 id=\"4-Flujo-de-datos-entre-componentes\"><a href=\"#4-Flujo-de-datos-entre-componentes\" class=\"headerlink\" title=\"4 - Flujo de datos entre componentes\"></a>4 - Flujo de datos entre componentes</h4><h4 id=\"5-Servicios-inyectables\"><a href=\"#5-Servicios-inyectables\" class=\"headerlink\" title=\"5 - Servicios inyectables\"></a>5 - Servicios inyectables</h4><h4 id=\"6-Comunicaciones-http\"><a href=\"#6-Comunicaciones-http\" class=\"headerlink\" title=\"6 - Comunicaciones http\"></a>6 - Comunicaciones http</h4><h4 id=\"7-Vigilancia-y-seguridad\"><a href=\"#7-Vigilancia-y-seguridad\" class=\"headerlink\" title=\"7 - Vigilancia y seguridad\"></a>7 - Vigilancia y seguridad</h4><h4 id=\"8-Formularios-reactivos\"><a href=\"#8-Formularios-reactivos\" class=\"headerlink\" title=\"8 - Formularios reactivos\"></a>8 - Formularios reactivos</h4><h4 id=\"9-Material-Design-y-CLI\"><a href=\"#9-Material-Design-y-CLI\" class=\"headerlink\" title=\"9 - Material Design y CLI\"></a>9 - Material Design y CLI</h4><p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Empieza ya!</a><br><a href=\"cursos/angular-basic\">Contenido detallado Angular Basic</a></p><hr><h1 id=\"Angular-Business\"><a href=\"#Angular-Business\" class=\"headerlink\" title=\"Angular Business\"></a>Angular Business</h1><p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Implantacin de buenas prcticas en desarrollos empresariales con Angular.</a></p><h4 id=\"0-Repositorios-profesionales-con-Nx\"><a href=\"#0-Repositorios-profesionales-con-Nx\" class=\"headerlink\" title=\"0 - Repositorios profesionales con Nx\"></a>0 - Repositorios profesionales con Nx</h4><h4 id=\"1-Testing-de-aplicaciones-con-Cypress-y-Jest\"><a href=\"#1-Testing-de-aplicaciones-con-Cypress-y-Jest\" class=\"headerlink\" title=\"1 - Testing de aplicaciones con Cypress y Jest\"></a>1 - Testing de aplicaciones con Cypress y Jest</h4><h4 id=\"2-Deteccion-del-cambio-en-Angular\"><a href=\"#2-Deteccion-del-cambio-en-Angular\" class=\"headerlink\" title=\"2 - Deteccin del cambio en Angular\"></a>2 - Deteccin del cambio en Angular</h4><h4 id=\"3-Componentes-dinamicos-directivas-y-pipes\"><a href=\"#3-Componentes-dinamicos-directivas-y-pipes\" class=\"headerlink\" title=\"3 - Componentes dinmicos, directivas y pipes\"></a>3 - Componentes dinmicos, directivas y pipes</h4><h4 id=\"4-Redux-con-observables-RxJs\"><a href=\"#4-Redux-con-observables-RxJs\" class=\"headerlink\" title=\"4 - Redux con observables RxJs\"></a>4 - Redux con observables RxJs</h4><h4 id=\"5-Redux-con-NgRx\"><a href=\"#5-Redux-con-NgRx\" class=\"headerlink\" title=\"5 - Redux con NgRx\"></a>5 - Redux con NgRx</h4><h4 id=\"6-Deploy-Progressive-Web-Apps\"><a href=\"#6-Deploy-Progressive-Web-Apps\" class=\"headerlink\" title=\"6 - Deploy Progressive Web Apps\"></a>6 - Deploy Progressive Web Apps</h4><h4 id=\"7-Server-Side-Rendering\"><a href=\"#7-Server-Side-Rendering\" class=\"headerlink\" title=\"7 - Server Side Rendering\"></a>7 - Server Side Rendering</h4><h4 id=\"8-Internacionalizacion-y-puesta-en-produccion\"><a href=\"#8-Internacionalizacion-y-puesta-en-produccion\" class=\"headerlink\" title=\"8 - Internacionalizacin y puesta en produccin\"></a>8 - Internacionalizacin y puesta en produccin</h4><h4 id=\"9-Web-Components\"><a href=\"#9-Web-Components\" class=\"headerlink\" title=\"9 - Web Components\"></a>9 - Web Components</h4><p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/\" target=\"_blank\" rel=\"noopener\">Mejora ya!</a><br><a href=\"cursos/angular-business\">Contenido detallado Angular Business</a></p><blockquote><p>Con diploma acreditativo, bolsa de trabajo y bonificables por Fundae.<br> <cite>Aprende online con Alberto Basalo</cite></p></blockquote><p><a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">Angular Basic: Curso de introduccin desde cero al desarrollo con Angular.</a></p><p><a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders/\" target=\"_blank\" rel=\"noopener\">Angular Business: Curso de implantacin de buenas prcticas en desarrollos empresariales con Angular.</a></p>"},{"title":"Noticias Junio 2016","id":16,"updated":"2016-06-06T12:28:19.000Z","date":"2016-06-03T08:44:51.000Z","_content":"\n##06-06-16\n\n\n###Angular 2 R.C.: La evolucin de la plataforma.\nAngularJS ha sufrido una metamorfosis. Mantiene el nombre a duras penas. Ahora ya ni le pone el sufijo ...JS. Pero la esperada versin [Angular2](http://angular.io) lo cambia todo. Cambia el lenguaje, cambia la filosofa y cambia la sintaxis.\n\nTodo este cambio es necesario para competir en el ecosistema JavaScript. Continuamente aparecen y desaparecen libreras. Para sobrevivir fue necesario renacer. Ahora [es una plataforma](/angular2-primeras-impresiones/) mucho ms cercana al mundo empresarial. \n\nUsa esta [serie de artculos sobre Angular2](/tag/angular2/) como tutorial para adaptarte a esta evolucin.\n \n###Enlaces para aprender\n####[AngularJS] : [Mejorar el Rendimiento en una lnea.]()\nParece un eslogan de gancho fcil, pero funciona. La clave es la informacin de depuracin que se genera de manera automtica. Al eliminarla se reduce el peso y se mejora la velocidad.\n \n####[JavaScript] : [La fatiga de frameworks comparada.]()\nEmpiezo por la consabida broma de pedir una moratoria en el desarrollo de armas... digo de frameworks JavaScript . Mientras tanto mira esta tabla que compara la sintaxis de libreras muy populares.\n \n####[NodeJS] : [Monitorizar aplicaciones bien y fcil.]()\nSi no sabes lo que hace tu aplicacin ests perdido. Lo primero que necesitas es una estrategia para generar logs. En Node tienes muchas opciones. Adems del console.log(' ;-) ').\n \n####[MongoDB] : [Rendimiento y Monitorizacin de MongoDB.]()\nAhora le toca a la base de datos. No es fcil entender ni usar correctamente la enorme cantidad de mtricas que ofrece MongoDB. Pero es fundamental conocer y aplicar algunas para controlar y escalar  las instalciones.\n \n####[CleanCode] : [Escribe cdigo pensando en mantenerlo.]()\nEscribimos una vez pero revisamos 20. Nosotros, nuestros compaeros y nuestros herederos. Unos cuantos consejos y buenas prcticas te ayudarn a tratar con lo heredado y a dejar mejores herencias.\n \n###Prximas actividades\nEste es el mes de Angular2. Su estreno como Release Candidate permite ofrecer [formacin con garantas](/promociones). Nos vemos.\n\n \n>*Keep coding, keep learning.*","source":"Noticias-Junio-2016/index.md","raw":"---\ntitle: Noticias Junio 2016\npermalink: noticias-junio-16\nid: 16\nupdated: '2016-06-06 14:28:19'\ndate: 2016-06-03 10:44:51\n---\n\n##06-06-16\n\n\n###Angular 2 R.C.: La evolucin de la plataforma.\nAngularJS ha sufrido una metamorfosis. Mantiene el nombre a duras penas. Ahora ya ni le pone el sufijo ...JS. Pero la esperada versin [Angular2](http://angular.io) lo cambia todo. Cambia el lenguaje, cambia la filosofa y cambia la sintaxis.\n\nTodo este cambio es necesario para competir en el ecosistema JavaScript. Continuamente aparecen y desaparecen libreras. Para sobrevivir fue necesario renacer. Ahora [es una plataforma](/angular2-primeras-impresiones/) mucho ms cercana al mundo empresarial. \n\nUsa esta [serie de artculos sobre Angular2](/tag/angular2/) como tutorial para adaptarte a esta evolucin.\n \n###Enlaces para aprender\n####[AngularJS] : [Mejorar el Rendimiento en una lnea.]()\nParece un eslogan de gancho fcil, pero funciona. La clave es la informacin de depuracin que se genera de manera automtica. Al eliminarla se reduce el peso y se mejora la velocidad.\n \n####[JavaScript] : [La fatiga de frameworks comparada.]()\nEmpiezo por la consabida broma de pedir una moratoria en el desarrollo de armas... digo de frameworks JavaScript . Mientras tanto mira esta tabla que compara la sintaxis de libreras muy populares.\n \n####[NodeJS] : [Monitorizar aplicaciones bien y fcil.]()\nSi no sabes lo que hace tu aplicacin ests perdido. Lo primero que necesitas es una estrategia para generar logs. En Node tienes muchas opciones. Adems del console.log(' ;-) ').\n \n####[MongoDB] : [Rendimiento y Monitorizacin de MongoDB.]()\nAhora le toca a la base de datos. No es fcil entender ni usar correctamente la enorme cantidad de mtricas que ofrece MongoDB. Pero es fundamental conocer y aplicar algunas para controlar y escalar  las instalciones.\n \n####[CleanCode] : [Escribe cdigo pensando en mantenerlo.]()\nEscribimos una vez pero revisamos 20. Nosotros, nuestros compaeros y nuestros herederos. Unos cuantos consejos y buenas prcticas te ayudarn a tratar con lo heredado y a dejar mejores herencias.\n \n###Prximas actividades\nEste es el mes de Angular2. Su estreno como Release Candidate permite ofrecer [formacin con garantas](/promociones). Nos vemos.\n\n \n>*Keep coding, keep learning.*","path":"noticias-junio-16.html","comments":1,"layout":"page","_id":"ck70mab12000dbss3v0sfooyv","content":"<p>##06-06-16</p><p>###Angular 2 R.C.: La evolucin de la plataforma.<br>AngularJS ha sufrido una metamorfosis. Mantiene el nombre a duras penas. Ahora ya ni le pone el sufijo JS. Pero la esperada versin <a href=\"http://angular.io\" target=\"_blank\" rel=\"noopener\">Angular2</a> lo cambia todo. Cambia el lenguaje, cambia la filosofa y cambia la sintaxis.</p><p>Todo este cambio es necesario para competir en el ecosistema JavaScript. Continuamente aparecen y desaparecen libreras. Para sobrevivir fue necesario renacer. Ahora <a href=\"/angular2-primeras-impresiones/\">es una plataforma</a> mucho ms cercana al mundo empresarial.</p><p>Usa esta <a href=\"/tag/angular2/\">serie de artculos sobre Angular2</a> como tutorial para adaptarte a esta evolucin.</p><p>###Enlaces para aprender<br>####[AngularJS] : <a href=\"\">Mejorar el Rendimiento en una lnea.</a><br>Parece un eslogan de gancho fcil, pero funciona. La clave es la informacin de depuracin que se genera de manera automtica. Al eliminarla se reduce el peso y se mejora la velocidad.</p><p>####[JavaScript] : <a href=\"\">La fatiga de frameworks comparada.</a><br>Empiezo por la consabida broma de pedir una moratoria en el desarrollo de armas digo de frameworks JavaScript . Mientras tanto mira esta tabla que compara la sintaxis de libreras muy populares.</p><p>####[NodeJS] : <a href=\"\">Monitorizar aplicaciones bien y fcil.</a><br>Si no sabes lo que hace tu aplicacin ests perdido. Lo primero que necesitas es una estrategia para generar logs. En Node tienes muchas opciones. Adems del console.log( ;-) ).</p><p>####[MongoDB] : <a href=\"\">Rendimiento y Monitorizacin de MongoDB.</a><br>Ahora le toca a la base de datos. No es fcil entender ni usar correctamente la enorme cantidad de mtricas que ofrece MongoDB. Pero es fundamental conocer y aplicar algunas para controlar y escalar las instalciones.</p><p>####[CleanCode] : <a href=\"\">Escribe cdigo pensando en mantenerlo.</a><br>Escribimos una vez pero revisamos 20. Nosotros, nuestros compaeros y nuestros herederos. Unos cuantos consejos y buenas prcticas te ayudarn a tratar con lo heredado y a dejar mejores herencias.</p><p>###Prximas actividades<br>Este es el mes de Angular2. Su estreno como Release Candidate permite ofrecer <a href=\"/promociones\">formacin con garantas</a>. Nos vemos.</p><blockquote><p><em>Keep coding, keep learning.</em></p></blockquote>","site":{"data":{}},"excerpt":"","more":"<p>##06-06-16</p><p>###Angular 2 R.C.: La evolucin de la plataforma.<br>AngularJS ha sufrido una metamorfosis. Mantiene el nombre a duras penas. Ahora ya ni le pone el sufijo JS. Pero la esperada versin <a href=\"http://angular.io\" target=\"_blank\" rel=\"noopener\">Angular2</a> lo cambia todo. Cambia el lenguaje, cambia la filosofa y cambia la sintaxis.</p><p>Todo este cambio es necesario para competir en el ecosistema JavaScript. Continuamente aparecen y desaparecen libreras. Para sobrevivir fue necesario renacer. Ahora <a href=\"/angular2-primeras-impresiones/\">es una plataforma</a> mucho ms cercana al mundo empresarial.</p><p>Usa esta <a href=\"/tag/angular2/\">serie de artculos sobre Angular2</a> como tutorial para adaptarte a esta evolucin.</p><p>###Enlaces para aprender<br>####[AngularJS] : <a href=\"\">Mejorar el Rendimiento en una lnea.</a><br>Parece un eslogan de gancho fcil, pero funciona. La clave es la informacin de depuracin que se genera de manera automtica. Al eliminarla se reduce el peso y se mejora la velocidad.</p><p>####[JavaScript] : <a href=\"\">La fatiga de frameworks comparada.</a><br>Empiezo por la consabida broma de pedir una moratoria en el desarrollo de armas digo de frameworks JavaScript . Mientras tanto mira esta tabla que compara la sintaxis de libreras muy populares.</p><p>####[NodeJS] : <a href=\"\">Monitorizar aplicaciones bien y fcil.</a><br>Si no sabes lo que hace tu aplicacin ests perdido. Lo primero que necesitas es una estrategia para generar logs. En Node tienes muchas opciones. Adems del console.log( ;-) ).</p><p>####[MongoDB] : <a href=\"\">Rendimiento y Monitorizacin de MongoDB.</a><br>Ahora le toca a la base de datos. No es fcil entender ni usar correctamente la enorme cantidad de mtricas que ofrece MongoDB. Pero es fundamental conocer y aplicar algunas para controlar y escalar las instalciones.</p><p>####[CleanCode] : <a href=\"\">Escribe cdigo pensando en mantenerlo.</a><br>Escribimos una vez pero revisamos 20. Nosotros, nuestros compaeros y nuestros herederos. Unos cuantos consejos y buenas prcticas te ayudarn a tratar con lo heredado y a dejar mejores herencias.</p><p>###Prximas actividades<br>Este es el mes de Angular2. Su estreno como Release Candidate permite ofrecer <a href=\"/promociones\">formacin con garantas</a>. Nos vemos.</p><blockquote><p><em>Keep coding, keep learning.</em></p></blockquote>"},{"title":"Promociones","id":25,"updated":"2016-05-27T06:46:03.000Z","date":"2016-05-10T11:53:10.000Z","_content":"\n#Cursos de Angular2\n\n---\n\n####Online\n\nInicio 9 de junio de 2016\n\n###[Angular 2, desarrollo de aplicaciones empresariales con HTML](http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/)\n\nCon EscuelaIT\n\n\n---\n\n####Presencial en Corua\n\nInicio 10 de junio de 2016\n\n###[A Corua : Curso en Abierto de Angular2, TypeScript y Estrategias de Migracin de versiones 1.x](http://vitaedigital.com/ofertas-formacion/#a-coruna-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x)\n\nCon Vitae Digital","source":"Promociones/index.md","raw":"---\ntitle: Promociones\npermalink: promociones\nid: 25\nupdated: '2016-05-27 08:46:03'\ndate: 2016-05-10 13:53:10\n---\n\n#Cursos de Angular2\n\n---\n\n####Online\n\nInicio 9 de junio de 2016\n\n###[Angular 2, desarrollo de aplicaciones empresariales con HTML](http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/)\n\nCon EscuelaIT\n\n\n---\n\n####Presencial en Corua\n\nInicio 10 de junio de 2016\n\n###[A Corua : Curso en Abierto de Angular2, TypeScript y Estrategias de Migracin de versiones 1.x](http://vitaedigital.com/ofertas-formacion/#a-coruna-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x)\n\nCon Vitae Digital","path":"promociones.html","comments":1,"layout":"page","_id":"ck70mab14000fbss3yqti2l5n","content":"<p>#Cursos de Angular2</p><hr><p>####Online</p><p>Inicio 9 de junio de 2016</p><p>###<a href=\"http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/\" target=\"_blank\" rel=\"noopener\">Angular 2, desarrollo de aplicaciones empresariales con HTML</a></p><p>Con EscuelaIT</p><hr><p>####Presencial en Corua</p><p>Inicio 10 de junio de 2016</p><p>###<a href=\"http://vitaedigital.com/ofertas-formacion/#a-coruna-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x\" target=\"_blank\" rel=\"noopener\">A Corua : Curso en Abierto de Angular2, TypeScript y Estrategias de Migracin de versiones 1.x</a></p><p>Con Vitae Digital</p>","site":{"data":{}},"excerpt":"","more":"<p>#Cursos de Angular2</p><hr><p>####Online</p><p>Inicio 9 de junio de 2016</p><p>###<a href=\"http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/\" target=\"_blank\" rel=\"noopener\">Angular 2, desarrollo de aplicaciones empresariales con HTML</a></p><p>Con EscuelaIT</p><hr><p>####Presencial en Corua</p><p>Inicio 10 de junio de 2016</p><p>###<a href=\"http://vitaedigital.com/ofertas-formacion/#a-coruna-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x\" target=\"_blank\" rel=\"noopener\">A Corua : Curso en Abierto de Angular2, TypeScript y Estrategias de Migracin de versiones 1.x</a></p><p>Con Vitae Digital</p>"},{"title":"[object Object]","tags":null,"_content":"","source":"scaffolds/draft.md","raw":"---\ntitle: {{ title }}\ntags:\n---\n","date":"2018-05-03T08:56:05.855Z","updated":"2018-05-03T08:56:05.855Z","path":"scaffolds/draft.html","comments":1,"layout":"page","_id":"ck70mab18000hbss3m7gyandv","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"[object Object]","date":"2018-05-03T08:56:05.871Z","tags":null,"_content":"","source":"scaffolds/post.md","raw":"---\ntitle: {{ title }}\ndate: {{ date }}\ntags:\n---\n","updated":"2018-05-03T08:56:05.871Z","path":"scaffolds/post.html","comments":1,"layout":"page","_id":"ck70mab1a000jbss3fgvv6zy1","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"[object Object]","date":"2018-05-03T08:56:05.871Z","_content":"","source":"scaffolds/page.md","raw":"---\ntitle: {{ title }}\ndate: {{ date }}\n---\n","updated":"2018-05-03T08:56:05.871Z","path":"scaffolds/page.html","comments":1,"layout":"page","_id":"ck70mab1d000lbss3isx0jb2z","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"Node 6.0.0 actualizacin con nvm","id":"11","updated":"2016-05-05T08:02:26.000Z","date":"2016-05-05T07:39:40.000Z","_content":"\nAcabamos de recibir la buena noticia de la versin 6 de **NodeJS**. En este caso con mejoras de rendimiento e incorporacin de sintaxis de **ES6**. Cmo obtener esta nueva versin?. Y sobretodo,  cmo manejar la convivencia de distintas versiones? La ayuda se llama [nvm](https://github.com/creationix/nvm)\n\nEstos son los pasos que has de seguir para instalar la herramienta.\n\nSe recomienda desinstalar las versiones de **node** y **npm** instaladas previamente. No es obligatorio.\n\n#### LINUX & OS X\n\n1- Comprobamos que tenemos instaladas las dependencias\n1.1 - Dependencias **Linux**\n```\nsudo apt-get update\nsudo apt-get install build-essential\n```\n\n1.2 -Dependencias **OSX** (herramientas de linea de comandos para XCode)\n```\nxcode-select --install\n```\n\n\n2- Descargamos y ejecutamos el script de instalacin\n\n```\ncurl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash\n```\n\n\n3- Comprobamos que est instalado **NVM**\n```\ncommand -v nvm\n```\n*debe devolver nvm*\n\n\n4- Instalamos la versin de Node que deseamos\n```\nnvm install 6.0.0\n```\n\n5- Elegimos la versin de Node instalada que deseamos usar\n\n```\nnvm use 6.0.0\n```\n\n#### WINDOWS\n\nPara **Windows** no existe una versin *nativa* de **nvm**, pero si hay dos opciones para gestionar las versiones de node instaladas.\n\n1- **nvm-windows**\n\thttps://github.com/coreybutler/nvm-windows\n\tEs un wrapper de npm para windows, el instalador se encuentra en la URL (https://github.com/coreybutler/nvm/releases).\n\nLos `comandos` para instalar y la versin de Node son los mismos que en Linux y OSX.\n\n2- **nodist**\nEs un gestor de versiones parecido a NVM solo para Windows\n\tLa URL del instalador (https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe).\n\tLos comandos se encuentran en la documentacin. (https://github.com/marcelklehr/nodist)","source":"_posts/Node-6-0-0-actualizacion-con-nvm.md","raw":"---\ntitle: Node 6.0.0 actualizacin con nvm\ntags:\n- NodeJS\n- Introduccin\npermalink: node-6-0-0-actualizacion-con-nvm\nid: 11\nupdated: '2016-05-05 10:02:26'\ndate: 2016-05-05 09:39:40\n---\n\nAcabamos de recibir la buena noticia de la versin 6 de **NodeJS**. En este caso con mejoras de rendimiento e incorporacin de sintaxis de **ES6**. Cmo obtener esta nueva versin?. Y sobretodo,  cmo manejar la convivencia de distintas versiones? La ayuda se llama [nvm](https://github.com/creationix/nvm)\n\nEstos son los pasos que has de seguir para instalar la herramienta.\n\nSe recomienda desinstalar las versiones de **node** y **npm** instaladas previamente. No es obligatorio.\n\n#### LINUX & OS X\n\n1- Comprobamos que tenemos instaladas las dependencias\n1.1 - Dependencias **Linux**\n```\nsudo apt-get update\nsudo apt-get install build-essential\n```\n\n1.2 -Dependencias **OSX** (herramientas de linea de comandos para XCode)\n```\nxcode-select --install\n```\n\n\n2- Descargamos y ejecutamos el script de instalacin\n\n```\ncurl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash\n```\n\n\n3- Comprobamos que est instalado **NVM**\n```\ncommand -v nvm\n```\n*debe devolver nvm*\n\n\n4- Instalamos la versin de Node que deseamos\n```\nnvm install 6.0.0\n```\n\n5- Elegimos la versin de Node instalada que deseamos usar\n\n```\nnvm use 6.0.0\n```\n\n#### WINDOWS\n\nPara **Windows** no existe una versin *nativa* de **nvm**, pero si hay dos opciones para gestionar las versiones de node instaladas.\n\n1- **nvm-windows**\n\thttps://github.com/coreybutler/nvm-windows\n\tEs un wrapper de npm para windows, el instalador se encuentra en la URL (https://github.com/coreybutler/nvm/releases).\n\nLos `comandos` para instalar y la versin de Node son los mismos que en Linux y OSX.\n\n2- **nodist**\nEs un gestor de versiones parecido a NVM solo para Windows\n\tLa URL del instalador (https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe).\n\tLos comandos se encuentran en la documentacin. (https://github.com/marcelklehr/nodist)","slug":"node-6-0-0-actualizacion-con-nvm","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab0l0004bss3uj0qleb4","content":"<p>Acabamos de recibir la buena noticia de la versin 6 de <strong>NodeJS</strong>. En este caso con mejoras de rendimiento e incorporacin de sintaxis de <strong>ES6</strong>. Cmo obtener esta nueva versin?. Y sobretodo, cmo manejar la convivencia de distintas versiones? La ayuda se llama <a href=\"https://github.com/creationix/nvm\" target=\"_blank\" rel=\"noopener\">nvm</a></p><p>Estos son los pasos que has de seguir para instalar la herramienta.</p><p>Se recomienda desinstalar las versiones de <strong>node</strong> y <strong>npm</strong> instaladas previamente. No es obligatorio.</p><h4 id=\"LINUX-amp-OS-X\"><a href=\"#LINUX-amp-OS-X\" class=\"headerlink\" title=\"LINUX &amp; OS X\"></a>LINUX &amp; OS X</h4><p>1- Comprobamos que tenemos instaladas las dependencias<br>1.1 - Dependencias <strong>Linux</strong></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install build-essential</span><br></pre></td></tr></table></figure><p>1.2 -Dependencias <strong>OSX</strong> (herramientas de linea de comandos para XCode)</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xcode-select --install</span><br></pre></td></tr></table></figure><p>2- Descargamos y ejecutamos el script de instalacin</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash</span><br></pre></td></tr></table></figure><p>3- Comprobamos que est instalado <strong>NVM</strong></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">command -v nvm</span><br></pre></td></tr></table></figure><p><em>debe devolver nvm</em></p><p>4- Instalamos la versin de Node que deseamos</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nvm install 6.0.0</span><br></pre></td></tr></table></figure><p>5- Elegimos la versin de Node instalada que deseamos usar</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nvm use 6.0.0</span><br></pre></td></tr></table></figure><h4 id=\"WINDOWS\"><a href=\"#WINDOWS\" class=\"headerlink\" title=\"WINDOWS\"></a>WINDOWS</h4><p>Para <strong>Windows</strong> no existe una versin <em>nativa</em> de <strong>nvm</strong>, pero si hay dos opciones para gestionar las versiones de node instaladas.</p><p>1- <strong>nvm-windows</strong><br><a href=\"https://github.com/coreybutler/nvm-windows\" target=\"_blank\" rel=\"noopener\">https://github.com/coreybutler/nvm-windows</a><br>Es un wrapper de npm para windows, el instalador se encuentra en la URL (<a href=\"https://github.com/coreybutler/nvm/releases\" target=\"_blank\" rel=\"noopener\">https://github.com/coreybutler/nvm/releases</a>).</p><p>Los <code>comandos</code> para instalar y la versin de Node son los mismos que en Linux y OSX.</p><p>2- <strong>nodist</strong><br>Es un gestor de versiones parecido a NVM solo para Windows<br>La URL del instalador (<a href=\"https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe\" target=\"_blank\" rel=\"noopener\">https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe</a>).<br>Los comandos se encuentran en la documentacin. (<a href=\"https://github.com/marcelklehr/nodist\" target=\"_blank\" rel=\"noopener\">https://github.com/marcelklehr/nodist</a>)</p>","site":{"data":{}},"excerpt":"","more":"<p>Acabamos de recibir la buena noticia de la versin 6 de <strong>NodeJS</strong>. En este caso con mejoras de rendimiento e incorporacin de sintaxis de <strong>ES6</strong>. Cmo obtener esta nueva versin?. Y sobretodo, cmo manejar la convivencia de distintas versiones? La ayuda se llama <a href=\"https://github.com/creationix/nvm\" target=\"_blank\" rel=\"noopener\">nvm</a></p><p>Estos son los pasos que has de seguir para instalar la herramienta.</p><p>Se recomienda desinstalar las versiones de <strong>node</strong> y <strong>npm</strong> instaladas previamente. No es obligatorio.</p><h4 id=\"LINUX-amp-OS-X\"><a href=\"#LINUX-amp-OS-X\" class=\"headerlink\" title=\"LINUX &amp; OS X\"></a>LINUX &amp; OS X</h4><p>1- Comprobamos que tenemos instaladas las dependencias<br>1.1 - Dependencias <strong>Linux</strong></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install build-essential</span><br></pre></td></tr></table></figure><p>1.2 -Dependencias <strong>OSX</strong> (herramientas de linea de comandos para XCode)</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xcode-select --install</span><br></pre></td></tr></table></figure><p>2- Descargamos y ejecutamos el script de instalacin</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash</span><br></pre></td></tr></table></figure><p>3- Comprobamos que est instalado <strong>NVM</strong></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">command -v nvm</span><br></pre></td></tr></table></figure><p><em>debe devolver nvm</em></p><p>4- Instalamos la versin de Node que deseamos</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nvm install 6.0.0</span><br></pre></td></tr></table></figure><p>5- Elegimos la versin de Node instalada que deseamos usar</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nvm use 6.0.0</span><br></pre></td></tr></table></figure><h4 id=\"WINDOWS\"><a href=\"#WINDOWS\" class=\"headerlink\" title=\"WINDOWS\"></a>WINDOWS</h4><p>Para <strong>Windows</strong> no existe una versin <em>nativa</em> de <strong>nvm</strong>, pero si hay dos opciones para gestionar las versiones de node instaladas.</p><p>1- <strong>nvm-windows</strong><br><a href=\"https://github.com/coreybutler/nvm-windows\" target=\"_blank\" rel=\"noopener\">https://github.com/coreybutler/nvm-windows</a><br>Es un wrapper de npm para windows, el instalador se encuentra en la URL (<a href=\"https://github.com/coreybutler/nvm/releases\" target=\"_blank\" rel=\"noopener\">https://github.com/coreybutler/nvm/releases</a>).</p><p>Los <code>comandos</code> para instalar y la versin de Node son los mismos que en Linux y OSX.</p><p>2- <strong>nodist</strong><br>Es un gestor de versiones parecido a NVM solo para Windows<br>La URL del instalador (<a href=\"https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe\" target=\"_blank\" rel=\"noopener\">https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe</a>).<br>Los comandos se encuentran en la documentacin. (<a href=\"https://github.com/marcelklehr/nodist\" target=\"_blank\" rel=\"noopener\">https://github.com/marcelklehr/nodist</a>)</p>"},{"title":"Para qu puedo usar NodeJS","id":"20","updated":"2015-08-20T12:53:50.000Z","date":"2015-08-20T12:28:01.000Z","_content":"\nNodeJS se ha hecho muy popular por dos razones relacionas: **potencia y escalabilidad.** Ambas derivadas de su modelo de *ejecucin asncrona no bloqueante*.\n\nSe basa en el lenguaje **JavaScript**: sencillo, verstil y ampliamente conocido. NodeJS complementa a JS con libreras de sistema que sacan un gran rendimiento a los ejecutables.\n\nEl uso ms inmediato de NodeJS est en la **programacin de servicios web**. Tanto en la creacin de APIs como sirviendo pginas tradicionales. Esto le ha valido que se le conozca como el *JavaScript del lado del servidor.*\n\nPero, ms all de la web destaca en entornos empresariales. Se puede utilizar para construir **aplicaciones de escritorio** con iniciativas como (NW)[] y (electron)[]. Tambin y sobre todo se usa para **scripts de administracin o monitorizacin** en departamentos IT. Pequeos proyectos aplicables a sistemas de ficheros, mquinas y servidores. Y una derivada de esto son los proyectos de ayuda al desarrollador que se integran en los *development workflows* de cada vez ms empresas de programacin en cualquier lenguaje.\n\nDada la capacidad de procesamiento asncrono es una herramienta ideal para generar sistemas que respondan en **tiempo real**. Y por su escasa demanda de *hardware* se usa tambin en proyectos de **Internet of Things**\n\nEn definitiva podemos decir que NodeJS y su ecosistema proponen un nuevo paradigma de desarrollo que eleva a JavaScript como lenguaje **de propsito general.**\n\n\n","source":"_posts/Para-que-puedo-usar-NodeJS.md","raw":"---\ntitle: Para qu puedo usar NodeJS\ntags:\n- NodeJS\n- Introduccin\npermalink: para-que-puedo-usar-nodejs\nid: 20\nupdated: '2015-08-20 14:53:50'\ndate: 2015-08-20 14:28:01\n---\n\nNodeJS se ha hecho muy popular por dos razones relacionas: **potencia y escalabilidad.** Ambas derivadas de su modelo de *ejecucin asncrona no bloqueante*.\n\nSe basa en el lenguaje **JavaScript**: sencillo, verstil y ampliamente conocido. NodeJS complementa a JS con libreras de sistema que sacan un gran rendimiento a los ejecutables.\n\nEl uso ms inmediato de NodeJS est en la **programacin de servicios web**. Tanto en la creacin de APIs como sirviendo pginas tradicionales. Esto le ha valido que se le conozca como el *JavaScript del lado del servidor.*\n\nPero, ms all de la web destaca en entornos empresariales. Se puede utilizar para construir **aplicaciones de escritorio** con iniciativas como (NW)[] y (electron)[]. Tambin y sobre todo se usa para **scripts de administracin o monitorizacin** en departamentos IT. Pequeos proyectos aplicables a sistemas de ficheros, mquinas y servidores. Y una derivada de esto son los proyectos de ayuda al desarrollador que se integran en los *development workflows* de cada vez ms empresas de programacin en cualquier lenguaje.\n\nDada la capacidad de procesamiento asncrono es una herramienta ideal para generar sistemas que respondan en **tiempo real**. Y por su escasa demanda de *hardware* se usa tambin en proyectos de **Internet of Things**\n\nEn definitiva podemos decir que NodeJS y su ecosistema proponen un nuevo paradigma de desarrollo que eleva a JavaScript como lenguaje **de propsito general.**\n\n\n","slug":"para-que-puedo-usar-nodejs","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab0r0006bss3pjil4tff","content":"<p>NodeJS se ha hecho muy popular por dos razones relacionas: <strong>potencia y escalabilidad.</strong> Ambas derivadas de su modelo de <em>ejecucin asncrona no bloqueante</em>.</p><p>Se basa en el lenguaje <strong>JavaScript</strong>: sencillo, verstil y ampliamente conocido. NodeJS complementa a JS con libreras de sistema que sacan un gran rendimiento a los ejecutables.</p><p>El uso ms inmediato de NodeJS est en la <strong>programacin de servicios web</strong>. Tanto en la creacin de APIs como sirviendo pginas tradicionales. Esto le ha valido que se le conozca como el <em>JavaScript del lado del servidor.</em></p><p>Pero, ms all de la web destaca en entornos empresariales. Se puede utilizar para construir <strong>aplicaciones de escritorio</strong> con iniciativas como (NW)[] y (electron)[]. Tambin y sobre todo se usa para <strong>scripts de administracin o monitorizacin</strong> en departamentos IT. Pequeos proyectos aplicables a sistemas de ficheros, mquinas y servidores. Y una derivada de esto son los proyectos de ayuda al desarrollador que se integran en los <em>development workflows</em> de cada vez ms empresas de programacin en cualquier lenguaje.</p><p>Dada la capacidad de procesamiento asncrono es una herramienta ideal para generar sistemas que respondan en <strong>tiempo real</strong>. Y por su escasa demanda de <em>hardware</em> se usa tambin en proyectos de <strong>Internet of Things</strong></p><p>En definitiva podemos decir que NodeJS y su ecosistema proponen un nuevo paradigma de desarrollo que eleva a JavaScript como lenguaje <strong>de propsito general.</strong></p>","site":{"data":{}},"excerpt":"","more":"<p>NodeJS se ha hecho muy popular por dos razones relacionas: <strong>potencia y escalabilidad.</strong> Ambas derivadas de su modelo de <em>ejecucin asncrona no bloqueante</em>.</p><p>Se basa en el lenguaje <strong>JavaScript</strong>: sencillo, verstil y ampliamente conocido. NodeJS complementa a JS con libreras de sistema que sacan un gran rendimiento a los ejecutables.</p><p>El uso ms inmediato de NodeJS est en la <strong>programacin de servicios web</strong>. Tanto en la creacin de APIs como sirviendo pginas tradicionales. Esto le ha valido que se le conozca como el <em>JavaScript del lado del servidor.</em></p><p>Pero, ms all de la web destaca en entornos empresariales. Se puede utilizar para construir <strong>aplicaciones de escritorio</strong> con iniciativas como (NW)[] y (electron)[]. Tambin y sobre todo se usa para <strong>scripts de administracin o monitorizacin</strong> en departamentos IT. Pequeos proyectos aplicables a sistemas de ficheros, mquinas y servidores. Y una derivada de esto son los proyectos de ayuda al desarrollador que se integran en los <em>development workflows</em> de cada vez ms empresas de programacin en cualquier lenguaje.</p><p>Dada la capacidad de procesamiento asncrono es una herramienta ideal para generar sistemas que respondan en <strong>tiempo real</strong>. Y por su escasa demanda de <em>hardware</em> se usa tambin en proyectos de <strong>Internet of Things</strong></p><p>En definitiva podemos decir que NodeJS y su ecosistema proponen un nuevo paradigma de desarrollo que eleva a JavaScript como lenguaje <strong>de propsito general.</strong></p>"},{"title":"Soluciones BackEnd 2016","id":"8","updated":"2016-04-01T06:02:55.000Z","date":"2016-03-21T10:50:58.000Z","_content":"\nLas soluciones JavaScript para el servidor que marcan **tendencia en el desarrollo back end** durante este 2016. Continuacin de la saga que iniciamos con **[FrontEdge](http://academia-binaria.com/soluciones-frontend-2016/)**.\n\n* Mi apuesta de mercado sigue empezando por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido **[ES6](http://es6-features.org/#Constants)**. En el lado del servidor destaco la disponibilidad de [Promesas](http://es6-features.org/#PromiseUsage) de forma nativa..\n\n* Las aplicaciones crecen y se controlan por su API.As que este es el punto al que ms atencin debes prestarle. Por supuesto que *hay que cumplir con el estndar REST y hay que documentar* todo nuestro cdigo. Pero para ser ms productivo y mantener actualizado el sistema, te propongo que uses **[RAML](http://raml.org/)**. Un lenguaje para documentar APIs que con las herramientas adecuadas permite la generacin de pruebas, esqueletos de aplicaciones e infraestructura.\n\n* El ya viejo conocido **[NodeJS](https://nodejs.org/)** se ha modernizado y a partir de la versin 4, especialmente en la 5, admite la mayor parte de la sintaxis ES6. Adems ha mejorado su velocidad en un 25% gracias a la actualizacin del motor V8 que procesa internamente el JavaScript.\n\n* En la base de datos irrumpe con fuerza la nueva versin de **[MongoDB 3.2](https://docs.mongodb.org/manual/release-notes/3.2/)**, que incorpora grandes novedades como: sistema de almacenamiento ms rpido, ndices parciales, validacin de esquema y el esperado *join* entre colecciones .\n\nEn [esta presentacin](https://docs.google.com/presentation/d/12gdsjxUgsN58uzxF4XO38cP2QSH6IR5WjEZBLGfCgUY/edit?usp=sharing) tienes ms informacin acerca de lo que llamo **backEdge** : tecnologa utilizable, de ltima generacin y con enorme potencial.\n\nEn [este video](https://youtu.be/cfmJQjBfM-s) tienes la charla que di con o que llamo **Desarrollo Web** presentando las tendencias tecnolgicas del 2016.","source":"_posts/Soluciones-BackEnd-2016.md","raw":"---\ntitle: Soluciones BackEnd 2016\ntags:\n- BackEnd\n- NodeJS\n- MongoDB\n- Opinin\npermalink: soluciones-backend-2016\nid: 8\nupdated: '2016-04-01 08:02:55'\ndate: 2016-03-21 11:50:58\n---\n\nLas soluciones JavaScript para el servidor que marcan **tendencia en el desarrollo back end** durante este 2016. Continuacin de la saga que iniciamos con **[FrontEdge](http://academia-binaria.com/soluciones-frontend-2016/)**.\n\n* Mi apuesta de mercado sigue empezando por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido **[ES6](http://es6-features.org/#Constants)**. En el lado del servidor destaco la disponibilidad de [Promesas](http://es6-features.org/#PromiseUsage) de forma nativa..\n\n* Las aplicaciones crecen y se controlan por su API.As que este es el punto al que ms atencin debes prestarle. Por supuesto que *hay que cumplir con el estndar REST y hay que documentar* todo nuestro cdigo. Pero para ser ms productivo y mantener actualizado el sistema, te propongo que uses **[RAML](http://raml.org/)**. Un lenguaje para documentar APIs que con las herramientas adecuadas permite la generacin de pruebas, esqueletos de aplicaciones e infraestructura.\n\n* El ya viejo conocido **[NodeJS](https://nodejs.org/)** se ha modernizado y a partir de la versin 4, especialmente en la 5, admite la mayor parte de la sintaxis ES6. Adems ha mejorado su velocidad en un 25% gracias a la actualizacin del motor V8 que procesa internamente el JavaScript.\n\n* En la base de datos irrumpe con fuerza la nueva versin de **[MongoDB 3.2](https://docs.mongodb.org/manual/release-notes/3.2/)**, que incorpora grandes novedades como: sistema de almacenamiento ms rpido, ndices parciales, validacin de esquema y el esperado *join* entre colecciones .\n\nEn [esta presentacin](https://docs.google.com/presentation/d/12gdsjxUgsN58uzxF4XO38cP2QSH6IR5WjEZBLGfCgUY/edit?usp=sharing) tienes ms informacin acerca de lo que llamo **backEdge** : tecnologa utilizable, de ltima generacin y con enorme potencial.\n\nEn [este video](https://youtu.be/cfmJQjBfM-s) tienes la charla que di con o que llamo **Desarrollo Web** presentando las tendencias tecnolgicas del 2016.","slug":"soluciones-backend-2016","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab0s0008bss337ug1zzi","content":"<p>Las soluciones JavaScript para el servidor que marcan <strong>tendencia en el desarrollo back end</strong> durante este 2016. Continuacin de la saga que iniciamos con <strong><a href=\"http://academia-binaria.com/soluciones-frontend-2016/\">FrontEdge</a></strong>.</p><ul><li><p>Mi apuesta de mercado sigue empezando por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido <strong><a href=\"http://es6-features.org/#Constants\" target=\"_blank\" rel=\"noopener\">ES6</a></strong>. En el lado del servidor destaco la disponibilidad de <a href=\"http://es6-features.org/#PromiseUsage\" target=\"_blank\" rel=\"noopener\">Promesas</a> de forma nativa..</p></li><li><p>Las aplicaciones crecen y se controlan por su API.As que este es el punto al que ms atencin debes prestarle. Por supuesto que <em>hay que cumplir con el estndar REST y hay que documentar</em> todo nuestro cdigo. Pero para ser ms productivo y mantener actualizado el sistema, te propongo que uses <strong><a href=\"http://raml.org/\" target=\"_blank\" rel=\"noopener\">RAML</a></strong>. Un lenguaje para documentar APIs que con las herramientas adecuadas permite la generacin de pruebas, esqueletos de aplicaciones e infraestructura.</p></li><li><p>El ya viejo conocido <strong><a href=\"https://nodejs.org/\" target=\"_blank\" rel=\"noopener\">NodeJS</a></strong> se ha modernizado y a partir de la versin 4, especialmente en la 5, admite la mayor parte de la sintaxis ES6. Adems ha mejorado su velocidad en un 25% gracias a la actualizacin del motor V8 que procesa internamente el JavaScript.</p></li><li><p>En la base de datos irrumpe con fuerza la nueva versin de <strong><a href=\"https://docs.mongodb.org/manual/release-notes/3.2/\" target=\"_blank\" rel=\"noopener\">MongoDB 3.2</a></strong>, que incorpora grandes novedades como: sistema de almacenamiento ms rpido, ndices parciales, validacin de esquema y el esperado <em>join</em> entre colecciones .</p></li></ul><p>En <a href=\"https://docs.google.com/presentation/d/12gdsjxUgsN58uzxF4XO38cP2QSH6IR5WjEZBLGfCgUY/edit?usp=sharing\" target=\"_blank\" rel=\"noopener\">esta presentacin</a> tienes ms informacin acerca de lo que llamo <strong>backEdge</strong> : tecnologa utilizable, de ltima generacin y con enorme potencial.</p><p>En <a href=\"https://youtu.be/cfmJQjBfM-s\" target=\"_blank\" rel=\"noopener\">este video</a> tienes la charla que di con o que llamo <strong>Desarrollo Web</strong> presentando las tendencias tecnolgicas del 2016.</p>","site":{"data":{}},"excerpt":"","more":"<p>Las soluciones JavaScript para el servidor que marcan <strong>tendencia en el desarrollo back end</strong> durante este 2016. Continuacin de la saga que iniciamos con <strong><a href=\"http://academia-binaria.com/soluciones-frontend-2016/\">FrontEdge</a></strong>.</p><ul><li><p>Mi apuesta de mercado sigue empezando por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido <strong><a href=\"http://es6-features.org/#Constants\" target=\"_blank\" rel=\"noopener\">ES6</a></strong>. En el lado del servidor destaco la disponibilidad de <a href=\"http://es6-features.org/#PromiseUsage\" target=\"_blank\" rel=\"noopener\">Promesas</a> de forma nativa..</p></li><li><p>Las aplicaciones crecen y se controlan por su API.As que este es el punto al que ms atencin debes prestarle. Por supuesto que <em>hay que cumplir con el estndar REST y hay que documentar</em> todo nuestro cdigo. Pero para ser ms productivo y mantener actualizado el sistema, te propongo que uses <strong><a href=\"http://raml.org/\" target=\"_blank\" rel=\"noopener\">RAML</a></strong>. Un lenguaje para documentar APIs que con las herramientas adecuadas permite la generacin de pruebas, esqueletos de aplicaciones e infraestructura.</p></li><li><p>El ya viejo conocido <strong><a href=\"https://nodejs.org/\" target=\"_blank\" rel=\"noopener\">NodeJS</a></strong> se ha modernizado y a partir de la versin 4, especialmente en la 5, admite la mayor parte de la sintaxis ES6. Adems ha mejorado su velocidad en un 25% gracias a la actualizacin del motor V8 que procesa internamente el JavaScript.</p></li><li><p>En la base de datos irrumpe con fuerza la nueva versin de <strong><a href=\"https://docs.mongodb.org/manual/release-notes/3.2/\" target=\"_blank\" rel=\"noopener\">MongoDB 3.2</a></strong>, que incorpora grandes novedades como: sistema de almacenamiento ms rpido, ndices parciales, validacin de esquema y el esperado <em>join</em> entre colecciones .</p></li></ul><p>En <a href=\"https://docs.google.com/presentation/d/12gdsjxUgsN58uzxF4XO38cP2QSH6IR5WjEZBLGfCgUY/edit?usp=sharing\" target=\"_blank\" rel=\"noopener\">esta presentacin</a> tienes ms informacin acerca de lo que llamo <strong>backEdge</strong> : tecnologa utilizable, de ltima generacin y con enorme potencial.</p><p>En <a href=\"https://youtu.be/cfmJQjBfM-s\" target=\"_blank\" rel=\"noopener\">este video</a> tienes la charla que di con o que llamo <strong>Desarrollo Web</strong> presentando las tendencias tecnolgicas del 2016.</p>"},{"title":"Soluciones FrontEnd 2016","id":"7","updated":"2016-01-14T10:17:31.000Z","date":"2016-01-14T09:39:32.000Z","_content":"\nInicio el ao proponiendo una seleccin de tecnologas que sern **tendencia en el desarrollo front end** durante este 2016.\n\n* Mi apuesta de mercado empieza por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido **[ES6](http://es6-features.org/#Constants)**. Tras siete aos desde la anterior gran revisin, el xito y la popularidad de JS no poda esperar ms. Y tu tampoco debes esperar ms para conocerlo y usarlo.\n\n* Existe una creciente necesidad de dependencias externas en nuestra aplicaciones y sobre todo incorporar libreras provenientes de otros entornos y desarrolladas con variantes de JS. Para administrar todo ello propongo **[JSPM](http://jspm.io/)**, que se incorporar definitivamente a nuestro toolbox durante el 2016.\n\n* De entre las libreras y frameworks disponibles, AngularJS continuar siendo el rey. Este viejo conocido est creciendo en ya en grandes empresas, banca y administraciones pblicas. Mientras esperamos la gloriosa venida de la versin 2.0, tenemos la oportunidad de  adecuar nuestro estilo de programacin y desarrollar de manera mas limpia con la versin puente **[AngularJS1.5](https://www.angularjs.org/)**\n\n* En la parte visual, el look & feel propuesto por Google con Material Design es un xito de aceptacin para el desarrollo de aplicaciones empresariales. La librera **[AngularMaterial](https://material.angularjs.org/latest/)** es una implementacin para Angular de dicha especificacin grfica. Moderno y con enorme potencial.\n\nEn [esta presentacin](https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing) tienes ms informacin acerca de lo que llamo **frontEdge** : tecnologa utilizable, de ltima generacin y con enorme potencial.\n\n[Presentacin frontEdge](https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing)\n\nSi tienes tiempo, mira [este vdeo](https://www.youtube.com/watch?v=vJZb_rs2vvU) con una charla en la que comentamos estas y otras tecnologas para programadores.\n\n[video frontEdge](https://www.youtube.com/watch?v=vJZb_rs2vvU)","source":"_posts/Soluciones-FrontEnd-2016.md","raw":"---\ntitle: Soluciones FrontEnd 2016\ntags:\n- FrontEnd\n- AngularJS\n- Opinin\npermalink: soluciones-frontend-2016\nid: 7\nupdated: '2016-01-14 11:17:31'\ndate: 2016-01-14 10:39:32\n---\n\nInicio el ao proponiendo una seleccin de tecnologas que sern **tendencia en el desarrollo front end** durante este 2016.\n\n* Mi apuesta de mercado empieza por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido **[ES6](http://es6-features.org/#Constants)**. Tras siete aos desde la anterior gran revisin, el xito y la popularidad de JS no poda esperar ms. Y tu tampoco debes esperar ms para conocerlo y usarlo.\n\n* Existe una creciente necesidad de dependencias externas en nuestra aplicaciones y sobre todo incorporar libreras provenientes de otros entornos y desarrolladas con variantes de JS. Para administrar todo ello propongo **[JSPM](http://jspm.io/)**, que se incorporar definitivamente a nuestro toolbox durante el 2016.\n\n* De entre las libreras y frameworks disponibles, AngularJS continuar siendo el rey. Este viejo conocido est creciendo en ya en grandes empresas, banca y administraciones pblicas. Mientras esperamos la gloriosa venida de la versin 2.0, tenemos la oportunidad de  adecuar nuestro estilo de programacin y desarrollar de manera mas limpia con la versin puente **[AngularJS1.5](https://www.angularjs.org/)**\n\n* En la parte visual, el look & feel propuesto por Google con Material Design es un xito de aceptacin para el desarrollo de aplicaciones empresariales. La librera **[AngularMaterial](https://material.angularjs.org/latest/)** es una implementacin para Angular de dicha especificacin grfica. Moderno y con enorme potencial.\n\nEn [esta presentacin](https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing) tienes ms informacin acerca de lo que llamo **frontEdge** : tecnologa utilizable, de ltima generacin y con enorme potencial.\n\n[Presentacin frontEdge](https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing)\n\nSi tienes tiempo, mira [este vdeo](https://www.youtube.com/watch?v=vJZb_rs2vvU) con una charla en la que comentamos estas y otras tecnologas para programadores.\n\n[video frontEdge](https://www.youtube.com/watch?v=vJZb_rs2vvU)","slug":"soluciones-frontend-2016","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab0w000abss3x3r6phky","content":"<p>Inicio el ao proponiendo una seleccin de tecnologas que sern <strong>tendencia en el desarrollo front end</strong> durante este 2016.</p><ul><li><p>Mi apuesta de mercado empieza por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido <strong><a href=\"http://es6-features.org/#Constants\" target=\"_blank\" rel=\"noopener\">ES6</a></strong>. Tras siete aos desde la anterior gran revisin, el xito y la popularidad de JS no poda esperar ms. Y tu tampoco debes esperar ms para conocerlo y usarlo.</p></li><li><p>Existe una creciente necesidad de dependencias externas en nuestra aplicaciones y sobre todo incorporar libreras provenientes de otros entornos y desarrolladas con variantes de JS. Para administrar todo ello propongo <strong><a href=\"http://jspm.io/\" target=\"_blank\" rel=\"noopener\">JSPM</a></strong>, que se incorporar definitivamente a nuestro toolbox durante el 2016.</p></li><li><p>De entre las libreras y frameworks disponibles, AngularJS continuar siendo el rey. Este viejo conocido est creciendo en ya en grandes empresas, banca y administraciones pblicas. Mientras esperamos la gloriosa venida de la versin 2.0, tenemos la oportunidad de adecuar nuestro estilo de programacin y desarrollar de manera mas limpia con la versin puente <strong><a href=\"https://www.angularjs.org/\" target=\"_blank\" rel=\"noopener\">AngularJS1.5</a></strong></p></li><li><p>En la parte visual, el look &amp; feel propuesto por Google con Material Design es un xito de aceptacin para el desarrollo de aplicaciones empresariales. La librera <strong><a href=\"https://material.angularjs.org/latest/\" target=\"_blank\" rel=\"noopener\">AngularMaterial</a></strong> es una implementacin para Angular de dicha especificacin grfica. Moderno y con enorme potencial.</p></li></ul><p>En <a href=\"https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing\" target=\"_blank\" rel=\"noopener\">esta presentacin</a> tienes ms informacin acerca de lo que llamo <strong>frontEdge</strong> : tecnologa utilizable, de ltima generacin y con enorme potencial.</p><p><a href=\"https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing\" target=\"_blank\" rel=\"noopener\">Presentacin frontEdge</a></p><p>Si tienes tiempo, mira <a href=\"https://www.youtube.com/watch?v=vJZb_rs2vvU\" target=\"_blank\" rel=\"noopener\">este vdeo</a> con una charla en la que comentamos estas y otras tecnologas para programadores.</p><p><a href=\"https://www.youtube.com/watch?v=vJZb_rs2vvU\" target=\"_blank\" rel=\"noopener\">video frontEdge</a></p>","site":{"data":{}},"excerpt":"","more":"<p>Inicio el ao proponiendo una seleccin de tecnologas que sern <strong>tendencia en el desarrollo front end</strong> durante este 2016.</p><ul><li><p>Mi apuesta de mercado empieza por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido <strong><a href=\"http://es6-features.org/#Constants\" target=\"_blank\" rel=\"noopener\">ES6</a></strong>. Tras siete aos desde la anterior gran revisin, el xito y la popularidad de JS no poda esperar ms. Y tu tampoco debes esperar ms para conocerlo y usarlo.</p></li><li><p>Existe una creciente necesidad de dependencias externas en nuestra aplicaciones y sobre todo incorporar libreras provenientes de otros entornos y desarrolladas con variantes de JS. Para administrar todo ello propongo <strong><a href=\"http://jspm.io/\" target=\"_blank\" rel=\"noopener\">JSPM</a></strong>, que se incorporar definitivamente a nuestro toolbox durante el 2016.</p></li><li><p>De entre las libreras y frameworks disponibles, AngularJS continuar siendo el rey. Este viejo conocido est creciendo en ya en grandes empresas, banca y administraciones pblicas. Mientras esperamos la gloriosa venida de la versin 2.0, tenemos la oportunidad de adecuar nuestro estilo de programacin y desarrollar de manera mas limpia con la versin puente <strong><a href=\"https://www.angularjs.org/\" target=\"_blank\" rel=\"noopener\">AngularJS1.5</a></strong></p></li><li><p>En la parte visual, el look &amp; feel propuesto por Google con Material Design es un xito de aceptacin para el desarrollo de aplicaciones empresariales. La librera <strong><a href=\"https://material.angularjs.org/latest/\" target=\"_blank\" rel=\"noopener\">AngularMaterial</a></strong> es una implementacin para Angular de dicha especificacin grfica. Moderno y con enorme potencial.</p></li></ul><p>En <a href=\"https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing\" target=\"_blank\" rel=\"noopener\">esta presentacin</a> tienes ms informacin acerca de lo que llamo <strong>frontEdge</strong> : tecnologa utilizable, de ltima generacin y con enorme potencial.</p><p><a href=\"https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing\" target=\"_blank\" rel=\"noopener\">Presentacin frontEdge</a></p><p>Si tienes tiempo, mira <a href=\"https://www.youtube.com/watch?v=vJZb_rs2vvU\" target=\"_blank\" rel=\"noopener\">este vdeo</a> con una charla en la que comentamos estas y otras tecnologas para programadores.</p><p><a href=\"https://www.youtube.com/watch?v=vJZb_rs2vvU\" target=\"_blank\" rel=\"noopener\">video frontEdge</a></p>"},{"title":"TypeScript, programa en el front igual que en el back","id":"23","updated":"2017-03-14T18:10:13.000Z","date":"2017-03-14T18:02:11.000Z","thumbnail":"/css/images/typescript.jpg","_content":"\nHasta hace bien poco haba dos mundos en la programacin casi enfrentados: el desarrollo *back end y el front end*. El primero era el de los programadores de verdad, con **lenguajes serios y patrones de diseo**. El ltimo era el universo de los diseadores, con lenguajes de segundo nivel y **micro scripts o cdigo espagueti** descontrolado.\n\n<!-- more -->\n\nPero la llegada de los frameworks *MVC* en el cliente, llev **grandes cantidades de cdigo al navegador** y el desarrollo front end ya nunca sera lo mismo. Primero se portaron los patrones, despus las buenas prcticas, ms tarde las herramientas y as hasta haber eliminado las fronteras entre *back y front*.\n\nPero quedaba algo pendiente, el leguaje. En el lado del servidor haba multitud de opciones, siendo *Java* y *C#* las ms aceptadas por la empresa, administracin y banca. Pero al otro lado del cable segua, con algunos retoques, el viejo *JavaScript*.\n\nY entonces eclosion *TypeScript*. Un proyecto maduro creado por el equipo de desarrollo de Microsoft y que lleva a *JavaScript* al siguiente nivel. Con **tipos estticos** (de ah su nombre) propicia que las herramientas de desarrollo mejoren la productividad y experiencia de los programadores. Y como consecuencia **suaviza la rampa de entrada al *front* para los desarrolladores *back***.\n\nYa no queda excusas para programar en el cliente igual de bien que en el servidor. Prueba el *TypeScript* si dominas y te gusta la POO, sers un *full stack* cuestin de horas.","source":"_posts/TypeScript-programa-en-el-front-igual-que-en-el-back.md","raw":"---\ntitle: 'TypeScript, programa en el front igual que en el back'\ntags:\n- TypeScript\n- Opinin\npermalink: typescript-programa-en-el-front-igual-que-en-el-back\nid: 23\nupdated: '2017-03-14 19:10:13'\ndate: 2017-03-14 19:02:11\nthumbnail: /css/images/typescript.jpg\n---\n\nHasta hace bien poco haba dos mundos en la programacin casi enfrentados: el desarrollo *back end y el front end*. El primero era el de los programadores de verdad, con **lenguajes serios y patrones de diseo**. El ltimo era el universo de los diseadores, con lenguajes de segundo nivel y **micro scripts o cdigo espagueti** descontrolado.\n\n<!-- more -->\n\nPero la llegada de los frameworks *MVC* en el cliente, llev **grandes cantidades de cdigo al navegador** y el desarrollo front end ya nunca sera lo mismo. Primero se portaron los patrones, despus las buenas prcticas, ms tarde las herramientas y as hasta haber eliminado las fronteras entre *back y front*.\n\nPero quedaba algo pendiente, el leguaje. En el lado del servidor haba multitud de opciones, siendo *Java* y *C#* las ms aceptadas por la empresa, administracin y banca. Pero al otro lado del cable segua, con algunos retoques, el viejo *JavaScript*.\n\nY entonces eclosion *TypeScript*. Un proyecto maduro creado por el equipo de desarrollo de Microsoft y que lleva a *JavaScript* al siguiente nivel. Con **tipos estticos** (de ah su nombre) propicia que las herramientas de desarrollo mejoren la productividad y experiencia de los programadores. Y como consecuencia **suaviza la rampa de entrada al *front* para los desarrolladores *back***.\n\nYa no queda excusas para programar en el cliente igual de bien que en el servidor. Prueba el *TypeScript* si dominas y te gusta la POO, sers un *full stack* cuestin de horas.","slug":"typescript-programa-en-el-front-igual-que-en-el-back","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab0z000cbss31l84jg2e","content":"<p>Hasta hace bien poco haba dos mundos en la programacin casi enfrentados: el desarrollo <em>back end y el front end</em>. El primero era el de los programadores de verdad, con <strong>lenguajes serios y patrones de diseo</strong>. El ltimo era el universo de los diseadores, con lenguajes de segundo nivel y <strong>micro scripts o cdigo espagueti</strong> descontrolado.</p><a id=\"more\"></a><p>Pero la llegada de los frameworks <em>MVC</em> en el cliente, llev <strong>grandes cantidades de cdigo al navegador</strong> y el desarrollo front end ya nunca sera lo mismo. Primero se portaron los patrones, despus las buenas prcticas, ms tarde las herramientas y as hasta haber eliminado las fronteras entre <em>back y front</em>.</p><p>Pero quedaba algo pendiente, el leguaje. En el lado del servidor haba multitud de opciones, siendo <em>Java</em> y <em>C#</em> las ms aceptadas por la empresa, administracin y banca. Pero al otro lado del cable segua, con algunos retoques, el viejo <em>JavaScript</em>.</p><p>Y entonces eclosion <em>TypeScript</em>. Un proyecto maduro creado por el equipo de desarrollo de Microsoft y que lleva a <em>JavaScript</em> al siguiente nivel. Con <strong>tipos estticos</strong> (de ah su nombre) propicia que las herramientas de desarrollo mejoren la productividad y experiencia de los programadores. Y como consecuencia <strong>suaviza la rampa de entrada al <em>front</em> para los desarrolladores <em>back</em></strong>.</p><p>Ya no queda excusas para programar en el cliente igual de bien que en el servidor. Prueba el <em>TypeScript</em> si dominas y te gusta la POO, sers un <em>full stack</em> cuestin de horas.</p>","site":{"data":{}},"excerpt":"<p>Hasta hace bien poco haba dos mundos en la programacin casi enfrentados: el desarrollo <em>back end y el front end</em>. El primero era el de los programadores de verdad, con <strong>lenguajes serios y patrones de diseo</strong>. El ltimo era el universo de los diseadores, con lenguajes de segundo nivel y <strong>micro scripts o cdigo espagueti</strong> descontrolado.</p>","more":"<p>Pero la llegada de los frameworks <em>MVC</em> en el cliente, llev <strong>grandes cantidades de cdigo al navegador</strong> y el desarrollo front end ya nunca sera lo mismo. Primero se portaron los patrones, despus las buenas prcticas, ms tarde las herramientas y as hasta haber eliminado las fronteras entre <em>back y front</em>.</p><p>Pero quedaba algo pendiente, el leguaje. En el lado del servidor haba multitud de opciones, siendo <em>Java</em> y <em>C#</em> las ms aceptadas por la empresa, administracin y banca. Pero al otro lado del cable segua, con algunos retoques, el viejo <em>JavaScript</em>.</p><p>Y entonces eclosion <em>TypeScript</em>. Un proyecto maduro creado por el equipo de desarrollo de Microsoft y que lleva a <em>JavaScript</em> al siguiente nivel. Con <strong>tipos estticos</strong> (de ah su nombre) propicia que las herramientas de desarrollo mejoren la productividad y experiencia de los programadores. Y como consecuencia <strong>suaviza la rampa de entrada al <em>front</em> para los desarrolladores <em>back</em></strong>.</p><p>Ya no queda excusas para programar en el cliente igual de bien que en el servidor. Prueba el <em>TypeScript</em> si dominas y te gusta la POO, sers un <em>full stack</em> cuestin de horas.</p>"},{"title":"Un vistazo a las caractersticas principales de Angular Ivy 9","date":"2020-02-19T16:19:39.000Z","thumbnail":"/css/images/angular.builders_cuadrado.png","_content":"\n![un-vistazo-a-las-caractersticas-principales-en-el-lanzamiento-de-Angular-Ivy-versin-9](/images/light-new-year-s-eve-fireworks-sylvester-40663.jpg)\n\nEste artculo es una traduccin aprobada por el autor, [Lars Gyrup Brink Nielsen](https://twitter.com/LayZeeDK), y editor originales.\n\nEnlace original en ingls [A look at major features in the Angular Ivy version 9 release](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/) del 6 de febrero de 2020\n\nEn resumen con Angular 9 tenemos cambios. MUCHOS y en todas partes: globalizacin dinmica, modo estricto, _Bazel_ y mucho ms.\n\n*(Y s, ahora por fin se ha lanzado __Angular Ivy versin 9__)*\n\n<!-- more -->\n\n## _Ivy_ est habilitado por defecto\n\nEn versiones anteriores de Angular, tuvimos que optar por _Ivy_. En la versin 9, tenemos que optar por no usar  _Ivy_ si queremos quedarnos con View Engine. Esto es posible en las versiones 9 y la futura 10 para garantizar una transicin ms fluida de _View Engine_ a _Ivy_.\n\nLas libreras *se pueden* compilar AOT, pero no es recomendable. El equipo de Angular tiene un plan de migracin de _View Engine_ a _Ivy_ que recomienda publicar solo libreras compatibles con _View Engine_ compiladas con JIT para Angular versin 9. El compilador de compatibilidad Angular actualizar las libreras compatibles con _View Engine_ a _Ivy_ cuando se instalen en una aplicacin Angular _Ivy_.\n\nObtn informacin sobre la compatibilidad de la biblioteca y el plan de transicin de `View Engine-to-Ivy` en [\"La gua de Angular _Ivy_ para autores de libreras\"](https://indepth.dev/the-angular-ivy-guide-for-library-authors/) .\n\n```json\n// tsconfig.json\n{\n\"angularCompilerOptions\": {\n\"enableIvy\": false\n}\n}\n```\n\n```typescript\n// polyfills.ts\n// Solo se usa en aplicaciones multilinges de Ivy\n// import '@angular/localize/init';\n```\n\n*Listado 1. Optar por no usar _Ivy_ para recurrir a _View Engine_.*\n\nSi tienes problemas con _Ivy_ en tu aplicacin, o en cualquiera de las libreras de las que depende, puedes optar por salir de _Ivy_ y volver a _View Engine_. Hazlo desactivando la opcin del compilador angular `enableIvy` y deshabilitando` @angular/localize` como se ve en Listado 1.\n\nOptar por evitar _Ivy_ en un entorno de servidor es un poco ms complicado. [Sigue la gua oficial para darte de baja de _Ivy_ cuando uses la renderizacin del lado del servidor](https://angular.io/guide/ivy#using-ssr-without-ivy).\n\n## El principio de localidad\n\nAntes, para compilar un componente en _View Engine_, Angular necesitaba informacin sobre todas sus dependencias declaradas. Esto significa que las libreras Angular no se pueden compilar AOT usando _View Engine_.\n\nAhora para compilar un componente en _Ivy_, Angular solo necesita informacin sobre el componente en s. Pero, _Ivy_ no necesita metadatos de ninguna dependencia declarable para compilar un componente.\n\nEl principio de localidad significa que, en general, veremos tiempos de construccin ms rpidos.\n\n### Componentes con carga diferida\n\nLas declaraciones `entryComponents` estn en desuso porque ya no son necesarias. Cualquier componente _Ivy_ puede cargarse de forma diferida y renderizarse dinmicamente.\n\nEsto significa que ahora podemos cargar de forma diferida y renderizar un componente sin enrutamiento o mdulos Angular. Sin embargo, en la prctica an tenemos que usar mdulos para renderizar componentes o mdulos funcionales para vincular la plantilla de un componente a sus dependencias.\n\nLas libreras que solo son utilizadas por un componente con carga diferida se agrupan en fragmentos con carga diferida.\n\n## Mejoras en la carga diferencial\n\nCuando se introdujo la carga diferencial en Angular versin 8, el proceso de compilacin se ejecutaba una vez para el paquete ES5 y otra vez para el paquete ES2015+.\n\nEn Angular versin 9, primero se emite un paquete ES2015+. Ese paquete se transfiere a un paquete ES5 separado. De esta manera, no tenemos que pasar por un proceso de compilacin completo dos veces.\n\n## Compilacin AOT en todas partes\n\nAOT est habilitado de forma predeterminada en las compilaciones, el servidor de desarrollo e incluso en las pruebas. Anteriormente, la compilacin AOT era significativamente ms lenta que la compilacin JIT, por lo que JIT se usaba para el desarrollo y las pruebas. Con las mejoras de tiempo de construccin y reconstruccin en Ivy, la compilacin AOT ahora ofrece una gran experiencia al desarrollador.\n\nCuando utilizbamos la compilacin JIT en desarrollo y solo la compilacin AOT en la compilacin final, algunos errores se detectaban solo al hacer compilaciones de produccin o, peor an, en tiempo de ejecucin.\n\n## Tamaos de paquete\n\nIvy puede habilitar paquetes ms pequeos porque usa el _Ivy Instruction Set_, que es un conjunto de instrucciones de representacin de tiempo de ejecucin potencialmente _tree-shakable_. Nuestros paquetes solo incluirn las instrucciones de renderizado que realmente usamos en nuestros proyectos.\n\nEsto es ideal para casos de uso como _micro-frontends_, Angular Elements y aplicaciones web donde Angular no controla todo el documento.\n\nSin embargo, la diferencia en los tamaos de nuestros paquetes entre _View Engine_ e _Ivy_ variar segn el tamao de nuestra aplicacin y las libreras de terceros que utilizamos. En general:\n\n- Las aplicaciones pequeas y simples vern una disminucin considerable del peso del paquete.\n- Las aplicaciones complejas vern un aumento en el fichero principal, pero una disminucin en los tamaos de paquetes con carga diferida.\n\nEsto significa una disminucin considerable del tamao de descarga combinada para aplicaciones grandes, pero podra significar un aumento en el peso total para aplicaciones medianas. En ambos casos, el tamao del paquete principal probablemente aumentar, lo que es malo para el tiempo de carga inicial de la pgina.\n\n## Globalizacin\n\nLas configuraciones regionales (formato de nmero, formato de fecha y otras configuraciones regionales) se pueden cargar dinmicamente en tiempo de ejecucin en lugar de tener que registrarse en tiempo de compilacin.\n\n```typescript\n// main.ts\nimport '@angular/localize/init';\n\nimport { loadTranslations } from '@angular/localize';\n\nloadTranslations ({\n'8374172394781134519': 'Hola, {$nombre de usuario}! Bienvenido a {$appName}. ',\n});\n```\n\n*Listado 2. Carga dinmica de traducciones.*\n\nComo se ve en el Listado 2, los textos traducidos tambin se pueden cargar dinmicamente en tiempo de ejecucin en lugar de ser parte de nuestros paquetes.\n\nLos textos traducidos pueden cargarse desde una base de datos o un archivo.\n\n### Mltiples idiomas desde un nico paquete de aplicaciones\n\nPara cambiar el idioma, tenemos que reiniciar la aplicacin, pero no tenemos que servir un fichero de aplicaciones diferente.\n\nEsto significa que podemos, con alguna configuracin, admitir varios idiomas con un solo paquete de aplicaciones en un solo nombre de host.\n\n### Tiempo de compilacin en lnea\n\nUna aplicacin localizada ahora solo se compilar una vez. En lugar de mltiples compilaciones para producir un paquete por idioma, se produce un paquete por idioma reemplazando los marcadores de posicin `$localize` con textos traducidos.\n\nAhora  hay que agregar el paquete `@angular/localize` para posibilitar la localizacin (varios idiomas). La buena noticia es que ya no tenemos que incluir el cdigo de localizacin de Angular en nuestros paquetes si solo tenemos un idioma.\n\nSi no usamos plantillas localizadas, las instrucciones de _Ivy_ `i18n *` se sacan del paquete principal.\n\n### Textos localizables en modelos de componentes y servicios\n\n```typescript\n// app.component.ts\n@Component({\n  template: '{{ title }}'\n})\nexport class AppComponent {\n  title = $localize`Welcome to MyApp`;\n}\n```\n\n*Listado 3. Un marcador de posicin de texto de traduccin en un modelo de componente.*\n\nUna nueva caracterstica de internacionalizacin es que tambin podemos incluir marcadores de posicin para textos traducidos en el contenido de nuestros modelos como se ve en el Listado 3. Anteriormente, esto solo era posible en las plantillas.\n\n## mbitos adicionales de proveedores de dependencias\n\nSiempre hemos tenido alcance de mdulo para los proveedores de inyeccin de servicios. La versin Angular 6 introdujo el alcance `'root'` y los proveedores _tree-shakable_, tanto para los proveedores de alcance desde el mdulo raz como desde mdulos inferiores.\n\nLa versin angular 9 presenta los nuevos mbitos de proveedor `'platform'` y `'any'`. Los proveedores con mbito de `'platform'` se pueden compartir entre mltiples aplicaciones Angular en el mismo documento. El alcance del proveedor `'any'` compartir un proveedor por inyector de mdulo. Por ejemplo, una instancia de servicio para el paquete principal cargado por adelantado y una instancia de servicio para cada mdulo cargado con retraso.\n\n## Experiencia mejorada del desarrollador\n\nIvy permite que _Angular Language Service_ admita comprobaciones adicionales durante el desarrollo. Esta es una gran mejora para la experiencia del desarrollador.\n\n### Comprobaciones de ruta de archivo\n\n_Angular Language Service_ verifica continuamente la hoja de estilo de componentes y las rutas de plantilla.\n\n### Verificaciones de tipo de plantilla\n\nLas plantillas se verifican por tipo, de acuerdo con el modo de verificacin de tipo de plantilla como se describe ms abajo en la seccin \"Modo estricto\". Los nombres y tipos de miembros se verifican, incluso en vistas incrustadas. Lo que anteriormente resultaba en errores de tiempo de ejecucin ahora se detecta durante el desarrollo y la construccin.\n\n## Nueva API de depuracin en modo de desarrollo\n\n`ng.probe` ha sido reemplazado por una nueva API de depuracin en modo de desarrollo. Las funciones ms notables son `ng.applyChanges` y` ng.getComponent`.\n\n## Modo estricto\n\n### Esquema estricto del espacio de trabajo\n\nEl comando `ng new` ahora es compatible con el indicador` --strict` que por defecto est desactivado (`false`).\n\n```bash\nng new my-app --strict\n```\n\nCuando est habilitado, este parmetro agrega algunas comprobaciones estrictas del compilador TypeScript como se ve en el Listado 4.\n\n```json\n// tsconfig.json\n{\n\"compilerOptions\": {\n\"noImplicitAny\": true,\n\"noImplicitReturns\": true,\n\"noImplicitThis\": true,\n\"noFallthroughCasesInSwitch\": true,\n\"strictlyNullChecks\": true\n}\n}\n```\n\n*Listado 4. Opciones del compilador TypeScript habilitadas en un estricto espacio de trabajo angular.*\n\nCuriosamente, esto no agrega las mismas opciones que si simplemente estableciramos `\"strict\": true` en el objeto `compilerOptions`. Comparemos la opcin estricta del _workspace_ Angular con la opcin estricta del compilador TypeScript.\n\nAmbos tienen estas opciones en comn:\n\n- `noImplicitAny`\n- `noImplicitThis`\n- `strictlyNullChecks`\n\nLa opcin estricta de Angular establece adems estas opciones:\n\n- `noImplicitReturns`\n- `noFallthroughCasesInSwitch`\n\nmientras que la opcin estricta del compilador TypeScript establece adicionalmente estas opciones:\n\n- `alwaysStrict`\n- `strictlyBindCallApply`\n- `strictlyFunctionTypes`\n- `estrictoPropertyInitialization`\n\nAdems, la opcin de Angular no establece la comprobacin del tipo de plantilla en el nuevo modo estricto, lo deja en el modo `'full'` anterior.\n\n### Verificacin estricta del tipo de plantilla\n\nHemos tenido la opcin de habilitar la verificacin del tipo de plantilla desde Angular versin 5 configurando `\"fullTemplateTypeCheck\":true` en el objeto`angularCompilerOptions`.\n\nIvy presenta una estricta comprobacin del tipo de plantilla como se ve en el Listado 5. Cuando se establece esta nueva opcin del compilador Angular, se ignora el valor de `fullTemplateTypeCheck`.\n\n```typescript\n// tsconfig.json\n{\n\"angularCompilerOptions\": {\n\"strictTemplates\": true\n}\n}\n```\n\n*Listado 5. Habilita la comprobacin estricta del tipo de plantilla.*\n\nLa comprobacin de tipo de plantilla estricta verifica los tipos de enlaces de propiedades y respeta la opcin `stricNullChecks`. Tambin verifica los tipos de referencias de plantilla a directivas y componentes, incluidos los tipos genricos. Tambin se verifican los tipos de variables de contexto de plantilla, lo cual es excelente para los bucles `NgFor`. El tipo `$ event` est marcado para enlaces de eventos y animaciones. Incluso el tipo de elementos DOM nativos se verifica con una comprobacin estricta del tipo de plantilla.\n\nEstas comprobaciones adicionales pueden conducir a errores y falsos positivos bajo ciertas circunstancias. Por ejemplo, cuando se usan libreras que no estn compiladas con `strictNullChecks`. Para abordar esto, la verificacin estricta del tipo de plantilla tiene opciones para optar por no participar y ajustar los controles. Por ejemplo, `strictTemplates` es en realidad una atajo de 8 opciones de compilador Angular.\n\n## Herencia de clase de componente y directiva mejorada\n\nLas clases base sin selector ahora son compatibles con directivas y componentes. Algunos metadatos ahora se heredan de componentes base y clases directivas. Esto hace que sea ms fcil extender, por ejemplo, las directivas Angular Components y Angular Router.\n\n## ltimas versiones de TypeScript\n\nLas versiones de TypeScript 3.6 y 3.7 son compatibles con la versin angular 9. Las versiones anteriores de TypeScript ya no son compatibles. Consulta la Tabla 1 para comparar la compatibilidad de TypeScript entre\ntodas las versiones Angular.\n\n[vista bruta](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support.csv)\n[descargable angular-cli-node-js-typescript-support.csv](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv) hosted with  by [GitHub](https://github.com/)\n\n*Tabla 1. Tabla de compatibilidad del Angular CLI, Angular, Node.js y TypeScript.* [*Abrir en una pestaa nueva*](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3)*\n\nTypeScript versin 3.6 presenta estas y otras caractersticas:\n\n- Soporte Unicode para identificadores en destinos modernos\n- Experiencia de desarrollador mejorada para promesas\n- Comprobacin de tipo ms estricto de generadores\n\nTypeScript versin 3.7 presenta estas y otras caractersticas que podemos usar con Angular versin 9:\n\n- Operador de encadenamiento opcional (`?.`) similar al operador de navegacin segura para plantillas Angular\n- Operador de unin con nulos (`??`)\n- Funciones de afirmacin de pruebas (`assert parameterName is typeName` y `asserts parameterName`)\n- `await` de primer nivel\n- Alias de tipo recursivo mejorado\n- Mejora de la experiencia del desarrollador para funciones de comprobaciones\n\n## Generacin mejorada del lado del servidor con Angular Universal\n\nAngular Universal versin 9 se lanza con un servidor de desarrollo Node.js Express para proporcionar un entorno realista durante el desarrollo.\n\nTambin parte de este lanzamiento es un constructor del CLI para pre-renderizar rutas estticas usando `guess-parser`, inspirado en `angular-prerender`. Podemos pasar un archivo de rutas para renderizar rutas dinmicas (rutas con parmetros).\n\n### Cmo empiezo?\n\nPodemos agregar Angular Universal usando el comando `ng add @nguniversal/express-engine`. Luego podemos usar el comando del constructor `ng run myapp:serve-ssr` para iniciar el servidor de desarrollo de renderizado del lado del servidor con recarga en vivo. De manera similar, podemos usar `ng run myapp:prerender` para detectar rutas estticas y dinmicas y pre renderizarlas.\n\n## Experiencia de clases y estilo mejorada\n\nAl aplicacin de estilo en Angular _Ivy_ ha sido reelaborado. La combinacin de clases HTML estticas con las directivas `NgStyle` y` NgClass` es ahora totalmente compatible y ms fcil de entender.\n\n### Soporte de propiedades personalizadas de CSS\n\nComo parte de la reescritura del estilo Ivy, ahora se admiten las propiedades personalizadas de CSS enlazadas.\n\nUn ejemplo de enlace css puede ser as:\n\n```html\n<div [style.--my-var]=\"myProperty || 'any value'\"></div>\n```\n\nLas propiedades personalizadas de CSS tienen control de alcance, por lo que esta propiedad de CSS se limitara al DOM del componente.\n\n## Lanzamiento estable de Bazel como opcin de suscripcin\n\nBazel versin 2.1 es una herramienta de automatizacin de compilacin opcional para Angular versin 9.\n\n### Cmo empiezo?\n\nPara habilitar Bazel, usa `ng add @angular/bazel` o la coleccin de esquemas `@angular/bazel` cuando generes un espacio de trabajo Angular.\n\nAsegrate de seguir [la gua de instalacin de Bazel](https://docs.bazel.build/versions/2.0.0/install.html) para tu sistema operativo.\n\n## Angular Components\n\nLa versin Angular 9 viene con componentes oficiales para YouTube y Google Maps. Se agreg una directiva y un servicio de portapapeles al Angular CDK.\n\n## Pruebas\n\nLa mayor sorpresa de la versin Angular versin 9 son las muchas mejoras en las pruebas. Se resuelven problemas de rendimiento, se mejoran los tipos y se introducen nuevos conceptos.\n\n[Obtn informacin sobre las principales caractersticas y mejoras para las pruebas en \"Pruebas de siguiente nivel en Angular _Ivy_ versin 9\"](https://indepth.dev/next-level-testing-in-angular-ivy-version-9/).\n\n## Conclusin\n\nUno de los objetivos ms importantes ha sido mantener la compatibilidad hacia atrs entre _Ivy_ y _View Engine_ tanto como fue posible.\n\nPor supuesto, la versin Angular 9 tambin incluye correcciones de errores, temas obsoletos y cambios importantes. _Ivy_ tambin aborda algunos problemas de antiguos que no cubrimos en este artculo.\n\nAngular _Ivy_ es un facilitador para las caractersticas que estn por venir. Como hemos discutido en este artculo, _Ivy_ ya nos ha dado beneficios para diferentes casos de uso. Sin embargo, las mejores caractersticas llegarn en futuras versiones de Angular. Cul de las posibles caractersticas que se entregarn en las versiones 10 y 11 de Angular est por decidir?\n\nSolo discutimos qu es parte de las API pblicas y estables de Angular versin 9. Algunas API experimentales son parte de esta versin, como `renderComponent`,` markDirty` y `detectChanges`. Sin embargo, todava estn sujetos a cambios.\n\nCon la retirada de las declaraciones de componentes de entrada y los componentes con carga diferida utilizando mdulos de representacin, estamos un paso ms cerca de tener [componentes que se pueden eliminar del rbol y mdulos Angular opcionales](https://indepth.dev/angular-revisited-tree-shakable-components-and-optional-ngmodules/).\n\n[Los componentes de funcionalidad](https://indepth.dev/component-features-with-angular-ivy/) tambin forman parte de esta versin, pero solo estn expuestos para uso interno de _Ivy_.\n\nLa versin de Angular _Ivy_ versin 9 nos brinda mejoras para el empaquetamiento, las pruebas, la experiencia del desarrollador, las herramientas, la depuracin y la verificacin de tipos. Toda una buena coleccin de caractersticas.\n\n## Recursos relacionados\n\n### Componentes con carga lenta\n\n[Informacin sobre los mdulos de presentacin en la charla \"Angular revisited: Tree-shakable components and optional NgModules\"](https://youtu.be/DA3efofhpq4).\n\n[Aprende a usar los componentes de carga diferida en \"Lazy load components in Angular\" por Kevin Kreuzer](https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8).\n\n### Comprobacin de tipos en plantillas\n\n[Lee la gua oficial sobre la verificacin de tipos en plantillas Angular para conocer los detalles de la resolucin de problemas y la configuracin](https://angular.io/guide/template-typecheck#troubleshooting-template-errors).\n\n### Globalizacin\n\n[Manfred Steyer analiza las configuraciones regionales de carga diferida en \"Lazy Loading Locales with Angular\"](https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/).\n\n[Cdric Exbrayat analiza la globalizacin de _Ivy_ en \"Internationalization with @angular/localize\"](https://blog.ninja-squad.com/2019/12/10/angular-localize/).\n\n### mbitos adicionales de proveedor de dependencias\n\nObtn informacin sobre los mbitos de proveedor de `'any'` y `'platform'` en [Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler](https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb).\n\n### Nueva API de depuracin\n[Lee sobre la API de depuracin completa en la documentacin oficial](https://angular.io/api/core/global).\n\n### Angular Universal versin 9\n\nEstos dos artculos entran en detalles de Angular Universal versin 9:\n\n-   [Angular Universal v9: Whats New ? by Mark Pieszak](https://trilon.io/blog/angular-universal-v9-whats-new)\n-   [Angular v9 & Universal: SSR and prerendering out of the box! by Sam Vloeberghs](https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1)\n\nAprende sobre `angular-prerender`, la biblioteca que inspir estas nuevas caractersticas de Angular Universal en [Prerender Angular Apps with a single Command by Christoph Guttandin](https://media-codings.com/articles/prerender-angular-apps-with-a-single-command).\n\n### Enlace de propiedades personalizadas de CSS\n\n[Mira este tweet y la demostracin de Alexey Zuev para ver los enlaces de Propiedades personalizadas de CSS en accin](https://twitter.com/yurzui/status/1221159415820275717).\n\n## Revisores\n\nSiempre es til tener una segunda opinin sobre nuestro trabajo o incluso detectar errores tontos. Para este artculo el autor tuvo el placer de ser revisado por:\n\n-   [Christoph Guttandin](https://twitter.com/chrisguttandin)\n-   [Evgeny Fedorenko](https://indepth.dev/author/evgeny/)\n-   [Santosh Yadav](https://dev.to/santoshyadav198613)\n\nCover photo by [Pixabay](https://www.pexels.com/photo/light-new-year-s-eve-fireworks-sylvester-40663/) on Pexels.\n\nEl autor original: [Lars Gyrup Brink Nielsen](https://twitter.com/LayZeeDK)\n\nEl traductor al espaol: [Alberto Basalo](https://twitter.com/albertobasalo)\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","source":"_posts/angular9.md","raw":"---\ntitle: Un vistazo a las caractersticas principales de Angular Ivy 9\npermalink: un-vistazo-a-las-caractersticas-principales-en-el-lanzamiento-de-Angular-Ivy-versin-9\ndate: 2020-02-19 17:19:39\ntags:\n- Angular\n- Angular9\n- Ivy\ncategories:\n- [Angular]\nthumbnail: /css/images/angular.builders_cuadrado.png\n---\n\n![un-vistazo-a-las-caractersticas-principales-en-el-lanzamiento-de-Angular-Ivy-versin-9](/images/light-new-year-s-eve-fireworks-sylvester-40663.jpg)\n\nEste artculo es una traduccin aprobada por el autor, [Lars Gyrup Brink Nielsen](https://twitter.com/LayZeeDK), y editor originales.\n\nEnlace original en ingls [A look at major features in the Angular Ivy version 9 release](https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/) del 6 de febrero de 2020\n\nEn resumen con Angular 9 tenemos cambios. MUCHOS y en todas partes: globalizacin dinmica, modo estricto, _Bazel_ y mucho ms.\n\n*(Y s, ahora por fin se ha lanzado __Angular Ivy versin 9__)*\n\n<!-- more -->\n\n## _Ivy_ est habilitado por defecto\n\nEn versiones anteriores de Angular, tuvimos que optar por _Ivy_. En la versin 9, tenemos que optar por no usar  _Ivy_ si queremos quedarnos con View Engine. Esto es posible en las versiones 9 y la futura 10 para garantizar una transicin ms fluida de _View Engine_ a _Ivy_.\n\nLas libreras *se pueden* compilar AOT, pero no es recomendable. El equipo de Angular tiene un plan de migracin de _View Engine_ a _Ivy_ que recomienda publicar solo libreras compatibles con _View Engine_ compiladas con JIT para Angular versin 9. El compilador de compatibilidad Angular actualizar las libreras compatibles con _View Engine_ a _Ivy_ cuando se instalen en una aplicacin Angular _Ivy_.\n\nObtn informacin sobre la compatibilidad de la biblioteca y el plan de transicin de `View Engine-to-Ivy` en [\"La gua de Angular _Ivy_ para autores de libreras\"](https://indepth.dev/the-angular-ivy-guide-for-library-authors/) .\n\n```json\n// tsconfig.json\n{\n\"angularCompilerOptions\": {\n\"enableIvy\": false\n}\n}\n```\n\n```typescript\n// polyfills.ts\n// Solo se usa en aplicaciones multilinges de Ivy\n// import '@angular/localize/init';\n```\n\n*Listado 1. Optar por no usar _Ivy_ para recurrir a _View Engine_.*\n\nSi tienes problemas con _Ivy_ en tu aplicacin, o en cualquiera de las libreras de las que depende, puedes optar por salir de _Ivy_ y volver a _View Engine_. Hazlo desactivando la opcin del compilador angular `enableIvy` y deshabilitando` @angular/localize` como se ve en Listado 1.\n\nOptar por evitar _Ivy_ en un entorno de servidor es un poco ms complicado. [Sigue la gua oficial para darte de baja de _Ivy_ cuando uses la renderizacin del lado del servidor](https://angular.io/guide/ivy#using-ssr-without-ivy).\n\n## El principio de localidad\n\nAntes, para compilar un componente en _View Engine_, Angular necesitaba informacin sobre todas sus dependencias declaradas. Esto significa que las libreras Angular no se pueden compilar AOT usando _View Engine_.\n\nAhora para compilar un componente en _Ivy_, Angular solo necesita informacin sobre el componente en s. Pero, _Ivy_ no necesita metadatos de ninguna dependencia declarable para compilar un componente.\n\nEl principio de localidad significa que, en general, veremos tiempos de construccin ms rpidos.\n\n### Componentes con carga diferida\n\nLas declaraciones `entryComponents` estn en desuso porque ya no son necesarias. Cualquier componente _Ivy_ puede cargarse de forma diferida y renderizarse dinmicamente.\n\nEsto significa que ahora podemos cargar de forma diferida y renderizar un componente sin enrutamiento o mdulos Angular. Sin embargo, en la prctica an tenemos que usar mdulos para renderizar componentes o mdulos funcionales para vincular la plantilla de un componente a sus dependencias.\n\nLas libreras que solo son utilizadas por un componente con carga diferida se agrupan en fragmentos con carga diferida.\n\n## Mejoras en la carga diferencial\n\nCuando se introdujo la carga diferencial en Angular versin 8, el proceso de compilacin se ejecutaba una vez para el paquete ES5 y otra vez para el paquete ES2015+.\n\nEn Angular versin 9, primero se emite un paquete ES2015+. Ese paquete se transfiere a un paquete ES5 separado. De esta manera, no tenemos que pasar por un proceso de compilacin completo dos veces.\n\n## Compilacin AOT en todas partes\n\nAOT est habilitado de forma predeterminada en las compilaciones, el servidor de desarrollo e incluso en las pruebas. Anteriormente, la compilacin AOT era significativamente ms lenta que la compilacin JIT, por lo que JIT se usaba para el desarrollo y las pruebas. Con las mejoras de tiempo de construccin y reconstruccin en Ivy, la compilacin AOT ahora ofrece una gran experiencia al desarrollador.\n\nCuando utilizbamos la compilacin JIT en desarrollo y solo la compilacin AOT en la compilacin final, algunos errores se detectaban solo al hacer compilaciones de produccin o, peor an, en tiempo de ejecucin.\n\n## Tamaos de paquete\n\nIvy puede habilitar paquetes ms pequeos porque usa el _Ivy Instruction Set_, que es un conjunto de instrucciones de representacin de tiempo de ejecucin potencialmente _tree-shakable_. Nuestros paquetes solo incluirn las instrucciones de renderizado que realmente usamos en nuestros proyectos.\n\nEsto es ideal para casos de uso como _micro-frontends_, Angular Elements y aplicaciones web donde Angular no controla todo el documento.\n\nSin embargo, la diferencia en los tamaos de nuestros paquetes entre _View Engine_ e _Ivy_ variar segn el tamao de nuestra aplicacin y las libreras de terceros que utilizamos. En general:\n\n- Las aplicaciones pequeas y simples vern una disminucin considerable del peso del paquete.\n- Las aplicaciones complejas vern un aumento en el fichero principal, pero una disminucin en los tamaos de paquetes con carga diferida.\n\nEsto significa una disminucin considerable del tamao de descarga combinada para aplicaciones grandes, pero podra significar un aumento en el peso total para aplicaciones medianas. En ambos casos, el tamao del paquete principal probablemente aumentar, lo que es malo para el tiempo de carga inicial de la pgina.\n\n## Globalizacin\n\nLas configuraciones regionales (formato de nmero, formato de fecha y otras configuraciones regionales) se pueden cargar dinmicamente en tiempo de ejecucin en lugar de tener que registrarse en tiempo de compilacin.\n\n```typescript\n// main.ts\nimport '@angular/localize/init';\n\nimport { loadTranslations } from '@angular/localize';\n\nloadTranslations ({\n'8374172394781134519': 'Hola, {$nombre de usuario}! Bienvenido a {$appName}. ',\n});\n```\n\n*Listado 2. Carga dinmica de traducciones.*\n\nComo se ve en el Listado 2, los textos traducidos tambin se pueden cargar dinmicamente en tiempo de ejecucin en lugar de ser parte de nuestros paquetes.\n\nLos textos traducidos pueden cargarse desde una base de datos o un archivo.\n\n### Mltiples idiomas desde un nico paquete de aplicaciones\n\nPara cambiar el idioma, tenemos que reiniciar la aplicacin, pero no tenemos que servir un fichero de aplicaciones diferente.\n\nEsto significa que podemos, con alguna configuracin, admitir varios idiomas con un solo paquete de aplicaciones en un solo nombre de host.\n\n### Tiempo de compilacin en lnea\n\nUna aplicacin localizada ahora solo se compilar una vez. En lugar de mltiples compilaciones para producir un paquete por idioma, se produce un paquete por idioma reemplazando los marcadores de posicin `$localize` con textos traducidos.\n\nAhora  hay que agregar el paquete `@angular/localize` para posibilitar la localizacin (varios idiomas). La buena noticia es que ya no tenemos que incluir el cdigo de localizacin de Angular en nuestros paquetes si solo tenemos un idioma.\n\nSi no usamos plantillas localizadas, las instrucciones de _Ivy_ `i18n *` se sacan del paquete principal.\n\n### Textos localizables en modelos de componentes y servicios\n\n```typescript\n// app.component.ts\n@Component({\n  template: '{{ title }}'\n})\nexport class AppComponent {\n  title = $localize`Welcome to MyApp`;\n}\n```\n\n*Listado 3. Un marcador de posicin de texto de traduccin en un modelo de componente.*\n\nUna nueva caracterstica de internacionalizacin es que tambin podemos incluir marcadores de posicin para textos traducidos en el contenido de nuestros modelos como se ve en el Listado 3. Anteriormente, esto solo era posible en las plantillas.\n\n## mbitos adicionales de proveedores de dependencias\n\nSiempre hemos tenido alcance de mdulo para los proveedores de inyeccin de servicios. La versin Angular 6 introdujo el alcance `'root'` y los proveedores _tree-shakable_, tanto para los proveedores de alcance desde el mdulo raz como desde mdulos inferiores.\n\nLa versin angular 9 presenta los nuevos mbitos de proveedor `'platform'` y `'any'`. Los proveedores con mbito de `'platform'` se pueden compartir entre mltiples aplicaciones Angular en el mismo documento. El alcance del proveedor `'any'` compartir un proveedor por inyector de mdulo. Por ejemplo, una instancia de servicio para el paquete principal cargado por adelantado y una instancia de servicio para cada mdulo cargado con retraso.\n\n## Experiencia mejorada del desarrollador\n\nIvy permite que _Angular Language Service_ admita comprobaciones adicionales durante el desarrollo. Esta es una gran mejora para la experiencia del desarrollador.\n\n### Comprobaciones de ruta de archivo\n\n_Angular Language Service_ verifica continuamente la hoja de estilo de componentes y las rutas de plantilla.\n\n### Verificaciones de tipo de plantilla\n\nLas plantillas se verifican por tipo, de acuerdo con el modo de verificacin de tipo de plantilla como se describe ms abajo en la seccin \"Modo estricto\". Los nombres y tipos de miembros se verifican, incluso en vistas incrustadas. Lo que anteriormente resultaba en errores de tiempo de ejecucin ahora se detecta durante el desarrollo y la construccin.\n\n## Nueva API de depuracin en modo de desarrollo\n\n`ng.probe` ha sido reemplazado por una nueva API de depuracin en modo de desarrollo. Las funciones ms notables son `ng.applyChanges` y` ng.getComponent`.\n\n## Modo estricto\n\n### Esquema estricto del espacio de trabajo\n\nEl comando `ng new` ahora es compatible con el indicador` --strict` que por defecto est desactivado (`false`).\n\n```bash\nng new my-app --strict\n```\n\nCuando est habilitado, este parmetro agrega algunas comprobaciones estrictas del compilador TypeScript como se ve en el Listado 4.\n\n```json\n// tsconfig.json\n{\n\"compilerOptions\": {\n\"noImplicitAny\": true,\n\"noImplicitReturns\": true,\n\"noImplicitThis\": true,\n\"noFallthroughCasesInSwitch\": true,\n\"strictlyNullChecks\": true\n}\n}\n```\n\n*Listado 4. Opciones del compilador TypeScript habilitadas en un estricto espacio de trabajo angular.*\n\nCuriosamente, esto no agrega las mismas opciones que si simplemente estableciramos `\"strict\": true` en el objeto `compilerOptions`. Comparemos la opcin estricta del _workspace_ Angular con la opcin estricta del compilador TypeScript.\n\nAmbos tienen estas opciones en comn:\n\n- `noImplicitAny`\n- `noImplicitThis`\n- `strictlyNullChecks`\n\nLa opcin estricta de Angular establece adems estas opciones:\n\n- `noImplicitReturns`\n- `noFallthroughCasesInSwitch`\n\nmientras que la opcin estricta del compilador TypeScript establece adicionalmente estas opciones:\n\n- `alwaysStrict`\n- `strictlyBindCallApply`\n- `strictlyFunctionTypes`\n- `estrictoPropertyInitialization`\n\nAdems, la opcin de Angular no establece la comprobacin del tipo de plantilla en el nuevo modo estricto, lo deja en el modo `'full'` anterior.\n\n### Verificacin estricta del tipo de plantilla\n\nHemos tenido la opcin de habilitar la verificacin del tipo de plantilla desde Angular versin 5 configurando `\"fullTemplateTypeCheck\":true` en el objeto`angularCompilerOptions`.\n\nIvy presenta una estricta comprobacin del tipo de plantilla como se ve en el Listado 5. Cuando se establece esta nueva opcin del compilador Angular, se ignora el valor de `fullTemplateTypeCheck`.\n\n```typescript\n// tsconfig.json\n{\n\"angularCompilerOptions\": {\n\"strictTemplates\": true\n}\n}\n```\n\n*Listado 5. Habilita la comprobacin estricta del tipo de plantilla.*\n\nLa comprobacin de tipo de plantilla estricta verifica los tipos de enlaces de propiedades y respeta la opcin `stricNullChecks`. Tambin verifica los tipos de referencias de plantilla a directivas y componentes, incluidos los tipos genricos. Tambin se verifican los tipos de variables de contexto de plantilla, lo cual es excelente para los bucles `NgFor`. El tipo `$ event` est marcado para enlaces de eventos y animaciones. Incluso el tipo de elementos DOM nativos se verifica con una comprobacin estricta del tipo de plantilla.\n\nEstas comprobaciones adicionales pueden conducir a errores y falsos positivos bajo ciertas circunstancias. Por ejemplo, cuando se usan libreras que no estn compiladas con `strictNullChecks`. Para abordar esto, la verificacin estricta del tipo de plantilla tiene opciones para optar por no participar y ajustar los controles. Por ejemplo, `strictTemplates` es en realidad una atajo de 8 opciones de compilador Angular.\n\n## Herencia de clase de componente y directiva mejorada\n\nLas clases base sin selector ahora son compatibles con directivas y componentes. Algunos metadatos ahora se heredan de componentes base y clases directivas. Esto hace que sea ms fcil extender, por ejemplo, las directivas Angular Components y Angular Router.\n\n## ltimas versiones de TypeScript\n\nLas versiones de TypeScript 3.6 y 3.7 son compatibles con la versin angular 9. Las versiones anteriores de TypeScript ya no son compatibles. Consulta la Tabla 1 para comparar la compatibilidad de TypeScript entre\ntodas las versiones Angular.\n\n[vista bruta](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support.csv)\n[descargable angular-cli-node-js-typescript-support.csv](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv) hosted with  by [GitHub](https://github.com/)\n\n*Tabla 1. Tabla de compatibilidad del Angular CLI, Angular, Node.js y TypeScript.* [*Abrir en una pestaa nueva*](https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3)*\n\nTypeScript versin 3.6 presenta estas y otras caractersticas:\n\n- Soporte Unicode para identificadores en destinos modernos\n- Experiencia de desarrollador mejorada para promesas\n- Comprobacin de tipo ms estricto de generadores\n\nTypeScript versin 3.7 presenta estas y otras caractersticas que podemos usar con Angular versin 9:\n\n- Operador de encadenamiento opcional (`?.`) similar al operador de navegacin segura para plantillas Angular\n- Operador de unin con nulos (`??`)\n- Funciones de afirmacin de pruebas (`assert parameterName is typeName` y `asserts parameterName`)\n- `await` de primer nivel\n- Alias de tipo recursivo mejorado\n- Mejora de la experiencia del desarrollador para funciones de comprobaciones\n\n## Generacin mejorada del lado del servidor con Angular Universal\n\nAngular Universal versin 9 se lanza con un servidor de desarrollo Node.js Express para proporcionar un entorno realista durante el desarrollo.\n\nTambin parte de este lanzamiento es un constructor del CLI para pre-renderizar rutas estticas usando `guess-parser`, inspirado en `angular-prerender`. Podemos pasar un archivo de rutas para renderizar rutas dinmicas (rutas con parmetros).\n\n### Cmo empiezo?\n\nPodemos agregar Angular Universal usando el comando `ng add @nguniversal/express-engine`. Luego podemos usar el comando del constructor `ng run myapp:serve-ssr` para iniciar el servidor de desarrollo de renderizado del lado del servidor con recarga en vivo. De manera similar, podemos usar `ng run myapp:prerender` para detectar rutas estticas y dinmicas y pre renderizarlas.\n\n## Experiencia de clases y estilo mejorada\n\nAl aplicacin de estilo en Angular _Ivy_ ha sido reelaborado. La combinacin de clases HTML estticas con las directivas `NgStyle` y` NgClass` es ahora totalmente compatible y ms fcil de entender.\n\n### Soporte de propiedades personalizadas de CSS\n\nComo parte de la reescritura del estilo Ivy, ahora se admiten las propiedades personalizadas de CSS enlazadas.\n\nUn ejemplo de enlace css puede ser as:\n\n```html\n<div [style.--my-var]=\"myProperty || 'any value'\"></div>\n```\n\nLas propiedades personalizadas de CSS tienen control de alcance, por lo que esta propiedad de CSS se limitara al DOM del componente.\n\n## Lanzamiento estable de Bazel como opcin de suscripcin\n\nBazel versin 2.1 es una herramienta de automatizacin de compilacin opcional para Angular versin 9.\n\n### Cmo empiezo?\n\nPara habilitar Bazel, usa `ng add @angular/bazel` o la coleccin de esquemas `@angular/bazel` cuando generes un espacio de trabajo Angular.\n\nAsegrate de seguir [la gua de instalacin de Bazel](https://docs.bazel.build/versions/2.0.0/install.html) para tu sistema operativo.\n\n## Angular Components\n\nLa versin Angular 9 viene con componentes oficiales para YouTube y Google Maps. Se agreg una directiva y un servicio de portapapeles al Angular CDK.\n\n## Pruebas\n\nLa mayor sorpresa de la versin Angular versin 9 son las muchas mejoras en las pruebas. Se resuelven problemas de rendimiento, se mejoran los tipos y se introducen nuevos conceptos.\n\n[Obtn informacin sobre las principales caractersticas y mejoras para las pruebas en \"Pruebas de siguiente nivel en Angular _Ivy_ versin 9\"](https://indepth.dev/next-level-testing-in-angular-ivy-version-9/).\n\n## Conclusin\n\nUno de los objetivos ms importantes ha sido mantener la compatibilidad hacia atrs entre _Ivy_ y _View Engine_ tanto como fue posible.\n\nPor supuesto, la versin Angular 9 tambin incluye correcciones de errores, temas obsoletos y cambios importantes. _Ivy_ tambin aborda algunos problemas de antiguos que no cubrimos en este artculo.\n\nAngular _Ivy_ es un facilitador para las caractersticas que estn por venir. Como hemos discutido en este artculo, _Ivy_ ya nos ha dado beneficios para diferentes casos de uso. Sin embargo, las mejores caractersticas llegarn en futuras versiones de Angular. Cul de las posibles caractersticas que se entregarn en las versiones 10 y 11 de Angular est por decidir?\n\nSolo discutimos qu es parte de las API pblicas y estables de Angular versin 9. Algunas API experimentales son parte de esta versin, como `renderComponent`,` markDirty` y `detectChanges`. Sin embargo, todava estn sujetos a cambios.\n\nCon la retirada de las declaraciones de componentes de entrada y los componentes con carga diferida utilizando mdulos de representacin, estamos un paso ms cerca de tener [componentes que se pueden eliminar del rbol y mdulos Angular opcionales](https://indepth.dev/angular-revisited-tree-shakable-components-and-optional-ngmodules/).\n\n[Los componentes de funcionalidad](https://indepth.dev/component-features-with-angular-ivy/) tambin forman parte de esta versin, pero solo estn expuestos para uso interno de _Ivy_.\n\nLa versin de Angular _Ivy_ versin 9 nos brinda mejoras para el empaquetamiento, las pruebas, la experiencia del desarrollador, las herramientas, la depuracin y la verificacin de tipos. Toda una buena coleccin de caractersticas.\n\n## Recursos relacionados\n\n### Componentes con carga lenta\n\n[Informacin sobre los mdulos de presentacin en la charla \"Angular revisited: Tree-shakable components and optional NgModules\"](https://youtu.be/DA3efofhpq4).\n\n[Aprende a usar los componentes de carga diferida en \"Lazy load components in Angular\" por Kevin Kreuzer](https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8).\n\n### Comprobacin de tipos en plantillas\n\n[Lee la gua oficial sobre la verificacin de tipos en plantillas Angular para conocer los detalles de la resolucin de problemas y la configuracin](https://angular.io/guide/template-typecheck#troubleshooting-template-errors).\n\n### Globalizacin\n\n[Manfred Steyer analiza las configuraciones regionales de carga diferida en \"Lazy Loading Locales with Angular\"](https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/).\n\n[Cdric Exbrayat analiza la globalizacin de _Ivy_ en \"Internationalization with @angular/localize\"](https://blog.ninja-squad.com/2019/12/10/angular-localize/).\n\n### mbitos adicionales de proveedor de dependencias\n\nObtn informacin sobre los mbitos de proveedor de `'any'` y `'platform'` en [Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler](https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb).\n\n### Nueva API de depuracin\n[Lee sobre la API de depuracin completa en la documentacin oficial](https://angular.io/api/core/global).\n\n### Angular Universal versin 9\n\nEstos dos artculos entran en detalles de Angular Universal versin 9:\n\n-   [Angular Universal v9: Whats New ? by Mark Pieszak](https://trilon.io/blog/angular-universal-v9-whats-new)\n-   [Angular v9 & Universal: SSR and prerendering out of the box! by Sam Vloeberghs](https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1)\n\nAprende sobre `angular-prerender`, la biblioteca que inspir estas nuevas caractersticas de Angular Universal en [Prerender Angular Apps with a single Command by Christoph Guttandin](https://media-codings.com/articles/prerender-angular-apps-with-a-single-command).\n\n### Enlace de propiedades personalizadas de CSS\n\n[Mira este tweet y la demostracin de Alexey Zuev para ver los enlaces de Propiedades personalizadas de CSS en accin](https://twitter.com/yurzui/status/1221159415820275717).\n\n## Revisores\n\nSiempre es til tener una segunda opinin sobre nuestro trabajo o incluso detectar errores tontos. Para este artculo el autor tuvo el placer de ser revisado por:\n\n-   [Christoph Guttandin](https://twitter.com/chrisguttandin)\n-   [Evgeny Fedorenko](https://indepth.dev/author/evgeny/)\n-   [Santosh Yadav](https://dev.to/santoshyadav198613)\n\nCover photo by [Pixabay](https://www.pexels.com/photo/light-new-year-s-eve-fireworks-sylvester-40663/) on Pexels.\n\nEl autor original: [Lars Gyrup Brink Nielsen](https://twitter.com/LayZeeDK)\n\nEl traductor al espaol: [Alberto Basalo](https://twitter.com/albertobasalo)\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","slug":"un-vistazo-a-las-caractersticas-principales-en-el-lanzamiento-de-Angular-Ivy-versin-9","published":1,"updated":"2020-02-24T15:34:09.788Z","_id":"ck70mab13000ebss30ziy72qu","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/light-new-year-s-eve-fireworks-sylvester-40663.jpg\" alt=\"un-vistazo-a-las-caractersticas-principales-en-el-lanzamiento-de-Angular-Ivy-versin-9\"></p><p>Este artculo es una traduccin aprobada por el autor, <a href=\"https://twitter.com/LayZeeDK\" target=\"_blank\" rel=\"noopener\">Lars Gyrup Brink Nielsen</a>, y editor originales.</p><p>Enlace original en ingls <a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/\" target=\"_blank\" rel=\"noopener\">A look at major features in the Angular Ivy version 9 release</a> del 6 de febrero de 2020</p><p>En resumen con Angular 9 tenemos cambios. MUCHOS y en todas partes: globalizacin dinmica, modo estricto, <em>Bazel</em> y mucho ms.</p><p><em>(Y s, ahora por fin se ha lanzado <strong>Angular Ivy versin 9</strong>)</em></p><a id=\"more\"></a><h2 id=\"Ivy-esta-habilitado-por-defecto\"><a href=\"#Ivy-esta-habilitado-por-defecto\" class=\"headerlink\" title=\"Ivy est habilitado por defecto\"></a><em>Ivy</em> est habilitado por defecto</h2><p>En versiones anteriores de Angular, tuvimos que optar por <em>Ivy</em>. En la versin 9, tenemos que optar por no usar <em>Ivy</em> si queremos quedarnos con View Engine. Esto es posible en las versiones 9 y la futura 10 para garantizar una transicin ms fluida de <em>View Engine</em> a <em>Ivy</em>.</p><p>Las libreras <em>se pueden</em> compilar AOT, pero no es recomendable. El equipo de Angular tiene un plan de migracin de <em>View Engine</em> a <em>Ivy</em> que recomienda publicar solo libreras compatibles con <em>View Engine</em> compiladas con JIT para Angular versin 9. El compilador de compatibilidad Angular actualizar las libreras compatibles con <em>View Engine</em> a <em>Ivy</em> cuando se instalen en una aplicacin Angular <em>Ivy</em>.</p><p>Obtn informacin sobre la compatibilidad de la biblioteca y el plan de transicin de <code>View Engine-to-Ivy</code> en <a href=\"https://indepth.dev/the-angular-ivy-guide-for-library-authors/\" target=\"_blank\" rel=\"noopener\">La gua de Angular <em>Ivy</em> para autores de libreras</a> .</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"attr\">\"angularCompilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"attr\">\"enableIvy\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// polyfills.ts</span></span><br><span class=\"line\"><span class=\"comment\">// Solo se usa en aplicaciones multilinges de Ivy</span></span><br><span class=\"line\"><span class=\"comment\">// import '@angular/localize/init';</span></span><br></pre></td></tr></table></figure><p><em>Listado 1. Optar por no usar <em>Ivy</em> para recurrir a <em>View Engine</em>.</em></p><p>Si tienes problemas con <em>Ivy</em> en tu aplicacin, o en cualquiera de las libreras de las que depende, puedes optar por salir de <em>Ivy</em> y volver a <em>View Engine</em>. Hazlo desactivando la opcin del compilador angular <code>enableIvy</code> y deshabilitando<code>@angular/localize</code> como se ve en Listado 1.</p><p>Optar por evitar <em>Ivy</em> en un entorno de servidor es un poco ms complicado. <a href=\"https://angular.io/guide/ivy#using-ssr-without-ivy\" target=\"_blank\" rel=\"noopener\">Sigue la gua oficial para darte de baja de <em>Ivy</em> cuando uses la renderizacin del lado del servidor</a>.</p><h2 id=\"El-principio-de-localidad\"><a href=\"#El-principio-de-localidad\" class=\"headerlink\" title=\"El principio de localidad\"></a>El principio de localidad</h2><p>Antes, para compilar un componente en <em>View Engine</em>, Angular necesitaba informacin sobre todas sus dependencias declaradas. Esto significa que las libreras Angular no se pueden compilar AOT usando <em>View Engine</em>.</p><p>Ahora para compilar un componente en <em>Ivy</em>, Angular solo necesita informacin sobre el componente en s. Pero, <em>Ivy</em> no necesita metadatos de ninguna dependencia declarable para compilar un componente.</p><p>El principio de localidad significa que, en general, veremos tiempos de construccin ms rpidos.</p><h3 id=\"Componentes-con-carga-diferida\"><a href=\"#Componentes-con-carga-diferida\" class=\"headerlink\" title=\"Componentes con carga diferida\"></a>Componentes con carga diferida</h3><p>Las declaraciones <code>entryComponents</code> estn en desuso porque ya no son necesarias. Cualquier componente <em>Ivy</em> puede cargarse de forma diferida y renderizarse dinmicamente.</p><p>Esto significa que ahora podemos cargar de forma diferida y renderizar un componente sin enrutamiento o mdulos Angular. Sin embargo, en la prctica an tenemos que usar mdulos para renderizar componentes o mdulos funcionales para vincular la plantilla de un componente a sus dependencias.</p><p>Las libreras que solo son utilizadas por un componente con carga diferida se agrupan en fragmentos con carga diferida.</p><h2 id=\"Mejoras-en-la-carga-diferencial\"><a href=\"#Mejoras-en-la-carga-diferencial\" class=\"headerlink\" title=\"Mejoras en la carga diferencial\"></a>Mejoras en la carga diferencial</h2><p>Cuando se introdujo la carga diferencial en Angular versin 8, el proceso de compilacin se ejecutaba una vez para el paquete ES5 y otra vez para el paquete ES2015+.</p><p>En Angular versin 9, primero se emite un paquete ES2015+. Ese paquete se transfiere a un paquete ES5 separado. De esta manera, no tenemos que pasar por un proceso de compilacin completo dos veces.</p><h2 id=\"Compilacion-AOT-en-todas-partes\"><a href=\"#Compilacion-AOT-en-todas-partes\" class=\"headerlink\" title=\"Compilacin AOT en todas partes\"></a>Compilacin AOT en todas partes</h2><p>AOT est habilitado de forma predeterminada en las compilaciones, el servidor de desarrollo e incluso en las pruebas. Anteriormente, la compilacin AOT era significativamente ms lenta que la compilacin JIT, por lo que JIT se usaba para el desarrollo y las pruebas. Con las mejoras de tiempo de construccin y reconstruccin en Ivy, la compilacin AOT ahora ofrece una gran experiencia al desarrollador.</p><p>Cuando utilizbamos la compilacin JIT en desarrollo y solo la compilacin AOT en la compilacin final, algunos errores se detectaban solo al hacer compilaciones de produccin o, peor an, en tiempo de ejecucin.</p><h2 id=\"Tamanos-de-paquete\"><a href=\"#Tamanos-de-paquete\" class=\"headerlink\" title=\"Tamaos de paquete\"></a>Tamaos de paquete</h2><p>Ivy puede habilitar paquetes ms pequeos porque usa el <em>Ivy Instruction Set</em>, que es un conjunto de instrucciones de representacin de tiempo de ejecucin potencialmente <em>tree-shakable</em>. Nuestros paquetes solo incluirn las instrucciones de renderizado que realmente usamos en nuestros proyectos.</p><p>Esto es ideal para casos de uso como <em>micro-frontends</em>, Angular Elements y aplicaciones web donde Angular no controla todo el documento.</p><p>Sin embargo, la diferencia en los tamaos de nuestros paquetes entre <em>View Engine</em> e <em>Ivy</em> variar segn el tamao de nuestra aplicacin y las libreras de terceros que utilizamos. En general:</p><ul><li>Las aplicaciones pequeas y simples vern una disminucin considerable del peso del paquete.</li><li>Las aplicaciones complejas vern un aumento en el fichero principal, pero una disminucin en los tamaos de paquetes con carga diferida.</li></ul><p>Esto significa una disminucin considerable del tamao de descarga combinada para aplicaciones grandes, pero podra significar un aumento en el peso total para aplicaciones medianas. En ambos casos, el tamao del paquete principal probablemente aumentar, lo que es malo para el tiempo de carga inicial de la pgina.</p><h2 id=\"Globalizacion\"><a href=\"#Globalizacion\" class=\"headerlink\" title=\"Globalizacin\"></a>Globalizacin</h2><p>Las configuraciones regionales (formato de nmero, formato de fecha y otras configuraciones regionales) se pueden cargar dinmicamente en tiempo de ejecucin en lugar de tener que registrarse en tiempo de compilacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// main.ts</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'@angular/localize/init'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; loadTranslations &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/localize'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">loadTranslations (&#123;</span><br><span class=\"line\"><span class=\"string\">'8374172394781134519'</span>: <span class=\"string\">'Hola, &#123;$nombre de usuario&#125;! Bienvenido a &#123;$appName&#125;. '</span>,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p><em>Listado 2. Carga dinmica de traducciones.</em></p><p>Como se ve en el Listado 2, los textos traducidos tambin se pueden cargar dinmicamente en tiempo de ejecucin en lugar de ser parte de nuestros paquetes.</p><p>Los textos traducidos pueden cargarse desde una base de datos o un archivo.</p><h3 id=\"Multiples-idiomas-desde-un-unico-paquete-de-aplicaciones\"><a href=\"#Multiples-idiomas-desde-un-unico-paquete-de-aplicaciones\" class=\"headerlink\" title=\"Mltiples idiomas desde un nico paquete de aplicaciones\"></a>Mltiples idiomas desde un nico paquete de aplicaciones</h3><p>Para cambiar el idioma, tenemos que reiniciar la aplicacin, pero no tenemos que servir un fichero de aplicaciones diferente.</p><p>Esto significa que podemos, con alguna configuracin, admitir varios idiomas con un solo paquete de aplicaciones en un solo nombre de host.</p><h3 id=\"Tiempo-de-compilacion-en-linea\"><a href=\"#Tiempo-de-compilacion-en-linea\" class=\"headerlink\" title=\"Tiempo de compilacin en lnea\"></a>Tiempo de compilacin en lnea</h3><p>Una aplicacin localizada ahora solo se compilar una vez. En lugar de mltiples compilaciones para producir un paquete por idioma, se produce un paquete por idioma reemplazando los marcadores de posicin <code>$localize</code> con textos traducidos.</p><p>Ahora hay que agregar el paquete <code>@angular/localize</code> para posibilitar la localizacin (varios idiomas). La buena noticia es que ya no tenemos que incluir el cdigo de localizacin de Angular en nuestros paquetes si solo tenemos un idioma.</p><p>Si no usamos plantillas localizadas, las instrucciones de <em>Ivy</em> <code>i18n *</code> se sacan del paquete principal.</p><h3 id=\"Textos-localizables-en-modelos-de-componentes-y-servicios\"><a href=\"#Textos-localizables-en-modelos-de-componentes-y-servicios\" class=\"headerlink\" title=\"Textos localizables en modelos de componentes y servicios\"></a>Textos localizables en modelos de componentes y servicios</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.component.ts</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  template: <span class=\"string\">'&#123;&#123; title &#125;&#125;'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;</span><br><span class=\"line\">  title = $localize<span class=\"string\">`Welcome to MyApp`</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 3. Un marcador de posicin de texto de traduccin en un modelo de componente.</em></p><p>Una nueva caracterstica de internacionalizacin es que tambin podemos incluir marcadores de posicin para textos traducidos en el contenido de nuestros modelos como se ve en el Listado 3. Anteriormente, esto solo era posible en las plantillas.</p><h2 id=\"Ambitos-adicionales-de-proveedores-de-dependencias\"><a href=\"#Ambitos-adicionales-de-proveedores-de-dependencias\" class=\"headerlink\" title=\"mbitos adicionales de proveedores de dependencias\"></a>mbitos adicionales de proveedores de dependencias</h2><p>Siempre hemos tenido alcance de mdulo para los proveedores de inyeccin de servicios. La versin Angular 6 introdujo el alcance <code>&#39;root&#39;</code> y los proveedores <em>tree-shakable</em>, tanto para los proveedores de alcance desde el mdulo raz como desde mdulos inferiores.</p><p>La versin angular 9 presenta los nuevos mbitos de proveedor <code>&#39;platform&#39;</code> y <code>&#39;any&#39;</code>. Los proveedores con mbito de <code>&#39;platform&#39;</code> se pueden compartir entre mltiples aplicaciones Angular en el mismo documento. El alcance del proveedor <code>&#39;any&#39;</code> compartir un proveedor por inyector de mdulo. Por ejemplo, una instancia de servicio para el paquete principal cargado por adelantado y una instancia de servicio para cada mdulo cargado con retraso.</p><h2 id=\"Experiencia-mejorada-del-desarrollador\"><a href=\"#Experiencia-mejorada-del-desarrollador\" class=\"headerlink\" title=\"Experiencia mejorada del desarrollador\"></a>Experiencia mejorada del desarrollador</h2><p>Ivy permite que <em>Angular Language Service</em> admita comprobaciones adicionales durante el desarrollo. Esta es una gran mejora para la experiencia del desarrollador.</p><h3 id=\"Comprobaciones-de-ruta-de-archivo\"><a href=\"#Comprobaciones-de-ruta-de-archivo\" class=\"headerlink\" title=\"Comprobaciones de ruta de archivo\"></a>Comprobaciones de ruta de archivo</h3><p><em>Angular Language Service</em> verifica continuamente la hoja de estilo de componentes y las rutas de plantilla.</p><h3 id=\"Verificaciones-de-tipo-de-plantilla\"><a href=\"#Verificaciones-de-tipo-de-plantilla\" class=\"headerlink\" title=\"Verificaciones de tipo de plantilla\"></a>Verificaciones de tipo de plantilla</h3><p>Las plantillas se verifican por tipo, de acuerdo con el modo de verificacin de tipo de plantilla como se describe ms abajo en la seccin Modo estricto. Los nombres y tipos de miembros se verifican, incluso en vistas incrustadas. Lo que anteriormente resultaba en errores de tiempo de ejecucin ahora se detecta durante el desarrollo y la construccin.</p><h2 id=\"Nueva-API-de-depuracion-en-modo-de-desarrollo\"><a href=\"#Nueva-API-de-depuracion-en-modo-de-desarrollo\" class=\"headerlink\" title=\"Nueva API de depuracin en modo de desarrollo\"></a>Nueva API de depuracin en modo de desarrollo</h2><p><code>ng.probe</code> ha sido reemplazado por una nueva API de depuracin en modo de desarrollo. Las funciones ms notables son <code>ng.applyChanges</code> y<code>ng.getComponent</code>.</p><h2 id=\"Modo-estricto\"><a href=\"#Modo-estricto\" class=\"headerlink\" title=\"Modo estricto\"></a>Modo estricto</h2><h3 id=\"Esquema-estricto-del-espacio-de-trabajo\"><a href=\"#Esquema-estricto-del-espacio-de-trabajo\" class=\"headerlink\" title=\"Esquema estricto del espacio de trabajo\"></a>Esquema estricto del espacio de trabajo</h3><p>El comando <code>ng new</code> ahora es compatible con el indicador<code>--strict</code> que por defecto est desactivado (<code>false</code>).</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new my-app --strict</span><br></pre></td></tr></table></figure><p>Cuando est habilitado, este parmetro agrega algunas comprobaciones estrictas del compilador TypeScript como se ve en el Listado 4.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"attr\">\"compilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitAny\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitReturns\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitThis\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noFallthroughCasesInSwitch\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"strictlyNullChecks\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 4. Opciones del compilador TypeScript habilitadas en un estricto espacio de trabajo angular.</em></p><p>Curiosamente, esto no agrega las mismas opciones que si simplemente estableciramos <code>&quot;strict&quot;: true</code> en el objeto <code>compilerOptions</code>. Comparemos la opcin estricta del <em>workspace</em> Angular con la opcin estricta del compilador TypeScript.</p><p>Ambos tienen estas opciones en comn:</p><ul><li><code>noImplicitAny</code></li><li><code>noImplicitThis</code></li><li><code>strictlyNullChecks</code></li></ul><p>La opcin estricta de Angular establece adems estas opciones:</p><ul><li><code>noImplicitReturns</code></li><li><code>noFallthroughCasesInSwitch</code></li></ul><p>mientras que la opcin estricta del compilador TypeScript establece adicionalmente estas opciones:</p><ul><li><code>alwaysStrict</code></li><li><code>strictlyBindCallApply</code></li><li><code>strictlyFunctionTypes</code></li><li><code>estrictoPropertyInitialization</code></li></ul><p>Adems, la opcin de Angular no establece la comprobacin del tipo de plantilla en el nuevo modo estricto, lo deja en el modo <code>&#39;full&#39;</code> anterior.</p><h3 id=\"Verificacion-estricta-del-tipo-de-plantilla\"><a href=\"#Verificacion-estricta-del-tipo-de-plantilla\" class=\"headerlink\" title=\"Verificacin estricta del tipo de plantilla\"></a>Verificacin estricta del tipo de plantilla</h3><p>Hemos tenido la opcin de habilitar la verificacin del tipo de plantilla desde Angular versin 5 configurando <code>&quot;fullTemplateTypeCheck&quot;:true</code> en el objeto<code>angularCompilerOptions</code>.</p><p>Ivy presenta una estricta comprobacin del tipo de plantilla como se ve en el Listado 5. Cuando se establece esta nueva opcin del compilador Angular, se ignora el valor de <code>fullTemplateTypeCheck</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// tsconfig.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"string\">\"angularCompilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"string\">\"strictTemplates\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 5. Habilita la comprobacin estricta del tipo de plantilla.</em></p><p>La comprobacin de tipo de plantilla estricta verifica los tipos de enlaces de propiedades y respeta la opcin <code>stricNullChecks</code>. Tambin verifica los tipos de referencias de plantilla a directivas y componentes, incluidos los tipos genricos. Tambin se verifican los tipos de variables de contexto de plantilla, lo cual es excelente para los bucles <code>NgFor</code>. El tipo <code>$ event</code> est marcado para enlaces de eventos y animaciones. Incluso el tipo de elementos DOM nativos se verifica con una comprobacin estricta del tipo de plantilla.</p><p>Estas comprobaciones adicionales pueden conducir a errores y falsos positivos bajo ciertas circunstancias. Por ejemplo, cuando se usan libreras que no estn compiladas con <code>strictNullChecks</code>. Para abordar esto, la verificacin estricta del tipo de plantilla tiene opciones para optar por no participar y ajustar los controles. Por ejemplo, <code>strictTemplates</code> es en realidad una atajo de 8 opciones de compilador Angular.</p><h2 id=\"Herencia-de-clase-de-componente-y-directiva-mejorada\"><a href=\"#Herencia-de-clase-de-componente-y-directiva-mejorada\" class=\"headerlink\" title=\"Herencia de clase de componente y directiva mejorada\"></a>Herencia de clase de componente y directiva mejorada</h2><p>Las clases base sin selector ahora son compatibles con directivas y componentes. Algunos metadatos ahora se heredan de componentes base y clases directivas. Esto hace que sea ms fcil extender, por ejemplo, las directivas Angular Components y Angular Router.</p><h2 id=\"Ultimas-versiones-de-TypeScript\"><a href=\"#Ultimas-versiones-de-TypeScript\" class=\"headerlink\" title=\"ltimas versiones de TypeScript\"></a>ltimas versiones de TypeScript</h2><p>Las versiones de TypeScript 3.6 y 3.7 son compatibles con la versin angular 9. Las versiones anteriores de TypeScript ya no son compatibles. Consulta la Tabla 1 para comparar la compatibilidad de TypeScript entre<br>todas las versiones Angular.</p><p><a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support.csv\" target=\"_blank\" rel=\"noopener\">vista bruta</a><br><a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv\" target=\"_blank\" rel=\"noopener\">descargable angular-cli-node-js-typescript-support.csv</a> hosted with  by <a href=\"https://github.com/\" target=\"_blank\" rel=\"noopener\">GitHub</a></p><p><em>Tabla 1. Tabla de compatibilidad del Angular CLI, Angular, Node.js y TypeScript.</em> <a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3\" target=\"_blank\" rel=\"noopener\"><em>Abrir en una pestaa nueva</em></a>*</p><p>TypeScript versin 3.6 presenta estas y otras caractersticas:</p><ul><li>Soporte Unicode para identificadores en destinos modernos</li><li>Experiencia de desarrollador mejorada para promesas</li><li>Comprobacin de tipo ms estricto de generadores</li></ul><p>TypeScript versin 3.7 presenta estas y otras caractersticas que podemos usar con Angular versin 9:</p><ul><li>Operador de encadenamiento opcional (<code>?.</code>) similar al operador de navegacin segura para plantillas Angular</li><li>Operador de unin con nulos (<code>??</code>)</li><li>Funciones de afirmacin de pruebas (<code>assert parameterName is typeName</code> y <code>asserts parameterName</code>)</li><li><code>await</code> de primer nivel</li><li>Alias de tipo recursivo mejorado</li><li>Mejora de la experiencia del desarrollador para funciones de comprobaciones</li></ul><h2 id=\"Generacion-mejorada-del-lado-del-servidor-con-Angular-Universal\"><a href=\"#Generacion-mejorada-del-lado-del-servidor-con-Angular-Universal\" class=\"headerlink\" title=\"Generacin mejorada del lado del servidor con Angular Universal\"></a>Generacin mejorada del lado del servidor con Angular Universal</h2><p>Angular Universal versin 9 se lanza con un servidor de desarrollo Node.js Express para proporcionar un entorno realista durante el desarrollo.</p><p>Tambin parte de este lanzamiento es un constructor del CLI para pre-renderizar rutas estticas usando <code>guess-parser</code>, inspirado en <code>angular-prerender</code>. Podemos pasar un archivo de rutas para renderizar rutas dinmicas (rutas con parmetros).</p><h3 id=\"Como-empiezo\"><a href=\"#Como-empiezo\" class=\"headerlink\" title=\"Cmo empiezo?\"></a>Cmo empiezo?</h3><p>Podemos agregar Angular Universal usando el comando <code>ng add @nguniversal/express-engine</code>. Luego podemos usar el comando del constructor <code>ng run myapp:serve-ssr</code> para iniciar el servidor de desarrollo de renderizado del lado del servidor con recarga en vivo. De manera similar, podemos usar <code>ng run myapp:prerender</code> para detectar rutas estticas y dinmicas y pre renderizarlas.</p><h2 id=\"Experiencia-de-clases-y-estilo-mejorada\"><a href=\"#Experiencia-de-clases-y-estilo-mejorada\" class=\"headerlink\" title=\"Experiencia de clases y estilo mejorada\"></a>Experiencia de clases y estilo mejorada</h2><p>Al aplicacin de estilo en Angular <em>Ivy</em> ha sido reelaborado. La combinacin de clases HTML estticas con las directivas <code>NgStyle</code> y<code>NgClass</code> es ahora totalmente compatible y ms fcil de entender.</p><h3 id=\"Soporte-de-propiedades-personalizadas-de-CSS\"><a href=\"#Soporte-de-propiedades-personalizadas-de-CSS\" class=\"headerlink\" title=\"Soporte de propiedades personalizadas de CSS\"></a>Soporte de propiedades personalizadas de CSS</h3><p>Como parte de la reescritura del estilo Ivy, ahora se admiten las propiedades personalizadas de CSS enlazadas.</p><p>Un ejemplo de enlace css puede ser as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">style.--my-var</span>]=<span class=\"string\">\"myProperty || 'any value'\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Las propiedades personalizadas de CSS tienen control de alcance, por lo que esta propiedad de CSS se limitara al DOM del componente.</p><h2 id=\"Lanzamiento-estable-de-Bazel-como-opcion-de-suscripcion\"><a href=\"#Lanzamiento-estable-de-Bazel-como-opcion-de-suscripcion\" class=\"headerlink\" title=\"Lanzamiento estable de Bazel como opcin de suscripcin\"></a>Lanzamiento estable de Bazel como opcin de suscripcin</h2><p>Bazel versin 2.1 es una herramienta de automatizacin de compilacin opcional para Angular versin 9.</p><h3 id=\"Como-empiezo-1\"><a href=\"#Como-empiezo-1\" class=\"headerlink\" title=\"Cmo empiezo?\"></a>Cmo empiezo?</h3><p>Para habilitar Bazel, usa <code>ng add @angular/bazel</code> o la coleccin de esquemas <code>@angular/bazel</code> cuando generes un espacio de trabajo Angular.</p><p>Asegrate de seguir <a href=\"https://docs.bazel.build/versions/2.0.0/install.html\" target=\"_blank\" rel=\"noopener\">la gua de instalacin de Bazel</a> para tu sistema operativo.</p><h2 id=\"Angular-Components\"><a href=\"#Angular-Components\" class=\"headerlink\" title=\"Angular Components\"></a>Angular Components</h2><p>La versin Angular 9 viene con componentes oficiales para YouTube y Google Maps. Se agreg una directiva y un servicio de portapapeles al Angular CDK.</p><h2 id=\"Pruebas\"><a href=\"#Pruebas\" class=\"headerlink\" title=\"Pruebas\"></a>Pruebas</h2><p>La mayor sorpresa de la versin Angular versin 9 son las muchas mejoras en las pruebas. Se resuelven problemas de rendimiento, se mejoran los tipos y se introducen nuevos conceptos.</p><p><a href=\"https://indepth.dev/next-level-testing-in-angular-ivy-version-9/\" target=\"_blank\" rel=\"noopener\">Obtn informacin sobre las principales caractersticas y mejoras para las pruebas en Pruebas de siguiente nivel en Angular <em>Ivy</em> versin 9</a>.</p><h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusin\"></a>Conclusin</h2><p>Uno de los objetivos ms importantes ha sido mantener la compatibilidad hacia atrs entre <em>Ivy</em> y <em>View Engine</em> tanto como fue posible.</p><p>Por supuesto, la versin Angular 9 tambin incluye correcciones de errores, temas obsoletos y cambios importantes. <em>Ivy</em> tambin aborda algunos problemas de antiguos que no cubrimos en este artculo.</p><p>Angular <em>Ivy</em> es un facilitador para las caractersticas que estn por venir. Como hemos discutido en este artculo, <em>Ivy</em> ya nos ha dado beneficios para diferentes casos de uso. Sin embargo, las mejores caractersticas llegarn en futuras versiones de Angular. Cul de las posibles caractersticas que se entregarn en las versiones 10 y 11 de Angular est por decidir?</p><p>Solo discutimos qu es parte de las API pblicas y estables de Angular versin 9. Algunas API experimentales son parte de esta versin, como <code>renderComponent</code>,<code>markDirty</code> y <code>detectChanges</code>. Sin embargo, todava estn sujetos a cambios.</p><p>Con la retirada de las declaraciones de componentes de entrada y los componentes con carga diferida utilizando mdulos de representacin, estamos un paso ms cerca de tener <a href=\"https://indepth.dev/angular-revisited-tree-shakable-components-and-optional-ngmodules/\" target=\"_blank\" rel=\"noopener\">componentes que se pueden eliminar del rbol y mdulos Angular opcionales</a>.</p><p><a href=\"https://indepth.dev/component-features-with-angular-ivy/\" target=\"_blank\" rel=\"noopener\">Los componentes de funcionalidad</a> tambin forman parte de esta versin, pero solo estn expuestos para uso interno de <em>Ivy</em>.</p><p>La versin de Angular <em>Ivy</em> versin 9 nos brinda mejoras para el empaquetamiento, las pruebas, la experiencia del desarrollador, las herramientas, la depuracin y la verificacin de tipos. Toda una buena coleccin de caractersticas.</p><h2 id=\"Recursos-relacionados\"><a href=\"#Recursos-relacionados\" class=\"headerlink\" title=\"Recursos relacionados\"></a>Recursos relacionados</h2><h3 id=\"Componentes-con-carga-lenta\"><a href=\"#Componentes-con-carga-lenta\" class=\"headerlink\" title=\"Componentes con carga lenta\"></a>Componentes con carga lenta</h3><p><a href=\"https://youtu.be/DA3efofhpq4\" target=\"_blank\" rel=\"noopener\">Informacin sobre los mdulos de presentacin en la charla Angular revisited: Tree-shakable components and optional NgModules</a>.</p><p><a href=\"https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8\" target=\"_blank\" rel=\"noopener\">Aprende a usar los componentes de carga diferida en Lazy load components in Angular por Kevin Kreuzer</a>.</p><h3 id=\"Comprobacion-de-tipos-en-plantillas\"><a href=\"#Comprobacion-de-tipos-en-plantillas\" class=\"headerlink\" title=\"Comprobacin de tipos en plantillas\"></a>Comprobacin de tipos en plantillas</h3><p><a href=\"https://angular.io/guide/template-typecheck#troubleshooting-template-errors\" target=\"_blank\" rel=\"noopener\">Lee la gua oficial sobre la verificacin de tipos en plantillas Angular para conocer los detalles de la resolucin de problemas y la configuracin</a>.</p><h3 id=\"Globalizacion-1\"><a href=\"#Globalizacion-1\" class=\"headerlink\" title=\"Globalizacin\"></a>Globalizacin</h3><p><a href=\"https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/\" target=\"_blank\" rel=\"noopener\">Manfred Steyer analiza las configuraciones regionales de carga diferida en Lazy Loading Locales with Angular</a>.</p><p><a href=\"https://blog.ninja-squad.com/2019/12/10/angular-localize/\" target=\"_blank\" rel=\"noopener\">Cdric Exbrayat analiza la globalizacin de <em>Ivy</em> en Internationalization with @angular/localize</a>.</p><h3 id=\"Ambitos-adicionales-de-proveedor-de-dependencias\"><a href=\"#Ambitos-adicionales-de-proveedor-de-dependencias\" class=\"headerlink\" title=\"mbitos adicionales de proveedor de dependencias\"></a>mbitos adicionales de proveedor de dependencias</h3><p>Obtn informacin sobre los mbitos de proveedor de <code>&#39;any&#39;</code> y <code>&#39;platform&#39;</code> en <a href=\"https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb\" target=\"_blank\" rel=\"noopener\">Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler</a>.</p><h3 id=\"Nueva-API-de-depuracion\"><a href=\"#Nueva-API-de-depuracion\" class=\"headerlink\" title=\"Nueva API de depuracin\"></a>Nueva API de depuracin</h3><p><a href=\"https://angular.io/api/core/global\" target=\"_blank\" rel=\"noopener\">Lee sobre la API de depuracin completa en la documentacin oficial</a>.</p><h3 id=\"Angular-Universal-version-9\"><a href=\"#Angular-Universal-version-9\" class=\"headerlink\" title=\"Angular Universal versin 9\"></a>Angular Universal versin 9</h3><p>Estos dos artculos entran en detalles de Angular Universal versin 9:</p><ul><li><a href=\"https://trilon.io/blog/angular-universal-v9-whats-new\" target=\"_blank\" rel=\"noopener\">Angular Universal v9: Whats New ? by Mark Pieszak</a></li><li><a href=\"https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1\" target=\"_blank\" rel=\"noopener\">Angular v9 &amp; Universal: SSR and prerendering out of the box! by Sam Vloeberghs</a></li></ul><p>Aprende sobre <code>angular-prerender</code>, la biblioteca que inspir estas nuevas caractersticas de Angular Universal en <a href=\"https://media-codings.com/articles/prerender-angular-apps-with-a-single-command\" target=\"_blank\" rel=\"noopener\">Prerender Angular Apps with a single Command by Christoph Guttandin</a>.</p><h3 id=\"Enlace-de-propiedades-personalizadas-de-CSS\"><a href=\"#Enlace-de-propiedades-personalizadas-de-CSS\" class=\"headerlink\" title=\"Enlace de propiedades personalizadas de CSS\"></a>Enlace de propiedades personalizadas de CSS</h3><p><a href=\"https://twitter.com/yurzui/status/1221159415820275717\" target=\"_blank\" rel=\"noopener\">Mira este tweet y la demostracin de Alexey Zuev para ver los enlaces de Propiedades personalizadas de CSS en accin</a>.</p><h2 id=\"Revisores\"><a href=\"#Revisores\" class=\"headerlink\" title=\"Revisores\"></a>Revisores</h2><p>Siempre es til tener una segunda opinin sobre nuestro trabajo o incluso detectar errores tontos. Para este artculo el autor tuvo el placer de ser revisado por:</p><ul><li><a href=\"https://twitter.com/chrisguttandin\" target=\"_blank\" rel=\"noopener\">Christoph Guttandin</a></li><li><a href=\"https://indepth.dev/author/evgeny/\" target=\"_blank\" rel=\"noopener\">Evgeny Fedorenko</a></li><li><a href=\"https://dev.to/santoshyadav198613\" target=\"_blank\" rel=\"noopener\">Santosh Yadav</a></li></ul><p>Cover photo by <a href=\"https://www.pexels.com/photo/light-new-year-s-eve-fireworks-sylvester-40663/\" target=\"_blank\" rel=\"noopener\">Pixabay</a> on Pexels.</p><p>El autor original: <a href=\"https://twitter.com/LayZeeDK\" target=\"_blank\" rel=\"noopener\">Lars Gyrup Brink Nielsen</a></p><p>El traductor al espaol: <a href=\"https://twitter.com/albertobasalo\" target=\"_blank\" rel=\"noopener\">Alberto Basalo</a></p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/light-new-year-s-eve-fireworks-sylvester-40663.jpg\" alt=\"un-vistazo-a-las-caractersticas-principales-en-el-lanzamiento-de-Angular-Ivy-versin-9\"></p><p>Este artculo es una traduccin aprobada por el autor, <a href=\"https://twitter.com/LayZeeDK\" target=\"_blank\" rel=\"noopener\">Lars Gyrup Brink Nielsen</a>, y editor originales.</p><p>Enlace original en ingls <a href=\"https://indepth.dev/a-look-at-major-features-in-the-angular-ivy-version-9-release/\" target=\"_blank\" rel=\"noopener\">A look at major features in the Angular Ivy version 9 release</a> del 6 de febrero de 2020</p><p>En resumen con Angular 9 tenemos cambios. MUCHOS y en todas partes: globalizacin dinmica, modo estricto, <em>Bazel</em> y mucho ms.</p><p><em>(Y s, ahora por fin se ha lanzado <strong>Angular Ivy versin 9</strong>)</em></p>","more":"<h2 id=\"Ivy-esta-habilitado-por-defecto\"><a href=\"#Ivy-esta-habilitado-por-defecto\" class=\"headerlink\" title=\"Ivy est habilitado por defecto\"></a><em>Ivy</em> est habilitado por defecto</h2><p>En versiones anteriores de Angular, tuvimos que optar por <em>Ivy</em>. En la versin 9, tenemos que optar por no usar <em>Ivy</em> si queremos quedarnos con View Engine. Esto es posible en las versiones 9 y la futura 10 para garantizar una transicin ms fluida de <em>View Engine</em> a <em>Ivy</em>.</p><p>Las libreras <em>se pueden</em> compilar AOT, pero no es recomendable. El equipo de Angular tiene un plan de migracin de <em>View Engine</em> a <em>Ivy</em> que recomienda publicar solo libreras compatibles con <em>View Engine</em> compiladas con JIT para Angular versin 9. El compilador de compatibilidad Angular actualizar las libreras compatibles con <em>View Engine</em> a <em>Ivy</em> cuando se instalen en una aplicacin Angular <em>Ivy</em>.</p><p>Obtn informacin sobre la compatibilidad de la biblioteca y el plan de transicin de <code>View Engine-to-Ivy</code> en <a href=\"https://indepth.dev/the-angular-ivy-guide-for-library-authors/\" target=\"_blank\" rel=\"noopener\">La gua de Angular <em>Ivy</em> para autores de libreras</a> .</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"attr\">\"angularCompilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"attr\">\"enableIvy\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// polyfills.ts</span></span><br><span class=\"line\"><span class=\"comment\">// Solo se usa en aplicaciones multilinges de Ivy</span></span><br><span class=\"line\"><span class=\"comment\">// import '@angular/localize/init';</span></span><br></pre></td></tr></table></figure><p><em>Listado 1. Optar por no usar <em>Ivy</em> para recurrir a <em>View Engine</em>.</em></p><p>Si tienes problemas con <em>Ivy</em> en tu aplicacin, o en cualquiera de las libreras de las que depende, puedes optar por salir de <em>Ivy</em> y volver a <em>View Engine</em>. Hazlo desactivando la opcin del compilador angular <code>enableIvy</code> y deshabilitando<code>@angular/localize</code> como se ve en Listado 1.</p><p>Optar por evitar <em>Ivy</em> en un entorno de servidor es un poco ms complicado. <a href=\"https://angular.io/guide/ivy#using-ssr-without-ivy\" target=\"_blank\" rel=\"noopener\">Sigue la gua oficial para darte de baja de <em>Ivy</em> cuando uses la renderizacin del lado del servidor</a>.</p><h2 id=\"El-principio-de-localidad\"><a href=\"#El-principio-de-localidad\" class=\"headerlink\" title=\"El principio de localidad\"></a>El principio de localidad</h2><p>Antes, para compilar un componente en <em>View Engine</em>, Angular necesitaba informacin sobre todas sus dependencias declaradas. Esto significa que las libreras Angular no se pueden compilar AOT usando <em>View Engine</em>.</p><p>Ahora para compilar un componente en <em>Ivy</em>, Angular solo necesita informacin sobre el componente en s. Pero, <em>Ivy</em> no necesita metadatos de ninguna dependencia declarable para compilar un componente.</p><p>El principio de localidad significa que, en general, veremos tiempos de construccin ms rpidos.</p><h3 id=\"Componentes-con-carga-diferida\"><a href=\"#Componentes-con-carga-diferida\" class=\"headerlink\" title=\"Componentes con carga diferida\"></a>Componentes con carga diferida</h3><p>Las declaraciones <code>entryComponents</code> estn en desuso porque ya no son necesarias. Cualquier componente <em>Ivy</em> puede cargarse de forma diferida y renderizarse dinmicamente.</p><p>Esto significa que ahora podemos cargar de forma diferida y renderizar un componente sin enrutamiento o mdulos Angular. Sin embargo, en la prctica an tenemos que usar mdulos para renderizar componentes o mdulos funcionales para vincular la plantilla de un componente a sus dependencias.</p><p>Las libreras que solo son utilizadas por un componente con carga diferida se agrupan en fragmentos con carga diferida.</p><h2 id=\"Mejoras-en-la-carga-diferencial\"><a href=\"#Mejoras-en-la-carga-diferencial\" class=\"headerlink\" title=\"Mejoras en la carga diferencial\"></a>Mejoras en la carga diferencial</h2><p>Cuando se introdujo la carga diferencial en Angular versin 8, el proceso de compilacin se ejecutaba una vez para el paquete ES5 y otra vez para el paquete ES2015+.</p><p>En Angular versin 9, primero se emite un paquete ES2015+. Ese paquete se transfiere a un paquete ES5 separado. De esta manera, no tenemos que pasar por un proceso de compilacin completo dos veces.</p><h2 id=\"Compilacion-AOT-en-todas-partes\"><a href=\"#Compilacion-AOT-en-todas-partes\" class=\"headerlink\" title=\"Compilacin AOT en todas partes\"></a>Compilacin AOT en todas partes</h2><p>AOT est habilitado de forma predeterminada en las compilaciones, el servidor de desarrollo e incluso en las pruebas. Anteriormente, la compilacin AOT era significativamente ms lenta que la compilacin JIT, por lo que JIT se usaba para el desarrollo y las pruebas. Con las mejoras de tiempo de construccin y reconstruccin en Ivy, la compilacin AOT ahora ofrece una gran experiencia al desarrollador.</p><p>Cuando utilizbamos la compilacin JIT en desarrollo y solo la compilacin AOT en la compilacin final, algunos errores se detectaban solo al hacer compilaciones de produccin o, peor an, en tiempo de ejecucin.</p><h2 id=\"Tamanos-de-paquete\"><a href=\"#Tamanos-de-paquete\" class=\"headerlink\" title=\"Tamaos de paquete\"></a>Tamaos de paquete</h2><p>Ivy puede habilitar paquetes ms pequeos porque usa el <em>Ivy Instruction Set</em>, que es un conjunto de instrucciones de representacin de tiempo de ejecucin potencialmente <em>tree-shakable</em>. Nuestros paquetes solo incluirn las instrucciones de renderizado que realmente usamos en nuestros proyectos.</p><p>Esto es ideal para casos de uso como <em>micro-frontends</em>, Angular Elements y aplicaciones web donde Angular no controla todo el documento.</p><p>Sin embargo, la diferencia en los tamaos de nuestros paquetes entre <em>View Engine</em> e <em>Ivy</em> variar segn el tamao de nuestra aplicacin y las libreras de terceros que utilizamos. En general:</p><ul><li>Las aplicaciones pequeas y simples vern una disminucin considerable del peso del paquete.</li><li>Las aplicaciones complejas vern un aumento en el fichero principal, pero una disminucin en los tamaos de paquetes con carga diferida.</li></ul><p>Esto significa una disminucin considerable del tamao de descarga combinada para aplicaciones grandes, pero podra significar un aumento en el peso total para aplicaciones medianas. En ambos casos, el tamao del paquete principal probablemente aumentar, lo que es malo para el tiempo de carga inicial de la pgina.</p><h2 id=\"Globalizacion\"><a href=\"#Globalizacion\" class=\"headerlink\" title=\"Globalizacin\"></a>Globalizacin</h2><p>Las configuraciones regionales (formato de nmero, formato de fecha y otras configuraciones regionales) se pueden cargar dinmicamente en tiempo de ejecucin en lugar de tener que registrarse en tiempo de compilacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// main.ts</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'@angular/localize/init'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; loadTranslations &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/localize'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">loadTranslations (&#123;</span><br><span class=\"line\"><span class=\"string\">'8374172394781134519'</span>: <span class=\"string\">'Hola, &#123;$nombre de usuario&#125;! Bienvenido a &#123;$appName&#125;. '</span>,</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p><em>Listado 2. Carga dinmica de traducciones.</em></p><p>Como se ve en el Listado 2, los textos traducidos tambin se pueden cargar dinmicamente en tiempo de ejecucin en lugar de ser parte de nuestros paquetes.</p><p>Los textos traducidos pueden cargarse desde una base de datos o un archivo.</p><h3 id=\"Multiples-idiomas-desde-un-unico-paquete-de-aplicaciones\"><a href=\"#Multiples-idiomas-desde-un-unico-paquete-de-aplicaciones\" class=\"headerlink\" title=\"Mltiples idiomas desde un nico paquete de aplicaciones\"></a>Mltiples idiomas desde un nico paquete de aplicaciones</h3><p>Para cambiar el idioma, tenemos que reiniciar la aplicacin, pero no tenemos que servir un fichero de aplicaciones diferente.</p><p>Esto significa que podemos, con alguna configuracin, admitir varios idiomas con un solo paquete de aplicaciones en un solo nombre de host.</p><h3 id=\"Tiempo-de-compilacion-en-linea\"><a href=\"#Tiempo-de-compilacion-en-linea\" class=\"headerlink\" title=\"Tiempo de compilacin en lnea\"></a>Tiempo de compilacin en lnea</h3><p>Una aplicacin localizada ahora solo se compilar una vez. En lugar de mltiples compilaciones para producir un paquete por idioma, se produce un paquete por idioma reemplazando los marcadores de posicin <code>$localize</code> con textos traducidos.</p><p>Ahora hay que agregar el paquete <code>@angular/localize</code> para posibilitar la localizacin (varios idiomas). La buena noticia es que ya no tenemos que incluir el cdigo de localizacin de Angular en nuestros paquetes si solo tenemos un idioma.</p><p>Si no usamos plantillas localizadas, las instrucciones de <em>Ivy</em> <code>i18n *</code> se sacan del paquete principal.</p><h3 id=\"Textos-localizables-en-modelos-de-componentes-y-servicios\"><a href=\"#Textos-localizables-en-modelos-de-componentes-y-servicios\" class=\"headerlink\" title=\"Textos localizables en modelos de componentes y servicios\"></a>Textos localizables en modelos de componentes y servicios</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.component.ts</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  template: <span class=\"string\">'&#123;&#123; title &#125;&#125;'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;</span><br><span class=\"line\">  title = $localize<span class=\"string\">`Welcome to MyApp`</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 3. Un marcador de posicin de texto de traduccin en un modelo de componente.</em></p><p>Una nueva caracterstica de internacionalizacin es que tambin podemos incluir marcadores de posicin para textos traducidos en el contenido de nuestros modelos como se ve en el Listado 3. Anteriormente, esto solo era posible en las plantillas.</p><h2 id=\"Ambitos-adicionales-de-proveedores-de-dependencias\"><a href=\"#Ambitos-adicionales-de-proveedores-de-dependencias\" class=\"headerlink\" title=\"mbitos adicionales de proveedores de dependencias\"></a>mbitos adicionales de proveedores de dependencias</h2><p>Siempre hemos tenido alcance de mdulo para los proveedores de inyeccin de servicios. La versin Angular 6 introdujo el alcance <code>&#39;root&#39;</code> y los proveedores <em>tree-shakable</em>, tanto para los proveedores de alcance desde el mdulo raz como desde mdulos inferiores.</p><p>La versin angular 9 presenta los nuevos mbitos de proveedor <code>&#39;platform&#39;</code> y <code>&#39;any&#39;</code>. Los proveedores con mbito de <code>&#39;platform&#39;</code> se pueden compartir entre mltiples aplicaciones Angular en el mismo documento. El alcance del proveedor <code>&#39;any&#39;</code> compartir un proveedor por inyector de mdulo. Por ejemplo, una instancia de servicio para el paquete principal cargado por adelantado y una instancia de servicio para cada mdulo cargado con retraso.</p><h2 id=\"Experiencia-mejorada-del-desarrollador\"><a href=\"#Experiencia-mejorada-del-desarrollador\" class=\"headerlink\" title=\"Experiencia mejorada del desarrollador\"></a>Experiencia mejorada del desarrollador</h2><p>Ivy permite que <em>Angular Language Service</em> admita comprobaciones adicionales durante el desarrollo. Esta es una gran mejora para la experiencia del desarrollador.</p><h3 id=\"Comprobaciones-de-ruta-de-archivo\"><a href=\"#Comprobaciones-de-ruta-de-archivo\" class=\"headerlink\" title=\"Comprobaciones de ruta de archivo\"></a>Comprobaciones de ruta de archivo</h3><p><em>Angular Language Service</em> verifica continuamente la hoja de estilo de componentes y las rutas de plantilla.</p><h3 id=\"Verificaciones-de-tipo-de-plantilla\"><a href=\"#Verificaciones-de-tipo-de-plantilla\" class=\"headerlink\" title=\"Verificaciones de tipo de plantilla\"></a>Verificaciones de tipo de plantilla</h3><p>Las plantillas se verifican por tipo, de acuerdo con el modo de verificacin de tipo de plantilla como se describe ms abajo en la seccin Modo estricto. Los nombres y tipos de miembros se verifican, incluso en vistas incrustadas. Lo que anteriormente resultaba en errores de tiempo de ejecucin ahora se detecta durante el desarrollo y la construccin.</p><h2 id=\"Nueva-API-de-depuracion-en-modo-de-desarrollo\"><a href=\"#Nueva-API-de-depuracion-en-modo-de-desarrollo\" class=\"headerlink\" title=\"Nueva API de depuracin en modo de desarrollo\"></a>Nueva API de depuracin en modo de desarrollo</h2><p><code>ng.probe</code> ha sido reemplazado por una nueva API de depuracin en modo de desarrollo. Las funciones ms notables son <code>ng.applyChanges</code> y<code>ng.getComponent</code>.</p><h2 id=\"Modo-estricto\"><a href=\"#Modo-estricto\" class=\"headerlink\" title=\"Modo estricto\"></a>Modo estricto</h2><h3 id=\"Esquema-estricto-del-espacio-de-trabajo\"><a href=\"#Esquema-estricto-del-espacio-de-trabajo\" class=\"headerlink\" title=\"Esquema estricto del espacio de trabajo\"></a>Esquema estricto del espacio de trabajo</h3><p>El comando <code>ng new</code> ahora es compatible con el indicador<code>--strict</code> que por defecto est desactivado (<code>false</code>).</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new my-app --strict</span><br></pre></td></tr></table></figure><p>Cuando est habilitado, este parmetro agrega algunas comprobaciones estrictas del compilador TypeScript como se ve en el Listado 4.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// tsconfig.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"attr\">\"compilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitAny\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitReturns\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noImplicitThis\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"noFallthroughCasesInSwitch\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">\"strictlyNullChecks\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 4. Opciones del compilador TypeScript habilitadas en un estricto espacio de trabajo angular.</em></p><p>Curiosamente, esto no agrega las mismas opciones que si simplemente estableciramos <code>&quot;strict&quot;: true</code> en el objeto <code>compilerOptions</code>. Comparemos la opcin estricta del <em>workspace</em> Angular con la opcin estricta del compilador TypeScript.</p><p>Ambos tienen estas opciones en comn:</p><ul><li><code>noImplicitAny</code></li><li><code>noImplicitThis</code></li><li><code>strictlyNullChecks</code></li></ul><p>La opcin estricta de Angular establece adems estas opciones:</p><ul><li><code>noImplicitReturns</code></li><li><code>noFallthroughCasesInSwitch</code></li></ul><p>mientras que la opcin estricta del compilador TypeScript establece adicionalmente estas opciones:</p><ul><li><code>alwaysStrict</code></li><li><code>strictlyBindCallApply</code></li><li><code>strictlyFunctionTypes</code></li><li><code>estrictoPropertyInitialization</code></li></ul><p>Adems, la opcin de Angular no establece la comprobacin del tipo de plantilla en el nuevo modo estricto, lo deja en el modo <code>&#39;full&#39;</code> anterior.</p><h3 id=\"Verificacion-estricta-del-tipo-de-plantilla\"><a href=\"#Verificacion-estricta-del-tipo-de-plantilla\" class=\"headerlink\" title=\"Verificacin estricta del tipo de plantilla\"></a>Verificacin estricta del tipo de plantilla</h3><p>Hemos tenido la opcin de habilitar la verificacin del tipo de plantilla desde Angular versin 5 configurando <code>&quot;fullTemplateTypeCheck&quot;:true</code> en el objeto<code>angularCompilerOptions</code>.</p><p>Ivy presenta una estricta comprobacin del tipo de plantilla como se ve en el Listado 5. Cuando se establece esta nueva opcin del compilador Angular, se ignora el valor de <code>fullTemplateTypeCheck</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// tsconfig.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"string\">\"angularCompilerOptions\"</span>: &#123;</span><br><span class=\"line\"><span class=\"string\">\"strictTemplates\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p><em>Listado 5. Habilita la comprobacin estricta del tipo de plantilla.</em></p><p>La comprobacin de tipo de plantilla estricta verifica los tipos de enlaces de propiedades y respeta la opcin <code>stricNullChecks</code>. Tambin verifica los tipos de referencias de plantilla a directivas y componentes, incluidos los tipos genricos. Tambin se verifican los tipos de variables de contexto de plantilla, lo cual es excelente para los bucles <code>NgFor</code>. El tipo <code>$ event</code> est marcado para enlaces de eventos y animaciones. Incluso el tipo de elementos DOM nativos se verifica con una comprobacin estricta del tipo de plantilla.</p><p>Estas comprobaciones adicionales pueden conducir a errores y falsos positivos bajo ciertas circunstancias. Por ejemplo, cuando se usan libreras que no estn compiladas con <code>strictNullChecks</code>. Para abordar esto, la verificacin estricta del tipo de plantilla tiene opciones para optar por no participar y ajustar los controles. Por ejemplo, <code>strictTemplates</code> es en realidad una atajo de 8 opciones de compilador Angular.</p><h2 id=\"Herencia-de-clase-de-componente-y-directiva-mejorada\"><a href=\"#Herencia-de-clase-de-componente-y-directiva-mejorada\" class=\"headerlink\" title=\"Herencia de clase de componente y directiva mejorada\"></a>Herencia de clase de componente y directiva mejorada</h2><p>Las clases base sin selector ahora son compatibles con directivas y componentes. Algunos metadatos ahora se heredan de componentes base y clases directivas. Esto hace que sea ms fcil extender, por ejemplo, las directivas Angular Components y Angular Router.</p><h2 id=\"Ultimas-versiones-de-TypeScript\"><a href=\"#Ultimas-versiones-de-TypeScript\" class=\"headerlink\" title=\"ltimas versiones de TypeScript\"></a>ltimas versiones de TypeScript</h2><p>Las versiones de TypeScript 3.6 y 3.7 son compatibles con la versin angular 9. Las versiones anteriores de TypeScript ya no son compatibles. Consulta la Tabla 1 para comparar la compatibilidad de TypeScript entre<br>todas las versiones Angular.</p><p><a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3/raw/ad300b4d2bdbc51b4dd8092c059a68cb22d3774d/angular-cli-node-js-typescript-support.csv\" target=\"_blank\" rel=\"noopener\">vista bruta</a><br><a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3#file-angular-cli-node-js-typescript-support-csv\" target=\"_blank\" rel=\"noopener\">descargable angular-cli-node-js-typescript-support.csv</a> hosted with  by <a href=\"https://github.com/\" target=\"_blank\" rel=\"noopener\">GitHub</a></p><p><em>Tabla 1. Tabla de compatibilidad del Angular CLI, Angular, Node.js y TypeScript.</em> <a href=\"https://gist.github.com/LayZeeDK/c822cc812f75bb07b7c55d07ba2719b3\" target=\"_blank\" rel=\"noopener\"><em>Abrir en una pestaa nueva</em></a>*</p><p>TypeScript versin 3.6 presenta estas y otras caractersticas:</p><ul><li>Soporte Unicode para identificadores en destinos modernos</li><li>Experiencia de desarrollador mejorada para promesas</li><li>Comprobacin de tipo ms estricto de generadores</li></ul><p>TypeScript versin 3.7 presenta estas y otras caractersticas que podemos usar con Angular versin 9:</p><ul><li>Operador de encadenamiento opcional (<code>?.</code>) similar al operador de navegacin segura para plantillas Angular</li><li>Operador de unin con nulos (<code>??</code>)</li><li>Funciones de afirmacin de pruebas (<code>assert parameterName is typeName</code> y <code>asserts parameterName</code>)</li><li><code>await</code> de primer nivel</li><li>Alias de tipo recursivo mejorado</li><li>Mejora de la experiencia del desarrollador para funciones de comprobaciones</li></ul><h2 id=\"Generacion-mejorada-del-lado-del-servidor-con-Angular-Universal\"><a href=\"#Generacion-mejorada-del-lado-del-servidor-con-Angular-Universal\" class=\"headerlink\" title=\"Generacin mejorada del lado del servidor con Angular Universal\"></a>Generacin mejorada del lado del servidor con Angular Universal</h2><p>Angular Universal versin 9 se lanza con un servidor de desarrollo Node.js Express para proporcionar un entorno realista durante el desarrollo.</p><p>Tambin parte de este lanzamiento es un constructor del CLI para pre-renderizar rutas estticas usando <code>guess-parser</code>, inspirado en <code>angular-prerender</code>. Podemos pasar un archivo de rutas para renderizar rutas dinmicas (rutas con parmetros).</p><h3 id=\"Como-empiezo\"><a href=\"#Como-empiezo\" class=\"headerlink\" title=\"Cmo empiezo?\"></a>Cmo empiezo?</h3><p>Podemos agregar Angular Universal usando el comando <code>ng add @nguniversal/express-engine</code>. Luego podemos usar el comando del constructor <code>ng run myapp:serve-ssr</code> para iniciar el servidor de desarrollo de renderizado del lado del servidor con recarga en vivo. De manera similar, podemos usar <code>ng run myapp:prerender</code> para detectar rutas estticas y dinmicas y pre renderizarlas.</p><h2 id=\"Experiencia-de-clases-y-estilo-mejorada\"><a href=\"#Experiencia-de-clases-y-estilo-mejorada\" class=\"headerlink\" title=\"Experiencia de clases y estilo mejorada\"></a>Experiencia de clases y estilo mejorada</h2><p>Al aplicacin de estilo en Angular <em>Ivy</em> ha sido reelaborado. La combinacin de clases HTML estticas con las directivas <code>NgStyle</code> y<code>NgClass</code> es ahora totalmente compatible y ms fcil de entender.</p><h3 id=\"Soporte-de-propiedades-personalizadas-de-CSS\"><a href=\"#Soporte-de-propiedades-personalizadas-de-CSS\" class=\"headerlink\" title=\"Soporte de propiedades personalizadas de CSS\"></a>Soporte de propiedades personalizadas de CSS</h3><p>Como parte de la reescritura del estilo Ivy, ahora se admiten las propiedades personalizadas de CSS enlazadas.</p><p>Un ejemplo de enlace css puede ser as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">style.--my-var</span>]=<span class=\"string\">\"myProperty || 'any value'\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Las propiedades personalizadas de CSS tienen control de alcance, por lo que esta propiedad de CSS se limitara al DOM del componente.</p><h2 id=\"Lanzamiento-estable-de-Bazel-como-opcion-de-suscripcion\"><a href=\"#Lanzamiento-estable-de-Bazel-como-opcion-de-suscripcion\" class=\"headerlink\" title=\"Lanzamiento estable de Bazel como opcin de suscripcin\"></a>Lanzamiento estable de Bazel como opcin de suscripcin</h2><p>Bazel versin 2.1 es una herramienta de automatizacin de compilacin opcional para Angular versin 9.</p><h3 id=\"Como-empiezo-1\"><a href=\"#Como-empiezo-1\" class=\"headerlink\" title=\"Cmo empiezo?\"></a>Cmo empiezo?</h3><p>Para habilitar Bazel, usa <code>ng add @angular/bazel</code> o la coleccin de esquemas <code>@angular/bazel</code> cuando generes un espacio de trabajo Angular.</p><p>Asegrate de seguir <a href=\"https://docs.bazel.build/versions/2.0.0/install.html\" target=\"_blank\" rel=\"noopener\">la gua de instalacin de Bazel</a> para tu sistema operativo.</p><h2 id=\"Angular-Components\"><a href=\"#Angular-Components\" class=\"headerlink\" title=\"Angular Components\"></a>Angular Components</h2><p>La versin Angular 9 viene con componentes oficiales para YouTube y Google Maps. Se agreg una directiva y un servicio de portapapeles al Angular CDK.</p><h2 id=\"Pruebas\"><a href=\"#Pruebas\" class=\"headerlink\" title=\"Pruebas\"></a>Pruebas</h2><p>La mayor sorpresa de la versin Angular versin 9 son las muchas mejoras en las pruebas. Se resuelven problemas de rendimiento, se mejoran los tipos y se introducen nuevos conceptos.</p><p><a href=\"https://indepth.dev/next-level-testing-in-angular-ivy-version-9/\" target=\"_blank\" rel=\"noopener\">Obtn informacin sobre las principales caractersticas y mejoras para las pruebas en Pruebas de siguiente nivel en Angular <em>Ivy</em> versin 9</a>.</p><h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusin\"></a>Conclusin</h2><p>Uno de los objetivos ms importantes ha sido mantener la compatibilidad hacia atrs entre <em>Ivy</em> y <em>View Engine</em> tanto como fue posible.</p><p>Por supuesto, la versin Angular 9 tambin incluye correcciones de errores, temas obsoletos y cambios importantes. <em>Ivy</em> tambin aborda algunos problemas de antiguos que no cubrimos en este artculo.</p><p>Angular <em>Ivy</em> es un facilitador para las caractersticas que estn por venir. Como hemos discutido en este artculo, <em>Ivy</em> ya nos ha dado beneficios para diferentes casos de uso. Sin embargo, las mejores caractersticas llegarn en futuras versiones de Angular. Cul de las posibles caractersticas que se entregarn en las versiones 10 y 11 de Angular est por decidir?</p><p>Solo discutimos qu es parte de las API pblicas y estables de Angular versin 9. Algunas API experimentales son parte de esta versin, como <code>renderComponent</code>,<code>markDirty</code> y <code>detectChanges</code>. Sin embargo, todava estn sujetos a cambios.</p><p>Con la retirada de las declaraciones de componentes de entrada y los componentes con carga diferida utilizando mdulos de representacin, estamos un paso ms cerca de tener <a href=\"https://indepth.dev/angular-revisited-tree-shakable-components-and-optional-ngmodules/\" target=\"_blank\" rel=\"noopener\">componentes que se pueden eliminar del rbol y mdulos Angular opcionales</a>.</p><p><a href=\"https://indepth.dev/component-features-with-angular-ivy/\" target=\"_blank\" rel=\"noopener\">Los componentes de funcionalidad</a> tambin forman parte de esta versin, pero solo estn expuestos para uso interno de <em>Ivy</em>.</p><p>La versin de Angular <em>Ivy</em> versin 9 nos brinda mejoras para el empaquetamiento, las pruebas, la experiencia del desarrollador, las herramientas, la depuracin y la verificacin de tipos. Toda una buena coleccin de caractersticas.</p><h2 id=\"Recursos-relacionados\"><a href=\"#Recursos-relacionados\" class=\"headerlink\" title=\"Recursos relacionados\"></a>Recursos relacionados</h2><h3 id=\"Componentes-con-carga-lenta\"><a href=\"#Componentes-con-carga-lenta\" class=\"headerlink\" title=\"Componentes con carga lenta\"></a>Componentes con carga lenta</h3><p><a href=\"https://youtu.be/DA3efofhpq4\" target=\"_blank\" rel=\"noopener\">Informacin sobre los mdulos de presentacin en la charla Angular revisited: Tree-shakable components and optional NgModules</a>.</p><p><a href=\"https://medium.com/angular-in-depth/lazy-load-components-in-angular-596357ab05d8\" target=\"_blank\" rel=\"noopener\">Aprende a usar los componentes de carga diferida en Lazy load components in Angular por Kevin Kreuzer</a>.</p><h3 id=\"Comprobacion-de-tipos-en-plantillas\"><a href=\"#Comprobacion-de-tipos-en-plantillas\" class=\"headerlink\" title=\"Comprobacin de tipos en plantillas\"></a>Comprobacin de tipos en plantillas</h3><p><a href=\"https://angular.io/guide/template-typecheck#troubleshooting-template-errors\" target=\"_blank\" rel=\"noopener\">Lee la gua oficial sobre la verificacin de tipos en plantillas Angular para conocer los detalles de la resolucin de problemas y la configuracin</a>.</p><h3 id=\"Globalizacion-1\"><a href=\"#Globalizacion-1\" class=\"headerlink\" title=\"Globalizacin\"></a>Globalizacin</h3><p><a href=\"https://www.softwarearchitekt.at/aktuelles/lazy-loading-locals-with-angular/\" target=\"_blank\" rel=\"noopener\">Manfred Steyer analiza las configuraciones regionales de carga diferida en Lazy Loading Locales with Angular</a>.</p><p><a href=\"https://blog.ninja-squad.com/2019/12/10/angular-localize/\" target=\"_blank\" rel=\"noopener\">Cdric Exbrayat analiza la globalizacin de <em>Ivy</em> en Internationalization with @angular/localize</a>.</p><h3 id=\"Ambitos-adicionales-de-proveedor-de-dependencias\"><a href=\"#Ambitos-adicionales-de-proveedor-de-dependencias\" class=\"headerlink\" title=\"mbitos adicionales de proveedor de dependencias\"></a>mbitos adicionales de proveedor de dependencias</h3><p>Obtn informacin sobre los mbitos de proveedor de <code>&#39;any&#39;</code> y <code>&#39;platform&#39;</code> en <a href=\"https://dev.to/christiankohler/improved-dependeny-injection-with-the-new-providedin-scopes-any-and-platform-30bb\" target=\"_blank\" rel=\"noopener\">Improved Dependeny Injection with the new providedIn scopes any and platform by Christian Kohler</a>.</p><h3 id=\"Nueva-API-de-depuracion\"><a href=\"#Nueva-API-de-depuracion\" class=\"headerlink\" title=\"Nueva API de depuracin\"></a>Nueva API de depuracin</h3><p><a href=\"https://angular.io/api/core/global\" target=\"_blank\" rel=\"noopener\">Lee sobre la API de depuracin completa en la documentacin oficial</a>.</p><h3 id=\"Angular-Universal-version-9\"><a href=\"#Angular-Universal-version-9\" class=\"headerlink\" title=\"Angular Universal versin 9\"></a>Angular Universal versin 9</h3><p>Estos dos artculos entran en detalles de Angular Universal versin 9:</p><ul><li><a href=\"https://trilon.io/blog/angular-universal-v9-whats-new\" target=\"_blank\" rel=\"noopener\">Angular Universal v9: Whats New ? by Mark Pieszak</a></li><li><a href=\"https://dev.to/angular/angular-v9-universal-ssr-and-prerendering-out-of-the-box-33b1\" target=\"_blank\" rel=\"noopener\">Angular v9 &amp; Universal: SSR and prerendering out of the box! by Sam Vloeberghs</a></li></ul><p>Aprende sobre <code>angular-prerender</code>, la biblioteca que inspir estas nuevas caractersticas de Angular Universal en <a href=\"https://media-codings.com/articles/prerender-angular-apps-with-a-single-command\" target=\"_blank\" rel=\"noopener\">Prerender Angular Apps with a single Command by Christoph Guttandin</a>.</p><h3 id=\"Enlace-de-propiedades-personalizadas-de-CSS\"><a href=\"#Enlace-de-propiedades-personalizadas-de-CSS\" class=\"headerlink\" title=\"Enlace de propiedades personalizadas de CSS\"></a>Enlace de propiedades personalizadas de CSS</h3><p><a href=\"https://twitter.com/yurzui/status/1221159415820275717\" target=\"_blank\" rel=\"noopener\">Mira este tweet y la demostracin de Alexey Zuev para ver los enlaces de Propiedades personalizadas de CSS en accin</a>.</p><h2 id=\"Revisores\"><a href=\"#Revisores\" class=\"headerlink\" title=\"Revisores\"></a>Revisores</h2><p>Siempre es til tener una segunda opinin sobre nuestro trabajo o incluso detectar errores tontos. Para este artculo el autor tuvo el placer de ser revisado por:</p><ul><li><a href=\"https://twitter.com/chrisguttandin\" target=\"_blank\" rel=\"noopener\">Christoph Guttandin</a></li><li><a href=\"https://indepth.dev/author/evgeny/\" target=\"_blank\" rel=\"noopener\">Evgeny Fedorenko</a></li><li><a href=\"https://dev.to/santoshyadav198613\" target=\"_blank\" rel=\"noopener\">Santosh Yadav</a></li></ul><p>Cover photo by <a href=\"https://www.pexels.com/photo/light-new-year-s-eve-fireworks-sylvester-40663/\" target=\"_blank\" rel=\"noopener\">Pixabay</a> on Pexels.</p><p>El autor original: <a href=\"https://twitter.com/LayZeeDK\" target=\"_blank\" rel=\"noopener\">Lars Gyrup Brink Nielsen</a></p><p>El traductor al espaol: <a href=\"https://twitter.com/albertobasalo\" target=\"_blank\" rel=\"noopener\">Alberto Basalo</a></p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Nx, mono repositorios en Angular","date":"2019-09-03T16:59:27.000Z","thumbnail":"/css/images/angular-10_monorepo.png","_content":"\n![nx-mono-repositorios-en-Angular](/images/tutorial-angular-10_monorepo.png)\n\nEmpiezo este **tutorial de Angular Avanzado** con la frase con la que acab un artculo de opinin sobre arquitectura de software acerca de [Angular para grandes aplicaciones.](https://medium.com/@albertobasalo71/angular-para-grandes-aplicaciones-b66786fd3032)\n\n> Angular y las decisiones de diseo que le acompaan tienen como objetivo facilitar el desarrollo y mantenimiento a medio y largo plazo de aplicaciones web no triviales.\n\nLas empresas de desarrollo y los clientes finales que escogen **Angular**, suelen ser de tamao medio o grande. Cuanto mayor sea el problema ms destaca este _framework_. Y tarde o temprano esos grandes proyectos necesitarn compartir o reutilizar cdigo. La herramienta [Nx de Nrwl](https://nx.dev/angular) ayuda en esa tarea facilitando la creacin de espacios de trabajo multi proyecto: **los mono repositorios.**\n\n<!-- more -->\n\nPartiendo de cero y usando las herramientas de [Nrwl.io/](https://nrwl.io/) crearemos un _blueprint_ para desarrollar grandes aplicaciones. Al finalizar tendrs, en el mismo repositorio, un par de aplicaciones y varias libreras reutilizables creadas con los _Nx power-ups_.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n## Tabla de Contenido:\n\n[1. Crear el repositorio.](./#1-Crear-el-repositorio)\n\n[2. Generar varias aplicaciones con Angular.](./#2-Generar-una-SPA-con-Angular)\n\n[3. Tener una biblioteca TypeScript con lgica de dominio.](./#3-Tener-una-biblioteca-TypeScript-con-logica-de-dominio)\n\n[4. Tener una biblioteca Angular con componentes de interfaz.](./#4-Tener-una-biblioteca-Angular-con-componentes-de-interfaz)\n\n[5. Tener una biblioteca Angular con servicios de datos.](./#5-Tener-una-biblioteca-Angular-con-servicios-de-datos)\n\n[Diagramas](./#Diagramas)\n\n[Resumen](./#Resumen)\n\n---\n\n# 1. Crear el repositorio\n\n```yaml\n Como: arquitecto de software\n quiero: disponer de un espacio de trabajo nico\n para: crear aplicaciones y libreras.\n ```\n\nLo primero ser preparar las herramientas. **Nx** es un complemento del **CLI** as que debemos tener este ltimo disponible. Voy a emplear [yarn](https://yarnpkg.com/lang/en/) para la instalacin de paquetes y la ejecucin de comandos. Pero se muestran las instrucciones alternativas con `npm`. El repositorio siempre lo creo vaco y despus agrego las capacidades especficas para **Angular**.\n\n```bash\n# Add latest Angular CLI\nyarn global add @angular/cli\n# Sets yarn as default packager for cli\nng config -g cli.packageManager yarn\n\n# Creates empty repository\nyarn create nx-workspace angular-blueprint\n\n# also with NPM...\nnpm i -g @angular/cli\nnpx create-nx-workspace@latest angular-blueprint\n```\n\n---\n\n# 2. Generar una SPA con Angular\n\n```yaml\nAs a: customer,\n  I want: to see a shop\n  so that: I can buy products\n\n As a: seller,\n  I want: to see a warehouse\n  so that: I can take control\n```\n\nLos prximos comandos te sonarn a los mismo del **angular-cli**. Es normal, pues **Nx** utiliza y mejora las capacidades de la herramienta original. La diferencia est en que la recin creada aplicacin, en lugar de nacer en la raz del _workspace_, va la carpeta especfica `/apps`.\n\n```bash\n# Add Angular capabilities\nyarn add --dev @nrwl/angular\n\n# Generate an Angular application with nx power-ups\nng g @nrwl/schematics:application shop --inlineStyle --routing --directory= -p ab-shop\n# Start default !!!\nyarn start\n# Generate an Angular application with nx power-ups\nng g @nrwl/schematics:application warehouse --inlineStyle --routing --directory= -p ab-warehouse\n# Start especific !!!\nng serve warehouse --port=4202 -o\n```\n\nAmbas aplicaciones comparten la configuracin del `angular.json` y las dems herramientas de ayuda como **tslint** y **prettier**. Destaca mucho que tambin que compartan `/node_modules`, lo cual se agradece en el tiempo y en el espacio.\n\nCon nx puedes crear tambin aplicaciones de Backend. Por ejemplo un API REST hecha con [NestJS](https://nestjs.com/). Para acceder a los generadores especfico tienes que instalarlos antes. por ejemplo:\n\n```bash\nyarn add --dev @nrwl/nest\nng g @nrwl/nest:application api\nng serve api\n```\n\nAl tener varias aplicaciones es conveniente disponer de scripts especficos para cada una. Por ejemplo yo en el `package.json` tenda algo as.\n\n```json\n{\n  \"start:shop\": \"ng serve shop --port=4201 -o\",\n  \"build:shop\": \"ng build shop --prod\",\n  \"test:shop\": \"ng test shop\",\n  \"start:warehouse\": \"ng serve warehouse --port=4202 -o\",\n  \"build:warehouse\": \"ng build warehouse --prod\",\n  \"test:warehouse\": \"ng test warehouse\",\n  \"start:api\": \"ng serve api\",\n  \"build:api\": \"ng build api --prod\",\n  \"test:api\": \"ng test api\",\n}\n```\n\nPor supuesto que todos estos comando se pueden lanzar visualmente mediante la extensin [Angular Console para VSCode](https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console). Te recomiendo adems estas otras extensiones:\n\n```json\n{\n  \"recommendations\": [\n    \"nrwl.angular-console\",\n    \"angular.ng-template\",\n    \"ms-vscode.vscode-typescript-tslint-plugin\",\n    \"esbenp.prettier-vscode\",\n    \"pkief.material-icon-theme\",\n    \"christian-kohler.path-intellisense\",\n    \"ban.spellright\",\n    \"johnpapa.angular-essentials\"\n  ]\n}\n```\n\n---\n\n\n# 3. Tener una biblioteca TypeScript con lgica de dominio.\n\n```yaml\n Como: arquitecto\n quiero: tener una biblioteca en TypeScript con lgica de dominio\n de modo que: pueda usarla con varios frameworks o incluso en puro JavaScript.\n ```\n\nMs temprano que tarde aparecern funcionalidades comunes a distintas aplicaciones. Validadores genricos, utilidades o casos concretos de un cliente pero que se usan en todos sus desarrollos. En este ejemplo partimos de la necesidad comn de un sistema de saludos (un mensaje, vaya). Y para ello empezamos por definir una `interface` pblica reutilizable.\n\nUn poco de arquitectura de software. Todo lo que podamos programar y que no dependa de un _framework_ debemos encapsularlo en libreras independientes. De esa forma puede reutilizarse con otras tecnologas o sobrevivir dignamente a la evolucin o desaparicin de Angular.\n\nLo primero ser crear la librera. Pero esta vez no usaremos los _schematics_ del **cli**, si no los propios de **nrwl**. La idea es usarla como la **capa de dominio de la arquitectura**. En ella pondremos los modelos y servicios de lgica de negocio con las menores dependencias posibles. Repito lo fundamental: minimizar las dependencias. En concreto no dependeremos de Angular, lo cual permitira usarlo con otros _frameworks_ actuales o futuros.\n\n```bash\n# Generate a Type Script library with nx power-ups\nng generate @nrwl/workspace:library domain --directory=shared\n```\nPor ahora no te preocupes de la implementacin. La muestro para destacar las dos cosas que considero ms importantes:\n\n- No hay ninguna referencia explcita a _Angular_.\n\n- Lo que quieras exportar debe indicarse en el fichero `index.ts`.\n\nPor lo dems es puro _TypeScript_; en una carpeta con intenciones bien claras: `models/` creo de forma manual el siguiente fichero:\n\n`libs\\shared\\domain\\src\\lib\\models\\greetings.interface.ts`\n\n```typescript\nexport interface Greetings {\n  message: string;\n}\n```\nal no disponer del sistema de mdulos de angular tengo que exportarlo en el ndice de la librera.\n\n`libs\\shared\\domain\\src\\index.ts`\n\n```typescript\nexport * from './lib/models/greetings.interface';\n```\n\nPara localizarlo, Nx crea un alias en el `tsconfig.json`, que puedes retocar a voluntad\n\n```json\n\"paths\": {\n  \"@a-boss/domain\": [\"libs/shared/domain/src/index.ts\"]\n}\n```\n\nYa est listo para seer consumido desde distintos proyectos (Lo har despus en el API y ya mismo en la prxima librera de componentes).\n\n---\n\n# 4. Tener una biblioteca Angular con componentes de interfaz\n\n```yaml\nAs a: customer,\n  I want: to be greeted\n  so that: I feel at home\n\nAs a: seller,\n  I want: to be greeted\n  so that: I feel at home\n```\n\nSi eres una empresa consultora es posible que te encuentres repitiendo funciones o pantallas una y otra vez para distintos clientes. Por supuesto que una gran empresa seguro que se hacen muchas aplicaciones similares, a las que les vendra de maravilla **compartir una biblioteca de componentes**.\n\nPues ahora crear libreras es igual de sencillo que crear aplicaciones. **Nx** las depositar en la carpeta `/libs` y se ocupar de apuntarlas en el `tsconfig.json` para que la importacin desde el resto del proyecto use alias cortos y evidentes.\n\nCrear componentes en un entorno multi proyecto requiere especificar a qu proyecto se asociarn. Para empezar vamos a crear los componentes bsicos para esta funcionalidad en una librera compartida de para interfaz de usuario.\n\n```bash\n# Generate an Angular library with nx power-ups\nng g @nrwl/angular:library ui --directory=shared --prefix=ab-ui --simpleModuleName\n# Generate Greetings Component\nng g component greetings --project=shared-ui --module=ui.module.ts --export --inlineStyle --inlineTemplate\n```\n\nY le damos contenido al componente. Fjate en la importacin de la interfaz `Greetings`.\n\n\n`libs\\shared\\ui\\src\\lib\\greetings\\greetings.component.ts`\n\n```typescript\nimport { Greetings } from '@a-boss/domain';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'ab-ui-greetings',\n  template: `\n    <p>\n      {{ theGreeting.message }}\n    </p>\n  `,\n  styles: []\n})\nexport class GreetingsComponent implements OnInit {\n  public theGreeting: Greetings = { message: 'Hello world' };\n  constructor() {}\n\n  ngOnInit() {}\n}\n```\n---\n\nPuedes usarlos como cualquier otro componente y en cualquier aplicacin del repositorio. Simplemente importando el mdulo en el que se declaran: el `UiModule`. NX se encarga de referenciar cada proyecto en el fichero `tsconfig.json`. De esa forma se facilita su importacin en cualquier otra aplicacin del repositorio.\n\nPrimero importamos el mdulo.\n\n`apps\\shop\\src\\app\\app.module.ts`\n\n```typescript\nimport { UiModule } from '@a-boss/ui';\nimport { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { RouterModule } from '@angular/router';\nimport { AppComponent } from './app.component';\n\n@NgModule({\n  declarations: [AppComponent],\n  imports: [\n    BrowserModule,\n    RouterModule.forRoot([], { initialNavigation: 'enabled' }),\n    UiModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\nY ya podemos incrustar sus componentes pblicos.\n\n`apps\\shop\\src\\app\\app.component.html`\n\n```html\n<ab-ui-greetings></ab-ui-greetings>\n<router-outlet></router-outlet>\n```\n\n`apps\\shop\\src\\app\\app.component.ts`\n\n```typescript\nimport { Component } from '@angular/core';\n\n@Component({\n  selector: 'ab-shop-root',\n  templateUrl: './app.component.html',\n  styles: []\n})\nexport class AppComponent {\n  title = 'shop';\n}\n```\n\n---\n\n# 5. Tener una biblioteca Angular con servicios de datos\n\n```yaml\nAs a: customer,\n  I want: to be greeted by the API :-)\n  so that: I know I am not alone.\n\nAs a: seller,\n  I want: to be greeted by the API :-)\n  so that: I know I am not alone.\n```\n\nAdems de componentes visuales, podemos tener libreras con servicios de lgica o de acceso a datos. Por ejemplo un servicio para comunicarnos con el API podra ser utilizado en diversos proyectos (aplicaciones o libreras).\n\nCon lo ya sabido vamos a crear una librera compartida para acceso a datos.\n\n\n```bash\nng g @nrwl/angular:library data --directory=shared --prefix=ab-data --simpleModuleName\nng g service greetings --project=shared-data --no-flat\n```\n\nEl servicio realiza la llamada http y devuelve un observable.\n\n`libs\\shared\\data\\src\\lib\\greetings\\greetings.service.ts`\n\n```typescript\nimport { Greetings } from '@a-boss/domain';\nimport { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\n@Injectable({\n  providedIn: 'root'\n})\nexport class GreetingsService {\n  private apiUrl = 'http://localhost:3333/api';\n  constructor(private httpClient: HttpClient) {}\n  public getGrettings$(): Observable<Greetings> {\n    return this.httpClient.get<Greetings>(this.apiUrl);\n  }\n}\n```\n\nPara consumir el servicio no hay que hacer nada ms. Pero, para importarlo en TypeScript, necesitmaos que nos lo exporten adecuadamente.\n\n`libs\\shared\\data\\src\\index.ts`\n\n```typescript\nexport * from './lib/data.module';\nexport * from './lib/greetings/greetings.service';\n```\n\n`tsconfig.json`\n\n```json\n\"paths\": {\n  \"@a-boss/domain\": [\"libs/shared/domain/src/index.ts\"]\n}\n```\n\nY ahora consumirlo ya no es un problema. Por ejemplo directamente en el componente.\n\n`libs\\shared\\ui\\src\\lib\\greetings\\greetings.component.ts`\n\n```typescript\nimport { GreetingsService } from '@a-boss/data';\nimport { Greetings } from '@a-boss/domain';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'ab-ui-greetings',\n  template: `\n    <p>\n      {{ theGreeting.message }}\n    </p>\n  `,\n  styles: []\n})\nexport class GreetingsComponent implements OnInit {\n  public theGreeting: Greetings = { message: 'Hello world' };\n  constructor(private greetingsService: GreetingsService) {}\n  public ngOnInit() {\n    this.greetingsService.getGrettings$().subscribe(this.appendApiMessage);\n  }\n  private appendApiMessage = (apiGreetings: Greetings) =>\n    (this.theGreeting.message += ' and ' + apiGreetings.message);\n}\n```\n\nYa que estamos accediendo al API, podemos aprovechar para adecuar sus tipos a la interfaz declarada en el dominio. Fjate lo familiar que resulta este cdigo **NodeJS** gracias al framework [nest](https://nestjs.com/).\n\n`apps\\api\\src\\app\\app.controller.ts`\n\n```typescript\nimport { Greetings } from '@a-boss/domain';\nimport { Controller, Get } from '@nestjs/common';\nimport { AppService } from './app.service';\n\n@Controller()\nexport class AppController {\n  constructor(private readonly appService: AppService) {}\n\n  @Get()\n  getData(): Greetings {\n    return this.appService.getData();\n  }\n}\n```\n\n\n<!-- ## Diagramas\n\nEl siguiente diagrama nos muestra a vista de pjaro las distintas libreras y aplicaciones que tenemos en este momento. Fjate en la jerarqua de dependencias : Aplicaciones -> Libreras Angular -> Libreras del Dominio.\n\n![Dependencias entre proyectos](/images/10-projects-dependency.png)\n\n---\n\nTienes ms ejemplos en el repositorio como [la implementacin un _ErrorHandler_](https://github.com/angularbuilders/angular-blueprint/blob/master/libs/tracer/src/lib/services/error-handler.service.ts). Es un servicio que una vez provedo hace uso del servicio de trazas.\n\nDispones de un _journal_ con indicaciones paso a paso de este tutorial. Consulta directamente la [documentacin](https://angularbuilders.github.io/angular-blueprint/0-mono_repo) del proyecto en GitHub.\n\nLas tareas relativas a este tutorial estn resueltas en el [proyecto 0 - monorepo](https://github.com/angularbuilders/angular-blueprint/projects/1)\n\n![Angular.Builders](/css/images/angular.builders.png)\n\nLa iniciativa [Angular.Builders](https://angular.builders) nace para ayudar a desarrolladores y arquitectos de software como t. Ofrecemos formacin y productos de ayuda y ejemplo como [angular.blueprint](https://angularbuilders.github.io/angular-blueprint/).\n\nPara ms informacin sobre servicios de consultora [ponte en contacto conmigo](https://www.linkedin.com/in/albertobasalo/).\n-->\n\n---\n\n## Resumen\n\nEn definitiva, los grandes desarrollos demandados por bancos, multinacionales o administracin pblica requieren soluciones avanzadas. **Angular** es una plataforma ideal para esos grandes proyectos, pero requiere conocimiento y bases slidas para sacarle partido.\n\nCon este tutorial empiezas tu formacin [avanzada en Angular](../tag/Avanzado/) para poder afrontar retos de tamao industrial. Contina aprendiendo a crear y ejecutar pruebas automatizadas creando [tests unitarios con Jest y e2e con Cypress en Angular](../tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular). Todos esos detalles se tratan en el [curso avanzado online](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-10-nx-mono-repositorios-en-Angular.md","raw":"---\ntitle: Nx, mono repositorios en Angular\npermalink: nx-mono-repositorios-en-Angular\ndate: 2019-09-03 18:59:27\ntags:\n- Angular\n- Angular8\n- Nx\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-10_monorepo.png\n---\n\n![nx-mono-repositorios-en-Angular](/images/tutorial-angular-10_monorepo.png)\n\nEmpiezo este **tutorial de Angular Avanzado** con la frase con la que acab un artculo de opinin sobre arquitectura de software acerca de [Angular para grandes aplicaciones.](https://medium.com/@albertobasalo71/angular-para-grandes-aplicaciones-b66786fd3032)\n\n> Angular y las decisiones de diseo que le acompaan tienen como objetivo facilitar el desarrollo y mantenimiento a medio y largo plazo de aplicaciones web no triviales.\n\nLas empresas de desarrollo y los clientes finales que escogen **Angular**, suelen ser de tamao medio o grande. Cuanto mayor sea el problema ms destaca este _framework_. Y tarde o temprano esos grandes proyectos necesitarn compartir o reutilizar cdigo. La herramienta [Nx de Nrwl](https://nx.dev/angular) ayuda en esa tarea facilitando la creacin de espacios de trabajo multi proyecto: **los mono repositorios.**\n\n<!-- more -->\n\nPartiendo de cero y usando las herramientas de [Nrwl.io/](https://nrwl.io/) crearemos un _blueprint_ para desarrollar grandes aplicaciones. Al finalizar tendrs, en el mismo repositorio, un par de aplicaciones y varias libreras reutilizables creadas con los _Nx power-ups_.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n## Tabla de Contenido:\n\n[1. Crear el repositorio.](./#1-Crear-el-repositorio)\n\n[2. Generar varias aplicaciones con Angular.](./#2-Generar-una-SPA-con-Angular)\n\n[3. Tener una biblioteca TypeScript con lgica de dominio.](./#3-Tener-una-biblioteca-TypeScript-con-logica-de-dominio)\n\n[4. Tener una biblioteca Angular con componentes de interfaz.](./#4-Tener-una-biblioteca-Angular-con-componentes-de-interfaz)\n\n[5. Tener una biblioteca Angular con servicios de datos.](./#5-Tener-una-biblioteca-Angular-con-servicios-de-datos)\n\n[Diagramas](./#Diagramas)\n\n[Resumen](./#Resumen)\n\n---\n\n# 1. Crear el repositorio\n\n```yaml\n Como: arquitecto de software\n quiero: disponer de un espacio de trabajo nico\n para: crear aplicaciones y libreras.\n ```\n\nLo primero ser preparar las herramientas. **Nx** es un complemento del **CLI** as que debemos tener este ltimo disponible. Voy a emplear [yarn](https://yarnpkg.com/lang/en/) para la instalacin de paquetes y la ejecucin de comandos. Pero se muestran las instrucciones alternativas con `npm`. El repositorio siempre lo creo vaco y despus agrego las capacidades especficas para **Angular**.\n\n```bash\n# Add latest Angular CLI\nyarn global add @angular/cli\n# Sets yarn as default packager for cli\nng config -g cli.packageManager yarn\n\n# Creates empty repository\nyarn create nx-workspace angular-blueprint\n\n# also with NPM...\nnpm i -g @angular/cli\nnpx create-nx-workspace@latest angular-blueprint\n```\n\n---\n\n# 2. Generar una SPA con Angular\n\n```yaml\nAs a: customer,\n  I want: to see a shop\n  so that: I can buy products\n\n As a: seller,\n  I want: to see a warehouse\n  so that: I can take control\n```\n\nLos prximos comandos te sonarn a los mismo del **angular-cli**. Es normal, pues **Nx** utiliza y mejora las capacidades de la herramienta original. La diferencia est en que la recin creada aplicacin, en lugar de nacer en la raz del _workspace_, va la carpeta especfica `/apps`.\n\n```bash\n# Add Angular capabilities\nyarn add --dev @nrwl/angular\n\n# Generate an Angular application with nx power-ups\nng g @nrwl/schematics:application shop --inlineStyle --routing --directory= -p ab-shop\n# Start default !!!\nyarn start\n# Generate an Angular application with nx power-ups\nng g @nrwl/schematics:application warehouse --inlineStyle --routing --directory= -p ab-warehouse\n# Start especific !!!\nng serve warehouse --port=4202 -o\n```\n\nAmbas aplicaciones comparten la configuracin del `angular.json` y las dems herramientas de ayuda como **tslint** y **prettier**. Destaca mucho que tambin que compartan `/node_modules`, lo cual se agradece en el tiempo y en el espacio.\n\nCon nx puedes crear tambin aplicaciones de Backend. Por ejemplo un API REST hecha con [NestJS](https://nestjs.com/). Para acceder a los generadores especfico tienes que instalarlos antes. por ejemplo:\n\n```bash\nyarn add --dev @nrwl/nest\nng g @nrwl/nest:application api\nng serve api\n```\n\nAl tener varias aplicaciones es conveniente disponer de scripts especficos para cada una. Por ejemplo yo en el `package.json` tenda algo as.\n\n```json\n{\n  \"start:shop\": \"ng serve shop --port=4201 -o\",\n  \"build:shop\": \"ng build shop --prod\",\n  \"test:shop\": \"ng test shop\",\n  \"start:warehouse\": \"ng serve warehouse --port=4202 -o\",\n  \"build:warehouse\": \"ng build warehouse --prod\",\n  \"test:warehouse\": \"ng test warehouse\",\n  \"start:api\": \"ng serve api\",\n  \"build:api\": \"ng build api --prod\",\n  \"test:api\": \"ng test api\",\n}\n```\n\nPor supuesto que todos estos comando se pueden lanzar visualmente mediante la extensin [Angular Console para VSCode](https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console). Te recomiendo adems estas otras extensiones:\n\n```json\n{\n  \"recommendations\": [\n    \"nrwl.angular-console\",\n    \"angular.ng-template\",\n    \"ms-vscode.vscode-typescript-tslint-plugin\",\n    \"esbenp.prettier-vscode\",\n    \"pkief.material-icon-theme\",\n    \"christian-kohler.path-intellisense\",\n    \"ban.spellright\",\n    \"johnpapa.angular-essentials\"\n  ]\n}\n```\n\n---\n\n\n# 3. Tener una biblioteca TypeScript con lgica de dominio.\n\n```yaml\n Como: arquitecto\n quiero: tener una biblioteca en TypeScript con lgica de dominio\n de modo que: pueda usarla con varios frameworks o incluso en puro JavaScript.\n ```\n\nMs temprano que tarde aparecern funcionalidades comunes a distintas aplicaciones. Validadores genricos, utilidades o casos concretos de un cliente pero que se usan en todos sus desarrollos. En este ejemplo partimos de la necesidad comn de un sistema de saludos (un mensaje, vaya). Y para ello empezamos por definir una `interface` pblica reutilizable.\n\nUn poco de arquitectura de software. Todo lo que podamos programar y que no dependa de un _framework_ debemos encapsularlo en libreras independientes. De esa forma puede reutilizarse con otras tecnologas o sobrevivir dignamente a la evolucin o desaparicin de Angular.\n\nLo primero ser crear la librera. Pero esta vez no usaremos los _schematics_ del **cli**, si no los propios de **nrwl**. La idea es usarla como la **capa de dominio de la arquitectura**. En ella pondremos los modelos y servicios de lgica de negocio con las menores dependencias posibles. Repito lo fundamental: minimizar las dependencias. En concreto no dependeremos de Angular, lo cual permitira usarlo con otros _frameworks_ actuales o futuros.\n\n```bash\n# Generate a Type Script library with nx power-ups\nng generate @nrwl/workspace:library domain --directory=shared\n```\nPor ahora no te preocupes de la implementacin. La muestro para destacar las dos cosas que considero ms importantes:\n\n- No hay ninguna referencia explcita a _Angular_.\n\n- Lo que quieras exportar debe indicarse en el fichero `index.ts`.\n\nPor lo dems es puro _TypeScript_; en una carpeta con intenciones bien claras: `models/` creo de forma manual el siguiente fichero:\n\n`libs\\shared\\domain\\src\\lib\\models\\greetings.interface.ts`\n\n```typescript\nexport interface Greetings {\n  message: string;\n}\n```\nal no disponer del sistema de mdulos de angular tengo que exportarlo en el ndice de la librera.\n\n`libs\\shared\\domain\\src\\index.ts`\n\n```typescript\nexport * from './lib/models/greetings.interface';\n```\n\nPara localizarlo, Nx crea un alias en el `tsconfig.json`, que puedes retocar a voluntad\n\n```json\n\"paths\": {\n  \"@a-boss/domain\": [\"libs/shared/domain/src/index.ts\"]\n}\n```\n\nYa est listo para seer consumido desde distintos proyectos (Lo har despus en el API y ya mismo en la prxima librera de componentes).\n\n---\n\n# 4. Tener una biblioteca Angular con componentes de interfaz\n\n```yaml\nAs a: customer,\n  I want: to be greeted\n  so that: I feel at home\n\nAs a: seller,\n  I want: to be greeted\n  so that: I feel at home\n```\n\nSi eres una empresa consultora es posible que te encuentres repitiendo funciones o pantallas una y otra vez para distintos clientes. Por supuesto que una gran empresa seguro que se hacen muchas aplicaciones similares, a las que les vendra de maravilla **compartir una biblioteca de componentes**.\n\nPues ahora crear libreras es igual de sencillo que crear aplicaciones. **Nx** las depositar en la carpeta `/libs` y se ocupar de apuntarlas en el `tsconfig.json` para que la importacin desde el resto del proyecto use alias cortos y evidentes.\n\nCrear componentes en un entorno multi proyecto requiere especificar a qu proyecto se asociarn. Para empezar vamos a crear los componentes bsicos para esta funcionalidad en una librera compartida de para interfaz de usuario.\n\n```bash\n# Generate an Angular library with nx power-ups\nng g @nrwl/angular:library ui --directory=shared --prefix=ab-ui --simpleModuleName\n# Generate Greetings Component\nng g component greetings --project=shared-ui --module=ui.module.ts --export --inlineStyle --inlineTemplate\n```\n\nY le damos contenido al componente. Fjate en la importacin de la interfaz `Greetings`.\n\n\n`libs\\shared\\ui\\src\\lib\\greetings\\greetings.component.ts`\n\n```typescript\nimport { Greetings } from '@a-boss/domain';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'ab-ui-greetings',\n  template: `\n    <p>\n      {{ theGreeting.message }}\n    </p>\n  `,\n  styles: []\n})\nexport class GreetingsComponent implements OnInit {\n  public theGreeting: Greetings = { message: 'Hello world' };\n  constructor() {}\n\n  ngOnInit() {}\n}\n```\n---\n\nPuedes usarlos como cualquier otro componente y en cualquier aplicacin del repositorio. Simplemente importando el mdulo en el que se declaran: el `UiModule`. NX se encarga de referenciar cada proyecto en el fichero `tsconfig.json`. De esa forma se facilita su importacin en cualquier otra aplicacin del repositorio.\n\nPrimero importamos el mdulo.\n\n`apps\\shop\\src\\app\\app.module.ts`\n\n```typescript\nimport { UiModule } from '@a-boss/ui';\nimport { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { RouterModule } from '@angular/router';\nimport { AppComponent } from './app.component';\n\n@NgModule({\n  declarations: [AppComponent],\n  imports: [\n    BrowserModule,\n    RouterModule.forRoot([], { initialNavigation: 'enabled' }),\n    UiModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\nY ya podemos incrustar sus componentes pblicos.\n\n`apps\\shop\\src\\app\\app.component.html`\n\n```html\n<ab-ui-greetings></ab-ui-greetings>\n<router-outlet></router-outlet>\n```\n\n`apps\\shop\\src\\app\\app.component.ts`\n\n```typescript\nimport { Component } from '@angular/core';\n\n@Component({\n  selector: 'ab-shop-root',\n  templateUrl: './app.component.html',\n  styles: []\n})\nexport class AppComponent {\n  title = 'shop';\n}\n```\n\n---\n\n# 5. Tener una biblioteca Angular con servicios de datos\n\n```yaml\nAs a: customer,\n  I want: to be greeted by the API :-)\n  so that: I know I am not alone.\n\nAs a: seller,\n  I want: to be greeted by the API :-)\n  so that: I know I am not alone.\n```\n\nAdems de componentes visuales, podemos tener libreras con servicios de lgica o de acceso a datos. Por ejemplo un servicio para comunicarnos con el API podra ser utilizado en diversos proyectos (aplicaciones o libreras).\n\nCon lo ya sabido vamos a crear una librera compartida para acceso a datos.\n\n\n```bash\nng g @nrwl/angular:library data --directory=shared --prefix=ab-data --simpleModuleName\nng g service greetings --project=shared-data --no-flat\n```\n\nEl servicio realiza la llamada http y devuelve un observable.\n\n`libs\\shared\\data\\src\\lib\\greetings\\greetings.service.ts`\n\n```typescript\nimport { Greetings } from '@a-boss/domain';\nimport { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\n@Injectable({\n  providedIn: 'root'\n})\nexport class GreetingsService {\n  private apiUrl = 'http://localhost:3333/api';\n  constructor(private httpClient: HttpClient) {}\n  public getGrettings$(): Observable<Greetings> {\n    return this.httpClient.get<Greetings>(this.apiUrl);\n  }\n}\n```\n\nPara consumir el servicio no hay que hacer nada ms. Pero, para importarlo en TypeScript, necesitmaos que nos lo exporten adecuadamente.\n\n`libs\\shared\\data\\src\\index.ts`\n\n```typescript\nexport * from './lib/data.module';\nexport * from './lib/greetings/greetings.service';\n```\n\n`tsconfig.json`\n\n```json\n\"paths\": {\n  \"@a-boss/domain\": [\"libs/shared/domain/src/index.ts\"]\n}\n```\n\nY ahora consumirlo ya no es un problema. Por ejemplo directamente en el componente.\n\n`libs\\shared\\ui\\src\\lib\\greetings\\greetings.component.ts`\n\n```typescript\nimport { GreetingsService } from '@a-boss/data';\nimport { Greetings } from '@a-boss/domain';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'ab-ui-greetings',\n  template: `\n    <p>\n      {{ theGreeting.message }}\n    </p>\n  `,\n  styles: []\n})\nexport class GreetingsComponent implements OnInit {\n  public theGreeting: Greetings = { message: 'Hello world' };\n  constructor(private greetingsService: GreetingsService) {}\n  public ngOnInit() {\n    this.greetingsService.getGrettings$().subscribe(this.appendApiMessage);\n  }\n  private appendApiMessage = (apiGreetings: Greetings) =>\n    (this.theGreeting.message += ' and ' + apiGreetings.message);\n}\n```\n\nYa que estamos accediendo al API, podemos aprovechar para adecuar sus tipos a la interfaz declarada en el dominio. Fjate lo familiar que resulta este cdigo **NodeJS** gracias al framework [nest](https://nestjs.com/).\n\n`apps\\api\\src\\app\\app.controller.ts`\n\n```typescript\nimport { Greetings } from '@a-boss/domain';\nimport { Controller, Get } from '@nestjs/common';\nimport { AppService } from './app.service';\n\n@Controller()\nexport class AppController {\n  constructor(private readonly appService: AppService) {}\n\n  @Get()\n  getData(): Greetings {\n    return this.appService.getData();\n  }\n}\n```\n\n\n<!-- ## Diagramas\n\nEl siguiente diagrama nos muestra a vista de pjaro las distintas libreras y aplicaciones que tenemos en este momento. Fjate en la jerarqua de dependencias : Aplicaciones -> Libreras Angular -> Libreras del Dominio.\n\n![Dependencias entre proyectos](/images/10-projects-dependency.png)\n\n---\n\nTienes ms ejemplos en el repositorio como [la implementacin un _ErrorHandler_](https://github.com/angularbuilders/angular-blueprint/blob/master/libs/tracer/src/lib/services/error-handler.service.ts). Es un servicio que una vez provedo hace uso del servicio de trazas.\n\nDispones de un _journal_ con indicaciones paso a paso de este tutorial. Consulta directamente la [documentacin](https://angularbuilders.github.io/angular-blueprint/0-mono_repo) del proyecto en GitHub.\n\nLas tareas relativas a este tutorial estn resueltas en el [proyecto 0 - monorepo](https://github.com/angularbuilders/angular-blueprint/projects/1)\n\n![Angular.Builders](/css/images/angular.builders.png)\n\nLa iniciativa [Angular.Builders](https://angular.builders) nace para ayudar a desarrolladores y arquitectos de software como t. Ofrecemos formacin y productos de ayuda y ejemplo como [angular.blueprint](https://angularbuilders.github.io/angular-blueprint/).\n\nPara ms informacin sobre servicios de consultora [ponte en contacto conmigo](https://www.linkedin.com/in/albertobasalo/).\n-->\n\n---\n\n## Resumen\n\nEn definitiva, los grandes desarrollos demandados por bancos, multinacionales o administracin pblica requieren soluciones avanzadas. **Angular** es una plataforma ideal para esos grandes proyectos, pero requiere conocimiento y bases slidas para sacarle partido.\n\nCon este tutorial empiezas tu formacin [avanzada en Angular](../tag/Avanzado/) para poder afrontar retos de tamao industrial. Contina aprendiendo a crear y ejecutar pruebas automatizadas creando [tests unitarios con Jest y e2e con Cypress en Angular](../tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular). Todos esos detalles se tratan en el [curso avanzado online](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"nx-mono-repositorios-en-Angular","published":1,"updated":"2019-09-23T11:20:34.965Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab16000gbss3cmtwqgdm","content":"<p><img src=\"/images/tutorial-angular-10_monorepo.png\" alt=\"nx-mono-repositorios-en-Angular\"></p><p>Empiezo este <strong>tutorial de Angular Avanzado</strong> con la frase con la que acab un artculo de opinin sobre arquitectura de software acerca de <a href=\"https://medium.com/@albertobasalo71/angular-para-grandes-aplicaciones-b66786fd3032\" target=\"_blank\" rel=\"noopener\">Angular para grandes aplicaciones.</a></p><blockquote><p>Angular y las decisiones de diseo que le acompaan tienen como objetivo facilitar el desarrollo y mantenimiento a medio y largo plazo de aplicaciones web no triviales.</p></blockquote><p>Las empresas de desarrollo y los clientes finales que escogen <strong>Angular</strong>, suelen ser de tamao medio o grande. Cuanto mayor sea el problema ms destaca este <em>framework</em>. Y tarde o temprano esos grandes proyectos necesitarn compartir o reutilizar cdigo. La herramienta <a href=\"https://nx.dev/angular\" target=\"_blank\" rel=\"noopener\">Nx de Nrwl</a> ayuda en esa tarea facilitando la creacin de espacios de trabajo multi proyecto: <strong>los mono repositorios.</strong></p><a id=\"more\"></a><p>Partiendo de cero y usando las herramientas de <a href=\"https://nrwl.io/\" target=\"_blank\" rel=\"noopener\">Nrwl.io/</a> crearemos un <em>blueprint</em> para desarrollar grandes aplicaciones. Al finalizar tendrs, en el mismo repositorio, un par de aplicaciones y varias libreras reutilizables creadas con los <em>Nx power-ups</em>.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id=\"Tabla-de-Contenido\"><a href=\"#Tabla-de-Contenido\" class=\"headerlink\" title=\"Tabla de Contenido:\"></a>Tabla de Contenido:</h2><p><a href=\"./#1-Crear-el-repositorio\">1. Crear el repositorio.</a></p><p><a href=\"./#2-Generar-una-SPA-con-Angular\">2. Generar varias aplicaciones con Angular.</a></p><p><a href=\"./#3-Tener-una-biblioteca-TypeScript-con-logica-de-dominio\">3. Tener una biblioteca TypeScript con lgica de dominio.</a></p><p><a href=\"./#4-Tener-una-biblioteca-Angular-con-componentes-de-interfaz\">4. Tener una biblioteca Angular con componentes de interfaz.</a></p><p><a href=\"./#5-Tener-una-biblioteca-Angular-con-servicios-de-datos\">5. Tener una biblioteca Angular con servicios de datos.</a></p><p><a href=\"./#Diagramas\">Diagramas</a></p><p><a href=\"./#Resumen\">Resumen</a></p><hr><h1 id=\"1-Crear-el-repositorio\"><a href=\"#1-Crear-el-repositorio\" class=\"headerlink\" title=\"1. Crear el repositorio\"></a>1. Crear el repositorio</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">Como:</span> <span class=\"string\">arquitecto</span> <span class=\"string\">de</span> <span class=\"string\">software</span></span><br><span class=\"line\"><span class=\"attr\">quiero:</span> <span class=\"string\">disponer</span> <span class=\"string\">de</span> <span class=\"string\">un</span> <span class=\"string\">espacio</span> <span class=\"string\">de</span> <span class=\"string\">trabajo</span> <span class=\"string\">nico</span></span><br><span class=\"line\"><span class=\"attr\">para:</span> <span class=\"string\">crear</span> <span class=\"string\">aplicaciones</span> <span class=\"string\">y</span> <span class=\"string\">libreras.</span></span><br></pre></td></tr></table></figure><p>Lo primero ser preparar las herramientas. <strong>Nx</strong> es un complemento del <strong>CLI</strong> as que debemos tener este ltimo disponible. Voy a emplear <a href=\"https://yarnpkg.com/lang/en/\" target=\"_blank\" rel=\"noopener\">yarn</a> para la instalacin de paquetes y la ejecucin de comandos. Pero se muestran las instrucciones alternativas con <code>npm</code>. El repositorio siempre lo creo vaco y despus agrego las capacidades especficas para <strong>Angular</strong>.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Add latest Angular CLI</span></span><br><span class=\"line\">yarn global add @angular/cli</span><br><span class=\"line\"><span class=\"comment\"># Sets yarn as default packager for cli</span></span><br><span class=\"line\">ng config -g cli.packageManager yarn</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Creates empty repository</span></span><br><span class=\"line\">yarn create nx-workspace angular-blueprint</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># also with NPM...</span></span><br><span class=\"line\">npm i -g @angular/cli</span><br><span class=\"line\">npx create-nx-workspace@latest angular-blueprint</span><br></pre></td></tr></table></figure><hr><h1 id=\"2-Generar-una-SPA-con-Angular\"><a href=\"#2-Generar-una-SPA-con-Angular\" class=\"headerlink\" title=\"2. Generar una SPA con Angular\"></a>2. Generar una SPA con Angular</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">shop</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">buy</span> <span class=\"string\">products</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">warehouse</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">take</span> <span class=\"string\">control</span></span><br></pre></td></tr></table></figure><p>Los prximos comandos te sonarn a los mismo del <strong>angular-cli</strong>. Es normal, pues <strong>Nx</strong> utiliza y mejora las capacidades de la herramienta original. La diferencia est en que la recin creada aplicacin, en lugar de nacer en la raz del <em>workspace</em>, va la carpeta especfica <code>/apps</code>.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Add Angular capabilities</span></span><br><span class=\"line\">yarn add --dev @nrwl/angular</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Generate an Angular application with nx power-ups</span></span><br><span class=\"line\">ng g @nrwl/schematics:application shop --inlineStyle --routing --directory= -p ab-shop</span><br><span class=\"line\"><span class=\"comment\"># Start default !!!</span></span><br><span class=\"line\">yarn start</span><br><span class=\"line\"><span class=\"comment\"># Generate an Angular application with nx power-ups</span></span><br><span class=\"line\">ng g @nrwl/schematics:application warehouse --inlineStyle --routing --directory= -p ab-warehouse</span><br><span class=\"line\"><span class=\"comment\"># Start especific !!!</span></span><br><span class=\"line\">ng serve warehouse --port=4202 -o</span><br></pre></td></tr></table></figure><p>Ambas aplicaciones comparten la configuracin del <code>angular.json</code> y las dems herramientas de ayuda como <strong>tslint</strong> y <strong>prettier</strong>. Destaca mucho que tambin que compartan <code>/node_modules</code>, lo cual se agradece en el tiempo y en el espacio.</p><p>Con nx puedes crear tambin aplicaciones de Backend. Por ejemplo un API REST hecha con <a href=\"https://nestjs.com/\" target=\"_blank\" rel=\"noopener\">NestJS</a>. Para acceder a los generadores especfico tienes que instalarlos antes. por ejemplo:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn add --dev @nrwl/nest</span><br><span class=\"line\">ng g @nrwl/nest:application api</span><br><span class=\"line\">ng serve api</span><br></pre></td></tr></table></figure><p>Al tener varias aplicaciones es conveniente disponer de scripts especficos para cada una. Por ejemplo yo en el <code>package.json</code> tenda algo as.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"start:shop\"</span>: <span class=\"string\">\"ng serve shop --port=4201 -o\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"build:shop\"</span>: <span class=\"string\">\"ng build shop --prod\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"test:shop\"</span>: <span class=\"string\">\"ng test shop\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"start:warehouse\"</span>: <span class=\"string\">\"ng serve warehouse --port=4202 -o\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"build:warehouse\"</span>: <span class=\"string\">\"ng build warehouse --prod\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"test:warehouse\"</span>: <span class=\"string\">\"ng test warehouse\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"start:api\"</span>: <span class=\"string\">\"ng serve api\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"build:api\"</span>: <span class=\"string\">\"ng build api --prod\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"test:api\"</span>: <span class=\"string\">\"ng test api\"</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Por supuesto que todos estos comando se pueden lanzar visualmente mediante la extensin <a href=\"https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console\" target=\"_blank\" rel=\"noopener\">Angular Console para VSCode</a>. Te recomiendo adems estas otras extensiones:</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"recommendations\"</span>: [</span><br><span class=\"line\">    <span class=\"string\">\"nrwl.angular-console\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"angular.ng-template\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"ms-vscode.vscode-typescript-tslint-plugin\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"esbenp.prettier-vscode\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"pkief.material-icon-theme\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"christian-kohler.path-intellisense\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"ban.spellright\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"johnpapa.angular-essentials\"</span></span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><h1 id=\"3-Tener-una-biblioteca-TypeScript-con-logica-de-dominio\"><a href=\"#3-Tener-una-biblioteca-TypeScript-con-logica-de-dominio\" class=\"headerlink\" title=\"3. Tener una biblioteca TypeScript con lgica de dominio.\"></a>3. Tener una biblioteca TypeScript con lgica de dominio.</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">Como:</span> <span class=\"string\">arquitecto</span></span><br><span class=\"line\"><span class=\"attr\">quiero:</span> <span class=\"string\">tener</span> <span class=\"string\">una</span> <span class=\"string\">biblioteca</span> <span class=\"string\">en</span> <span class=\"string\">TypeScript</span> <span class=\"string\">con</span> <span class=\"string\">lgica</span> <span class=\"string\">de</span> <span class=\"string\">dominio</span></span><br><span class=\"line\"><span class=\"string\">de</span> <span class=\"string\">modo</span> <span class=\"attr\">que:</span> <span class=\"string\">pueda</span> <span class=\"string\">usarla</span> <span class=\"string\">con</span> <span class=\"string\">varios</span> <span class=\"string\">frameworks</span> <span class=\"string\">o</span> <span class=\"string\">incluso</span> <span class=\"string\">en</span> <span class=\"string\">puro</span> <span class=\"string\">JavaScript.</span></span><br></pre></td></tr></table></figure><p>Ms temprano que tarde aparecern funcionalidades comunes a distintas aplicaciones. Validadores genricos, utilidades o casos concretos de un cliente pero que se usan en todos sus desarrollos. En este ejemplo partimos de la necesidad comn de un sistema de saludos (un mensaje, vaya). Y para ello empezamos por definir una <code>interface</code> pblica reutilizable.</p><p>Un poco de arquitectura de software. Todo lo que podamos programar y que no dependa de un <em>framework</em> debemos encapsularlo en libreras independientes. De esa forma puede reutilizarse con otras tecnologas o sobrevivir dignamente a la evolucin o desaparicin de Angular.</p><p>Lo primero ser crear la librera. Pero esta vez no usaremos los <em>schematics</em> del <strong>cli</strong>, si no los propios de <strong>nrwl</strong>. La idea es usarla como la <strong>capa de dominio de la arquitectura</strong>. En ella pondremos los modelos y servicios de lgica de negocio con las menores dependencias posibles. Repito lo fundamental: minimizar las dependencias. En concreto no dependeremos de Angular, lo cual permitira usarlo con otros <em>frameworks</em> actuales o futuros.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Generate a Type Script library with nx power-ups</span></span><br><span class=\"line\">ng generate @nrwl/workspace:library domain --directory=shared</span><br></pre></td></tr></table></figure><p>Por ahora no te preocupes de la implementacin. La muestro para destacar las dos cosas que considero ms importantes:</p><ul><li><p>No hay ninguna referencia explcita a <em>Angular</em>.</p></li><li><p>Lo que quieras exportar debe indicarse en el fichero <code>index.ts</code>.</p></li></ul><p>Por lo dems es puro <em>TypeScript</em>; en una carpeta con intenciones bien claras: <code>models/</code> creo de forma manual el siguiente fichero:</p><p><code>libs\\shared\\domain\\src\\lib\\models\\greetings.interface.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Greetings &#123;</span><br><span class=\"line\">  message: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>al no disponer del sistema de mdulos de angular tengo que exportarlo en el ndice de la librera.</p><p><code>libs\\shared\\domain\\src\\index.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> * <span class=\"keyword\">from</span> <span class=\"string\">'./lib/models/greetings.interface'</span>;</span><br></pre></td></tr></table></figure><p>Para localizarlo, Nx crea un alias en el <code>tsconfig.json</code>, que puedes retocar a voluntad</p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"paths\": &#123;</span><br><span class=\"line\">  \"@a-boss/domain\": [\"libs/shared/domain/src/index.ts\"]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ya est listo para seer consumido desde distintos proyectos (Lo har despus en el API y ya mismo en la prxima librera de componentes).</p><hr><h1 id=\"4-Tener-una-biblioteca-Angular-con-componentes-de-interfaz\"><a href=\"#4-Tener-una-biblioteca-Angular-con-componentes-de-interfaz\" class=\"headerlink\" title=\"4. Tener una biblioteca Angular con componentes de interfaz\"></a>4. Tener una biblioteca Angular con componentes de interfaz</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">be</span> <span class=\"string\">greeted</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">feel</span> <span class=\"string\">at</span> <span class=\"string\">home</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">be</span> <span class=\"string\">greeted</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">feel</span> <span class=\"string\">at</span> <span class=\"string\">home</span></span><br></pre></td></tr></table></figure><p>Si eres una empresa consultora es posible que te encuentres repitiendo funciones o pantallas una y otra vez para distintos clientes. Por supuesto que una gran empresa seguro que se hacen muchas aplicaciones similares, a las que les vendra de maravilla <strong>compartir una biblioteca de componentes</strong>.</p><p>Pues ahora crear libreras es igual de sencillo que crear aplicaciones. <strong>Nx</strong> las depositar en la carpeta <code>/libs</code> y se ocupar de apuntarlas en el <code>tsconfig.json</code> para que la importacin desde el resto del proyecto use alias cortos y evidentes.</p><p>Crear componentes en un entorno multi proyecto requiere especificar a qu proyecto se asociarn. Para empezar vamos a crear los componentes bsicos para esta funcionalidad en una librera compartida de para interfaz de usuario.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Generate an Angular library with nx power-ups</span></span><br><span class=\"line\">ng g @nrwl/angular:library ui --directory=shared --prefix=ab-ui --simpleModuleName</span><br><span class=\"line\"><span class=\"comment\"># Generate Greetings Component</span></span><br><span class=\"line\">ng g component greetings --project=shared-ui --module=ui.module.ts --<span class=\"built_in\">export</span> --inlineStyle --inlineTemplate</span><br></pre></td></tr></table></figure><p>Y le damos contenido al componente. Fjate en la importacin de la interfaz <code>Greetings</code>.</p><p><code>libs\\shared\\ui\\src\\lib\\greetings\\greetings.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Greetings &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/domain'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-ui-greetings'</span>,</span><br><span class=\"line\">  template: <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">    &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"string\">      &#123;&#123; theGreeting.message &#125;&#125;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"string\">  `</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> GreetingsComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> theGreeting: Greetings = &#123; message: <span class=\"string\">'Hello world'</span> &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><p>Puedes usarlos como cualquier otro componente y en cualquier aplicacin del repositorio. Simplemente importando el mdulo en el que se declaran: el <code>UiModule</code>. NX se encarga de referenciar cada proyecto en el fichero <code>tsconfig.json</code>. De esa forma se facilita su importacin en cualquier otra aplicacin del repositorio.</p><p>Primero importamos el mdulo.</p><p><code>apps\\shop\\src\\app\\app.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; UiModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/ui'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; BrowserModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    BrowserModule,</span><br><span class=\"line\">    RouterModule.forRoot([], &#123; initialNavigation: <span class=\"string\">'enabled'</span> &#125;),</span><br><span class=\"line\">    UiModule</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Y ya podemos incrustar sus componentes pblicos.</p><p><code>apps\\shop\\src\\app\\app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-ui-greetings</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-ui-greetings</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>apps\\shop\\src\\app\\app.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-shop-root'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./app.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;</span><br><span class=\"line\">  title = <span class=\"string\">'shop'</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><h1 id=\"5-Tener-una-biblioteca-Angular-con-servicios-de-datos\"><a href=\"#5-Tener-una-biblioteca-Angular-con-servicios-de-datos\" class=\"headerlink\" title=\"5. Tener una biblioteca Angular con servicios de datos\"></a>5. Tener una biblioteca Angular con servicios de datos</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">be</span> <span class=\"string\">greeted</span> <span class=\"string\">by</span> <span class=\"string\">the</span> <span class=\"string\">API</span> <span class=\"string\">:-)</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">know</span> <span class=\"string\">I</span> <span class=\"string\">am</span> <span class=\"string\">not</span> <span class=\"string\">alone.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">be</span> <span class=\"string\">greeted</span> <span class=\"string\">by</span> <span class=\"string\">the</span> <span class=\"string\">API</span> <span class=\"string\">:-)</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">know</span> <span class=\"string\">I</span> <span class=\"string\">am</span> <span class=\"string\">not</span> <span class=\"string\">alone.</span></span><br></pre></td></tr></table></figure><p>Adems de componentes visuales, podemos tener libreras con servicios de lgica o de acceso a datos. Por ejemplo un servicio para comunicarnos con el API podra ser utilizado en diversos proyectos (aplicaciones o libreras).</p><p>Con lo ya sabido vamos a crear una librera compartida para acceso a datos.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @nrwl/angular:library data --directory=shared --prefix=ab-data --simpleModuleName</span><br><span class=\"line\">ng g service greetings --project=shared-data --no-flat</span><br></pre></td></tr></table></figure><p>El servicio realiza la llamada http y devuelve un observable.</p><p><code>libs\\shared\\data\\src\\lib\\greetings\\greetings.service.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Greetings &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/domain'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpClient &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Injectable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Observable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'rxjs'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> GreetingsService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> apiUrl = <span class=\"string\">'http://localhost:3333/api'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> getGrettings$(): Observable&lt;Greetings&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.httpClient.get&lt;Greetings&gt;(<span class=\"keyword\">this</span>.apiUrl);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Para consumir el servicio no hay que hacer nada ms. Pero, para importarlo en TypeScript, necesitmaos que nos lo exporten adecuadamente.</p><p><code>libs\\shared\\data\\src\\index.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> * <span class=\"keyword\">from</span> <span class=\"string\">'./lib/data.module'</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> * <span class=\"keyword\">from</span> <span class=\"string\">'./lib/greetings/greetings.service'</span>;</span><br></pre></td></tr></table></figure><p><code>tsconfig.json</code></p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"paths\": &#123;</span><br><span class=\"line\">  \"@a-boss/domain\": [\"libs/shared/domain/src/index.ts\"]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y ahora consumirlo ya no es un problema. Por ejemplo directamente en el componente.</p><p><code>libs\\shared\\ui\\src\\lib\\greetings\\greetings.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; GreetingsService &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/data'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Greetings &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/domain'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-ui-greetings'</span>,</span><br><span class=\"line\">  template: <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">    &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"string\">      &#123;&#123; theGreeting.message &#125;&#125;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"string\">  `</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> GreetingsComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> theGreeting: Greetings = &#123; message: <span class=\"string\">'Hello world'</span> &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> greetingsService: GreetingsService</span>) &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.greetingsService.getGrettings$().subscribe(<span class=\"keyword\">this</span>.appendApiMessage);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> appendApiMessage = <span class=\"function\">(<span class=\"params\">apiGreetings: Greetings</span>) =&gt;</span></span><br><span class=\"line\">    (<span class=\"keyword\">this</span>.theGreeting.message += <span class=\"string\">' and '</span> + apiGreetings.message);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ya que estamos accediendo al API, podemos aprovechar para adecuar sus tipos a la interfaz declarada en el dominio. Fjate lo familiar que resulta este cdigo <strong>NodeJS</strong> gracias al framework <a href=\"https://nestjs.com/\" target=\"_blank\" rel=\"noopener\">nest</a>.</p><p><code>apps\\api\\src\\app\\app.controller.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Greetings &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/domain'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Controller, Get &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@nestjs/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppService &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.service'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Controller</span>()</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppController &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> readonly appService: AppService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Get</span>()</span><br><span class=\"line\">  getData(): Greetings &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.appService.getData();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id=\"Resumen\"><a href=\"#Resumen\" class=\"headerlink\" title=\"Resumen\"></a>Resumen</h2><p>En definitiva, los grandes desarrollos demandados por bancos, multinacionales o administracin pblica requieren soluciones avanzadas. <strong>Angular</strong> es una plataforma ideal para esos grandes proyectos, pero requiere conocimiento y bases slidas para sacarle partido.</p><p>Con este tutorial empiezas tu formacin <a href=\"../tag/Avanzado/\">avanzada en Angular</a> para poder afrontar retos de tamao industrial. Contina aprendiendo a crear y ejecutar pruebas automatizadas creando <a href=\"../tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular\">tests unitarios con Jest y e2e con Cypress en Angular</a>. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-10_monorepo.png\" alt=\"nx-mono-repositorios-en-Angular\"></p><p>Empiezo este <strong>tutorial de Angular Avanzado</strong> con la frase con la que acab un artculo de opinin sobre arquitectura de software acerca de <a href=\"https://medium.com/@albertobasalo71/angular-para-grandes-aplicaciones-b66786fd3032\" target=\"_blank\" rel=\"noopener\">Angular para grandes aplicaciones.</a></p><blockquote><p>Angular y las decisiones de diseo que le acompaan tienen como objetivo facilitar el desarrollo y mantenimiento a medio y largo plazo de aplicaciones web no triviales.</p></blockquote><p>Las empresas de desarrollo y los clientes finales que escogen <strong>Angular</strong>, suelen ser de tamao medio o grande. Cuanto mayor sea el problema ms destaca este <em>framework</em>. Y tarde o temprano esos grandes proyectos necesitarn compartir o reutilizar cdigo. La herramienta <a href=\"https://nx.dev/angular\" target=\"_blank\" rel=\"noopener\">Nx de Nrwl</a> ayuda en esa tarea facilitando la creacin de espacios de trabajo multi proyecto: <strong>los mono repositorios.</strong></p>","more":"<p>Partiendo de cero y usando las herramientas de <a href=\"https://nrwl.io/\" target=\"_blank\" rel=\"noopener\">Nrwl.io/</a> crearemos un <em>blueprint</em> para desarrollar grandes aplicaciones. Al finalizar tendrs, en el mismo repositorio, un par de aplicaciones y varias libreras reutilizables creadas con los <em>Nx power-ups</em>.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id=\"Tabla-de-Contenido\"><a href=\"#Tabla-de-Contenido\" class=\"headerlink\" title=\"Tabla de Contenido:\"></a>Tabla de Contenido:</h2><p><a href=\"./#1-Crear-el-repositorio\">1. Crear el repositorio.</a></p><p><a href=\"./#2-Generar-una-SPA-con-Angular\">2. Generar varias aplicaciones con Angular.</a></p><p><a href=\"./#3-Tener-una-biblioteca-TypeScript-con-logica-de-dominio\">3. Tener una biblioteca TypeScript con lgica de dominio.</a></p><p><a href=\"./#4-Tener-una-biblioteca-Angular-con-componentes-de-interfaz\">4. Tener una biblioteca Angular con componentes de interfaz.</a></p><p><a href=\"./#5-Tener-una-biblioteca-Angular-con-servicios-de-datos\">5. Tener una biblioteca Angular con servicios de datos.</a></p><p><a href=\"./#Diagramas\">Diagramas</a></p><p><a href=\"./#Resumen\">Resumen</a></p><hr><h1 id=\"1-Crear-el-repositorio\"><a href=\"#1-Crear-el-repositorio\" class=\"headerlink\" title=\"1. Crear el repositorio\"></a>1. Crear el repositorio</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">Como:</span> <span class=\"string\">arquitecto</span> <span class=\"string\">de</span> <span class=\"string\">software</span></span><br><span class=\"line\"><span class=\"attr\">quiero:</span> <span class=\"string\">disponer</span> <span class=\"string\">de</span> <span class=\"string\">un</span> <span class=\"string\">espacio</span> <span class=\"string\">de</span> <span class=\"string\">trabajo</span> <span class=\"string\">nico</span></span><br><span class=\"line\"><span class=\"attr\">para:</span> <span class=\"string\">crear</span> <span class=\"string\">aplicaciones</span> <span class=\"string\">y</span> <span class=\"string\">libreras.</span></span><br></pre></td></tr></table></figure><p>Lo primero ser preparar las herramientas. <strong>Nx</strong> es un complemento del <strong>CLI</strong> as que debemos tener este ltimo disponible. Voy a emplear <a href=\"https://yarnpkg.com/lang/en/\" target=\"_blank\" rel=\"noopener\">yarn</a> para la instalacin de paquetes y la ejecucin de comandos. Pero se muestran las instrucciones alternativas con <code>npm</code>. El repositorio siempre lo creo vaco y despus agrego las capacidades especficas para <strong>Angular</strong>.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Add latest Angular CLI</span></span><br><span class=\"line\">yarn global add @angular/cli</span><br><span class=\"line\"><span class=\"comment\"># Sets yarn as default packager for cli</span></span><br><span class=\"line\">ng config -g cli.packageManager yarn</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Creates empty repository</span></span><br><span class=\"line\">yarn create nx-workspace angular-blueprint</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># also with NPM...</span></span><br><span class=\"line\">npm i -g @angular/cli</span><br><span class=\"line\">npx create-nx-workspace@latest angular-blueprint</span><br></pre></td></tr></table></figure><hr><h1 id=\"2-Generar-una-SPA-con-Angular\"><a href=\"#2-Generar-una-SPA-con-Angular\" class=\"headerlink\" title=\"2. Generar una SPA con Angular\"></a>2. Generar una SPA con Angular</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">shop</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">buy</span> <span class=\"string\">products</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">warehouse</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">take</span> <span class=\"string\">control</span></span><br></pre></td></tr></table></figure><p>Los prximos comandos te sonarn a los mismo del <strong>angular-cli</strong>. Es normal, pues <strong>Nx</strong> utiliza y mejora las capacidades de la herramienta original. La diferencia est en que la recin creada aplicacin, en lugar de nacer en la raz del <em>workspace</em>, va la carpeta especfica <code>/apps</code>.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Add Angular capabilities</span></span><br><span class=\"line\">yarn add --dev @nrwl/angular</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Generate an Angular application with nx power-ups</span></span><br><span class=\"line\">ng g @nrwl/schematics:application shop --inlineStyle --routing --directory= -p ab-shop</span><br><span class=\"line\"><span class=\"comment\"># Start default !!!</span></span><br><span class=\"line\">yarn start</span><br><span class=\"line\"><span class=\"comment\"># Generate an Angular application with nx power-ups</span></span><br><span class=\"line\">ng g @nrwl/schematics:application warehouse --inlineStyle --routing --directory= -p ab-warehouse</span><br><span class=\"line\"><span class=\"comment\"># Start especific !!!</span></span><br><span class=\"line\">ng serve warehouse --port=4202 -o</span><br></pre></td></tr></table></figure><p>Ambas aplicaciones comparten la configuracin del <code>angular.json</code> y las dems herramientas de ayuda como <strong>tslint</strong> y <strong>prettier</strong>. Destaca mucho que tambin que compartan <code>/node_modules</code>, lo cual se agradece en el tiempo y en el espacio.</p><p>Con nx puedes crear tambin aplicaciones de Backend. Por ejemplo un API REST hecha con <a href=\"https://nestjs.com/\" target=\"_blank\" rel=\"noopener\">NestJS</a>. Para acceder a los generadores especfico tienes que instalarlos antes. por ejemplo:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn add --dev @nrwl/nest</span><br><span class=\"line\">ng g @nrwl/nest:application api</span><br><span class=\"line\">ng serve api</span><br></pre></td></tr></table></figure><p>Al tener varias aplicaciones es conveniente disponer de scripts especficos para cada una. Por ejemplo yo en el <code>package.json</code> tenda algo as.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"start:shop\"</span>: <span class=\"string\">\"ng serve shop --port=4201 -o\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"build:shop\"</span>: <span class=\"string\">\"ng build shop --prod\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"test:shop\"</span>: <span class=\"string\">\"ng test shop\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"start:warehouse\"</span>: <span class=\"string\">\"ng serve warehouse --port=4202 -o\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"build:warehouse\"</span>: <span class=\"string\">\"ng build warehouse --prod\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"test:warehouse\"</span>: <span class=\"string\">\"ng test warehouse\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"start:api\"</span>: <span class=\"string\">\"ng serve api\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"build:api\"</span>: <span class=\"string\">\"ng build api --prod\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"test:api\"</span>: <span class=\"string\">\"ng test api\"</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Por supuesto que todos estos comando se pueden lanzar visualmente mediante la extensin <a href=\"https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console\" target=\"_blank\" rel=\"noopener\">Angular Console para VSCode</a>. Te recomiendo adems estas otras extensiones:</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"recommendations\"</span>: [</span><br><span class=\"line\">    <span class=\"string\">\"nrwl.angular-console\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"angular.ng-template\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"ms-vscode.vscode-typescript-tslint-plugin\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"esbenp.prettier-vscode\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"pkief.material-icon-theme\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"christian-kohler.path-intellisense\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"ban.spellright\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"johnpapa.angular-essentials\"</span></span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><h1 id=\"3-Tener-una-biblioteca-TypeScript-con-logica-de-dominio\"><a href=\"#3-Tener-una-biblioteca-TypeScript-con-logica-de-dominio\" class=\"headerlink\" title=\"3. Tener una biblioteca TypeScript con lgica de dominio.\"></a>3. Tener una biblioteca TypeScript con lgica de dominio.</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">Como:</span> <span class=\"string\">arquitecto</span></span><br><span class=\"line\"><span class=\"attr\">quiero:</span> <span class=\"string\">tener</span> <span class=\"string\">una</span> <span class=\"string\">biblioteca</span> <span class=\"string\">en</span> <span class=\"string\">TypeScript</span> <span class=\"string\">con</span> <span class=\"string\">lgica</span> <span class=\"string\">de</span> <span class=\"string\">dominio</span></span><br><span class=\"line\"><span class=\"string\">de</span> <span class=\"string\">modo</span> <span class=\"attr\">que:</span> <span class=\"string\">pueda</span> <span class=\"string\">usarla</span> <span class=\"string\">con</span> <span class=\"string\">varios</span> <span class=\"string\">frameworks</span> <span class=\"string\">o</span> <span class=\"string\">incluso</span> <span class=\"string\">en</span> <span class=\"string\">puro</span> <span class=\"string\">JavaScript.</span></span><br></pre></td></tr></table></figure><p>Ms temprano que tarde aparecern funcionalidades comunes a distintas aplicaciones. Validadores genricos, utilidades o casos concretos de un cliente pero que se usan en todos sus desarrollos. En este ejemplo partimos de la necesidad comn de un sistema de saludos (un mensaje, vaya). Y para ello empezamos por definir una <code>interface</code> pblica reutilizable.</p><p>Un poco de arquitectura de software. Todo lo que podamos programar y que no dependa de un <em>framework</em> debemos encapsularlo en libreras independientes. De esa forma puede reutilizarse con otras tecnologas o sobrevivir dignamente a la evolucin o desaparicin de Angular.</p><p>Lo primero ser crear la librera. Pero esta vez no usaremos los <em>schematics</em> del <strong>cli</strong>, si no los propios de <strong>nrwl</strong>. La idea es usarla como la <strong>capa de dominio de la arquitectura</strong>. En ella pondremos los modelos y servicios de lgica de negocio con las menores dependencias posibles. Repito lo fundamental: minimizar las dependencias. En concreto no dependeremos de Angular, lo cual permitira usarlo con otros <em>frameworks</em> actuales o futuros.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Generate a Type Script library with nx power-ups</span></span><br><span class=\"line\">ng generate @nrwl/workspace:library domain --directory=shared</span><br></pre></td></tr></table></figure><p>Por ahora no te preocupes de la implementacin. La muestro para destacar las dos cosas que considero ms importantes:</p><ul><li><p>No hay ninguna referencia explcita a <em>Angular</em>.</p></li><li><p>Lo que quieras exportar debe indicarse en el fichero <code>index.ts</code>.</p></li></ul><p>Por lo dems es puro <em>TypeScript</em>; en una carpeta con intenciones bien claras: <code>models/</code> creo de forma manual el siguiente fichero:</p><p><code>libs\\shared\\domain\\src\\lib\\models\\greetings.interface.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Greetings &#123;</span><br><span class=\"line\">  message: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>al no disponer del sistema de mdulos de angular tengo que exportarlo en el ndice de la librera.</p><p><code>libs\\shared\\domain\\src\\index.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> * <span class=\"keyword\">from</span> <span class=\"string\">'./lib/models/greetings.interface'</span>;</span><br></pre></td></tr></table></figure><p>Para localizarlo, Nx crea un alias en el <code>tsconfig.json</code>, que puedes retocar a voluntad</p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"paths\": &#123;</span><br><span class=\"line\">  \"@a-boss/domain\": [\"libs/shared/domain/src/index.ts\"]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ya est listo para seer consumido desde distintos proyectos (Lo har despus en el API y ya mismo en la prxima librera de componentes).</p><hr><h1 id=\"4-Tener-una-biblioteca-Angular-con-componentes-de-interfaz\"><a href=\"#4-Tener-una-biblioteca-Angular-con-componentes-de-interfaz\" class=\"headerlink\" title=\"4. Tener una biblioteca Angular con componentes de interfaz\"></a>4. Tener una biblioteca Angular con componentes de interfaz</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">be</span> <span class=\"string\">greeted</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">feel</span> <span class=\"string\">at</span> <span class=\"string\">home</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">be</span> <span class=\"string\">greeted</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">feel</span> <span class=\"string\">at</span> <span class=\"string\">home</span></span><br></pre></td></tr></table></figure><p>Si eres una empresa consultora es posible que te encuentres repitiendo funciones o pantallas una y otra vez para distintos clientes. Por supuesto que una gran empresa seguro que se hacen muchas aplicaciones similares, a las que les vendra de maravilla <strong>compartir una biblioteca de componentes</strong>.</p><p>Pues ahora crear libreras es igual de sencillo que crear aplicaciones. <strong>Nx</strong> las depositar en la carpeta <code>/libs</code> y se ocupar de apuntarlas en el <code>tsconfig.json</code> para que la importacin desde el resto del proyecto use alias cortos y evidentes.</p><p>Crear componentes en un entorno multi proyecto requiere especificar a qu proyecto se asociarn. Para empezar vamos a crear los componentes bsicos para esta funcionalidad en una librera compartida de para interfaz de usuario.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Generate an Angular library with nx power-ups</span></span><br><span class=\"line\">ng g @nrwl/angular:library ui --directory=shared --prefix=ab-ui --simpleModuleName</span><br><span class=\"line\"><span class=\"comment\"># Generate Greetings Component</span></span><br><span class=\"line\">ng g component greetings --project=shared-ui --module=ui.module.ts --<span class=\"built_in\">export</span> --inlineStyle --inlineTemplate</span><br></pre></td></tr></table></figure><p>Y le damos contenido al componente. Fjate en la importacin de la interfaz <code>Greetings</code>.</p><p><code>libs\\shared\\ui\\src\\lib\\greetings\\greetings.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Greetings &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/domain'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-ui-greetings'</span>,</span><br><span class=\"line\">  template: <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">    &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"string\">      &#123;&#123; theGreeting.message &#125;&#125;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"string\">  `</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> GreetingsComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> theGreeting: Greetings = &#123; message: <span class=\"string\">'Hello world'</span> &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><p>Puedes usarlos como cualquier otro componente y en cualquier aplicacin del repositorio. Simplemente importando el mdulo en el que se declaran: el <code>UiModule</code>. NX se encarga de referenciar cada proyecto en el fichero <code>tsconfig.json</code>. De esa forma se facilita su importacin en cualquier otra aplicacin del repositorio.</p><p>Primero importamos el mdulo.</p><p><code>apps\\shop\\src\\app\\app.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; UiModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/ui'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; BrowserModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    BrowserModule,</span><br><span class=\"line\">    RouterModule.forRoot([], &#123; initialNavigation: <span class=\"string\">'enabled'</span> &#125;),</span><br><span class=\"line\">    UiModule</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Y ya podemos incrustar sus componentes pblicos.</p><p><code>apps\\shop\\src\\app\\app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-ui-greetings</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-ui-greetings</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>apps\\shop\\src\\app\\app.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-shop-root'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./app.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;</span><br><span class=\"line\">  title = <span class=\"string\">'shop'</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><h1 id=\"5-Tener-una-biblioteca-Angular-con-servicios-de-datos\"><a href=\"#5-Tener-una-biblioteca-Angular-con-servicios-de-datos\" class=\"headerlink\" title=\"5. Tener una biblioteca Angular con servicios de datos\"></a>5. Tener una biblioteca Angular con servicios de datos</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">be</span> <span class=\"string\">greeted</span> <span class=\"string\">by</span> <span class=\"string\">the</span> <span class=\"string\">API</span> <span class=\"string\">:-)</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">know</span> <span class=\"string\">I</span> <span class=\"string\">am</span> <span class=\"string\">not</span> <span class=\"string\">alone.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">be</span> <span class=\"string\">greeted</span> <span class=\"string\">by</span> <span class=\"string\">the</span> <span class=\"string\">API</span> <span class=\"string\">:-)</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">know</span> <span class=\"string\">I</span> <span class=\"string\">am</span> <span class=\"string\">not</span> <span class=\"string\">alone.</span></span><br></pre></td></tr></table></figure><p>Adems de componentes visuales, podemos tener libreras con servicios de lgica o de acceso a datos. Por ejemplo un servicio para comunicarnos con el API podra ser utilizado en diversos proyectos (aplicaciones o libreras).</p><p>Con lo ya sabido vamos a crear una librera compartida para acceso a datos.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @nrwl/angular:library data --directory=shared --prefix=ab-data --simpleModuleName</span><br><span class=\"line\">ng g service greetings --project=shared-data --no-flat</span><br></pre></td></tr></table></figure><p>El servicio realiza la llamada http y devuelve un observable.</p><p><code>libs\\shared\\data\\src\\lib\\greetings\\greetings.service.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Greetings &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/domain'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpClient &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Injectable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Observable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'rxjs'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> GreetingsService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> apiUrl = <span class=\"string\">'http://localhost:3333/api'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> getGrettings$(): Observable&lt;Greetings&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.httpClient.get&lt;Greetings&gt;(<span class=\"keyword\">this</span>.apiUrl);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Para consumir el servicio no hay que hacer nada ms. Pero, para importarlo en TypeScript, necesitmaos que nos lo exporten adecuadamente.</p><p><code>libs\\shared\\data\\src\\index.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> * <span class=\"keyword\">from</span> <span class=\"string\">'./lib/data.module'</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> * <span class=\"keyword\">from</span> <span class=\"string\">'./lib/greetings/greetings.service'</span>;</span><br></pre></td></tr></table></figure><p><code>tsconfig.json</code></p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"paths\": &#123;</span><br><span class=\"line\">  \"@a-boss/domain\": [\"libs/shared/domain/src/index.ts\"]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y ahora consumirlo ya no es un problema. Por ejemplo directamente en el componente.</p><p><code>libs\\shared\\ui\\src\\lib\\greetings\\greetings.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; GreetingsService &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/data'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Greetings &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/domain'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-ui-greetings'</span>,</span><br><span class=\"line\">  template: <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">    &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"string\">      &#123;&#123; theGreeting.message &#125;&#125;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"string\">  `</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> GreetingsComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> theGreeting: Greetings = &#123; message: <span class=\"string\">'Hello world'</span> &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> greetingsService: GreetingsService</span>) &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.greetingsService.getGrettings$().subscribe(<span class=\"keyword\">this</span>.appendApiMessage);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> appendApiMessage = <span class=\"function\">(<span class=\"params\">apiGreetings: Greetings</span>) =&gt;</span></span><br><span class=\"line\">    (<span class=\"keyword\">this</span>.theGreeting.message += <span class=\"string\">' and '</span> + apiGreetings.message);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ya que estamos accediendo al API, podemos aprovechar para adecuar sus tipos a la interfaz declarada en el dominio. Fjate lo familiar que resulta este cdigo <strong>NodeJS</strong> gracias al framework <a href=\"https://nestjs.com/\" target=\"_blank\" rel=\"noopener\">nest</a>.</p><p><code>apps\\api\\src\\app\\app.controller.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Greetings &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/domain'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Controller, Get &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@nestjs/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppService &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.service'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Controller</span>()</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppController &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> readonly appService: AppService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Get</span>()</span><br><span class=\"line\">  getData(): Greetings &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.appService.getData();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id=\"Resumen\"><a href=\"#Resumen\" class=\"headerlink\" title=\"Resumen\"></a>Resumen</h2><p>En definitiva, los grandes desarrollos demandados por bancos, multinacionales o administracin pblica requieren soluciones avanzadas. <strong>Angular</strong> es una plataforma ideal para esos grandes proyectos, pero requiere conocimiento y bases slidas para sacarle partido.</p><p>Con este tutorial empiezas tu formacin <a href=\"../tag/Avanzado/\">avanzada en Angular</a> para poder afrontar retos de tamao industrial. Contina aprendiendo a crear y ejecutar pruebas automatizadas creando <a href=\"../tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular\">tests unitarios con Jest y e2e con Cypress en Angular</a>. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Tests unitarios con Jest y e2e con Cypress en Angular","date":"2019-09-05T12:25:12.000Z","thumbnail":"/css/images/angular-11_test.png","_content":"\n![tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular](/images/tutorial-angular-11_test.png)\n\nContinuamos este **tutorial de Angular Avanzado** con el tema controvertido del testing. S, ya s que todos deberamos hacerlo siempre, pero tambin s que no es cierto. As que vamos a ponerle remedio eliminando excusas y facilitando las pruebas automatizadas.\n\n> Por si hace falta su defensa: Las pruebas automticas de cdigo son la principal tcnica de reduccin de bugs y garantizan el buen funcionamiento durante un refactoring. Bueno para el usuario bueno para el programador.\n\nLos desarrollos que hoy en da hacemos con **Angular** suelen ser de tamao medio o grande y con una esperanza de vida y mantenimiento que se mide en aos. As que cuantas ms pruebas tengamos menos miedo tendremos a cambiar el cdigo. Y la necesidad de cambio siempre estar ah. Veremos como _Jest_ y _Cypress_ nos ayudan muchsimo en la tarea.\n\n<!-- more -->\n\nPartiendo del [mono repositorio creado](../nx-mono-repositorios-en-Angular) usando las herramientas de [Nrwl.io/](https://nrwl.io/) aprovecharemos las herramientas que instala y configura dos productos de ltima generacin que facilitan la tarea. Usaremos [Jest](https://jestjs.io/) para los test unitarios y [Cypress](https://www.cypress.io/) para los de integracin _End to End_. Vamos a empezar por el final.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n## Tabla de Contenido:\n\n[1. Test de Integracin con Cypress.](./#1.-Test-de-Integracin-con-Cypress)\n\n[2. Test Unitarios con Jest.](./#2.-Test-Unitarios-con-Jest)\n\n<!-- [Diagramas](./#Diagramas) -->\n\n[Resumen](./#Resumen)\n\n---\n\n# 1. Test de Integracin con Cypress\n\n```yaml\nAs a: developer,\n  I want: to test end to end my app\n  so that: I can be sure of the functions\n```\n\nLas pruebas de integracin son las que tienen un retorno de inversin ms inmediato. Si esta es tu primera aproximacin al testing, te recomiendo empezar por aqu. Se trata de definir un escenario y pre programar el comportamiento del usuario. El sistema lo ejecutar y podrs contrastar el resultado con algn valor esperado.\n\nSon pruebas de caja negra que interactan con el sistema en ejecucin. Todo ello automatizado y con informes visuales interactivos o en ficheros de texto con el resultado de las pruebas.\n\n## 1.1 Cypress\n\n[Cypress](https://www.cypress.io/) es el equivalente a Protractor, el producto propio de Angular. La ventaja principal es que no est atado a ningn framework y por tanto lo que hagas valdr para probar cualquier web en cualquier tecnologa.\n\nCon cada aplicacin generada se crea una hermana para sus pruebas _e2e_. Esa aplicacin de pruebas est configurada y lista para compilar, servir y probar su aplicacin objetivo. Con [Nx](https://twitter.com/NxDevTools) tenemos todo instalado, configurado y listo para ejecutarse con comandos como los siguientes que yo coloco en el `packcage.json`:\n\n```json\n{\n  \"e2e:shop\": \"ng e2e shop-e2e --watch\",\n  \"e2e:warehouse\": \"ng e2e warehouse-e2e --watch\"\n}\n```\n\nLuego se pueden lanzar desde la terminal muy cmodamente.\n\n```terminal\nyarn e2e:shop\nyarn e2e:warehouse\n```\n\n## 1.2 Test e2e\n\n```yaml\nGIVEN: the shop web app\n  WHEN: user visits home page\n    THEN: should display welcome message\n    THEN: should display welcome message from the API\n```\n\nTu trabajo como _tester_ ser definir las pruebas en la carpeta `/integration`. Por ejemplo para empezar nos ofrecen el fichero `app-spec.ts` en el que yo he especificado el comportamiento deseado por mi pgina. La sintaxis se entiende por si misma. He seguido el convenio **GIVEN, WHEN, THEN** para especificar pruebas que podran considerarse casi de comportamiento o aceptacin.\n\n`apps\\shop-e2e\\src\\integration\\app.spec.ts`\n\n```typescript\nimport { getGreeting } from '../support/app.po';\n\ndescribe('GIVEN: the shop web app', () => {\n  beforeEach(() => cy.visit('/'));\n  context('WHEN: user visits home page', () => {\n    it('THEN: should display welcome message', () => {\n      getGreeting().contains('Hello world');\n    });\n    // needs the api server to run\n    // yarn start:api\n    it('THEN: should display welcome message from the API', () => {\n      getGreeting().contains('and Welcome to api!');\n    });\n  });\n});\n```\n\nLa parte ms tcnica y tediosa es la que accede al _DOM_ y lo mejor es tener eso a parte. En la carpeta `/support` nos sugieren que creemos utilidades para tratar con el _DOM_ y de esa forma mantener los test lo ms cercanos posible a un lenguaje natural de negocio. En este caso uso una aproximacin libre al [BDD con gherkin](https://www.genbeta.com/desarrollo/bdd-cucumber-y-gherkin-desarrollo-dirigido-por-comportamiento) para mantener el espritu de sencillez de un tutorial sobre tecnologa Angular, no sobre testing.\n\n`apps\\shop-e2e\\src\\support\\app.po.ts`\n\n```typescript\nexport const getGreeting = () => cy.get('h1');\n```\n\n---\n\n\n# 2. Test Unitarios con Jest\n\nLas pruebas unitarias, muy asociadas al [TDD](https://hackernoon.com/introduction-to-test-driven-development-tdd-61a13bc92d92), son las mejores amigas del desarrollador. Pero, tambin son las ms engorrosas para empezar. As que aqu veremos una introduccin sencilla para que nadie deje de hacerlas.\n\n\n## 2.1 Jest\n\n[Jest](https://jestjs.io/) es un framework de testing para JavaScript muy sencillo y rpido. Puedes usarlo con cualquier otro framework. Para el caso de Angular ya viene preconfigurado si usas las extensiones Nx.\n\nMete los siguientes scripts en el `package.json` y as tendrs a mano siempre las pruebas. Te recomiendo que desarrolles con el test unitario lanzado; es la manera ms rpida de probar el cdigo que ests tocando. Idealmente incluso con **TDD** el [test antes del cdigo](https://medium.com/javascript-scene/tdd-changed-my-life-5af0ce099f80).\n\n> Para ms informacin acerca de lo til y rentable que resulta practicar **TDD**, te recomiendo que leas este artculo: [Statistics & Studies: The Benefits Of Test Driven Development](https://theqalead.com/general/statistics-studies-benefits-test-driven-development/)\n\n```json\n{\n  \"test:shop\": \"ng test shop --watch --verbose\",\n  \"test:warehouse\": \"ng test warehouse --watch --verbose\",\n  \"test:api\": \"ng test api --watch --verbose\"\n}\n```\n\n```terminal\nyarn test:shop\nyarn test:warehouse\nyarn test:api\n```\n\n## 2.2 Tests unitarios\n\n\n### 2.2.1 Componentes\n\n```yaml\nGIVEN: an AppComponent declared in AppModule\n  WHEN: the AppModule is compiled\n    THEN: should create the component\n    THEN: should have a property title with value 'shop'\n    THEN: should render 'Hello world' in a H1 tag\n```\n\nEn este caso queremos probar una librera de componentes. Y empezamos por el componente raz. Esta es una prueba unitarias pero con un toque de integracin parcial pues necesita de otros componentes para ejecutarse. Cuanto ms arriba en la jerarqua est el componente mayor ser su necesidad de integrar a otros. Pero no pasa nada, de esta forma te aseguras de que el mdulo de la librera se importa y que sus componentes se exportan correctamente.\n\nAl grano, vamos a la aplicacin _shop_ para  comprobar que su componente `AppComponent` funciona y (de paso) que se renderiza tambin el componente `ab-ui-greetings` incrustando los saludos.\n\n\n`apps\\shop\\src\\app\\app.component.spec.ts`\n\n```typescript\nimport { UiModule } from '@a-boss/ui';\nimport { async, TestBed } from '@angular/core/testing';\nimport { RouterTestingModule } from '@angular/router/testing';\nimport { AppComponent } from './app.component';\n\ndescribe('GIVEN: an AppComponent declared in AppModule', () => {\n  describe('WHEN: the AppModule is compiled', () => {\n    beforeEach(async(() => {\n      TestBed.configureTestingModule({\n        imports: [RouterTestingModule, UiModule],\n        declarations: [AppComponent]\n      }).compileComponents();\n    }));\n\n    it('THEN: should create the component', () => {\n      const fixture = TestBed.createComponent(AppComponent);\n      const app = fixture.debugElement.componentInstance;\n      expect(app).toBeTruthy();\n    });\n\n    it(`THEN: should have a property title with value 'shop'`, () => {\n      const fixture = TestBed.createComponent(AppComponent);\n      const app = fixture.debugElement.componentInstance;\n      expect(app.title).toEqual('shop');\n    });\n\n    it(`THEN: should render 'Hello world' in a H1 tag`, () => {\n      const fixture = TestBed.createComponent(AppComponent);\n      fixture.detectChanges();\n      const compiled = fixture.debugElement.nativeElement;\n      expect(compiled.querySelector('h1').textContent).toContain('Hello world');\n    });\n  });\n});\n```\n\n### 2.2.2 Services\n\n```yaml\nGIVEN: a GreetingsService\n  WHEN: the DataModule is compiled\n    THEN: should be created\n    THEN: should return an observable when call 'getGrettings()'\n    THEN: should return 'Welcome to api!' when call 'getGrettings()'\n```\n\nLa prueba de servicios es ms sencilla que la de componentes pues no hay que tratar con la renderizacin del HTML; slo funcionalidad en una clase TypeScript. Pero, siempre hay un pero, muchos de estos servicios tratarn con llamadas asncronas. Afortunadamente est todo pensado y se resuelve con dos conceptos: la funcin `async()` y inyeccin de rplicas (_mocks_) de las dependencias.\n\n`libs\\shared\\data\\src\\lib\\greetings\\greetings.service.spec.ts`\n\n```typescript\n// importar rplicas para testing de las dependencias del servicio\nimport {\n  HttpClientTestingModule,\n  HttpTestingController\n} from '@angular/common/http/testing';\nimport { async, TestBed } from '@angular/core/testing';\nimport { Observable } from 'rxjs';\nimport { GreetingsService } from './greetings.service';\n\ndescribe('GIVEN: a GreetingsService', () => {\n  describe('WHEN: the DataModule is compiled', () => {\n    beforeEach(() => {\n      TestBed.configureTestingModule({\n        imports: [HttpClientTestingModule]\n      });\n    });\n\n    it('THEN: should be created', () => {\n      const service: GreetingsService = TestBed.get(GreetingsService);\n      expect(service).toBeTruthy();\n    });\n\n    it(`THEN: should return an observable when call 'getGrettings()'`, () => {\n      const service: GreetingsService = TestBed.get(GreetingsService);\n      const greetings$: Observable<any> = service.getGrettings$();\n      expect(greetings$).toBeInstanceOf(Observable);\n    });\n\n    // Ojo al async para ejectuar las llamadas asncronas\n    it(`THEN: should return 'Welcome to api!' when call 'getGrettings()'`, async(() => {\n      const service: GreetingsService = TestBed.get(GreetingsService);\n      service\n        .getGrettings$()\n        .subscribe(result =>\n          expect(result).toEqual({ message: 'Welcome to api!' })\n        );\n      // mock del backend para no depender del servidor\n      const httpMock = TestBed.get(HttpTestingController);\n      // esperar a que se llame a esta ruta\n      const req = httpMock.expectOne('http://localhost:3333/api');\n      req.flush({ message: 'Welcome to api!' }); // responder con esto\n      httpMock.verify(); // comprobar que no hay ms llamadas\n    }));\n  });\n});\n```\n\nA partir de aqu es siempre igual. Defines un respuesta esperada, le das una entrada conocida y si algo no cuadra, entonces el cdigo no pasa la prueba y tienes una oportunidad para mejorarlo.\n\nEn la prueba de servicios es fundamental que uses rplicas de sus dependencias. Es la forma de garantizar que pruebas nicamente el servicio, sin depender de nada. Esto era mucho ms complejo con los componentes, pero un mandamiento con los servicios.\n\n---\n\n## Resumen\n\nEn definitiva, los grandes desarrollos demandados por bancos, multinacionales o administracin pblica requieren soluciones fiables y mantenibles. Y eso pasa inexcusablemente por hacer testing. **Angular** facilita las pruebas unitarias y de integracin; especialmente con las herramientas _Jest_ y  _Cypress_ ya configuradas por **NxDevTools**.\n\nCon este tutorial de formacin [avanzada en Angular](../tag/Avanzado/) te preparas para poder afrontar retos de tamao industrial. Contina aprendiendo a mejorar el rendimiento usando la [deteccin del cambio en Angular](../deteccion-del-cambio-en-Angular). Todos esos detalles se tratan en el [curso avanzado online](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-11-tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular.md","raw":"---\ntitle: Tests unitarios con Jest y e2e con Cypress en Angular\npermalink: tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular\ndate: 2019-09-05 14:25:12\ntags:\n- Angular\n- Angular8\n- Nx\n- Test\n- Jest\n- Cypress\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-11_test.png\n---\n\n![tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular](/images/tutorial-angular-11_test.png)\n\nContinuamos este **tutorial de Angular Avanzado** con el tema controvertido del testing. S, ya s que todos deberamos hacerlo siempre, pero tambin s que no es cierto. As que vamos a ponerle remedio eliminando excusas y facilitando las pruebas automatizadas.\n\n> Por si hace falta su defensa: Las pruebas automticas de cdigo son la principal tcnica de reduccin de bugs y garantizan el buen funcionamiento durante un refactoring. Bueno para el usuario bueno para el programador.\n\nLos desarrollos que hoy en da hacemos con **Angular** suelen ser de tamao medio o grande y con una esperanza de vida y mantenimiento que se mide en aos. As que cuantas ms pruebas tengamos menos miedo tendremos a cambiar el cdigo. Y la necesidad de cambio siempre estar ah. Veremos como _Jest_ y _Cypress_ nos ayudan muchsimo en la tarea.\n\n<!-- more -->\n\nPartiendo del [mono repositorio creado](../nx-mono-repositorios-en-Angular) usando las herramientas de [Nrwl.io/](https://nrwl.io/) aprovecharemos las herramientas que instala y configura dos productos de ltima generacin que facilitan la tarea. Usaremos [Jest](https://jestjs.io/) para los test unitarios y [Cypress](https://www.cypress.io/) para los de integracin _End to End_. Vamos a empezar por el final.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n## Tabla de Contenido:\n\n[1. Test de Integracin con Cypress.](./#1.-Test-de-Integracin-con-Cypress)\n\n[2. Test Unitarios con Jest.](./#2.-Test-Unitarios-con-Jest)\n\n<!-- [Diagramas](./#Diagramas) -->\n\n[Resumen](./#Resumen)\n\n---\n\n# 1. Test de Integracin con Cypress\n\n```yaml\nAs a: developer,\n  I want: to test end to end my app\n  so that: I can be sure of the functions\n```\n\nLas pruebas de integracin son las que tienen un retorno de inversin ms inmediato. Si esta es tu primera aproximacin al testing, te recomiendo empezar por aqu. Se trata de definir un escenario y pre programar el comportamiento del usuario. El sistema lo ejecutar y podrs contrastar el resultado con algn valor esperado.\n\nSon pruebas de caja negra que interactan con el sistema en ejecucin. Todo ello automatizado y con informes visuales interactivos o en ficheros de texto con el resultado de las pruebas.\n\n## 1.1 Cypress\n\n[Cypress](https://www.cypress.io/) es el equivalente a Protractor, el producto propio de Angular. La ventaja principal es que no est atado a ningn framework y por tanto lo que hagas valdr para probar cualquier web en cualquier tecnologa.\n\nCon cada aplicacin generada se crea una hermana para sus pruebas _e2e_. Esa aplicacin de pruebas est configurada y lista para compilar, servir y probar su aplicacin objetivo. Con [Nx](https://twitter.com/NxDevTools) tenemos todo instalado, configurado y listo para ejecutarse con comandos como los siguientes que yo coloco en el `packcage.json`:\n\n```json\n{\n  \"e2e:shop\": \"ng e2e shop-e2e --watch\",\n  \"e2e:warehouse\": \"ng e2e warehouse-e2e --watch\"\n}\n```\n\nLuego se pueden lanzar desde la terminal muy cmodamente.\n\n```terminal\nyarn e2e:shop\nyarn e2e:warehouse\n```\n\n## 1.2 Test e2e\n\n```yaml\nGIVEN: the shop web app\n  WHEN: user visits home page\n    THEN: should display welcome message\n    THEN: should display welcome message from the API\n```\n\nTu trabajo como _tester_ ser definir las pruebas en la carpeta `/integration`. Por ejemplo para empezar nos ofrecen el fichero `app-spec.ts` en el que yo he especificado el comportamiento deseado por mi pgina. La sintaxis se entiende por si misma. He seguido el convenio **GIVEN, WHEN, THEN** para especificar pruebas que podran considerarse casi de comportamiento o aceptacin.\n\n`apps\\shop-e2e\\src\\integration\\app.spec.ts`\n\n```typescript\nimport { getGreeting } from '../support/app.po';\n\ndescribe('GIVEN: the shop web app', () => {\n  beforeEach(() => cy.visit('/'));\n  context('WHEN: user visits home page', () => {\n    it('THEN: should display welcome message', () => {\n      getGreeting().contains('Hello world');\n    });\n    // needs the api server to run\n    // yarn start:api\n    it('THEN: should display welcome message from the API', () => {\n      getGreeting().contains('and Welcome to api!');\n    });\n  });\n});\n```\n\nLa parte ms tcnica y tediosa es la que accede al _DOM_ y lo mejor es tener eso a parte. En la carpeta `/support` nos sugieren que creemos utilidades para tratar con el _DOM_ y de esa forma mantener los test lo ms cercanos posible a un lenguaje natural de negocio. En este caso uso una aproximacin libre al [BDD con gherkin](https://www.genbeta.com/desarrollo/bdd-cucumber-y-gherkin-desarrollo-dirigido-por-comportamiento) para mantener el espritu de sencillez de un tutorial sobre tecnologa Angular, no sobre testing.\n\n`apps\\shop-e2e\\src\\support\\app.po.ts`\n\n```typescript\nexport const getGreeting = () => cy.get('h1');\n```\n\n---\n\n\n# 2. Test Unitarios con Jest\n\nLas pruebas unitarias, muy asociadas al [TDD](https://hackernoon.com/introduction-to-test-driven-development-tdd-61a13bc92d92), son las mejores amigas del desarrollador. Pero, tambin son las ms engorrosas para empezar. As que aqu veremos una introduccin sencilla para que nadie deje de hacerlas.\n\n\n## 2.1 Jest\n\n[Jest](https://jestjs.io/) es un framework de testing para JavaScript muy sencillo y rpido. Puedes usarlo con cualquier otro framework. Para el caso de Angular ya viene preconfigurado si usas las extensiones Nx.\n\nMete los siguientes scripts en el `package.json` y as tendrs a mano siempre las pruebas. Te recomiendo que desarrolles con el test unitario lanzado; es la manera ms rpida de probar el cdigo que ests tocando. Idealmente incluso con **TDD** el [test antes del cdigo](https://medium.com/javascript-scene/tdd-changed-my-life-5af0ce099f80).\n\n> Para ms informacin acerca de lo til y rentable que resulta practicar **TDD**, te recomiendo que leas este artculo: [Statistics & Studies: The Benefits Of Test Driven Development](https://theqalead.com/general/statistics-studies-benefits-test-driven-development/)\n\n```json\n{\n  \"test:shop\": \"ng test shop --watch --verbose\",\n  \"test:warehouse\": \"ng test warehouse --watch --verbose\",\n  \"test:api\": \"ng test api --watch --verbose\"\n}\n```\n\n```terminal\nyarn test:shop\nyarn test:warehouse\nyarn test:api\n```\n\n## 2.2 Tests unitarios\n\n\n### 2.2.1 Componentes\n\n```yaml\nGIVEN: an AppComponent declared in AppModule\n  WHEN: the AppModule is compiled\n    THEN: should create the component\n    THEN: should have a property title with value 'shop'\n    THEN: should render 'Hello world' in a H1 tag\n```\n\nEn este caso queremos probar una librera de componentes. Y empezamos por el componente raz. Esta es una prueba unitarias pero con un toque de integracin parcial pues necesita de otros componentes para ejecutarse. Cuanto ms arriba en la jerarqua est el componente mayor ser su necesidad de integrar a otros. Pero no pasa nada, de esta forma te aseguras de que el mdulo de la librera se importa y que sus componentes se exportan correctamente.\n\nAl grano, vamos a la aplicacin _shop_ para  comprobar que su componente `AppComponent` funciona y (de paso) que se renderiza tambin el componente `ab-ui-greetings` incrustando los saludos.\n\n\n`apps\\shop\\src\\app\\app.component.spec.ts`\n\n```typescript\nimport { UiModule } from '@a-boss/ui';\nimport { async, TestBed } from '@angular/core/testing';\nimport { RouterTestingModule } from '@angular/router/testing';\nimport { AppComponent } from './app.component';\n\ndescribe('GIVEN: an AppComponent declared in AppModule', () => {\n  describe('WHEN: the AppModule is compiled', () => {\n    beforeEach(async(() => {\n      TestBed.configureTestingModule({\n        imports: [RouterTestingModule, UiModule],\n        declarations: [AppComponent]\n      }).compileComponents();\n    }));\n\n    it('THEN: should create the component', () => {\n      const fixture = TestBed.createComponent(AppComponent);\n      const app = fixture.debugElement.componentInstance;\n      expect(app).toBeTruthy();\n    });\n\n    it(`THEN: should have a property title with value 'shop'`, () => {\n      const fixture = TestBed.createComponent(AppComponent);\n      const app = fixture.debugElement.componentInstance;\n      expect(app.title).toEqual('shop');\n    });\n\n    it(`THEN: should render 'Hello world' in a H1 tag`, () => {\n      const fixture = TestBed.createComponent(AppComponent);\n      fixture.detectChanges();\n      const compiled = fixture.debugElement.nativeElement;\n      expect(compiled.querySelector('h1').textContent).toContain('Hello world');\n    });\n  });\n});\n```\n\n### 2.2.2 Services\n\n```yaml\nGIVEN: a GreetingsService\n  WHEN: the DataModule is compiled\n    THEN: should be created\n    THEN: should return an observable when call 'getGrettings()'\n    THEN: should return 'Welcome to api!' when call 'getGrettings()'\n```\n\nLa prueba de servicios es ms sencilla que la de componentes pues no hay que tratar con la renderizacin del HTML; slo funcionalidad en una clase TypeScript. Pero, siempre hay un pero, muchos de estos servicios tratarn con llamadas asncronas. Afortunadamente est todo pensado y se resuelve con dos conceptos: la funcin `async()` y inyeccin de rplicas (_mocks_) de las dependencias.\n\n`libs\\shared\\data\\src\\lib\\greetings\\greetings.service.spec.ts`\n\n```typescript\n// importar rplicas para testing de las dependencias del servicio\nimport {\n  HttpClientTestingModule,\n  HttpTestingController\n} from '@angular/common/http/testing';\nimport { async, TestBed } from '@angular/core/testing';\nimport { Observable } from 'rxjs';\nimport { GreetingsService } from './greetings.service';\n\ndescribe('GIVEN: a GreetingsService', () => {\n  describe('WHEN: the DataModule is compiled', () => {\n    beforeEach(() => {\n      TestBed.configureTestingModule({\n        imports: [HttpClientTestingModule]\n      });\n    });\n\n    it('THEN: should be created', () => {\n      const service: GreetingsService = TestBed.get(GreetingsService);\n      expect(service).toBeTruthy();\n    });\n\n    it(`THEN: should return an observable when call 'getGrettings()'`, () => {\n      const service: GreetingsService = TestBed.get(GreetingsService);\n      const greetings$: Observable<any> = service.getGrettings$();\n      expect(greetings$).toBeInstanceOf(Observable);\n    });\n\n    // Ojo al async para ejectuar las llamadas asncronas\n    it(`THEN: should return 'Welcome to api!' when call 'getGrettings()'`, async(() => {\n      const service: GreetingsService = TestBed.get(GreetingsService);\n      service\n        .getGrettings$()\n        .subscribe(result =>\n          expect(result).toEqual({ message: 'Welcome to api!' })\n        );\n      // mock del backend para no depender del servidor\n      const httpMock = TestBed.get(HttpTestingController);\n      // esperar a que se llame a esta ruta\n      const req = httpMock.expectOne('http://localhost:3333/api');\n      req.flush({ message: 'Welcome to api!' }); // responder con esto\n      httpMock.verify(); // comprobar que no hay ms llamadas\n    }));\n  });\n});\n```\n\nA partir de aqu es siempre igual. Defines un respuesta esperada, le das una entrada conocida y si algo no cuadra, entonces el cdigo no pasa la prueba y tienes una oportunidad para mejorarlo.\n\nEn la prueba de servicios es fundamental que uses rplicas de sus dependencias. Es la forma de garantizar que pruebas nicamente el servicio, sin depender de nada. Esto era mucho ms complejo con los componentes, pero un mandamiento con los servicios.\n\n---\n\n## Resumen\n\nEn definitiva, los grandes desarrollos demandados por bancos, multinacionales o administracin pblica requieren soluciones fiables y mantenibles. Y eso pasa inexcusablemente por hacer testing. **Angular** facilita las pruebas unitarias y de integracin; especialmente con las herramientas _Jest_ y  _Cypress_ ya configuradas por **NxDevTools**.\n\nCon este tutorial de formacin [avanzada en Angular](../tag/Avanzado/) te preparas para poder afrontar retos de tamao industrial. Contina aprendiendo a mejorar el rendimiento usando la [deteccin del cambio en Angular](../deteccion-del-cambio-en-Angular). Todos esos detalles se tratan en el [curso avanzado online](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular","published":1,"updated":"2020-10-27T07:59:13.151Z","_id":"ck70mab19000ibss3mandbfcy","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-11_test.png\" alt=\"tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular\"></p><p>Continuamos este <strong>tutorial de Angular Avanzado</strong> con el tema controvertido del testing. S, ya s que todos deberamos hacerlo siempre, pero tambin s que no es cierto. As que vamos a ponerle remedio eliminando excusas y facilitando las pruebas automatizadas.</p><blockquote><p>Por si hace falta su defensa: Las pruebas automticas de cdigo son la principal tcnica de reduccin de bugs y garantizan el buen funcionamiento durante un refactoring. Bueno para el usuario bueno para el programador.</p></blockquote><p>Los desarrollos que hoy en da hacemos con <strong>Angular</strong> suelen ser de tamao medio o grande y con una esperanza de vida y mantenimiento que se mide en aos. As que cuantas ms pruebas tengamos menos miedo tendremos a cambiar el cdigo. Y la necesidad de cambio siempre estar ah. Veremos como <em>Jest</em> y <em>Cypress</em> nos ayudan muchsimo en la tarea.</p><a id=\"more\"></a><p>Partiendo del <a href=\"../nx-mono-repositorios-en-Angular\">mono repositorio creado</a> usando las herramientas de <a href=\"https://nrwl.io/\" target=\"_blank\" rel=\"noopener\">Nrwl.io/</a> aprovecharemos las herramientas que instala y configura dos productos de ltima generacin que facilitan la tarea. Usaremos <a href=\"https://jestjs.io/\" target=\"_blank\" rel=\"noopener\">Jest</a> para los test unitarios y <a href=\"https://www.cypress.io/\" target=\"_blank\" rel=\"noopener\">Cypress</a> para los de integracin <em>End to End</em>. Vamos a empezar por el final.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id=\"Tabla-de-Contenido\"><a href=\"#Tabla-de-Contenido\" class=\"headerlink\" title=\"Tabla de Contenido:\"></a>Tabla de Contenido:</h2><p><a href=\"./#1.-Test-de-Integracin-con-Cypress\">1. Test de Integracin con Cypress.</a></p><p><a href=\"./#2.-Test-Unitarios-con-Jest\">2. Test Unitarios con Jest.</a></p><p><a href=\"./#Resumen\">Resumen</a></p><hr><h1 id=\"1-Test-de-Integracion-con-Cypress\"><a href=\"#1-Test-de-Integracion-con-Cypress\" class=\"headerlink\" title=\"1. Test de Integracin con Cypress\"></a>1. Test de Integracin con Cypress</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">developer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">test</span> <span class=\"string\">end</span> <span class=\"string\">to</span> <span class=\"string\">end</span> <span class=\"string\">my</span> <span class=\"string\">app</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">be</span> <span class=\"string\">sure</span> <span class=\"string\">of</span> <span class=\"string\">the</span> <span class=\"string\">functions</span></span><br></pre></td></tr></table></figure><p>Las pruebas de integracin son las que tienen un retorno de inversin ms inmediato. Si esta es tu primera aproximacin al testing, te recomiendo empezar por aqu. Se trata de definir un escenario y pre programar el comportamiento del usuario. El sistema lo ejecutar y podrs contrastar el resultado con algn valor esperado.</p><p>Son pruebas de caja negra que interactan con el sistema en ejecucin. Todo ello automatizado y con informes visuales interactivos o en ficheros de texto con el resultado de las pruebas.</p><h2 id=\"1-1-Cypress\"><a href=\"#1-1-Cypress\" class=\"headerlink\" title=\"1.1 Cypress\"></a>1.1 Cypress</h2><p><a href=\"https://www.cypress.io/\" target=\"_blank\" rel=\"noopener\">Cypress</a> es el equivalente a Protractor, el producto propio de Angular. La ventaja principal es que no est atado a ningn framework y por tanto lo que hagas valdr para probar cualquier web en cualquier tecnologa.</p><p>Con cada aplicacin generada se crea una hermana para sus pruebas <em>e2e</em>. Esa aplicacin de pruebas est configurada y lista para compilar, servir y probar su aplicacin objetivo. Con <a href=\"https://twitter.com/NxDevTools\" target=\"_blank\" rel=\"noopener\">Nx</a> tenemos todo instalado, configurado y listo para ejecutarse con comandos como los siguientes que yo coloco en el <code>packcage.json</code>:</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"e2e:shop\"</span>: <span class=\"string\">\"ng e2e shop-e2e --watch\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"e2e:warehouse\"</span>: <span class=\"string\">\"ng e2e warehouse-e2e --watch\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Luego se pueden lanzar desde la terminal muy cmodamente.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn e2e:shop</span><br><span class=\"line\">yarn e2e:warehouse</span><br></pre></td></tr></table></figure><h2 id=\"1-2-Test-e2e\"><a href=\"#1-2-Test-e2e\" class=\"headerlink\" title=\"1.2 Test e2e\"></a>1.2 Test e2e</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">GIVEN:</span> <span class=\"string\">the</span> <span class=\"string\">shop</span> <span class=\"string\">web</span> <span class=\"string\">app</span></span><br><span class=\"line\"><span class=\"attr\">  WHEN:</span> <span class=\"string\">user</span> <span class=\"string\">visits</span> <span class=\"string\">home</span> <span class=\"string\">page</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">display</span> <span class=\"string\">welcome</span> <span class=\"string\">message</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">display</span> <span class=\"string\">welcome</span> <span class=\"string\">message</span> <span class=\"string\">from</span> <span class=\"string\">the</span> <span class=\"string\">API</span></span><br></pre></td></tr></table></figure><p>Tu trabajo como <em>tester</em> ser definir las pruebas en la carpeta <code>/integration</code>. Por ejemplo para empezar nos ofrecen el fichero <code>app-spec.ts</code> en el que yo he especificado el comportamiento deseado por mi pgina. La sintaxis se entiende por si misma. He seguido el convenio <strong>GIVEN, WHEN, THEN</strong> para especificar pruebas que podran considerarse casi de comportamiento o aceptacin.</p><p><code>apps\\shop-e2e\\src\\integration\\app.spec.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; getGreeting &#125; <span class=\"keyword\">from</span> <span class=\"string\">'../support/app.po'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">describe(<span class=\"string\">'GIVEN: the shop web app'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  beforeEach(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> cy.visit(<span class=\"string\">'/'</span>));</span><br><span class=\"line\">  context(<span class=\"string\">'WHEN: user visits home page'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    it(<span class=\"string\">'THEN: should display welcome message'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      getGreeting().contains(<span class=\"string\">'Hello world'</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"comment\">// needs the api server to run</span></span><br><span class=\"line\">    <span class=\"comment\">// yarn start:api</span></span><br><span class=\"line\">    it(<span class=\"string\">'THEN: should display welcome message from the API'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      getGreeting().contains(<span class=\"string\">'and Welcome to api!'</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p>La parte ms tcnica y tediosa es la que accede al <em>DOM</em> y lo mejor es tener eso a parte. En la carpeta <code>/support</code> nos sugieren que creemos utilidades para tratar con el <em>DOM</em> y de esa forma mantener los test lo ms cercanos posible a un lenguaje natural de negocio. En este caso uso una aproximacin libre al <a href=\"https://www.genbeta.com/desarrollo/bdd-cucumber-y-gherkin-desarrollo-dirigido-por-comportamiento\" target=\"_blank\" rel=\"noopener\">BDD con gherkin</a> para mantener el espritu de sencillez de un tutorial sobre tecnologa Angular, no sobre testing.</p><p><code>apps\\shop-e2e\\src\\support\\app.po.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> getGreeting = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> cy.get(<span class=\"string\">'h1'</span>);</span><br></pre></td></tr></table></figure><hr><h1 id=\"2-Test-Unitarios-con-Jest\"><a href=\"#2-Test-Unitarios-con-Jest\" class=\"headerlink\" title=\"2. Test Unitarios con Jest\"></a>2. Test Unitarios con Jest</h1><p>Las pruebas unitarias, muy asociadas al <a href=\"https://hackernoon.com/introduction-to-test-driven-development-tdd-61a13bc92d92\" target=\"_blank\" rel=\"noopener\">TDD</a>, son las mejores amigas del desarrollador. Pero, tambin son las ms engorrosas para empezar. As que aqu veremos una introduccin sencilla para que nadie deje de hacerlas.</p><h2 id=\"2-1-Jest\"><a href=\"#2-1-Jest\" class=\"headerlink\" title=\"2.1 Jest\"></a>2.1 Jest</h2><p><a href=\"https://jestjs.io/\" target=\"_blank\" rel=\"noopener\">Jest</a> es un framework de testing para JavaScript muy sencillo y rpido. Puedes usarlo con cualquier otro framework. Para el caso de Angular ya viene preconfigurado si usas las extensiones Nx.</p><p>Mete los siguientes scripts en el <code>package.json</code> y as tendrs a mano siempre las pruebas. Te recomiendo que desarrolles con el test unitario lanzado; es la manera ms rpida de probar el cdigo que ests tocando. Idealmente incluso con <strong>TDD</strong> el <a href=\"https://medium.com/javascript-scene/tdd-changed-my-life-5af0ce099f80\" target=\"_blank\" rel=\"noopener\">test antes del cdigo</a>.</p><blockquote><p>Para ms informacin acerca de lo til y rentable que resulta practicar <strong>TDD</strong>, te recomiendo que leas este artculo: <a href=\"https://theqalead.com/general/statistics-studies-benefits-test-driven-development/\" target=\"_blank\" rel=\"noopener\">Statistics &amp; Studies: The Benefits Of Test Driven Development</a></p></blockquote><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"test:shop\"</span>: <span class=\"string\">\"ng test shop --watch --verbose\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"test:warehouse\"</span>: <span class=\"string\">\"ng test warehouse --watch --verbose\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"test:api\"</span>: <span class=\"string\">\"ng test api --watch --verbose\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn test:shop</span><br><span class=\"line\">yarn test:warehouse</span><br><span class=\"line\">yarn test:api</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Tests-unitarios\"><a href=\"#2-2-Tests-unitarios\" class=\"headerlink\" title=\"2.2 Tests unitarios\"></a>2.2 Tests unitarios</h2><h3 id=\"2-2-1-Componentes\"><a href=\"#2-2-1-Componentes\" class=\"headerlink\" title=\"2.2.1 Componentes\"></a>2.2.1 Componentes</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">GIVEN:</span> <span class=\"string\">an</span> <span class=\"string\">AppComponent</span> <span class=\"string\">declared</span> <span class=\"string\">in</span> <span class=\"string\">AppModule</span></span><br><span class=\"line\"><span class=\"attr\">  WHEN:</span> <span class=\"string\">the</span> <span class=\"string\">AppModule</span> <span class=\"string\">is</span> <span class=\"string\">compiled</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">create</span> <span class=\"string\">the</span> <span class=\"string\">component</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">have</span> <span class=\"string\">a</span> <span class=\"string\">property</span> <span class=\"string\">title</span> <span class=\"string\">with</span> <span class=\"string\">value</span> <span class=\"string\">'shop'</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">render</span> <span class=\"string\">'Hello world'</span> <span class=\"string\">in</span> <span class=\"string\">a</span> <span class=\"string\">H1</span> <span class=\"string\">tag</span></span><br></pre></td></tr></table></figure><p>En este caso queremos probar una librera de componentes. Y empezamos por el componente raz. Esta es una prueba unitarias pero con un toque de integracin parcial pues necesita de otros componentes para ejecutarse. Cuanto ms arriba en la jerarqua est el componente mayor ser su necesidad de integrar a otros. Pero no pasa nada, de esta forma te aseguras de que el mdulo de la librera se importa y que sus componentes se exportan correctamente.</p><p>Al grano, vamos a la aplicacin <em>shop</em> para comprobar que su componente <code>AppComponent</code> funciona y (de paso) que se renderiza tambin el componente <code>ab-ui-greetings</code> incrustando los saludos.</p><p><code>apps\\shop\\src\\app\\app.component.spec.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; UiModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/ui'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"keyword\">async</span>, TestBed &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core/testing'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; RouterTestingModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router/testing'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">describe(<span class=\"string\">'GIVEN: an AppComponent declared in AppModule'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  describe(<span class=\"string\">'WHEN: the AppModule is compiled'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    beforeEach(<span class=\"keyword\">async</span>(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      TestBed.configureTestingModule(&#123;</span><br><span class=\"line\">        imports: [RouterTestingModule, UiModule],</span><br><span class=\"line\">        declarations: [AppComponent]</span><br><span class=\"line\">      &#125;).compileComponents();</span><br><span class=\"line\">    &#125;));</span><br><span class=\"line\"></span><br><span class=\"line\">    it(<span class=\"string\">'THEN: should create the component'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> fixture = TestBed.createComponent(AppComponent);</span><br><span class=\"line\">      <span class=\"keyword\">const</span> app = fixture.debugElement.componentInstance;</span><br><span class=\"line\">      expect(app).toBeTruthy();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    it(<span class=\"string\">`THEN: should have a property title with value 'shop'`</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> fixture = TestBed.createComponent(AppComponent);</span><br><span class=\"line\">      <span class=\"keyword\">const</span> app = fixture.debugElement.componentInstance;</span><br><span class=\"line\">      expect(app.title).toEqual(<span class=\"string\">'shop'</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    it(<span class=\"string\">`THEN: should render 'Hello world' in a H1 tag`</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> fixture = TestBed.createComponent(AppComponent);</span><br><span class=\"line\">      fixture.detectChanges();</span><br><span class=\"line\">      <span class=\"keyword\">const</span> compiled = fixture.debugElement.nativeElement;</span><br><span class=\"line\">      expect(compiled.querySelector(<span class=\"string\">'h1'</span>).textContent).toContain(<span class=\"string\">'Hello world'</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><h3 id=\"2-2-2-Services\"><a href=\"#2-2-2-Services\" class=\"headerlink\" title=\"2.2.2 Services\"></a>2.2.2 Services</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">GIVEN:</span> <span class=\"string\">a</span> <span class=\"string\">GreetingsService</span></span><br><span class=\"line\"><span class=\"attr\">  WHEN:</span> <span class=\"string\">the</span> <span class=\"string\">DataModule</span> <span class=\"string\">is</span> <span class=\"string\">compiled</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">be</span> <span class=\"string\">created</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">return</span> <span class=\"string\">an</span> <span class=\"string\">observable</span> <span class=\"string\">when</span> <span class=\"string\">call</span> <span class=\"string\">'getGrettings()'</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">return</span> <span class=\"string\">'Welcome to api!'</span> <span class=\"string\">when</span> <span class=\"string\">call</span> <span class=\"string\">'getGrettings()'</span></span><br></pre></td></tr></table></figure><p>La prueba de servicios es ms sencilla que la de componentes pues no hay que tratar con la renderizacin del HTML; slo funcionalidad en una clase TypeScript. Pero, siempre hay un pero, muchos de estos servicios tratarn con llamadas asncronas. Afortunadamente est todo pensado y se resuelve con dos conceptos: la funcin <code>async()</code> y inyeccin de rplicas (<em>mocks</em>) de las dependencias.</p><p><code>libs\\shared\\data\\src\\lib\\greetings\\greetings.service.spec.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// importar rplicas para testing de las dependencias del servicio</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123;</span><br><span class=\"line\">  HttpClientTestingModule,</span><br><span class=\"line\">  HttpTestingController</span><br><span class=\"line\">&#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http/testing'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"keyword\">async</span>, TestBed &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core/testing'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Observable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'rxjs'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; GreetingsService &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./greetings.service'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">describe(<span class=\"string\">'GIVEN: a GreetingsService'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  describe(<span class=\"string\">'WHEN: the DataModule is compiled'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    beforeEach(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      TestBed.configureTestingModule(&#123;</span><br><span class=\"line\">        imports: [HttpClientTestingModule]</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    it(<span class=\"string\">'THEN: should be created'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> service: GreetingsService = TestBed.get(GreetingsService);</span><br><span class=\"line\">      expect(service).toBeTruthy();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    it(<span class=\"string\">`THEN: should return an observable when call 'getGrettings()'`</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> service: GreetingsService = TestBed.get(GreetingsService);</span><br><span class=\"line\">      <span class=\"keyword\">const</span> greetings$: Observable&lt;<span class=\"built_in\">any</span>&gt; = service.getGrettings$();</span><br><span class=\"line\">      expect(greetings$).toBeInstanceOf(Observable);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Ojo al async para ejectuar las llamadas asncronas</span></span><br><span class=\"line\">    it(<span class=\"string\">`THEN: should return 'Welcome to api!' when call 'getGrettings()'`</span>, <span class=\"keyword\">async</span>(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> service: GreetingsService = TestBed.get(GreetingsService);</span><br><span class=\"line\">      service</span><br><span class=\"line\">        .getGrettings$()</span><br><span class=\"line\">        .subscribe(<span class=\"function\"><span class=\"params\">result</span> =&gt;</span></span><br><span class=\"line\">          expect(result).toEqual(&#123; message: <span class=\"string\">'Welcome to api!'</span> &#125;)</span><br><span class=\"line\">        );</span><br><span class=\"line\">      <span class=\"comment\">// mock del backend para no depender del servidor</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> httpMock = TestBed.get(HttpTestingController);</span><br><span class=\"line\">      <span class=\"comment\">// esperar a que se llame a esta ruta</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> req = httpMock.expectOne(<span class=\"string\">'http://localhost:3333/api'</span>);</span><br><span class=\"line\">      req.flush(&#123; message: <span class=\"string\">'Welcome to api!'</span> &#125;); <span class=\"comment\">// responder con esto</span></span><br><span class=\"line\">      httpMock.verify(); <span class=\"comment\">// comprobar que no hay ms llamadas</span></span><br><span class=\"line\">    &#125;));</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p>A partir de aqu es siempre igual. Defines un respuesta esperada, le das una entrada conocida y si algo no cuadra, entonces el cdigo no pasa la prueba y tienes una oportunidad para mejorarlo.</p><p>En la prueba de servicios es fundamental que uses rplicas de sus dependencias. Es la forma de garantizar que pruebas nicamente el servicio, sin depender de nada. Esto era mucho ms complejo con los componentes, pero un mandamiento con los servicios.</p><hr><h2 id=\"Resumen\"><a href=\"#Resumen\" class=\"headerlink\" title=\"Resumen\"></a>Resumen</h2><p>En definitiva, los grandes desarrollos demandados por bancos, multinacionales o administracin pblica requieren soluciones fiables y mantenibles. Y eso pasa inexcusablemente por hacer testing. <strong>Angular</strong> facilita las pruebas unitarias y de integracin; especialmente con las herramientas <em>Jest</em> y <em>Cypress</em> ya configuradas por <strong>NxDevTools</strong>.</p><p>Con este tutorial de formacin <a href=\"../tag/Avanzado/\">avanzada en Angular</a> te preparas para poder afrontar retos de tamao industrial. Contina aprendiendo a mejorar el rendimiento usando la <a href=\"../deteccion-del-cambio-en-Angular\">deteccin del cambio en Angular</a>. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-11_test.png\" alt=\"tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular\"></p><p>Continuamos este <strong>tutorial de Angular Avanzado</strong> con el tema controvertido del testing. S, ya s que todos deberamos hacerlo siempre, pero tambin s que no es cierto. As que vamos a ponerle remedio eliminando excusas y facilitando las pruebas automatizadas.</p><blockquote><p>Por si hace falta su defensa: Las pruebas automticas de cdigo son la principal tcnica de reduccin de bugs y garantizan el buen funcionamiento durante un refactoring. Bueno para el usuario bueno para el programador.</p></blockquote><p>Los desarrollos que hoy en da hacemos con <strong>Angular</strong> suelen ser de tamao medio o grande y con una esperanza de vida y mantenimiento que se mide en aos. As que cuantas ms pruebas tengamos menos miedo tendremos a cambiar el cdigo. Y la necesidad de cambio siempre estar ah. Veremos como <em>Jest</em> y <em>Cypress</em> nos ayudan muchsimo en la tarea.</p>","more":"<p>Partiendo del <a href=\"../nx-mono-repositorios-en-Angular\">mono repositorio creado</a> usando las herramientas de <a href=\"https://nrwl.io/\" target=\"_blank\" rel=\"noopener\">Nrwl.io/</a> aprovecharemos las herramientas que instala y configura dos productos de ltima generacin que facilitan la tarea. Usaremos <a href=\"https://jestjs.io/\" target=\"_blank\" rel=\"noopener\">Jest</a> para los test unitarios y <a href=\"https://www.cypress.io/\" target=\"_blank\" rel=\"noopener\">Cypress</a> para los de integracin <em>End to End</em>. Vamos a empezar por el final.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id=\"Tabla-de-Contenido\"><a href=\"#Tabla-de-Contenido\" class=\"headerlink\" title=\"Tabla de Contenido:\"></a>Tabla de Contenido:</h2><p><a href=\"./#1.-Test-de-Integracin-con-Cypress\">1. Test de Integracin con Cypress.</a></p><p><a href=\"./#2.-Test-Unitarios-con-Jest\">2. Test Unitarios con Jest.</a></p><p><a href=\"./#Resumen\">Resumen</a></p><hr><h1 id=\"1-Test-de-Integracion-con-Cypress\"><a href=\"#1-Test-de-Integracion-con-Cypress\" class=\"headerlink\" title=\"1. Test de Integracin con Cypress\"></a>1. Test de Integracin con Cypress</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">developer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">test</span> <span class=\"string\">end</span> <span class=\"string\">to</span> <span class=\"string\">end</span> <span class=\"string\">my</span> <span class=\"string\">app</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">be</span> <span class=\"string\">sure</span> <span class=\"string\">of</span> <span class=\"string\">the</span> <span class=\"string\">functions</span></span><br></pre></td></tr></table></figure><p>Las pruebas de integracin son las que tienen un retorno de inversin ms inmediato. Si esta es tu primera aproximacin al testing, te recomiendo empezar por aqu. Se trata de definir un escenario y pre programar el comportamiento del usuario. El sistema lo ejecutar y podrs contrastar el resultado con algn valor esperado.</p><p>Son pruebas de caja negra que interactan con el sistema en ejecucin. Todo ello automatizado y con informes visuales interactivos o en ficheros de texto con el resultado de las pruebas.</p><h2 id=\"1-1-Cypress\"><a href=\"#1-1-Cypress\" class=\"headerlink\" title=\"1.1 Cypress\"></a>1.1 Cypress</h2><p><a href=\"https://www.cypress.io/\" target=\"_blank\" rel=\"noopener\">Cypress</a> es el equivalente a Protractor, el producto propio de Angular. La ventaja principal es que no est atado a ningn framework y por tanto lo que hagas valdr para probar cualquier web en cualquier tecnologa.</p><p>Con cada aplicacin generada se crea una hermana para sus pruebas <em>e2e</em>. Esa aplicacin de pruebas est configurada y lista para compilar, servir y probar su aplicacin objetivo. Con <a href=\"https://twitter.com/NxDevTools\" target=\"_blank\" rel=\"noopener\">Nx</a> tenemos todo instalado, configurado y listo para ejecutarse con comandos como los siguientes que yo coloco en el <code>packcage.json</code>:</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"e2e:shop\"</span>: <span class=\"string\">\"ng e2e shop-e2e --watch\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"e2e:warehouse\"</span>: <span class=\"string\">\"ng e2e warehouse-e2e --watch\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Luego se pueden lanzar desde la terminal muy cmodamente.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn e2e:shop</span><br><span class=\"line\">yarn e2e:warehouse</span><br></pre></td></tr></table></figure><h2 id=\"1-2-Test-e2e\"><a href=\"#1-2-Test-e2e\" class=\"headerlink\" title=\"1.2 Test e2e\"></a>1.2 Test e2e</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">GIVEN:</span> <span class=\"string\">the</span> <span class=\"string\">shop</span> <span class=\"string\">web</span> <span class=\"string\">app</span></span><br><span class=\"line\"><span class=\"attr\">  WHEN:</span> <span class=\"string\">user</span> <span class=\"string\">visits</span> <span class=\"string\">home</span> <span class=\"string\">page</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">display</span> <span class=\"string\">welcome</span> <span class=\"string\">message</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">display</span> <span class=\"string\">welcome</span> <span class=\"string\">message</span> <span class=\"string\">from</span> <span class=\"string\">the</span> <span class=\"string\">API</span></span><br></pre></td></tr></table></figure><p>Tu trabajo como <em>tester</em> ser definir las pruebas en la carpeta <code>/integration</code>. Por ejemplo para empezar nos ofrecen el fichero <code>app-spec.ts</code> en el que yo he especificado el comportamiento deseado por mi pgina. La sintaxis se entiende por si misma. He seguido el convenio <strong>GIVEN, WHEN, THEN</strong> para especificar pruebas que podran considerarse casi de comportamiento o aceptacin.</p><p><code>apps\\shop-e2e\\src\\integration\\app.spec.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; getGreeting &#125; <span class=\"keyword\">from</span> <span class=\"string\">'../support/app.po'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">describe(<span class=\"string\">'GIVEN: the shop web app'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  beforeEach(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> cy.visit(<span class=\"string\">'/'</span>));</span><br><span class=\"line\">  context(<span class=\"string\">'WHEN: user visits home page'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    it(<span class=\"string\">'THEN: should display welcome message'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      getGreeting().contains(<span class=\"string\">'Hello world'</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"comment\">// needs the api server to run</span></span><br><span class=\"line\">    <span class=\"comment\">// yarn start:api</span></span><br><span class=\"line\">    it(<span class=\"string\">'THEN: should display welcome message from the API'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      getGreeting().contains(<span class=\"string\">'and Welcome to api!'</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p>La parte ms tcnica y tediosa es la que accede al <em>DOM</em> y lo mejor es tener eso a parte. En la carpeta <code>/support</code> nos sugieren que creemos utilidades para tratar con el <em>DOM</em> y de esa forma mantener los test lo ms cercanos posible a un lenguaje natural de negocio. En este caso uso una aproximacin libre al <a href=\"https://www.genbeta.com/desarrollo/bdd-cucumber-y-gherkin-desarrollo-dirigido-por-comportamiento\" target=\"_blank\" rel=\"noopener\">BDD con gherkin</a> para mantener el espritu de sencillez de un tutorial sobre tecnologa Angular, no sobre testing.</p><p><code>apps\\shop-e2e\\src\\support\\app.po.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> getGreeting = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> cy.get(<span class=\"string\">'h1'</span>);</span><br></pre></td></tr></table></figure><hr><h1 id=\"2-Test-Unitarios-con-Jest\"><a href=\"#2-Test-Unitarios-con-Jest\" class=\"headerlink\" title=\"2. Test Unitarios con Jest\"></a>2. Test Unitarios con Jest</h1><p>Las pruebas unitarias, muy asociadas al <a href=\"https://hackernoon.com/introduction-to-test-driven-development-tdd-61a13bc92d92\" target=\"_blank\" rel=\"noopener\">TDD</a>, son las mejores amigas del desarrollador. Pero, tambin son las ms engorrosas para empezar. As que aqu veremos una introduccin sencilla para que nadie deje de hacerlas.</p><h2 id=\"2-1-Jest\"><a href=\"#2-1-Jest\" class=\"headerlink\" title=\"2.1 Jest\"></a>2.1 Jest</h2><p><a href=\"https://jestjs.io/\" target=\"_blank\" rel=\"noopener\">Jest</a> es un framework de testing para JavaScript muy sencillo y rpido. Puedes usarlo con cualquier otro framework. Para el caso de Angular ya viene preconfigurado si usas las extensiones Nx.</p><p>Mete los siguientes scripts en el <code>package.json</code> y as tendrs a mano siempre las pruebas. Te recomiendo que desarrolles con el test unitario lanzado; es la manera ms rpida de probar el cdigo que ests tocando. Idealmente incluso con <strong>TDD</strong> el <a href=\"https://medium.com/javascript-scene/tdd-changed-my-life-5af0ce099f80\" target=\"_blank\" rel=\"noopener\">test antes del cdigo</a>.</p><blockquote><p>Para ms informacin acerca de lo til y rentable que resulta practicar <strong>TDD</strong>, te recomiendo que leas este artculo: <a href=\"https://theqalead.com/general/statistics-studies-benefits-test-driven-development/\" target=\"_blank\" rel=\"noopener\">Statistics &amp; Studies: The Benefits Of Test Driven Development</a></p></blockquote><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"test:shop\"</span>: <span class=\"string\">\"ng test shop --watch --verbose\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"test:warehouse\"</span>: <span class=\"string\">\"ng test warehouse --watch --verbose\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"test:api\"</span>: <span class=\"string\">\"ng test api --watch --verbose\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn test:shop</span><br><span class=\"line\">yarn test:warehouse</span><br><span class=\"line\">yarn test:api</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Tests-unitarios\"><a href=\"#2-2-Tests-unitarios\" class=\"headerlink\" title=\"2.2 Tests unitarios\"></a>2.2 Tests unitarios</h2><h3 id=\"2-2-1-Componentes\"><a href=\"#2-2-1-Componentes\" class=\"headerlink\" title=\"2.2.1 Componentes\"></a>2.2.1 Componentes</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">GIVEN:</span> <span class=\"string\">an</span> <span class=\"string\">AppComponent</span> <span class=\"string\">declared</span> <span class=\"string\">in</span> <span class=\"string\">AppModule</span></span><br><span class=\"line\"><span class=\"attr\">  WHEN:</span> <span class=\"string\">the</span> <span class=\"string\">AppModule</span> <span class=\"string\">is</span> <span class=\"string\">compiled</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">create</span> <span class=\"string\">the</span> <span class=\"string\">component</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">have</span> <span class=\"string\">a</span> <span class=\"string\">property</span> <span class=\"string\">title</span> <span class=\"string\">with</span> <span class=\"string\">value</span> <span class=\"string\">'shop'</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">render</span> <span class=\"string\">'Hello world'</span> <span class=\"string\">in</span> <span class=\"string\">a</span> <span class=\"string\">H1</span> <span class=\"string\">tag</span></span><br></pre></td></tr></table></figure><p>En este caso queremos probar una librera de componentes. Y empezamos por el componente raz. Esta es una prueba unitarias pero con un toque de integracin parcial pues necesita de otros componentes para ejecutarse. Cuanto ms arriba en la jerarqua est el componente mayor ser su necesidad de integrar a otros. Pero no pasa nada, de esta forma te aseguras de que el mdulo de la librera se importa y que sus componentes se exportan correctamente.</p><p>Al grano, vamos a la aplicacin <em>shop</em> para comprobar que su componente <code>AppComponent</code> funciona y (de paso) que se renderiza tambin el componente <code>ab-ui-greetings</code> incrustando los saludos.</p><p><code>apps\\shop\\src\\app\\app.component.spec.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; UiModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@a-boss/ui'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"keyword\">async</span>, TestBed &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core/testing'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; RouterTestingModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router/testing'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">describe(<span class=\"string\">'GIVEN: an AppComponent declared in AppModule'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  describe(<span class=\"string\">'WHEN: the AppModule is compiled'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    beforeEach(<span class=\"keyword\">async</span>(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      TestBed.configureTestingModule(&#123;</span><br><span class=\"line\">        imports: [RouterTestingModule, UiModule],</span><br><span class=\"line\">        declarations: [AppComponent]</span><br><span class=\"line\">      &#125;).compileComponents();</span><br><span class=\"line\">    &#125;));</span><br><span class=\"line\"></span><br><span class=\"line\">    it(<span class=\"string\">'THEN: should create the component'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> fixture = TestBed.createComponent(AppComponent);</span><br><span class=\"line\">      <span class=\"keyword\">const</span> app = fixture.debugElement.componentInstance;</span><br><span class=\"line\">      expect(app).toBeTruthy();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    it(<span class=\"string\">`THEN: should have a property title with value 'shop'`</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> fixture = TestBed.createComponent(AppComponent);</span><br><span class=\"line\">      <span class=\"keyword\">const</span> app = fixture.debugElement.componentInstance;</span><br><span class=\"line\">      expect(app.title).toEqual(<span class=\"string\">'shop'</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    it(<span class=\"string\">`THEN: should render 'Hello world' in a H1 tag`</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> fixture = TestBed.createComponent(AppComponent);</span><br><span class=\"line\">      fixture.detectChanges();</span><br><span class=\"line\">      <span class=\"keyword\">const</span> compiled = fixture.debugElement.nativeElement;</span><br><span class=\"line\">      expect(compiled.querySelector(<span class=\"string\">'h1'</span>).textContent).toContain(<span class=\"string\">'Hello world'</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><h3 id=\"2-2-2-Services\"><a href=\"#2-2-2-Services\" class=\"headerlink\" title=\"2.2.2 Services\"></a>2.2.2 Services</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">GIVEN:</span> <span class=\"string\">a</span> <span class=\"string\">GreetingsService</span></span><br><span class=\"line\"><span class=\"attr\">  WHEN:</span> <span class=\"string\">the</span> <span class=\"string\">DataModule</span> <span class=\"string\">is</span> <span class=\"string\">compiled</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">be</span> <span class=\"string\">created</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">return</span> <span class=\"string\">an</span> <span class=\"string\">observable</span> <span class=\"string\">when</span> <span class=\"string\">call</span> <span class=\"string\">'getGrettings()'</span></span><br><span class=\"line\"><span class=\"attr\">    THEN:</span> <span class=\"string\">should</span> <span class=\"string\">return</span> <span class=\"string\">'Welcome to api!'</span> <span class=\"string\">when</span> <span class=\"string\">call</span> <span class=\"string\">'getGrettings()'</span></span><br></pre></td></tr></table></figure><p>La prueba de servicios es ms sencilla que la de componentes pues no hay que tratar con la renderizacin del HTML; slo funcionalidad en una clase TypeScript. Pero, siempre hay un pero, muchos de estos servicios tratarn con llamadas asncronas. Afortunadamente est todo pensado y se resuelve con dos conceptos: la funcin <code>async()</code> y inyeccin de rplicas (<em>mocks</em>) de las dependencias.</p><p><code>libs\\shared\\data\\src\\lib\\greetings\\greetings.service.spec.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// importar rplicas para testing de las dependencias del servicio</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123;</span><br><span class=\"line\">  HttpClientTestingModule,</span><br><span class=\"line\">  HttpTestingController</span><br><span class=\"line\">&#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http/testing'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"keyword\">async</span>, TestBed &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core/testing'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Observable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'rxjs'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; GreetingsService &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./greetings.service'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">describe(<span class=\"string\">'GIVEN: a GreetingsService'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  describe(<span class=\"string\">'WHEN: the DataModule is compiled'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    beforeEach(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      TestBed.configureTestingModule(&#123;</span><br><span class=\"line\">        imports: [HttpClientTestingModule]</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    it(<span class=\"string\">'THEN: should be created'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> service: GreetingsService = TestBed.get(GreetingsService);</span><br><span class=\"line\">      expect(service).toBeTruthy();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    it(<span class=\"string\">`THEN: should return an observable when call 'getGrettings()'`</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> service: GreetingsService = TestBed.get(GreetingsService);</span><br><span class=\"line\">      <span class=\"keyword\">const</span> greetings$: Observable&lt;<span class=\"built_in\">any</span>&gt; = service.getGrettings$();</span><br><span class=\"line\">      expect(greetings$).toBeInstanceOf(Observable);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Ojo al async para ejectuar las llamadas asncronas</span></span><br><span class=\"line\">    it(<span class=\"string\">`THEN: should return 'Welcome to api!' when call 'getGrettings()'`</span>, <span class=\"keyword\">async</span>(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> service: GreetingsService = TestBed.get(GreetingsService);</span><br><span class=\"line\">      service</span><br><span class=\"line\">        .getGrettings$()</span><br><span class=\"line\">        .subscribe(<span class=\"function\"><span class=\"params\">result</span> =&gt;</span></span><br><span class=\"line\">          expect(result).toEqual(&#123; message: <span class=\"string\">'Welcome to api!'</span> &#125;)</span><br><span class=\"line\">        );</span><br><span class=\"line\">      <span class=\"comment\">// mock del backend para no depender del servidor</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> httpMock = TestBed.get(HttpTestingController);</span><br><span class=\"line\">      <span class=\"comment\">// esperar a que se llame a esta ruta</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> req = httpMock.expectOne(<span class=\"string\">'http://localhost:3333/api'</span>);</span><br><span class=\"line\">      req.flush(&#123; message: <span class=\"string\">'Welcome to api!'</span> &#125;); <span class=\"comment\">// responder con esto</span></span><br><span class=\"line\">      httpMock.verify(); <span class=\"comment\">// comprobar que no hay ms llamadas</span></span><br><span class=\"line\">    &#125;));</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p>A partir de aqu es siempre igual. Defines un respuesta esperada, le das una entrada conocida y si algo no cuadra, entonces el cdigo no pasa la prueba y tienes una oportunidad para mejorarlo.</p><p>En la prueba de servicios es fundamental que uses rplicas de sus dependencias. Es la forma de garantizar que pruebas nicamente el servicio, sin depender de nada. Esto era mucho ms complejo con los componentes, pero un mandamiento con los servicios.</p><hr><h2 id=\"Resumen\"><a href=\"#Resumen\" class=\"headerlink\" title=\"Resumen\"></a>Resumen</h2><p>En definitiva, los grandes desarrollos demandados por bancos, multinacionales o administracin pblica requieren soluciones fiables y mantenibles. Y eso pasa inexcusablemente por hacer testing. <strong>Angular</strong> facilita las pruebas unitarias y de integracin; especialmente con las herramientas <em>Jest</em> y <em>Cypress</em> ya configuradas por <strong>NxDevTools</strong>.</p><p>Con este tutorial de formacin <a href=\"../tag/Avanzado/\">avanzada en Angular</a> te preparas para poder afrontar retos de tamao industrial. Contina aprendiendo a mejorar el rendimiento usando la <a href=\"../deteccion-del-cambio-en-Angular\">deteccin del cambio en Angular</a>. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Deteccin del cambio en Angular","date":"2019-09-11T16:09:27.000Z","thumbnail":"/css/images/angular-12_change.png","_content":"\n![deteccion-del-cambio-en-Angular](/images/tutorial-angular-12_change.png)\n\nLa forma en que Angular realiza su renderizado y actualiza sus vistas es un factor clave para el rendimiento de las aplicaciones. Cmo funciona la estrategia de deteccin de cambios de Angular? Pues tiene dos modos: `default` o *automgico* y `onPush` o *mindfulness*.\n\n> Es importante tomar consciencia sobre el proceso y las implicaciones. Es costoso realizar la deteccin ms veces de lo necesario y  no hacerlo suficientemente implica no ver resultados reales.\n\nAfortunadamente el cambio del modo automtico al manual no tiene por qu ser traumtico. Con un mayor conocimiento del `changeDetectionStrategy` y un poco de trabajo extra tendrs aplicaciones ms eficientes y mantenibles.\n\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Tests unitarios con Jest y e2e con Cypress en Angular](../tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular/). Al finalizar tendrs una aplicacin que actualiza la vista slo cuando es necesario, es decir: cuando los datos han cambiado.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n\n## Tabla de Contenido:\n\n[1. Comunicacin de datos entre componentes.](./#1-Comunicacion-de-datos-entre-componentes)\n\n[2. Change detection strategies](./#2-Change-detection-strategies)\n\n[3. Inmutabilidad](./#3-Inmutabilidad)\n\n[Diagramas](./#Diagramas)\n\n[Resumen](./#Resumen)\n\n---\n\n# 1 Comunicacin de datos entre componentes\n\n```yaml\nAs a: customer,\n  I want: to see a shopping cart page\n  so that: i can browse the list of products in my basket\n\nAs a: customer,\n  I want: to pick a product\n  so that: I can add units to my basket\n\nAs a: customer,\n  I want: to remove a product from my basket\n  so that: I can take less units\n\nAs a: customer,\n  I want: to see always counters of my basket\n  so that: I can know what I'm buying\n```\n\nSigue la pista al cdigo de ejemplo creado a partir de estos comandos:\n\n```terminal\nng g m cart --project=shop --module=app.module.ts --routing --route=cart\n```\n\n`apps\\shop\\src\\app\\app.component.html`\n\n```html\n<nav>\n  <a [routerLink]=\"['/cart']\">Basket</a>\n</nav>\n```\n\n```terminal\nng g c cart/item-picker --project=shop\nng g c cart/basket-list --project=shop\nng g s basket --project=shop\n```\n\nLa deteccin de cambios se dispara ante eventos que le ocurren a los componentes. **La deteccin se realiza componente a componente**, as que compensa tener muchos componentes pequeos, para que cada uno por si slo no genere demasiado ruido.\n\n## 1.1 Componentes Contenedores y Presentadores\n\nAl pasar de un nico componente a varios mini-componentes, se propone usar **el patrn contenedor / presentadores**. Se mantiene un componente padre que contiene mltiples componentes presentadores hijos. El contendor es el nico con acceso a los servicios de negocio y datos. Los presentadores reciben los datos y emiten eventos. Los presentadores no obtienen ni modifican datos por su cuenta.\n\nNomenclatura\n- **Container**: aka *Parent, Smart*. `AppComponent` y `CartComponent`\n- **Presenter**: aka *Child, Dumb*. `ItemPickerComponent` y `BasketListComponent`\n\n> Este reparto de responsabilidades es aconsejable independientemente de la estrategia de deteccin aplicada. Tienes ms informacin el artculo de introduccin [flujo de datos entre componentes](../flujo-de-datos-entre-componentes-angular).\n\n# 2 Change detection strategies\n\nCon la aplicacin bien estructurada en componentes y con la comunicacin estandarizada, habremos reducido el impacto de la deteccin del cambio y estaremos preparados para optimizarlo. Conozcamos en detalle las estrategias de deteccin del cambio.\n\nEl decorador `@Component()` admite en su configuracin la poco conocida propiedad `changeDetection`. Dicha propiedad puede asignarse manualmente al componente, o indicarle su uso al generador del cli.\n\n## 2.1 Deteccin automtica, *default*\n\nPor defecto, Angular tiene que ser conservador y verificar cada posible cambio, esto se denomina comprobacin sucia o *dirty checking*. Se dispara **con demasiada frecuencia**, al menos en los siguientes casos:\n\n- Eventos desde el browser\n- Timers, intervals etc..\n- Llamadas http\n- Promesas y cdigo asncrono.\n\nPor si fuera poco, adems de dispararse mucho es **muy costoso**. Determinar que algo ha cambiado implica comparar dos estados: el actual y el anterior.\n\n> La comparacin es valor a valor, en profundidad, para cada propiedad de cada objeto, para cada objeto de cada array.\n\nCon todo, esta estrategia es cmoda para el programador y suficiente para casos bsicos. Pero demasiada magia dificulta el control en aplicaciones complejas. Y en pantallas de mucha informacin e interaccin degrada el rendimiento percibido.\n\n## 2.2 Deteccin manual, *onPush*\n\nComo se puede prever, la deteccin del cambio manual es lanzada por el programador. No siempre va a ser laborioso, pero ser ms consciente pues para que ocurra han de darse alguna de estas circunstancias:\n\n- **Explcitamente** el programador solicita la deteccin llamando a `ChangeDetectorRef.detectChanges();\n- **Implcitamente** al usar el `pipe Async` en la vista se llama a ese mismo mtodo.\n- **Conscientemente** el desarrollador obliga a un componente a repintarse si le cambia la referencia a un `@Input()`.\n\n> En este modo los componentes dejan de evaluar y comparar sus propiedades rutinariamente. Slo atienden a eventos `@Output()` o **cambios de referencia** `@Input()`. Esto relaja mucho al motor de Angular, que ya no tiene que hacer comparaciones odiosas. Sabr que algo ha cambiado porque... es otro objeto.\n\n# 3 Inmutabilidad\n\nComo ya se ha dicho, para que Angular en la estrategia automtica decida que algo ha cambiado necesita hacer una comparacin por valor. Para evitar ese coste usamos la estrategia manual y el programador tiene que cambiar la referencia de algo cuando quiera que Angular repinte la vista.\n\n## 3.1 Por referencia y por valor\n\nNormalmente tendr que crear un nuevo objeto y reasignarlo en lugar del anterior en un **ciclo de clonacin, mutacin y asignacin**. Por costoso que parezca siempre compensa si evita muchas e innecesarias comparaciones por valor en estructuras profundas.\n\nLa estrategia `onPush` trata a todos los `Inputs` en inmutables, es decir, algo que no espera que cambie. Similar al paso de parmetros por valor, que si cambia es porque es otro puntero.\n\n## 3.2 El clonado\nEl potencialmente pesado trabajo de clonado lo podemos evitar en muchos casos usando alguna de estas tcnicas:\n\n- **Tipos primitivos** que se pasan por valor en las propiedades `@Input()`\n- **Arrays**: muchos mtodos como `.filter() .slice() .sort() .concat()` etc., devuelven nuevas referencias sin modificar el array original.\n- **Observables y el pipe Async**, pues en este caso se subscribe y lanza implcitamente la deteccin del cambio. No hay necesidad de clonar todo lo que llega por _http_.\n\nPara los dems casos tenemos operadores *TypeScript* sencillos y optimizados para obtener nuevas referencias a partir de otros ya existentes.\n\n```typescript\n// js cloning techniques\nconst original = { name:'first', value:1 };\nconst cloned = { ...original };\n// > { name:'first', value:1 }\nconst mutated = { ...original, value:2, newProperty: 'added' };\n// > { name:'first', value:2, newProperty: 'added' }\nconst list = [ original, cloned, mutated ];\n// > [ { name:'first', value:1 }, { name:'first', value:1 }, { name:'first', value:2, newProperty: 'added' } ]\nconst clonedList = [ ...list ];\n// > [ { name:'first', value:1 }, { name:'first', value:1 }, { name:'first', value:2, newProperty: 'added' } ]\nconst mutatedList = [ ...list, { name: 'new item'} ];\n// > [ { name:'first', value:1 }, { name:'first', value:1 }, { name:'first', value:2, newProperty: 'added' }, { name: 'new item'} ]\nconst newList = list.filter(i => i.name=='first');\n// > [ { name:'first', value:1 }, { name:'first', value:1 }, { name:'first', value:2, newProperty: 'added' } ]\n```\n\nYa tienes los conocimientos para acelerar y reducir la incertidumbre sobre el actualizacin de vistas usando el patrn **contenedor / presentador** junto con la estrategia de deteccin de cambios `OnPush`. Ahora vamos a ver un ejemplo.\n\n\n\n## 3.3 Todo reactivo.\n\n```yaml\n Como: desarrollador\n  quiero: que las comunicaciones sean fluidas e independientes del tiempo\n  para que: los cambios en los datos cambien la presentacin sin esfuerzo\n```\n\nOtro de los pilares de la programacin moderna de grandes aplicaciones es la **reactividad** (nada que ver con Chernbil). Se trata de que los cambios se comuniquen cuando ocurran, sin necesidad de preguntar por ellos. De esta forma **los componentes reaccionarn al cambio** en lugar de buscarlo proactivamente mejorando mucho el rendimiento de las aplicaciones.\n\nReducida a lo esencial, la lgica ms bsica que quiero comunicar es un contador de elementos y la propia cesta. Un msero nmero y un array. Pero claro, hacerlo reactivo requiere usar observables, y para eso emplearemos la librera [RxJs](https://www.learnrxjs.io/concepts/rxjs-primer.html).\n\n---\n\n## Diagramas\n\nEl siguiente diagrama nos muestra a vista de pjaro los procesos que sique Angular para la deteccin del cambio y sus dos estrategias.\n\n![Deteccin del cambio](/images/change-detection.jpg)\n\n---\n\n## Resumen\n\n### OnPush es ms ligero\n\n- Se lanza menos veces\n\n- Slo comprueba referencias, no valores\n\n\n### Async, CDR y clone detectan los cambios\n\n- **`Async`:** para que las respuestas desde observables sean limpias\n\n- **_CDR_:** cuando el cambio venga de procesos asncronos pero no observables\n\n- **_Clonado_:** para que se detecten cambios simplemente usando las referencias\n\nLa deteccin automtica es cmoda pero costosa. Por dos razones: se dispara muchas veces y necesita comprobar si hay cambios comparando valor por valor. La deteccin manual es ms eficiente. Se lanza menos veces y adems le basta un cambio de referencia para saber que hay novedades. Para poder usarla sin grandes trabajos recomiendo usar el _pipe_ `async`, siempre con orgenes de datos observables. Para ello necesitamos usar y conocer patrones que hagan uso de la librera observable _RxJs_\n\nPero vale ya de infraestructura, pasemos a algo visual. En este tutorial de formacin [avanzada en Angular](../tag/Avanzado/) veremos ahora cmo crear [componentes dinmicos, directivas y pipes con Angular](../componentes-dinamicos-directivas-y-pipes-con-Angular). Todos esos detalles se tratan en el [curso avanzado online](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-12-Deteccion-del-cambio-en-Angular.md","raw":"---\ntitle: Deteccin del cambio en Angular\npermalink: deteccion-del-cambio-en-Angular\ndate: 2019-09-11 18:09:27\ntags:\n- Angular\n- Angular8\n- ChangeDetection\n- Observables\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-12_change.png\n---\n\n![deteccion-del-cambio-en-Angular](/images/tutorial-angular-12_change.png)\n\nLa forma en que Angular realiza su renderizado y actualiza sus vistas es un factor clave para el rendimiento de las aplicaciones. Cmo funciona la estrategia de deteccin de cambios de Angular? Pues tiene dos modos: `default` o *automgico* y `onPush` o *mindfulness*.\n\n> Es importante tomar consciencia sobre el proceso y las implicaciones. Es costoso realizar la deteccin ms veces de lo necesario y  no hacerlo suficientemente implica no ver resultados reales.\n\nAfortunadamente el cambio del modo automtico al manual no tiene por qu ser traumtico. Con un mayor conocimiento del `changeDetectionStrategy` y un poco de trabajo extra tendrs aplicaciones ms eficientes y mantenibles.\n\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Tests unitarios con Jest y e2e con Cypress en Angular](../tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular/). Al finalizar tendrs una aplicacin que actualiza la vista slo cuando es necesario, es decir: cuando los datos han cambiado.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n\n## Tabla de Contenido:\n\n[1. Comunicacin de datos entre componentes.](./#1-Comunicacion-de-datos-entre-componentes)\n\n[2. Change detection strategies](./#2-Change-detection-strategies)\n\n[3. Inmutabilidad](./#3-Inmutabilidad)\n\n[Diagramas](./#Diagramas)\n\n[Resumen](./#Resumen)\n\n---\n\n# 1 Comunicacin de datos entre componentes\n\n```yaml\nAs a: customer,\n  I want: to see a shopping cart page\n  so that: i can browse the list of products in my basket\n\nAs a: customer,\n  I want: to pick a product\n  so that: I can add units to my basket\n\nAs a: customer,\n  I want: to remove a product from my basket\n  so that: I can take less units\n\nAs a: customer,\n  I want: to see always counters of my basket\n  so that: I can know what I'm buying\n```\n\nSigue la pista al cdigo de ejemplo creado a partir de estos comandos:\n\n```terminal\nng g m cart --project=shop --module=app.module.ts --routing --route=cart\n```\n\n`apps\\shop\\src\\app\\app.component.html`\n\n```html\n<nav>\n  <a [routerLink]=\"['/cart']\">Basket</a>\n</nav>\n```\n\n```terminal\nng g c cart/item-picker --project=shop\nng g c cart/basket-list --project=shop\nng g s basket --project=shop\n```\n\nLa deteccin de cambios se dispara ante eventos que le ocurren a los componentes. **La deteccin se realiza componente a componente**, as que compensa tener muchos componentes pequeos, para que cada uno por si slo no genere demasiado ruido.\n\n## 1.1 Componentes Contenedores y Presentadores\n\nAl pasar de un nico componente a varios mini-componentes, se propone usar **el patrn contenedor / presentadores**. Se mantiene un componente padre que contiene mltiples componentes presentadores hijos. El contendor es el nico con acceso a los servicios de negocio y datos. Los presentadores reciben los datos y emiten eventos. Los presentadores no obtienen ni modifican datos por su cuenta.\n\nNomenclatura\n- **Container**: aka *Parent, Smart*. `AppComponent` y `CartComponent`\n- **Presenter**: aka *Child, Dumb*. `ItemPickerComponent` y `BasketListComponent`\n\n> Este reparto de responsabilidades es aconsejable independientemente de la estrategia de deteccin aplicada. Tienes ms informacin el artculo de introduccin [flujo de datos entre componentes](../flujo-de-datos-entre-componentes-angular).\n\n# 2 Change detection strategies\n\nCon la aplicacin bien estructurada en componentes y con la comunicacin estandarizada, habremos reducido el impacto de la deteccin del cambio y estaremos preparados para optimizarlo. Conozcamos en detalle las estrategias de deteccin del cambio.\n\nEl decorador `@Component()` admite en su configuracin la poco conocida propiedad `changeDetection`. Dicha propiedad puede asignarse manualmente al componente, o indicarle su uso al generador del cli.\n\n## 2.1 Deteccin automtica, *default*\n\nPor defecto, Angular tiene que ser conservador y verificar cada posible cambio, esto se denomina comprobacin sucia o *dirty checking*. Se dispara **con demasiada frecuencia**, al menos en los siguientes casos:\n\n- Eventos desde el browser\n- Timers, intervals etc..\n- Llamadas http\n- Promesas y cdigo asncrono.\n\nPor si fuera poco, adems de dispararse mucho es **muy costoso**. Determinar que algo ha cambiado implica comparar dos estados: el actual y el anterior.\n\n> La comparacin es valor a valor, en profundidad, para cada propiedad de cada objeto, para cada objeto de cada array.\n\nCon todo, esta estrategia es cmoda para el programador y suficiente para casos bsicos. Pero demasiada magia dificulta el control en aplicaciones complejas. Y en pantallas de mucha informacin e interaccin degrada el rendimiento percibido.\n\n## 2.2 Deteccin manual, *onPush*\n\nComo se puede prever, la deteccin del cambio manual es lanzada por el programador. No siempre va a ser laborioso, pero ser ms consciente pues para que ocurra han de darse alguna de estas circunstancias:\n\n- **Explcitamente** el programador solicita la deteccin llamando a `ChangeDetectorRef.detectChanges();\n- **Implcitamente** al usar el `pipe Async` en la vista se llama a ese mismo mtodo.\n- **Conscientemente** el desarrollador obliga a un componente a repintarse si le cambia la referencia a un `@Input()`.\n\n> En este modo los componentes dejan de evaluar y comparar sus propiedades rutinariamente. Slo atienden a eventos `@Output()` o **cambios de referencia** `@Input()`. Esto relaja mucho al motor de Angular, que ya no tiene que hacer comparaciones odiosas. Sabr que algo ha cambiado porque... es otro objeto.\n\n# 3 Inmutabilidad\n\nComo ya se ha dicho, para que Angular en la estrategia automtica decida que algo ha cambiado necesita hacer una comparacin por valor. Para evitar ese coste usamos la estrategia manual y el programador tiene que cambiar la referencia de algo cuando quiera que Angular repinte la vista.\n\n## 3.1 Por referencia y por valor\n\nNormalmente tendr que crear un nuevo objeto y reasignarlo en lugar del anterior en un **ciclo de clonacin, mutacin y asignacin**. Por costoso que parezca siempre compensa si evita muchas e innecesarias comparaciones por valor en estructuras profundas.\n\nLa estrategia `onPush` trata a todos los `Inputs` en inmutables, es decir, algo que no espera que cambie. Similar al paso de parmetros por valor, que si cambia es porque es otro puntero.\n\n## 3.2 El clonado\nEl potencialmente pesado trabajo de clonado lo podemos evitar en muchos casos usando alguna de estas tcnicas:\n\n- **Tipos primitivos** que se pasan por valor en las propiedades `@Input()`\n- **Arrays**: muchos mtodos como `.filter() .slice() .sort() .concat()` etc., devuelven nuevas referencias sin modificar el array original.\n- **Observables y el pipe Async**, pues en este caso se subscribe y lanza implcitamente la deteccin del cambio. No hay necesidad de clonar todo lo que llega por _http_.\n\nPara los dems casos tenemos operadores *TypeScript* sencillos y optimizados para obtener nuevas referencias a partir de otros ya existentes.\n\n```typescript\n// js cloning techniques\nconst original = { name:'first', value:1 };\nconst cloned = { ...original };\n// > { name:'first', value:1 }\nconst mutated = { ...original, value:2, newProperty: 'added' };\n// > { name:'first', value:2, newProperty: 'added' }\nconst list = [ original, cloned, mutated ];\n// > [ { name:'first', value:1 }, { name:'first', value:1 }, { name:'first', value:2, newProperty: 'added' } ]\nconst clonedList = [ ...list ];\n// > [ { name:'first', value:1 }, { name:'first', value:1 }, { name:'first', value:2, newProperty: 'added' } ]\nconst mutatedList = [ ...list, { name: 'new item'} ];\n// > [ { name:'first', value:1 }, { name:'first', value:1 }, { name:'first', value:2, newProperty: 'added' }, { name: 'new item'} ]\nconst newList = list.filter(i => i.name=='first');\n// > [ { name:'first', value:1 }, { name:'first', value:1 }, { name:'first', value:2, newProperty: 'added' } ]\n```\n\nYa tienes los conocimientos para acelerar y reducir la incertidumbre sobre el actualizacin de vistas usando el patrn **contenedor / presentador** junto con la estrategia de deteccin de cambios `OnPush`. Ahora vamos a ver un ejemplo.\n\n\n\n## 3.3 Todo reactivo.\n\n```yaml\n Como: desarrollador\n  quiero: que las comunicaciones sean fluidas e independientes del tiempo\n  para que: los cambios en los datos cambien la presentacin sin esfuerzo\n```\n\nOtro de los pilares de la programacin moderna de grandes aplicaciones es la **reactividad** (nada que ver con Chernbil). Se trata de que los cambios se comuniquen cuando ocurran, sin necesidad de preguntar por ellos. De esta forma **los componentes reaccionarn al cambio** en lugar de buscarlo proactivamente mejorando mucho el rendimiento de las aplicaciones.\n\nReducida a lo esencial, la lgica ms bsica que quiero comunicar es un contador de elementos y la propia cesta. Un msero nmero y un array. Pero claro, hacerlo reactivo requiere usar observables, y para eso emplearemos la librera [RxJs](https://www.learnrxjs.io/concepts/rxjs-primer.html).\n\n---\n\n## Diagramas\n\nEl siguiente diagrama nos muestra a vista de pjaro los procesos que sique Angular para la deteccin del cambio y sus dos estrategias.\n\n![Deteccin del cambio](/images/change-detection.jpg)\n\n---\n\n## Resumen\n\n### OnPush es ms ligero\n\n- Se lanza menos veces\n\n- Slo comprueba referencias, no valores\n\n\n### Async, CDR y clone detectan los cambios\n\n- **`Async`:** para que las respuestas desde observables sean limpias\n\n- **_CDR_:** cuando el cambio venga de procesos asncronos pero no observables\n\n- **_Clonado_:** para que se detecten cambios simplemente usando las referencias\n\nLa deteccin automtica es cmoda pero costosa. Por dos razones: se dispara muchas veces y necesita comprobar si hay cambios comparando valor por valor. La deteccin manual es ms eficiente. Se lanza menos veces y adems le basta un cambio de referencia para saber que hay novedades. Para poder usarla sin grandes trabajos recomiendo usar el _pipe_ `async`, siempre con orgenes de datos observables. Para ello necesitamos usar y conocer patrones que hagan uso de la librera observable _RxJs_\n\nPero vale ya de infraestructura, pasemos a algo visual. En este tutorial de formacin [avanzada en Angular](../tag/Avanzado/) veremos ahora cmo crear [componentes dinmicos, directivas y pipes con Angular](../componentes-dinamicos-directivas-y-pipes-con-Angular). Todos esos detalles se tratan en el [curso avanzado online](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"deteccion-del-cambio-en-Angular","published":1,"updated":"2019-10-16T14:23:01.020Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab1b000kbss3las8qgob","content":"<p><img src=\"/images/tutorial-angular-12_change.png\" alt=\"deteccion-del-cambio-en-Angular\"></p><p>La forma en que Angular realiza su renderizado y actualiza sus vistas es un factor clave para el rendimiento de las aplicaciones. Cmo funciona la estrategia de deteccin de cambios de Angular? Pues tiene dos modos: <code>default</code> o <em>automgico</em> y <code>onPush</code> o <em>mindfulness</em>.</p><blockquote><p>Es importante tomar consciencia sobre el proceso y las implicaciones. Es costoso realizar la deteccin ms veces de lo necesario y no hacerlo suficientemente implica no ver resultados reales.</p></blockquote><p>Afortunadamente el cambio del modo automtico al manual no tiene por qu ser traumtico. Con un mayor conocimiento del <code>changeDetectionStrategy</code> y un poco de trabajo extra tendrs aplicaciones ms eficientes y mantenibles.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular/\">Tests unitarios con Jest y e2e con Cypress en Angular</a>. Al finalizar tendrs una aplicacin que actualiza la vista slo cuando es necesario, es decir: cuando los datos han cambiado.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id=\"Tabla-de-Contenido\"><a href=\"#Tabla-de-Contenido\" class=\"headerlink\" title=\"Tabla de Contenido:\"></a>Tabla de Contenido:</h2><p><a href=\"./#1-Comunicacion-de-datos-entre-componentes\">1. Comunicacin de datos entre componentes.</a></p><p><a href=\"./#2-Change-detection-strategies\">2. Change detection strategies</a></p><p><a href=\"./#3-Inmutabilidad\">3. Inmutabilidad</a></p><p><a href=\"./#Diagramas\">Diagramas</a></p><p><a href=\"./#Resumen\">Resumen</a></p><hr><h1 id=\"1-Comunicacion-de-datos-entre-componentes\"><a href=\"#1-Comunicacion-de-datos-entre-componentes\" class=\"headerlink\" title=\"1 Comunicacin de datos entre componentes\"></a>1 Comunicacin de datos entre componentes</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">shopping</span> <span class=\"string\">cart</span> <span class=\"string\">page</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">i</span> <span class=\"string\">can</span> <span class=\"string\">browse</span> <span class=\"string\">the</span> <span class=\"string\">list</span> <span class=\"string\">of</span> <span class=\"string\">products</span> <span class=\"string\">in</span> <span class=\"string\">my</span> <span class=\"string\">basket</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">pick</span> <span class=\"string\">a</span> <span class=\"string\">product</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">add</span> <span class=\"string\">units</span> <span class=\"string\">to</span> <span class=\"string\">my</span> <span class=\"string\">basket</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">remove</span> <span class=\"string\">a</span> <span class=\"string\">product</span> <span class=\"string\">from</span> <span class=\"string\">my</span> <span class=\"string\">basket</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">take</span> <span class=\"string\">less</span> <span class=\"string\">units</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">always</span> <span class=\"string\">counters</span> <span class=\"string\">of</span> <span class=\"string\">my</span> <span class=\"string\">basket</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">know</span> <span class=\"string\">what</span> <span class=\"string\">I'm</span> <span class=\"string\">buying</span></span><br></pre></td></tr></table></figure><p>Sigue la pista al cdigo de ejemplo creado a partir de estos comandos:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m cart --project=shop --module=app.module.ts --routing --route=cart</span><br></pre></td></tr></table></figure><p><code>apps\\shop\\src\\app\\app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">nav</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/cart']\"</span>&gt;</span>Basket<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c cart/item-picker --project=shop</span><br><span class=\"line\">ng g c cart/basket-list --project=shop</span><br><span class=\"line\">ng g s basket --project=shop</span><br></pre></td></tr></table></figure><p>La deteccin de cambios se dispara ante eventos que le ocurren a los componentes. <strong>La deteccin se realiza componente a componente</strong>, as que compensa tener muchos componentes pequeos, para que cada uno por si slo no genere demasiado ruido.</p><h2 id=\"1-1-Componentes-Contenedores-y-Presentadores\"><a href=\"#1-1-Componentes-Contenedores-y-Presentadores\" class=\"headerlink\" title=\"1.1 Componentes Contenedores y Presentadores\"></a>1.1 Componentes Contenedores y Presentadores</h2><p>Al pasar de un nico componente a varios mini-componentes, se propone usar <strong>el patrn contenedor / presentadores</strong>. Se mantiene un componente padre que contiene mltiples componentes presentadores hijos. El contendor es el nico con acceso a los servicios de negocio y datos. Los presentadores reciben los datos y emiten eventos. Los presentadores no obtienen ni modifican datos por su cuenta.</p><p>Nomenclatura</p><ul><li><strong>Container</strong>: aka <em>Parent, Smart</em>. <code>AppComponent</code> y <code>CartComponent</code></li><li><strong>Presenter</strong>: aka <em>Child, Dumb</em>. <code>ItemPickerComponent</code> y <code>BasketListComponent</code></li></ul><blockquote><p>Este reparto de responsabilidades es aconsejable independientemente de la estrategia de deteccin aplicada. Tienes ms informacin el artculo de introduccin <a href=\"../flujo-de-datos-entre-componentes-angular\">flujo de datos entre componentes</a>.</p></blockquote><h1 id=\"2-Change-detection-strategies\"><a href=\"#2-Change-detection-strategies\" class=\"headerlink\" title=\"2 Change detection strategies\"></a>2 Change detection strategies</h1><p>Con la aplicacin bien estructurada en componentes y con la comunicacin estandarizada, habremos reducido el impacto de la deteccin del cambio y estaremos preparados para optimizarlo. Conozcamos en detalle las estrategias de deteccin del cambio.</p><p>El decorador <code>@Component()</code> admite en su configuracin la poco conocida propiedad <code>changeDetection</code>. Dicha propiedad puede asignarse manualmente al componente, o indicarle su uso al generador del cli.</p><h2 id=\"2-1-Deteccion-automatica-default\"><a href=\"#2-1-Deteccion-automatica-default\" class=\"headerlink\" title=\"2.1 Deteccin automtica, default\"></a>2.1 Deteccin automtica, <em>default</em></h2><p>Por defecto, Angular tiene que ser conservador y verificar cada posible cambio, esto se denomina comprobacin sucia o <em>dirty checking</em>. Se dispara <strong>con demasiada frecuencia</strong>, al menos en los siguientes casos:</p><ul><li>Eventos desde el browser</li><li>Timers, intervals etc..</li><li>Llamadas http</li><li>Promesas y cdigo asncrono.</li></ul><p>Por si fuera poco, adems de dispararse mucho es <strong>muy costoso</strong>. Determinar que algo ha cambiado implica comparar dos estados: el actual y el anterior.</p><blockquote><p>La comparacin es valor a valor, en profundidad, para cada propiedad de cada objeto, para cada objeto de cada array.</p></blockquote><p>Con todo, esta estrategia es cmoda para el programador y suficiente para casos bsicos. Pero demasiada magia dificulta el control en aplicaciones complejas. Y en pantallas de mucha informacin e interaccin degrada el rendimiento percibido.</p><h2 id=\"2-2-Deteccion-manual-onPush\"><a href=\"#2-2-Deteccion-manual-onPush\" class=\"headerlink\" title=\"2.2 Deteccin manual, onPush\"></a>2.2 Deteccin manual, <em>onPush</em></h2><p>Como se puede prever, la deteccin del cambio manual es lanzada por el programador. No siempre va a ser laborioso, pero ser ms consciente pues para que ocurra han de darse alguna de estas circunstancias:</p><ul><li><strong>Explcitamente</strong> el programador solicita la deteccin llamando a `ChangeDetectorRef.detectChanges();</li><li><strong>Implcitamente</strong> al usar el <code>pipe Async</code> en la vista se llama a ese mismo mtodo.</li><li><strong>Conscientemente</strong> el desarrollador obliga a un componente a repintarse si le cambia la referencia a un <code>@Input()</code>.</li></ul><blockquote><p>En este modo los componentes dejan de evaluar y comparar sus propiedades rutinariamente. Slo atienden a eventos <code>@Output()</code> o <strong>cambios de referencia</strong> <code>@Input()</code>. Esto relaja mucho al motor de Angular, que ya no tiene que hacer comparaciones odiosas. Sabr que algo ha cambiado porque es otro objeto.</p></blockquote><h1 id=\"3-Inmutabilidad\"><a href=\"#3-Inmutabilidad\" class=\"headerlink\" title=\"3 Inmutabilidad\"></a>3 Inmutabilidad</h1><p>Como ya se ha dicho, para que Angular en la estrategia automtica decida que algo ha cambiado necesita hacer una comparacin por valor. Para evitar ese coste usamos la estrategia manual y el programador tiene que cambiar la referencia de algo cuando quiera que Angular repinte la vista.</p><h2 id=\"3-1-Por-referencia-y-por-valor\"><a href=\"#3-1-Por-referencia-y-por-valor\" class=\"headerlink\" title=\"3.1 Por referencia y por valor\"></a>3.1 Por referencia y por valor</h2><p>Normalmente tendr que crear un nuevo objeto y reasignarlo en lugar del anterior en un <strong>ciclo de clonacin, mutacin y asignacin</strong>. Por costoso que parezca siempre compensa si evita muchas e innecesarias comparaciones por valor en estructuras profundas.</p><p>La estrategia <code>onPush</code> trata a todos los <code>Inputs</code> en inmutables, es decir, algo que no espera que cambie. Similar al paso de parmetros por valor, que si cambia es porque es otro puntero.</p><h2 id=\"3-2-El-clonado\"><a href=\"#3-2-El-clonado\" class=\"headerlink\" title=\"3.2 El clonado\"></a>3.2 El clonado</h2><p>El potencialmente pesado trabajo de clonado lo podemos evitar en muchos casos usando alguna de estas tcnicas:</p><ul><li><strong>Tipos primitivos</strong> que se pasan por valor en las propiedades <code>@Input()</code></li><li><strong>Arrays</strong>: muchos mtodos como <code>.filter() .slice() .sort() .concat()</code> etc., devuelven nuevas referencias sin modificar el array original.</li><li><strong>Observables y el pipe Async</strong>, pues en este caso se subscribe y lanza implcitamente la deteccin del cambio. No hay necesidad de clonar todo lo que llega por <em>http</em>.</li></ul><p>Para los dems casos tenemos operadores <em>TypeScript</em> sencillos y optimizados para obtener nuevas referencias a partir de otros ya existentes.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// js cloning techniques</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> original = &#123; name:<span class=\"string\">'first'</span>, value:<span class=\"number\">1</span> &#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> cloned = &#123; ...original &#125;;</span><br><span class=\"line\"><span class=\"comment\">// &gt; &#123; name:'first', value:1 &#125;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> mutated = &#123; ...original, value:<span class=\"number\">2</span>, newProperty: <span class=\"string\">'added'</span> &#125;;</span><br><span class=\"line\"><span class=\"comment\">// &gt; &#123; name:'first', value:2, newProperty: 'added' &#125;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> list = [ original, cloned, mutated ];</span><br><span class=\"line\"><span class=\"comment\">// &gt; [ &#123; name:'first', value:1 &#125;, &#123; name:'first', value:1 &#125;, &#123; name:'first', value:2, newProperty: 'added' &#125; ]</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> clonedList = [ ...list ];</span><br><span class=\"line\"><span class=\"comment\">// &gt; [ &#123; name:'first', value:1 &#125;, &#123; name:'first', value:1 &#125;, &#123; name:'first', value:2, newProperty: 'added' &#125; ]</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> mutatedList = [ ...list, &#123; name: <span class=\"string\">'new item'</span>&#125; ];</span><br><span class=\"line\"><span class=\"comment\">// &gt; [ &#123; name:'first', value:1 &#125;, &#123; name:'first', value:1 &#125;, &#123; name:'first', value:2, newProperty: 'added' &#125;, &#123; name: 'new item'&#125; ]</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> newList = list.filter(<span class=\"function\"><span class=\"params\">i</span> =&gt;</span> i.name==<span class=\"string\">'first'</span>);</span><br><span class=\"line\"><span class=\"comment\">// &gt; [ &#123; name:'first', value:1 &#125;, &#123; name:'first', value:1 &#125;, &#123; name:'first', value:2, newProperty: 'added' &#125; ]</span></span><br></pre></td></tr></table></figure><p>Ya tienes los conocimientos para acelerar y reducir la incertidumbre sobre el actualizacin de vistas usando el patrn <strong>contenedor / presentador</strong> junto con la estrategia de deteccin de cambios <code>OnPush</code>. Ahora vamos a ver un ejemplo.</p><h2 id=\"3-3-Todo-reactivo\"><a href=\"#3-3-Todo-reactivo\" class=\"headerlink\" title=\"3.3 Todo reactivo.\"></a>3.3 Todo reactivo.</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">Como:</span> <span class=\"string\">desarrollador</span></span><br><span class=\"line\"><span class=\"attr\"> quiero:</span> <span class=\"string\">que</span> <span class=\"string\">las</span> <span class=\"string\">comunicaciones</span> <span class=\"string\">sean</span> <span class=\"string\">fluidas</span> <span class=\"string\">e</span> <span class=\"string\">independientes</span> <span class=\"string\">del</span> <span class=\"string\">tiempo</span></span><br><span class=\"line\"> <span class=\"string\">para</span> <span class=\"attr\">que:</span> <span class=\"string\">los</span> <span class=\"string\">cambios</span> <span class=\"string\">en</span> <span class=\"string\">los</span> <span class=\"string\">datos</span> <span class=\"string\">cambien</span> <span class=\"string\">la</span> <span class=\"string\">presentacin</span> <span class=\"string\">sin</span> <span class=\"string\">esfuerzo</span></span><br></pre></td></tr></table></figure><p>Otro de los pilares de la programacin moderna de grandes aplicaciones es la <strong>reactividad</strong> (nada que ver con Chernbil). Se trata de que los cambios se comuniquen cuando ocurran, sin necesidad de preguntar por ellos. De esta forma <strong>los componentes reaccionarn al cambio</strong> en lugar de buscarlo proactivamente mejorando mucho el rendimiento de las aplicaciones.</p><p>Reducida a lo esencial, la lgica ms bsica que quiero comunicar es un contador de elementos y la propia cesta. Un msero nmero y un array. Pero claro, hacerlo reactivo requiere usar observables, y para eso emplearemos la librera <a href=\"https://www.learnrxjs.io/concepts/rxjs-primer.html\" target=\"_blank\" rel=\"noopener\">RxJs</a>.</p><hr><h2 id=\"Diagramas\"><a href=\"#Diagramas\" class=\"headerlink\" title=\"Diagramas\"></a>Diagramas</h2><p>El siguiente diagrama nos muestra a vista de pjaro los procesos que sique Angular para la deteccin del cambio y sus dos estrategias.</p><p><img src=\"/images/change-detection.jpg\" alt=\"Deteccin del cambio\"></p><hr><h2 id=\"Resumen\"><a href=\"#Resumen\" class=\"headerlink\" title=\"Resumen\"></a>Resumen</h2><h3 id=\"OnPush-es-mas-ligero\"><a href=\"#OnPush-es-mas-ligero\" class=\"headerlink\" title=\"OnPush es ms ligero\"></a>OnPush es ms ligero</h3><ul><li><p>Se lanza menos veces</p></li><li><p>Slo comprueba referencias, no valores</p></li></ul><h3 id=\"Async-CDR-y-clone-detectan-los-cambios\"><a href=\"#Async-CDR-y-clone-detectan-los-cambios\" class=\"headerlink\" title=\"Async, CDR y clone detectan los cambios\"></a>Async, CDR y clone detectan los cambios</h3><ul><li><p><strong><code>Async</code>:</strong> para que las respuestas desde observables sean limpias</p></li><li><p><strong><em>CDR</em>:</strong> cuando el cambio venga de procesos asncronos pero no observables</p></li><li><p><strong><em>Clonado</em>:</strong> para que se detecten cambios simplemente usando las referencias</p></li></ul><p>La deteccin automtica es cmoda pero costosa. Por dos razones: se dispara muchas veces y necesita comprobar si hay cambios comparando valor por valor. La deteccin manual es ms eficiente. Se lanza menos veces y adems le basta un cambio de referencia para saber que hay novedades. Para poder usarla sin grandes trabajos recomiendo usar el <em>pipe</em> <code>async</code>, siempre con orgenes de datos observables. Para ello necesitamos usar y conocer patrones que hagan uso de la librera observable <em>RxJs</em></p><p>Pero vale ya de infraestructura, pasemos a algo visual. En este tutorial de formacin <a href=\"../tag/Avanzado/\">avanzada en Angular</a> veremos ahora cmo crear <a href=\"../componentes-dinamicos-directivas-y-pipes-con-Angular\">componentes dinmicos, directivas y pipes con Angular</a>. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-12_change.png\" alt=\"deteccion-del-cambio-en-Angular\"></p><p>La forma en que Angular realiza su renderizado y actualiza sus vistas es un factor clave para el rendimiento de las aplicaciones. Cmo funciona la estrategia de deteccin de cambios de Angular? Pues tiene dos modos: <code>default</code> o <em>automgico</em> y <code>onPush</code> o <em>mindfulness</em>.</p><blockquote><p>Es importante tomar consciencia sobre el proceso y las implicaciones. Es costoso realizar la deteccin ms veces de lo necesario y no hacerlo suficientemente implica no ver resultados reales.</p></blockquote><p>Afortunadamente el cambio del modo automtico al manual no tiene por qu ser traumtico. Con un mayor conocimiento del <code>changeDetectionStrategy</code> y un poco de trabajo extra tendrs aplicaciones ms eficientes y mantenibles.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../tests-unitarios-con-jest-y-e2e-con-cypress-en-Angular/\">Tests unitarios con Jest y e2e con Cypress en Angular</a>. Al finalizar tendrs una aplicacin que actualiza la vista slo cuando es necesario, es decir: cuando los datos han cambiado.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id=\"Tabla-de-Contenido\"><a href=\"#Tabla-de-Contenido\" class=\"headerlink\" title=\"Tabla de Contenido:\"></a>Tabla de Contenido:</h2><p><a href=\"./#1-Comunicacion-de-datos-entre-componentes\">1. Comunicacin de datos entre componentes.</a></p><p><a href=\"./#2-Change-detection-strategies\">2. Change detection strategies</a></p><p><a href=\"./#3-Inmutabilidad\">3. Inmutabilidad</a></p><p><a href=\"./#Diagramas\">Diagramas</a></p><p><a href=\"./#Resumen\">Resumen</a></p><hr><h1 id=\"1-Comunicacion-de-datos-entre-componentes\"><a href=\"#1-Comunicacion-de-datos-entre-componentes\" class=\"headerlink\" title=\"1 Comunicacin de datos entre componentes\"></a>1 Comunicacin de datos entre componentes</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">shopping</span> <span class=\"string\">cart</span> <span class=\"string\">page</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">i</span> <span class=\"string\">can</span> <span class=\"string\">browse</span> <span class=\"string\">the</span> <span class=\"string\">list</span> <span class=\"string\">of</span> <span class=\"string\">products</span> <span class=\"string\">in</span> <span class=\"string\">my</span> <span class=\"string\">basket</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">pick</span> <span class=\"string\">a</span> <span class=\"string\">product</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">add</span> <span class=\"string\">units</span> <span class=\"string\">to</span> <span class=\"string\">my</span> <span class=\"string\">basket</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">remove</span> <span class=\"string\">a</span> <span class=\"string\">product</span> <span class=\"string\">from</span> <span class=\"string\">my</span> <span class=\"string\">basket</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">take</span> <span class=\"string\">less</span> <span class=\"string\">units</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">always</span> <span class=\"string\">counters</span> <span class=\"string\">of</span> <span class=\"string\">my</span> <span class=\"string\">basket</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">know</span> <span class=\"string\">what</span> <span class=\"string\">I'm</span> <span class=\"string\">buying</span></span><br></pre></td></tr></table></figure><p>Sigue la pista al cdigo de ejemplo creado a partir de estos comandos:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m cart --project=shop --module=app.module.ts --routing --route=cart</span><br></pre></td></tr></table></figure><p><code>apps\\shop\\src\\app\\app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">nav</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/cart']\"</span>&gt;</span>Basket<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c cart/item-picker --project=shop</span><br><span class=\"line\">ng g c cart/basket-list --project=shop</span><br><span class=\"line\">ng g s basket --project=shop</span><br></pre></td></tr></table></figure><p>La deteccin de cambios se dispara ante eventos que le ocurren a los componentes. <strong>La deteccin se realiza componente a componente</strong>, as que compensa tener muchos componentes pequeos, para que cada uno por si slo no genere demasiado ruido.</p><h2 id=\"1-1-Componentes-Contenedores-y-Presentadores\"><a href=\"#1-1-Componentes-Contenedores-y-Presentadores\" class=\"headerlink\" title=\"1.1 Componentes Contenedores y Presentadores\"></a>1.1 Componentes Contenedores y Presentadores</h2><p>Al pasar de un nico componente a varios mini-componentes, se propone usar <strong>el patrn contenedor / presentadores</strong>. Se mantiene un componente padre que contiene mltiples componentes presentadores hijos. El contendor es el nico con acceso a los servicios de negocio y datos. Los presentadores reciben los datos y emiten eventos. Los presentadores no obtienen ni modifican datos por su cuenta.</p><p>Nomenclatura</p><ul><li><strong>Container</strong>: aka <em>Parent, Smart</em>. <code>AppComponent</code> y <code>CartComponent</code></li><li><strong>Presenter</strong>: aka <em>Child, Dumb</em>. <code>ItemPickerComponent</code> y <code>BasketListComponent</code></li></ul><blockquote><p>Este reparto de responsabilidades es aconsejable independientemente de la estrategia de deteccin aplicada. Tienes ms informacin el artculo de introduccin <a href=\"../flujo-de-datos-entre-componentes-angular\">flujo de datos entre componentes</a>.</p></blockquote><h1 id=\"2-Change-detection-strategies\"><a href=\"#2-Change-detection-strategies\" class=\"headerlink\" title=\"2 Change detection strategies\"></a>2 Change detection strategies</h1><p>Con la aplicacin bien estructurada en componentes y con la comunicacin estandarizada, habremos reducido el impacto de la deteccin del cambio y estaremos preparados para optimizarlo. Conozcamos en detalle las estrategias de deteccin del cambio.</p><p>El decorador <code>@Component()</code> admite en su configuracin la poco conocida propiedad <code>changeDetection</code>. Dicha propiedad puede asignarse manualmente al componente, o indicarle su uso al generador del cli.</p><h2 id=\"2-1-Deteccion-automatica-default\"><a href=\"#2-1-Deteccion-automatica-default\" class=\"headerlink\" title=\"2.1 Deteccin automtica, default\"></a>2.1 Deteccin automtica, <em>default</em></h2><p>Por defecto, Angular tiene que ser conservador y verificar cada posible cambio, esto se denomina comprobacin sucia o <em>dirty checking</em>. Se dispara <strong>con demasiada frecuencia</strong>, al menos en los siguientes casos:</p><ul><li>Eventos desde el browser</li><li>Timers, intervals etc..</li><li>Llamadas http</li><li>Promesas y cdigo asncrono.</li></ul><p>Por si fuera poco, adems de dispararse mucho es <strong>muy costoso</strong>. Determinar que algo ha cambiado implica comparar dos estados: el actual y el anterior.</p><blockquote><p>La comparacin es valor a valor, en profundidad, para cada propiedad de cada objeto, para cada objeto de cada array.</p></blockquote><p>Con todo, esta estrategia es cmoda para el programador y suficiente para casos bsicos. Pero demasiada magia dificulta el control en aplicaciones complejas. Y en pantallas de mucha informacin e interaccin degrada el rendimiento percibido.</p><h2 id=\"2-2-Deteccion-manual-onPush\"><a href=\"#2-2-Deteccion-manual-onPush\" class=\"headerlink\" title=\"2.2 Deteccin manual, onPush\"></a>2.2 Deteccin manual, <em>onPush</em></h2><p>Como se puede prever, la deteccin del cambio manual es lanzada por el programador. No siempre va a ser laborioso, pero ser ms consciente pues para que ocurra han de darse alguna de estas circunstancias:</p><ul><li><strong>Explcitamente</strong> el programador solicita la deteccin llamando a `ChangeDetectorRef.detectChanges();</li><li><strong>Implcitamente</strong> al usar el <code>pipe Async</code> en la vista se llama a ese mismo mtodo.</li><li><strong>Conscientemente</strong> el desarrollador obliga a un componente a repintarse si le cambia la referencia a un <code>@Input()</code>.</li></ul><blockquote><p>En este modo los componentes dejan de evaluar y comparar sus propiedades rutinariamente. Slo atienden a eventos <code>@Output()</code> o <strong>cambios de referencia</strong> <code>@Input()</code>. Esto relaja mucho al motor de Angular, que ya no tiene que hacer comparaciones odiosas. Sabr que algo ha cambiado porque es otro objeto.</p></blockquote><h1 id=\"3-Inmutabilidad\"><a href=\"#3-Inmutabilidad\" class=\"headerlink\" title=\"3 Inmutabilidad\"></a>3 Inmutabilidad</h1><p>Como ya se ha dicho, para que Angular en la estrategia automtica decida que algo ha cambiado necesita hacer una comparacin por valor. Para evitar ese coste usamos la estrategia manual y el programador tiene que cambiar la referencia de algo cuando quiera que Angular repinte la vista.</p><h2 id=\"3-1-Por-referencia-y-por-valor\"><a href=\"#3-1-Por-referencia-y-por-valor\" class=\"headerlink\" title=\"3.1 Por referencia y por valor\"></a>3.1 Por referencia y por valor</h2><p>Normalmente tendr que crear un nuevo objeto y reasignarlo en lugar del anterior en un <strong>ciclo de clonacin, mutacin y asignacin</strong>. Por costoso que parezca siempre compensa si evita muchas e innecesarias comparaciones por valor en estructuras profundas.</p><p>La estrategia <code>onPush</code> trata a todos los <code>Inputs</code> en inmutables, es decir, algo que no espera que cambie. Similar al paso de parmetros por valor, que si cambia es porque es otro puntero.</p><h2 id=\"3-2-El-clonado\"><a href=\"#3-2-El-clonado\" class=\"headerlink\" title=\"3.2 El clonado\"></a>3.2 El clonado</h2><p>El potencialmente pesado trabajo de clonado lo podemos evitar en muchos casos usando alguna de estas tcnicas:</p><ul><li><strong>Tipos primitivos</strong> que se pasan por valor en las propiedades <code>@Input()</code></li><li><strong>Arrays</strong>: muchos mtodos como <code>.filter() .slice() .sort() .concat()</code> etc., devuelven nuevas referencias sin modificar el array original.</li><li><strong>Observables y el pipe Async</strong>, pues en este caso se subscribe y lanza implcitamente la deteccin del cambio. No hay necesidad de clonar todo lo que llega por <em>http</em>.</li></ul><p>Para los dems casos tenemos operadores <em>TypeScript</em> sencillos y optimizados para obtener nuevas referencias a partir de otros ya existentes.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// js cloning techniques</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> original = &#123; name:<span class=\"string\">'first'</span>, value:<span class=\"number\">1</span> &#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> cloned = &#123; ...original &#125;;</span><br><span class=\"line\"><span class=\"comment\">// &gt; &#123; name:'first', value:1 &#125;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> mutated = &#123; ...original, value:<span class=\"number\">2</span>, newProperty: <span class=\"string\">'added'</span> &#125;;</span><br><span class=\"line\"><span class=\"comment\">// &gt; &#123; name:'first', value:2, newProperty: 'added' &#125;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> list = [ original, cloned, mutated ];</span><br><span class=\"line\"><span class=\"comment\">// &gt; [ &#123; name:'first', value:1 &#125;, &#123; name:'first', value:1 &#125;, &#123; name:'first', value:2, newProperty: 'added' &#125; ]</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> clonedList = [ ...list ];</span><br><span class=\"line\"><span class=\"comment\">// &gt; [ &#123; name:'first', value:1 &#125;, &#123; name:'first', value:1 &#125;, &#123; name:'first', value:2, newProperty: 'added' &#125; ]</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> mutatedList = [ ...list, &#123; name: <span class=\"string\">'new item'</span>&#125; ];</span><br><span class=\"line\"><span class=\"comment\">// &gt; [ &#123; name:'first', value:1 &#125;, &#123; name:'first', value:1 &#125;, &#123; name:'first', value:2, newProperty: 'added' &#125;, &#123; name: 'new item'&#125; ]</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> newList = list.filter(<span class=\"function\"><span class=\"params\">i</span> =&gt;</span> i.name==<span class=\"string\">'first'</span>);</span><br><span class=\"line\"><span class=\"comment\">// &gt; [ &#123; name:'first', value:1 &#125;, &#123; name:'first', value:1 &#125;, &#123; name:'first', value:2, newProperty: 'added' &#125; ]</span></span><br></pre></td></tr></table></figure><p>Ya tienes los conocimientos para acelerar y reducir la incertidumbre sobre el actualizacin de vistas usando el patrn <strong>contenedor / presentador</strong> junto con la estrategia de deteccin de cambios <code>OnPush</code>. Ahora vamos a ver un ejemplo.</p><h2 id=\"3-3-Todo-reactivo\"><a href=\"#3-3-Todo-reactivo\" class=\"headerlink\" title=\"3.3 Todo reactivo.\"></a>3.3 Todo reactivo.</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">Como:</span> <span class=\"string\">desarrollador</span></span><br><span class=\"line\"><span class=\"attr\"> quiero:</span> <span class=\"string\">que</span> <span class=\"string\">las</span> <span class=\"string\">comunicaciones</span> <span class=\"string\">sean</span> <span class=\"string\">fluidas</span> <span class=\"string\">e</span> <span class=\"string\">independientes</span> <span class=\"string\">del</span> <span class=\"string\">tiempo</span></span><br><span class=\"line\"> <span class=\"string\">para</span> <span class=\"attr\">que:</span> <span class=\"string\">los</span> <span class=\"string\">cambios</span> <span class=\"string\">en</span> <span class=\"string\">los</span> <span class=\"string\">datos</span> <span class=\"string\">cambien</span> <span class=\"string\">la</span> <span class=\"string\">presentacin</span> <span class=\"string\">sin</span> <span class=\"string\">esfuerzo</span></span><br></pre></td></tr></table></figure><p>Otro de los pilares de la programacin moderna de grandes aplicaciones es la <strong>reactividad</strong> (nada que ver con Chernbil). Se trata de que los cambios se comuniquen cuando ocurran, sin necesidad de preguntar por ellos. De esta forma <strong>los componentes reaccionarn al cambio</strong> en lugar de buscarlo proactivamente mejorando mucho el rendimiento de las aplicaciones.</p><p>Reducida a lo esencial, la lgica ms bsica que quiero comunicar es un contador de elementos y la propia cesta. Un msero nmero y un array. Pero claro, hacerlo reactivo requiere usar observables, y para eso emplearemos la librera <a href=\"https://www.learnrxjs.io/concepts/rxjs-primer.html\" target=\"_blank\" rel=\"noopener\">RxJs</a>.</p><hr><h2 id=\"Diagramas\"><a href=\"#Diagramas\" class=\"headerlink\" title=\"Diagramas\"></a>Diagramas</h2><p>El siguiente diagrama nos muestra a vista de pjaro los procesos que sique Angular para la deteccin del cambio y sus dos estrategias.</p><p><img src=\"/images/change-detection.jpg\" alt=\"Deteccin del cambio\"></p><hr><h2 id=\"Resumen\"><a href=\"#Resumen\" class=\"headerlink\" title=\"Resumen\"></a>Resumen</h2><h3 id=\"OnPush-es-mas-ligero\"><a href=\"#OnPush-es-mas-ligero\" class=\"headerlink\" title=\"OnPush es ms ligero\"></a>OnPush es ms ligero</h3><ul><li><p>Se lanza menos veces</p></li><li><p>Slo comprueba referencias, no valores</p></li></ul><h3 id=\"Async-CDR-y-clone-detectan-los-cambios\"><a href=\"#Async-CDR-y-clone-detectan-los-cambios\" class=\"headerlink\" title=\"Async, CDR y clone detectan los cambios\"></a>Async, CDR y clone detectan los cambios</h3><ul><li><p><strong><code>Async</code>:</strong> para que las respuestas desde observables sean limpias</p></li><li><p><strong><em>CDR</em>:</strong> cuando el cambio venga de procesos asncronos pero no observables</p></li><li><p><strong><em>Clonado</em>:</strong> para que se detecten cambios simplemente usando las referencias</p></li></ul><p>La deteccin automtica es cmoda pero costosa. Por dos razones: se dispara muchas veces y necesita comprobar si hay cambios comparando valor por valor. La deteccin manual es ms eficiente. Se lanza menos veces y adems le basta un cambio de referencia para saber que hay novedades. Para poder usarla sin grandes trabajos recomiendo usar el <em>pipe</em> <code>async</code>, siempre con orgenes de datos observables. Para ello necesitamos usar y conocer patrones que hagan uso de la librera observable <em>RxJs</em></p><p>Pero vale ya de infraestructura, pasemos a algo visual. En este tutorial de formacin <a href=\"../tag/Avanzado/\">avanzada en Angular</a> veremos ahora cmo crear <a href=\"../componentes-dinamicos-directivas-y-pipes-con-Angular\">componentes dinmicos, directivas y pipes con Angular</a>. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Componentes dinmicos, directivas y pipes con Angular","date":"2019-09-13T12:27:09.000Z","thumbnail":"/css/images/angular-13_template.png","_content":"\n![componentes-dinamicos-directivas-y-pipes-con-Angular](/images/tutorial-angular-13_template.png)\n\nEl sistema de componentes de Angular te permite reutilizar pequeas unidades para montar grandes y complejas interfaces. Eso es bueno porque la capa de presentacin se _come_ la mayor parte del tiempo de desarrollo. Pero podemos ir ms all.\n\n> Podemos crear componentes con estructura fija y contenido dinmico. Podemos dar funcionalidad extra mediante directivas y podemos crear pipes para transformar la presentacin.\n\nY todo esto de una forma sencilla y familiar usando el CLI. No hay excusa para no reutilizar cdigo en la capa de presentacin. _Don't repeat Yourself!_.\n\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Deteccin del cambio en Angular](../deteccion-del-cambio-en-Angular/). Al finalizar tendrs una aplicacin que muestra informacin sobre productos de manera flexible y al gusto del programador.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n\n## Tabla de Contenido:\n\n[1. Plantillas de contenido dinmico.](./#1-Plantillas-de-contenido-dinamico)\n\n[2. Atributos custom con Directivas.](./#2-Atributos-custom-con-Directivas)\n\n[3. Funciones de transformacin con Pipes.](./#3-Funciones-de-transformacion-con-Pipes)\n\n---\n\n# 1 Plantillas de contenido dinmico\n\n```yaml\nAs a: customer,\n  I want: to see a product card with price in euros\n  so that: i can decide to purchase it or not\n\nAs a: seller,\n  I want: to see a product card with stock\n  so that: I can ask for more or not\n```\n\nEn muchas ocasiones tenemos que presentar la misma informacin pero con ligeros cambios. Por ejemplo una vista a veces con unos botones a veces con un texto.\n\nEn otras ocasiones mostramos informacin muy diferente pero con la misma estructura. Por ejemplo pginas de bsqueda; pueden ser de productos, clientes, tareas... pero siempre con la parte de filtro y la del listado.\n\nAlgunas veces se puede resolver con un `*ngIf`. Pero hay ocasiones que donde la tcnica del `ng-content` te puede ser mucho ms til. Como ejemplo voy a crear un componente base para mostrar una ficha de producto. Despus usar esa plantilla para _rellenarla_ segn las especificaciones de cada pantalla.\n\n---\n\n## 1.1 Un componente comn\n\n```bash\nng g c product-template --project=products --module=products.module.ts --export\n```\n\n\n> La visin del comprador y del vendedor es parecida. Mantenemos estructura, inyectamos contenido.\n\n```html\n<article style=\"margin: 5px; padding: 5px; border: 2px; border-style: solid;\">\n  <header>\n    <h2>\n      {{ product.description }}\n    </h2>\n  </header>\n  <main>\n    <ng-content select=\"main\"></ng-content>\n  </main>\n  <footer style=\"margin-top: 5px\">\n    <ng-content select=\".actions\"></ng-content>\n  </footer>\n</article>\n```\n\nLa directiva `ngContent` permite crear *slots* para incrustar contenido a voluntad del consumidor. Cada *slot* se identifica mediante un `select=\"css-selector\"`.\n\nLos selectores pueden referirse a elementos _html_, clases _css_ o identificadores. En la prctica es como dejar unos sitios en los que inyectar contenido. Y para referirse a esos sitios les damos un nombre selector.\n\n---\n\n## 1.2 Implementaciones distintas\n\nA partir de aqu podra haber mltiples componentes que usasen la misma plantilla. Voy a mostrar uno de ejemplo.\n\n```bash\nng g c catalog/product --project=shop\n```\nLa etiqueta `<main>` y el atributo `class=\"actions\"` son usados para seleccionar los slots en los que sern inyectados. Por lo dems el componente `ab-products-product-template` se comporta como cualquier otro pudiendo recibir argumentos...\n\n`apps\\shop\\src\\app\\catalog\\catalog.component.html`\n\n```html\n<ab-products-product-template [product]=\"product\">\n  <main>\n    <div>\n      {{ product.brand }} - {{ product.category }}\n    </div>\n    <div>\n      Price: {{ product.price }}\n    </div>\n  </main>\n  <nav class=\"actions\">\n    <button (clic)=\"buy.next()\"\n            style=\"background-color:coral; padding: 5px\"><strong>Buy me!</strong></button>\n  </nav>\n</ab-products-product-template>\n```\n\nLa idea es que bajo **una misma estructura puedas crear distintas implementaciones** y as mantener una coherencia visual o simplemente no repetir cdigo.\n\n# 2 Atributos custom con Directivas\n\n```yaml\nAs a: seller,\n  I want: to see a green mark on products with stock\n  so that: I know I don't do need to refill\n\nAs a: seller,\n  I want: to see a red mark on products with out stock\n  so that: I know I need to refill\n```\n## 2.1 Generacin de directivas\n\nPrimero la definicin. Si los componentes nos permite crear nuevas etiquetas en _html_, las directivas nos permiten crear atributos. Se usan para dar **funcionalidad extra a los elementos** estndar o no de las aplicaciones.\n\nLa forma de crearlas es mediante el CLI. En este caso con el comando `directive`.\n\n```terminal\nng g directive out-of-stock --project=products --export\n```\n\nEL resultado es una clase con su propio decorador `@Directive` en el que asignamos su selector. Es decir el nombre del atributo que podremos usar. El convenio es utilizar el prefijo y el propio nombre de directiva en _camel case_.\n\n```typescript\n@Directive({\n  selector: '[abProductsOutOfStock]'\n})\nexport class OutOfStockDirective {\n  private minimalStock = 10;\n\n  @Input()\n  set abProductsOutOfStock(stock: number) {\n    const color = stock <= this.minimalStock ? 'MistyRose' : 'Aquamarine';\n    this.el.nativeElement.style.backgroundColor = color;\n  }\n\n  constructor(private el: ElementRef) {}\n}\n```\n\nEn la implementacin ya puedes hacer lo que te parezca. Es muy habitual que las directivas se usen para manipular el elemento nativo al que se aplican. Por eso casi siempre solicitars la inyeccin de un puntero a dicho elemento: el de la dependencia de tipo `ElementRef` que viene en el _core_ de Angular.\n\nA partir de ah ya puedes hacer lo necesario manipulando el _html_ tanto en el constructor como en respuesta a cambios o durante la entrada de atributos.\n\n---\n\n## 2.2 Consumo de directivas\n\nUsarlas es todava ms sencillo. Una vez exportadas e importadas como cualquier otro artificio Angular, ya puedes asignarlas como atributo a las etiquetas de tus plantillas.\n\n`apps\\shop\\src\\app\\catalog\\product\\product.component.html`\n\n```html\n  <div [abProductsOutOfStock]=\"product.stock\">\n    Stock: {{ product.stock }}\n  </div>\n```\n\nAlgunas, como este caso, reciben valores. Otras simplemente actan una vez asignadas. De nuevo la idea es que **todas las manipulaciones de bajo nivel se _escondan_ en las directivas** y que los controladores de nuestros componentes queden limpios y desacoplados de la capa de presentacin.\n\n# 3 Funciones de transformacin con Pipes\n\n```yaml\nAs a: customer,\n  I want: to see a product price also in dollars\n  so that: I can compare prices\nAs a: customer,\n  I want: to see a product price also in pounds\n  so that: I can compare prices\n```\n\nEn este caso lo que queremos es transformar un dato de nuestro modelo antes de presentarlo en pantalla. Para ello seguro que has usado algn `pipe` de Angular desde el primer da que empezaste a programar.\n\n## 3.1 Generacin de pipes\n\nPero ahora vamos a generar nuestros propios _pipes_. Una vez ms usaremos el CLI con su comando especfico para este caso:\n\n```terminal\nng g pipe exRate --project=products --export\n```\n\nAl igual que los componentes y que las directivas, los _pipes_ tienen un nombre como clase y un nombre en su decorador para ser usados desde fuera.\n\n```typescript\n@Pipe({\n  name: 'exRate'\n})\nexport class ExRatePipe implements PipeTransform {\n  private readonly euroDollars = 1.13;\n  private readonly ratesApi = 'https://api.exchangeratesapi.io/latest?symbols=';\n\n  constructor(private httpClient: HttpClient) {}\n\n  public transform(euros: number, symbol: string): number | Observable<number> {\n    if (!symbol) {\n      return euros * this.euroDollars;\n    } else {\n      return this.getOnlineRates$(symbol).pipe(map(rate => euros * rate));\n    }\n  }\n}\n```\nLa clase tienen que implementar la interfaz `PipeTransform` que obliga a tener un mtodo pblico `transform(value: any):any`. En este mtodo definimos nuestra funcin de transformacin.\n\nLa nica salvedad es incidir en que sea lo ms ligera posible pues se ejecuta en cada uso y repintado. Por ejemplo yo aqu necesito un servicio asncrono, y para no penalizar demasiado el rendimiento, le aplico el operador `shareReplay` para que acte como una cach.\n\n```typescript\nprivate getOnlineRates$(symbol: string) {\n  const ratesUrl = this.ratesApi + symbol;\n  return this.httpClient.get<any>(ratesUrl).pipe(\n    shareReplay(1),\n    refCount(),\n    map(resp => resp.rates[symbol])\n  );\n}\n```\n\n## 3.2 Consumo de pipes\n\nLa parte del consumo es la ms simple. Se trata de invocar a la transformacin pasndole los atributos necesarios y volver a transformar o utilizar directamente el resultado.\n\n`apps\\shop\\src\\app\\catalog\\product\\product.component.html`\n\n```html\n  <div>\n    ${{ product.price | exRate | number:'1.0-0'}}\n    {{ product.price | exRate:'GBP' | async | number:'1.0-0'}} \n  </div>\n```\n\nY con esto ya tenemos tres nuevas maneras de reutilizar cdigo y dar nuevas capacidades a la parte de presentacin. Pero en este tutorial de formacin [avanzada en Angular](../tag/Avanzado/) volvemos de nuevo a las profundidades del modelo y la gestin de datos empezando con el [Flujo reactivo unidireccional con Angular y RxJs](../flujo-reactivo-unidireccional-con-Angular-y-RxJs). Todos esos detalles se tratan en el [curso avanzado online](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-13-Componentes-dinamicos-directivas-y-pipes-con-Angular.md","raw":"---\ntitle: Componentes dinmicos, directivas y pipes con Angular\npermalink: componentes-dinamicos-directivas-y-pipes-con-Angular\ndate: 2019-09-13 14:27:09\ntags:\n- Angular\n- Angular8\n- Template\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-13_template.png\n---\n\n![componentes-dinamicos-directivas-y-pipes-con-Angular](/images/tutorial-angular-13_template.png)\n\nEl sistema de componentes de Angular te permite reutilizar pequeas unidades para montar grandes y complejas interfaces. Eso es bueno porque la capa de presentacin se _come_ la mayor parte del tiempo de desarrollo. Pero podemos ir ms all.\n\n> Podemos crear componentes con estructura fija y contenido dinmico. Podemos dar funcionalidad extra mediante directivas y podemos crear pipes para transformar la presentacin.\n\nY todo esto de una forma sencilla y familiar usando el CLI. No hay excusa para no reutilizar cdigo en la capa de presentacin. _Don't repeat Yourself!_.\n\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Deteccin del cambio en Angular](../deteccion-del-cambio-en-Angular/). Al finalizar tendrs una aplicacin que muestra informacin sobre productos de manera flexible y al gusto del programador.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n\n## Tabla de Contenido:\n\n[1. Plantillas de contenido dinmico.](./#1-Plantillas-de-contenido-dinamico)\n\n[2. Atributos custom con Directivas.](./#2-Atributos-custom-con-Directivas)\n\n[3. Funciones de transformacin con Pipes.](./#3-Funciones-de-transformacion-con-Pipes)\n\n---\n\n# 1 Plantillas de contenido dinmico\n\n```yaml\nAs a: customer,\n  I want: to see a product card with price in euros\n  so that: i can decide to purchase it or not\n\nAs a: seller,\n  I want: to see a product card with stock\n  so that: I can ask for more or not\n```\n\nEn muchas ocasiones tenemos que presentar la misma informacin pero con ligeros cambios. Por ejemplo una vista a veces con unos botones a veces con un texto.\n\nEn otras ocasiones mostramos informacin muy diferente pero con la misma estructura. Por ejemplo pginas de bsqueda; pueden ser de productos, clientes, tareas... pero siempre con la parte de filtro y la del listado.\n\nAlgunas veces se puede resolver con un `*ngIf`. Pero hay ocasiones que donde la tcnica del `ng-content` te puede ser mucho ms til. Como ejemplo voy a crear un componente base para mostrar una ficha de producto. Despus usar esa plantilla para _rellenarla_ segn las especificaciones de cada pantalla.\n\n---\n\n## 1.1 Un componente comn\n\n```bash\nng g c product-template --project=products --module=products.module.ts --export\n```\n\n\n> La visin del comprador y del vendedor es parecida. Mantenemos estructura, inyectamos contenido.\n\n```html\n<article style=\"margin: 5px; padding: 5px; border: 2px; border-style: solid;\">\n  <header>\n    <h2>\n      {{ product.description }}\n    </h2>\n  </header>\n  <main>\n    <ng-content select=\"main\"></ng-content>\n  </main>\n  <footer style=\"margin-top: 5px\">\n    <ng-content select=\".actions\"></ng-content>\n  </footer>\n</article>\n```\n\nLa directiva `ngContent` permite crear *slots* para incrustar contenido a voluntad del consumidor. Cada *slot* se identifica mediante un `select=\"css-selector\"`.\n\nLos selectores pueden referirse a elementos _html_, clases _css_ o identificadores. En la prctica es como dejar unos sitios en los que inyectar contenido. Y para referirse a esos sitios les damos un nombre selector.\n\n---\n\n## 1.2 Implementaciones distintas\n\nA partir de aqu podra haber mltiples componentes que usasen la misma plantilla. Voy a mostrar uno de ejemplo.\n\n```bash\nng g c catalog/product --project=shop\n```\nLa etiqueta `<main>` y el atributo `class=\"actions\"` son usados para seleccionar los slots en los que sern inyectados. Por lo dems el componente `ab-products-product-template` se comporta como cualquier otro pudiendo recibir argumentos...\n\n`apps\\shop\\src\\app\\catalog\\catalog.component.html`\n\n```html\n<ab-products-product-template [product]=\"product\">\n  <main>\n    <div>\n      {{ product.brand }} - {{ product.category }}\n    </div>\n    <div>\n      Price: {{ product.price }}\n    </div>\n  </main>\n  <nav class=\"actions\">\n    <button (clic)=\"buy.next()\"\n            style=\"background-color:coral; padding: 5px\"><strong>Buy me!</strong></button>\n  </nav>\n</ab-products-product-template>\n```\n\nLa idea es que bajo **una misma estructura puedas crear distintas implementaciones** y as mantener una coherencia visual o simplemente no repetir cdigo.\n\n# 2 Atributos custom con Directivas\n\n```yaml\nAs a: seller,\n  I want: to see a green mark on products with stock\n  so that: I know I don't do need to refill\n\nAs a: seller,\n  I want: to see a red mark on products with out stock\n  so that: I know I need to refill\n```\n## 2.1 Generacin de directivas\n\nPrimero la definicin. Si los componentes nos permite crear nuevas etiquetas en _html_, las directivas nos permiten crear atributos. Se usan para dar **funcionalidad extra a los elementos** estndar o no de las aplicaciones.\n\nLa forma de crearlas es mediante el CLI. En este caso con el comando `directive`.\n\n```terminal\nng g directive out-of-stock --project=products --export\n```\n\nEL resultado es una clase con su propio decorador `@Directive` en el que asignamos su selector. Es decir el nombre del atributo que podremos usar. El convenio es utilizar el prefijo y el propio nombre de directiva en _camel case_.\n\n```typescript\n@Directive({\n  selector: '[abProductsOutOfStock]'\n})\nexport class OutOfStockDirective {\n  private minimalStock = 10;\n\n  @Input()\n  set abProductsOutOfStock(stock: number) {\n    const color = stock <= this.minimalStock ? 'MistyRose' : 'Aquamarine';\n    this.el.nativeElement.style.backgroundColor = color;\n  }\n\n  constructor(private el: ElementRef) {}\n}\n```\n\nEn la implementacin ya puedes hacer lo que te parezca. Es muy habitual que las directivas se usen para manipular el elemento nativo al que se aplican. Por eso casi siempre solicitars la inyeccin de un puntero a dicho elemento: el de la dependencia de tipo `ElementRef` que viene en el _core_ de Angular.\n\nA partir de ah ya puedes hacer lo necesario manipulando el _html_ tanto en el constructor como en respuesta a cambios o durante la entrada de atributos.\n\n---\n\n## 2.2 Consumo de directivas\n\nUsarlas es todava ms sencillo. Una vez exportadas e importadas como cualquier otro artificio Angular, ya puedes asignarlas como atributo a las etiquetas de tus plantillas.\n\n`apps\\shop\\src\\app\\catalog\\product\\product.component.html`\n\n```html\n  <div [abProductsOutOfStock]=\"product.stock\">\n    Stock: {{ product.stock }}\n  </div>\n```\n\nAlgunas, como este caso, reciben valores. Otras simplemente actan una vez asignadas. De nuevo la idea es que **todas las manipulaciones de bajo nivel se _escondan_ en las directivas** y que los controladores de nuestros componentes queden limpios y desacoplados de la capa de presentacin.\n\n# 3 Funciones de transformacin con Pipes\n\n```yaml\nAs a: customer,\n  I want: to see a product price also in dollars\n  so that: I can compare prices\nAs a: customer,\n  I want: to see a product price also in pounds\n  so that: I can compare prices\n```\n\nEn este caso lo que queremos es transformar un dato de nuestro modelo antes de presentarlo en pantalla. Para ello seguro que has usado algn `pipe` de Angular desde el primer da que empezaste a programar.\n\n## 3.1 Generacin de pipes\n\nPero ahora vamos a generar nuestros propios _pipes_. Una vez ms usaremos el CLI con su comando especfico para este caso:\n\n```terminal\nng g pipe exRate --project=products --export\n```\n\nAl igual que los componentes y que las directivas, los _pipes_ tienen un nombre como clase y un nombre en su decorador para ser usados desde fuera.\n\n```typescript\n@Pipe({\n  name: 'exRate'\n})\nexport class ExRatePipe implements PipeTransform {\n  private readonly euroDollars = 1.13;\n  private readonly ratesApi = 'https://api.exchangeratesapi.io/latest?symbols=';\n\n  constructor(private httpClient: HttpClient) {}\n\n  public transform(euros: number, symbol: string): number | Observable<number> {\n    if (!symbol) {\n      return euros * this.euroDollars;\n    } else {\n      return this.getOnlineRates$(symbol).pipe(map(rate => euros * rate));\n    }\n  }\n}\n```\nLa clase tienen que implementar la interfaz `PipeTransform` que obliga a tener un mtodo pblico `transform(value: any):any`. En este mtodo definimos nuestra funcin de transformacin.\n\nLa nica salvedad es incidir en que sea lo ms ligera posible pues se ejecuta en cada uso y repintado. Por ejemplo yo aqu necesito un servicio asncrono, y para no penalizar demasiado el rendimiento, le aplico el operador `shareReplay` para que acte como una cach.\n\n```typescript\nprivate getOnlineRates$(symbol: string) {\n  const ratesUrl = this.ratesApi + symbol;\n  return this.httpClient.get<any>(ratesUrl).pipe(\n    shareReplay(1),\n    refCount(),\n    map(resp => resp.rates[symbol])\n  );\n}\n```\n\n## 3.2 Consumo de pipes\n\nLa parte del consumo es la ms simple. Se trata de invocar a la transformacin pasndole los atributos necesarios y volver a transformar o utilizar directamente el resultado.\n\n`apps\\shop\\src\\app\\catalog\\product\\product.component.html`\n\n```html\n  <div>\n    ${{ product.price | exRate | number:'1.0-0'}}\n    {{ product.price | exRate:'GBP' | async | number:'1.0-0'}} \n  </div>\n```\n\nY con esto ya tenemos tres nuevas maneras de reutilizar cdigo y dar nuevas capacidades a la parte de presentacin. Pero en este tutorial de formacin [avanzada en Angular](../tag/Avanzado/) volvemos de nuevo a las profundidades del modelo y la gestin de datos empezando con el [Flujo reactivo unidireccional con Angular y RxJs](../flujo-reactivo-unidireccional-con-Angular-y-RxJs). Todos esos detalles se tratan en el [curso avanzado online](https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"componentes-dinamicos-directivas-y-pipes-con-Angular","published":1,"updated":"2019-10-16T14:23:01.021Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab1e000mbss3x0jskz3t","content":"<p><img src=\"/images/tutorial-angular-13_template.png\" alt=\"componentes-dinamicos-directivas-y-pipes-con-Angular\"></p><p>El sistema de componentes de Angular te permite reutilizar pequeas unidades para montar grandes y complejas interfaces. Eso es bueno porque la capa de presentacin se <em>come</em> la mayor parte del tiempo de desarrollo. Pero podemos ir ms all.</p><blockquote><p>Podemos crear componentes con estructura fija y contenido dinmico. Podemos dar funcionalidad extra mediante directivas y podemos crear pipes para transformar la presentacin.</p></blockquote><p>Y todo esto de una forma sencilla y familiar usando el CLI. No hay excusa para no reutilizar cdigo en la capa de presentacin. <em>Dont repeat Yourself!</em>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../deteccion-del-cambio-en-Angular/\">Deteccin del cambio en Angular</a>. Al finalizar tendrs una aplicacin que muestra informacin sobre productos de manera flexible y al gusto del programador.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id=\"Tabla-de-Contenido\"><a href=\"#Tabla-de-Contenido\" class=\"headerlink\" title=\"Tabla de Contenido:\"></a>Tabla de Contenido:</h2><p><a href=\"./#1-Plantillas-de-contenido-dinamico\">1. Plantillas de contenido dinmico.</a></p><p><a href=\"./#2-Atributos-custom-con-Directivas\">2. Atributos custom con Directivas.</a></p><p><a href=\"./#3-Funciones-de-transformacion-con-Pipes\">3. Funciones de transformacin con Pipes.</a></p><hr><h1 id=\"1-Plantillas-de-contenido-dinamico\"><a href=\"#1-Plantillas-de-contenido-dinamico\" class=\"headerlink\" title=\"1 Plantillas de contenido dinmico\"></a>1 Plantillas de contenido dinmico</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">product</span> <span class=\"string\">card</span> <span class=\"string\">with</span> <span class=\"string\">price</span> <span class=\"string\">in</span> <span class=\"string\">euros</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">i</span> <span class=\"string\">can</span> <span class=\"string\">decide</span> <span class=\"string\">to</span> <span class=\"string\">purchase</span> <span class=\"string\">it</span> <span class=\"string\">or</span> <span class=\"string\">not</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">product</span> <span class=\"string\">card</span> <span class=\"string\">with</span> <span class=\"string\">stock</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">ask</span> <span class=\"string\">for</span> <span class=\"string\">more</span> <span class=\"string\">or</span> <span class=\"string\">not</span></span><br></pre></td></tr></table></figure><p>En muchas ocasiones tenemos que presentar la misma informacin pero con ligeros cambios. Por ejemplo una vista a veces con unos botones a veces con un texto.</p><p>En otras ocasiones mostramos informacin muy diferente pero con la misma estructura. Por ejemplo pginas de bsqueda; pueden ser de productos, clientes, tareas pero siempre con la parte de filtro y la del listado.</p><p>Algunas veces se puede resolver con un <code>*ngIf</code>. Pero hay ocasiones que donde la tcnica del <code>ng-content</code> te puede ser mucho ms til. Como ejemplo voy a crear un componente base para mostrar una ficha de producto. Despus usar esa plantilla para <em>rellenarla</em> segn las especificaciones de cada pantalla.</p><hr><h2 id=\"1-1-Un-componente-comun\"><a href=\"#1-1-Un-componente-comun\" class=\"headerlink\" title=\"1.1 Un componente comn\"></a>1.1 Un componente comn</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c product-template --project=products --module=products.module.ts --<span class=\"built_in\">export</span></span><br></pre></td></tr></table></figure><blockquote><p>La visin del comprador y del vendedor es parecida. Mantenemos estructura, inyectamos contenido.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">article</span> <span class=\"attr\">style</span>=<span class=\"string\">\"margin: 5px; padding: 5px; border: 2px; border-style: solid;\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">      &#123;&#123; product.description &#125;&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ng-content</span> <span class=\"attr\">select</span>=<span class=\"string\">\"main\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ng-content</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">footer</span> <span class=\"attr\">style</span>=<span class=\"string\">\"margin-top: 5px\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ng-content</span> <span class=\"attr\">select</span>=<span class=\"string\">\".actions\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ng-content</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">footer</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">article</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La directiva <code>ngContent</code> permite crear <em>slots</em> para incrustar contenido a voluntad del consumidor. Cada <em>slot</em> se identifica mediante un <code>select=&quot;css-selector&quot;</code>.</p><p>Los selectores pueden referirse a elementos <em>html</em>, clases <em>css</em> o identificadores. En la prctica es como dejar unos sitios en los que inyectar contenido. Y para referirse a esos sitios les damos un nombre selector.</p><hr><h2 id=\"1-2-Implementaciones-distintas\"><a href=\"#1-2-Implementaciones-distintas\" class=\"headerlink\" title=\"1.2 Implementaciones distintas\"></a>1.2 Implementaciones distintas</h2><p>A partir de aqu podra haber mltiples componentes que usasen la misma plantilla. Voy a mostrar uno de ejemplo.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c catalog/product --project=shop</span><br></pre></td></tr></table></figure><p>La etiqueta <code>&lt;main&gt;</code> y el atributo <code>class=&quot;actions&quot;</code> son usados para seleccionar los slots en los que sern inyectados. Por lo dems el componente <code>ab-products-product-template</code> se comporta como cualquier otro pudiendo recibir argumentos</p><p><code>apps\\shop\\src\\app\\catalog\\catalog.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-products-product-template</span> [<span class=\"attr\">product</span>]=<span class=\"string\">\"product\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      &#123;&#123; product.brand &#125;&#125; - &#123;&#123; product.category &#125;&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      Price: &#123;&#123; product.price &#125;&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">nav</span> <span class=\"attr\">class</span>=<span class=\"string\">\"actions\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">clic</span>)=<span class=\"string\">\"buy.next()\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">style</span>=<span class=\"string\">\"background-color:coral; padding: 5px\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span>Buy me!<span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ab-products-product-template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La idea es que bajo <strong>una misma estructura puedas crear distintas implementaciones</strong> y as mantener una coherencia visual o simplemente no repetir cdigo.</p><h1 id=\"2-Atributos-custom-con-Directivas\"><a href=\"#2-Atributos-custom-con-Directivas\" class=\"headerlink\" title=\"2 Atributos custom con Directivas\"></a>2 Atributos custom con Directivas</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">green</span> <span class=\"string\">mark</span> <span class=\"string\">on</span> <span class=\"string\">products</span> <span class=\"string\">with</span> <span class=\"string\">stock</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">know</span> <span class=\"string\">I</span> <span class=\"string\">don't</span> <span class=\"string\">do</span> <span class=\"string\">need</span> <span class=\"string\">to</span> <span class=\"string\">refill</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">red</span> <span class=\"string\">mark</span> <span class=\"string\">on</span> <span class=\"string\">products</span> <span class=\"string\">with</span> <span class=\"string\">out</span> <span class=\"string\">stock</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">know</span> <span class=\"string\">I</span> <span class=\"string\">need</span> <span class=\"string\">to</span> <span class=\"string\">refill</span></span><br></pre></td></tr></table></figure><h2 id=\"2-1-Generacion-de-directivas\"><a href=\"#2-1-Generacion-de-directivas\" class=\"headerlink\" title=\"2.1 Generacin de directivas\"></a>2.1 Generacin de directivas</h2><p>Primero la definicin. Si los componentes nos permite crear nuevas etiquetas en <em>html</em>, las directivas nos permiten crear atributos. Se usan para dar <strong>funcionalidad extra a los elementos</strong> estndar o no de las aplicaciones.</p><p>La forma de crearlas es mediante el CLI. En este caso con el comando <code>directive</code>.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g directive out-of-stock --project=products --export</span><br></pre></td></tr></table></figure><p>EL resultado es una clase con su propio decorador <code>@Directive</code> en el que asignamos su selector. Es decir el nombre del atributo que podremos usar. El convenio es utilizar el prefijo y el propio nombre de directiva en <em>camel case</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Directive</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'[abProductsOutOfStock]'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> OutOfStockDirective &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> minimalStock = <span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Input</span>()</span><br><span class=\"line\">  <span class=\"keyword\">set</span> abProductsOutOfStock(stock: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> color = stock &lt;= <span class=\"keyword\">this</span>.minimalStock ? <span class=\"string\">'MistyRose'</span> : <span class=\"string\">'Aquamarine'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.el.nativeElement.style.backgroundColor = color;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> el: ElementRef</span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>En la implementacin ya puedes hacer lo que te parezca. Es muy habitual que las directivas se usen para manipular el elemento nativo al que se aplican. Por eso casi siempre solicitars la inyeccin de un puntero a dicho elemento: el de la dependencia de tipo <code>ElementRef</code> que viene en el <em>core</em> de Angular.</p><p>A partir de ah ya puedes hacer lo necesario manipulando el <em>html</em> tanto en el constructor como en respuesta a cambios o durante la entrada de atributos.</p><hr><h2 id=\"2-2-Consumo-de-directivas\"><a href=\"#2-2-Consumo-de-directivas\" class=\"headerlink\" title=\"2.2 Consumo de directivas\"></a>2.2 Consumo de directivas</h2><p>Usarlas es todava ms sencillo. Una vez exportadas e importadas como cualquier otro artificio Angular, ya puedes asignarlas como atributo a las etiquetas de tus plantillas.</p><p><code>apps\\shop\\src\\app\\catalog\\product\\product.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">abProductsOutOfStock</span>]=<span class=\"string\">\"product.stock\"</span>&gt;</span></span><br><span class=\"line\">  Stock: &#123;&#123; product.stock &#125;&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Algunas, como este caso, reciben valores. Otras simplemente actan una vez asignadas. De nuevo la idea es que <strong>todas las manipulaciones de bajo nivel se <em>escondan</em> en las directivas</strong> y que los controladores de nuestros componentes queden limpios y desacoplados de la capa de presentacin.</p><h1 id=\"3-Funciones-de-transformacion-con-Pipes\"><a href=\"#3-Funciones-de-transformacion-con-Pipes\" class=\"headerlink\" title=\"3 Funciones de transformacin con Pipes\"></a>3 Funciones de transformacin con Pipes</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">product</span> <span class=\"string\">price</span> <span class=\"string\">also</span> <span class=\"string\">in</span> <span class=\"string\">dollars</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">compare</span> <span class=\"string\">prices</span></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">product</span> <span class=\"string\">price</span> <span class=\"string\">also</span> <span class=\"string\">in</span> <span class=\"string\">pounds</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">compare</span> <span class=\"string\">prices</span></span><br></pre></td></tr></table></figure><p>En este caso lo que queremos es transformar un dato de nuestro modelo antes de presentarlo en pantalla. Para ello seguro que has usado algn <code>pipe</code> de Angular desde el primer da que empezaste a programar.</p><h2 id=\"3-1-Generacion-de-pipes\"><a href=\"#3-1-Generacion-de-pipes\" class=\"headerlink\" title=\"3.1 Generacin de pipes\"></a>3.1 Generacin de pipes</h2><p>Pero ahora vamos a generar nuestros propios <em>pipes</em>. Una vez ms usaremos el CLI con su comando especfico para este caso:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g pipe exRate --project=products --export</span><br></pre></td></tr></table></figure><p>Al igual que los componentes y que las directivas, los <em>pipes</em> tienen un nombre como clase y un nombre en su decorador para ser usados desde fuera.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Pipe</span>(&#123;</span><br><span class=\"line\">  name: <span class=\"string\">'exRate'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ExRatePipe <span class=\"keyword\">implements</span> PipeTransform &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> readonly euroDollars = <span class=\"number\">1.13</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> readonly ratesApi = <span class=\"string\">'https://api.exchangeratesapi.io/latest?symbols='</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> transform(euros: <span class=\"built_in\">number</span>, symbol: <span class=\"built_in\">string</span>): <span class=\"built_in\">number</span> | Observable&lt;<span class=\"built_in\">number</span>&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!symbol) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> euros * <span class=\"keyword\">this</span>.euroDollars;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.getOnlineRates$(symbol).pipe(map(<span class=\"function\"><span class=\"params\">rate</span> =&gt;</span> euros * rate));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>La clase tienen que implementar la interfaz <code>PipeTransform</code> que obliga a tener un mtodo pblico <code>transform(value: any):any</code>. En este mtodo definimos nuestra funcin de transformacin.</p><p>La nica salvedad es incidir en que sea lo ms ligera posible pues se ejecuta en cada uso y repintado. Por ejemplo yo aqu necesito un servicio asncrono, y para no penalizar demasiado el rendimiento, le aplico el operador <code>shareReplay</code> para que acte como una cach.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> getOnlineRates$(symbol: <span class=\"built_in\">string</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> ratesUrl = <span class=\"keyword\">this</span>.ratesApi + symbol;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.httpClient.get&lt;<span class=\"built_in\">any</span>&gt;(ratesUrl).pipe(</span><br><span class=\"line\">    shareReplay(<span class=\"number\">1</span>),</span><br><span class=\"line\">    refCount(),</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">resp</span> =&gt;</span> resp.rates[symbol])</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Consumo-de-pipes\"><a href=\"#3-2-Consumo-de-pipes\" class=\"headerlink\" title=\"3.2 Consumo de pipes\"></a>3.2 Consumo de pipes</h2><p>La parte del consumo es la ms simple. Se trata de invocar a la transformacin pasndole los atributos necesarios y volver a transformar o utilizar directamente el resultado.</p><p><code>apps\\shop\\src\\app\\catalog\\product\\product.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  $&#123;&#123; product.price | exRate | number:'1.0-0'&#125;&#125;</span><br><span class=\"line\">  &#123;&#123; product.price | exRate:'GBP' | async | number:'1.0-0'&#125;&#125; </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y con esto ya tenemos tres nuevas maneras de reutilizar cdigo y dar nuevas capacidades a la parte de presentacin. Pero en este tutorial de formacin <a href=\"../tag/Avanzado/\">avanzada en Angular</a> volvemos de nuevo a las profundidades del modelo y la gestin de datos empezando con el <a href=\"../flujo-reactivo-unidireccional-con-Angular-y-RxJs\">Flujo reactivo unidireccional con Angular y RxJs</a>. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-13_template.png\" alt=\"componentes-dinamicos-directivas-y-pipes-con-Angular\"></p><p>El sistema de componentes de Angular te permite reutilizar pequeas unidades para montar grandes y complejas interfaces. Eso es bueno porque la capa de presentacin se <em>come</em> la mayor parte del tiempo de desarrollo. Pero podemos ir ms all.</p><blockquote><p>Podemos crear componentes con estructura fija y contenido dinmico. Podemos dar funcionalidad extra mediante directivas y podemos crear pipes para transformar la presentacin.</p></blockquote><p>Y todo esto de una forma sencilla y familiar usando el CLI. No hay excusa para no reutilizar cdigo en la capa de presentacin. <em>Dont repeat Yourself!</em>.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../deteccion-del-cambio-en-Angular/\">Deteccin del cambio en Angular</a>. Al finalizar tendrs una aplicacin que muestra informacin sobre productos de manera flexible y al gusto del programador.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id=\"Tabla-de-Contenido\"><a href=\"#Tabla-de-Contenido\" class=\"headerlink\" title=\"Tabla de Contenido:\"></a>Tabla de Contenido:</h2><p><a href=\"./#1-Plantillas-de-contenido-dinamico\">1. Plantillas de contenido dinmico.</a></p><p><a href=\"./#2-Atributos-custom-con-Directivas\">2. Atributos custom con Directivas.</a></p><p><a href=\"./#3-Funciones-de-transformacion-con-Pipes\">3. Funciones de transformacin con Pipes.</a></p><hr><h1 id=\"1-Plantillas-de-contenido-dinamico\"><a href=\"#1-Plantillas-de-contenido-dinamico\" class=\"headerlink\" title=\"1 Plantillas de contenido dinmico\"></a>1 Plantillas de contenido dinmico</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">product</span> <span class=\"string\">card</span> <span class=\"string\">with</span> <span class=\"string\">price</span> <span class=\"string\">in</span> <span class=\"string\">euros</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">i</span> <span class=\"string\">can</span> <span class=\"string\">decide</span> <span class=\"string\">to</span> <span class=\"string\">purchase</span> <span class=\"string\">it</span> <span class=\"string\">or</span> <span class=\"string\">not</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">product</span> <span class=\"string\">card</span> <span class=\"string\">with</span> <span class=\"string\">stock</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">ask</span> <span class=\"string\">for</span> <span class=\"string\">more</span> <span class=\"string\">or</span> <span class=\"string\">not</span></span><br></pre></td></tr></table></figure><p>En muchas ocasiones tenemos que presentar la misma informacin pero con ligeros cambios. Por ejemplo una vista a veces con unos botones a veces con un texto.</p><p>En otras ocasiones mostramos informacin muy diferente pero con la misma estructura. Por ejemplo pginas de bsqueda; pueden ser de productos, clientes, tareas pero siempre con la parte de filtro y la del listado.</p><p>Algunas veces se puede resolver con un <code>*ngIf</code>. Pero hay ocasiones que donde la tcnica del <code>ng-content</code> te puede ser mucho ms til. Como ejemplo voy a crear un componente base para mostrar una ficha de producto. Despus usar esa plantilla para <em>rellenarla</em> segn las especificaciones de cada pantalla.</p><hr><h2 id=\"1-1-Un-componente-comun\"><a href=\"#1-1-Un-componente-comun\" class=\"headerlink\" title=\"1.1 Un componente comn\"></a>1.1 Un componente comn</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c product-template --project=products --module=products.module.ts --<span class=\"built_in\">export</span></span><br></pre></td></tr></table></figure><blockquote><p>La visin del comprador y del vendedor es parecida. Mantenemos estructura, inyectamos contenido.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">article</span> <span class=\"attr\">style</span>=<span class=\"string\">\"margin: 5px; padding: 5px; border: 2px; border-style: solid;\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">      &#123;&#123; product.description &#125;&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ng-content</span> <span class=\"attr\">select</span>=<span class=\"string\">\"main\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ng-content</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">footer</span> <span class=\"attr\">style</span>=<span class=\"string\">\"margin-top: 5px\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ng-content</span> <span class=\"attr\">select</span>=<span class=\"string\">\".actions\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ng-content</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">footer</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">article</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La directiva <code>ngContent</code> permite crear <em>slots</em> para incrustar contenido a voluntad del consumidor. Cada <em>slot</em> se identifica mediante un <code>select=&quot;css-selector&quot;</code>.</p><p>Los selectores pueden referirse a elementos <em>html</em>, clases <em>css</em> o identificadores. En la prctica es como dejar unos sitios en los que inyectar contenido. Y para referirse a esos sitios les damos un nombre selector.</p><hr><h2 id=\"1-2-Implementaciones-distintas\"><a href=\"#1-2-Implementaciones-distintas\" class=\"headerlink\" title=\"1.2 Implementaciones distintas\"></a>1.2 Implementaciones distintas</h2><p>A partir de aqu podra haber mltiples componentes que usasen la misma plantilla. Voy a mostrar uno de ejemplo.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c catalog/product --project=shop</span><br></pre></td></tr></table></figure><p>La etiqueta <code>&lt;main&gt;</code> y el atributo <code>class=&quot;actions&quot;</code> son usados para seleccionar los slots en los que sern inyectados. Por lo dems el componente <code>ab-products-product-template</code> se comporta como cualquier otro pudiendo recibir argumentos</p><p><code>apps\\shop\\src\\app\\catalog\\catalog.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-products-product-template</span> [<span class=\"attr\">product</span>]=<span class=\"string\">\"product\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      &#123;&#123; product.brand &#125;&#125; - &#123;&#123; product.category &#125;&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      Price: &#123;&#123; product.price &#125;&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">nav</span> <span class=\"attr\">class</span>=<span class=\"string\">\"actions\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">clic</span>)=<span class=\"string\">\"buy.next()\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">style</span>=<span class=\"string\">\"background-color:coral; padding: 5px\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span>Buy me!<span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ab-products-product-template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La idea es que bajo <strong>una misma estructura puedas crear distintas implementaciones</strong> y as mantener una coherencia visual o simplemente no repetir cdigo.</p><h1 id=\"2-Atributos-custom-con-Directivas\"><a href=\"#2-Atributos-custom-con-Directivas\" class=\"headerlink\" title=\"2 Atributos custom con Directivas\"></a>2 Atributos custom con Directivas</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">green</span> <span class=\"string\">mark</span> <span class=\"string\">on</span> <span class=\"string\">products</span> <span class=\"string\">with</span> <span class=\"string\">stock</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">know</span> <span class=\"string\">I</span> <span class=\"string\">don't</span> <span class=\"string\">do</span> <span class=\"string\">need</span> <span class=\"string\">to</span> <span class=\"string\">refill</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">red</span> <span class=\"string\">mark</span> <span class=\"string\">on</span> <span class=\"string\">products</span> <span class=\"string\">with</span> <span class=\"string\">out</span> <span class=\"string\">stock</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">know</span> <span class=\"string\">I</span> <span class=\"string\">need</span> <span class=\"string\">to</span> <span class=\"string\">refill</span></span><br></pre></td></tr></table></figure><h2 id=\"2-1-Generacion-de-directivas\"><a href=\"#2-1-Generacion-de-directivas\" class=\"headerlink\" title=\"2.1 Generacin de directivas\"></a>2.1 Generacin de directivas</h2><p>Primero la definicin. Si los componentes nos permite crear nuevas etiquetas en <em>html</em>, las directivas nos permiten crear atributos. Se usan para dar <strong>funcionalidad extra a los elementos</strong> estndar o no de las aplicaciones.</p><p>La forma de crearlas es mediante el CLI. En este caso con el comando <code>directive</code>.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g directive out-of-stock --project=products --export</span><br></pre></td></tr></table></figure><p>EL resultado es una clase con su propio decorador <code>@Directive</code> en el que asignamos su selector. Es decir el nombre del atributo que podremos usar. El convenio es utilizar el prefijo y el propio nombre de directiva en <em>camel case</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Directive</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'[abProductsOutOfStock]'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> OutOfStockDirective &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> minimalStock = <span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"meta\">@Input</span>()</span><br><span class=\"line\">  <span class=\"keyword\">set</span> abProductsOutOfStock(stock: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> color = stock &lt;= <span class=\"keyword\">this</span>.minimalStock ? <span class=\"string\">'MistyRose'</span> : <span class=\"string\">'Aquamarine'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.el.nativeElement.style.backgroundColor = color;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> el: ElementRef</span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>En la implementacin ya puedes hacer lo que te parezca. Es muy habitual que las directivas se usen para manipular el elemento nativo al que se aplican. Por eso casi siempre solicitars la inyeccin de un puntero a dicho elemento: el de la dependencia de tipo <code>ElementRef</code> que viene en el <em>core</em> de Angular.</p><p>A partir de ah ya puedes hacer lo necesario manipulando el <em>html</em> tanto en el constructor como en respuesta a cambios o durante la entrada de atributos.</p><hr><h2 id=\"2-2-Consumo-de-directivas\"><a href=\"#2-2-Consumo-de-directivas\" class=\"headerlink\" title=\"2.2 Consumo de directivas\"></a>2.2 Consumo de directivas</h2><p>Usarlas es todava ms sencillo. Una vez exportadas e importadas como cualquier otro artificio Angular, ya puedes asignarlas como atributo a las etiquetas de tus plantillas.</p><p><code>apps\\shop\\src\\app\\catalog\\product\\product.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">abProductsOutOfStock</span>]=<span class=\"string\">\"product.stock\"</span>&gt;</span></span><br><span class=\"line\">  Stock: &#123;&#123; product.stock &#125;&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Algunas, como este caso, reciben valores. Otras simplemente actan una vez asignadas. De nuevo la idea es que <strong>todas las manipulaciones de bajo nivel se <em>escondan</em> en las directivas</strong> y que los controladores de nuestros componentes queden limpios y desacoplados de la capa de presentacin.</p><h1 id=\"3-Funciones-de-transformacion-con-Pipes\"><a href=\"#3-Funciones-de-transformacion-con-Pipes\" class=\"headerlink\" title=\"3 Funciones de transformacin con Pipes\"></a>3 Funciones de transformacin con Pipes</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">product</span> <span class=\"string\">price</span> <span class=\"string\">also</span> <span class=\"string\">in</span> <span class=\"string\">dollars</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">compare</span> <span class=\"string\">prices</span></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">a</span> <span class=\"string\">product</span> <span class=\"string\">price</span> <span class=\"string\">also</span> <span class=\"string\">in</span> <span class=\"string\">pounds</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">compare</span> <span class=\"string\">prices</span></span><br></pre></td></tr></table></figure><p>En este caso lo que queremos es transformar un dato de nuestro modelo antes de presentarlo en pantalla. Para ello seguro que has usado algn <code>pipe</code> de Angular desde el primer da que empezaste a programar.</p><h2 id=\"3-1-Generacion-de-pipes\"><a href=\"#3-1-Generacion-de-pipes\" class=\"headerlink\" title=\"3.1 Generacin de pipes\"></a>3.1 Generacin de pipes</h2><p>Pero ahora vamos a generar nuestros propios <em>pipes</em>. Una vez ms usaremos el CLI con su comando especfico para este caso:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g pipe exRate --project=products --export</span><br></pre></td></tr></table></figure><p>Al igual que los componentes y que las directivas, los <em>pipes</em> tienen un nombre como clase y un nombre en su decorador para ser usados desde fuera.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Pipe</span>(&#123;</span><br><span class=\"line\">  name: <span class=\"string\">'exRate'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ExRatePipe <span class=\"keyword\">implements</span> PipeTransform &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> readonly euroDollars = <span class=\"number\">1.13</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> readonly ratesApi = <span class=\"string\">'https://api.exchangeratesapi.io/latest?symbols='</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> transform(euros: <span class=\"built_in\">number</span>, symbol: <span class=\"built_in\">string</span>): <span class=\"built_in\">number</span> | Observable&lt;<span class=\"built_in\">number</span>&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!symbol) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> euros * <span class=\"keyword\">this</span>.euroDollars;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.getOnlineRates$(symbol).pipe(map(<span class=\"function\"><span class=\"params\">rate</span> =&gt;</span> euros * rate));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>La clase tienen que implementar la interfaz <code>PipeTransform</code> que obliga a tener un mtodo pblico <code>transform(value: any):any</code>. En este mtodo definimos nuestra funcin de transformacin.</p><p>La nica salvedad es incidir en que sea lo ms ligera posible pues se ejecuta en cada uso y repintado. Por ejemplo yo aqu necesito un servicio asncrono, y para no penalizar demasiado el rendimiento, le aplico el operador <code>shareReplay</code> para que acte como una cach.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> getOnlineRates$(symbol: <span class=\"built_in\">string</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> ratesUrl = <span class=\"keyword\">this</span>.ratesApi + symbol;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.httpClient.get&lt;<span class=\"built_in\">any</span>&gt;(ratesUrl).pipe(</span><br><span class=\"line\">    shareReplay(<span class=\"number\">1</span>),</span><br><span class=\"line\">    refCount(),</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">resp</span> =&gt;</span> resp.rates[symbol])</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Consumo-de-pipes\"><a href=\"#3-2-Consumo-de-pipes\" class=\"headerlink\" title=\"3.2 Consumo de pipes\"></a>3.2 Consumo de pipes</h2><p>La parte del consumo es la ms simple. Se trata de invocar a la transformacin pasndole los atributos necesarios y volver a transformar o utilizar directamente el resultado.</p><p><code>apps\\shop\\src\\app\\catalog\\product\\product.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  $&#123;&#123; product.price | exRate | number:'1.0-0'&#125;&#125;</span><br><span class=\"line\">  &#123;&#123; product.price | exRate:'GBP' | async | number:'1.0-0'&#125;&#125; </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y con esto ya tenemos tres nuevas maneras de reutilizar cdigo y dar nuevas capacidades a la parte de presentacin. Pero en este tutorial de formacin <a href=\"../tag/Avanzado/\">avanzada en Angular</a> volvemos de nuevo a las profundidades del modelo y la gestin de datos empezando con el <a href=\"../flujo-reactivo-unidireccional-con-Angular-y-RxJs\">Flujo reactivo unidireccional con Angular y RxJs</a>. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Redux, flujo reactivo unidireccional con Angular y RxJs","date":"2019-09-17T10:47:58.000Z","thumbnail":"/css/images/angular-14_redux.png","_content":"\n![flujo-reactivo-unidireccional-con-Angular-y-RxJs](/images/tutorial-angular-14_redux.png)\n\nContinuando con el **tutorial de Angular Avanzado** nos centramos ahora en una arquitectura de comunicacin de datos conocida como _Unidirectional Data Flow_ o flujo de datos en un mismo sentido; la base del **patrn Redux**. Esta tcnica es una mejora sobre el modelo bsico de Angular, el _double-binding_, el cual facilitaba mucho el desarrollo en pequeos proyectos.\n\n> Cuando hablamos de mejora debemos ser honestos con los costes y beneficios: aqu vamos a mejorar la eficiencia en ejecucin y a facilitar la depuracin a costa de una mayor complejidad estructural y sintctica. Merece la pena cuanto ms grande sea el proyecto. Este es un ejemplo simplificado pero realista que implementa _Redux_. Tmate tu tiempo para estudiarlo con calma.\n\nTomar las decisiones correctas en cuestiones de este calibre puede suponer la diferencia entre el xito o fracaso de un proyecto. Voy a explicarte las razones para usar este patrn y la manera ms sencilla de introducirlo en tus aplicaciones, dejndote en el umbral de soluciones an ms potentes como la gestin de estado centralizada con _Redux_.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Componentes dinmicos, directivas y pipes con Angular](../componentes-dinamicos-directivas-y-pipes-con-Angular). Al finalizar dotaremos a la aplicacin de un almacn de datos _Redux_ que notifica cambios reactivos.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n## Tabla de Contenido:\n\n[1. Arquitectura del patrn Redux.](./#1-Arquitectura-del-patron-Redux)\n\n[2. Implementacin de un Store con RxJs.](./#2-Implementacion-de-un-Store-con-RxJs)\n\n[Resumen](./#Resumen)\n\n---\n\n# 1. Arquitectura del patrn Redux\n\n```yaml\nComo: desarrollador,\n   Quiero: saber qu acciones se pueden hacer\n   para que: pueda controlar la funcionalidad\n\nComo: desarrollador,\n   Quiero: saber qu cambios se han realizado\n   para que: pueda depurar y predecir el comportamiento\n```\n\nHablar de _Unidirectional Data Flow_ sin presentar **_Redux_** es poco menos que imposible. Vamos a ver en qu consiste este patrn tan usado, no slo en Angular. Lo que aprendas te servir tambin para _react_, _vue_ y otros.\n\n**Redux se ocupa de la gestin del estado**, es decir, del valor de las variables en un determinado momento. Centraliza sus cambios para saber qu ocurri para llegar a este valor, y qu valor tendr segn lo que ocurra. Desacopla los emisores de acciones de los receptores de informacin, para ello combina otros dos patrones:\n\n- **Action:** Envo de comandos al almacn para actualizar el estado\n\n- **Observable:** Subscripcin a cambios en el estado del almacn.\n\nComo incorpora cierta complejidad de serie conviene que nos hagamos esta pregunta Cundo usarlo?. Una pequea lista de ideas sobre cundo implementar Redux.\n\n- Aplicaciones complejas con **mltiples componentes**.\n    - El patrn contenedor / presentadores se hace complejo y tedioso a partir de tres niveles de profundidad del rbol.\n    - Los `router-outlets` inician una jerarqua propia. Comunicar componentes entre rboles no es factible con `@Input` y `@Output`\n- Uso de estrategias de **deteccin del cambio OnPush**.\n    - Consumo de datos mediante _pipes async_ suscritos a observables.\n- **Cambios concurrentes** por el usuario y los servicios.\n    - Peticiones mediante _pull_ a intervalos regulares\n    - Recepcin de _sockets_\n    - Llamadas en paralelo\n- Gestin de datos local con _cachs_\n\n> Redux no hace rpido lo simple, sino mantenible lo complejo.\n\n\n## 1.1 Principios de Redux\n\nTenemos tres principios bsicos que cumplir:\n\n- **Single Source Of Truth**: Cada pieza de informacin se almacena en un nico lugar, independientemente de dnde sea creada, modificada o requerida.\n- **Read Only State**: La informacin ser de slo lectura y slo podr modificarse a travs de conductos oficiales.\n- **Changes By Pure Functions**: Los cambios tienen que poder ser replicados, cancelados y auditados; lo mejor, usar una funcin pura.\n\n## 1.2 Elementos de Redux\n\nLos artificios fundamentales que incorporaremos a nuestro desarrollo van en dos niveles. El primer nivel resuelve los dos primeros principios.\n\n- **Store**: El sistema que mantiene el estado. Despacha acciones de mutado sobre el mismo y comunica cambios enviando copias de slo lectura a los subscriptores.\n- **State**: Objeto que contiene la nica copia vlida de la informacin. Representa el valor del almacn en un momento determinado. Nunca expondremos un puntero a este dato privado.\n\n### Acceso al estado\n\n- **Setters** : Mtodos que asignan y notifican un nuevo cambio. Clonan la informacin recibida para que el llamante no tenga un puntero al estado.\n\n- **Selectors** : Mtodos para consulta del estado. Devuelven un observable al que suscribirse para obtener notificaciones de cambio o una instantnea. En cualquier caso siempre emitir o devolver un clon del estado.\n\n### Mutaciones del estado\n\n- **Actions**: Objetos identificados por un tipo y cargados con un *payload*. Transmiten una intencin de mutacin sobre el estado del *store*.\n\n- **Reducers** : Son funciones puras, que ostentan la exclusividad de poder mutar el estado. Reciben dos argumentos: el estado actual y una accin con su tipo y su carga. Clonan el estado, realizan los cambios oportunos y devuelven el estado mutado.\n\n![Redux](/images/Redux.png)\n\nPodemos verlo en un diagrama antes de pasar a verlo en cdigo.\n\n\n# 2. Implementacin de un Store con RxJs\n\n```yaml\nAs a: seller,\n  I want: to know how many products are out of stock\n  so that: I can refill them\n```\n\nPara que veas que **Redux es independiente de Angular**, vamos a montarlo en una librera sin dependencias del _framework_. **Slo TypeScript y RxJs**. A da de hoy ambas tecnologas son transversales al ecosistema _frontend_.\n\n```\nng g @nrwl/workspace:library rx-store\n```\n\n## 2.1 El Store observable mnimo\n\nEmpezaremos por la implementacin ms inocente de un almacn reactivo. Una clase con [tipos genricos](https://www.typescriptlang.org/docs/handbook/generics.html) que hace uso de la librera de observables RxJs. De esta, toma el `BehaviorSubject` que permite notificar cambios y valores iniciales.\n\nAunque para evitar que otra clase consumidora tambin emita sin control, slo exponemos su interfaz `asObservable()`. Relacionado con esto tambin es obligatorio evitar a toda costa punteros al estado. Para ell siempre trabajamos con clones. Los mtodos `get() set()` usan el [spread operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax) de JS `{ ...this.state }` tanto al recibir como al devolver el valor del estado.\n\n`libs\\rx-store\\src\\lib\\mini-store.ts`\n\n```typescript\nimport { BehaviorSubject, Observable } from 'rxjs';\n\nexport class MiniStore<T> {\n  private state: T;\n  private subject$ = new BehaviorSubject(this.get());\n\n  constructor(initialState: T) {\n    this.set(initialState);\n  }\n  public set(newSate: T) {\n    this.state = { ...newSate };\n    this.subject$.next(this.get());\n  }\n  public select$(): Observable<T> {\n    return this.subject$.asObservable();\n  }\n  private get(): T {\n    return { ...this.state };\n  }\n}\n```\nPuedes ver su uso en los test unitarios que le acompaan en `libs\\rx-store\\src\\lib\\rx-store.spec.ts`.\n\n```typescript\nimport { MiniStore } from './mini-store';\ndescribe('GIVEN: a basic mini-store of  product stocks', () => {\n  interface ProductStock { stock: number; }\n  const initial: ProductStock = { stock: 25 };\n  describe('WHEN: I start one ', () => {\n    const stockMiniStore = new MiniStore<ProductStock>(initial);\n    it('THEN: it should have the inital value', done => {\n      stockMiniStore.select$().subscribe(res => {\n        expect(res).toEqual(initial);\n        done();\n      });\n    });\n  });\n  describe('WHEN: I start and set a new value ', () => {\n    const stockMiniStore = new MiniStore<ProductStock>(initial);\n    stockMiniStore.set({ stock: 40 });\n    it('THEN: it should emit the same value', done => {\n      stockMiniStore.select$().subscribe(res => {\n        expect(res).toEqual({ stock: 40 });\n        done();\n      });\n    });\n  });\n});\n```\n\n## 2.2 El envo de acciones\n\nEn una situacin ms realista y aproximada al patrn Redux **no deberamos asignar el valor de manera directa**, pues hay que dejar rastro de cmo se lleg ah. Necesitamos entonces los conceptos de acciones y funcin reductora. La idea es que el almacn reciba acciones, invoque al reductor y asigne el valor obtenido. Vamos a verlo.\n\nEmpezamos por crear otra clase similar `libs\\rx-store\\src\\lib\\rx-store.ts` y un par de ayudas. Como mnimo el _interface_ que debe cumplir toda `Action`; es muy sencillo y siempre igual: una cadena para especificar el comando y cualquier cosa como argumento de carga. Aprovechando las potencia del TypeScript tambin creamos un _type_ para asegurar que la `reducerFunction` tiene la firma adecuada. La obligamos a recibir como argumentos el estado actual y la accin que se le aplica; teniendo que devolver el nuevo estado.\n\n```typescript\nimport { BehaviorSubject, Observable } from 'rxjs';\n\nexport interface Action {\n  type: string;\n  payload: any;\n}\n\nexport type reducerFunction<T> = (state: T, action: Action) => T;\n\nexport class RxStore<T> {\n  private state: T;\n  private subject$ = new BehaviorSubject<T>(this.get());\n\n  constructor(initialState: T, private reducer: reducerFunction<T>) {\n    this.set(initialState);\n  }\n  public select$(): Observable<T> {\n    return this.subject$.asObservable();\n  }\n  public dispatch(action: Action) {\n    const curretState = this.get();\n    const newState = this.reducer(curretState, action);\n    // instrumentation, cache, log...\n    this.set(newState);\n  }\n  private get(): T {\n    return { ...this.state };\n  }\n  private set(newSate: T) {\n    this.state = { ...newSate };\n    this.subject$.next(this.get());\n  }\n}\n```\n\nComo puedes ver, los `get()` y `set()` son ahora privados. El mundo exterior nos enva acciones al mtodo `public dispatch(action: Action)`.  Ese sera un buen momento para incluir lgica de infraestructura e instrumentacin. Hay quien  crea un _log_ de lo ocurrido, un histrico de valores... las libreras profesionales nos dan todo eso y mas. Una vez recibida la accin empieza la fiesta de los _clones_ invocando en medio a una funcin reductora que ahora veremos.\n\n---\n\n## 2.3 La funcin reductora de estado\n\nEn el fichero de _test_ `libs\\rx-store\\src\\lib\\rx-store.spec.ts` tenemos un ejemplo clarificador :\n\n```typescript\nconst stockReducer: reducerFunction<ProductStock> = function(\n    state: ProductStock,\n    action: Action\n  ): ProductStock {\n    const clonedState = { ...state };\n    switch (action.type) {\n      case 'set':\n        clonedState.stock = action.payload;\n        break;\n      case 'increment':\n        clonedState.stock += action.payload;\n        break;\n      default:\n        break;\n    }\n    return clonedState;\n  };\n```\nDefinimos `stockReducer` como una [**funcin pura**](https://www.freecodecamp.org/news/what-is-a-pure-function-in-javascript-acb887375dfe/) que cumple con el tipo `reducerFunction`. Normalmente estas funciones tienen un _switch_ que evala el tipo de la accin. En cada caso se asigna un nuevo estado segn la mnima lgica oportuna y al finalizar se devuelve el estado mutado.\n\nVeamos el resto del _test_ para tener una idea de cmo se utiliza.\n\n```typescript\ndescribe('WHEN: I get an increment ', () => {\n  const stockRxStore = new RxStore<ProductStock>(initial, stockReducer);\n  const incrementAction: Action = { type: 'increment', payload: 5 };\n  stockRxStore.dispatch(incrementAction);\n  it('THEN: it should raise the stock', done => {\n    stockRxStore.select$().subscribe(res => {\n      expect(res).toEqual({ stock: 30 });\n      done();\n    });\n  });\n});\n```\n\nDe esta forma ya tenemos un sistema sencillo pero del que podramos decir que cumple con los principios bsicos de Redux.\n\n## Resumen\n\nLas aplicaciones reales no son sencillas. Este es un tutorial avanzado que te exige conocimiento previo y dedicacin. A cambio espero que te resulte til y que podis incorporar las tcnicas de deteccin del cambio y control de estado observable en vuestros proyectos.\n\nCon este tutorial continas tu formacin [avanzada en Angular](../tag/Avanzado/); para poder afrontar retos de tamao industrial usando te recomiendo que uses [El patrn Redux con NgRx en Angular](../el-patron-redux-con-ngrx-en-angular). Todos esos detalles se tratan en el [curso avanzado online](../https://academia-binaria.com/cursos/angular-business) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-14-Flujo reactivo unidireccional con Angular y RxJs.md","raw":"---\ntitle: Redux, flujo reactivo unidireccional con Angular y RxJs\npermalink: flujo-reactivo-unidireccional-con-Angular-y-RxJs\ndate: 2019-09-17 12:47:58\ntags:\n- Angular\n- Angular8\n- Redux\n- RxJs\n- Observables\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-14_redux.png\n---\n\n![flujo-reactivo-unidireccional-con-Angular-y-RxJs](/images/tutorial-angular-14_redux.png)\n\nContinuando con el **tutorial de Angular Avanzado** nos centramos ahora en una arquitectura de comunicacin de datos conocida como _Unidirectional Data Flow_ o flujo de datos en un mismo sentido; la base del **patrn Redux**. Esta tcnica es una mejora sobre el modelo bsico de Angular, el _double-binding_, el cual facilitaba mucho el desarrollo en pequeos proyectos.\n\n> Cuando hablamos de mejora debemos ser honestos con los costes y beneficios: aqu vamos a mejorar la eficiencia en ejecucin y a facilitar la depuracin a costa de una mayor complejidad estructural y sintctica. Merece la pena cuanto ms grande sea el proyecto. Este es un ejemplo simplificado pero realista que implementa _Redux_. Tmate tu tiempo para estudiarlo con calma.\n\nTomar las decisiones correctas en cuestiones de este calibre puede suponer la diferencia entre el xito o fracaso de un proyecto. Voy a explicarte las razones para usar este patrn y la manera ms sencilla de introducirlo en tus aplicaciones, dejndote en el umbral de soluciones an ms potentes como la gestin de estado centralizada con _Redux_.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Componentes dinmicos, directivas y pipes con Angular](../componentes-dinamicos-directivas-y-pipes-con-Angular). Al finalizar dotaremos a la aplicacin de un almacn de datos _Redux_ que notifica cambios reactivos.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n## Tabla de Contenido:\n\n[1. Arquitectura del patrn Redux.](./#1-Arquitectura-del-patron-Redux)\n\n[2. Implementacin de un Store con RxJs.](./#2-Implementacion-de-un-Store-con-RxJs)\n\n[Resumen](./#Resumen)\n\n---\n\n# 1. Arquitectura del patrn Redux\n\n```yaml\nComo: desarrollador,\n   Quiero: saber qu acciones se pueden hacer\n   para que: pueda controlar la funcionalidad\n\nComo: desarrollador,\n   Quiero: saber qu cambios se han realizado\n   para que: pueda depurar y predecir el comportamiento\n```\n\nHablar de _Unidirectional Data Flow_ sin presentar **_Redux_** es poco menos que imposible. Vamos a ver en qu consiste este patrn tan usado, no slo en Angular. Lo que aprendas te servir tambin para _react_, _vue_ y otros.\n\n**Redux se ocupa de la gestin del estado**, es decir, del valor de las variables en un determinado momento. Centraliza sus cambios para saber qu ocurri para llegar a este valor, y qu valor tendr segn lo que ocurra. Desacopla los emisores de acciones de los receptores de informacin, para ello combina otros dos patrones:\n\n- **Action:** Envo de comandos al almacn para actualizar el estado\n\n- **Observable:** Subscripcin a cambios en el estado del almacn.\n\nComo incorpora cierta complejidad de serie conviene que nos hagamos esta pregunta Cundo usarlo?. Una pequea lista de ideas sobre cundo implementar Redux.\n\n- Aplicaciones complejas con **mltiples componentes**.\n    - El patrn contenedor / presentadores se hace complejo y tedioso a partir de tres niveles de profundidad del rbol.\n    - Los `router-outlets` inician una jerarqua propia. Comunicar componentes entre rboles no es factible con `@Input` y `@Output`\n- Uso de estrategias de **deteccin del cambio OnPush**.\n    - Consumo de datos mediante _pipes async_ suscritos a observables.\n- **Cambios concurrentes** por el usuario y los servicios.\n    - Peticiones mediante _pull_ a intervalos regulares\n    - Recepcin de _sockets_\n    - Llamadas en paralelo\n- Gestin de datos local con _cachs_\n\n> Redux no hace rpido lo simple, sino mantenible lo complejo.\n\n\n## 1.1 Principios de Redux\n\nTenemos tres principios bsicos que cumplir:\n\n- **Single Source Of Truth**: Cada pieza de informacin se almacena en un nico lugar, independientemente de dnde sea creada, modificada o requerida.\n- **Read Only State**: La informacin ser de slo lectura y slo podr modificarse a travs de conductos oficiales.\n- **Changes By Pure Functions**: Los cambios tienen que poder ser replicados, cancelados y auditados; lo mejor, usar una funcin pura.\n\n## 1.2 Elementos de Redux\n\nLos artificios fundamentales que incorporaremos a nuestro desarrollo van en dos niveles. El primer nivel resuelve los dos primeros principios.\n\n- **Store**: El sistema que mantiene el estado. Despacha acciones de mutado sobre el mismo y comunica cambios enviando copias de slo lectura a los subscriptores.\n- **State**: Objeto que contiene la nica copia vlida de la informacin. Representa el valor del almacn en un momento determinado. Nunca expondremos un puntero a este dato privado.\n\n### Acceso al estado\n\n- **Setters** : Mtodos que asignan y notifican un nuevo cambio. Clonan la informacin recibida para que el llamante no tenga un puntero al estado.\n\n- **Selectors** : Mtodos para consulta del estado. Devuelven un observable al que suscribirse para obtener notificaciones de cambio o una instantnea. En cualquier caso siempre emitir o devolver un clon del estado.\n\n### Mutaciones del estado\n\n- **Actions**: Objetos identificados por un tipo y cargados con un *payload*. Transmiten una intencin de mutacin sobre el estado del *store*.\n\n- **Reducers** : Son funciones puras, que ostentan la exclusividad de poder mutar el estado. Reciben dos argumentos: el estado actual y una accin con su tipo y su carga. Clonan el estado, realizan los cambios oportunos y devuelven el estado mutado.\n\n![Redux](/images/Redux.png)\n\nPodemos verlo en un diagrama antes de pasar a verlo en cdigo.\n\n\n# 2. Implementacin de un Store con RxJs\n\n```yaml\nAs a: seller,\n  I want: to know how many products are out of stock\n  so that: I can refill them\n```\n\nPara que veas que **Redux es independiente de Angular**, vamos a montarlo en una librera sin dependencias del _framework_. **Slo TypeScript y RxJs**. A da de hoy ambas tecnologas son transversales al ecosistema _frontend_.\n\n```\nng g @nrwl/workspace:library rx-store\n```\n\n## 2.1 El Store observable mnimo\n\nEmpezaremos por la implementacin ms inocente de un almacn reactivo. Una clase con [tipos genricos](https://www.typescriptlang.org/docs/handbook/generics.html) que hace uso de la librera de observables RxJs. De esta, toma el `BehaviorSubject` que permite notificar cambios y valores iniciales.\n\nAunque para evitar que otra clase consumidora tambin emita sin control, slo exponemos su interfaz `asObservable()`. Relacionado con esto tambin es obligatorio evitar a toda costa punteros al estado. Para ell siempre trabajamos con clones. Los mtodos `get() set()` usan el [spread operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax) de JS `{ ...this.state }` tanto al recibir como al devolver el valor del estado.\n\n`libs\\rx-store\\src\\lib\\mini-store.ts`\n\n```typescript\nimport { BehaviorSubject, Observable } from 'rxjs';\n\nexport class MiniStore<T> {\n  private state: T;\n  private subject$ = new BehaviorSubject(this.get());\n\n  constructor(initialState: T) {\n    this.set(initialState);\n  }\n  public set(newSate: T) {\n    this.state = { ...newSate };\n    this.subject$.next(this.get());\n  }\n  public select$(): Observable<T> {\n    return this.subject$.asObservable();\n  }\n  private get(): T {\n    return { ...this.state };\n  }\n}\n```\nPuedes ver su uso en los test unitarios que le acompaan en `libs\\rx-store\\src\\lib\\rx-store.spec.ts`.\n\n```typescript\nimport { MiniStore } from './mini-store';\ndescribe('GIVEN: a basic mini-store of  product stocks', () => {\n  interface ProductStock { stock: number; }\n  const initial: ProductStock = { stock: 25 };\n  describe('WHEN: I start one ', () => {\n    const stockMiniStore = new MiniStore<ProductStock>(initial);\n    it('THEN: it should have the inital value', done => {\n      stockMiniStore.select$().subscribe(res => {\n        expect(res).toEqual(initial);\n        done();\n      });\n    });\n  });\n  describe('WHEN: I start and set a new value ', () => {\n    const stockMiniStore = new MiniStore<ProductStock>(initial);\n    stockMiniStore.set({ stock: 40 });\n    it('THEN: it should emit the same value', done => {\n      stockMiniStore.select$().subscribe(res => {\n        expect(res).toEqual({ stock: 40 });\n        done();\n      });\n    });\n  });\n});\n```\n\n## 2.2 El envo de acciones\n\nEn una situacin ms realista y aproximada al patrn Redux **no deberamos asignar el valor de manera directa**, pues hay que dejar rastro de cmo se lleg ah. Necesitamos entonces los conceptos de acciones y funcin reductora. La idea es que el almacn reciba acciones, invoque al reductor y asigne el valor obtenido. Vamos a verlo.\n\nEmpezamos por crear otra clase similar `libs\\rx-store\\src\\lib\\rx-store.ts` y un par de ayudas. Como mnimo el _interface_ que debe cumplir toda `Action`; es muy sencillo y siempre igual: una cadena para especificar el comando y cualquier cosa como argumento de carga. Aprovechando las potencia del TypeScript tambin creamos un _type_ para asegurar que la `reducerFunction` tiene la firma adecuada. La obligamos a recibir como argumentos el estado actual y la accin que se le aplica; teniendo que devolver el nuevo estado.\n\n```typescript\nimport { BehaviorSubject, Observable } from 'rxjs';\n\nexport interface Action {\n  type: string;\n  payload: any;\n}\n\nexport type reducerFunction<T> = (state: T, action: Action) => T;\n\nexport class RxStore<T> {\n  private state: T;\n  private subject$ = new BehaviorSubject<T>(this.get());\n\n  constructor(initialState: T, private reducer: reducerFunction<T>) {\n    this.set(initialState);\n  }\n  public select$(): Observable<T> {\n    return this.subject$.asObservable();\n  }\n  public dispatch(action: Action) {\n    const curretState = this.get();\n    const newState = this.reducer(curretState, action);\n    // instrumentation, cache, log...\n    this.set(newState);\n  }\n  private get(): T {\n    return { ...this.state };\n  }\n  private set(newSate: T) {\n    this.state = { ...newSate };\n    this.subject$.next(this.get());\n  }\n}\n```\n\nComo puedes ver, los `get()` y `set()` son ahora privados. El mundo exterior nos enva acciones al mtodo `public dispatch(action: Action)`.  Ese sera un buen momento para incluir lgica de infraestructura e instrumentacin. Hay quien  crea un _log_ de lo ocurrido, un histrico de valores... las libreras profesionales nos dan todo eso y mas. Una vez recibida la accin empieza la fiesta de los _clones_ invocando en medio a una funcin reductora que ahora veremos.\n\n---\n\n## 2.3 La funcin reductora de estado\n\nEn el fichero de _test_ `libs\\rx-store\\src\\lib\\rx-store.spec.ts` tenemos un ejemplo clarificador :\n\n```typescript\nconst stockReducer: reducerFunction<ProductStock> = function(\n    state: ProductStock,\n    action: Action\n  ): ProductStock {\n    const clonedState = { ...state };\n    switch (action.type) {\n      case 'set':\n        clonedState.stock = action.payload;\n        break;\n      case 'increment':\n        clonedState.stock += action.payload;\n        break;\n      default:\n        break;\n    }\n    return clonedState;\n  };\n```\nDefinimos `stockReducer` como una [**funcin pura**](https://www.freecodecamp.org/news/what-is-a-pure-function-in-javascript-acb887375dfe/) que cumple con el tipo `reducerFunction`. Normalmente estas funciones tienen un _switch_ que evala el tipo de la accin. En cada caso se asigna un nuevo estado segn la mnima lgica oportuna y al finalizar se devuelve el estado mutado.\n\nVeamos el resto del _test_ para tener una idea de cmo se utiliza.\n\n```typescript\ndescribe('WHEN: I get an increment ', () => {\n  const stockRxStore = new RxStore<ProductStock>(initial, stockReducer);\n  const incrementAction: Action = { type: 'increment', payload: 5 };\n  stockRxStore.dispatch(incrementAction);\n  it('THEN: it should raise the stock', done => {\n    stockRxStore.select$().subscribe(res => {\n      expect(res).toEqual({ stock: 30 });\n      done();\n    });\n  });\n});\n```\n\nDe esta forma ya tenemos un sistema sencillo pero del que podramos decir que cumple con los principios bsicos de Redux.\n\n## Resumen\n\nLas aplicaciones reales no son sencillas. Este es un tutorial avanzado que te exige conocimiento previo y dedicacin. A cambio espero que te resulte til y que podis incorporar las tcnicas de deteccin del cambio y control de estado observable en vuestros proyectos.\n\nCon este tutorial continas tu formacin [avanzada en Angular](../tag/Avanzado/); para poder afrontar retos de tamao industrial usando te recomiendo que uses [El patrn Redux con NgRx en Angular](../el-patron-redux-con-ngrx-en-angular). Todos esos detalles se tratan en el [curso avanzado online](../https://academia-binaria.com/cursos/angular-business) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"flujo-reactivo-unidireccional-con-Angular-y-RxJs","published":1,"updated":"2019-10-16T14:23:01.023Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab1f000nbss3qfd58y4p","content":"<p><img src=\"/images/tutorial-angular-14_redux.png\" alt=\"flujo-reactivo-unidireccional-con-Angular-y-RxJs\"></p><p>Continuando con el <strong>tutorial de Angular Avanzado</strong> nos centramos ahora en una arquitectura de comunicacin de datos conocida como <em>Unidirectional Data Flow</em> o flujo de datos en un mismo sentido; la base del <strong>patrn Redux</strong>. Esta tcnica es una mejora sobre el modelo bsico de Angular, el <em>double-binding</em>, el cual facilitaba mucho el desarrollo en pequeos proyectos.</p><blockquote><p>Cuando hablamos de mejora debemos ser honestos con los costes y beneficios: aqu vamos a mejorar la eficiencia en ejecucin y a facilitar la depuracin a costa de una mayor complejidad estructural y sintctica. Merece la pena cuanto ms grande sea el proyecto. Este es un ejemplo simplificado pero realista que implementa <em>Redux</em>. Tmate tu tiempo para estudiarlo con calma.</p></blockquote><p>Tomar las decisiones correctas en cuestiones de este calibre puede suponer la diferencia entre el xito o fracaso de un proyecto. Voy a explicarte las razones para usar este patrn y la manera ms sencilla de introducirlo en tus aplicaciones, dejndote en el umbral de soluciones an ms potentes como la gestin de estado centralizada con <em>Redux</em>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../componentes-dinamicos-directivas-y-pipes-con-Angular\">Componentes dinmicos, directivas y pipes con Angular</a>. Al finalizar dotaremos a la aplicacin de un almacn de datos <em>Redux</em> que notifica cambios reactivos.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id=\"Tabla-de-Contenido\"><a href=\"#Tabla-de-Contenido\" class=\"headerlink\" title=\"Tabla de Contenido:\"></a>Tabla de Contenido:</h2><p><a href=\"./#1-Arquitectura-del-patron-Redux\">1. Arquitectura del patrn Redux.</a></p><p><a href=\"./#2-Implementacion-de-un-Store-con-RxJs\">2. Implementacin de un Store con RxJs.</a></p><p><a href=\"./#Resumen\">Resumen</a></p><hr><h1 id=\"1-Arquitectura-del-patron-Redux\"><a href=\"#1-Arquitectura-del-patron-Redux\" class=\"headerlink\" title=\"1. Arquitectura del patrn Redux\"></a>1. Arquitectura del patrn Redux</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">Como:</span> <span class=\"string\">desarrollador,</span></span><br><span class=\"line\"><span class=\"attr\">   Quiero:</span> <span class=\"string\">saber</span> <span class=\"string\">qu</span> <span class=\"string\">acciones</span> <span class=\"string\">se</span> <span class=\"string\">pueden</span> <span class=\"string\">hacer</span></span><br><span class=\"line\">   <span class=\"string\">para</span> <span class=\"attr\">que:</span> <span class=\"string\">pueda</span> <span class=\"string\">controlar</span> <span class=\"string\">la</span> <span class=\"string\">funcionalidad</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Como:</span> <span class=\"string\">desarrollador,</span></span><br><span class=\"line\"><span class=\"attr\">   Quiero:</span> <span class=\"string\">saber</span> <span class=\"string\">qu</span> <span class=\"string\">cambios</span> <span class=\"string\">se</span> <span class=\"string\">han</span> <span class=\"string\">realizado</span></span><br><span class=\"line\">   <span class=\"string\">para</span> <span class=\"attr\">que:</span> <span class=\"string\">pueda</span> <span class=\"string\">depurar</span> <span class=\"string\">y</span> <span class=\"string\">predecir</span> <span class=\"string\">el</span> <span class=\"string\">comportamiento</span></span><br></pre></td></tr></table></figure><p>Hablar de <em>Unidirectional Data Flow</em> sin presentar <strong><em>Redux</em></strong> es poco menos que imposible. Vamos a ver en qu consiste este patrn tan usado, no slo en Angular. Lo que aprendas te servir tambin para <em>react</em>, <em>vue</em> y otros.</p><p><strong>Redux se ocupa de la gestin del estado</strong>, es decir, del valor de las variables en un determinado momento. Centraliza sus cambios para saber qu ocurri para llegar a este valor, y qu valor tendr segn lo que ocurra. Desacopla los emisores de acciones de los receptores de informacin, para ello combina otros dos patrones:</p><ul><li><p><strong>Action:</strong> Envo de comandos al almacn para actualizar el estado</p></li><li><p><strong>Observable:</strong> Subscripcin a cambios en el estado del almacn.</p></li></ul><p>Como incorpora cierta complejidad de serie conviene que nos hagamos esta pregunta Cundo usarlo?. Una pequea lista de ideas sobre cundo implementar Redux.</p><ul><li>Aplicaciones complejas con <strong>mltiples componentes</strong>.<ul><li>El patrn contenedor / presentadores se hace complejo y tedioso a partir de tres niveles de profundidad del rbol.</li><li>Los <code>router-outlets</code> inician una jerarqua propia. Comunicar componentes entre rboles no es factible con <code>@Input</code> y <code>@Output</code></li></ul></li><li>Uso de estrategias de <strong>deteccin del cambio OnPush</strong>.<ul><li>Consumo de datos mediante <em>pipes async</em> suscritos a observables.</li></ul></li><li><strong>Cambios concurrentes</strong> por el usuario y los servicios.<ul><li>Peticiones mediante <em>pull</em> a intervalos regulares</li><li>Recepcin de <em>sockets</em></li><li>Llamadas en paralelo</li></ul></li><li>Gestin de datos local con <em>cachs</em></li></ul><blockquote><p>Redux no hace rpido lo simple, sino mantenible lo complejo.</p></blockquote><h2 id=\"1-1-Principios-de-Redux\"><a href=\"#1-1-Principios-de-Redux\" class=\"headerlink\" title=\"1.1 Principios de Redux\"></a>1.1 Principios de Redux</h2><p>Tenemos tres principios bsicos que cumplir:</p><ul><li><strong>Single Source Of Truth</strong>: Cada pieza de informacin se almacena en un nico lugar, independientemente de dnde sea creada, modificada o requerida.</li><li><strong>Read Only State</strong>: La informacin ser de slo lectura y slo podr modificarse a travs de conductos oficiales.</li><li><strong>Changes By Pure Functions</strong>: Los cambios tienen que poder ser replicados, cancelados y auditados; lo mejor, usar una funcin pura.</li></ul><h2 id=\"1-2-Elementos-de-Redux\"><a href=\"#1-2-Elementos-de-Redux\" class=\"headerlink\" title=\"1.2 Elementos de Redux\"></a>1.2 Elementos de Redux</h2><p>Los artificios fundamentales que incorporaremos a nuestro desarrollo van en dos niveles. El primer nivel resuelve los dos primeros principios.</p><ul><li><strong>Store</strong>: El sistema que mantiene el estado. Despacha acciones de mutado sobre el mismo y comunica cambios enviando copias de slo lectura a los subscriptores.</li><li><strong>State</strong>: Objeto que contiene la nica copia vlida de la informacin. Representa el valor del almacn en un momento determinado. Nunca expondremos un puntero a este dato privado.</li></ul><h3 id=\"Acceso-al-estado\"><a href=\"#Acceso-al-estado\" class=\"headerlink\" title=\"Acceso al estado\"></a>Acceso al estado</h3><ul><li><p><strong>Setters</strong> : Mtodos que asignan y notifican un nuevo cambio. Clonan la informacin recibida para que el llamante no tenga un puntero al estado.</p></li><li><p><strong>Selectors</strong> : Mtodos para consulta del estado. Devuelven un observable al que suscribirse para obtener notificaciones de cambio o una instantnea. En cualquier caso siempre emitir o devolver un clon del estado.</p></li></ul><h3 id=\"Mutaciones-del-estado\"><a href=\"#Mutaciones-del-estado\" class=\"headerlink\" title=\"Mutaciones del estado\"></a>Mutaciones del estado</h3><ul><li><p><strong>Actions</strong>: Objetos identificados por un tipo y cargados con un <em>payload</em>. Transmiten una intencin de mutacin sobre el estado del <em>store</em>.</p></li><li><p><strong>Reducers</strong> : Son funciones puras, que ostentan la exclusividad de poder mutar el estado. Reciben dos argumentos: el estado actual y una accin con su tipo y su carga. Clonan el estado, realizan los cambios oportunos y devuelven el estado mutado.</p></li></ul><p><img src=\"/images/Redux.png\" alt=\"Redux\"></p><p>Podemos verlo en un diagrama antes de pasar a verlo en cdigo.</p><h1 id=\"2-Implementacion-de-un-Store-con-RxJs\"><a href=\"#2-Implementacion-de-un-Store-con-RxJs\" class=\"headerlink\" title=\"2. Implementacin de un Store con RxJs\"></a>2. Implementacin de un Store con RxJs</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">know</span> <span class=\"string\">how</span> <span class=\"string\">many</span> <span class=\"string\">products</span> <span class=\"string\">are</span> <span class=\"string\">out</span> <span class=\"string\">of</span> <span class=\"string\">stock</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">refill</span> <span class=\"string\">them</span></span><br></pre></td></tr></table></figure><p>Para que veas que <strong>Redux es independiente de Angular</strong>, vamos a montarlo en una librera sin dependencias del <em>framework</em>. <strong>Slo TypeScript y RxJs</strong>. A da de hoy ambas tecnologas son transversales al ecosistema <em>frontend</em>.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @nrwl/workspace:library rx-store</span><br></pre></td></tr></table></figure><h2 id=\"2-1-El-Store-observable-minimo\"><a href=\"#2-1-El-Store-observable-minimo\" class=\"headerlink\" title=\"2.1 El Store observable mnimo\"></a>2.1 El Store observable mnimo</h2><p>Empezaremos por la implementacin ms inocente de un almacn reactivo. Una clase con <a href=\"https://www.typescriptlang.org/docs/handbook/generics.html\" target=\"_blank\" rel=\"noopener\">tipos genricos</a> que hace uso de la librera de observables RxJs. De esta, toma el <code>BehaviorSubject</code> que permite notificar cambios y valores iniciales.</p><p>Aunque para evitar que otra clase consumidora tambin emita sin control, slo exponemos su interfaz <code>asObservable()</code>. Relacionado con esto tambin es obligatorio evitar a toda costa punteros al estado. Para ell siempre trabajamos con clones. Los mtodos <code>get() set()</code> usan el <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax\" target=\"_blank\" rel=\"noopener\">spread operator</a> de JS <code>{ ...this.state }</code> tanto al recibir como al devolver el valor del estado.</p><p><code>libs\\rx-store\\src\\lib\\mini-store.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; BehaviorSubject, Observable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'rxjs'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> MiniStore&lt;T&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> state: T;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> subject$ = <span class=\"keyword\">new</span> BehaviorSubject(<span class=\"keyword\">this</span>.get());</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\">initialState: T</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.set(initialState);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">set</span>(newSate: T) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123; ...newSate &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.subject$.next(<span class=\"keyword\">this</span>.get());</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> select$(): Observable&lt;T&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.subject$.asObservable();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">get</span>(): T &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123; ...this.state &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Puedes ver su uso en los test unitarios que le acompaan en <code>libs\\rx-store\\src\\lib\\rx-store.spec.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; MiniStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./mini-store'</span>;</span><br><span class=\"line\">describe(<span class=\"string\">'GIVEN: a basic mini-store of  product stocks'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">interface</span> ProductStock &#123; stock: <span class=\"built_in\">number</span>; &#125;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> initial: ProductStock = &#123; stock: <span class=\"number\">25</span> &#125;;</span><br><span class=\"line\">  describe(<span class=\"string\">'WHEN: I start one '</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> stockMiniStore = <span class=\"keyword\">new</span> MiniStore&lt;ProductStock&gt;(initial);</span><br><span class=\"line\">    it(<span class=\"string\">'THEN: it should have the inital value'</span>, <span class=\"function\"><span class=\"params\">done</span> =&gt;</span> &#123;</span><br><span class=\"line\">      stockMiniStore.select$().subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">        expect(res).toEqual(initial);</span><br><span class=\"line\">        done();</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  describe(<span class=\"string\">'WHEN: I start and set a new value '</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> stockMiniStore = <span class=\"keyword\">new</span> MiniStore&lt;ProductStock&gt;(initial);</span><br><span class=\"line\">    stockMiniStore.set(&#123; stock: <span class=\"number\">40</span> &#125;);</span><br><span class=\"line\">    it(<span class=\"string\">'THEN: it should emit the same value'</span>, <span class=\"function\"><span class=\"params\">done</span> =&gt;</span> &#123;</span><br><span class=\"line\">      stockMiniStore.select$().subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">        expect(res).toEqual(&#123; stock: <span class=\"number\">40</span> &#125;);</span><br><span class=\"line\">        done();</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><h2 id=\"2-2-El-envio-de-acciones\"><a href=\"#2-2-El-envio-de-acciones\" class=\"headerlink\" title=\"2.2 El envo de acciones\"></a>2.2 El envo de acciones</h2><p>En una situacin ms realista y aproximada al patrn Redux <strong>no deberamos asignar el valor de manera directa</strong>, pues hay que dejar rastro de cmo se lleg ah. Necesitamos entonces los conceptos de acciones y funcin reductora. La idea es que el almacn reciba acciones, invoque al reductor y asigne el valor obtenido. Vamos a verlo.</p><p>Empezamos por crear otra clase similar <code>libs\\rx-store\\src\\lib\\rx-store.ts</code> y un par de ayudas. Como mnimo el <em>interface</em> que debe cumplir toda <code>Action</code>; es muy sencillo y siempre igual: una cadena para especificar el comando y cualquier cosa como argumento de carga. Aprovechando las potencia del TypeScript tambin creamos un <em>type</em> para asegurar que la <code>reducerFunction</code> tiene la firma adecuada. La obligamos a recibir como argumentos el estado actual y la accin que se le aplica; teniendo que devolver el nuevo estado.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; BehaviorSubject, Observable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'rxjs'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Action &#123;</span><br><span class=\"line\">  <span class=\"keyword\">type</span>: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  payload: <span class=\"built_in\">any</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">type</span> reducerFunction&lt;T&gt; = <span class=\"function\">(<span class=\"params\">state: T, action: Action</span>) =&gt;</span> T;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RxStore&lt;T&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> state: T;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> subject$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;T&gt;(<span class=\"keyword\">this</span>.get());</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\">initialState: T, <span class=\"keyword\">private</span> reducer: reducerFunction&lt;T&gt;</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.set(initialState);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> select$(): Observable&lt;T&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.subject$.asObservable();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> dispatch(action: Action) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> curretState = <span class=\"keyword\">this</span>.get();</span><br><span class=\"line\">    <span class=\"keyword\">const</span> newState = <span class=\"keyword\">this</span>.reducer(curretState, action);</span><br><span class=\"line\">    <span class=\"comment\">// instrumentation, cache, log...</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.set(newState);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">get</span>(): T &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123; ...this.state &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">set</span>(newSate: T) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123; ...newSate &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.subject$.next(<span class=\"keyword\">this</span>.get());</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Como puedes ver, los <code>get()</code> y <code>set()</code> son ahora privados. El mundo exterior nos enva acciones al mtodo <code>public dispatch(action: Action)</code>. Ese sera un buen momento para incluir lgica de infraestructura e instrumentacin. Hay quien crea un <em>log</em> de lo ocurrido, un histrico de valores las libreras profesionales nos dan todo eso y mas. Una vez recibida la accin empieza la fiesta de los <em>clones</em> invocando en medio a una funcin reductora que ahora veremos.</p><hr><h2 id=\"2-3-La-funcion-reductora-de-estado\"><a href=\"#2-3-La-funcion-reductora-de-estado\" class=\"headerlink\" title=\"2.3 La funcin reductora de estado\"></a>2.3 La funcin reductora de estado</h2><p>En el fichero de <em>test</em> <code>libs\\rx-store\\src\\lib\\rx-store.spec.ts</code> tenemos un ejemplo clarificador :</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> stockReducer: reducerFunction&lt;ProductStock&gt; = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    state: ProductStock,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    action: Action</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">  </span>): <span class=\"title\">ProductStock</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> clonedState = &#123; ...state &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (action.type) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">case</span> <span class=\"string\">'set'</span>:</span><br><span class=\"line\">        clonedState.stock = action.payload;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">      <span class=\"keyword\">case</span> <span class=\"string\">'increment'</span>:</span><br><span class=\"line\">        clonedState.stock += action.payload;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">      <span class=\"keyword\">default</span>:</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> clonedState;</span><br><span class=\"line\">  &#125;;</span><br></pre></td></tr></table></figure><p>Definimos <code>stockReducer</code> como una <a href=\"https://www.freecodecamp.org/news/what-is-a-pure-function-in-javascript-acb887375dfe/\" target=\"_blank\" rel=\"noopener\"><strong>funcin pura</strong></a> que cumple con el tipo <code>reducerFunction</code>. Normalmente estas funciones tienen un <em>switch</em> que evala el tipo de la accin. En cada caso se asigna un nuevo estado segn la mnima lgica oportuna y al finalizar se devuelve el estado mutado.</p><p>Veamos el resto del <em>test</em> para tener una idea de cmo se utiliza.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">describe(<span class=\"string\">'WHEN: I get an increment '</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> stockRxStore = <span class=\"keyword\">new</span> RxStore&lt;ProductStock&gt;(initial, stockReducer);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> incrementAction: Action = &#123; <span class=\"keyword\">type</span>: <span class=\"string\">'increment'</span>, payload: <span class=\"number\">5</span> &#125;;</span><br><span class=\"line\">  stockRxStore.dispatch(incrementAction);</span><br><span class=\"line\">  it(<span class=\"string\">'THEN: it should raise the stock'</span>, <span class=\"function\"><span class=\"params\">done</span> =&gt;</span> &#123;</span><br><span class=\"line\">    stockRxStore.select$().subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">      expect(res).toEqual(&#123; stock: <span class=\"number\">30</span> &#125;);</span><br><span class=\"line\">      done();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p>De esta forma ya tenemos un sistema sencillo pero del que podramos decir que cumple con los principios bsicos de Redux.</p><h2 id=\"Resumen\"><a href=\"#Resumen\" class=\"headerlink\" title=\"Resumen\"></a>Resumen</h2><p>Las aplicaciones reales no son sencillas. Este es un tutorial avanzado que te exige conocimiento previo y dedicacin. A cambio espero que te resulte til y que podis incorporar las tcnicas de deteccin del cambio y control de estado observable en vuestros proyectos.</p><p>Con este tutorial continas tu formacin <a href=\"../tag/Avanzado/\">avanzada en Angular</a>; para poder afrontar retos de tamao industrial usando te recomiendo que uses <a href=\"../el-patron-redux-con-ngrx-en-angular\">El patrn Redux con NgRx en Angular</a>. Todos esos detalles se tratan en el <a href=\"../https://academia-binaria.com/cursos/angular-business\">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-14_redux.png\" alt=\"flujo-reactivo-unidireccional-con-Angular-y-RxJs\"></p><p>Continuando con el <strong>tutorial de Angular Avanzado</strong> nos centramos ahora en una arquitectura de comunicacin de datos conocida como <em>Unidirectional Data Flow</em> o flujo de datos en un mismo sentido; la base del <strong>patrn Redux</strong>. Esta tcnica es una mejora sobre el modelo bsico de Angular, el <em>double-binding</em>, el cual facilitaba mucho el desarrollo en pequeos proyectos.</p><blockquote><p>Cuando hablamos de mejora debemos ser honestos con los costes y beneficios: aqu vamos a mejorar la eficiencia en ejecucin y a facilitar la depuracin a costa de una mayor complejidad estructural y sintctica. Merece la pena cuanto ms grande sea el proyecto. Este es un ejemplo simplificado pero realista que implementa <em>Redux</em>. Tmate tu tiempo para estudiarlo con calma.</p></blockquote><p>Tomar las decisiones correctas en cuestiones de este calibre puede suponer la diferencia entre el xito o fracaso de un proyecto. Voy a explicarte las razones para usar este patrn y la manera ms sencilla de introducirlo en tus aplicaciones, dejndote en el umbral de soluciones an ms potentes como la gestin de estado centralizada con <em>Redux</em>.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../componentes-dinamicos-directivas-y-pipes-con-Angular\">Componentes dinmicos, directivas y pipes con Angular</a>. Al finalizar dotaremos a la aplicacin de un almacn de datos <em>Redux</em> que notifica cambios reactivos.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h2 id=\"Tabla-de-Contenido\"><a href=\"#Tabla-de-Contenido\" class=\"headerlink\" title=\"Tabla de Contenido:\"></a>Tabla de Contenido:</h2><p><a href=\"./#1-Arquitectura-del-patron-Redux\">1. Arquitectura del patrn Redux.</a></p><p><a href=\"./#2-Implementacion-de-un-Store-con-RxJs\">2. Implementacin de un Store con RxJs.</a></p><p><a href=\"./#Resumen\">Resumen</a></p><hr><h1 id=\"1-Arquitectura-del-patron-Redux\"><a href=\"#1-Arquitectura-del-patron-Redux\" class=\"headerlink\" title=\"1. Arquitectura del patrn Redux\"></a>1. Arquitectura del patrn Redux</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">Como:</span> <span class=\"string\">desarrollador,</span></span><br><span class=\"line\"><span class=\"attr\">   Quiero:</span> <span class=\"string\">saber</span> <span class=\"string\">qu</span> <span class=\"string\">acciones</span> <span class=\"string\">se</span> <span class=\"string\">pueden</span> <span class=\"string\">hacer</span></span><br><span class=\"line\">   <span class=\"string\">para</span> <span class=\"attr\">que:</span> <span class=\"string\">pueda</span> <span class=\"string\">controlar</span> <span class=\"string\">la</span> <span class=\"string\">funcionalidad</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Como:</span> <span class=\"string\">desarrollador,</span></span><br><span class=\"line\"><span class=\"attr\">   Quiero:</span> <span class=\"string\">saber</span> <span class=\"string\">qu</span> <span class=\"string\">cambios</span> <span class=\"string\">se</span> <span class=\"string\">han</span> <span class=\"string\">realizado</span></span><br><span class=\"line\">   <span class=\"string\">para</span> <span class=\"attr\">que:</span> <span class=\"string\">pueda</span> <span class=\"string\">depurar</span> <span class=\"string\">y</span> <span class=\"string\">predecir</span> <span class=\"string\">el</span> <span class=\"string\">comportamiento</span></span><br></pre></td></tr></table></figure><p>Hablar de <em>Unidirectional Data Flow</em> sin presentar <strong><em>Redux</em></strong> es poco menos que imposible. Vamos a ver en qu consiste este patrn tan usado, no slo en Angular. Lo que aprendas te servir tambin para <em>react</em>, <em>vue</em> y otros.</p><p><strong>Redux se ocupa de la gestin del estado</strong>, es decir, del valor de las variables en un determinado momento. Centraliza sus cambios para saber qu ocurri para llegar a este valor, y qu valor tendr segn lo que ocurra. Desacopla los emisores de acciones de los receptores de informacin, para ello combina otros dos patrones:</p><ul><li><p><strong>Action:</strong> Envo de comandos al almacn para actualizar el estado</p></li><li><p><strong>Observable:</strong> Subscripcin a cambios en el estado del almacn.</p></li></ul><p>Como incorpora cierta complejidad de serie conviene que nos hagamos esta pregunta Cundo usarlo?. Una pequea lista de ideas sobre cundo implementar Redux.</p><ul><li>Aplicaciones complejas con <strong>mltiples componentes</strong>.<ul><li>El patrn contenedor / presentadores se hace complejo y tedioso a partir de tres niveles de profundidad del rbol.</li><li>Los <code>router-outlets</code> inician una jerarqua propia. Comunicar componentes entre rboles no es factible con <code>@Input</code> y <code>@Output</code></li></ul></li><li>Uso de estrategias de <strong>deteccin del cambio OnPush</strong>.<ul><li>Consumo de datos mediante <em>pipes async</em> suscritos a observables.</li></ul></li><li><strong>Cambios concurrentes</strong> por el usuario y los servicios.<ul><li>Peticiones mediante <em>pull</em> a intervalos regulares</li><li>Recepcin de <em>sockets</em></li><li>Llamadas en paralelo</li></ul></li><li>Gestin de datos local con <em>cachs</em></li></ul><blockquote><p>Redux no hace rpido lo simple, sino mantenible lo complejo.</p></blockquote><h2 id=\"1-1-Principios-de-Redux\"><a href=\"#1-1-Principios-de-Redux\" class=\"headerlink\" title=\"1.1 Principios de Redux\"></a>1.1 Principios de Redux</h2><p>Tenemos tres principios bsicos que cumplir:</p><ul><li><strong>Single Source Of Truth</strong>: Cada pieza de informacin se almacena en un nico lugar, independientemente de dnde sea creada, modificada o requerida.</li><li><strong>Read Only State</strong>: La informacin ser de slo lectura y slo podr modificarse a travs de conductos oficiales.</li><li><strong>Changes By Pure Functions</strong>: Los cambios tienen que poder ser replicados, cancelados y auditados; lo mejor, usar una funcin pura.</li></ul><h2 id=\"1-2-Elementos-de-Redux\"><a href=\"#1-2-Elementos-de-Redux\" class=\"headerlink\" title=\"1.2 Elementos de Redux\"></a>1.2 Elementos de Redux</h2><p>Los artificios fundamentales que incorporaremos a nuestro desarrollo van en dos niveles. El primer nivel resuelve los dos primeros principios.</p><ul><li><strong>Store</strong>: El sistema que mantiene el estado. Despacha acciones de mutado sobre el mismo y comunica cambios enviando copias de slo lectura a los subscriptores.</li><li><strong>State</strong>: Objeto que contiene la nica copia vlida de la informacin. Representa el valor del almacn en un momento determinado. Nunca expondremos un puntero a este dato privado.</li></ul><h3 id=\"Acceso-al-estado\"><a href=\"#Acceso-al-estado\" class=\"headerlink\" title=\"Acceso al estado\"></a>Acceso al estado</h3><ul><li><p><strong>Setters</strong> : Mtodos que asignan y notifican un nuevo cambio. Clonan la informacin recibida para que el llamante no tenga un puntero al estado.</p></li><li><p><strong>Selectors</strong> : Mtodos para consulta del estado. Devuelven un observable al que suscribirse para obtener notificaciones de cambio o una instantnea. En cualquier caso siempre emitir o devolver un clon del estado.</p></li></ul><h3 id=\"Mutaciones-del-estado\"><a href=\"#Mutaciones-del-estado\" class=\"headerlink\" title=\"Mutaciones del estado\"></a>Mutaciones del estado</h3><ul><li><p><strong>Actions</strong>: Objetos identificados por un tipo y cargados con un <em>payload</em>. Transmiten una intencin de mutacin sobre el estado del <em>store</em>.</p></li><li><p><strong>Reducers</strong> : Son funciones puras, que ostentan la exclusividad de poder mutar el estado. Reciben dos argumentos: el estado actual y una accin con su tipo y su carga. Clonan el estado, realizan los cambios oportunos y devuelven el estado mutado.</p></li></ul><p><img src=\"/images/Redux.png\" alt=\"Redux\"></p><p>Podemos verlo en un diagrama antes de pasar a verlo en cdigo.</p><h1 id=\"2-Implementacion-de-un-Store-con-RxJs\"><a href=\"#2-Implementacion-de-un-Store-con-RxJs\" class=\"headerlink\" title=\"2. Implementacin de un Store con RxJs\"></a>2. Implementacin de un Store con RxJs</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">seller,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">know</span> <span class=\"string\">how</span> <span class=\"string\">many</span> <span class=\"string\">products</span> <span class=\"string\">are</span> <span class=\"string\">out</span> <span class=\"string\">of</span> <span class=\"string\">stock</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">refill</span> <span class=\"string\">them</span></span><br></pre></td></tr></table></figure><p>Para que veas que <strong>Redux es independiente de Angular</strong>, vamos a montarlo en una librera sin dependencias del <em>framework</em>. <strong>Slo TypeScript y RxJs</strong>. A da de hoy ambas tecnologas son transversales al ecosistema <em>frontend</em>.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @nrwl/workspace:library rx-store</span><br></pre></td></tr></table></figure><h2 id=\"2-1-El-Store-observable-minimo\"><a href=\"#2-1-El-Store-observable-minimo\" class=\"headerlink\" title=\"2.1 El Store observable mnimo\"></a>2.1 El Store observable mnimo</h2><p>Empezaremos por la implementacin ms inocente de un almacn reactivo. Una clase con <a href=\"https://www.typescriptlang.org/docs/handbook/generics.html\" target=\"_blank\" rel=\"noopener\">tipos genricos</a> que hace uso de la librera de observables RxJs. De esta, toma el <code>BehaviorSubject</code> que permite notificar cambios y valores iniciales.</p><p>Aunque para evitar que otra clase consumidora tambin emita sin control, slo exponemos su interfaz <code>asObservable()</code>. Relacionado con esto tambin es obligatorio evitar a toda costa punteros al estado. Para ell siempre trabajamos con clones. Los mtodos <code>get() set()</code> usan el <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax\" target=\"_blank\" rel=\"noopener\">spread operator</a> de JS <code>{ ...this.state }</code> tanto al recibir como al devolver el valor del estado.</p><p><code>libs\\rx-store\\src\\lib\\mini-store.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; BehaviorSubject, Observable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'rxjs'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> MiniStore&lt;T&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> state: T;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> subject$ = <span class=\"keyword\">new</span> BehaviorSubject(<span class=\"keyword\">this</span>.get());</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\">initialState: T</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.set(initialState);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">set</span>(newSate: T) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123; ...newSate &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.subject$.next(<span class=\"keyword\">this</span>.get());</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> select$(): Observable&lt;T&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.subject$.asObservable();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">get</span>(): T &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123; ...this.state &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Puedes ver su uso en los test unitarios que le acompaan en <code>libs\\rx-store\\src\\lib\\rx-store.spec.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; MiniStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./mini-store'</span>;</span><br><span class=\"line\">describe(<span class=\"string\">'GIVEN: a basic mini-store of  product stocks'</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">interface</span> ProductStock &#123; stock: <span class=\"built_in\">number</span>; &#125;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> initial: ProductStock = &#123; stock: <span class=\"number\">25</span> &#125;;</span><br><span class=\"line\">  describe(<span class=\"string\">'WHEN: I start one '</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> stockMiniStore = <span class=\"keyword\">new</span> MiniStore&lt;ProductStock&gt;(initial);</span><br><span class=\"line\">    it(<span class=\"string\">'THEN: it should have the inital value'</span>, <span class=\"function\"><span class=\"params\">done</span> =&gt;</span> &#123;</span><br><span class=\"line\">      stockMiniStore.select$().subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">        expect(res).toEqual(initial);</span><br><span class=\"line\">        done();</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  describe(<span class=\"string\">'WHEN: I start and set a new value '</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> stockMiniStore = <span class=\"keyword\">new</span> MiniStore&lt;ProductStock&gt;(initial);</span><br><span class=\"line\">    stockMiniStore.set(&#123; stock: <span class=\"number\">40</span> &#125;);</span><br><span class=\"line\">    it(<span class=\"string\">'THEN: it should emit the same value'</span>, <span class=\"function\"><span class=\"params\">done</span> =&gt;</span> &#123;</span><br><span class=\"line\">      stockMiniStore.select$().subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">        expect(res).toEqual(&#123; stock: <span class=\"number\">40</span> &#125;);</span><br><span class=\"line\">        done();</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><h2 id=\"2-2-El-envio-de-acciones\"><a href=\"#2-2-El-envio-de-acciones\" class=\"headerlink\" title=\"2.2 El envo de acciones\"></a>2.2 El envo de acciones</h2><p>En una situacin ms realista y aproximada al patrn Redux <strong>no deberamos asignar el valor de manera directa</strong>, pues hay que dejar rastro de cmo se lleg ah. Necesitamos entonces los conceptos de acciones y funcin reductora. La idea es que el almacn reciba acciones, invoque al reductor y asigne el valor obtenido. Vamos a verlo.</p><p>Empezamos por crear otra clase similar <code>libs\\rx-store\\src\\lib\\rx-store.ts</code> y un par de ayudas. Como mnimo el <em>interface</em> que debe cumplir toda <code>Action</code>; es muy sencillo y siempre igual: una cadena para especificar el comando y cualquier cosa como argumento de carga. Aprovechando las potencia del TypeScript tambin creamos un <em>type</em> para asegurar que la <code>reducerFunction</code> tiene la firma adecuada. La obligamos a recibir como argumentos el estado actual y la accin que se le aplica; teniendo que devolver el nuevo estado.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; BehaviorSubject, Observable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'rxjs'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Action &#123;</span><br><span class=\"line\">  <span class=\"keyword\">type</span>: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  payload: <span class=\"built_in\">any</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">type</span> reducerFunction&lt;T&gt; = <span class=\"function\">(<span class=\"params\">state: T, action: Action</span>) =&gt;</span> T;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RxStore&lt;T&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> state: T;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> subject$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;T&gt;(<span class=\"keyword\">this</span>.get());</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\">initialState: T, <span class=\"keyword\">private</span> reducer: reducerFunction&lt;T&gt;</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.set(initialState);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> select$(): Observable&lt;T&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.subject$.asObservable();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> dispatch(action: Action) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> curretState = <span class=\"keyword\">this</span>.get();</span><br><span class=\"line\">    <span class=\"keyword\">const</span> newState = <span class=\"keyword\">this</span>.reducer(curretState, action);</span><br><span class=\"line\">    <span class=\"comment\">// instrumentation, cache, log...</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.set(newState);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">get</span>(): T &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123; ...this.state &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">set</span>(newSate: T) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123; ...newSate &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.subject$.next(<span class=\"keyword\">this</span>.get());</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Como puedes ver, los <code>get()</code> y <code>set()</code> son ahora privados. El mundo exterior nos enva acciones al mtodo <code>public dispatch(action: Action)</code>. Ese sera un buen momento para incluir lgica de infraestructura e instrumentacin. Hay quien crea un <em>log</em> de lo ocurrido, un histrico de valores las libreras profesionales nos dan todo eso y mas. Una vez recibida la accin empieza la fiesta de los <em>clones</em> invocando en medio a una funcin reductora que ahora veremos.</p><hr><h2 id=\"2-3-La-funcion-reductora-de-estado\"><a href=\"#2-3-La-funcion-reductora-de-estado\" class=\"headerlink\" title=\"2.3 La funcin reductora de estado\"></a>2.3 La funcin reductora de estado</h2><p>En el fichero de <em>test</em> <code>libs\\rx-store\\src\\lib\\rx-store.spec.ts</code> tenemos un ejemplo clarificador :</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> stockReducer: reducerFunction&lt;ProductStock&gt; = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    state: ProductStock,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    action: Action</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">  </span>): <span class=\"title\">ProductStock</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> clonedState = &#123; ...state &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (action.type) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">case</span> <span class=\"string\">'set'</span>:</span><br><span class=\"line\">        clonedState.stock = action.payload;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">      <span class=\"keyword\">case</span> <span class=\"string\">'increment'</span>:</span><br><span class=\"line\">        clonedState.stock += action.payload;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">      <span class=\"keyword\">default</span>:</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> clonedState;</span><br><span class=\"line\">  &#125;;</span><br></pre></td></tr></table></figure><p>Definimos <code>stockReducer</code> como una <a href=\"https://www.freecodecamp.org/news/what-is-a-pure-function-in-javascript-acb887375dfe/\" target=\"_blank\" rel=\"noopener\"><strong>funcin pura</strong></a> que cumple con el tipo <code>reducerFunction</code>. Normalmente estas funciones tienen un <em>switch</em> que evala el tipo de la accin. En cada caso se asigna un nuevo estado segn la mnima lgica oportuna y al finalizar se devuelve el estado mutado.</p><p>Veamos el resto del <em>test</em> para tener una idea de cmo se utiliza.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">describe(<span class=\"string\">'WHEN: I get an increment '</span>, <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> stockRxStore = <span class=\"keyword\">new</span> RxStore&lt;ProductStock&gt;(initial, stockReducer);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> incrementAction: Action = &#123; <span class=\"keyword\">type</span>: <span class=\"string\">'increment'</span>, payload: <span class=\"number\">5</span> &#125;;</span><br><span class=\"line\">  stockRxStore.dispatch(incrementAction);</span><br><span class=\"line\">  it(<span class=\"string\">'THEN: it should raise the stock'</span>, <span class=\"function\"><span class=\"params\">done</span> =&gt;</span> &#123;</span><br><span class=\"line\">    stockRxStore.select$().subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">      expect(res).toEqual(&#123; stock: <span class=\"number\">30</span> &#125;);</span><br><span class=\"line\">      done();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure><p>De esta forma ya tenemos un sistema sencillo pero del que podramos decir que cumple con los principios bsicos de Redux.</p><h2 id=\"Resumen\"><a href=\"#Resumen\" class=\"headerlink\" title=\"Resumen\"></a>Resumen</h2><p>Las aplicaciones reales no son sencillas. Este es un tutorial avanzado que te exige conocimiento previo y dedicacin. A cambio espero que te resulte til y que podis incorporar las tcnicas de deteccin del cambio y control de estado observable en vuestros proyectos.</p><p>Con este tutorial continas tu formacin <a href=\"../tag/Avanzado/\">avanzada en Angular</a>; para poder afrontar retos de tamao industrial usando te recomiendo que uses <a href=\"../el-patron-redux-con-ngrx-en-angular\">El patrn Redux con NgRx en Angular</a>. Todos esos detalles se tratan en el <a href=\"../https://academia-binaria.com/cursos/angular-business\">curso avanzado online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"El patrn Redux con NgRx en Angular","date":"2019-09-25T11:08:50.000Z","thumbnail":"/css/images/angular-15_ngrx.png","_content":"\n![el-patron-redux-con-ngrx-en-angular](/images/tutorial-angular-15_ngrx.png)\n\nLe pasa a todas las aplicaciones, crecen y crecen en funcionalidad y complejidad. En Angular estamos preparados para modularizar, componentizar e inyectar servicios. Pero con grandes aplicaciones, o con grandes equipos, parece que nada es suficiente. Se necesita una **gestin del estado centralizada** como la del [patrn Redux]((../flujo-reactivo-unidireccional-con-Angular-y-RxJs/)).\n\nSi decamos que **Redux no hace rpido lo simple, sino mantenible lo complejo**, ahora te digo que **NgRx no hace rpido a Redux, sino mantenible su boilerplate.** As que si tienes delante un desarrollo funcionalmente complejo, te recomiendo que uses *NgRX*; la solucin estndar para implementar **Redux con Angular**.\n\n\n<!-- more -->\n\nPartiendo del cdigo tal como qued en [Redux, flujo reactivo unidireccional con Angular y RxJs](../flujo-reactivo-unidireccional-con-Angular-y-RxJs/). Al finalizar tendrs una aplicacin que gestiona centralizadamente los cambios, que permite conocer qu ocurri y predecir lo que ocurrir usando NgRx.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n# 1 Instalacin y configuracin\n\n**NgRx** es el estndar de facto para implementar _Redux_ en Angular. Est basada en _RxJS_ y es una librera modular con todo lo necesario para crear grandes aplicaciones. Esto son los mdulos que la componen:\n\n- **store**: Es el mdulo principal con el administrador del estado centralizado y reactivo.\n- **store-devtools**: Instrumentacin para depurar desde el navegador. Vale su peso en oro.\n- **router-Store** : Almacena el estado del *router* de Angular en el *store*, tratando cada evento como una accin Redux.\n- **effects**: Los reductores son funciones puras sin efectos colaterales. Este mdulo es la solucin para comandos asncronos.\n- **schematics, entity, ngrx-data**: Son otros mdulos opcionales con ayudas y plantillas de NgRX.\n\n## 1.1 Instalacin de NgRx\n\nPara agregar *NgRx* a un app te propongo que uses los _schematics_ de NxDev pues disponen de ms opciones de configuracin inmediata. Aunque la alternativa con el CLI tambin es suficiente para empezar.\n\n```shell\n# with Nx.dev tools\nng g @nrwl/angular:ngrx app --module=apps/shop/src/app/app.module.ts --root --minimal\n# with only CLI\nng add @ngrx/store\n\n```\nCon esto habrs instalado y configurado NgRx y tu `AppModule` tendr algo as:\n\n```typescript\n@NgModule({\n  imports: [\n    CommonModule,\n    RouterModule,\n    StoreModule.forRoot(\n      {},\n      {\n        metaReducers: !environment.production ? [] : [],\n        runtimeChecks: {\n          strictActionImmutability: true,\n          strictStateImmutability: true\n        }\n      }\n    ),\n    EffectsModule.forRoot([])\n  ]\n})\nexport class AppModule {}\n```\n\n> El cdigo generado por cualquiera de los dos schematics no es para todos los gustos. Tmalo como un punto de partida y crea la estructura que mejor te encaje.\n\n## 1.2 DevTools\n\nLa razn principal de usar Redux es la capacidad que da al programador para comprender cmo el estado de sus variables ha variado en el tiempo. Es decir Cmo hemos llegado hasta aqu?. Esta es claramente una cuestin de anlisis y depuracin de cdigo. Y para ello necesitamos herramientas de desarrollador. Presentamos las [**Redux DevTools for Chrome**](https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en).\n\nEste es un plugin que se engancha a cualquier solucin Redux (no slo NgRx, ni siquiera slo Angular) y que permite explorar el valor del estado y lo ms interesante: la secuencia de acciones que se ha despachado y el efecto que cada una tuvo sobre el valor del estado.\n\nPara realizar el enganche sirve la lnea que vers tambin en el `AppModule`. La cual activa la monitorizacin cuando no estamos en produccin. Normal, esto es un herramienta para el desarrollador, nunca para el usuario.\n\n```typescript\n  !environment.production ? StoreDevtoolsModule.instrument() : [],\n```\nPara verlo en funcionamiento tienes que ejecutar y abrir tu app en Chrome. Despus en la pantalla de inspeccin del cdigo aparecer una pestaa al final de todo (ms all de Network y Application...) llamada Redux. La interfaz es muy intuitiva; no tardars en hacerte con ella. aunque ahora mismo un poco pobre...\n\n## 1.3 Router\n\nPara darle algo de contenido y de paso acercarnos a las capacidades de Redux y NgRx vamos a conectarle el `RouterModule` de la aplicacin. Para ello sirve la siguiente lnea que tienes que poner tambin en la importaciones del `AppModule`.\n\n```typescript\n  StoreRouterConnectingModule.forRoot({ routerState: RouterState.Minimal })\n```\n\nA partir de este momento cada evento de navegacin del _router_ va a generar una accin que _NgRx_ recoger y registrar. Esas acciones y su impacto en el estado se pueden visualizar con el plugin de Redux. Podrs ver los cambios y reproducirlos hacia adelante y atrs. Es como viajar en el tiempo dentro de la ejecucin de app.\n\n\n# 2 Actions\n\nHasta el momento ha sido todo muy de infraestructura, pero es hora de que hagamos algo funcional. Un ejemplo sera agregar a nuestra app un mdulo para la gestin de medios de pago de un usuario. Algo as:\n\n```yaml\nAs a: customer,\n  I want: to add payment methods\n  so that: I can pay with them\n\nAs a: customer,\n  I want: to select one as preferred\n  so that: I can make fewer clicks\n\nAs a: customer,\n  I want: to change de expiration date\n  so that: I get my cards up to date\n```\n\nPara ello, y valiendo una vez ms de los schematics vamos a agregar una _feature_\n\n```bash\nng g m payments --project=shop --module=app.module.ts --routing --route=payments\nng g @ngrx/schematics:feature payments/store/paymentMethod --project=shop --module=payments/payments.module.ts --no-flat --no-spec --creators\n```\n\nEsto habr generado un buen montn de cdigo. Pero todo demasiado genrico. Vamos a empezar a adaptarlo a nuestro problema aportando un modelo de datos.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.model.ts`\n\n```typescript\nexport interface PaymentMethod {\n  id: string;\n  expiration: Date;\n}\n\nexport interface PaymentMethods {\n  list: PaymentMethod[];\n  preferred: string;\n}\n```\nY ahora s, vamos a por las acciones.\n\n## 2.1 Create\n\nUno de los parmetros usados durante la generacin de la _feature_ fue `--creators`. Esto le indic a NgRx que preferimos usar funciones en lugar de clases para definir nuestras acciones. As que en el fichero de definicin de acciones te encontrars con llamadas a una funcin como esta `createAction('Descripcin de la accin', props<{ parametro: Tipo }>() )`.\nCon esto tenemos que cubrir los dos requerimientos de Redux: las acciones han de tener un tipo y una _payload_.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.actions.ts`\n\n```typescript\nexport const loadPaymentMethods = createAction(\n  '[PaymentMethod] Load PaymentMethods'\n);\n\nexport const addPaymentMethod = createAction(\n  '[PaymentMethod] Add PaymentMethod',\n  props<{ newPaymentMethod: PaymentMethod }>()\n);\n\nexport const selectPreferredPaymentMethod = createAction(\n  '[PaymentMethod] Select preferred PaymentMethod',\n  props<{ preferredId: string }>()\n);\n\nexport const setExpirationPaymentMethod = createAction(\n  '[PaymentMethod] Set Expiration Date on PaymentMethod',\n  props<{ updatedPaymentMethod: PaymentMethod }>()\n);\n```\n\nEl cdigo puede resultar extrao a primera vista; pero es siempre igual y acabas familiarizando muy rpido. Esencialmente se trata de dar un nombre a la accin y luego configurarla. Lo imprescindible va a ser un string que la describa. Es recomendable seguir el convenio con el formato `[Origen] Nombre accin descriptivo`.\n\nEl segundo argumento de la funcin `creteAction` es a su vez otra funcin. La parte interesante de la funcin `propos<>()` est en su tipo genrico. Es ah dnde definimos el tipo de datos de la _payload_ que puede transportar la accin.\n\n## 2.2 Dispatch\n\nDefinir el catlogo de acciones es la primera parte del problema. Ahora nos toca invocarlas, o como se dice en el argot Redux: despacharlas. Para ello voy a crear un servicio auxiliar que encapsule toda la interaccin con NgRx. Es una implementacin del patrn fachada para unificar y facilitar el trabajo con Redux desde fuera.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.service.ts`\n\n```typescript\nimport { Injectable } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport * as PaymentMethodActions from './payment-method.actions';\nimport { PaymentMethod, PaymentMethods } from './payment-method.model';\n@Injectable({\n  providedIn: 'root'\n})\nexport class PaymentMethodService {\n  constructor(private store: Store<PaymentMethods>) {}\n}\n```\n\nY aqu puedo crear los mtodos funcionales que despachen las acciones sobre el _store_ de NgRx.\n\n```typescript\npublic loadPaymentMethods() {\n  this.store.dispatch(PaymentMethodActions.loadPaymentMethods());\n}\npublic addPaymentMethod(newPaymentMethod: PaymentMethod) {\n    this.store.dispatch(\n      PaymentMethodActions.addPaymentMethod({\n        newPaymentMethod: { ...newPaymentMethod }\n      })\n    );\n  }\npublic selectPreferredPaymentMethod(preferredId: string) {\n  this.store.dispatch(\n    PaymentMethodActions.selectPreferredPaymentMethod({ preferredId })\n  );\n}\npublic setExpirationPaymentMethod(updatedPaymentMethod: PaymentMethod) {\n  this.store.dispatch(\n    PaymentMethodActions.setExpirationPaymentMethod({\n      updatedPaymentMethod: { ...updatedPaymentMethod }\n    })\n  );\n}\n```\n\nEs necesario enviar siempre un clon de los argumentos para desconectarlos del origen. En Redux queremos tener la fuente nica de la verdad, y eso slo es posible si los argumentos que recibimos estn sellados y aislados del resto del mundo.\n\nPara una primera aproximacin, reconozco que es mucho cdigo para tan poca funcionalidad. Claro que para quien use esta fachada el mundo es mucho ms sencillo. Y por dentro es muy potente y controlable.\n\n`apps\\shop\\src\\app\\payments\\payments.component.ts`\n\n```typescript\nexport class PaymentsComponent implements OnInit {\n  constructor(private paymentMethodService: PaymentMethodService) {}\n\n  ngOnInit() {\n    this.paymentMethodService.loadPaymentMethods();\n    const visa: PaymentMethod = {\n      id: '1234 7896 3214 6549',\n      expiration: new Date(2020, 6-1, 30)\n    };\n    this.paymentMethodService.addPaymentMethod(visa);\n    this.paymentMethodService.selectPreferredPaymentMethod(visa.id);\n    visa.expiration = new Date(2021, 12-1, 31);\n    this.paymentMethodService.setExpirationPaymentMethod(visa);\n  }\n}\n```\n\n# 3 State reducer\n\n## 3.1 State\n\nEl estado en *redux* es un objeto tipado a partir de una interfaz, inicialmente llamada `State` a secas, aunque yo prefiero identificarla como `PaymentMethodsState`. Tendr propiedades para almacenar objetos ms o menos complejos. Cada propiedad tendr su propio tipo complejo y necesita un estado inicial. Eso es lo que hace este cdigo:\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts`\n\n```typescript\nexport const paymentMethodFeatureKey = 'paymentMethod';\n\nexport interface PaymentMethodsState {\n  paymentMethods: PaymentMethods;\n}\n\nexport const initialState: PaymentMethodsState = {\n  paymentMethods: { list: [], preferred: null }\n};\n```\n\n## 3.2 Create function\n\nPero todo estado necesita su reductor, y una vez ms lo crearemos mediante una funcin. En este caso es la `createReducer(state, on(action1, function1) )`. Su encarnacin ms bsica tiene la siguiente pinta:\n\n```typescript\nconst paymentMethodReducer = createReducer(\n  initialState,\n  on(PaymentMethodActions.loadPaymentMethods, state => state)\n);\n```\nLo que hace es definir una serie de `hooks` para enganchar funciones de mutacin en respuesta a las acciones despachadas. Empezamos con la accin `loadPaymentMethods` y en este caso no por ahora hacemos ninguna mutacin al estado. Es un reductor transparente e innecesario. Lo pongo para familiarizarnos con la sintaxis.\n\nVamos a algo ms complejo y til como la accin `addPaymentMethod`. Funcionalmente queremos agregar el nuevo mtodo de pago que viene en su carga al array actual de mtodos de pago. Nada complejo, ya s deben ser todas las funciones reductoras.\n\nPero, siempre hay un pero, resulta que **una funcin reductora debe ser tambin una funcin pura**. Y esto nos obliga a mutar el estado sin mutar los argumentos; es decir, nos obliga a clonar el estado y sus propiedades antes de cambiarlas.\n\n```typescript\non(PaymentMethodActions.addPaymentMethod, (state, { newPaymentMethod }) => {\n  return {\n    ...state,\n    paymentMethods: {\n      ...state.paymentMethods,\n      list: [...state.paymentMethods.list, newPaymentMethod]\n    }\n  };\n})\n```\n\nEl proceso de clonado puedes hacerlo con mayor o menor profundidad, pero al menos un clonado superficial del estado es obligatorio. Yo aqu he optado por clonar incluso el array interno, aunque no sea estrictamente obligatorio.\n\n\n## 3.3 Register in Store\n\nEl resultado de esta invocacin a `createReducer()` se ser a su vez otra funcin que yo almacen en la contante `paymentMethodReducer`. Por requerimiento del proceso de empaquetado con `webpack` que nada tiene que ver con NgRx, estamos obligados a exportar la funcin mediante un _wrapper_ como este:\n\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts`\n\n```typescript\nexport function reducer(state: PaymentMethodsState | undefined, action: Action) {\n  return paymentMethodReducer(state, action);\n}\n```\n\nHecho esto tenemos ya una funcin reductora que debemos registrar en el _store_. Lo que hacemos es decirle a NgRx que cuando llegue una accin de mutado invoque a esta accin pasndole la propiedad del estado encargada gestionar.\n\n`apps\\shop\\src\\app\\payments\\payments.module.ts`\n\n```typescript\nimport * as fromPaymentMethod from './store/payment-method/payment-method.reducer';\n@NgModule({\n  imports: [\n    StoreModule.forFeature(\n      fromPaymentMethod.paymentMethodFeatureKey,\n      fromPaymentMethod.reducer\n    )]\n```\n\nNormalmente el nombre de dicha propiedad se estable en una constante exportada para evitar fallos de tecleo con consecuencias imprevisibles.\n\n# 4 Selectors\n\nHasta ahora hemos definido el estado, y creado las acciones que despachamos conta l. Y hemos creado las funciones reductoras que lo modifican al recibir las acciones. No es poco, pero es la mitad del camino. Nos queda enterarnos de los cambios que se ha realizado. Y para eso nos ofrecen un concepto muy de base de datos `select`.\n\n## 4.1 Create selector\n\nLos selectores, mejor dicho las funciones selectoras, se crean mediante una funcin factora igual que hemos visto para las reductoras y las acciones. La diferencia es que aqu las tenemos que llamar a dos niveles: el de la funcionalidad y el de la propiedad especfica que nos interesa.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.selectors.ts`\n\n```typescript\nimport { createFeatureSelector, createSelector } from '@ngrx/store';\nimport { paymentMethodFeatureKey, State } from './payment-method.reducer';\n\nexport const getPaymentMethodState = createFeatureSelector<State>(\n  paymentMethodFeatureKey\n);\n\nexport const getPaymentMethodsList = createSelector(\n  getPaymentMethodState,\n  (state: State) => state.paymentMethods.list\n);\n\nexport const getPreferredPaymentMethod = createSelector(\n  getPaymentMethodState,\n  (state: State) => state.paymentMethods.preferred\n);\n```\n\nPodemos tener tantos selectores como queramos. Se aconseja crearlos para cada tema de inters que pueda tener el resto de la aplicacin. Pueden ser simples vista parciales del estado o complejas transformaciones a gusto del consumidor. NgRx lo hace de forma que optimiza clculos y llamadas as que nos sugieren que abusemos de ellos y encapsulemos aqu todo el acceso al valor y a los cambios del estado.\n\n## 4.2 Selecting data\n\nUna vez ms, si queremos que nuestra aplicacin se desacople lo  ms posible de ngRx, debemos llamar a los selectores desde un servicio fachada. As que aadimos al `apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.service.ts` un par de nuevos mtodos pblicos.\n\n```typescript\n  public getPaymentMethodsList$(): Observable<PaymentMethod[]> {\n    return this.store.select(PaymentMethodSelectors.getPaymentMethodsList);\n  }\n\n  public getPreferredPaymentMethod$(): Observable<string> {\n    return this.store.select(PaymentMethodSelectors.getPreferredPaymentMethod);\n  }\n```\n\n## 4.3 Showing data\n\nEstos mtodos devuelven observables a los que suscribirse para mostrar los valores cambiantes del estado. Gracias a la fachada anterior el componente consumidor es completamente inconsciente de la existencia de NgRx.\n\n```typescript\nexport class PaymentsComponent implements OnInit {\n  public paymentMethodsList$: Observable<PaymentMethod[]>;\n  public preferredPaymentMethod$: Observable<string>;\n  constructor(private paymentMethodService: PaymentMethodService) {}\n\n  ngOnInit() {\n    this.paymentMethodsList$ = this.paymentMethodService.getPaymentMethodsList$();\n    this.preferredPaymentMethod$ = this.paymentMethodService.getPreferredPaymentMethod$();\n  }\n}\n```\n\nPor supuesto, desde la _template_ lo tratamos como a cualquier otro dato asncrono.\n\n```html\n<p>Payment Methods List:</p>\n<pre>{{ paymentMethodsList$ | async | json }}</pre>\n<p>Preferred Payment Method:</p>\n<pre>{{ preferredPaymentMethod$ | async | json }}</pre>\n```\n\n\n# 5 Effects\n\nLas funciones reductoras, como ya se ha dicho, deben ser puras. La idea es que puedan ser auditadas, re-ejecutadas y testeadas sin que necesiten servicios externos ni causen efectos colaterales. Y esto es un problema con la cantidad de **ejecuciones asncronas en las aplicaciones web**. Cualquier tentacin de lanzar una llamada *AJAX* dentro de un reductor debe ser eliminada de inmediato.\n\n> Dos razones: por un lado en Angular se necesita invocar al *httpClient* de alguna manera para realizar la llamada *AJAX*. Y ya que la funcin reductora no pertenece a ninguna clase Angular, no puede haber constructor que reclame la inyeccin de la dependencia a dicho servicio. Tampoco las funciones puras tienen permitido usar nada que no venga entre sus argumentos. Por otra parte las funciones puras han de ser predecibles, y una llamada a un servidor remoto no es en absoluto predecible. Puede pasarle de todo, as que **los reductores no son pas para procesos asncronos**.\n\nLa solucin que proponen *NgRX* es usar un artificio llamado efecto, porque ser encargado de **los efectos secundarios que provocan las las instrucciones asncronas**. De una forma simplista, diremos que las acciones asncronas se multiplicarn por tres. El comando que genera la llamada, y los dos potenciales eventos con la respuesta correcta o el error.\n\nPara manejarlo todo incluyen en la librera el mdulo `EffectsModule` que ha de registrarse junto al `StoreModule`. Desde ese momento *NgRX* activa un sistema de seguimiento que trata las acciones como un stream de *RxJS* y permite subscribirse a la invocacin de dichas acciones y tratarlas adecuadamente.\n\n## 5.1 Install\n\nSegn el proceso que hayas escogido para agregar Ngrx puede que ya tengas los efectos agregados o que tengas que hacerlo manualmente mediante un instruccin como esta:\n\n```bash\nng add @ngrx/effects\n```\nEn cualquier caso aparecer una instruccin de registro en el mdulo raz o funcional que lo necesite. Por ejemplo el de `PaymentsModule` es:\n\n```typescript\nEffectsModule.forFeature([])\n```\n\n## 5.2 Efecto bsico\n\nEn un ejemplo inicial vamos a intentar almacenar y recuperar los mtodos de pago desde el _local storage_ del navegador. Esta es claramente una actividad de riesgo (y no lo dogo slo por el evidente peligro de seguridad). Pero el acceso puede fallar o no estar disponible. Y en el mejor de los casos es un recurso externo que nunca podra ir dentro de una funcin reductora.\n\nAs que vamos a ver el trabajo necesario para montar esto _como Redux manda_.\n\n### Acciones\n\nPara empezar agregamos dos nuevas acciones en respuesta a los potenciales eventos que puedan surgir del acceso al _local storage_\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.actions.ts`\n\n```typescript\nexport const loadPaymentMethods = createAction(\n  '[PaymentMethod] Load Payment Methods'\n);\n\nexport const loadPaymentMethodsSucess = createAction(\n  '[PaymentMethod] Load Payment Methods Success',\n  props<{ paymentMethodList: PaymentMethod[] }>()\n);\n\nexport const loadPaymentMethodsError = createAction(\n  '[PaymentMethod] Load Payment Methods Error'\n);\n```\n\nPara simplificarlo no estoy reportando nada del error especfico. La `loadPaymentMethodsError` servir para indicar que el proceso ha fallado. sin ms.\n\n### Definicin\n\nAhora viene lo bueno. La creacin de un efecto. Empezamos como siempre usando una funcin factora : `createEffect()`. Slo que esta vez va asociada a una propiedad pblica de un servicio de Angular. Y aqu ya tenemos todos nuestros juguetes disponibles.\n\nPor ejemplo la inyeccin de dependencias; en el constructor `constructor(private actions$: Actions) {}` solicitamos como argumento un observable de todas las acciones que se hayan despachado en nuestro `store`. Ese _stream_ servir para escuchar y filtrar las acciones que nos interesen. Despus haremos nuestra operativa con todas las llamadas que hagan falta.\n\nSlo un requisito. Al terminar hemos de retornar un observable con una nueva accin que el sistema encauzar para ser despachada. Esto obliga a conocer bien los operadores _RxJs_ que estn en la base do todo este montaje. De ah el uso `concatMap()` y por supuesto del creador observable ms bsico: `of()`.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.effects.ts`\n\n```typescript\npublic loadPaymentMethods$ = createEffect(() =>\n  this.actions$.pipe(\n    ofType(PaymentMethodActions.loadPaymentMethods),\n    concatMap(() => {\n      try {\n        let storedList = JSON.parse(\n          window.localStorage.getItem(this.storeKey)\n        );\n        if (!storedList) {\n          storedList = initialState.paymentMethods.list;\n          window.localStorage.setItem(\n            this.storeKey,\n            JSON.stringify(storedList)\n          );\n        }\n        return of(\n          PaymentMethodActions.loadPaymentMethodsSucess({\n            paymentMethodList: storedList\n          })\n        );\n      } catch (e) {\n        return of(PaymentMethodActions.loadPaymentMethodsError);\n      }\n    })\n  )\n);\n```\nTmate tu tiempo para entender este efecto, y recuerda que por raro que te parezca al principio, te acabars acostumbrando muy pronto porque siempre sigue el mismo esquema.\n\n### Reducer y Register\n\nPor si te olvidabas, todo este trabajo no altera para nada al estado. Recuerda que slo las reductoras asociadas a las acciones lo hacen. As que incrementamos nuestro cdigo con nuevos casos para el reductor.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts`\n\n```typescript\non(\n    PaymentMethodActions.loadPaymentMethodsSucess,\n    (state, { paymentMethodList }) => {\n      return {\n        ...state,\n        paymentMethods: { ...state.paymentMethods, list: paymentMethodList }\n      };\n    }\n  ),\n  on(PaymentMethodActions.loadPaymentMethodsError, state => state),\n```\n\nY para finalizar registramos la clase que contiene al efecto (como un provider especial) en el mdulo de efectos.\n\n`apps\\shop\\src\\app\\payments\\payments.module.ts`\n\n```typescript\nEffectsModule.forFeature([PaymentMethodEffects])\n```\n\n## 5.3 Api async\n\nUna vez familiarizado con la sintaxis de los efectos bsicos, es hora de pasar a los que sin duda se utilizan ms: los efectos sobre servicios asncronos. Es decir casi todas las llamadas a un API. Algo muy sencillo podra ser agregar a nuestra tienda un converso de divisas para saber los precios en distintas monedas.\n\n```yaml\nAs a: customer,\n  I want: to see the current exchange rate in several currencies\n  so that: I can decide\n```\n\n### Actions\n\nA estas alturas te pido un ltimo esfuerzo para que interpretes el siguiente cdigo:\n\n`apps\\shop\\src\\app\\rates\\store\\exchange-rate\\exchange-rate.actions.ts`\n\n```typescript\nexport const loadExchangeRates = createAction(\n  '[ExchangeRate] Load ExchangeRates'\n);\n\nexport const loadExchangeRatesSuccess = createAction(\n  '[ExchangeRate] Load ExchangeRates Success',\n  props<{ rates: any }>()\n);\n\nexport const loadExchangeRatesError = createAction(\n  '[ExchangeRate] Load ExchangeRates Error',\n  props<{ rates: any }>()\n);\n```\n\n\nEfectivamente, para cada llamada usaremos tres acciones. El comando que la inicia y los dos eventos que pueden ocurrir _success and error_.\n\n### Effect\n\n`apps\\shop\\src\\app\\rates\\store\\exchange-rate\\exchange-rate.effects.ts`\n\n```typescript\nexport class ExchangeRateEffects {\n  public loadExchangeRates$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(ExchangeRateActions.loadExchangeRates),\n      concatMap(() =>\n        this.http.get<any>('https://api.exchangeratesapi.io/latest').pipe(\n          map(res =>\n            ExchangeRateActions.loadExchangeRatesSuccess({ rates: res.rates })\n          ),\n          catchError(err =>\n            of(ExchangeRateActions.loadExchangeRatesError({ rates: err }))\n          )\n        )))\n  );\n  constructor(private actions$: Actions, private http: HttpClient) {}\n}\n```\n\nParadjicamente un efecto que incluya una llamada _http_ es ms sencillo, pues la naturaleza asncrona de _Ajax_ junto con el uso de _Observables_ en `httpClient` nos dejan medio trabajo hecho.\n\nLo que realmente hacemos es encauzar el flujo de acciones `pipe(concatMap())` hacia un flujo de respuestas _http_ `this.http.get()`. Pero claro esto es trampa, as que de nuevo encauzamos la respuesta hacia una accin `pipe(map(res=> actionSuccess(res)))`. Cuando la respuesta no llega volvemos a lo que ya sabemos, crear un nuevo observable con `of(actionError(err))`.\n\nAqu lo dejamos. Soy consciente de que Redux es complejo. Soy consciente de que NgRx aade mucho cdigo de infraestructura. Pero tambin te animo a revisar este artculo y practicar con un caso sencillo antes de tomar cualquier decisin. Incluir NgRx o no hacerlo tiene un alto impacto en el mantenimiento de tu proyecto. No te tires a de cabeza ni lo rechaces de plano.\n\nDescarga y revisa la aplicacin de ejemplo. Si la dominas, entonces es que ya tienes los conocimientos para gestionar de manera centralizada, auditable y predecible el estado de tus programas. El patrn Redux lucir ms cuanto ms grande y compleja sea tu aplicacin.\n\nContina tu formacin avanzada para crear aplicaciones [PWA, entre la web y las apps con Angular](../pwa-entre-la-web-y-las-apps-con-angular) y vers como aprendes a programar con Angular 8.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-15-El-patron-Redux-con-NgRx-en-Angular.md","raw":"---\ntitle: El patrn Redux con NgRx en Angular\npermalink: el-patron-redux-con-ngrx-en-angular\ndate: 2019-09-25 13:08:50\ntags:\n- Angular\n- Angular8\n- Angular2\n- Redux\n- NgRx\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-15_ngrx.png\n---\n\n![el-patron-redux-con-ngrx-en-angular](/images/tutorial-angular-15_ngrx.png)\n\nLe pasa a todas las aplicaciones, crecen y crecen en funcionalidad y complejidad. En Angular estamos preparados para modularizar, componentizar e inyectar servicios. Pero con grandes aplicaciones, o con grandes equipos, parece que nada es suficiente. Se necesita una **gestin del estado centralizada** como la del [patrn Redux]((../flujo-reactivo-unidireccional-con-Angular-y-RxJs/)).\n\nSi decamos que **Redux no hace rpido lo simple, sino mantenible lo complejo**, ahora te digo que **NgRx no hace rpido a Redux, sino mantenible su boilerplate.** As que si tienes delante un desarrollo funcionalmente complejo, te recomiendo que uses *NgRX*; la solucin estndar para implementar **Redux con Angular**.\n\n\n<!-- more -->\n\nPartiendo del cdigo tal como qued en [Redux, flujo reactivo unidireccional con Angular y RxJs](../flujo-reactivo-unidireccional-con-Angular-y-RxJs/). Al finalizar tendrs una aplicacin que gestiona centralizadamente los cambios, que permite conocer qu ocurri y predecir lo que ocurrir usando NgRx.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n# 1 Instalacin y configuracin\n\n**NgRx** es el estndar de facto para implementar _Redux_ en Angular. Est basada en _RxJS_ y es una librera modular con todo lo necesario para crear grandes aplicaciones. Esto son los mdulos que la componen:\n\n- **store**: Es el mdulo principal con el administrador del estado centralizado y reactivo.\n- **store-devtools**: Instrumentacin para depurar desde el navegador. Vale su peso en oro.\n- **router-Store** : Almacena el estado del *router* de Angular en el *store*, tratando cada evento como una accin Redux.\n- **effects**: Los reductores son funciones puras sin efectos colaterales. Este mdulo es la solucin para comandos asncronos.\n- **schematics, entity, ngrx-data**: Son otros mdulos opcionales con ayudas y plantillas de NgRX.\n\n## 1.1 Instalacin de NgRx\n\nPara agregar *NgRx* a un app te propongo que uses los _schematics_ de NxDev pues disponen de ms opciones de configuracin inmediata. Aunque la alternativa con el CLI tambin es suficiente para empezar.\n\n```shell\n# with Nx.dev tools\nng g @nrwl/angular:ngrx app --module=apps/shop/src/app/app.module.ts --root --minimal\n# with only CLI\nng add @ngrx/store\n\n```\nCon esto habrs instalado y configurado NgRx y tu `AppModule` tendr algo as:\n\n```typescript\n@NgModule({\n  imports: [\n    CommonModule,\n    RouterModule,\n    StoreModule.forRoot(\n      {},\n      {\n        metaReducers: !environment.production ? [] : [],\n        runtimeChecks: {\n          strictActionImmutability: true,\n          strictStateImmutability: true\n        }\n      }\n    ),\n    EffectsModule.forRoot([])\n  ]\n})\nexport class AppModule {}\n```\n\n> El cdigo generado por cualquiera de los dos schematics no es para todos los gustos. Tmalo como un punto de partida y crea la estructura que mejor te encaje.\n\n## 1.2 DevTools\n\nLa razn principal de usar Redux es la capacidad que da al programador para comprender cmo el estado de sus variables ha variado en el tiempo. Es decir Cmo hemos llegado hasta aqu?. Esta es claramente una cuestin de anlisis y depuracin de cdigo. Y para ello necesitamos herramientas de desarrollador. Presentamos las [**Redux DevTools for Chrome**](https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en).\n\nEste es un plugin que se engancha a cualquier solucin Redux (no slo NgRx, ni siquiera slo Angular) y que permite explorar el valor del estado y lo ms interesante: la secuencia de acciones que se ha despachado y el efecto que cada una tuvo sobre el valor del estado.\n\nPara realizar el enganche sirve la lnea que vers tambin en el `AppModule`. La cual activa la monitorizacin cuando no estamos en produccin. Normal, esto es un herramienta para el desarrollador, nunca para el usuario.\n\n```typescript\n  !environment.production ? StoreDevtoolsModule.instrument() : [],\n```\nPara verlo en funcionamiento tienes que ejecutar y abrir tu app en Chrome. Despus en la pantalla de inspeccin del cdigo aparecer una pestaa al final de todo (ms all de Network y Application...) llamada Redux. La interfaz es muy intuitiva; no tardars en hacerte con ella. aunque ahora mismo un poco pobre...\n\n## 1.3 Router\n\nPara darle algo de contenido y de paso acercarnos a las capacidades de Redux y NgRx vamos a conectarle el `RouterModule` de la aplicacin. Para ello sirve la siguiente lnea que tienes que poner tambin en la importaciones del `AppModule`.\n\n```typescript\n  StoreRouterConnectingModule.forRoot({ routerState: RouterState.Minimal })\n```\n\nA partir de este momento cada evento de navegacin del _router_ va a generar una accin que _NgRx_ recoger y registrar. Esas acciones y su impacto en el estado se pueden visualizar con el plugin de Redux. Podrs ver los cambios y reproducirlos hacia adelante y atrs. Es como viajar en el tiempo dentro de la ejecucin de app.\n\n\n# 2 Actions\n\nHasta el momento ha sido todo muy de infraestructura, pero es hora de que hagamos algo funcional. Un ejemplo sera agregar a nuestra app un mdulo para la gestin de medios de pago de un usuario. Algo as:\n\n```yaml\nAs a: customer,\n  I want: to add payment methods\n  so that: I can pay with them\n\nAs a: customer,\n  I want: to select one as preferred\n  so that: I can make fewer clicks\n\nAs a: customer,\n  I want: to change de expiration date\n  so that: I get my cards up to date\n```\n\nPara ello, y valiendo una vez ms de los schematics vamos a agregar una _feature_\n\n```bash\nng g m payments --project=shop --module=app.module.ts --routing --route=payments\nng g @ngrx/schematics:feature payments/store/paymentMethod --project=shop --module=payments/payments.module.ts --no-flat --no-spec --creators\n```\n\nEsto habr generado un buen montn de cdigo. Pero todo demasiado genrico. Vamos a empezar a adaptarlo a nuestro problema aportando un modelo de datos.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.model.ts`\n\n```typescript\nexport interface PaymentMethod {\n  id: string;\n  expiration: Date;\n}\n\nexport interface PaymentMethods {\n  list: PaymentMethod[];\n  preferred: string;\n}\n```\nY ahora s, vamos a por las acciones.\n\n## 2.1 Create\n\nUno de los parmetros usados durante la generacin de la _feature_ fue `--creators`. Esto le indic a NgRx que preferimos usar funciones en lugar de clases para definir nuestras acciones. As que en el fichero de definicin de acciones te encontrars con llamadas a una funcin como esta `createAction('Descripcin de la accin', props<{ parametro: Tipo }>() )`.\nCon esto tenemos que cubrir los dos requerimientos de Redux: las acciones han de tener un tipo y una _payload_.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.actions.ts`\n\n```typescript\nexport const loadPaymentMethods = createAction(\n  '[PaymentMethod] Load PaymentMethods'\n);\n\nexport const addPaymentMethod = createAction(\n  '[PaymentMethod] Add PaymentMethod',\n  props<{ newPaymentMethod: PaymentMethod }>()\n);\n\nexport const selectPreferredPaymentMethod = createAction(\n  '[PaymentMethod] Select preferred PaymentMethod',\n  props<{ preferredId: string }>()\n);\n\nexport const setExpirationPaymentMethod = createAction(\n  '[PaymentMethod] Set Expiration Date on PaymentMethod',\n  props<{ updatedPaymentMethod: PaymentMethod }>()\n);\n```\n\nEl cdigo puede resultar extrao a primera vista; pero es siempre igual y acabas familiarizando muy rpido. Esencialmente se trata de dar un nombre a la accin y luego configurarla. Lo imprescindible va a ser un string que la describa. Es recomendable seguir el convenio con el formato `[Origen] Nombre accin descriptivo`.\n\nEl segundo argumento de la funcin `creteAction` es a su vez otra funcin. La parte interesante de la funcin `propos<>()` est en su tipo genrico. Es ah dnde definimos el tipo de datos de la _payload_ que puede transportar la accin.\n\n## 2.2 Dispatch\n\nDefinir el catlogo de acciones es la primera parte del problema. Ahora nos toca invocarlas, o como se dice en el argot Redux: despacharlas. Para ello voy a crear un servicio auxiliar que encapsule toda la interaccin con NgRx. Es una implementacin del patrn fachada para unificar y facilitar el trabajo con Redux desde fuera.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.service.ts`\n\n```typescript\nimport { Injectable } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport * as PaymentMethodActions from './payment-method.actions';\nimport { PaymentMethod, PaymentMethods } from './payment-method.model';\n@Injectable({\n  providedIn: 'root'\n})\nexport class PaymentMethodService {\n  constructor(private store: Store<PaymentMethods>) {}\n}\n```\n\nY aqu puedo crear los mtodos funcionales que despachen las acciones sobre el _store_ de NgRx.\n\n```typescript\npublic loadPaymentMethods() {\n  this.store.dispatch(PaymentMethodActions.loadPaymentMethods());\n}\npublic addPaymentMethod(newPaymentMethod: PaymentMethod) {\n    this.store.dispatch(\n      PaymentMethodActions.addPaymentMethod({\n        newPaymentMethod: { ...newPaymentMethod }\n      })\n    );\n  }\npublic selectPreferredPaymentMethod(preferredId: string) {\n  this.store.dispatch(\n    PaymentMethodActions.selectPreferredPaymentMethod({ preferredId })\n  );\n}\npublic setExpirationPaymentMethod(updatedPaymentMethod: PaymentMethod) {\n  this.store.dispatch(\n    PaymentMethodActions.setExpirationPaymentMethod({\n      updatedPaymentMethod: { ...updatedPaymentMethod }\n    })\n  );\n}\n```\n\nEs necesario enviar siempre un clon de los argumentos para desconectarlos del origen. En Redux queremos tener la fuente nica de la verdad, y eso slo es posible si los argumentos que recibimos estn sellados y aislados del resto del mundo.\n\nPara una primera aproximacin, reconozco que es mucho cdigo para tan poca funcionalidad. Claro que para quien use esta fachada el mundo es mucho ms sencillo. Y por dentro es muy potente y controlable.\n\n`apps\\shop\\src\\app\\payments\\payments.component.ts`\n\n```typescript\nexport class PaymentsComponent implements OnInit {\n  constructor(private paymentMethodService: PaymentMethodService) {}\n\n  ngOnInit() {\n    this.paymentMethodService.loadPaymentMethods();\n    const visa: PaymentMethod = {\n      id: '1234 7896 3214 6549',\n      expiration: new Date(2020, 6-1, 30)\n    };\n    this.paymentMethodService.addPaymentMethod(visa);\n    this.paymentMethodService.selectPreferredPaymentMethod(visa.id);\n    visa.expiration = new Date(2021, 12-1, 31);\n    this.paymentMethodService.setExpirationPaymentMethod(visa);\n  }\n}\n```\n\n# 3 State reducer\n\n## 3.1 State\n\nEl estado en *redux* es un objeto tipado a partir de una interfaz, inicialmente llamada `State` a secas, aunque yo prefiero identificarla como `PaymentMethodsState`. Tendr propiedades para almacenar objetos ms o menos complejos. Cada propiedad tendr su propio tipo complejo y necesita un estado inicial. Eso es lo que hace este cdigo:\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts`\n\n```typescript\nexport const paymentMethodFeatureKey = 'paymentMethod';\n\nexport interface PaymentMethodsState {\n  paymentMethods: PaymentMethods;\n}\n\nexport const initialState: PaymentMethodsState = {\n  paymentMethods: { list: [], preferred: null }\n};\n```\n\n## 3.2 Create function\n\nPero todo estado necesita su reductor, y una vez ms lo crearemos mediante una funcin. En este caso es la `createReducer(state, on(action1, function1) )`. Su encarnacin ms bsica tiene la siguiente pinta:\n\n```typescript\nconst paymentMethodReducer = createReducer(\n  initialState,\n  on(PaymentMethodActions.loadPaymentMethods, state => state)\n);\n```\nLo que hace es definir una serie de `hooks` para enganchar funciones de mutacin en respuesta a las acciones despachadas. Empezamos con la accin `loadPaymentMethods` y en este caso no por ahora hacemos ninguna mutacin al estado. Es un reductor transparente e innecesario. Lo pongo para familiarizarnos con la sintaxis.\n\nVamos a algo ms complejo y til como la accin `addPaymentMethod`. Funcionalmente queremos agregar el nuevo mtodo de pago que viene en su carga al array actual de mtodos de pago. Nada complejo, ya s deben ser todas las funciones reductoras.\n\nPero, siempre hay un pero, resulta que **una funcin reductora debe ser tambin una funcin pura**. Y esto nos obliga a mutar el estado sin mutar los argumentos; es decir, nos obliga a clonar el estado y sus propiedades antes de cambiarlas.\n\n```typescript\non(PaymentMethodActions.addPaymentMethod, (state, { newPaymentMethod }) => {\n  return {\n    ...state,\n    paymentMethods: {\n      ...state.paymentMethods,\n      list: [...state.paymentMethods.list, newPaymentMethod]\n    }\n  };\n})\n```\n\nEl proceso de clonado puedes hacerlo con mayor o menor profundidad, pero al menos un clonado superficial del estado es obligatorio. Yo aqu he optado por clonar incluso el array interno, aunque no sea estrictamente obligatorio.\n\n\n## 3.3 Register in Store\n\nEl resultado de esta invocacin a `createReducer()` se ser a su vez otra funcin que yo almacen en la contante `paymentMethodReducer`. Por requerimiento del proceso de empaquetado con `webpack` que nada tiene que ver con NgRx, estamos obligados a exportar la funcin mediante un _wrapper_ como este:\n\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts`\n\n```typescript\nexport function reducer(state: PaymentMethodsState | undefined, action: Action) {\n  return paymentMethodReducer(state, action);\n}\n```\n\nHecho esto tenemos ya una funcin reductora que debemos registrar en el _store_. Lo que hacemos es decirle a NgRx que cuando llegue una accin de mutado invoque a esta accin pasndole la propiedad del estado encargada gestionar.\n\n`apps\\shop\\src\\app\\payments\\payments.module.ts`\n\n```typescript\nimport * as fromPaymentMethod from './store/payment-method/payment-method.reducer';\n@NgModule({\n  imports: [\n    StoreModule.forFeature(\n      fromPaymentMethod.paymentMethodFeatureKey,\n      fromPaymentMethod.reducer\n    )]\n```\n\nNormalmente el nombre de dicha propiedad se estable en una constante exportada para evitar fallos de tecleo con consecuencias imprevisibles.\n\n# 4 Selectors\n\nHasta ahora hemos definido el estado, y creado las acciones que despachamos conta l. Y hemos creado las funciones reductoras que lo modifican al recibir las acciones. No es poco, pero es la mitad del camino. Nos queda enterarnos de los cambios que se ha realizado. Y para eso nos ofrecen un concepto muy de base de datos `select`.\n\n## 4.1 Create selector\n\nLos selectores, mejor dicho las funciones selectoras, se crean mediante una funcin factora igual que hemos visto para las reductoras y las acciones. La diferencia es que aqu las tenemos que llamar a dos niveles: el de la funcionalidad y el de la propiedad especfica que nos interesa.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.selectors.ts`\n\n```typescript\nimport { createFeatureSelector, createSelector } from '@ngrx/store';\nimport { paymentMethodFeatureKey, State } from './payment-method.reducer';\n\nexport const getPaymentMethodState = createFeatureSelector<State>(\n  paymentMethodFeatureKey\n);\n\nexport const getPaymentMethodsList = createSelector(\n  getPaymentMethodState,\n  (state: State) => state.paymentMethods.list\n);\n\nexport const getPreferredPaymentMethod = createSelector(\n  getPaymentMethodState,\n  (state: State) => state.paymentMethods.preferred\n);\n```\n\nPodemos tener tantos selectores como queramos. Se aconseja crearlos para cada tema de inters que pueda tener el resto de la aplicacin. Pueden ser simples vista parciales del estado o complejas transformaciones a gusto del consumidor. NgRx lo hace de forma que optimiza clculos y llamadas as que nos sugieren que abusemos de ellos y encapsulemos aqu todo el acceso al valor y a los cambios del estado.\n\n## 4.2 Selecting data\n\nUna vez ms, si queremos que nuestra aplicacin se desacople lo  ms posible de ngRx, debemos llamar a los selectores desde un servicio fachada. As que aadimos al `apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.service.ts` un par de nuevos mtodos pblicos.\n\n```typescript\n  public getPaymentMethodsList$(): Observable<PaymentMethod[]> {\n    return this.store.select(PaymentMethodSelectors.getPaymentMethodsList);\n  }\n\n  public getPreferredPaymentMethod$(): Observable<string> {\n    return this.store.select(PaymentMethodSelectors.getPreferredPaymentMethod);\n  }\n```\n\n## 4.3 Showing data\n\nEstos mtodos devuelven observables a los que suscribirse para mostrar los valores cambiantes del estado. Gracias a la fachada anterior el componente consumidor es completamente inconsciente de la existencia de NgRx.\n\n```typescript\nexport class PaymentsComponent implements OnInit {\n  public paymentMethodsList$: Observable<PaymentMethod[]>;\n  public preferredPaymentMethod$: Observable<string>;\n  constructor(private paymentMethodService: PaymentMethodService) {}\n\n  ngOnInit() {\n    this.paymentMethodsList$ = this.paymentMethodService.getPaymentMethodsList$();\n    this.preferredPaymentMethod$ = this.paymentMethodService.getPreferredPaymentMethod$();\n  }\n}\n```\n\nPor supuesto, desde la _template_ lo tratamos como a cualquier otro dato asncrono.\n\n```html\n<p>Payment Methods List:</p>\n<pre>{{ paymentMethodsList$ | async | json }}</pre>\n<p>Preferred Payment Method:</p>\n<pre>{{ preferredPaymentMethod$ | async | json }}</pre>\n```\n\n\n# 5 Effects\n\nLas funciones reductoras, como ya se ha dicho, deben ser puras. La idea es que puedan ser auditadas, re-ejecutadas y testeadas sin que necesiten servicios externos ni causen efectos colaterales. Y esto es un problema con la cantidad de **ejecuciones asncronas en las aplicaciones web**. Cualquier tentacin de lanzar una llamada *AJAX* dentro de un reductor debe ser eliminada de inmediato.\n\n> Dos razones: por un lado en Angular se necesita invocar al *httpClient* de alguna manera para realizar la llamada *AJAX*. Y ya que la funcin reductora no pertenece a ninguna clase Angular, no puede haber constructor que reclame la inyeccin de la dependencia a dicho servicio. Tampoco las funciones puras tienen permitido usar nada que no venga entre sus argumentos. Por otra parte las funciones puras han de ser predecibles, y una llamada a un servidor remoto no es en absoluto predecible. Puede pasarle de todo, as que **los reductores no son pas para procesos asncronos**.\n\nLa solucin que proponen *NgRX* es usar un artificio llamado efecto, porque ser encargado de **los efectos secundarios que provocan las las instrucciones asncronas**. De una forma simplista, diremos que las acciones asncronas se multiplicarn por tres. El comando que genera la llamada, y los dos potenciales eventos con la respuesta correcta o el error.\n\nPara manejarlo todo incluyen en la librera el mdulo `EffectsModule` que ha de registrarse junto al `StoreModule`. Desde ese momento *NgRX* activa un sistema de seguimiento que trata las acciones como un stream de *RxJS* y permite subscribirse a la invocacin de dichas acciones y tratarlas adecuadamente.\n\n## 5.1 Install\n\nSegn el proceso que hayas escogido para agregar Ngrx puede que ya tengas los efectos agregados o que tengas que hacerlo manualmente mediante un instruccin como esta:\n\n```bash\nng add @ngrx/effects\n```\nEn cualquier caso aparecer una instruccin de registro en el mdulo raz o funcional que lo necesite. Por ejemplo el de `PaymentsModule` es:\n\n```typescript\nEffectsModule.forFeature([])\n```\n\n## 5.2 Efecto bsico\n\nEn un ejemplo inicial vamos a intentar almacenar y recuperar los mtodos de pago desde el _local storage_ del navegador. Esta es claramente una actividad de riesgo (y no lo dogo slo por el evidente peligro de seguridad). Pero el acceso puede fallar o no estar disponible. Y en el mejor de los casos es un recurso externo que nunca podra ir dentro de una funcin reductora.\n\nAs que vamos a ver el trabajo necesario para montar esto _como Redux manda_.\n\n### Acciones\n\nPara empezar agregamos dos nuevas acciones en respuesta a los potenciales eventos que puedan surgir del acceso al _local storage_\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.actions.ts`\n\n```typescript\nexport const loadPaymentMethods = createAction(\n  '[PaymentMethod] Load Payment Methods'\n);\n\nexport const loadPaymentMethodsSucess = createAction(\n  '[PaymentMethod] Load Payment Methods Success',\n  props<{ paymentMethodList: PaymentMethod[] }>()\n);\n\nexport const loadPaymentMethodsError = createAction(\n  '[PaymentMethod] Load Payment Methods Error'\n);\n```\n\nPara simplificarlo no estoy reportando nada del error especfico. La `loadPaymentMethodsError` servir para indicar que el proceso ha fallado. sin ms.\n\n### Definicin\n\nAhora viene lo bueno. La creacin de un efecto. Empezamos como siempre usando una funcin factora : `createEffect()`. Slo que esta vez va asociada a una propiedad pblica de un servicio de Angular. Y aqu ya tenemos todos nuestros juguetes disponibles.\n\nPor ejemplo la inyeccin de dependencias; en el constructor `constructor(private actions$: Actions) {}` solicitamos como argumento un observable de todas las acciones que se hayan despachado en nuestro `store`. Ese _stream_ servir para escuchar y filtrar las acciones que nos interesen. Despus haremos nuestra operativa con todas las llamadas que hagan falta.\n\nSlo un requisito. Al terminar hemos de retornar un observable con una nueva accin que el sistema encauzar para ser despachada. Esto obliga a conocer bien los operadores _RxJs_ que estn en la base do todo este montaje. De ah el uso `concatMap()` y por supuesto del creador observable ms bsico: `of()`.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.effects.ts`\n\n```typescript\npublic loadPaymentMethods$ = createEffect(() =>\n  this.actions$.pipe(\n    ofType(PaymentMethodActions.loadPaymentMethods),\n    concatMap(() => {\n      try {\n        let storedList = JSON.parse(\n          window.localStorage.getItem(this.storeKey)\n        );\n        if (!storedList) {\n          storedList = initialState.paymentMethods.list;\n          window.localStorage.setItem(\n            this.storeKey,\n            JSON.stringify(storedList)\n          );\n        }\n        return of(\n          PaymentMethodActions.loadPaymentMethodsSucess({\n            paymentMethodList: storedList\n          })\n        );\n      } catch (e) {\n        return of(PaymentMethodActions.loadPaymentMethodsError);\n      }\n    })\n  )\n);\n```\nTmate tu tiempo para entender este efecto, y recuerda que por raro que te parezca al principio, te acabars acostumbrando muy pronto porque siempre sigue el mismo esquema.\n\n### Reducer y Register\n\nPor si te olvidabas, todo este trabajo no altera para nada al estado. Recuerda que slo las reductoras asociadas a las acciones lo hacen. As que incrementamos nuestro cdigo con nuevos casos para el reductor.\n\n`apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts`\n\n```typescript\non(\n    PaymentMethodActions.loadPaymentMethodsSucess,\n    (state, { paymentMethodList }) => {\n      return {\n        ...state,\n        paymentMethods: { ...state.paymentMethods, list: paymentMethodList }\n      };\n    }\n  ),\n  on(PaymentMethodActions.loadPaymentMethodsError, state => state),\n```\n\nY para finalizar registramos la clase que contiene al efecto (como un provider especial) en el mdulo de efectos.\n\n`apps\\shop\\src\\app\\payments\\payments.module.ts`\n\n```typescript\nEffectsModule.forFeature([PaymentMethodEffects])\n```\n\n## 5.3 Api async\n\nUna vez familiarizado con la sintaxis de los efectos bsicos, es hora de pasar a los que sin duda se utilizan ms: los efectos sobre servicios asncronos. Es decir casi todas las llamadas a un API. Algo muy sencillo podra ser agregar a nuestra tienda un converso de divisas para saber los precios en distintas monedas.\n\n```yaml\nAs a: customer,\n  I want: to see the current exchange rate in several currencies\n  so that: I can decide\n```\n\n### Actions\n\nA estas alturas te pido un ltimo esfuerzo para que interpretes el siguiente cdigo:\n\n`apps\\shop\\src\\app\\rates\\store\\exchange-rate\\exchange-rate.actions.ts`\n\n```typescript\nexport const loadExchangeRates = createAction(\n  '[ExchangeRate] Load ExchangeRates'\n);\n\nexport const loadExchangeRatesSuccess = createAction(\n  '[ExchangeRate] Load ExchangeRates Success',\n  props<{ rates: any }>()\n);\n\nexport const loadExchangeRatesError = createAction(\n  '[ExchangeRate] Load ExchangeRates Error',\n  props<{ rates: any }>()\n);\n```\n\n\nEfectivamente, para cada llamada usaremos tres acciones. El comando que la inicia y los dos eventos que pueden ocurrir _success and error_.\n\n### Effect\n\n`apps\\shop\\src\\app\\rates\\store\\exchange-rate\\exchange-rate.effects.ts`\n\n```typescript\nexport class ExchangeRateEffects {\n  public loadExchangeRates$ = createEffect(() =>\n    this.actions$.pipe(\n      ofType(ExchangeRateActions.loadExchangeRates),\n      concatMap(() =>\n        this.http.get<any>('https://api.exchangeratesapi.io/latest').pipe(\n          map(res =>\n            ExchangeRateActions.loadExchangeRatesSuccess({ rates: res.rates })\n          ),\n          catchError(err =>\n            of(ExchangeRateActions.loadExchangeRatesError({ rates: err }))\n          )\n        )))\n  );\n  constructor(private actions$: Actions, private http: HttpClient) {}\n}\n```\n\nParadjicamente un efecto que incluya una llamada _http_ es ms sencillo, pues la naturaleza asncrona de _Ajax_ junto con el uso de _Observables_ en `httpClient` nos dejan medio trabajo hecho.\n\nLo que realmente hacemos es encauzar el flujo de acciones `pipe(concatMap())` hacia un flujo de respuestas _http_ `this.http.get()`. Pero claro esto es trampa, as que de nuevo encauzamos la respuesta hacia una accin `pipe(map(res=> actionSuccess(res)))`. Cuando la respuesta no llega volvemos a lo que ya sabemos, crear un nuevo observable con `of(actionError(err))`.\n\nAqu lo dejamos. Soy consciente de que Redux es complejo. Soy consciente de que NgRx aade mucho cdigo de infraestructura. Pero tambin te animo a revisar este artculo y practicar con un caso sencillo antes de tomar cualquier decisin. Incluir NgRx o no hacerlo tiene un alto impacto en el mantenimiento de tu proyecto. No te tires a de cabeza ni lo rechaces de plano.\n\nDescarga y revisa la aplicacin de ejemplo. Si la dominas, entonces es que ya tienes los conocimientos para gestionar de manera centralizada, auditable y predecible el estado de tus programas. El patrn Redux lucir ms cuanto ms grande y compleja sea tu aplicacin.\n\nContina tu formacin avanzada para crear aplicaciones [PWA, entre la web y las apps con Angular](../pwa-entre-la-web-y-las-apps-con-angular) y vers como aprendes a programar con Angular 8.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"el-patron-redux-con-ngrx-en-angular","published":1,"updated":"2019-10-16T14:23:01.024Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab1g000obss300bzw0u4","content":"<p><img src=\"/images/tutorial-angular-15_ngrx.png\" alt=\"el-patron-redux-con-ngrx-en-angular\"></p><p>Le pasa a todas las aplicaciones, crecen y crecen en funcionalidad y complejidad. En Angular estamos preparados para modularizar, componentizar e inyectar servicios. Pero con grandes aplicaciones, o con grandes equipos, parece que nada es suficiente. Se necesita una <strong>gestin del estado centralizada</strong> como la del <a href=\"(../flujo-reactivo-unidireccional-con-Angular-y-RxJs/)\">patrn Redux</a>.</p><p>Si decamos que <strong>Redux no hace rpido lo simple, sino mantenible lo complejo</strong>, ahora te digo que <strong>NgRx no hace rpido a Redux, sino mantenible su boilerplate.</strong> As que si tienes delante un desarrollo funcionalmente complejo, te recomiendo que uses <em>NgRX</em>; la solucin estndar para implementar <strong>Redux con Angular</strong>.</p><a id=\"more\"></a><p>Partiendo del cdigo tal como qued en <a href=\"../flujo-reactivo-unidireccional-con-Angular-y-RxJs/\">Redux, flujo reactivo unidireccional con Angular y RxJs</a>. Al finalizar tendrs una aplicacin que gestiona centralizadamente los cambios, que permite conocer qu ocurri y predecir lo que ocurrir usando NgRx.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h1 id=\"1-Instalacion-y-configuracion\"><a href=\"#1-Instalacion-y-configuracion\" class=\"headerlink\" title=\"1 Instalacin y configuracin\"></a>1 Instalacin y configuracin</h1><p><strong>NgRx</strong> es el estndar de facto para implementar <em>Redux</em> en Angular. Est basada en <em>RxJS</em> y es una librera modular con todo lo necesario para crear grandes aplicaciones. Esto son los mdulos que la componen:</p><ul><li><strong>store</strong>: Es el mdulo principal con el administrador del estado centralizado y reactivo.</li><li><strong>store-devtools</strong>: Instrumentacin para depurar desde el navegador. Vale su peso en oro.</li><li><strong>router-Store</strong> : Almacena el estado del <em>router</em> de Angular en el <em>store</em>, tratando cada evento como una accin Redux.</li><li><strong>effects</strong>: Los reductores son funciones puras sin efectos colaterales. Este mdulo es la solucin para comandos asncronos.</li><li><strong>schematics, entity, ngrx-data</strong>: Son otros mdulos opcionales con ayudas y plantillas de NgRX.</li></ul><h2 id=\"1-1-Instalacion-de-NgRx\"><a href=\"#1-1-Instalacion-de-NgRx\" class=\"headerlink\" title=\"1.1 Instalacin de NgRx\"></a>1.1 Instalacin de NgRx</h2><p>Para agregar <em>NgRx</em> a un app te propongo que uses los <em>schematics</em> de NxDev pues disponen de ms opciones de configuracin inmediata. Aunque la alternativa con el CLI tambin es suficiente para empezar.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> with Nx.dev tools</span></span><br><span class=\"line\">ng g @nrwl/angular:ngrx app --module=apps/shop/src/app/app.module.ts --root --minimal</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> with only CLI</span></span><br><span class=\"line\">ng add @ngrx/store</span><br></pre></td></tr></table></figure><p>Con esto habrs instalado y configurado NgRx y tu <code>AppModule</code> tendr algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    RouterModule,</span><br><span class=\"line\">    StoreModule.forRoot(</span><br><span class=\"line\">      &#123;&#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        metaReducers: !environment.production ? [] : [],</span><br><span class=\"line\">        runtimeChecks: &#123;</span><br><span class=\"line\">          strictActionImmutability: <span class=\"literal\">true</span>,</span><br><span class=\"line\">          strictStateImmutability: <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ),</span><br><span class=\"line\">    EffectsModule.forRoot([])</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El cdigo generado por cualquiera de los dos schematics no es para todos los gustos. Tmalo como un punto de partida y crea la estructura que mejor te encaje.</p></blockquote><h2 id=\"1-2-DevTools\"><a href=\"#1-2-DevTools\" class=\"headerlink\" title=\"1.2 DevTools\"></a>1.2 DevTools</h2><p>La razn principal de usar Redux es la capacidad que da al programador para comprender cmo el estado de sus variables ha variado en el tiempo. Es decir Cmo hemos llegado hasta aqu?. Esta es claramente una cuestin de anlisis y depuracin de cdigo. Y para ello necesitamos herramientas de desarrollador. Presentamos las <a href=\"https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en\" target=\"_blank\" rel=\"noopener\"><strong>Redux DevTools for Chrome</strong></a>.</p><p>Este es un plugin que se engancha a cualquier solucin Redux (no slo NgRx, ni siquiera slo Angular) y que permite explorar el valor del estado y lo ms interesante: la secuencia de acciones que se ha despachado y el efecto que cada una tuvo sobre el valor del estado.</p><p>Para realizar el enganche sirve la lnea que vers tambin en el <code>AppModule</code>. La cual activa la monitorizacin cuando no estamos en produccin. Normal, esto es un herramienta para el desarrollador, nunca para el usuario.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">!environment.production ? StoreDevtoolsModule.instrument() : [],</span><br></pre></td></tr></table></figure><p>Para verlo en funcionamiento tienes que ejecutar y abrir tu app en Chrome. Despus en la pantalla de inspeccin del cdigo aparecer una pestaa al final de todo (ms all de Network y Application) llamada Redux. La interfaz es muy intuitiva; no tardars en hacerte con ella. aunque ahora mismo un poco pobre</p><h2 id=\"1-3-Router\"><a href=\"#1-3-Router\" class=\"headerlink\" title=\"1.3 Router\"></a>1.3 Router</h2><p>Para darle algo de contenido y de paso acercarnos a las capacidades de Redux y NgRx vamos a conectarle el <code>RouterModule</code> de la aplicacin. Para ello sirve la siguiente lnea que tienes que poner tambin en la importaciones del <code>AppModule</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">StoreRouterConnectingModule.forRoot(&#123; routerState: RouterState.Minimal &#125;)</span><br></pre></td></tr></table></figure><p>A partir de este momento cada evento de navegacin del <em>router</em> va a generar una accin que <em>NgRx</em> recoger y registrar. Esas acciones y su impacto en el estado se pueden visualizar con el plugin de Redux. Podrs ver los cambios y reproducirlos hacia adelante y atrs. Es como viajar en el tiempo dentro de la ejecucin de app.</p><h1 id=\"2-Actions\"><a href=\"#2-Actions\" class=\"headerlink\" title=\"2 Actions\"></a>2 Actions</h1><p>Hasta el momento ha sido todo muy de infraestructura, pero es hora de que hagamos algo funcional. Un ejemplo sera agregar a nuestra app un mdulo para la gestin de medios de pago de un usuario. Algo as:</p><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">add</span> <span class=\"string\">payment</span> <span class=\"string\">methods</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">pay</span> <span class=\"string\">with</span> <span class=\"string\">them</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">select</span> <span class=\"string\">one</span> <span class=\"string\">as</span> <span class=\"string\">preferred</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">make</span> <span class=\"string\">fewer</span> <span class=\"string\">clicks</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">change</span> <span class=\"string\">de</span> <span class=\"string\">expiration</span> <span class=\"string\">date</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">get</span> <span class=\"string\">my</span> <span class=\"string\">cards</span> <span class=\"string\">up</span> <span class=\"string\">to</span> <span class=\"string\">date</span></span><br></pre></td></tr></table></figure><p>Para ello, y valiendo una vez ms de los schematics vamos a agregar una <em>feature</em></p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m payments --project=shop --module=app.module.ts --routing --route=payments</span><br><span class=\"line\">ng g @ngrx/schematics:feature payments/store/paymentMethod --project=shop --module=payments/payments.module.ts --no-flat --no-spec --creators</span><br></pre></td></tr></table></figure><p>Esto habr generado un buen montn de cdigo. Pero todo demasiado genrico. Vamos a empezar a adaptarlo a nuestro problema aportando un modelo de datos.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.model.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> PaymentMethod &#123;</span><br><span class=\"line\">  id: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  expiration: <span class=\"built_in\">Date</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> PaymentMethods &#123;</span><br><span class=\"line\">  list: PaymentMethod[];</span><br><span class=\"line\">  preferred: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y ahora s, vamos a por las acciones.</p><h2 id=\"2-1-Create\"><a href=\"#2-1-Create\" class=\"headerlink\" title=\"2.1 Create\"></a>2.1 Create</h2><p>Uno de los parmetros usados durante la generacin de la <em>feature</em> fue <code>--creators</code>. Esto le indic a NgRx que preferimos usar funciones en lugar de clases para definir nuestras acciones. As que en el fichero de definicin de acciones te encontrars con llamadas a una funcin como esta <code>createAction(&#39;Descripcin de la accin&#39;, props&lt;{ parametro: Tipo }&gt;() )</code>.<br>Con esto tenemos que cubrir los dos requerimientos de Redux: las acciones han de tener un tipo y una <em>payload</em>.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.actions.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadPaymentMethods = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Load PaymentMethods'</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> addPaymentMethod = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Add PaymentMethod'</span>,</span><br><span class=\"line\">  props&lt;&#123; newPaymentMethod: PaymentMethod &#125;&gt;()</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> selectPreferredPaymentMethod = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Select preferred PaymentMethod'</span>,</span><br><span class=\"line\">  props&lt;&#123; preferredId: <span class=\"built_in\">string</span> &#125;&gt;()</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> setExpirationPaymentMethod = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Set Expiration Date on PaymentMethod'</span>,</span><br><span class=\"line\">  props&lt;&#123; updatedPaymentMethod: PaymentMethod &#125;&gt;()</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>El cdigo puede resultar extrao a primera vista; pero es siempre igual y acabas familiarizando muy rpido. Esencialmente se trata de dar un nombre a la accin y luego configurarla. Lo imprescindible va a ser un string que la describa. Es recomendable seguir el convenio con el formato <code>[Origen] Nombre accin descriptivo</code>.</p><p>El segundo argumento de la funcin <code>creteAction</code> es a su vez otra funcin. La parte interesante de la funcin <code>propos&lt;&gt;()</code> est en su tipo genrico. Es ah dnde definimos el tipo de datos de la <em>payload</em> que puede transportar la accin.</p><h2 id=\"2-2-Dispatch\"><a href=\"#2-2-Dispatch\" class=\"headerlink\" title=\"2.2 Dispatch\"></a>2.2 Dispatch</h2><p>Definir el catlogo de acciones es la primera parte del problema. Ahora nos toca invocarlas, o como se dice en el argot Redux: despacharlas. Para ello voy a crear un servicio auxiliar que encapsule toda la interaccin con NgRx. Es una implementacin del patrn fachada para unificar y facilitar el trabajo con Redux desde fuera.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.service.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Injectable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Store &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@ngrx/store'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> * <span class=\"keyword\">as</span> PaymentMethodActions <span class=\"keyword\">from</span> <span class=\"string\">'./payment-method.actions'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; PaymentMethod, PaymentMethods &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./payment-method.model'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> PaymentMethodService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> store: Store&lt;PaymentMethods&gt;</span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y aqu puedo crear los mtodos funcionales que despachen las acciones sobre el <em>store</em> de NgRx.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> loadPaymentMethods() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.store.dispatch(PaymentMethodActions.loadPaymentMethods());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> addPaymentMethod(newPaymentMethod: PaymentMethod) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.store.dispatch(</span><br><span class=\"line\">      PaymentMethodActions.addPaymentMethod(&#123;</span><br><span class=\"line\">        newPaymentMethod: &#123; ...newPaymentMethod &#125;</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> selectPreferredPaymentMethod(preferredId: <span class=\"built_in\">string</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.store.dispatch(</span><br><span class=\"line\">    PaymentMethodActions.selectPreferredPaymentMethod(&#123; preferredId &#125;)</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> setExpirationPaymentMethod(updatedPaymentMethod: PaymentMethod) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.store.dispatch(</span><br><span class=\"line\">    PaymentMethodActions.setExpirationPaymentMethod(&#123;</span><br><span class=\"line\">      updatedPaymentMethod: &#123; ...updatedPaymentMethod &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Es necesario enviar siempre un clon de los argumentos para desconectarlos del origen. En Redux queremos tener la fuente nica de la verdad, y eso slo es posible si los argumentos que recibimos estn sellados y aislados del resto del mundo.</p><p>Para una primera aproximacin, reconozco que es mucho cdigo para tan poca funcionalidad. Claro que para quien use esta fachada el mundo es mucho ms sencillo. Y por dentro es muy potente y controlable.</p><p><code>apps\\shop\\src\\app\\payments\\payments.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> PaymentsComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> paymentMethodService: PaymentMethodService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.paymentMethodService.loadPaymentMethods();</span><br><span class=\"line\">    <span class=\"keyword\">const</span> visa: PaymentMethod = &#123;</span><br><span class=\"line\">      id: <span class=\"string\">'1234 7896 3214 6549'</span>,</span><br><span class=\"line\">      expiration: <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(<span class=\"number\">2020</span>, <span class=\"number\">6</span><span class=\"number\">-1</span>, <span class=\"number\">30</span>)</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.paymentMethodService.addPaymentMethod(visa);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.paymentMethodService.selectPreferredPaymentMethod(visa.id);</span><br><span class=\"line\">    visa.expiration = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(<span class=\"number\">2021</span>, <span class=\"number\">12</span><span class=\"number\">-1</span>, <span class=\"number\">31</span>);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.paymentMethodService.setExpirationPaymentMethod(visa);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"3-State-reducer\"><a href=\"#3-State-reducer\" class=\"headerlink\" title=\"3 State reducer\"></a>3 State reducer</h1><h2 id=\"3-1-State\"><a href=\"#3-1-State\" class=\"headerlink\" title=\"3.1 State\"></a>3.1 State</h2><p>El estado en <em>redux</em> es un objeto tipado a partir de una interfaz, inicialmente llamada <code>State</code> a secas, aunque yo prefiero identificarla como <code>PaymentMethodsState</code>. Tendr propiedades para almacenar objetos ms o menos complejos. Cada propiedad tendr su propio tipo complejo y necesita un estado inicial. Eso es lo que hace este cdigo:</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> paymentMethodFeatureKey = <span class=\"string\">'paymentMethod'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> PaymentMethodsState &#123;</span><br><span class=\"line\">  paymentMethods: PaymentMethods;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> initialState: PaymentMethodsState = &#123;</span><br><span class=\"line\">  paymentMethods: &#123; list: [], preferred: <span class=\"literal\">null</span> &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Create-function\"><a href=\"#3-2-Create-function\" class=\"headerlink\" title=\"3.2 Create function\"></a>3.2 Create function</h2><p>Pero todo estado necesita su reductor, y una vez ms lo crearemos mediante una funcin. En este caso es la <code>createReducer(state, on(action1, function1) )</code>. Su encarnacin ms bsica tiene la siguiente pinta:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> paymentMethodReducer = createReducer(</span><br><span class=\"line\">  initialState,</span><br><span class=\"line\">  on(PaymentMethodActions.loadPaymentMethods, <span class=\"function\"><span class=\"params\">state</span> =&gt;</span> state)</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Lo que hace es definir una serie de <code>hooks</code> para enganchar funciones de mutacin en respuesta a las acciones despachadas. Empezamos con la accin <code>loadPaymentMethods</code> y en este caso no por ahora hacemos ninguna mutacin al estado. Es un reductor transparente e innecesario. Lo pongo para familiarizarnos con la sintaxis.</p><p>Vamos a algo ms complejo y til como la accin <code>addPaymentMethod</code>. Funcionalmente queremos agregar el nuevo mtodo de pago que viene en su carga al array actual de mtodos de pago. Nada complejo, ya s deben ser todas las funciones reductoras.</p><p>Pero, siempre hay un pero, resulta que <strong>una funcin reductora debe ser tambin una funcin pura</strong>. Y esto nos obliga a mutar el estado sin mutar los argumentos; es decir, nos obliga a clonar el estado y sus propiedades antes de cambiarlas.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">on(PaymentMethodActions.addPaymentMethod, <span class=\"function\">(<span class=\"params\">state, &#123; newPaymentMethod &#125;</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    ...state,</span><br><span class=\"line\">    paymentMethods: &#123;</span><br><span class=\"line\">      ...state.paymentMethods,</span><br><span class=\"line\">      list: [...state.paymentMethods.list, newPaymentMethod]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure><p>El proceso de clonado puedes hacerlo con mayor o menor profundidad, pero al menos un clonado superficial del estado es obligatorio. Yo aqu he optado por clonar incluso el array interno, aunque no sea estrictamente obligatorio.</p><h2 id=\"3-3-Register-in-Store\"><a href=\"#3-3-Register-in-Store\" class=\"headerlink\" title=\"3.3 Register in Store\"></a>3.3 Register in Store</h2><p>El resultado de esta invocacin a <code>createReducer()</code> se ser a su vez otra funcin que yo almacen en la contante <code>paymentMethodReducer</code>. Por requerimiento del proceso de empaquetado con <code>webpack</code> que nada tiene que ver con NgRx, estamos obligados a exportar la funcin mediante un <em>wrapper</em> como este:</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">reducer</span>(<span class=\"params\">state: PaymentMethodsState | <span class=\"literal\">undefined</span>, action: Action</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> paymentMethodReducer(state, action);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Hecho esto tenemos ya una funcin reductora que debemos registrar en el <em>store</em>. Lo que hacemos es decirle a NgRx que cuando llegue una accin de mutado invoque a esta accin pasndole la propiedad del estado encargada gestionar.</p><p><code>apps\\shop\\src\\app\\payments\\payments.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> * <span class=\"keyword\">as</span> fromPaymentMethod <span class=\"keyword\">from</span> <span class=\"string\">'./store/payment-method/payment-method.reducer'</span>;</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    StoreModule.forFeature(</span><br><span class=\"line\">      fromPaymentMethod.paymentMethodFeatureKey,</span><br><span class=\"line\">      fromPaymentMethod.reducer</span><br><span class=\"line\">    )]</span><br></pre></td></tr></table></figure><p>Normalmente el nombre de dicha propiedad se estable en una constante exportada para evitar fallos de tecleo con consecuencias imprevisibles.</p><h1 id=\"4-Selectors\"><a href=\"#4-Selectors\" class=\"headerlink\" title=\"4 Selectors\"></a>4 Selectors</h1><p>Hasta ahora hemos definido el estado, y creado las acciones que despachamos conta l. Y hemos creado las funciones reductoras que lo modifican al recibir las acciones. No es poco, pero es la mitad del camino. Nos queda enterarnos de los cambios que se ha realizado. Y para eso nos ofrecen un concepto muy de base de datos <code>select</code>.</p><h2 id=\"4-1-Create-selector\"><a href=\"#4-1-Create-selector\" class=\"headerlink\" title=\"4.1 Create selector\"></a>4.1 Create selector</h2><p>Los selectores, mejor dicho las funciones selectoras, se crean mediante una funcin factora igual que hemos visto para las reductoras y las acciones. La diferencia es que aqu las tenemos que llamar a dos niveles: el de la funcionalidad y el de la propiedad especfica que nos interesa.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.selectors.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createFeatureSelector, createSelector &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@ngrx/store'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; paymentMethodFeatureKey, State &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./payment-method.reducer'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> getPaymentMethodState = createFeatureSelector&lt;State&gt;(</span><br><span class=\"line\">  paymentMethodFeatureKey</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> getPaymentMethodsList = createSelector(</span><br><span class=\"line\">  getPaymentMethodState,</span><br><span class=\"line\">  (state: State) =&gt; state.paymentMethods.list</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> getPreferredPaymentMethod = createSelector(</span><br><span class=\"line\">  getPaymentMethodState,</span><br><span class=\"line\">  (state: State) =&gt; state.paymentMethods.preferred</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Podemos tener tantos selectores como queramos. Se aconseja crearlos para cada tema de inters que pueda tener el resto de la aplicacin. Pueden ser simples vista parciales del estado o complejas transformaciones a gusto del consumidor. NgRx lo hace de forma que optimiza clculos y llamadas as que nos sugieren que abusemos de ellos y encapsulemos aqu todo el acceso al valor y a los cambios del estado.</p><h2 id=\"4-2-Selecting-data\"><a href=\"#4-2-Selecting-data\" class=\"headerlink\" title=\"4.2 Selecting data\"></a>4.2 Selecting data</h2><p>Una vez ms, si queremos que nuestra aplicacin se desacople lo ms posible de ngRx, debemos llamar a los selectores desde un servicio fachada. As que aadimos al <code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.service.ts</code> un par de nuevos mtodos pblicos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> getPaymentMethodsList$(): Observable&lt;PaymentMethod[]&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.store.select(PaymentMethodSelectors.getPaymentMethodsList);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> getPreferredPaymentMethod$(): Observable&lt;<span class=\"built_in\">string</span>&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.store.select(PaymentMethodSelectors.getPreferredPaymentMethod);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"4-3-Showing-data\"><a href=\"#4-3-Showing-data\" class=\"headerlink\" title=\"4.3 Showing data\"></a>4.3 Showing data</h2><p>Estos mtodos devuelven observables a los que suscribirse para mostrar los valores cambiantes del estado. Gracias a la fachada anterior el componente consumidor es completamente inconsciente de la existencia de NgRx.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> PaymentsComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> paymentMethodsList$: Observable&lt;PaymentMethod[]&gt;;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> preferredPaymentMethod$: Observable&lt;<span class=\"built_in\">string</span>&gt;;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> paymentMethodService: PaymentMethodService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.paymentMethodsList$ = <span class=\"keyword\">this</span>.paymentMethodService.getPaymentMethodsList$();</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.preferredPaymentMethod$ = <span class=\"keyword\">this</span>.paymentMethodService.getPreferredPaymentMethod$();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Por supuesto, desde la <em>template</em> lo tratamos como a cualquier otro dato asncrono.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Payment Methods List:<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; paymentMethodsList$ | async | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Preferred Payment Method:<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; preferredPaymentMethod$ | async | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"5-Effects\"><a href=\"#5-Effects\" class=\"headerlink\" title=\"5 Effects\"></a>5 Effects</h1><p>Las funciones reductoras, como ya se ha dicho, deben ser puras. La idea es que puedan ser auditadas, re-ejecutadas y testeadas sin que necesiten servicios externos ni causen efectos colaterales. Y esto es un problema con la cantidad de <strong>ejecuciones asncronas en las aplicaciones web</strong>. Cualquier tentacin de lanzar una llamada <em>AJAX</em> dentro de un reductor debe ser eliminada de inmediato.</p><blockquote><p>Dos razones: por un lado en Angular se necesita invocar al <em>httpClient</em> de alguna manera para realizar la llamada <em>AJAX</em>. Y ya que la funcin reductora no pertenece a ninguna clase Angular, no puede haber constructor que reclame la inyeccin de la dependencia a dicho servicio. Tampoco las funciones puras tienen permitido usar nada que no venga entre sus argumentos. Por otra parte las funciones puras han de ser predecibles, y una llamada a un servidor remoto no es en absoluto predecible. Puede pasarle de todo, as que <strong>los reductores no son pas para procesos asncronos</strong>.</p></blockquote><p>La solucin que proponen <em>NgRX</em> es usar un artificio llamado efecto, porque ser encargado de <strong>los efectos secundarios que provocan las las instrucciones asncronas</strong>. De una forma simplista, diremos que las acciones asncronas se multiplicarn por tres. El comando que genera la llamada, y los dos potenciales eventos con la respuesta correcta o el error.</p><p>Para manejarlo todo incluyen en la librera el mdulo <code>EffectsModule</code> que ha de registrarse junto al <code>StoreModule</code>. Desde ese momento <em>NgRX</em> activa un sistema de seguimiento que trata las acciones como un stream de <em>RxJS</em> y permite subscribirse a la invocacin de dichas acciones y tratarlas adecuadamente.</p><h2 id=\"5-1-Install\"><a href=\"#5-1-Install\" class=\"headerlink\" title=\"5.1 Install\"></a>5.1 Install</h2><p>Segn el proceso que hayas escogido para agregar Ngrx puede que ya tengas los efectos agregados o que tengas que hacerlo manualmente mediante un instruccin como esta:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng add @ngrx/effects</span><br></pre></td></tr></table></figure><p>En cualquier caso aparecer una instruccin de registro en el mdulo raz o funcional que lo necesite. Por ejemplo el de <code>PaymentsModule</code> es:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EffectsModule.forFeature([])</span><br></pre></td></tr></table></figure><h2 id=\"5-2-Efecto-basico\"><a href=\"#5-2-Efecto-basico\" class=\"headerlink\" title=\"5.2 Efecto bsico\"></a>5.2 Efecto bsico</h2><p>En un ejemplo inicial vamos a intentar almacenar y recuperar los mtodos de pago desde el <em>local storage</em> del navegador. Esta es claramente una actividad de riesgo (y no lo dogo slo por el evidente peligro de seguridad). Pero el acceso puede fallar o no estar disponible. Y en el mejor de los casos es un recurso externo que nunca podra ir dentro de una funcin reductora.</p><p>As que vamos a ver el trabajo necesario para montar esto <em>como Redux manda</em>.</p><h3 id=\"Acciones\"><a href=\"#Acciones\" class=\"headerlink\" title=\"Acciones\"></a>Acciones</h3><p>Para empezar agregamos dos nuevas acciones en respuesta a los potenciales eventos que puedan surgir del acceso al <em>local storage</em></p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.actions.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadPaymentMethods = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Load Payment Methods'</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadPaymentMethodsSucess = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Load Payment Methods Success'</span>,</span><br><span class=\"line\">  props&lt;&#123; paymentMethodList: PaymentMethod[] &#125;&gt;()</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadPaymentMethodsError = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Load Payment Methods Error'</span></span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Para simplificarlo no estoy reportando nada del error especfico. La <code>loadPaymentMethodsError</code> servir para indicar que el proceso ha fallado. sin ms.</p><h3 id=\"Definicion\"><a href=\"#Definicion\" class=\"headerlink\" title=\"Definicin\"></a>Definicin</h3><p>Ahora viene lo bueno. La creacin de un efecto. Empezamos como siempre usando una funcin factora : <code>createEffect()</code>. Slo que esta vez va asociada a una propiedad pblica de un servicio de Angular. Y aqu ya tenemos todos nuestros juguetes disponibles.</p><p>Por ejemplo la inyeccin de dependencias; en el constructor <code>constructor(private actions$: Actions) {}</code> solicitamos como argumento un observable de todas las acciones que se hayan despachado en nuestro <code>store</code>. Ese <em>stream</em> servir para escuchar y filtrar las acciones que nos interesen. Despus haremos nuestra operativa con todas las llamadas que hagan falta.</p><p>Slo un requisito. Al terminar hemos de retornar un observable con una nueva accin que el sistema encauzar para ser despachada. Esto obliga a conocer bien los operadores <em>RxJs</em> que estn en la base do todo este montaje. De ah el uso <code>concatMap()</code> y por supuesto del creador observable ms bsico: <code>of()</code>.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.effects.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> loadPaymentMethods$ = createEffect(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">  <span class=\"keyword\">this</span>.actions$.pipe(</span><br><span class=\"line\">    ofType(PaymentMethodActions.loadPaymentMethods),</span><br><span class=\"line\">    concatMap(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> storedList = <span class=\"built_in\">JSON</span>.parse(</span><br><span class=\"line\">          <span class=\"built_in\">window</span>.localStorage.getItem(<span class=\"keyword\">this</span>.storeKey)</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!storedList) &#123;</span><br><span class=\"line\">          storedList = initialState.paymentMethods.list;</span><br><span class=\"line\">          <span class=\"built_in\">window</span>.localStorage.setItem(</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.storeKey,</span><br><span class=\"line\">            <span class=\"built_in\">JSON</span>.stringify(storedList)</span><br><span class=\"line\">          );</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> of(</span><br><span class=\"line\">          PaymentMethodActions.loadPaymentMethodsSucess(&#123;</span><br><span class=\"line\">            paymentMethodList: storedList</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">        );</span><br><span class=\"line\">      &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> of(PaymentMethodActions.loadPaymentMethodsError);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  )</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Tmate tu tiempo para entender este efecto, y recuerda que por raro que te parezca al principio, te acabars acostumbrando muy pronto porque siempre sigue el mismo esquema.</p><h3 id=\"Reducer-y-Register\"><a href=\"#Reducer-y-Register\" class=\"headerlink\" title=\"Reducer y Register\"></a>Reducer y Register</h3><p>Por si te olvidabas, todo este trabajo no altera para nada al estado. Recuerda que slo las reductoras asociadas a las acciones lo hacen. As que incrementamos nuestro cdigo con nuevos casos para el reductor.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">on(</span><br><span class=\"line\">    PaymentMethodActions.loadPaymentMethodsSucess,</span><br><span class=\"line\">    (state, &#123; paymentMethodList &#125;) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">        ...state,</span><br><span class=\"line\">        paymentMethods: &#123; ...state.paymentMethods, list: paymentMethodList &#125;</span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ),</span><br><span class=\"line\">  on(PaymentMethodActions.loadPaymentMethodsError, <span class=\"function\"><span class=\"params\">state</span> =&gt;</span> state),</span><br></pre></td></tr></table></figure><p>Y para finalizar registramos la clase que contiene al efecto (como un provider especial) en el mdulo de efectos.</p><p><code>apps\\shop\\src\\app\\payments\\payments.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EffectsModule.forFeature([PaymentMethodEffects])</span><br></pre></td></tr></table></figure><h2 id=\"5-3-Api-async\"><a href=\"#5-3-Api-async\" class=\"headerlink\" title=\"5.3 Api async\"></a>5.3 Api async</h2><p>Una vez familiarizado con la sintaxis de los efectos bsicos, es hora de pasar a los que sin duda se utilizan ms: los efectos sobre servicios asncronos. Es decir casi todas las llamadas a un API. Algo muy sencillo podra ser agregar a nuestra tienda un converso de divisas para saber los precios en distintas monedas.</p><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">the</span> <span class=\"string\">current</span> <span class=\"string\">exchange</span> <span class=\"string\">rate</span> <span class=\"string\">in</span> <span class=\"string\">several</span> <span class=\"string\">currencies</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">decide</span></span><br></pre></td></tr></table></figure><h3 id=\"Actions\"><a href=\"#Actions\" class=\"headerlink\" title=\"Actions\"></a>Actions</h3><p>A estas alturas te pido un ltimo esfuerzo para que interpretes el siguiente cdigo:</p><p><code>apps\\shop\\src\\app\\rates\\store\\exchange-rate\\exchange-rate.actions.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadExchangeRates = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[ExchangeRate] Load ExchangeRates'</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadExchangeRatesSuccess = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[ExchangeRate] Load ExchangeRates Success'</span>,</span><br><span class=\"line\">  props&lt;&#123; rates: <span class=\"built_in\">any</span> &#125;&gt;()</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadExchangeRatesError = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[ExchangeRate] Load ExchangeRates Error'</span>,</span><br><span class=\"line\">  props&lt;&#123; rates: <span class=\"built_in\">any</span> &#125;&gt;()</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Efectivamente, para cada llamada usaremos tres acciones. El comando que la inicia y los dos eventos que pueden ocurrir <em>success and error</em>.</p><h3 id=\"Effect\"><a href=\"#Effect\" class=\"headerlink\" title=\"Effect\"></a>Effect</h3><p><code>apps\\shop\\src\\app\\rates\\store\\exchange-rate\\exchange-rate.effects.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ExchangeRateEffects &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> loadExchangeRates$ = createEffect(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.actions$.pipe(</span><br><span class=\"line\">      ofType(ExchangeRateActions.loadExchangeRates),</span><br><span class=\"line\">      concatMap(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.http.get&lt;<span class=\"built_in\">any</span>&gt;(<span class=\"string\">'https://api.exchangeratesapi.io/latest'</span>).pipe(</span><br><span class=\"line\">          map(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span></span><br><span class=\"line\">            ExchangeRateActions.loadExchangeRatesSuccess(&#123; rates: res.rates &#125;)</span><br><span class=\"line\">          ),</span><br><span class=\"line\">          catchError(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span></span><br><span class=\"line\">            of(ExchangeRateActions.loadExchangeRatesError(&#123; rates: err &#125;))</span><br><span class=\"line\">          )</span><br><span class=\"line\">        )))</span><br><span class=\"line\">  );</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> actions$: Actions, <span class=\"keyword\">private</span> http: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Paradjicamente un efecto que incluya una llamada <em>http</em> es ms sencillo, pues la naturaleza asncrona de <em>Ajax</em> junto con el uso de <em>Observables</em> en <code>httpClient</code> nos dejan medio trabajo hecho.</p><p>Lo que realmente hacemos es encauzar el flujo de acciones <code>pipe(concatMap())</code> hacia un flujo de respuestas <em>http</em> <code>this.http.get()</code>. Pero claro esto es trampa, as que de nuevo encauzamos la respuesta hacia una accin <code>pipe(map(res=&gt; actionSuccess(res)))</code>. Cuando la respuesta no llega volvemos a lo que ya sabemos, crear un nuevo observable con <code>of(actionError(err))</code>.</p><p>Aqu lo dejamos. Soy consciente de que Redux es complejo. Soy consciente de que NgRx aade mucho cdigo de infraestructura. Pero tambin te animo a revisar este artculo y practicar con un caso sencillo antes de tomar cualquier decisin. Incluir NgRx o no hacerlo tiene un alto impacto en el mantenimiento de tu proyecto. No te tires a de cabeza ni lo rechaces de plano.</p><p>Descarga y revisa la aplicacin de ejemplo. Si la dominas, entonces es que ya tienes los conocimientos para gestionar de manera centralizada, auditable y predecible el estado de tus programas. El patrn Redux lucir ms cuanto ms grande y compleja sea tu aplicacin.</p><p>Contina tu formacin avanzada para crear aplicaciones <a href=\"../pwa-entre-la-web-y-las-apps-con-angular\">PWA, entre la web y las apps con Angular</a> y vers como aprendes a programar con Angular 8.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-15_ngrx.png\" alt=\"el-patron-redux-con-ngrx-en-angular\"></p><p>Le pasa a todas las aplicaciones, crecen y crecen en funcionalidad y complejidad. En Angular estamos preparados para modularizar, componentizar e inyectar servicios. Pero con grandes aplicaciones, o con grandes equipos, parece que nada es suficiente. Se necesita una <strong>gestin del estado centralizada</strong> como la del <a href=\"(../flujo-reactivo-unidireccional-con-Angular-y-RxJs/)\">patrn Redux</a>.</p><p>Si decamos que <strong>Redux no hace rpido lo simple, sino mantenible lo complejo</strong>, ahora te digo que <strong>NgRx no hace rpido a Redux, sino mantenible su boilerplate.</strong> As que si tienes delante un desarrollo funcionalmente complejo, te recomiendo que uses <em>NgRX</em>; la solucin estndar para implementar <strong>Redux con Angular</strong>.</p>","more":"<p>Partiendo del cdigo tal como qued en <a href=\"../flujo-reactivo-unidireccional-con-Angular-y-RxJs/\">Redux, flujo reactivo unidireccional con Angular y RxJs</a>. Al finalizar tendrs una aplicacin que gestiona centralizadamente los cambios, que permite conocer qu ocurri y predecir lo que ocurrir usando NgRx.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h1 id=\"1-Instalacion-y-configuracion\"><a href=\"#1-Instalacion-y-configuracion\" class=\"headerlink\" title=\"1 Instalacin y configuracin\"></a>1 Instalacin y configuracin</h1><p><strong>NgRx</strong> es el estndar de facto para implementar <em>Redux</em> en Angular. Est basada en <em>RxJS</em> y es una librera modular con todo lo necesario para crear grandes aplicaciones. Esto son los mdulos que la componen:</p><ul><li><strong>store</strong>: Es el mdulo principal con el administrador del estado centralizado y reactivo.</li><li><strong>store-devtools</strong>: Instrumentacin para depurar desde el navegador. Vale su peso en oro.</li><li><strong>router-Store</strong> : Almacena el estado del <em>router</em> de Angular en el <em>store</em>, tratando cada evento como una accin Redux.</li><li><strong>effects</strong>: Los reductores son funciones puras sin efectos colaterales. Este mdulo es la solucin para comandos asncronos.</li><li><strong>schematics, entity, ngrx-data</strong>: Son otros mdulos opcionales con ayudas y plantillas de NgRX.</li></ul><h2 id=\"1-1-Instalacion-de-NgRx\"><a href=\"#1-1-Instalacion-de-NgRx\" class=\"headerlink\" title=\"1.1 Instalacin de NgRx\"></a>1.1 Instalacin de NgRx</h2><p>Para agregar <em>NgRx</em> a un app te propongo que uses los <em>schematics</em> de NxDev pues disponen de ms opciones de configuracin inmediata. Aunque la alternativa con el CLI tambin es suficiente para empezar.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> with Nx.dev tools</span></span><br><span class=\"line\">ng g @nrwl/angular:ngrx app --module=apps/shop/src/app/app.module.ts --root --minimal</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> with only CLI</span></span><br><span class=\"line\">ng add @ngrx/store</span><br></pre></td></tr></table></figure><p>Con esto habrs instalado y configurado NgRx y tu <code>AppModule</code> tendr algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    RouterModule,</span><br><span class=\"line\">    StoreModule.forRoot(</span><br><span class=\"line\">      &#123;&#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        metaReducers: !environment.production ? [] : [],</span><br><span class=\"line\">        runtimeChecks: &#123;</span><br><span class=\"line\">          strictActionImmutability: <span class=\"literal\">true</span>,</span><br><span class=\"line\">          strictStateImmutability: <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ),</span><br><span class=\"line\">    EffectsModule.forRoot([])</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El cdigo generado por cualquiera de los dos schematics no es para todos los gustos. Tmalo como un punto de partida y crea la estructura que mejor te encaje.</p></blockquote><h2 id=\"1-2-DevTools\"><a href=\"#1-2-DevTools\" class=\"headerlink\" title=\"1.2 DevTools\"></a>1.2 DevTools</h2><p>La razn principal de usar Redux es la capacidad que da al programador para comprender cmo el estado de sus variables ha variado en el tiempo. Es decir Cmo hemos llegado hasta aqu?. Esta es claramente una cuestin de anlisis y depuracin de cdigo. Y para ello necesitamos herramientas de desarrollador. Presentamos las <a href=\"https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en\" target=\"_blank\" rel=\"noopener\"><strong>Redux DevTools for Chrome</strong></a>.</p><p>Este es un plugin que se engancha a cualquier solucin Redux (no slo NgRx, ni siquiera slo Angular) y que permite explorar el valor del estado y lo ms interesante: la secuencia de acciones que se ha despachado y el efecto que cada una tuvo sobre el valor del estado.</p><p>Para realizar el enganche sirve la lnea que vers tambin en el <code>AppModule</code>. La cual activa la monitorizacin cuando no estamos en produccin. Normal, esto es un herramienta para el desarrollador, nunca para el usuario.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">!environment.production ? StoreDevtoolsModule.instrument() : [],</span><br></pre></td></tr></table></figure><p>Para verlo en funcionamiento tienes que ejecutar y abrir tu app en Chrome. Despus en la pantalla de inspeccin del cdigo aparecer una pestaa al final de todo (ms all de Network y Application) llamada Redux. La interfaz es muy intuitiva; no tardars en hacerte con ella. aunque ahora mismo un poco pobre</p><h2 id=\"1-3-Router\"><a href=\"#1-3-Router\" class=\"headerlink\" title=\"1.3 Router\"></a>1.3 Router</h2><p>Para darle algo de contenido y de paso acercarnos a las capacidades de Redux y NgRx vamos a conectarle el <code>RouterModule</code> de la aplicacin. Para ello sirve la siguiente lnea que tienes que poner tambin en la importaciones del <code>AppModule</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">StoreRouterConnectingModule.forRoot(&#123; routerState: RouterState.Minimal &#125;)</span><br></pre></td></tr></table></figure><p>A partir de este momento cada evento de navegacin del <em>router</em> va a generar una accin que <em>NgRx</em> recoger y registrar. Esas acciones y su impacto en el estado se pueden visualizar con el plugin de Redux. Podrs ver los cambios y reproducirlos hacia adelante y atrs. Es como viajar en el tiempo dentro de la ejecucin de app.</p><h1 id=\"2-Actions\"><a href=\"#2-Actions\" class=\"headerlink\" title=\"2 Actions\"></a>2 Actions</h1><p>Hasta el momento ha sido todo muy de infraestructura, pero es hora de que hagamos algo funcional. Un ejemplo sera agregar a nuestra app un mdulo para la gestin de medios de pago de un usuario. Algo as:</p><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">add</span> <span class=\"string\">payment</span> <span class=\"string\">methods</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">pay</span> <span class=\"string\">with</span> <span class=\"string\">them</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">select</span> <span class=\"string\">one</span> <span class=\"string\">as</span> <span class=\"string\">preferred</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">make</span> <span class=\"string\">fewer</span> <span class=\"string\">clicks</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">change</span> <span class=\"string\">de</span> <span class=\"string\">expiration</span> <span class=\"string\">date</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">get</span> <span class=\"string\">my</span> <span class=\"string\">cards</span> <span class=\"string\">up</span> <span class=\"string\">to</span> <span class=\"string\">date</span></span><br></pre></td></tr></table></figure><p>Para ello, y valiendo una vez ms de los schematics vamos a agregar una <em>feature</em></p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m payments --project=shop --module=app.module.ts --routing --route=payments</span><br><span class=\"line\">ng g @ngrx/schematics:feature payments/store/paymentMethod --project=shop --module=payments/payments.module.ts --no-flat --no-spec --creators</span><br></pre></td></tr></table></figure><p>Esto habr generado un buen montn de cdigo. Pero todo demasiado genrico. Vamos a empezar a adaptarlo a nuestro problema aportando un modelo de datos.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.model.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> PaymentMethod &#123;</span><br><span class=\"line\">  id: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  expiration: <span class=\"built_in\">Date</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> PaymentMethods &#123;</span><br><span class=\"line\">  list: PaymentMethod[];</span><br><span class=\"line\">  preferred: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y ahora s, vamos a por las acciones.</p><h2 id=\"2-1-Create\"><a href=\"#2-1-Create\" class=\"headerlink\" title=\"2.1 Create\"></a>2.1 Create</h2><p>Uno de los parmetros usados durante la generacin de la <em>feature</em> fue <code>--creators</code>. Esto le indic a NgRx que preferimos usar funciones en lugar de clases para definir nuestras acciones. As que en el fichero de definicin de acciones te encontrars con llamadas a una funcin como esta <code>createAction(&#39;Descripcin de la accin&#39;, props&lt;{ parametro: Tipo }&gt;() )</code>.<br>Con esto tenemos que cubrir los dos requerimientos de Redux: las acciones han de tener un tipo y una <em>payload</em>.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.actions.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadPaymentMethods = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Load PaymentMethods'</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> addPaymentMethod = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Add PaymentMethod'</span>,</span><br><span class=\"line\">  props&lt;&#123; newPaymentMethod: PaymentMethod &#125;&gt;()</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> selectPreferredPaymentMethod = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Select preferred PaymentMethod'</span>,</span><br><span class=\"line\">  props&lt;&#123; preferredId: <span class=\"built_in\">string</span> &#125;&gt;()</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> setExpirationPaymentMethod = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Set Expiration Date on PaymentMethod'</span>,</span><br><span class=\"line\">  props&lt;&#123; updatedPaymentMethod: PaymentMethod &#125;&gt;()</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>El cdigo puede resultar extrao a primera vista; pero es siempre igual y acabas familiarizando muy rpido. Esencialmente se trata de dar un nombre a la accin y luego configurarla. Lo imprescindible va a ser un string que la describa. Es recomendable seguir el convenio con el formato <code>[Origen] Nombre accin descriptivo</code>.</p><p>El segundo argumento de la funcin <code>creteAction</code> es a su vez otra funcin. La parte interesante de la funcin <code>propos&lt;&gt;()</code> est en su tipo genrico. Es ah dnde definimos el tipo de datos de la <em>payload</em> que puede transportar la accin.</p><h2 id=\"2-2-Dispatch\"><a href=\"#2-2-Dispatch\" class=\"headerlink\" title=\"2.2 Dispatch\"></a>2.2 Dispatch</h2><p>Definir el catlogo de acciones es la primera parte del problema. Ahora nos toca invocarlas, o como se dice en el argot Redux: despacharlas. Para ello voy a crear un servicio auxiliar que encapsule toda la interaccin con NgRx. Es una implementacin del patrn fachada para unificar y facilitar el trabajo con Redux desde fuera.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.service.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Injectable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Store &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@ngrx/store'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> * <span class=\"keyword\">as</span> PaymentMethodActions <span class=\"keyword\">from</span> <span class=\"string\">'./payment-method.actions'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; PaymentMethod, PaymentMethods &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./payment-method.model'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> PaymentMethodService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> store: Store&lt;PaymentMethods&gt;</span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y aqu puedo crear los mtodos funcionales que despachen las acciones sobre el <em>store</em> de NgRx.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> loadPaymentMethods() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.store.dispatch(PaymentMethodActions.loadPaymentMethods());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> addPaymentMethod(newPaymentMethod: PaymentMethod) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.store.dispatch(</span><br><span class=\"line\">      PaymentMethodActions.addPaymentMethod(&#123;</span><br><span class=\"line\">        newPaymentMethod: &#123; ...newPaymentMethod &#125;</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> selectPreferredPaymentMethod(preferredId: <span class=\"built_in\">string</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.store.dispatch(</span><br><span class=\"line\">    PaymentMethodActions.selectPreferredPaymentMethod(&#123; preferredId &#125;)</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> setExpirationPaymentMethod(updatedPaymentMethod: PaymentMethod) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.store.dispatch(</span><br><span class=\"line\">    PaymentMethodActions.setExpirationPaymentMethod(&#123;</span><br><span class=\"line\">      updatedPaymentMethod: &#123; ...updatedPaymentMethod &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Es necesario enviar siempre un clon de los argumentos para desconectarlos del origen. En Redux queremos tener la fuente nica de la verdad, y eso slo es posible si los argumentos que recibimos estn sellados y aislados del resto del mundo.</p><p>Para una primera aproximacin, reconozco que es mucho cdigo para tan poca funcionalidad. Claro que para quien use esta fachada el mundo es mucho ms sencillo. Y por dentro es muy potente y controlable.</p><p><code>apps\\shop\\src\\app\\payments\\payments.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> PaymentsComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> paymentMethodService: PaymentMethodService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.paymentMethodService.loadPaymentMethods();</span><br><span class=\"line\">    <span class=\"keyword\">const</span> visa: PaymentMethod = &#123;</span><br><span class=\"line\">      id: <span class=\"string\">'1234 7896 3214 6549'</span>,</span><br><span class=\"line\">      expiration: <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(<span class=\"number\">2020</span>, <span class=\"number\">6</span><span class=\"number\">-1</span>, <span class=\"number\">30</span>)</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.paymentMethodService.addPaymentMethod(visa);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.paymentMethodService.selectPreferredPaymentMethod(visa.id);</span><br><span class=\"line\">    visa.expiration = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(<span class=\"number\">2021</span>, <span class=\"number\">12</span><span class=\"number\">-1</span>, <span class=\"number\">31</span>);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.paymentMethodService.setExpirationPaymentMethod(visa);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"3-State-reducer\"><a href=\"#3-State-reducer\" class=\"headerlink\" title=\"3 State reducer\"></a>3 State reducer</h1><h2 id=\"3-1-State\"><a href=\"#3-1-State\" class=\"headerlink\" title=\"3.1 State\"></a>3.1 State</h2><p>El estado en <em>redux</em> es un objeto tipado a partir de una interfaz, inicialmente llamada <code>State</code> a secas, aunque yo prefiero identificarla como <code>PaymentMethodsState</code>. Tendr propiedades para almacenar objetos ms o menos complejos. Cada propiedad tendr su propio tipo complejo y necesita un estado inicial. Eso es lo que hace este cdigo:</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> paymentMethodFeatureKey = <span class=\"string\">'paymentMethod'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> PaymentMethodsState &#123;</span><br><span class=\"line\">  paymentMethods: PaymentMethods;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> initialState: PaymentMethodsState = &#123;</span><br><span class=\"line\">  paymentMethods: &#123; list: [], preferred: <span class=\"literal\">null</span> &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Create-function\"><a href=\"#3-2-Create-function\" class=\"headerlink\" title=\"3.2 Create function\"></a>3.2 Create function</h2><p>Pero todo estado necesita su reductor, y una vez ms lo crearemos mediante una funcin. En este caso es la <code>createReducer(state, on(action1, function1) )</code>. Su encarnacin ms bsica tiene la siguiente pinta:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> paymentMethodReducer = createReducer(</span><br><span class=\"line\">  initialState,</span><br><span class=\"line\">  on(PaymentMethodActions.loadPaymentMethods, <span class=\"function\"><span class=\"params\">state</span> =&gt;</span> state)</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Lo que hace es definir una serie de <code>hooks</code> para enganchar funciones de mutacin en respuesta a las acciones despachadas. Empezamos con la accin <code>loadPaymentMethods</code> y en este caso no por ahora hacemos ninguna mutacin al estado. Es un reductor transparente e innecesario. Lo pongo para familiarizarnos con la sintaxis.</p><p>Vamos a algo ms complejo y til como la accin <code>addPaymentMethod</code>. Funcionalmente queremos agregar el nuevo mtodo de pago que viene en su carga al array actual de mtodos de pago. Nada complejo, ya s deben ser todas las funciones reductoras.</p><p>Pero, siempre hay un pero, resulta que <strong>una funcin reductora debe ser tambin una funcin pura</strong>. Y esto nos obliga a mutar el estado sin mutar los argumentos; es decir, nos obliga a clonar el estado y sus propiedades antes de cambiarlas.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">on(PaymentMethodActions.addPaymentMethod, <span class=\"function\">(<span class=\"params\">state, &#123; newPaymentMethod &#125;</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    ...state,</span><br><span class=\"line\">    paymentMethods: &#123;</span><br><span class=\"line\">      ...state.paymentMethods,</span><br><span class=\"line\">      list: [...state.paymentMethods.list, newPaymentMethod]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure><p>El proceso de clonado puedes hacerlo con mayor o menor profundidad, pero al menos un clonado superficial del estado es obligatorio. Yo aqu he optado por clonar incluso el array interno, aunque no sea estrictamente obligatorio.</p><h2 id=\"3-3-Register-in-Store\"><a href=\"#3-3-Register-in-Store\" class=\"headerlink\" title=\"3.3 Register in Store\"></a>3.3 Register in Store</h2><p>El resultado de esta invocacin a <code>createReducer()</code> se ser a su vez otra funcin que yo almacen en la contante <code>paymentMethodReducer</code>. Por requerimiento del proceso de empaquetado con <code>webpack</code> que nada tiene que ver con NgRx, estamos obligados a exportar la funcin mediante un <em>wrapper</em> como este:</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">reducer</span>(<span class=\"params\">state: PaymentMethodsState | <span class=\"literal\">undefined</span>, action: Action</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> paymentMethodReducer(state, action);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Hecho esto tenemos ya una funcin reductora que debemos registrar en el <em>store</em>. Lo que hacemos es decirle a NgRx que cuando llegue una accin de mutado invoque a esta accin pasndole la propiedad del estado encargada gestionar.</p><p><code>apps\\shop\\src\\app\\payments\\payments.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> * <span class=\"keyword\">as</span> fromPaymentMethod <span class=\"keyword\">from</span> <span class=\"string\">'./store/payment-method/payment-method.reducer'</span>;</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    StoreModule.forFeature(</span><br><span class=\"line\">      fromPaymentMethod.paymentMethodFeatureKey,</span><br><span class=\"line\">      fromPaymentMethod.reducer</span><br><span class=\"line\">    )]</span><br></pre></td></tr></table></figure><p>Normalmente el nombre de dicha propiedad se estable en una constante exportada para evitar fallos de tecleo con consecuencias imprevisibles.</p><h1 id=\"4-Selectors\"><a href=\"#4-Selectors\" class=\"headerlink\" title=\"4 Selectors\"></a>4 Selectors</h1><p>Hasta ahora hemos definido el estado, y creado las acciones que despachamos conta l. Y hemos creado las funciones reductoras que lo modifican al recibir las acciones. No es poco, pero es la mitad del camino. Nos queda enterarnos de los cambios que se ha realizado. Y para eso nos ofrecen un concepto muy de base de datos <code>select</code>.</p><h2 id=\"4-1-Create-selector\"><a href=\"#4-1-Create-selector\" class=\"headerlink\" title=\"4.1 Create selector\"></a>4.1 Create selector</h2><p>Los selectores, mejor dicho las funciones selectoras, se crean mediante una funcin factora igual que hemos visto para las reductoras y las acciones. La diferencia es que aqu las tenemos que llamar a dos niveles: el de la funcionalidad y el de la propiedad especfica que nos interesa.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.selectors.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createFeatureSelector, createSelector &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@ngrx/store'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; paymentMethodFeatureKey, State &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./payment-method.reducer'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> getPaymentMethodState = createFeatureSelector&lt;State&gt;(</span><br><span class=\"line\">  paymentMethodFeatureKey</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> getPaymentMethodsList = createSelector(</span><br><span class=\"line\">  getPaymentMethodState,</span><br><span class=\"line\">  (state: State) =&gt; state.paymentMethods.list</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> getPreferredPaymentMethod = createSelector(</span><br><span class=\"line\">  getPaymentMethodState,</span><br><span class=\"line\">  (state: State) =&gt; state.paymentMethods.preferred</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Podemos tener tantos selectores como queramos. Se aconseja crearlos para cada tema de inters que pueda tener el resto de la aplicacin. Pueden ser simples vista parciales del estado o complejas transformaciones a gusto del consumidor. NgRx lo hace de forma que optimiza clculos y llamadas as que nos sugieren que abusemos de ellos y encapsulemos aqu todo el acceso al valor y a los cambios del estado.</p><h2 id=\"4-2-Selecting-data\"><a href=\"#4-2-Selecting-data\" class=\"headerlink\" title=\"4.2 Selecting data\"></a>4.2 Selecting data</h2><p>Una vez ms, si queremos que nuestra aplicacin se desacople lo ms posible de ngRx, debemos llamar a los selectores desde un servicio fachada. As que aadimos al <code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.service.ts</code> un par de nuevos mtodos pblicos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> getPaymentMethodsList$(): Observable&lt;PaymentMethod[]&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.store.select(PaymentMethodSelectors.getPaymentMethodsList);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> getPreferredPaymentMethod$(): Observable&lt;<span class=\"built_in\">string</span>&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.store.select(PaymentMethodSelectors.getPreferredPaymentMethod);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"4-3-Showing-data\"><a href=\"#4-3-Showing-data\" class=\"headerlink\" title=\"4.3 Showing data\"></a>4.3 Showing data</h2><p>Estos mtodos devuelven observables a los que suscribirse para mostrar los valores cambiantes del estado. Gracias a la fachada anterior el componente consumidor es completamente inconsciente de la existencia de NgRx.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> PaymentsComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> paymentMethodsList$: Observable&lt;PaymentMethod[]&gt;;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> preferredPaymentMethod$: Observable&lt;<span class=\"built_in\">string</span>&gt;;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> paymentMethodService: PaymentMethodService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.paymentMethodsList$ = <span class=\"keyword\">this</span>.paymentMethodService.getPaymentMethodsList$();</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.preferredPaymentMethod$ = <span class=\"keyword\">this</span>.paymentMethodService.getPreferredPaymentMethod$();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Por supuesto, desde la <em>template</em> lo tratamos como a cualquier otro dato asncrono.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Payment Methods List:<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; paymentMethodsList$ | async | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Preferred Payment Method:<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; preferredPaymentMethod$ | async | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"5-Effects\"><a href=\"#5-Effects\" class=\"headerlink\" title=\"5 Effects\"></a>5 Effects</h1><p>Las funciones reductoras, como ya se ha dicho, deben ser puras. La idea es que puedan ser auditadas, re-ejecutadas y testeadas sin que necesiten servicios externos ni causen efectos colaterales. Y esto es un problema con la cantidad de <strong>ejecuciones asncronas en las aplicaciones web</strong>. Cualquier tentacin de lanzar una llamada <em>AJAX</em> dentro de un reductor debe ser eliminada de inmediato.</p><blockquote><p>Dos razones: por un lado en Angular se necesita invocar al <em>httpClient</em> de alguna manera para realizar la llamada <em>AJAX</em>. Y ya que la funcin reductora no pertenece a ninguna clase Angular, no puede haber constructor que reclame la inyeccin de la dependencia a dicho servicio. Tampoco las funciones puras tienen permitido usar nada que no venga entre sus argumentos. Por otra parte las funciones puras han de ser predecibles, y una llamada a un servidor remoto no es en absoluto predecible. Puede pasarle de todo, as que <strong>los reductores no son pas para procesos asncronos</strong>.</p></blockquote><p>La solucin que proponen <em>NgRX</em> es usar un artificio llamado efecto, porque ser encargado de <strong>los efectos secundarios que provocan las las instrucciones asncronas</strong>. De una forma simplista, diremos que las acciones asncronas se multiplicarn por tres. El comando que genera la llamada, y los dos potenciales eventos con la respuesta correcta o el error.</p><p>Para manejarlo todo incluyen en la librera el mdulo <code>EffectsModule</code> que ha de registrarse junto al <code>StoreModule</code>. Desde ese momento <em>NgRX</em> activa un sistema de seguimiento que trata las acciones como un stream de <em>RxJS</em> y permite subscribirse a la invocacin de dichas acciones y tratarlas adecuadamente.</p><h2 id=\"5-1-Install\"><a href=\"#5-1-Install\" class=\"headerlink\" title=\"5.1 Install\"></a>5.1 Install</h2><p>Segn el proceso que hayas escogido para agregar Ngrx puede que ya tengas los efectos agregados o que tengas que hacerlo manualmente mediante un instruccin como esta:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng add @ngrx/effects</span><br></pre></td></tr></table></figure><p>En cualquier caso aparecer una instruccin de registro en el mdulo raz o funcional que lo necesite. Por ejemplo el de <code>PaymentsModule</code> es:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EffectsModule.forFeature([])</span><br></pre></td></tr></table></figure><h2 id=\"5-2-Efecto-basico\"><a href=\"#5-2-Efecto-basico\" class=\"headerlink\" title=\"5.2 Efecto bsico\"></a>5.2 Efecto bsico</h2><p>En un ejemplo inicial vamos a intentar almacenar y recuperar los mtodos de pago desde el <em>local storage</em> del navegador. Esta es claramente una actividad de riesgo (y no lo dogo slo por el evidente peligro de seguridad). Pero el acceso puede fallar o no estar disponible. Y en el mejor de los casos es un recurso externo que nunca podra ir dentro de una funcin reductora.</p><p>As que vamos a ver el trabajo necesario para montar esto <em>como Redux manda</em>.</p><h3 id=\"Acciones\"><a href=\"#Acciones\" class=\"headerlink\" title=\"Acciones\"></a>Acciones</h3><p>Para empezar agregamos dos nuevas acciones en respuesta a los potenciales eventos que puedan surgir del acceso al <em>local storage</em></p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.actions.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadPaymentMethods = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Load Payment Methods'</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadPaymentMethodsSucess = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Load Payment Methods Success'</span>,</span><br><span class=\"line\">  props&lt;&#123; paymentMethodList: PaymentMethod[] &#125;&gt;()</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadPaymentMethodsError = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[PaymentMethod] Load Payment Methods Error'</span></span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Para simplificarlo no estoy reportando nada del error especfico. La <code>loadPaymentMethodsError</code> servir para indicar que el proceso ha fallado. sin ms.</p><h3 id=\"Definicion\"><a href=\"#Definicion\" class=\"headerlink\" title=\"Definicin\"></a>Definicin</h3><p>Ahora viene lo bueno. La creacin de un efecto. Empezamos como siempre usando una funcin factora : <code>createEffect()</code>. Slo que esta vez va asociada a una propiedad pblica de un servicio de Angular. Y aqu ya tenemos todos nuestros juguetes disponibles.</p><p>Por ejemplo la inyeccin de dependencias; en el constructor <code>constructor(private actions$: Actions) {}</code> solicitamos como argumento un observable de todas las acciones que se hayan despachado en nuestro <code>store</code>. Ese <em>stream</em> servir para escuchar y filtrar las acciones que nos interesen. Despus haremos nuestra operativa con todas las llamadas que hagan falta.</p><p>Slo un requisito. Al terminar hemos de retornar un observable con una nueva accin que el sistema encauzar para ser despachada. Esto obliga a conocer bien los operadores <em>RxJs</em> que estn en la base do todo este montaje. De ah el uso <code>concatMap()</code> y por supuesto del creador observable ms bsico: <code>of()</code>.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.effects.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> loadPaymentMethods$ = createEffect(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">  <span class=\"keyword\">this</span>.actions$.pipe(</span><br><span class=\"line\">    ofType(PaymentMethodActions.loadPaymentMethods),</span><br><span class=\"line\">    concatMap(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> storedList = <span class=\"built_in\">JSON</span>.parse(</span><br><span class=\"line\">          <span class=\"built_in\">window</span>.localStorage.getItem(<span class=\"keyword\">this</span>.storeKey)</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!storedList) &#123;</span><br><span class=\"line\">          storedList = initialState.paymentMethods.list;</span><br><span class=\"line\">          <span class=\"built_in\">window</span>.localStorage.setItem(</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.storeKey,</span><br><span class=\"line\">            <span class=\"built_in\">JSON</span>.stringify(storedList)</span><br><span class=\"line\">          );</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> of(</span><br><span class=\"line\">          PaymentMethodActions.loadPaymentMethodsSucess(&#123;</span><br><span class=\"line\">            paymentMethodList: storedList</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">        );</span><br><span class=\"line\">      &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> of(PaymentMethodActions.loadPaymentMethodsError);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  )</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Tmate tu tiempo para entender este efecto, y recuerda que por raro que te parezca al principio, te acabars acostumbrando muy pronto porque siempre sigue el mismo esquema.</p><h3 id=\"Reducer-y-Register\"><a href=\"#Reducer-y-Register\" class=\"headerlink\" title=\"Reducer y Register\"></a>Reducer y Register</h3><p>Por si te olvidabas, todo este trabajo no altera para nada al estado. Recuerda que slo las reductoras asociadas a las acciones lo hacen. As que incrementamos nuestro cdigo con nuevos casos para el reductor.</p><p><code>apps\\shop\\src\\app\\payments\\store\\payment-method\\payment-method.reducer.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">on(</span><br><span class=\"line\">    PaymentMethodActions.loadPaymentMethodsSucess,</span><br><span class=\"line\">    (state, &#123; paymentMethodList &#125;) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">        ...state,</span><br><span class=\"line\">        paymentMethods: &#123; ...state.paymentMethods, list: paymentMethodList &#125;</span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ),</span><br><span class=\"line\">  on(PaymentMethodActions.loadPaymentMethodsError, <span class=\"function\"><span class=\"params\">state</span> =&gt;</span> state),</span><br></pre></td></tr></table></figure><p>Y para finalizar registramos la clase que contiene al efecto (como un provider especial) en el mdulo de efectos.</p><p><code>apps\\shop\\src\\app\\payments\\payments.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EffectsModule.forFeature([PaymentMethodEffects])</span><br></pre></td></tr></table></figure><h2 id=\"5-3-Api-async\"><a href=\"#5-3-Api-async\" class=\"headerlink\" title=\"5.3 Api async\"></a>5.3 Api async</h2><p>Una vez familiarizado con la sintaxis de los efectos bsicos, es hora de pasar a los que sin duda se utilizan ms: los efectos sobre servicios asncronos. Es decir casi todas las llamadas a un API. Algo muy sencillo podra ser agregar a nuestra tienda un converso de divisas para saber los precios en distintas monedas.</p><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">As</span> <span class=\"attr\">a:</span> <span class=\"string\">customer,</span></span><br><span class=\"line\">  <span class=\"string\">I</span> <span class=\"attr\">want:</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">the</span> <span class=\"string\">current</span> <span class=\"string\">exchange</span> <span class=\"string\">rate</span> <span class=\"string\">in</span> <span class=\"string\">several</span> <span class=\"string\">currencies</span></span><br><span class=\"line\">  <span class=\"string\">so</span> <span class=\"attr\">that:</span> <span class=\"string\">I</span> <span class=\"string\">can</span> <span class=\"string\">decide</span></span><br></pre></td></tr></table></figure><h3 id=\"Actions\"><a href=\"#Actions\" class=\"headerlink\" title=\"Actions\"></a>Actions</h3><p>A estas alturas te pido un ltimo esfuerzo para que interpretes el siguiente cdigo:</p><p><code>apps\\shop\\src\\app\\rates\\store\\exchange-rate\\exchange-rate.actions.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadExchangeRates = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[ExchangeRate] Load ExchangeRates'</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadExchangeRatesSuccess = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[ExchangeRate] Load ExchangeRates Success'</span>,</span><br><span class=\"line\">  props&lt;&#123; rates: <span class=\"built_in\">any</span> &#125;&gt;()</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> loadExchangeRatesError = createAction(</span><br><span class=\"line\">  <span class=\"string\">'[ExchangeRate] Load ExchangeRates Error'</span>,</span><br><span class=\"line\">  props&lt;&#123; rates: <span class=\"built_in\">any</span> &#125;&gt;()</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Efectivamente, para cada llamada usaremos tres acciones. El comando que la inicia y los dos eventos que pueden ocurrir <em>success and error</em>.</p><h3 id=\"Effect\"><a href=\"#Effect\" class=\"headerlink\" title=\"Effect\"></a>Effect</h3><p><code>apps\\shop\\src\\app\\rates\\store\\exchange-rate\\exchange-rate.effects.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ExchangeRateEffects &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> loadExchangeRates$ = createEffect(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.actions$.pipe(</span><br><span class=\"line\">      ofType(ExchangeRateActions.loadExchangeRates),</span><br><span class=\"line\">      concatMap(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.http.get&lt;<span class=\"built_in\">any</span>&gt;(<span class=\"string\">'https://api.exchangeratesapi.io/latest'</span>).pipe(</span><br><span class=\"line\">          map(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span></span><br><span class=\"line\">            ExchangeRateActions.loadExchangeRatesSuccess(&#123; rates: res.rates &#125;)</span><br><span class=\"line\">          ),</span><br><span class=\"line\">          catchError(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span></span><br><span class=\"line\">            of(ExchangeRateActions.loadExchangeRatesError(&#123; rates: err &#125;))</span><br><span class=\"line\">          )</span><br><span class=\"line\">        )))</span><br><span class=\"line\">  );</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> actions$: Actions, <span class=\"keyword\">private</span> http: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Paradjicamente un efecto que incluya una llamada <em>http</em> es ms sencillo, pues la naturaleza asncrona de <em>Ajax</em> junto con el uso de <em>Observables</em> en <code>httpClient</code> nos dejan medio trabajo hecho.</p><p>Lo que realmente hacemos es encauzar el flujo de acciones <code>pipe(concatMap())</code> hacia un flujo de respuestas <em>http</em> <code>this.http.get()</code>. Pero claro esto es trampa, as que de nuevo encauzamos la respuesta hacia una accin <code>pipe(map(res=&gt; actionSuccess(res)))</code>. Cuando la respuesta no llega volvemos a lo que ya sabemos, crear un nuevo observable con <code>of(actionError(err))</code>.</p><p>Aqu lo dejamos. Soy consciente de que Redux es complejo. Soy consciente de que NgRx aade mucho cdigo de infraestructura. Pero tambin te animo a revisar este artculo y practicar con un caso sencillo antes de tomar cualquier decisin. Incluir NgRx o no hacerlo tiene un alto impacto en el mantenimiento de tu proyecto. No te tires a de cabeza ni lo rechaces de plano.</p><p>Descarga y revisa la aplicacin de ejemplo. Si la dominas, entonces es que ya tienes los conocimientos para gestionar de manera centralizada, auditable y predecible el estado de tus programas. El patrn Redux lucir ms cuanto ms grande y compleja sea tu aplicacin.</p><p>Contina tu formacin avanzada para crear aplicaciones <a href=\"../pwa-entre-la-web-y-las-apps-con-angular\">PWA, entre la web y las apps con Angular</a> y vers como aprendes a programar con Angular 8.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Velocidad y SEO con el SSR de Angular Universal","date":"2019-10-09T11:50:27.000Z","thumbnail":"/css/images/angular-17_ssr.png","_content":"\n![velocidad-y-seo-con-el-ssr-de-angular-universal](/images/tutorial-angular-17_ssr.png)\n\nLas *SPA JavaScript*, muy balanceadas hacia el navegador, nacieron para **crear con tecnologa web aplicaciones de negocio**. Normalmente se desplegaban en *intranets*, o en internet para usuarios autorizados. Eran aplicaciones de uso intensivo, visita recurrente y alto rendimiento diario. El xito tecnolgico de *frameworks* como Angular las llev a ser usadas para desarrollar webs clsicas de internet y ser utilizadas por visitantes ocasionales.\n\nPero en esta situacin presentaron dos problemas para los que inicialmente no estaban preparadas. Por un lado la primera visita de un humano obligaba a la descarga completa de la aplicacin antes de poder ver nada. Y nada era lo que vean los visitantes robticos que pretendan indexar un sitio. Las soluciones a estos problemas incluyen, entre otras medidas, **una vuelta al servidor**. Lo que en Angular se conoce como **aplicacin universal**.\n\n\n<!-- more -->\n\nPartiendo del cdigo tal como qued en [PWA, Entre la web y las apps con Angular](../pwa-entre-la-web-y-las-apps-con-angular/). Al finalizar tendrs una aplicacin que  ofrece lo que buscan tanto a personas como a robots.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n# 1 Angular Universal\n\n## 1.1 Vuelta al servidor\n\n> Tenemos: Angular naci para vivir en el navegador.\n\n- Para **quitarle carga al servidor** generando el contenido dinmico en el navegador en base a plantillas.\n\n- Para enviar por la red primero la aplicacin y despus los datos, **ahorrando transferencia** durante un uso continuado.\n\n- Para mejorar la **experiencia del usuario** al no percibir recarga de pgina durante la navegacin dentro de la aplicacin.\n\n**Ideal en entornos de intranet o aplicaciones de gestin de uso intensivo.**\n\n**Problemtico para uso espordico o indexable pblicamente.**\n\n> Queremos: Indexado SEO y velocidad en la primera visita y tambin en las sucesivas.\n\n## 1.2 Para mejorar el SEO\n\n> El contenido se genera durante la ejecucin del JavaScript en el navegador.\n\n- Los **robots** no tienen nada significativo que indexar.\n\n- Las **redes sociales** no encuentran cabeceras para mejorar la presentacin de enlaces.\n\n**Hay que enviar el contenido ya generado.**\n\n**Pero sin perder la experiencia de usuario durante la ejecucin.**\n\n## 1.3 Para mejorar la experiencia en la primera visita\n\n> Para mostrar contenido antes hay que descargar y ejecutar la aplicacin.\n\n- Los **usuarios** ven una pgina vaca demasiado tiempo.\n\n- El **peso de la descarga inicial** es desproporcionado a pesar de _lazy loading_.\n\n**Hay que enviar el contenido ya generado.**\n\n**Descargar la aplicacin en segundo plano.**\n\n\n# 2 Despliegue con Node Express\n\nEl reto est en mantener lo bueno de las aplicaciones *JavaScript* como es la transicin fluida entre pginas, la interactividad o la descarga de datos bajo demanda, pero combinado con una mejor primera experiencia. Para ello la descarga del `index.html` tiene que venir con un documento html ya preparado con algo para mostrar y tardar lo menos posible en permitir la interaccin.\n\nEl **tiempo para el primer pintado** se ve penalizado por el tamao del *bundle* principal de Angular, pues en l reside habitualmente el componente *app* que acta de raz. Por supuesto que utilizar la carga diferida de mdulos es una manera obligada de reducir el peso del *main*. Todas las rutas, incluida la ruta base, deben ser *lazy* para retrasar la navegacin y que la descarga se produzca ms tarde. Slo el componente raz con la *shell* de navegacin bsica debera venir en el *bundle* principal.\n\nPero ni con eso es suficiente. El usuario no ver nada hasta que Angular se descargue, reclame el *bundle main*, lo procese y renderice ese *shell*. Hay usar alguna estrategia extra para reducir el tiempo de espera y entretener al usuario.\n\n\n## 2.1 Add Express Engine\n\nClaro que esto es slo un truco para que ese primer momento de espera se reduzca y no perdamos potenciales visitantes. Si queremos algo ms, como por ejemplo que el contenido a descargar sea ms fresco, entonces necesitaremos **renderizar en el servidor**. Y para ello necesitaremos un servidor de verdad. El propuesto y mejor documentado es *Express de NodeJS*.\n\nPara empezar tendrs que instalar y registrar las libraras necesarias. Adems habr que crear el pequeo servidor *Express*, y configurar al CLI para que haga el despliegue de ambos: cliente y servidor. Este laborioso trabajo se ha automatizado y ahora mismo se resuelve casi todo con una instruccin.\n\n```bash\nng add @nguniversal/express-engine --clientProject shop\n```\n\n## 2.2 Scripts de compilado y despliegue\n\nCuando termina la generacin e instalacin, comienza el compilado. En este caso es doble, porque adems de la compilacin habitual que llamaremos _client-bundle_, habr que compilar el servidor con su propia versin de la aplicacin cliente. Ser el _server-bundle_.\n\nAdems necesitamos una tercera compilacin (aunque no es propiamente de Angular) para el servidor _node/express_ que ejecutar el _server-bundle_. Y por ltimo ya slo nos queda poner en marcha dicho servidor que se quedar a la espera de peticiones de pginas.\n\nTodo esto se resume en los siguientes scripts, casi todos auto generados por el CLI.\n\n```json\n{\n  \"start:ssr\": \"npm run build:ssr && npm run serve:ssr\",\n  \"build:ssr\": \"npm run build:client-and-server-bundles && npm run compile:server\",\n  \"build:client-and-server-bundles\": \"ng build --prod && ng run shop:server:production --bundleDependencies all\",\n  \"compile:server\": \"webpack --config webpack.server.config.js --progress --colors\",\n  \"serve:ssr\": \"node dist/server\"\n}\n```\n## 2.3 Control de rutas\n\nEl resultado es un servidor *Node* que a cada peticin web responde enviando el `index.html`. Pero, y esta es la clave, resolver la ruta ejecutando la aplicacin Angular antes de responder al navegador. De esa forma el `index.html` ir recin generado con el contenido tal cual lo vera el usuario tras la ejecucin de Angular en local. As que **la espera al primer pintado significativo se reduce** y eso es bueno.\n\nPor si fuera poco, la principal ventaja al usar este mtodo es que al traer informacin dinmica puede usarse para indexar el contenido real del sitio. Esto es doblemente bueno, porque ahora todos **los robots indexadores podrn catalogar tu *site*** como si de una web clsica se tratase. Y los usuarios humanos podrn continuar la ejecucin en local disfrutando de las ventajas de una SPA.\n\nEl trabajo del servidor a partir de ese momento ser maysculo. Recibe la peticin, invoca a su versin de nuestra aplicacin Angular y la ejecuta en memoria. El resultado es un documento HTML que devolver al usuario. Dar lo mismo que ruta se le pida y si se resuelve por lazy-loading. Va totalmente preparado y configurado para cargar el JavaScript oportuno y ejecutarlo como lo hara un navegador.\n\nComprubalo solicitando diversas rutas e inspeccionando la respuesta del servidor.\n\n```json\nhttp://localhost:4000\nhttp://localhost:4000/rates\n```\n\nDe todas formas tengo que advertirte de que tomes todo esto con cautela por varios motivos:\n\n- Tecnologa compleja estable pero con carencias\n- Herramientas de generacin buenas pero incompletas\n- Transferencia de estado manual para evitar llamadas repetidas al API\n\nTampoco es sencilla la convivencia con libreras propias del *browser*, y menos si se trata de una PWA. Yo procuro usar un servicio que aisle al servidor de ciertas llamadas slo disponibles en el navegador, como por ejemplo todo lo relativo al *localStorage*.\n\n```typescript\nimport { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniversalService {\n  constructor(@Inject(PLATFORM_ID) private platformId: string) {}\n  public isBrowser() => isPlatformBrowser(this.platformId);\n  public isServer() => isPlatformServer(this.platformId);\n\n  public saveOnStorage(key, value) {\n    if (this.isBrowser()) {\n      sessionStorage.setItem(key, value);\n    } else {\n    }\n  }\n  public loadFromStorage(key) {\n    if (this.isBrowser()) {\n      sessionStorage.getItem(key);\n    } else {\n      return null;\n    }\n  }\n}\n```\n\n# 3 Variantes: shell y pre-rendering\n\nLa tcnica vista anteriormente resuelve los problemas de usuario y de robot SEO, pero a costa de cierta complejidad. Y, sobre todo, a costa de necesitar un servidor node en produccin.\n\nEn algunas situaciones queremos desplegar la aplicacin en un sencillo servidor de ficheros. A veces ni siquiera tenemos la necesidad del indexado completo.\n\nPara esos caso tenemos alternativas ms sencillas.\n\n## 3.1 Shell para mejora de experiencia inicial\n\n- Muestra un contenido instantneo mientras descarga la app.\n\n- Mejora la experiencia de usuario en la primera visita.\n\n- De cara al SEO, slo indexa el contenido inicial.\n\n> Adecuado para aplicaciones de usuario registrado, pero con un portal de bienvenida indexable y rpido.\n\nLa ms sencilla es hacer que el `index.html`, habitualmente vaco, se rellene con un **contenido visualizable mientras el proceso principal de Angular no arranca**. En ocasiones basta con poner a mano algn mensaje o animacin que indique que estamos cargando. Pero cuanto ms se parezca esa primera visin al resultado final mejor para el usuario. As que lo propio sera que el `index.html` ya bajase con el *shell* real de la aplicacin.\n\nMontar eso a mano no es la mejor opcin. La solucin parte de **renderizar el *html* durante el proceso de *deploy***. Se trata de configurar el CLI para que ejecute la aplicacin en la mquina del desarrollador sobre una ruta predefinida; y que copie el resultado sobre el `index.html` que enviar a distribucin.\n\nEste trabajo se ha automatizado y se resuelve con un par de comandos del Angular CLI.\n\n```bash\nng g app-shell --client-project shop --universal-project server-shop\n```\n\nEl efecto de este comando se materializa especialmente con la aparicin de nuevos *targets para los builders* del CLI en el fichero `angular.json`.\n\nCon el comando `ng run shop:app-shell` podrs generar una versin especial de distribucin en al que el `index.html` ya va prerenderizado con el contenido del componente asociado a la ruta *shell*. Realmente lo que hace es ejecutar tu aplicacin sobre una ruta predefinida, tomar el *html* resultado e inyectarlo en el *body* del `index.html` que ir a distribucin.\n\n> Por cierto, esta tcnica no obliga a disponer de ningn servidor web especial. Sigue funcionando con un servidor esttico de ficheros pues la prerenderizacin se produjo en la mquina del programador.\n\n## 3.2 Pre renderizado de toda la aplicacin\n\n- Se trata de volver no slo al servidor web, si no al servidor de ficheros.\n\n- La idea es invocar repetidamente al SSR y almacenar el HTML resultante en ficheros fsicos.\n\n- En produccin, los robots y los usuarios recibirn ya esas copias pre generadas.\n\n- Para mantener el sistema actualizado se necesita regenerar frecuentemente los ficheros\n\n> Adecuado para blogs y sitios que no puedan o no quieran tener un servidor web corriendo.\n\n\nA falta de una solucin oficial, podemos seguir la pista a iniciativas tipo [Angular Prerender](https://github.com/chrisguttandin/angular-prerender)\n\n# 4 SEO en la pgina, en el navegador y en el servidor\n\nCon lo visto hasta ahora tu aplicacin estar ms que cubierta en cuanto a ofrecer la mejor experiencia para usuarios al tiempo que enva contenido indexable para robots... Pero falta algo.\n\nHabitualmente las aplicaciones Angular manejan el contenido visible de una pgina web; es decir, el *body*. Para **acceder y cambiar el contenido del *header***, tan utilizado por los robots de redes sociales, hay que usar algo ms.\n\n## 4.1 Titulo y meta etiquetas de pgina\n\nComo parte del *framework* viene la librera *platform-browser* dnde tenemos un par de servicios para manipular el ttulo y cualquier etiqueta de meta informacin de la pgina.\n\nPara ello suele usarse un cdigo similar a este en el componente raz de la aplicacin. Es muy sencillo pero te dar una idea del potencial de estos servicios:\n\n```typescript\nimport { Meta, Title } from '@angular/platform-browser';\n@Component({\n  selector: 'app-root',\n  template: `<p>Aprende a usar el framework Angular</p>`,\n})\nexport class AppComponent implements OnInit {\n  constructor(private title: Title, private meta: Meta) {}\n  ngOnInit() {\n    this.title.setTitle('My title');\n    this.meta.addTag({ property: 'og:title', content: 'My title' }, true);\n  }\n}\n```\n\nAhora ya tienes una aplicacin que satisface a usuarios y robots por igual. Contina tu formacin avanzada para crear aplicaciones Angular para el mundo globalizado con tcnicas de [Internacionalizacin y puesta en produccin](../internacionalizacion-y-puesta-en-produccion-con-Angular/) y vers como aprendes a programar con Angular 8.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","source":"_posts/ng-17-velocidad-y-seo-con-el-ssr-de-angular-universal.md","raw":"---\ntitle: Velocidad y SEO con el SSR de Angular Universal\npermalink: velocidad-y-seo-con-el-ssr-de-angular-universal\ndate: 2019-10-09 13:50:27\ntags:\n- Angular\n- Angular8\n- Angular2\n- Universal\n- SSR\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-17_ssr.png\n---\n\n![velocidad-y-seo-con-el-ssr-de-angular-universal](/images/tutorial-angular-17_ssr.png)\n\nLas *SPA JavaScript*, muy balanceadas hacia el navegador, nacieron para **crear con tecnologa web aplicaciones de negocio**. Normalmente se desplegaban en *intranets*, o en internet para usuarios autorizados. Eran aplicaciones de uso intensivo, visita recurrente y alto rendimiento diario. El xito tecnolgico de *frameworks* como Angular las llev a ser usadas para desarrollar webs clsicas de internet y ser utilizadas por visitantes ocasionales.\n\nPero en esta situacin presentaron dos problemas para los que inicialmente no estaban preparadas. Por un lado la primera visita de un humano obligaba a la descarga completa de la aplicacin antes de poder ver nada. Y nada era lo que vean los visitantes robticos que pretendan indexar un sitio. Las soluciones a estos problemas incluyen, entre otras medidas, **una vuelta al servidor**. Lo que en Angular se conoce como **aplicacin universal**.\n\n\n<!-- more -->\n\nPartiendo del cdigo tal como qued en [PWA, Entre la web y las apps con Angular](../pwa-entre-la-web-y-las-apps-con-angular/). Al finalizar tendrs una aplicacin que  ofrece lo que buscan tanto a personas como a robots.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n# 1 Angular Universal\n\n## 1.1 Vuelta al servidor\n\n> Tenemos: Angular naci para vivir en el navegador.\n\n- Para **quitarle carga al servidor** generando el contenido dinmico en el navegador en base a plantillas.\n\n- Para enviar por la red primero la aplicacin y despus los datos, **ahorrando transferencia** durante un uso continuado.\n\n- Para mejorar la **experiencia del usuario** al no percibir recarga de pgina durante la navegacin dentro de la aplicacin.\n\n**Ideal en entornos de intranet o aplicaciones de gestin de uso intensivo.**\n\n**Problemtico para uso espordico o indexable pblicamente.**\n\n> Queremos: Indexado SEO y velocidad en la primera visita y tambin en las sucesivas.\n\n## 1.2 Para mejorar el SEO\n\n> El contenido se genera durante la ejecucin del JavaScript en el navegador.\n\n- Los **robots** no tienen nada significativo que indexar.\n\n- Las **redes sociales** no encuentran cabeceras para mejorar la presentacin de enlaces.\n\n**Hay que enviar el contenido ya generado.**\n\n**Pero sin perder la experiencia de usuario durante la ejecucin.**\n\n## 1.3 Para mejorar la experiencia en la primera visita\n\n> Para mostrar contenido antes hay que descargar y ejecutar la aplicacin.\n\n- Los **usuarios** ven una pgina vaca demasiado tiempo.\n\n- El **peso de la descarga inicial** es desproporcionado a pesar de _lazy loading_.\n\n**Hay que enviar el contenido ya generado.**\n\n**Descargar la aplicacin en segundo plano.**\n\n\n# 2 Despliegue con Node Express\n\nEl reto est en mantener lo bueno de las aplicaciones *JavaScript* como es la transicin fluida entre pginas, la interactividad o la descarga de datos bajo demanda, pero combinado con una mejor primera experiencia. Para ello la descarga del `index.html` tiene que venir con un documento html ya preparado con algo para mostrar y tardar lo menos posible en permitir la interaccin.\n\nEl **tiempo para el primer pintado** se ve penalizado por el tamao del *bundle* principal de Angular, pues en l reside habitualmente el componente *app* que acta de raz. Por supuesto que utilizar la carga diferida de mdulos es una manera obligada de reducir el peso del *main*. Todas las rutas, incluida la ruta base, deben ser *lazy* para retrasar la navegacin y que la descarga se produzca ms tarde. Slo el componente raz con la *shell* de navegacin bsica debera venir en el *bundle* principal.\n\nPero ni con eso es suficiente. El usuario no ver nada hasta que Angular se descargue, reclame el *bundle main*, lo procese y renderice ese *shell*. Hay usar alguna estrategia extra para reducir el tiempo de espera y entretener al usuario.\n\n\n## 2.1 Add Express Engine\n\nClaro que esto es slo un truco para que ese primer momento de espera se reduzca y no perdamos potenciales visitantes. Si queremos algo ms, como por ejemplo que el contenido a descargar sea ms fresco, entonces necesitaremos **renderizar en el servidor**. Y para ello necesitaremos un servidor de verdad. El propuesto y mejor documentado es *Express de NodeJS*.\n\nPara empezar tendrs que instalar y registrar las libraras necesarias. Adems habr que crear el pequeo servidor *Express*, y configurar al CLI para que haga el despliegue de ambos: cliente y servidor. Este laborioso trabajo se ha automatizado y ahora mismo se resuelve casi todo con una instruccin.\n\n```bash\nng add @nguniversal/express-engine --clientProject shop\n```\n\n## 2.2 Scripts de compilado y despliegue\n\nCuando termina la generacin e instalacin, comienza el compilado. En este caso es doble, porque adems de la compilacin habitual que llamaremos _client-bundle_, habr que compilar el servidor con su propia versin de la aplicacin cliente. Ser el _server-bundle_.\n\nAdems necesitamos una tercera compilacin (aunque no es propiamente de Angular) para el servidor _node/express_ que ejecutar el _server-bundle_. Y por ltimo ya slo nos queda poner en marcha dicho servidor que se quedar a la espera de peticiones de pginas.\n\nTodo esto se resume en los siguientes scripts, casi todos auto generados por el CLI.\n\n```json\n{\n  \"start:ssr\": \"npm run build:ssr && npm run serve:ssr\",\n  \"build:ssr\": \"npm run build:client-and-server-bundles && npm run compile:server\",\n  \"build:client-and-server-bundles\": \"ng build --prod && ng run shop:server:production --bundleDependencies all\",\n  \"compile:server\": \"webpack --config webpack.server.config.js --progress --colors\",\n  \"serve:ssr\": \"node dist/server\"\n}\n```\n## 2.3 Control de rutas\n\nEl resultado es un servidor *Node* que a cada peticin web responde enviando el `index.html`. Pero, y esta es la clave, resolver la ruta ejecutando la aplicacin Angular antes de responder al navegador. De esa forma el `index.html` ir recin generado con el contenido tal cual lo vera el usuario tras la ejecucin de Angular en local. As que **la espera al primer pintado significativo se reduce** y eso es bueno.\n\nPor si fuera poco, la principal ventaja al usar este mtodo es que al traer informacin dinmica puede usarse para indexar el contenido real del sitio. Esto es doblemente bueno, porque ahora todos **los robots indexadores podrn catalogar tu *site*** como si de una web clsica se tratase. Y los usuarios humanos podrn continuar la ejecucin en local disfrutando de las ventajas de una SPA.\n\nEl trabajo del servidor a partir de ese momento ser maysculo. Recibe la peticin, invoca a su versin de nuestra aplicacin Angular y la ejecuta en memoria. El resultado es un documento HTML que devolver al usuario. Dar lo mismo que ruta se le pida y si se resuelve por lazy-loading. Va totalmente preparado y configurado para cargar el JavaScript oportuno y ejecutarlo como lo hara un navegador.\n\nComprubalo solicitando diversas rutas e inspeccionando la respuesta del servidor.\n\n```json\nhttp://localhost:4000\nhttp://localhost:4000/rates\n```\n\nDe todas formas tengo que advertirte de que tomes todo esto con cautela por varios motivos:\n\n- Tecnologa compleja estable pero con carencias\n- Herramientas de generacin buenas pero incompletas\n- Transferencia de estado manual para evitar llamadas repetidas al API\n\nTampoco es sencilla la convivencia con libreras propias del *browser*, y menos si se trata de una PWA. Yo procuro usar un servicio que aisle al servidor de ciertas llamadas slo disponibles en el navegador, como por ejemplo todo lo relativo al *localStorage*.\n\n```typescript\nimport { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniversalService {\n  constructor(@Inject(PLATFORM_ID) private platformId: string) {}\n  public isBrowser() => isPlatformBrowser(this.platformId);\n  public isServer() => isPlatformServer(this.platformId);\n\n  public saveOnStorage(key, value) {\n    if (this.isBrowser()) {\n      sessionStorage.setItem(key, value);\n    } else {\n    }\n  }\n  public loadFromStorage(key) {\n    if (this.isBrowser()) {\n      sessionStorage.getItem(key);\n    } else {\n      return null;\n    }\n  }\n}\n```\n\n# 3 Variantes: shell y pre-rendering\n\nLa tcnica vista anteriormente resuelve los problemas de usuario y de robot SEO, pero a costa de cierta complejidad. Y, sobre todo, a costa de necesitar un servidor node en produccin.\n\nEn algunas situaciones queremos desplegar la aplicacin en un sencillo servidor de ficheros. A veces ni siquiera tenemos la necesidad del indexado completo.\n\nPara esos caso tenemos alternativas ms sencillas.\n\n## 3.1 Shell para mejora de experiencia inicial\n\n- Muestra un contenido instantneo mientras descarga la app.\n\n- Mejora la experiencia de usuario en la primera visita.\n\n- De cara al SEO, slo indexa el contenido inicial.\n\n> Adecuado para aplicaciones de usuario registrado, pero con un portal de bienvenida indexable y rpido.\n\nLa ms sencilla es hacer que el `index.html`, habitualmente vaco, se rellene con un **contenido visualizable mientras el proceso principal de Angular no arranca**. En ocasiones basta con poner a mano algn mensaje o animacin que indique que estamos cargando. Pero cuanto ms se parezca esa primera visin al resultado final mejor para el usuario. As que lo propio sera que el `index.html` ya bajase con el *shell* real de la aplicacin.\n\nMontar eso a mano no es la mejor opcin. La solucin parte de **renderizar el *html* durante el proceso de *deploy***. Se trata de configurar el CLI para que ejecute la aplicacin en la mquina del desarrollador sobre una ruta predefinida; y que copie el resultado sobre el `index.html` que enviar a distribucin.\n\nEste trabajo se ha automatizado y se resuelve con un par de comandos del Angular CLI.\n\n```bash\nng g app-shell --client-project shop --universal-project server-shop\n```\n\nEl efecto de este comando se materializa especialmente con la aparicin de nuevos *targets para los builders* del CLI en el fichero `angular.json`.\n\nCon el comando `ng run shop:app-shell` podrs generar una versin especial de distribucin en al que el `index.html` ya va prerenderizado con el contenido del componente asociado a la ruta *shell*. Realmente lo que hace es ejecutar tu aplicacin sobre una ruta predefinida, tomar el *html* resultado e inyectarlo en el *body* del `index.html` que ir a distribucin.\n\n> Por cierto, esta tcnica no obliga a disponer de ningn servidor web especial. Sigue funcionando con un servidor esttico de ficheros pues la prerenderizacin se produjo en la mquina del programador.\n\n## 3.2 Pre renderizado de toda la aplicacin\n\n- Se trata de volver no slo al servidor web, si no al servidor de ficheros.\n\n- La idea es invocar repetidamente al SSR y almacenar el HTML resultante en ficheros fsicos.\n\n- En produccin, los robots y los usuarios recibirn ya esas copias pre generadas.\n\n- Para mantener el sistema actualizado se necesita regenerar frecuentemente los ficheros\n\n> Adecuado para blogs y sitios que no puedan o no quieran tener un servidor web corriendo.\n\n\nA falta de una solucin oficial, podemos seguir la pista a iniciativas tipo [Angular Prerender](https://github.com/chrisguttandin/angular-prerender)\n\n# 4 SEO en la pgina, en el navegador y en el servidor\n\nCon lo visto hasta ahora tu aplicacin estar ms que cubierta en cuanto a ofrecer la mejor experiencia para usuarios al tiempo que enva contenido indexable para robots... Pero falta algo.\n\nHabitualmente las aplicaciones Angular manejan el contenido visible de una pgina web; es decir, el *body*. Para **acceder y cambiar el contenido del *header***, tan utilizado por los robots de redes sociales, hay que usar algo ms.\n\n## 4.1 Titulo y meta etiquetas de pgina\n\nComo parte del *framework* viene la librera *platform-browser* dnde tenemos un par de servicios para manipular el ttulo y cualquier etiqueta de meta informacin de la pgina.\n\nPara ello suele usarse un cdigo similar a este en el componente raz de la aplicacin. Es muy sencillo pero te dar una idea del potencial de estos servicios:\n\n```typescript\nimport { Meta, Title } from '@angular/platform-browser';\n@Component({\n  selector: 'app-root',\n  template: `<p>Aprende a usar el framework Angular</p>`,\n})\nexport class AppComponent implements OnInit {\n  constructor(private title: Title, private meta: Meta) {}\n  ngOnInit() {\n    this.title.setTitle('My title');\n    this.meta.addTag({ property: 'og:title', content: 'My title' }, true);\n  }\n}\n```\n\nAhora ya tienes una aplicacin que satisface a usuarios y robots por igual. Contina tu formacin avanzada para crear aplicaciones Angular para el mundo globalizado con tcnicas de [Internacionalizacin y puesta en produccin](../internacionalizacion-y-puesta-en-produccion-con-Angular/) y vers como aprendes a programar con Angular 8.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","slug":"velocidad-y-seo-con-el-ssr-de-angular-universal","published":1,"updated":"2019-10-16T14:23:01.028Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab1h000pbss3qisy3wfv","content":"<p><img src=\"/images/tutorial-angular-17_ssr.png\" alt=\"velocidad-y-seo-con-el-ssr-de-angular-universal\"></p><p>Las <em>SPA JavaScript</em>, muy balanceadas hacia el navegador, nacieron para <strong>crear con tecnologa web aplicaciones de negocio</strong>. Normalmente se desplegaban en <em>intranets</em>, o en internet para usuarios autorizados. Eran aplicaciones de uso intensivo, visita recurrente y alto rendimiento diario. El xito tecnolgico de <em>frameworks</em> como Angular las llev a ser usadas para desarrollar webs clsicas de internet y ser utilizadas por visitantes ocasionales.</p><p>Pero en esta situacin presentaron dos problemas para los que inicialmente no estaban preparadas. Por un lado la primera visita de un humano obligaba a la descarga completa de la aplicacin antes de poder ver nada. Y nada era lo que vean los visitantes robticos que pretendan indexar un sitio. Las soluciones a estos problemas incluyen, entre otras medidas, <strong>una vuelta al servidor</strong>. Lo que en Angular se conoce como <strong>aplicacin universal</strong>.</p><a id=\"more\"></a><p>Partiendo del cdigo tal como qued en <a href=\"../pwa-entre-la-web-y-las-apps-con-angular/\">PWA, Entre la web y las apps con Angular</a>. Al finalizar tendrs una aplicacin que ofrece lo que buscan tanto a personas como a robots.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h1 id=\"1-Angular-Universal\"><a href=\"#1-Angular-Universal\" class=\"headerlink\" title=\"1 Angular Universal\"></a>1 Angular Universal</h1><h2 id=\"1-1-Vuelta-al-servidor\"><a href=\"#1-1-Vuelta-al-servidor\" class=\"headerlink\" title=\"1.1 Vuelta al servidor\"></a>1.1 Vuelta al servidor</h2><blockquote><p>Tenemos: Angular naci para vivir en el navegador.</p></blockquote><ul><li><p>Para <strong>quitarle carga al servidor</strong> generando el contenido dinmico en el navegador en base a plantillas.</p></li><li><p>Para enviar por la red primero la aplicacin y despus los datos, <strong>ahorrando transferencia</strong> durante un uso continuado.</p></li><li><p>Para mejorar la <strong>experiencia del usuario</strong> al no percibir recarga de pgina durante la navegacin dentro de la aplicacin.</p></li></ul><p><strong>Ideal en entornos de intranet o aplicaciones de gestin de uso intensivo.</strong></p><p><strong>Problemtico para uso espordico o indexable pblicamente.</strong></p><blockquote><p>Queremos: Indexado SEO y velocidad en la primera visita y tambin en las sucesivas.</p></blockquote><h2 id=\"1-2-Para-mejorar-el-SEO\"><a href=\"#1-2-Para-mejorar-el-SEO\" class=\"headerlink\" title=\"1.2 Para mejorar el SEO\"></a>1.2 Para mejorar el SEO</h2><blockquote><p>El contenido se genera durante la ejecucin del JavaScript en el navegador.</p></blockquote><ul><li><p>Los <strong>robots</strong> no tienen nada significativo que indexar.</p></li><li><p>Las <strong>redes sociales</strong> no encuentran cabeceras para mejorar la presentacin de enlaces.</p></li></ul><p><strong>Hay que enviar el contenido ya generado.</strong></p><p><strong>Pero sin perder la experiencia de usuario durante la ejecucin.</strong></p><h2 id=\"1-3-Para-mejorar-la-experiencia-en-la-primera-visita\"><a href=\"#1-3-Para-mejorar-la-experiencia-en-la-primera-visita\" class=\"headerlink\" title=\"1.3 Para mejorar la experiencia en la primera visita\"></a>1.3 Para mejorar la experiencia en la primera visita</h2><blockquote><p>Para mostrar contenido antes hay que descargar y ejecutar la aplicacin.</p></blockquote><ul><li><p>Los <strong>usuarios</strong> ven una pgina vaca demasiado tiempo.</p></li><li><p>El <strong>peso de la descarga inicial</strong> es desproporcionado a pesar de <em>lazy loading</em>.</p></li></ul><p><strong>Hay que enviar el contenido ya generado.</strong></p><p><strong>Descargar la aplicacin en segundo plano.</strong></p><h1 id=\"2-Despliegue-con-Node-Express\"><a href=\"#2-Despliegue-con-Node-Express\" class=\"headerlink\" title=\"2 Despliegue con Node Express\"></a>2 Despliegue con Node Express</h1><p>El reto est en mantener lo bueno de las aplicaciones <em>JavaScript</em> como es la transicin fluida entre pginas, la interactividad o la descarga de datos bajo demanda, pero combinado con una mejor primera experiencia. Para ello la descarga del <code>index.html</code> tiene que venir con un documento html ya preparado con algo para mostrar y tardar lo menos posible en permitir la interaccin.</p><p>El <strong>tiempo para el primer pintado</strong> se ve penalizado por el tamao del <em>bundle</em> principal de Angular, pues en l reside habitualmente el componente <em>app</em> que acta de raz. Por supuesto que utilizar la carga diferida de mdulos es una manera obligada de reducir el peso del <em>main</em>. Todas las rutas, incluida la ruta base, deben ser <em>lazy</em> para retrasar la navegacin y que la descarga se produzca ms tarde. Slo el componente raz con la <em>shell</em> de navegacin bsica debera venir en el <em>bundle</em> principal.</p><p>Pero ni con eso es suficiente. El usuario no ver nada hasta que Angular se descargue, reclame el <em>bundle main</em>, lo procese y renderice ese <em>shell</em>. Hay usar alguna estrategia extra para reducir el tiempo de espera y entretener al usuario.</p><h2 id=\"2-1-Add-Express-Engine\"><a href=\"#2-1-Add-Express-Engine\" class=\"headerlink\" title=\"2.1 Add Express Engine\"></a>2.1 Add Express Engine</h2><p>Claro que esto es slo un truco para que ese primer momento de espera se reduzca y no perdamos potenciales visitantes. Si queremos algo ms, como por ejemplo que el contenido a descargar sea ms fresco, entonces necesitaremos <strong>renderizar en el servidor</strong>. Y para ello necesitaremos un servidor de verdad. El propuesto y mejor documentado es <em>Express de NodeJS</em>.</p><p>Para empezar tendrs que instalar y registrar las libraras necesarias. Adems habr que crear el pequeo servidor <em>Express</em>, y configurar al CLI para que haga el despliegue de ambos: cliente y servidor. Este laborioso trabajo se ha automatizado y ahora mismo se resuelve casi todo con una instruccin.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng add @nguniversal/express-engine --clientProject shop</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Scripts-de-compilado-y-despliegue\"><a href=\"#2-2-Scripts-de-compilado-y-despliegue\" class=\"headerlink\" title=\"2.2 Scripts de compilado y despliegue\"></a>2.2 Scripts de compilado y despliegue</h2><p>Cuando termina la generacin e instalacin, comienza el compilado. En este caso es doble, porque adems de la compilacin habitual que llamaremos <em>client-bundle</em>, habr que compilar el servidor con su propia versin de la aplicacin cliente. Ser el <em>server-bundle</em>.</p><p>Adems necesitamos una tercera compilacin (aunque no es propiamente de Angular) para el servidor <em>node/express</em> que ejecutar el <em>server-bundle</em>. Y por ltimo ya slo nos queda poner en marcha dicho servidor que se quedar a la espera de peticiones de pginas.</p><p>Todo esto se resume en los siguientes scripts, casi todos auto generados por el CLI.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"start:ssr\"</span>: <span class=\"string\">\"npm run build:ssr &amp;&amp; npm run serve:ssr\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"build:ssr\"</span>: <span class=\"string\">\"npm run build:client-and-server-bundles &amp;&amp; npm run compile:server\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"build:client-and-server-bundles\"</span>: <span class=\"string\">\"ng build --prod &amp;&amp; ng run shop:server:production --bundleDependencies all\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"compile:server\"</span>: <span class=\"string\">\"webpack --config webpack.server.config.js --progress --colors\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"serve:ssr\"</span>: <span class=\"string\">\"node dist/server\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Control-de-rutas\"><a href=\"#2-3-Control-de-rutas\" class=\"headerlink\" title=\"2.3 Control de rutas\"></a>2.3 Control de rutas</h2><p>El resultado es un servidor <em>Node</em> que a cada peticin web responde enviando el <code>index.html</code>. Pero, y esta es la clave, resolver la ruta ejecutando la aplicacin Angular antes de responder al navegador. De esa forma el <code>index.html</code> ir recin generado con el contenido tal cual lo vera el usuario tras la ejecucin de Angular en local. As que <strong>la espera al primer pintado significativo se reduce</strong> y eso es bueno.</p><p>Por si fuera poco, la principal ventaja al usar este mtodo es que al traer informacin dinmica puede usarse para indexar el contenido real del sitio. Esto es doblemente bueno, porque ahora todos <strong>los robots indexadores podrn catalogar tu <em>site</em></strong> como si de una web clsica se tratase. Y los usuarios humanos podrn continuar la ejecucin en local disfrutando de las ventajas de una SPA.</p><p>El trabajo del servidor a partir de ese momento ser maysculo. Recibe la peticin, invoca a su versin de nuestra aplicacin Angular y la ejecuta en memoria. El resultado es un documento HTML que devolver al usuario. Dar lo mismo que ruta se le pida y si se resuelve por lazy-loading. Va totalmente preparado y configurado para cargar el JavaScript oportuno y ejecutarlo como lo hara un navegador.</p><p>Comprubalo solicitando diversas rutas e inspeccionando la respuesta del servidor.</p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://localhost:4000</span><br><span class=\"line\">http://localhost:4000/rates</span><br></pre></td></tr></table></figure><p>De todas formas tengo que advertirte de que tomes todo esto con cautela por varios motivos:</p><ul><li>Tecnologa compleja estable pero con carencias</li><li>Herramientas de generacin buenas pero incompletas</li><li>Transferencia de estado manual para evitar llamadas repetidas al API</li></ul><p>Tampoco es sencilla la convivencia con libreras propias del <em>browser</em>, y menos si se trata de una PWA. Yo procuro usar un servicio que aisle al servidor de ciertas llamadas slo disponibles en el navegador, como por ejemplo todo lo relativo al <em>localStorage</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; isPlatformBrowser, isPlatformServer &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Inject, Injectable, PLATFORM_ID &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> UniversalService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"meta\">@Inject</span>(PLATFORM_ID) <span class=\"keyword\">private</span> platformId: <span class=\"built_in\">string</span></span>) &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> isBrowser() =&gt; isPlatformBrowser(<span class=\"keyword\">this</span>.platformId);</span><br><span class=\"line\">  <span class=\"keyword\">public</span> isServer() =&gt; isPlatformServer(<span class=\"keyword\">this</span>.platformId);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> saveOnStorage(key, value) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.isBrowser()) &#123;</span><br><span class=\"line\">      sessionStorage.setItem(key, value);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> loadFromStorage(key) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.isBrowser()) &#123;</span><br><span class=\"line\">      sessionStorage.getItem(key);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"3-Variantes-shell-y-pre-rendering\"><a href=\"#3-Variantes-shell-y-pre-rendering\" class=\"headerlink\" title=\"3 Variantes: shell y pre-rendering\"></a>3 Variantes: shell y pre-rendering</h1><p>La tcnica vista anteriormente resuelve los problemas de usuario y de robot SEO, pero a costa de cierta complejidad. Y, sobre todo, a costa de necesitar un servidor node en produccin.</p><p>En algunas situaciones queremos desplegar la aplicacin en un sencillo servidor de ficheros. A veces ni siquiera tenemos la necesidad del indexado completo.</p><p>Para esos caso tenemos alternativas ms sencillas.</p><h2 id=\"3-1-Shell-para-mejora-de-experiencia-inicial\"><a href=\"#3-1-Shell-para-mejora-de-experiencia-inicial\" class=\"headerlink\" title=\"3.1 Shell para mejora de experiencia inicial\"></a>3.1 Shell para mejora de experiencia inicial</h2><ul><li><p>Muestra un contenido instantneo mientras descarga la app.</p></li><li><p>Mejora la experiencia de usuario en la primera visita.</p></li><li><p>De cara al SEO, slo indexa el contenido inicial.</p></li></ul><blockquote><p>Adecuado para aplicaciones de usuario registrado, pero con un portal de bienvenida indexable y rpido.</p></blockquote><p>La ms sencilla es hacer que el <code>index.html</code>, habitualmente vaco, se rellene con un <strong>contenido visualizable mientras el proceso principal de Angular no arranca</strong>. En ocasiones basta con poner a mano algn mensaje o animacin que indique que estamos cargando. Pero cuanto ms se parezca esa primera visin al resultado final mejor para el usuario. As que lo propio sera que el <code>index.html</code> ya bajase con el <em>shell</em> real de la aplicacin.</p><p>Montar eso a mano no es la mejor opcin. La solucin parte de <strong>renderizar el <em>html</em> durante el proceso de <em>deploy</em></strong>. Se trata de configurar el CLI para que ejecute la aplicacin en la mquina del desarrollador sobre una ruta predefinida; y que copie el resultado sobre el <code>index.html</code> que enviar a distribucin.</p><p>Este trabajo se ha automatizado y se resuelve con un par de comandos del Angular CLI.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g app-shell --client-project shop --universal-project server-shop</span><br></pre></td></tr></table></figure><p>El efecto de este comando se materializa especialmente con la aparicin de nuevos <em>targets para los builders</em> del CLI en el fichero <code>angular.json</code>.</p><p>Con el comando <code>ng run shop:app-shell</code> podrs generar una versin especial de distribucin en al que el <code>index.html</code> ya va prerenderizado con el contenido del componente asociado a la ruta <em>shell</em>. Realmente lo que hace es ejecutar tu aplicacin sobre una ruta predefinida, tomar el <em>html</em> resultado e inyectarlo en el <em>body</em> del <code>index.html</code> que ir a distribucin.</p><blockquote><p>Por cierto, esta tcnica no obliga a disponer de ningn servidor web especial. Sigue funcionando con un servidor esttico de ficheros pues la prerenderizacin se produjo en la mquina del programador.</p></blockquote><h2 id=\"3-2-Pre-renderizado-de-toda-la-aplicacion\"><a href=\"#3-2-Pre-renderizado-de-toda-la-aplicacion\" class=\"headerlink\" title=\"3.2 Pre renderizado de toda la aplicacin\"></a>3.2 Pre renderizado de toda la aplicacin</h2><ul><li><p>Se trata de volver no slo al servidor web, si no al servidor de ficheros.</p></li><li><p>La idea es invocar repetidamente al SSR y almacenar el HTML resultante en ficheros fsicos.</p></li><li><p>En produccin, los robots y los usuarios recibirn ya esas copias pre generadas.</p></li><li><p>Para mantener el sistema actualizado se necesita regenerar frecuentemente los ficheros</p></li></ul><blockquote><p>Adecuado para blogs y sitios que no puedan o no quieran tener un servidor web corriendo.</p></blockquote><p>A falta de una solucin oficial, podemos seguir la pista a iniciativas tipo <a href=\"https://github.com/chrisguttandin/angular-prerender\" target=\"_blank\" rel=\"noopener\">Angular Prerender</a></p><h1 id=\"4-SEO-en-la-pagina-en-el-navegador-y-en-el-servidor\"><a href=\"#4-SEO-en-la-pagina-en-el-navegador-y-en-el-servidor\" class=\"headerlink\" title=\"4 SEO en la pgina, en el navegador y en el servidor\"></a>4 SEO en la pgina, en el navegador y en el servidor</h1><p>Con lo visto hasta ahora tu aplicacin estar ms que cubierta en cuanto a ofrecer la mejor experiencia para usuarios al tiempo que enva contenido indexable para robots Pero falta algo.</p><p>Habitualmente las aplicaciones Angular manejan el contenido visible de una pgina web; es decir, el <em>body</em>. Para <strong>acceder y cambiar el contenido del <em>header</em></strong>, tan utilizado por los robots de redes sociales, hay que usar algo ms.</p><h2 id=\"4-1-Titulo-y-meta-etiquetas-de-pagina\"><a href=\"#4-1-Titulo-y-meta-etiquetas-de-pagina\" class=\"headerlink\" title=\"4.1 Titulo y meta etiquetas de pgina\"></a>4.1 Titulo y meta etiquetas de pgina</h2><p>Como parte del <em>framework</em> viene la librera <em>platform-browser</em> dnde tenemos un par de servicios para manipular el ttulo y cualquier etiqueta de meta informacin de la pgina.</p><p>Para ello suele usarse un cdigo similar a este en el componente raz de la aplicacin. Es muy sencillo pero te dar una idea del potencial de estos servicios:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Meta, Title &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'app-root'</span>,</span><br><span class=\"line\">  template: <span class=\"string\">`&lt;p&gt;Aprende a usar el framework Angular&lt;/p&gt;`</span>,</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> title: Title, <span class=\"keyword\">private</span> meta: Meta</span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.title.setTitle(<span class=\"string\">'My title'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.meta.addTag(&#123; property: <span class=\"string\">'og:title'</span>, content: <span class=\"string\">'My title'</span> &#125;, <span class=\"literal\">true</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora ya tienes una aplicacin que satisface a usuarios y robots por igual. Contina tu formacin avanzada para crear aplicaciones Angular para el mundo globalizado con tcnicas de <a href=\"../internacionalizacion-y-puesta-en-produccion-con-Angular/\">Internacionalizacin y puesta en produccin</a> y vers como aprendes a programar con Angular 8.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-17_ssr.png\" alt=\"velocidad-y-seo-con-el-ssr-de-angular-universal\"></p><p>Las <em>SPA JavaScript</em>, muy balanceadas hacia el navegador, nacieron para <strong>crear con tecnologa web aplicaciones de negocio</strong>. Normalmente se desplegaban en <em>intranets</em>, o en internet para usuarios autorizados. Eran aplicaciones de uso intensivo, visita recurrente y alto rendimiento diario. El xito tecnolgico de <em>frameworks</em> como Angular las llev a ser usadas para desarrollar webs clsicas de internet y ser utilizadas por visitantes ocasionales.</p><p>Pero en esta situacin presentaron dos problemas para los que inicialmente no estaban preparadas. Por un lado la primera visita de un humano obligaba a la descarga completa de la aplicacin antes de poder ver nada. Y nada era lo que vean los visitantes robticos que pretendan indexar un sitio. Las soluciones a estos problemas incluyen, entre otras medidas, <strong>una vuelta al servidor</strong>. Lo que en Angular se conoce como <strong>aplicacin universal</strong>.</p>","more":"<p>Partiendo del cdigo tal como qued en <a href=\"../pwa-entre-la-web-y-las-apps-con-angular/\">PWA, Entre la web y las apps con Angular</a>. Al finalizar tendrs una aplicacin que ofrece lo que buscan tanto a personas como a robots.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h1 id=\"1-Angular-Universal\"><a href=\"#1-Angular-Universal\" class=\"headerlink\" title=\"1 Angular Universal\"></a>1 Angular Universal</h1><h2 id=\"1-1-Vuelta-al-servidor\"><a href=\"#1-1-Vuelta-al-servidor\" class=\"headerlink\" title=\"1.1 Vuelta al servidor\"></a>1.1 Vuelta al servidor</h2><blockquote><p>Tenemos: Angular naci para vivir en el navegador.</p></blockquote><ul><li><p>Para <strong>quitarle carga al servidor</strong> generando el contenido dinmico en el navegador en base a plantillas.</p></li><li><p>Para enviar por la red primero la aplicacin y despus los datos, <strong>ahorrando transferencia</strong> durante un uso continuado.</p></li><li><p>Para mejorar la <strong>experiencia del usuario</strong> al no percibir recarga de pgina durante la navegacin dentro de la aplicacin.</p></li></ul><p><strong>Ideal en entornos de intranet o aplicaciones de gestin de uso intensivo.</strong></p><p><strong>Problemtico para uso espordico o indexable pblicamente.</strong></p><blockquote><p>Queremos: Indexado SEO y velocidad en la primera visita y tambin en las sucesivas.</p></blockquote><h2 id=\"1-2-Para-mejorar-el-SEO\"><a href=\"#1-2-Para-mejorar-el-SEO\" class=\"headerlink\" title=\"1.2 Para mejorar el SEO\"></a>1.2 Para mejorar el SEO</h2><blockquote><p>El contenido se genera durante la ejecucin del JavaScript en el navegador.</p></blockquote><ul><li><p>Los <strong>robots</strong> no tienen nada significativo que indexar.</p></li><li><p>Las <strong>redes sociales</strong> no encuentran cabeceras para mejorar la presentacin de enlaces.</p></li></ul><p><strong>Hay que enviar el contenido ya generado.</strong></p><p><strong>Pero sin perder la experiencia de usuario durante la ejecucin.</strong></p><h2 id=\"1-3-Para-mejorar-la-experiencia-en-la-primera-visita\"><a href=\"#1-3-Para-mejorar-la-experiencia-en-la-primera-visita\" class=\"headerlink\" title=\"1.3 Para mejorar la experiencia en la primera visita\"></a>1.3 Para mejorar la experiencia en la primera visita</h2><blockquote><p>Para mostrar contenido antes hay que descargar y ejecutar la aplicacin.</p></blockquote><ul><li><p>Los <strong>usuarios</strong> ven una pgina vaca demasiado tiempo.</p></li><li><p>El <strong>peso de la descarga inicial</strong> es desproporcionado a pesar de <em>lazy loading</em>.</p></li></ul><p><strong>Hay que enviar el contenido ya generado.</strong></p><p><strong>Descargar la aplicacin en segundo plano.</strong></p><h1 id=\"2-Despliegue-con-Node-Express\"><a href=\"#2-Despliegue-con-Node-Express\" class=\"headerlink\" title=\"2 Despliegue con Node Express\"></a>2 Despliegue con Node Express</h1><p>El reto est en mantener lo bueno de las aplicaciones <em>JavaScript</em> como es la transicin fluida entre pginas, la interactividad o la descarga de datos bajo demanda, pero combinado con una mejor primera experiencia. Para ello la descarga del <code>index.html</code> tiene que venir con un documento html ya preparado con algo para mostrar y tardar lo menos posible en permitir la interaccin.</p><p>El <strong>tiempo para el primer pintado</strong> se ve penalizado por el tamao del <em>bundle</em> principal de Angular, pues en l reside habitualmente el componente <em>app</em> que acta de raz. Por supuesto que utilizar la carga diferida de mdulos es una manera obligada de reducir el peso del <em>main</em>. Todas las rutas, incluida la ruta base, deben ser <em>lazy</em> para retrasar la navegacin y que la descarga se produzca ms tarde. Slo el componente raz con la <em>shell</em> de navegacin bsica debera venir en el <em>bundle</em> principal.</p><p>Pero ni con eso es suficiente. El usuario no ver nada hasta que Angular se descargue, reclame el <em>bundle main</em>, lo procese y renderice ese <em>shell</em>. Hay usar alguna estrategia extra para reducir el tiempo de espera y entretener al usuario.</p><h2 id=\"2-1-Add-Express-Engine\"><a href=\"#2-1-Add-Express-Engine\" class=\"headerlink\" title=\"2.1 Add Express Engine\"></a>2.1 Add Express Engine</h2><p>Claro que esto es slo un truco para que ese primer momento de espera se reduzca y no perdamos potenciales visitantes. Si queremos algo ms, como por ejemplo que el contenido a descargar sea ms fresco, entonces necesitaremos <strong>renderizar en el servidor</strong>. Y para ello necesitaremos un servidor de verdad. El propuesto y mejor documentado es <em>Express de NodeJS</em>.</p><p>Para empezar tendrs que instalar y registrar las libraras necesarias. Adems habr que crear el pequeo servidor <em>Express</em>, y configurar al CLI para que haga el despliegue de ambos: cliente y servidor. Este laborioso trabajo se ha automatizado y ahora mismo se resuelve casi todo con una instruccin.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng add @nguniversal/express-engine --clientProject shop</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Scripts-de-compilado-y-despliegue\"><a href=\"#2-2-Scripts-de-compilado-y-despliegue\" class=\"headerlink\" title=\"2.2 Scripts de compilado y despliegue\"></a>2.2 Scripts de compilado y despliegue</h2><p>Cuando termina la generacin e instalacin, comienza el compilado. En este caso es doble, porque adems de la compilacin habitual que llamaremos <em>client-bundle</em>, habr que compilar el servidor con su propia versin de la aplicacin cliente. Ser el <em>server-bundle</em>.</p><p>Adems necesitamos una tercera compilacin (aunque no es propiamente de Angular) para el servidor <em>node/express</em> que ejecutar el <em>server-bundle</em>. Y por ltimo ya slo nos queda poner en marcha dicho servidor que se quedar a la espera de peticiones de pginas.</p><p>Todo esto se resume en los siguientes scripts, casi todos auto generados por el CLI.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"start:ssr\"</span>: <span class=\"string\">\"npm run build:ssr &amp;&amp; npm run serve:ssr\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"build:ssr\"</span>: <span class=\"string\">\"npm run build:client-and-server-bundles &amp;&amp; npm run compile:server\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"build:client-and-server-bundles\"</span>: <span class=\"string\">\"ng build --prod &amp;&amp; ng run shop:server:production --bundleDependencies all\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"compile:server\"</span>: <span class=\"string\">\"webpack --config webpack.server.config.js --progress --colors\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"serve:ssr\"</span>: <span class=\"string\">\"node dist/server\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Control-de-rutas\"><a href=\"#2-3-Control-de-rutas\" class=\"headerlink\" title=\"2.3 Control de rutas\"></a>2.3 Control de rutas</h2><p>El resultado es un servidor <em>Node</em> que a cada peticin web responde enviando el <code>index.html</code>. Pero, y esta es la clave, resolver la ruta ejecutando la aplicacin Angular antes de responder al navegador. De esa forma el <code>index.html</code> ir recin generado con el contenido tal cual lo vera el usuario tras la ejecucin de Angular en local. As que <strong>la espera al primer pintado significativo se reduce</strong> y eso es bueno.</p><p>Por si fuera poco, la principal ventaja al usar este mtodo es que al traer informacin dinmica puede usarse para indexar el contenido real del sitio. Esto es doblemente bueno, porque ahora todos <strong>los robots indexadores podrn catalogar tu <em>site</em></strong> como si de una web clsica se tratase. Y los usuarios humanos podrn continuar la ejecucin en local disfrutando de las ventajas de una SPA.</p><p>El trabajo del servidor a partir de ese momento ser maysculo. Recibe la peticin, invoca a su versin de nuestra aplicacin Angular y la ejecuta en memoria. El resultado es un documento HTML que devolver al usuario. Dar lo mismo que ruta se le pida y si se resuelve por lazy-loading. Va totalmente preparado y configurado para cargar el JavaScript oportuno y ejecutarlo como lo hara un navegador.</p><p>Comprubalo solicitando diversas rutas e inspeccionando la respuesta del servidor.</p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://localhost:4000</span><br><span class=\"line\">http://localhost:4000/rates</span><br></pre></td></tr></table></figure><p>De todas formas tengo que advertirte de que tomes todo esto con cautela por varios motivos:</p><ul><li>Tecnologa compleja estable pero con carencias</li><li>Herramientas de generacin buenas pero incompletas</li><li>Transferencia de estado manual para evitar llamadas repetidas al API</li></ul><p>Tampoco es sencilla la convivencia con libreras propias del <em>browser</em>, y menos si se trata de una PWA. Yo procuro usar un servicio que aisle al servidor de ciertas llamadas slo disponibles en el navegador, como por ejemplo todo lo relativo al <em>localStorage</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; isPlatformBrowser, isPlatformServer &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Inject, Injectable, PLATFORM_ID &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> UniversalService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"meta\">@Inject</span>(PLATFORM_ID) <span class=\"keyword\">private</span> platformId: <span class=\"built_in\">string</span></span>) &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> isBrowser() =&gt; isPlatformBrowser(<span class=\"keyword\">this</span>.platformId);</span><br><span class=\"line\">  <span class=\"keyword\">public</span> isServer() =&gt; isPlatformServer(<span class=\"keyword\">this</span>.platformId);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> saveOnStorage(key, value) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.isBrowser()) &#123;</span><br><span class=\"line\">      sessionStorage.setItem(key, value);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> loadFromStorage(key) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.isBrowser()) &#123;</span><br><span class=\"line\">      sessionStorage.getItem(key);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"3-Variantes-shell-y-pre-rendering\"><a href=\"#3-Variantes-shell-y-pre-rendering\" class=\"headerlink\" title=\"3 Variantes: shell y pre-rendering\"></a>3 Variantes: shell y pre-rendering</h1><p>La tcnica vista anteriormente resuelve los problemas de usuario y de robot SEO, pero a costa de cierta complejidad. Y, sobre todo, a costa de necesitar un servidor node en produccin.</p><p>En algunas situaciones queremos desplegar la aplicacin en un sencillo servidor de ficheros. A veces ni siquiera tenemos la necesidad del indexado completo.</p><p>Para esos caso tenemos alternativas ms sencillas.</p><h2 id=\"3-1-Shell-para-mejora-de-experiencia-inicial\"><a href=\"#3-1-Shell-para-mejora-de-experiencia-inicial\" class=\"headerlink\" title=\"3.1 Shell para mejora de experiencia inicial\"></a>3.1 Shell para mejora de experiencia inicial</h2><ul><li><p>Muestra un contenido instantneo mientras descarga la app.</p></li><li><p>Mejora la experiencia de usuario en la primera visita.</p></li><li><p>De cara al SEO, slo indexa el contenido inicial.</p></li></ul><blockquote><p>Adecuado para aplicaciones de usuario registrado, pero con un portal de bienvenida indexable y rpido.</p></blockquote><p>La ms sencilla es hacer que el <code>index.html</code>, habitualmente vaco, se rellene con un <strong>contenido visualizable mientras el proceso principal de Angular no arranca</strong>. En ocasiones basta con poner a mano algn mensaje o animacin que indique que estamos cargando. Pero cuanto ms se parezca esa primera visin al resultado final mejor para el usuario. As que lo propio sera que el <code>index.html</code> ya bajase con el <em>shell</em> real de la aplicacin.</p><p>Montar eso a mano no es la mejor opcin. La solucin parte de <strong>renderizar el <em>html</em> durante el proceso de <em>deploy</em></strong>. Se trata de configurar el CLI para que ejecute la aplicacin en la mquina del desarrollador sobre una ruta predefinida; y que copie el resultado sobre el <code>index.html</code> que enviar a distribucin.</p><p>Este trabajo se ha automatizado y se resuelve con un par de comandos del Angular CLI.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g app-shell --client-project shop --universal-project server-shop</span><br></pre></td></tr></table></figure><p>El efecto de este comando se materializa especialmente con la aparicin de nuevos <em>targets para los builders</em> del CLI en el fichero <code>angular.json</code>.</p><p>Con el comando <code>ng run shop:app-shell</code> podrs generar una versin especial de distribucin en al que el <code>index.html</code> ya va prerenderizado con el contenido del componente asociado a la ruta <em>shell</em>. Realmente lo que hace es ejecutar tu aplicacin sobre una ruta predefinida, tomar el <em>html</em> resultado e inyectarlo en el <em>body</em> del <code>index.html</code> que ir a distribucin.</p><blockquote><p>Por cierto, esta tcnica no obliga a disponer de ningn servidor web especial. Sigue funcionando con un servidor esttico de ficheros pues la prerenderizacin se produjo en la mquina del programador.</p></blockquote><h2 id=\"3-2-Pre-renderizado-de-toda-la-aplicacion\"><a href=\"#3-2-Pre-renderizado-de-toda-la-aplicacion\" class=\"headerlink\" title=\"3.2 Pre renderizado de toda la aplicacin\"></a>3.2 Pre renderizado de toda la aplicacin</h2><ul><li><p>Se trata de volver no slo al servidor web, si no al servidor de ficheros.</p></li><li><p>La idea es invocar repetidamente al SSR y almacenar el HTML resultante en ficheros fsicos.</p></li><li><p>En produccin, los robots y los usuarios recibirn ya esas copias pre generadas.</p></li><li><p>Para mantener el sistema actualizado se necesita regenerar frecuentemente los ficheros</p></li></ul><blockquote><p>Adecuado para blogs y sitios que no puedan o no quieran tener un servidor web corriendo.</p></blockquote><p>A falta de una solucin oficial, podemos seguir la pista a iniciativas tipo <a href=\"https://github.com/chrisguttandin/angular-prerender\" target=\"_blank\" rel=\"noopener\">Angular Prerender</a></p><h1 id=\"4-SEO-en-la-pagina-en-el-navegador-y-en-el-servidor\"><a href=\"#4-SEO-en-la-pagina-en-el-navegador-y-en-el-servidor\" class=\"headerlink\" title=\"4 SEO en la pgina, en el navegador y en el servidor\"></a>4 SEO en la pgina, en el navegador y en el servidor</h1><p>Con lo visto hasta ahora tu aplicacin estar ms que cubierta en cuanto a ofrecer la mejor experiencia para usuarios al tiempo que enva contenido indexable para robots Pero falta algo.</p><p>Habitualmente las aplicaciones Angular manejan el contenido visible de una pgina web; es decir, el <em>body</em>. Para <strong>acceder y cambiar el contenido del <em>header</em></strong>, tan utilizado por los robots de redes sociales, hay que usar algo ms.</p><h2 id=\"4-1-Titulo-y-meta-etiquetas-de-pagina\"><a href=\"#4-1-Titulo-y-meta-etiquetas-de-pagina\" class=\"headerlink\" title=\"4.1 Titulo y meta etiquetas de pgina\"></a>4.1 Titulo y meta etiquetas de pgina</h2><p>Como parte del <em>framework</em> viene la librera <em>platform-browser</em> dnde tenemos un par de servicios para manipular el ttulo y cualquier etiqueta de meta informacin de la pgina.</p><p>Para ello suele usarse un cdigo similar a este en el componente raz de la aplicacin. Es muy sencillo pero te dar una idea del potencial de estos servicios:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Meta, Title &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'app-root'</span>,</span><br><span class=\"line\">  template: <span class=\"string\">`&lt;p&gt;Aprende a usar el framework Angular&lt;/p&gt;`</span>,</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> title: Title, <span class=\"keyword\">private</span> meta: Meta</span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.title.setTitle(<span class=\"string\">'My title'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.meta.addTag(&#123; property: <span class=\"string\">'og:title'</span>, content: <span class=\"string\">'My title'</span> &#125;, <span class=\"literal\">true</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora ya tienes una aplicacin que satisface a usuarios y robots por igual. Contina tu formacin avanzada para crear aplicaciones Angular para el mundo globalizado con tcnicas de <a href=\"../internacionalizacion-y-puesta-en-produccion-con-Angular/\">Internacionalizacin y puesta en produccin</a> y vers como aprendes a programar con Angular 8.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"PWA, Entre la web y las apps con Angular","date":"2019-10-03T17:50:27.000Z","thumbnail":"/css/images/angular-16_pwa.png","_content":"\n![pwa-entre-la-web-y-las-apps-con-angular](/images/tutorial-angular-16_pwa.png)\n\nLas aplicaciones web han evolucionado desde el contenido esttico al dinmico, luego al adaptable y ahora se acercan **progresivamente a la experiencia y rendimiento de aplicaciones nativas**. En Angular se incorporan esas capacidades desde el propio *framework*.\n\nMediante la librera `@ngular/pwa` dispondremos de todo lo necesario para ofrecer instalacin en escritorio, actualizar la aplicacin controladamente, recibir notificaciones del servidor e incluso mejoras en la cach de comunicaciones que pudieran permitir un funcionamiento *offline*.\n\n\n<!-- more -->\n\nPartiendo del cdigo tal como qued en [El patrn Redux con NgRx en Angular](../el-patron-redux-con-ngrx-en-angular/). Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n# 1 Las herramientas de la librera PWA\n\nAprovechando las nuevas caractersticas del *Angular CLI* tenemos el comando `ng add @angular/pwa` que instala los paquetes y configura cualquier aplicacin Angular convirtindola en una *PWA* bsica.\n\nEstos son los actores y ficheros involucrados en este proceso tras la agregacin del paquete `pwa`.\n\n- ServiceWorkerModule\n- ./angular.json { \"serviceWorker\": true }\n- ./ngsw-config.json\n- ./src/manifest.webmanifest\n- ./src/index.html\n- ./assets/icons/..\n\nCon todo instalado y configurado, querrs probar que funciona. Pero, a primera vista no ocurre nada. **Las caractersticas *PWA* estn preparadas para funcionar en modo produccin**. As que lo primero ser ejecutar el comando `ng build --prod` y lanzar un servidor sobre la carpeta de distribucin recin creada.\n\nDe entre los nuevos ficheros que aparecen hay dos que debes conocer especialmente, **el *manifest* y el *service worker***.\n\n## 1.1 El manifest.webmanifest\n\nEste sencillo documento acompaa al `index.html` y le da indicaciones al navegador para que trate esta aplicacin de manera especial. El fichero en s contiene una *metadata* con textos descriptivos, colores e iconos para ser usados por el navegador y el sistema operativo y **ofrecerle al usuario que instale la *web* como una *app***.\n\nCasi todo es cosmtico, pero merece la pena prestar especial atencin a los iconos. Por defecto el *CLI* instala distintas versiones del logo oficial de Angular. Una forma cmoda de sustituirlo por los tuyos es usar la herramienta [*ngx-pwa-icons*](https://www.npmjs.com/package/ngx-pwa-icons)\n\n```json\n{\n  \"name\": \"shop\",\n  \"short_name\": \"shop\",\n  \"theme_color\": \"#1976d2\",\n  \"background_color\": \"#fafafa\",\n  \"display\": \"standalone\",\n  \"scope\": \"/\",\n  \"start_url\": \"/\",\n  \"icons\": [\n    {\n      \"src\": \"assets/icons/icon-72x72.png\",\n      \"sizes\": \"72x72\",\n      \"type\": \"image/png\"\n    },\n    ...\n   ]\n}\n```\n\n> Asegrate de que en la `start_url` apunte a la pgina de inicio correcta y despliega en modo produccin en un servidor seguro con *https*. Prubalo varias veces en distintos navegadores y vers las distintas experiencias de instalacin que ofrecen.\n\n## 1.2 El ngsw-worker.js\n\nEl otro gran fichero, y ms importante para los desarrolladores, es **el configurador del *Service Worker***. Cuando un navegador ejecuta un *script* lo hace en *thread* dedicado a la interaccin con el usuario y la manipulacin del *DOM*. Normalmente ese hilo est muy ocupado, cuando no est saturado. La solucin para agilizar los procesos est en usar ms *threads*. Presentamos el *worker thread*.\n\nSe le llama as a los hilos creados a partir del principal y que le ayudan en tareas en segundo plano. Esos hilos tienen **prohibido el acceso al DOM, ni lo escuchan ni lo manipulan**. Pero a cambio estn muy liberados para realizar clculos complejos o llamadas a servicios. Se comunican con el *thread* principal a travs de un sencillo protocolo de eventos y subscripciones.\n\nUna de las tareas para las que ms se les utiliza es para la gestin inteligente de las comunicaciones. Este fichero viene pre programado para realizar las siguientes **funciones PWA de Angular**:\n\n- Cach de contenido esttico para funcionamiento offline\n- Cach de datos dinmicos para mayor velocidad\n- Gestin de instalaciones y versiones\n- Notificaciones de datos push\n\nTodo lo que hay que hacer es configurar estas funciones en un fichero, el `ngsw-config.json`, ya generado con valores por defecto. El *CLI*, durante el proceso de construccin en modo produccin, copiar y manipular los scripts y sus configuraciones. En ejecucin, el `AppModule` registrar el script en el navegador, se subscribir a sus eventos y ejecutar lo configurado por el programador en el *json*.\n\n\n# 2 Comunicaciones y cach\n\n**El service worker de Angular** est especialmente diseado para hacerse cargo de las comunicaciones con el servidor. Digamos que se convierte en un **interceptor transparente de todas las peticiones http**. Tanto de los ficheros propios de la aplicacin como de las comunicaciones de datos.\n\n## 2.1 Descarga y actualizacin de la aplicacin\n\nUna vez descargado el *index.html* con el contenido mnimo de Angular, diramos que la aplicacin se ha instalado y est lista para ejecutarse. A partir de ese momento el *ngsw* toma el control y puede pre descargar ficheros en segundo plano; de forma que **cuando sean reclamados ya estn disponibles** y mejoren la experiencia del usuario.\n\nRutinariamente el servicio se ocupar de consultar novedades en el servidor para mantener los ficheros locales actualizados. Todo ello se configura en la seccin `assetGroups` del  `ngsw-config.json`.\n\n### Default: Full App\n\nSe descarga la aplicacin completa. Tranquilidad, esto sucede en segundo plano y una vez arrancado angular y con el usuario contento viendo ya la pgina pedida. Al navegar por las pginas la respuesta es instantnea porque los mdulos con el cdigo ya estn ah.\n\n```json\n  \"assetGroups\": [\n    {\n      \"name\": \"app\",\n      \"installMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\n          \"/favicon.ico\", \"/index.html\",\n          \"/manifest.webmanifest\",  \"/*.css\", \"/*.js\"\n        ]\n      }\n    },\n    {\n      \"name\": \"assets\",\n      \"installMode\": \"lazy\",\n      \"updateMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\n          \"/assets/**\",\n          \"/*.(eot|svg|cur|jpg|png|webp|gif|otf|ttf|woff|woff2|ani)\"\n        ]\n      }\n    }\n  ],\n```\n\nEso s, la descarga consume lnea. En cierto casos, con usuarios mviles y grandes aplicaciones quizs no sea adecuado. Si prefieres que los mdulos Lazy no se descarguen hasta que nose visiten, te propongo esta otra configuracin.\n\n### Proposed: Lazy App\n\n```json\n  \"assetGroups\":[\n    {\n      \"name\": \"coreapp\",\n      \"installMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\n          \"/favicon.ico\",\n          \"/index.html\",\n          \"/manifest.webmanifest\",\n          \"/*.css\",\n          \"/common*.js\",\n          \"/main*.js\",\n          \"/ngsw*.js\",\n          \"/*woker*.js\",\n          \"/*polyfills*.js\",\n          \"/runtime*.js\"\n        ]\n      }\n    },\n    {\n      \"name\": \"lazyapp\",\n      \"installMode\": \"lazy\",\n      \"updateMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\"/*.js\"]\n      }\n    }...\n```\n\n\n## 2.2 Cach inteligente de datos\n\nEl control de la **recepcin de datos dinmicos** es la otra gran tarea del *service worker*. En este caso para tener una cach que acelere la presentacin de datos o que incluso permita un funcionamiento *offline*.\n\nMediante **dos estrategias complementarias que tratan de mantener los datos actualizados y disponibles** en todo momento. En este caso configurndolo en los `dataGroups`.\n\n> La idea del *cache-first* es tener el dato ya listo para ser usado cuanto antes. Mientras que con *api-first* se pretende tener la versin ms actual posible, y usar la ltima descargada en caso de problemas o desconexin total.\n\n```json\n \"dataGroups\": [\n  {\n    \"name\": \"cache-first-greeting\",\n    \"urls\": [\n      \"http://localhost:3333/api\"\n    ],\n    \"cacheConfig\": {\n      \"strategy\": \"performance\",\n      \"maxAge\": \"1d\",\n      \"maxSize\": 10\n    }\n  },\n  {\n    \"name\": \"api-first-rates\",\n    \"urls\": [\n      \"https://api.exchangeratesapi.io/latest?symbols=GBP\",\n      \"https://api.exchangeratesapi.io/latest\"\n    ],\n    \"cacheConfig\": {\n      \"strategy\": \"freshness\",\n      \"timeout\": \"5s\",\n      \"maxAge\": \"1h\",\n      \"maxSize\": 10,\n    }\n  }\n]\n```\n\n# 3 Servicios\n\nLa librera `@angular/pwa` publica el mdulo `ServiceWorkerModule` que contiene la lgica de registro del *service worker* y dos servicios programables con los que interactuar desde el cdigo de tu aplicacin Angular.\n\n## 3.1 Actualizacin con el SwUpdate\n\nCuando despliegas una nueva versin seguro que ests deseando que los usuarios disfruten cuanto antes de las mejoras o correcciones. Pero en las aplicaciones SPA resulta que **la actualizacin no es tan inmediata** como pudiera parecer. Al no forzar la recarga del documento en las navegaciones internas, el `index.html` puede residir sin cambios ms de lo debido. Confiar en que lo hagan el navegador o el usuario puede no ser una opcin.\n\nLa solucin PWA es usar el `ServiceWorker` para detectar nuevas versiones en el servidor. Para ello utiliza un sistema propio de *hashes* que le permite comparar la versin descargada y la disponible en el servidor.** Cuando detecta un cambio emite un evento al que te puedes subscribir** usando el servicio `SwUpdate`. En ese momento puedes consultar al usuario, o forzar a lo bestia la recarga ;-).\n\n\n```typescript\nconstructor(private swUpdate: SwUpdate) {\n  if (this.swUpdate.isEnabled) {\n    this.swUpdate.available.subscribe((event: UpdateAvailableEvent) => {\n      if (confirm(`Do you want to update?`)) {\n        window.location.reload();\n      }\n    });\n  }\n}\n```\n\n## 3.2 Notificaciones con el SwPush\n\nUna caracterstica de las *apps* nativas muy aprecia por los usuarios es la capacidad de mostrar **mensajes recibidos va *push* por parte del servidor**. Pueden ser avisos, novedades o simple marketing. Pero lo importante es que lo recibe el sistema operativo, la aplicacin no necesita estar en marcha y el mensaje se muestra de forma nativa.\n\n> Obviamente para ello hay que involucrar cdigo de servidor y un servicio de mensajera de terceros. Pero la parte Angular del desarrollo es muy sencilla. Consiste en registrar al usuario, que voluntariamente decide ser notificado, y luego escuchar los mensajes provenientes en forma de eventos. Todo ello reclamando una dependencia al servicio de notificaciones `constructor(private swPush: SwPush)`.\n\n```typescript\nconstructor(private swUpdate: SwUpdate) {\n  if (this.swPush.isEnabled) {\n      this.swPush\n        .requestSubscription({ serverPublicKey: 'VAPID_PUBLIC_KEY' })\n        .then(sub => {\n          console.log('send subscription to your server and wait form messages', sub.toJSON());\n          this.swPush.messages.subscribe(msg => console.log('Received: ', msg));\n        })\n    }\n}\n```\n\nYa tienes una web que se comporta progresivamente como una App nativa, una *Progressive Web Application*. Las mejoras en rendimiento y experiencia de usuario son recompensa ms que suficiente para que le des una oportunidad a las **Angular PWA**.\n\nContina tu formacin avanzada para crear aplicaciones con mayor [Velocidad y SEO con el SSR de Angular Universal](../velocidad-y-seo-con-el-ssr-de-angular-universal) y vers como aprendes a programar con Angular 8.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-16-PWA-Entre-la-web-y-las-apps-con-Angular.md","raw":"---\ntitle: PWA, Entre la web y las apps con Angular\npermalink: pwa-entre-la-web-y-las-apps-con-angular\ndate: 2019-10-03 19:50:27\ntags:\n- Angular\n- Angular8\n- Angular2\n- PWA\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-16_pwa.png\n---\n\n![pwa-entre-la-web-y-las-apps-con-angular](/images/tutorial-angular-16_pwa.png)\n\nLas aplicaciones web han evolucionado desde el contenido esttico al dinmico, luego al adaptable y ahora se acercan **progresivamente a la experiencia y rendimiento de aplicaciones nativas**. En Angular se incorporan esas capacidades desde el propio *framework*.\n\nMediante la librera `@ngular/pwa` dispondremos de todo lo necesario para ofrecer instalacin en escritorio, actualizar la aplicacin controladamente, recibir notificaciones del servidor e incluso mejoras en la cach de comunicaciones que pudieran permitir un funcionamiento *offline*.\n\n\n<!-- more -->\n\nPartiendo del cdigo tal como qued en [El patrn Redux con NgRx en Angular](../el-patron-redux-con-ngrx-en-angular/). Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n\n# 1 Las herramientas de la librera PWA\n\nAprovechando las nuevas caractersticas del *Angular CLI* tenemos el comando `ng add @angular/pwa` que instala los paquetes y configura cualquier aplicacin Angular convirtindola en una *PWA* bsica.\n\nEstos son los actores y ficheros involucrados en este proceso tras la agregacin del paquete `pwa`.\n\n- ServiceWorkerModule\n- ./angular.json { \"serviceWorker\": true }\n- ./ngsw-config.json\n- ./src/manifest.webmanifest\n- ./src/index.html\n- ./assets/icons/..\n\nCon todo instalado y configurado, querrs probar que funciona. Pero, a primera vista no ocurre nada. **Las caractersticas *PWA* estn preparadas para funcionar en modo produccin**. As que lo primero ser ejecutar el comando `ng build --prod` y lanzar un servidor sobre la carpeta de distribucin recin creada.\n\nDe entre los nuevos ficheros que aparecen hay dos que debes conocer especialmente, **el *manifest* y el *service worker***.\n\n## 1.1 El manifest.webmanifest\n\nEste sencillo documento acompaa al `index.html` y le da indicaciones al navegador para que trate esta aplicacin de manera especial. El fichero en s contiene una *metadata* con textos descriptivos, colores e iconos para ser usados por el navegador y el sistema operativo y **ofrecerle al usuario que instale la *web* como una *app***.\n\nCasi todo es cosmtico, pero merece la pena prestar especial atencin a los iconos. Por defecto el *CLI* instala distintas versiones del logo oficial de Angular. Una forma cmoda de sustituirlo por los tuyos es usar la herramienta [*ngx-pwa-icons*](https://www.npmjs.com/package/ngx-pwa-icons)\n\n```json\n{\n  \"name\": \"shop\",\n  \"short_name\": \"shop\",\n  \"theme_color\": \"#1976d2\",\n  \"background_color\": \"#fafafa\",\n  \"display\": \"standalone\",\n  \"scope\": \"/\",\n  \"start_url\": \"/\",\n  \"icons\": [\n    {\n      \"src\": \"assets/icons/icon-72x72.png\",\n      \"sizes\": \"72x72\",\n      \"type\": \"image/png\"\n    },\n    ...\n   ]\n}\n```\n\n> Asegrate de que en la `start_url` apunte a la pgina de inicio correcta y despliega en modo produccin en un servidor seguro con *https*. Prubalo varias veces en distintos navegadores y vers las distintas experiencias de instalacin que ofrecen.\n\n## 1.2 El ngsw-worker.js\n\nEl otro gran fichero, y ms importante para los desarrolladores, es **el configurador del *Service Worker***. Cuando un navegador ejecuta un *script* lo hace en *thread* dedicado a la interaccin con el usuario y la manipulacin del *DOM*. Normalmente ese hilo est muy ocupado, cuando no est saturado. La solucin para agilizar los procesos est en usar ms *threads*. Presentamos el *worker thread*.\n\nSe le llama as a los hilos creados a partir del principal y que le ayudan en tareas en segundo plano. Esos hilos tienen **prohibido el acceso al DOM, ni lo escuchan ni lo manipulan**. Pero a cambio estn muy liberados para realizar clculos complejos o llamadas a servicios. Se comunican con el *thread* principal a travs de un sencillo protocolo de eventos y subscripciones.\n\nUna de las tareas para las que ms se les utiliza es para la gestin inteligente de las comunicaciones. Este fichero viene pre programado para realizar las siguientes **funciones PWA de Angular**:\n\n- Cach de contenido esttico para funcionamiento offline\n- Cach de datos dinmicos para mayor velocidad\n- Gestin de instalaciones y versiones\n- Notificaciones de datos push\n\nTodo lo que hay que hacer es configurar estas funciones en un fichero, el `ngsw-config.json`, ya generado con valores por defecto. El *CLI*, durante el proceso de construccin en modo produccin, copiar y manipular los scripts y sus configuraciones. En ejecucin, el `AppModule` registrar el script en el navegador, se subscribir a sus eventos y ejecutar lo configurado por el programador en el *json*.\n\n\n# 2 Comunicaciones y cach\n\n**El service worker de Angular** est especialmente diseado para hacerse cargo de las comunicaciones con el servidor. Digamos que se convierte en un **interceptor transparente de todas las peticiones http**. Tanto de los ficheros propios de la aplicacin como de las comunicaciones de datos.\n\n## 2.1 Descarga y actualizacin de la aplicacin\n\nUna vez descargado el *index.html* con el contenido mnimo de Angular, diramos que la aplicacin se ha instalado y est lista para ejecutarse. A partir de ese momento el *ngsw* toma el control y puede pre descargar ficheros en segundo plano; de forma que **cuando sean reclamados ya estn disponibles** y mejoren la experiencia del usuario.\n\nRutinariamente el servicio se ocupar de consultar novedades en el servidor para mantener los ficheros locales actualizados. Todo ello se configura en la seccin `assetGroups` del  `ngsw-config.json`.\n\n### Default: Full App\n\nSe descarga la aplicacin completa. Tranquilidad, esto sucede en segundo plano y una vez arrancado angular y con el usuario contento viendo ya la pgina pedida. Al navegar por las pginas la respuesta es instantnea porque los mdulos con el cdigo ya estn ah.\n\n```json\n  \"assetGroups\": [\n    {\n      \"name\": \"app\",\n      \"installMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\n          \"/favicon.ico\", \"/index.html\",\n          \"/manifest.webmanifest\",  \"/*.css\", \"/*.js\"\n        ]\n      }\n    },\n    {\n      \"name\": \"assets\",\n      \"installMode\": \"lazy\",\n      \"updateMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\n          \"/assets/**\",\n          \"/*.(eot|svg|cur|jpg|png|webp|gif|otf|ttf|woff|woff2|ani)\"\n        ]\n      }\n    }\n  ],\n```\n\nEso s, la descarga consume lnea. En cierto casos, con usuarios mviles y grandes aplicaciones quizs no sea adecuado. Si prefieres que los mdulos Lazy no se descarguen hasta que nose visiten, te propongo esta otra configuracin.\n\n### Proposed: Lazy App\n\n```json\n  \"assetGroups\":[\n    {\n      \"name\": \"coreapp\",\n      \"installMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\n          \"/favicon.ico\",\n          \"/index.html\",\n          \"/manifest.webmanifest\",\n          \"/*.css\",\n          \"/common*.js\",\n          \"/main*.js\",\n          \"/ngsw*.js\",\n          \"/*woker*.js\",\n          \"/*polyfills*.js\",\n          \"/runtime*.js\"\n        ]\n      }\n    },\n    {\n      \"name\": \"lazyapp\",\n      \"installMode\": \"lazy\",\n      \"updateMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\"/*.js\"]\n      }\n    }...\n```\n\n\n## 2.2 Cach inteligente de datos\n\nEl control de la **recepcin de datos dinmicos** es la otra gran tarea del *service worker*. En este caso para tener una cach que acelere la presentacin de datos o que incluso permita un funcionamiento *offline*.\n\nMediante **dos estrategias complementarias que tratan de mantener los datos actualizados y disponibles** en todo momento. En este caso configurndolo en los `dataGroups`.\n\n> La idea del *cache-first* es tener el dato ya listo para ser usado cuanto antes. Mientras que con *api-first* se pretende tener la versin ms actual posible, y usar la ltima descargada en caso de problemas o desconexin total.\n\n```json\n \"dataGroups\": [\n  {\n    \"name\": \"cache-first-greeting\",\n    \"urls\": [\n      \"http://localhost:3333/api\"\n    ],\n    \"cacheConfig\": {\n      \"strategy\": \"performance\",\n      \"maxAge\": \"1d\",\n      \"maxSize\": 10\n    }\n  },\n  {\n    \"name\": \"api-first-rates\",\n    \"urls\": [\n      \"https://api.exchangeratesapi.io/latest?symbols=GBP\",\n      \"https://api.exchangeratesapi.io/latest\"\n    ],\n    \"cacheConfig\": {\n      \"strategy\": \"freshness\",\n      \"timeout\": \"5s\",\n      \"maxAge\": \"1h\",\n      \"maxSize\": 10,\n    }\n  }\n]\n```\n\n# 3 Servicios\n\nLa librera `@angular/pwa` publica el mdulo `ServiceWorkerModule` que contiene la lgica de registro del *service worker* y dos servicios programables con los que interactuar desde el cdigo de tu aplicacin Angular.\n\n## 3.1 Actualizacin con el SwUpdate\n\nCuando despliegas una nueva versin seguro que ests deseando que los usuarios disfruten cuanto antes de las mejoras o correcciones. Pero en las aplicaciones SPA resulta que **la actualizacin no es tan inmediata** como pudiera parecer. Al no forzar la recarga del documento en las navegaciones internas, el `index.html` puede residir sin cambios ms de lo debido. Confiar en que lo hagan el navegador o el usuario puede no ser una opcin.\n\nLa solucin PWA es usar el `ServiceWorker` para detectar nuevas versiones en el servidor. Para ello utiliza un sistema propio de *hashes* que le permite comparar la versin descargada y la disponible en el servidor.** Cuando detecta un cambio emite un evento al que te puedes subscribir** usando el servicio `SwUpdate`. En ese momento puedes consultar al usuario, o forzar a lo bestia la recarga ;-).\n\n\n```typescript\nconstructor(private swUpdate: SwUpdate) {\n  if (this.swUpdate.isEnabled) {\n    this.swUpdate.available.subscribe((event: UpdateAvailableEvent) => {\n      if (confirm(`Do you want to update?`)) {\n        window.location.reload();\n      }\n    });\n  }\n}\n```\n\n## 3.2 Notificaciones con el SwPush\n\nUna caracterstica de las *apps* nativas muy aprecia por los usuarios es la capacidad de mostrar **mensajes recibidos va *push* por parte del servidor**. Pueden ser avisos, novedades o simple marketing. Pero lo importante es que lo recibe el sistema operativo, la aplicacin no necesita estar en marcha y el mensaje se muestra de forma nativa.\n\n> Obviamente para ello hay que involucrar cdigo de servidor y un servicio de mensajera de terceros. Pero la parte Angular del desarrollo es muy sencilla. Consiste en registrar al usuario, que voluntariamente decide ser notificado, y luego escuchar los mensajes provenientes en forma de eventos. Todo ello reclamando una dependencia al servicio de notificaciones `constructor(private swPush: SwPush)`.\n\n```typescript\nconstructor(private swUpdate: SwUpdate) {\n  if (this.swPush.isEnabled) {\n      this.swPush\n        .requestSubscription({ serverPublicKey: 'VAPID_PUBLIC_KEY' })\n        .then(sub => {\n          console.log('send subscription to your server and wait form messages', sub.toJSON());\n          this.swPush.messages.subscribe(msg => console.log('Received: ', msg));\n        })\n    }\n}\n```\n\nYa tienes una web que se comporta progresivamente como una App nativa, una *Progressive Web Application*. Las mejoras en rendimiento y experiencia de usuario son recompensa ms que suficiente para que le des una oportunidad a las **Angular PWA**.\n\nContina tu formacin avanzada para crear aplicaciones con mayor [Velocidad y SEO con el SSR de Angular Universal](../velocidad-y-seo-con-el-ssr-de-angular-universal) y vers como aprendes a programar con Angular 8.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"pwa-entre-la-web-y-las-apps-con-angular","published":1,"updated":"2019-10-16T14:23:01.026Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab1j000qbss3vbuehb0z","content":"<p><img src=\"/images/tutorial-angular-16_pwa.png\" alt=\"pwa-entre-la-web-y-las-apps-con-angular\"></p><p>Las aplicaciones web han evolucionado desde el contenido esttico al dinmico, luego al adaptable y ahora se acercan <strong>progresivamente a la experiencia y rendimiento de aplicaciones nativas</strong>. En Angular se incorporan esas capacidades desde el propio <em>framework</em>.</p><p>Mediante la librera <code>@ngular/pwa</code> dispondremos de todo lo necesario para ofrecer instalacin en escritorio, actualizar la aplicacin controladamente, recibir notificaciones del servidor e incluso mejoras en la cach de comunicaciones que pudieran permitir un funcionamiento <em>offline</em>.</p><a id=\"more\"></a><p>Partiendo del cdigo tal como qued en <a href=\"../el-patron-redux-con-ngrx-en-angular/\">El patrn Redux con NgRx en Angular</a>. Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h1 id=\"1-Las-herramientas-de-la-libreria-PWA\"><a href=\"#1-Las-herramientas-de-la-libreria-PWA\" class=\"headerlink\" title=\"1 Las herramientas de la librera PWA\"></a>1 Las herramientas de la librera PWA</h1><p>Aprovechando las nuevas caractersticas del <em>Angular CLI</em> tenemos el comando <code>ng add @angular/pwa</code> que instala los paquetes y configura cualquier aplicacin Angular convirtindola en una <em>PWA</em> bsica.</p><p>Estos son los actores y ficheros involucrados en este proceso tras la agregacin del paquete <code>pwa</code>.</p><ul><li>ServiceWorkerModule</li><li>./angular.json { serviceWorker: true }</li><li>./ngsw-config.json</li><li>./src/manifest.webmanifest</li><li>./src/index.html</li><li>./assets/icons/..</li></ul><p>Con todo instalado y configurado, querrs probar que funciona. Pero, a primera vista no ocurre nada. <strong>Las caractersticas <em>PWA</em> estn preparadas para funcionar en modo produccin</strong>. As que lo primero ser ejecutar el comando <code>ng build --prod</code> y lanzar un servidor sobre la carpeta de distribucin recin creada.</p><p>De entre los nuevos ficheros que aparecen hay dos que debes conocer especialmente, <strong>el <em>manifest</em> y el <em>service worker</em></strong>.</p><h2 id=\"1-1-El-manifest-webmanifest\"><a href=\"#1-1-El-manifest-webmanifest\" class=\"headerlink\" title=\"1.1 El manifest.webmanifest\"></a>1.1 El manifest.webmanifest</h2><p>Este sencillo documento acompaa al <code>index.html</code> y le da indicaciones al navegador para que trate esta aplicacin de manera especial. El fichero en s contiene una <em>metadata</em> con textos descriptivos, colores e iconos para ser usados por el navegador y el sistema operativo y <strong>ofrecerle al usuario que instale la <em>web</em> como una <em>app</em></strong>.</p><p>Casi todo es cosmtico, pero merece la pena prestar especial atencin a los iconos. Por defecto el <em>CLI</em> instala distintas versiones del logo oficial de Angular. Una forma cmoda de sustituirlo por los tuyos es usar la herramienta <a href=\"https://www.npmjs.com/package/ngx-pwa-icons\" target=\"_blank\" rel=\"noopener\"><em>ngx-pwa-icons</em></a></p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"shop\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"short_name\"</span>: <span class=\"string\">\"shop\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"theme_color\"</span>: <span class=\"string\">\"#1976d2\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"background_color\"</span>: <span class=\"string\">\"#fafafa\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"display\"</span>: <span class=\"string\">\"standalone\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"scope\"</span>: <span class=\"string\">\"/\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"start_url\"</span>: <span class=\"string\">\"/\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"icons\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"src\"</span>: <span class=\"string\">\"assets/icons/icon-72x72.png\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"sizes\"</span>: <span class=\"string\">\"72x72\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"image/png\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    ...</span><br><span class=\"line\">   ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Asegrate de que en la <code>start_url</code> apunte a la pgina de inicio correcta y despliega en modo produccin en un servidor seguro con <em>https</em>. Prubalo varias veces en distintos navegadores y vers las distintas experiencias de instalacin que ofrecen.</p></blockquote><h2 id=\"1-2-El-ngsw-worker-js\"><a href=\"#1-2-El-ngsw-worker-js\" class=\"headerlink\" title=\"1.2 El ngsw-worker.js\"></a>1.2 El ngsw-worker.js</h2><p>El otro gran fichero, y ms importante para los desarrolladores, es <strong>el configurador del <em>Service Worker</em></strong>. Cuando un navegador ejecuta un <em>script</em> lo hace en <em>thread</em> dedicado a la interaccin con el usuario y la manipulacin del <em>DOM</em>. Normalmente ese hilo est muy ocupado, cuando no est saturado. La solucin para agilizar los procesos est en usar ms <em>threads</em>. Presentamos el <em>worker thread</em>.</p><p>Se le llama as a los hilos creados a partir del principal y que le ayudan en tareas en segundo plano. Esos hilos tienen <strong>prohibido el acceso al DOM, ni lo escuchan ni lo manipulan</strong>. Pero a cambio estn muy liberados para realizar clculos complejos o llamadas a servicios. Se comunican con el <em>thread</em> principal a travs de un sencillo protocolo de eventos y subscripciones.</p><p>Una de las tareas para las que ms se les utiliza es para la gestin inteligente de las comunicaciones. Este fichero viene pre programado para realizar las siguientes <strong>funciones PWA de Angular</strong>:</p><ul><li>Cach de contenido esttico para funcionamiento offline</li><li>Cach de datos dinmicos para mayor velocidad</li><li>Gestin de instalaciones y versiones</li><li>Notificaciones de datos push</li></ul><p>Todo lo que hay que hacer es configurar estas funciones en un fichero, el <code>ngsw-config.json</code>, ya generado con valores por defecto. El <em>CLI</em>, durante el proceso de construccin en modo produccin, copiar y manipular los scripts y sus configuraciones. En ejecucin, el <code>AppModule</code> registrar el script en el navegador, se subscribir a sus eventos y ejecutar lo configurado por el programador en el <em>json</em>.</p><h1 id=\"2-Comunicaciones-y-cache\"><a href=\"#2-Comunicaciones-y-cache\" class=\"headerlink\" title=\"2 Comunicaciones y cach\"></a>2 Comunicaciones y cach</h1><p><strong>El service worker de Angular</strong> est especialmente diseado para hacerse cargo de las comunicaciones con el servidor. Digamos que se convierte en un <strong>interceptor transparente de todas las peticiones http</strong>. Tanto de los ficheros propios de la aplicacin como de las comunicaciones de datos.</p><h2 id=\"2-1-Descarga-y-actualizacion-de-la-aplicacion\"><a href=\"#2-1-Descarga-y-actualizacion-de-la-aplicacion\" class=\"headerlink\" title=\"2.1 Descarga y actualizacin de la aplicacin\"></a>2.1 Descarga y actualizacin de la aplicacin</h2><p>Una vez descargado el <em>index.html</em> con el contenido mnimo de Angular, diramos que la aplicacin se ha instalado y est lista para ejecutarse. A partir de ese momento el <em>ngsw</em> toma el control y puede pre descargar ficheros en segundo plano; de forma que <strong>cuando sean reclamados ya estn disponibles</strong> y mejoren la experiencia del usuario.</p><p>Rutinariamente el servicio se ocupar de consultar novedades en el servidor para mantener los ficheros locales actualizados. Todo ello se configura en la seccin <code>assetGroups</code> del <code>ngsw-config.json</code>.</p><h3 id=\"Default-Full-App\"><a href=\"#Default-Full-App\" class=\"headerlink\" title=\"Default: Full App\"></a>Default: Full App</h3><p>Se descarga la aplicacin completa. Tranquilidad, esto sucede en segundo plano y una vez arrancado angular y con el usuario contento viendo ya la pgina pedida. Al navegar por las pginas la respuesta es instantnea porque los mdulos con el cdigo ya estn ah.</p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"assetGroups\": [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"app\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"files\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"/favicon.ico\"</span>, <span class=\"string\">\"/index.html\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/manifest.webmanifest\"</span>,  <span class=\"string\">\"/*.css\"</span>, <span class=\"string\">\"/*.js\"</span></span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"assets\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"lazy\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"updateMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"files\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"/assets/**\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/*.(eot|svg|cur|jpg|png|webp|gif|otf|ttf|woff|woff2|ani)\"</span></span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">],</span><br></pre></td></tr></table></figure><p>Eso s, la descarga consume lnea. En cierto casos, con usuarios mviles y grandes aplicaciones quizs no sea adecuado. Si prefieres que los mdulos Lazy no se descarguen hasta que nose visiten, te propongo esta otra configuracin.</p><h3 id=\"Proposed-Lazy-App\"><a href=\"#Proposed-Lazy-App\" class=\"headerlink\" title=\"Proposed: Lazy App\"></a>Proposed: Lazy App</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"assetGroups\":[</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"coreapp\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"files\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"/favicon.ico\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/index.html\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/manifest.webmanifest\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/*.css\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/common*.js\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/main*.js\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/ngsw*.js\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/*woker*.js\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/*polyfills*.js\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/runtime*.js\"</span></span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"lazyapp\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"lazy\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"updateMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"files\"</span>: [<span class=\"string\">\"/*.js\"</span>]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;...</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Cache-inteligente-de-datos\"><a href=\"#2-2-Cache-inteligente-de-datos\" class=\"headerlink\" title=\"2.2 Cach inteligente de datos\"></a>2.2 Cach inteligente de datos</h2><p>El control de la <strong>recepcin de datos dinmicos</strong> es la otra gran tarea del <em>service worker</em>. En este caso para tener una cach que acelere la presentacin de datos o que incluso permita un funcionamiento <em>offline</em>.</p><p>Mediante <strong>dos estrategias complementarias que tratan de mantener los datos actualizados y disponibles</strong> en todo momento. En este caso configurndolo en los <code>dataGroups</code>.</p><blockquote><p>La idea del <em>cache-first</em> es tener el dato ya listo para ser usado cuanto antes. Mientras que con <em>api-first</em> se pretende tener la versin ms actual posible, y usar la ltima descargada en caso de problemas o desconexin total.</p></blockquote><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> \"dataGroups\": [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"cache-first-greeting\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"urls\"</span>: [</span><br><span class=\"line\">      <span class=\"string\">\"http://localhost:3333/api\"</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"attr\">\"cacheConfig\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"strategy\"</span>: <span class=\"string\">\"performance\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"maxAge\"</span>: <span class=\"string\">\"1d\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"maxSize\"</span>: <span class=\"number\">10</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"api-first-rates\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"urls\"</span>: [</span><br><span class=\"line\">      <span class=\"string\">\"https://api.exchangeratesapi.io/latest?symbols=GBP\"</span>,</span><br><span class=\"line\">      <span class=\"string\">\"https://api.exchangeratesapi.io/latest\"</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"attr\">\"cacheConfig\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"strategy\"</span>: <span class=\"string\">\"freshness\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"timeout\"</span>: <span class=\"string\">\"5s\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"maxAge\"</span>: <span class=\"string\">\"1h\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"maxSize\"</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure><h1 id=\"3-Servicios\"><a href=\"#3-Servicios\" class=\"headerlink\" title=\"3 Servicios\"></a>3 Servicios</h1><p>La librera <code>@angular/pwa</code> publica el mdulo <code>ServiceWorkerModule</code> que contiene la lgica de registro del <em>service worker</em> y dos servicios programables con los que interactuar desde el cdigo de tu aplicacin Angular.</p><h2 id=\"3-1-Actualizacion-con-el-SwUpdate\"><a href=\"#3-1-Actualizacion-con-el-SwUpdate\" class=\"headerlink\" title=\"3.1 Actualizacin con el SwUpdate\"></a>3.1 Actualizacin con el SwUpdate</h2><p>Cuando despliegas una nueva versin seguro que ests deseando que los usuarios disfruten cuanto antes de las mejoras o correcciones. Pero en las aplicaciones SPA resulta que <strong>la actualizacin no es tan inmediata</strong> como pudiera parecer. Al no forzar la recarga del documento en las navegaciones internas, el <code>index.html</code> puede residir sin cambios ms de lo debido. Confiar en que lo hagan el navegador o el usuario puede no ser una opcin.</p><p>La solucin PWA es usar el <code>ServiceWorker</code> para detectar nuevas versiones en el servidor. Para ello utiliza un sistema propio de <em>hashes</em> que le permite comparar la versin descargada y la disponible en el servidor.** Cuando detecta un cambio emite un evento al que te puedes subscribir** usando el servicio <code>SwUpdate</code>. En ese momento puedes consultar al usuario, o forzar a lo bestia la recarga ;-).</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> swUpdate: SwUpdate</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.swUpdate.isEnabled) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.swUpdate.available.subscribe(<span class=\"function\">(<span class=\"params\">event: UpdateAvailableEvent</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (confirm(<span class=\"string\">`Do you want to update?`</span>)) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">window</span>.location.reload();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Notificaciones-con-el-SwPush\"><a href=\"#3-2-Notificaciones-con-el-SwPush\" class=\"headerlink\" title=\"3.2 Notificaciones con el SwPush\"></a>3.2 Notificaciones con el SwPush</h2><p>Una caracterstica de las <em>apps</em> nativas muy aprecia por los usuarios es la capacidad de mostrar <strong>mensajes recibidos va <em>push</em> por parte del servidor</strong>. Pueden ser avisos, novedades o simple marketing. Pero lo importante es que lo recibe el sistema operativo, la aplicacin no necesita estar en marcha y el mensaje se muestra de forma nativa.</p><blockquote><p>Obviamente para ello hay que involucrar cdigo de servidor y un servicio de mensajera de terceros. Pero la parte Angular del desarrollo es muy sencilla. Consiste en registrar al usuario, que voluntariamente decide ser notificado, y luego escuchar los mensajes provenientes en forma de eventos. Todo ello reclamando una dependencia al servicio de notificaciones <code>constructor(private swPush: SwPush)</code>.</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> swUpdate: SwUpdate</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.swPush.isEnabled) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.swPush</span><br><span class=\"line\">        .requestSubscription(&#123; serverPublicKey: <span class=\"string\">'VAPID_PUBLIC_KEY'</span> &#125;)</span><br><span class=\"line\">        .then(<span class=\"function\"><span class=\"params\">sub</span> =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"built_in\">console</span>.log(<span class=\"string\">'send subscription to your server and wait form messages'</span>, sub.toJSON());</span><br><span class=\"line\">          <span class=\"keyword\">this</span>.swPush.messages.subscribe(<span class=\"function\"><span class=\"params\">msg</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">'Received: '</span>, msg));</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ya tienes una web que se comporta progresivamente como una App nativa, una <em>Progressive Web Application</em>. Las mejoras en rendimiento y experiencia de usuario son recompensa ms que suficiente para que le des una oportunidad a las <strong>Angular PWA</strong>.</p><p>Contina tu formacin avanzada para crear aplicaciones con mayor <a href=\"../velocidad-y-seo-con-el-ssr-de-angular-universal\">Velocidad y SEO con el SSR de Angular Universal</a> y vers como aprendes a programar con Angular 8.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-16_pwa.png\" alt=\"pwa-entre-la-web-y-las-apps-con-angular\"></p><p>Las aplicaciones web han evolucionado desde el contenido esttico al dinmico, luego al adaptable y ahora se acercan <strong>progresivamente a la experiencia y rendimiento de aplicaciones nativas</strong>. En Angular se incorporan esas capacidades desde el propio <em>framework</em>.</p><p>Mediante la librera <code>@ngular/pwa</code> dispondremos de todo lo necesario para ofrecer instalacin en escritorio, actualizar la aplicacin controladamente, recibir notificaciones del servidor e incluso mejoras en la cach de comunicaciones que pudieran permitir un funcionamiento <em>offline</em>.</p>","more":"<p>Partiendo del cdigo tal como qued en <a href=\"../el-patron-redux-con-ngrx-en-angular/\">El patrn Redux con NgRx en Angular</a>. Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h1 id=\"1-Las-herramientas-de-la-libreria-PWA\"><a href=\"#1-Las-herramientas-de-la-libreria-PWA\" class=\"headerlink\" title=\"1 Las herramientas de la librera PWA\"></a>1 Las herramientas de la librera PWA</h1><p>Aprovechando las nuevas caractersticas del <em>Angular CLI</em> tenemos el comando <code>ng add @angular/pwa</code> que instala los paquetes y configura cualquier aplicacin Angular convirtindola en una <em>PWA</em> bsica.</p><p>Estos son los actores y ficheros involucrados en este proceso tras la agregacin del paquete <code>pwa</code>.</p><ul><li>ServiceWorkerModule</li><li>./angular.json { serviceWorker: true }</li><li>./ngsw-config.json</li><li>./src/manifest.webmanifest</li><li>./src/index.html</li><li>./assets/icons/..</li></ul><p>Con todo instalado y configurado, querrs probar que funciona. Pero, a primera vista no ocurre nada. <strong>Las caractersticas <em>PWA</em> estn preparadas para funcionar en modo produccin</strong>. As que lo primero ser ejecutar el comando <code>ng build --prod</code> y lanzar un servidor sobre la carpeta de distribucin recin creada.</p><p>De entre los nuevos ficheros que aparecen hay dos que debes conocer especialmente, <strong>el <em>manifest</em> y el <em>service worker</em></strong>.</p><h2 id=\"1-1-El-manifest-webmanifest\"><a href=\"#1-1-El-manifest-webmanifest\" class=\"headerlink\" title=\"1.1 El manifest.webmanifest\"></a>1.1 El manifest.webmanifest</h2><p>Este sencillo documento acompaa al <code>index.html</code> y le da indicaciones al navegador para que trate esta aplicacin de manera especial. El fichero en s contiene una <em>metadata</em> con textos descriptivos, colores e iconos para ser usados por el navegador y el sistema operativo y <strong>ofrecerle al usuario que instale la <em>web</em> como una <em>app</em></strong>.</p><p>Casi todo es cosmtico, pero merece la pena prestar especial atencin a los iconos. Por defecto el <em>CLI</em> instala distintas versiones del logo oficial de Angular. Una forma cmoda de sustituirlo por los tuyos es usar la herramienta <a href=\"https://www.npmjs.com/package/ngx-pwa-icons\" target=\"_blank\" rel=\"noopener\"><em>ngx-pwa-icons</em></a></p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"shop\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"short_name\"</span>: <span class=\"string\">\"shop\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"theme_color\"</span>: <span class=\"string\">\"#1976d2\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"background_color\"</span>: <span class=\"string\">\"#fafafa\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"display\"</span>: <span class=\"string\">\"standalone\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"scope\"</span>: <span class=\"string\">\"/\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"start_url\"</span>: <span class=\"string\">\"/\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"icons\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"src\"</span>: <span class=\"string\">\"assets/icons/icon-72x72.png\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"sizes\"</span>: <span class=\"string\">\"72x72\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"image/png\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    ...</span><br><span class=\"line\">   ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Asegrate de que en la <code>start_url</code> apunte a la pgina de inicio correcta y despliega en modo produccin en un servidor seguro con <em>https</em>. Prubalo varias veces en distintos navegadores y vers las distintas experiencias de instalacin que ofrecen.</p></blockquote><h2 id=\"1-2-El-ngsw-worker-js\"><a href=\"#1-2-El-ngsw-worker-js\" class=\"headerlink\" title=\"1.2 El ngsw-worker.js\"></a>1.2 El ngsw-worker.js</h2><p>El otro gran fichero, y ms importante para los desarrolladores, es <strong>el configurador del <em>Service Worker</em></strong>. Cuando un navegador ejecuta un <em>script</em> lo hace en <em>thread</em> dedicado a la interaccin con el usuario y la manipulacin del <em>DOM</em>. Normalmente ese hilo est muy ocupado, cuando no est saturado. La solucin para agilizar los procesos est en usar ms <em>threads</em>. Presentamos el <em>worker thread</em>.</p><p>Se le llama as a los hilos creados a partir del principal y que le ayudan en tareas en segundo plano. Esos hilos tienen <strong>prohibido el acceso al DOM, ni lo escuchan ni lo manipulan</strong>. Pero a cambio estn muy liberados para realizar clculos complejos o llamadas a servicios. Se comunican con el <em>thread</em> principal a travs de un sencillo protocolo de eventos y subscripciones.</p><p>Una de las tareas para las que ms se les utiliza es para la gestin inteligente de las comunicaciones. Este fichero viene pre programado para realizar las siguientes <strong>funciones PWA de Angular</strong>:</p><ul><li>Cach de contenido esttico para funcionamiento offline</li><li>Cach de datos dinmicos para mayor velocidad</li><li>Gestin de instalaciones y versiones</li><li>Notificaciones de datos push</li></ul><p>Todo lo que hay que hacer es configurar estas funciones en un fichero, el <code>ngsw-config.json</code>, ya generado con valores por defecto. El <em>CLI</em>, durante el proceso de construccin en modo produccin, copiar y manipular los scripts y sus configuraciones. En ejecucin, el <code>AppModule</code> registrar el script en el navegador, se subscribir a sus eventos y ejecutar lo configurado por el programador en el <em>json</em>.</p><h1 id=\"2-Comunicaciones-y-cache\"><a href=\"#2-Comunicaciones-y-cache\" class=\"headerlink\" title=\"2 Comunicaciones y cach\"></a>2 Comunicaciones y cach</h1><p><strong>El service worker de Angular</strong> est especialmente diseado para hacerse cargo de las comunicaciones con el servidor. Digamos que se convierte en un <strong>interceptor transparente de todas las peticiones http</strong>. Tanto de los ficheros propios de la aplicacin como de las comunicaciones de datos.</p><h2 id=\"2-1-Descarga-y-actualizacion-de-la-aplicacion\"><a href=\"#2-1-Descarga-y-actualizacion-de-la-aplicacion\" class=\"headerlink\" title=\"2.1 Descarga y actualizacin de la aplicacin\"></a>2.1 Descarga y actualizacin de la aplicacin</h2><p>Una vez descargado el <em>index.html</em> con el contenido mnimo de Angular, diramos que la aplicacin se ha instalado y est lista para ejecutarse. A partir de ese momento el <em>ngsw</em> toma el control y puede pre descargar ficheros en segundo plano; de forma que <strong>cuando sean reclamados ya estn disponibles</strong> y mejoren la experiencia del usuario.</p><p>Rutinariamente el servicio se ocupar de consultar novedades en el servidor para mantener los ficheros locales actualizados. Todo ello se configura en la seccin <code>assetGroups</code> del <code>ngsw-config.json</code>.</p><h3 id=\"Default-Full-App\"><a href=\"#Default-Full-App\" class=\"headerlink\" title=\"Default: Full App\"></a>Default: Full App</h3><p>Se descarga la aplicacin completa. Tranquilidad, esto sucede en segundo plano y una vez arrancado angular y con el usuario contento viendo ya la pgina pedida. Al navegar por las pginas la respuesta es instantnea porque los mdulos con el cdigo ya estn ah.</p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"assetGroups\": [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"app\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"files\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"/favicon.ico\"</span>, <span class=\"string\">\"/index.html\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/manifest.webmanifest\"</span>,  <span class=\"string\">\"/*.css\"</span>, <span class=\"string\">\"/*.js\"</span></span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"assets\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"lazy\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"updateMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"files\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"/assets/**\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/*.(eot|svg|cur|jpg|png|webp|gif|otf|ttf|woff|woff2|ani)\"</span></span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">],</span><br></pre></td></tr></table></figure><p>Eso s, la descarga consume lnea. En cierto casos, con usuarios mviles y grandes aplicaciones quizs no sea adecuado. Si prefieres que los mdulos Lazy no se descarguen hasta que nose visiten, te propongo esta otra configuracin.</p><h3 id=\"Proposed-Lazy-App\"><a href=\"#Proposed-Lazy-App\" class=\"headerlink\" title=\"Proposed: Lazy App\"></a>Proposed: Lazy App</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"assetGroups\":[</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"coreapp\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"files\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"/favicon.ico\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/index.html\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/manifest.webmanifest\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/*.css\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/common*.js\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/main*.js\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/ngsw*.js\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/*woker*.js\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/*polyfills*.js\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/runtime*.js\"</span></span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"lazyapp\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"lazy\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"updateMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"files\"</span>: [<span class=\"string\">\"/*.js\"</span>]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;...</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Cache-inteligente-de-datos\"><a href=\"#2-2-Cache-inteligente-de-datos\" class=\"headerlink\" title=\"2.2 Cach inteligente de datos\"></a>2.2 Cach inteligente de datos</h2><p>El control de la <strong>recepcin de datos dinmicos</strong> es la otra gran tarea del <em>service worker</em>. En este caso para tener una cach que acelere la presentacin de datos o que incluso permita un funcionamiento <em>offline</em>.</p><p>Mediante <strong>dos estrategias complementarias que tratan de mantener los datos actualizados y disponibles</strong> en todo momento. En este caso configurndolo en los <code>dataGroups</code>.</p><blockquote><p>La idea del <em>cache-first</em> es tener el dato ya listo para ser usado cuanto antes. Mientras que con <em>api-first</em> se pretende tener la versin ms actual posible, y usar la ltima descargada en caso de problemas o desconexin total.</p></blockquote><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> \"dataGroups\": [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"cache-first-greeting\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"urls\"</span>: [</span><br><span class=\"line\">      <span class=\"string\">\"http://localhost:3333/api\"</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"attr\">\"cacheConfig\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"strategy\"</span>: <span class=\"string\">\"performance\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"maxAge\"</span>: <span class=\"string\">\"1d\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"maxSize\"</span>: <span class=\"number\">10</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"api-first-rates\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"urls\"</span>: [</span><br><span class=\"line\">      <span class=\"string\">\"https://api.exchangeratesapi.io/latest?symbols=GBP\"</span>,</span><br><span class=\"line\">      <span class=\"string\">\"https://api.exchangeratesapi.io/latest\"</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"attr\">\"cacheConfig\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"strategy\"</span>: <span class=\"string\">\"freshness\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"timeout\"</span>: <span class=\"string\">\"5s\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"maxAge\"</span>: <span class=\"string\">\"1h\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"maxSize\"</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure><h1 id=\"3-Servicios\"><a href=\"#3-Servicios\" class=\"headerlink\" title=\"3 Servicios\"></a>3 Servicios</h1><p>La librera <code>@angular/pwa</code> publica el mdulo <code>ServiceWorkerModule</code> que contiene la lgica de registro del <em>service worker</em> y dos servicios programables con los que interactuar desde el cdigo de tu aplicacin Angular.</p><h2 id=\"3-1-Actualizacion-con-el-SwUpdate\"><a href=\"#3-1-Actualizacion-con-el-SwUpdate\" class=\"headerlink\" title=\"3.1 Actualizacin con el SwUpdate\"></a>3.1 Actualizacin con el SwUpdate</h2><p>Cuando despliegas una nueva versin seguro que ests deseando que los usuarios disfruten cuanto antes de las mejoras o correcciones. Pero en las aplicaciones SPA resulta que <strong>la actualizacin no es tan inmediata</strong> como pudiera parecer. Al no forzar la recarga del documento en las navegaciones internas, el <code>index.html</code> puede residir sin cambios ms de lo debido. Confiar en que lo hagan el navegador o el usuario puede no ser una opcin.</p><p>La solucin PWA es usar el <code>ServiceWorker</code> para detectar nuevas versiones en el servidor. Para ello utiliza un sistema propio de <em>hashes</em> que le permite comparar la versin descargada y la disponible en el servidor.** Cuando detecta un cambio emite un evento al que te puedes subscribir** usando el servicio <code>SwUpdate</code>. En ese momento puedes consultar al usuario, o forzar a lo bestia la recarga ;-).</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> swUpdate: SwUpdate</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.swUpdate.isEnabled) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.swUpdate.available.subscribe(<span class=\"function\">(<span class=\"params\">event: UpdateAvailableEvent</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (confirm(<span class=\"string\">`Do you want to update?`</span>)) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">window</span>.location.reload();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Notificaciones-con-el-SwPush\"><a href=\"#3-2-Notificaciones-con-el-SwPush\" class=\"headerlink\" title=\"3.2 Notificaciones con el SwPush\"></a>3.2 Notificaciones con el SwPush</h2><p>Una caracterstica de las <em>apps</em> nativas muy aprecia por los usuarios es la capacidad de mostrar <strong>mensajes recibidos va <em>push</em> por parte del servidor</strong>. Pueden ser avisos, novedades o simple marketing. Pero lo importante es que lo recibe el sistema operativo, la aplicacin no necesita estar en marcha y el mensaje se muestra de forma nativa.</p><blockquote><p>Obviamente para ello hay que involucrar cdigo de servidor y un servicio de mensajera de terceros. Pero la parte Angular del desarrollo es muy sencilla. Consiste en registrar al usuario, que voluntariamente decide ser notificado, y luego escuchar los mensajes provenientes en forma de eventos. Todo ello reclamando una dependencia al servicio de notificaciones <code>constructor(private swPush: SwPush)</code>.</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> swUpdate: SwUpdate</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.swPush.isEnabled) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.swPush</span><br><span class=\"line\">        .requestSubscription(&#123; serverPublicKey: <span class=\"string\">'VAPID_PUBLIC_KEY'</span> &#125;)</span><br><span class=\"line\">        .then(<span class=\"function\"><span class=\"params\">sub</span> =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"built_in\">console</span>.log(<span class=\"string\">'send subscription to your server and wait form messages'</span>, sub.toJSON());</span><br><span class=\"line\">          <span class=\"keyword\">this</span>.swPush.messages.subscribe(<span class=\"function\"><span class=\"params\">msg</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">'Received: '</span>, msg));</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ya tienes una web que se comporta progresivamente como una App nativa, una <em>Progressive Web Application</em>. Las mejoras en rendimiento y experiencia de usuario son recompensa ms que suficiente para que le des una oportunidad a las <strong>Angular PWA</strong>.</p><p>Contina tu formacin avanzada para crear aplicaciones con mayor <a href=\"../velocidad-y-seo-con-el-ssr-de-angular-universal\">Velocidad y SEO con el SSR de Angular Universal</a> y vers como aprendes a programar con Angular 8.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Internacionalizacin y puesta en produccin","date":"2019-10-15T17:50:27.000Z","thumbnail":"/css/images/angular-18_i18n.png","_content":"\n![internacionalizacion-y-puesta-en-produccion-con-Angular](/images/tutorial-angular-18_i18n.png)\n\nLas aplicaciones web, son la expresin perfecta del mundo globalizado en el que vivimos. Preparar tu aplicacin para ese mundo se conoce como _internationalization_, o recortadamente **i18n**. Pero globalizar no significa \"caf con leche para todos\". Atender a las necesidades especficas de tus usuarios es el proceso de __localization__.\n\nPara empezar esto afecta las traducciones de los contenidos: sean datos o textos fijos. Pero tambin a las adaptaciones culturales para la presentacin de fechas, nmeros, iconos... En Angular tenemos herramientas y soluciones para poner en marcha proyectos globalizados.\n\n<!-- more -->\n\nPartiendo del cdigo tal como qued en [Velocidad y SEO con el SSR de Angular Universal](../velocidad-y-seo-con-el-ssr-de-angular-universal/). Al finalizar tendrs una aplicacin que adapta a la cultura del usuario.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n# 1 Traducciones y contenido\n\nTraducir una aplicacin es el primer paso para que un usuario la acepte y comprenda mejor. Afecta a los datos que venga dese un API, y afecta a los textos fijos que acompaan a los datos.\n\nComo estamos viendo Angular en frontend, me centrar en el problema de los literales en las _templates_. Existen varias estrategias para tratarlo, aqu veremos la oficial. Se apuesta por dos principios:\n\n- El programador vea el texto en la plantilla en el idioma nativo escogido para el desarrollo. As puede hacerse una idea del tamao y apariencia inicial y facilita mucho la legibilidad del HTML.\n\n- El usuario descargue la aplicacin especfica para su idioma, de forma que no necesite llamadas extra ni resolucin dinmica para los textos y menajes fijos.\n\n## 1.1 xi18n\n\nPara cumplir con esos criterios se necesita extraer del cdigo los literales que se van traducir. Para ello se usa una herramienta y un convenio.\n\nLa herramienta es `xi18n` que viene con el CLI. El convenio es la directiva `i18n` que viene con Angular. El uso es muy sencillo, como puedes ver este ejemplo.\n\n`apps\\warehouse\\src\\app\\app.component.html`\n\n```html\n<header>\n  <h1 i18n>Welcome to the Angular Builders Warehouse</h1>\n</header>\n<img src=\"../assets/Warehouse-Building.jpg\"\n     alt=\"Warehouse building\"\n     i18n-alt>\n<router-outlet></router-outlet>\n<footer>\n  <a href=\"https://angular.builders\"\n     target=\"blank\">Angular.Builders: </a>\n  <span i18n>a store of resources for developers and software architects.</span>\n</footer>\n```\n\nPara la extraccin se recomienda, como siempre, crear un script en el  `package.json`\n\n```json\n{\n  \"i18n:warehouse\": \"ng xi18n warehouse --output-path src/locale\",\n}\n```\n\n> Atencin IVY: por el momento debemos desactivar el renderizador _Ivy_ para poder realizar la extraccin.\n\n`apps\\warehouse\\tsconfig.app.json`\n\n```json\n{\n\"angularCompilerOptions\": {\n    \"enableIvy\": false\n  }\n}\n```\n\nAparecer un fichero _xml_ un tanto feo: `/src/locale/messages.xlf`. Aunque es procesable automticamente, por ahora vamos a usarlo de forma manual. Para empezar crea una copia y nmbrala incluyendo el idioma destino. Por ejemplo` messages.es.xlf`\n\nSlo tendrs que duplicar cada etiqueta `source` en su equivalente traducido `target`... y traducirlo, claro. Te pongo aqu un ejemplo de como quedara.\n\n```xml\n<trans-unit id=\"5c08a98fac06c803712ab27dbb81d889af5ef5fb\" datatype=\"html\">\n  <source>Welcome to the Angular Builders Warehouse</source>\n  <target>Bienvenido al almacn de Angular Builders</target>\n  <context-group purpose=\"location\">\n    <context context-type=\"sourcefile\">src/app/app.component.html</context>\n    <context context-type=\"linenumber\">2</context>\n  </context-group>\n</trans-unit>\n```\n\nNecesitars crear tantos ficheros como idiomas tengas que mantener. Si son muchos te recomiendo usar alguna herramienta. Tampoco debes olvidarte de realizar este proceso ante cada despliegue para incorporar los posibles cambios.\n\nY hablando de despliegue..\n\n## 1.2 Build configurations\n\nUna vez que tenemos las traducciones en los ficheros de idioma, ahora hay que compilarlos para generar una versin distribuible especfica para cada idioma. De nuevo esto es un proceso un tanto tedioso la primera vez, y que desde luego merece ser automatizado.\n\nSe trata de crear una nueva entrada en la rama `architect/build/configurations` de tu aplicacin en el fichero `angular.json`.\n\n```json\n\"production-es\": {\n  \"fileReplacements\": [\n    {\n      \"replace\": \"apps/warehouse/src/environments/environment.ts\",\n      \"with\": \"apps/warehouse/src/environments/environment.prod.es.ts\"\n    },\n  ],\n  \"outputPath\": \"dist/apps/warehouse/es/\",\n  \"i18nFile\": \"apps/warehouse/src/locale/messages.es.xlf\",\n  \"i18nFormat\": \"xlf\",\n  \"i18nLocale\": \"es\",\n  \"baseHref\": \"es\",\n}\n```\n\nEsencialmente se le dicen las rutas y los ficheros que debe utilizar durante el proceso de construccin. Para usarla definimos un par de scripts. Uno para la construccin en s mediante `ng build` y el otro para poder ver el resultado con un servidor de ficheros estticos.\n\n```json\n{\n  \"build:warehouse-es\": \"ng build warehouse --configuration=production-es\",\n  \"start:warehouse-es\": \"npm run build:warehouse-es && angular-http-server --path ./dist/apps/warehouse/es\",\n}\n```\n\n\n# 2 Adaptaciones culturales de tiempo y moneda\n\nPero no todo van a ser textos. Tambin hay fechas, nmero, imgenes... Se necesitan hacer pequeas adaptaciones en un montn de lugares. En Angular, algunas son casi gratis.\n\n## 2.1 Registro manual en app.module o Auto registro en angular.json\n\nHabrs usado _pipes_ como `date` o `number` desde el da que empezaste con Angular. Si no haces nada especial seguro que te choc ver que las fechas y los nmeros en formato norte americano. Es el que viene de fbrica, pero e fcil cambiarlo.\n\n### Manual\n\nPuedes asignar la cultura en tu aplicacin de forma implcita registrndola al inicio del mdulo raz. La clave est en importar el fichero con las definiciones particulares de tu cultura.\n\nTodo est descargado en node-modules. Pero slo se empaqueta y enva al navegador la cultura seleccionada.\n\n\n```typescript\nimport { registerLocaleData } from '@angular/common';\nimport localeEs from '@angular/common/locales/es';\n\nregisterLocaleData(localeEs);\n```\n\n### Automtico\n\nOtra forma es usar el fichero `package.json` para configurarlo. Puedes establece la cultura deseada en la propiedad `i18nLocale`.\n\n```json\n\"i18nLocale\": \"es\"\n```\n\n## 2.2 Tiempo, moneda y contenido\n\nEn cualquier caso, todos los pipes deAngular empezarn a comportarse educadamente conforme a la cultura establecida.\n\n`apps\\warehouse\\src\\app\\app.component.html`\n\n```html\n<article class=\"card\">\n  <p>{{ building.date | date:'long' }}</p>\n  <p>${{ building.value | number }}<i> {{ building.status }}</i></p>\n</article>\n```\n\n`apps\\warehouse\\src\\app\\app.component.ts`\n\n```TypeScript\npublic building = {\n  date: Date.now(),\n  value: 2345.897,\n  status: 'buy'\n};\nconstructor() {\n  if (this.building.status === 'buy') {\n    this.building.status = environment.buy;\n  } else {\n    this.building.status = environment.sell;\n  }\n}\n```\n\nOtra cosa pueden ser pequeos textos, lgica , iconos o clases css. A veces todo esto vara de un pas a otro. Esas variaciones puedes almacenarla en ficheros externos o dentro del cdigo. Pero si optas por esto ultimo entonces es mejor que uses los _environments_ para almacenar configuraciones especficas.\n\n```TypeScript\n# Original environment.prod.ts\n{\n  buy: 'for buy',\n  sell: 'for sell'\n}\n# En espaol environment.prod.es.ts\n{\n  buy: 'para comprar',\n  sell: 'para vender'\n}\n```\n\nAhora ya tienes una aplicacin que se puede desplegar adaptada a las preferencias culturales de tus usuarios. Contina tu formacin avanzada para crear aplicaciones ms all del framework con los [Elementos Angular para los Web Components](../elementos-Angular-para-los-Web-Components/) y vers como aprendes a programar con Angular 8.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","source":"_posts/ng-18-internacionalizacion-y-puesta-en-produccion-con-Angular.md","raw":"---\ntitle: Internacionalizacin y puesta en produccin\npermalink: internacionalizacion-y-puesta-en-produccion-con-Angular\ndate: 2019-10-15 19:50:27\ntags:\n- Angular\n- Angular8\n- Angular2\n- i18n\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-18_i18n.png\n---\n\n![internacionalizacion-y-puesta-en-produccion-con-Angular](/images/tutorial-angular-18_i18n.png)\n\nLas aplicaciones web, son la expresin perfecta del mundo globalizado en el que vivimos. Preparar tu aplicacin para ese mundo se conoce como _internationalization_, o recortadamente **i18n**. Pero globalizar no significa \"caf con leche para todos\". Atender a las necesidades especficas de tus usuarios es el proceso de __localization__.\n\nPara empezar esto afecta las traducciones de los contenidos: sean datos o textos fijos. Pero tambin a las adaptaciones culturales para la presentacin de fechas, nmeros, iconos... En Angular tenemos herramientas y soluciones para poner en marcha proyectos globalizados.\n\n<!-- more -->\n\nPartiendo del cdigo tal como qued en [Velocidad y SEO con el SSR de Angular Universal](../velocidad-y-seo-con-el-ssr-de-angular-universal/). Al finalizar tendrs una aplicacin que adapta a la cultura del usuario.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n# 1 Traducciones y contenido\n\nTraducir una aplicacin es el primer paso para que un usuario la acepte y comprenda mejor. Afecta a los datos que venga dese un API, y afecta a los textos fijos que acompaan a los datos.\n\nComo estamos viendo Angular en frontend, me centrar en el problema de los literales en las _templates_. Existen varias estrategias para tratarlo, aqu veremos la oficial. Se apuesta por dos principios:\n\n- El programador vea el texto en la plantilla en el idioma nativo escogido para el desarrollo. As puede hacerse una idea del tamao y apariencia inicial y facilita mucho la legibilidad del HTML.\n\n- El usuario descargue la aplicacin especfica para su idioma, de forma que no necesite llamadas extra ni resolucin dinmica para los textos y menajes fijos.\n\n## 1.1 xi18n\n\nPara cumplir con esos criterios se necesita extraer del cdigo los literales que se van traducir. Para ello se usa una herramienta y un convenio.\n\nLa herramienta es `xi18n` que viene con el CLI. El convenio es la directiva `i18n` que viene con Angular. El uso es muy sencillo, como puedes ver este ejemplo.\n\n`apps\\warehouse\\src\\app\\app.component.html`\n\n```html\n<header>\n  <h1 i18n>Welcome to the Angular Builders Warehouse</h1>\n</header>\n<img src=\"../assets/Warehouse-Building.jpg\"\n     alt=\"Warehouse building\"\n     i18n-alt>\n<router-outlet></router-outlet>\n<footer>\n  <a href=\"https://angular.builders\"\n     target=\"blank\">Angular.Builders: </a>\n  <span i18n>a store of resources for developers and software architects.</span>\n</footer>\n```\n\nPara la extraccin se recomienda, como siempre, crear un script en el  `package.json`\n\n```json\n{\n  \"i18n:warehouse\": \"ng xi18n warehouse --output-path src/locale\",\n}\n```\n\n> Atencin IVY: por el momento debemos desactivar el renderizador _Ivy_ para poder realizar la extraccin.\n\n`apps\\warehouse\\tsconfig.app.json`\n\n```json\n{\n\"angularCompilerOptions\": {\n    \"enableIvy\": false\n  }\n}\n```\n\nAparecer un fichero _xml_ un tanto feo: `/src/locale/messages.xlf`. Aunque es procesable automticamente, por ahora vamos a usarlo de forma manual. Para empezar crea una copia y nmbrala incluyendo el idioma destino. Por ejemplo` messages.es.xlf`\n\nSlo tendrs que duplicar cada etiqueta `source` en su equivalente traducido `target`... y traducirlo, claro. Te pongo aqu un ejemplo de como quedara.\n\n```xml\n<trans-unit id=\"5c08a98fac06c803712ab27dbb81d889af5ef5fb\" datatype=\"html\">\n  <source>Welcome to the Angular Builders Warehouse</source>\n  <target>Bienvenido al almacn de Angular Builders</target>\n  <context-group purpose=\"location\">\n    <context context-type=\"sourcefile\">src/app/app.component.html</context>\n    <context context-type=\"linenumber\">2</context>\n  </context-group>\n</trans-unit>\n```\n\nNecesitars crear tantos ficheros como idiomas tengas que mantener. Si son muchos te recomiendo usar alguna herramienta. Tampoco debes olvidarte de realizar este proceso ante cada despliegue para incorporar los posibles cambios.\n\nY hablando de despliegue..\n\n## 1.2 Build configurations\n\nUna vez que tenemos las traducciones en los ficheros de idioma, ahora hay que compilarlos para generar una versin distribuible especfica para cada idioma. De nuevo esto es un proceso un tanto tedioso la primera vez, y que desde luego merece ser automatizado.\n\nSe trata de crear una nueva entrada en la rama `architect/build/configurations` de tu aplicacin en el fichero `angular.json`.\n\n```json\n\"production-es\": {\n  \"fileReplacements\": [\n    {\n      \"replace\": \"apps/warehouse/src/environments/environment.ts\",\n      \"with\": \"apps/warehouse/src/environments/environment.prod.es.ts\"\n    },\n  ],\n  \"outputPath\": \"dist/apps/warehouse/es/\",\n  \"i18nFile\": \"apps/warehouse/src/locale/messages.es.xlf\",\n  \"i18nFormat\": \"xlf\",\n  \"i18nLocale\": \"es\",\n  \"baseHref\": \"es\",\n}\n```\n\nEsencialmente se le dicen las rutas y los ficheros que debe utilizar durante el proceso de construccin. Para usarla definimos un par de scripts. Uno para la construccin en s mediante `ng build` y el otro para poder ver el resultado con un servidor de ficheros estticos.\n\n```json\n{\n  \"build:warehouse-es\": \"ng build warehouse --configuration=production-es\",\n  \"start:warehouse-es\": \"npm run build:warehouse-es && angular-http-server --path ./dist/apps/warehouse/es\",\n}\n```\n\n\n# 2 Adaptaciones culturales de tiempo y moneda\n\nPero no todo van a ser textos. Tambin hay fechas, nmero, imgenes... Se necesitan hacer pequeas adaptaciones en un montn de lugares. En Angular, algunas son casi gratis.\n\n## 2.1 Registro manual en app.module o Auto registro en angular.json\n\nHabrs usado _pipes_ como `date` o `number` desde el da que empezaste con Angular. Si no haces nada especial seguro que te choc ver que las fechas y los nmeros en formato norte americano. Es el que viene de fbrica, pero e fcil cambiarlo.\n\n### Manual\n\nPuedes asignar la cultura en tu aplicacin de forma implcita registrndola al inicio del mdulo raz. La clave est en importar el fichero con las definiciones particulares de tu cultura.\n\nTodo est descargado en node-modules. Pero slo se empaqueta y enva al navegador la cultura seleccionada.\n\n\n```typescript\nimport { registerLocaleData } from '@angular/common';\nimport localeEs from '@angular/common/locales/es';\n\nregisterLocaleData(localeEs);\n```\n\n### Automtico\n\nOtra forma es usar el fichero `package.json` para configurarlo. Puedes establece la cultura deseada en la propiedad `i18nLocale`.\n\n```json\n\"i18nLocale\": \"es\"\n```\n\n## 2.2 Tiempo, moneda y contenido\n\nEn cualquier caso, todos los pipes deAngular empezarn a comportarse educadamente conforme a la cultura establecida.\n\n`apps\\warehouse\\src\\app\\app.component.html`\n\n```html\n<article class=\"card\">\n  <p>{{ building.date | date:'long' }}</p>\n  <p>${{ building.value | number }}<i> {{ building.status }}</i></p>\n</article>\n```\n\n`apps\\warehouse\\src\\app\\app.component.ts`\n\n```TypeScript\npublic building = {\n  date: Date.now(),\n  value: 2345.897,\n  status: 'buy'\n};\nconstructor() {\n  if (this.building.status === 'buy') {\n    this.building.status = environment.buy;\n  } else {\n    this.building.status = environment.sell;\n  }\n}\n```\n\nOtra cosa pueden ser pequeos textos, lgica , iconos o clases css. A veces todo esto vara de un pas a otro. Esas variaciones puedes almacenarla en ficheros externos o dentro del cdigo. Pero si optas por esto ultimo entonces es mejor que uses los _environments_ para almacenar configuraciones especficas.\n\n```TypeScript\n# Original environment.prod.ts\n{\n  buy: 'for buy',\n  sell: 'for sell'\n}\n# En espaol environment.prod.es.ts\n{\n  buy: 'para comprar',\n  sell: 'para vender'\n}\n```\n\nAhora ya tienes una aplicacin que se puede desplegar adaptada a las preferencias culturales de tus usuarios. Contina tu formacin avanzada para crear aplicaciones ms all del framework con los [Elementos Angular para los Web Components](../elementos-Angular-para-los-Web-Components/) y vers como aprendes a programar con Angular 8.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","slug":"internacionalizacion-y-puesta-en-produccion-con-Angular","published":1,"updated":"2019-10-28T10:09:34.693Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab1l000rbss3145s0ptk","content":"<p><img src=\"/images/tutorial-angular-18_i18n.png\" alt=\"internacionalizacion-y-puesta-en-produccion-con-Angular\"></p><p>Las aplicaciones web, son la expresin perfecta del mundo globalizado en el que vivimos. Preparar tu aplicacin para ese mundo se conoce como <em>internationalization</em>, o recortadamente <strong>i18n</strong>. Pero globalizar no significa caf con leche para todos. Atender a las necesidades especficas de tus usuarios es el proceso de <strong>localization</strong>.</p><p>Para empezar esto afecta las traducciones de los contenidos: sean datos o textos fijos. Pero tambin a las adaptaciones culturales para la presentacin de fechas, nmeros, iconos En Angular tenemos herramientas y soluciones para poner en marcha proyectos globalizados.</p><a id=\"more\"></a><p>Partiendo del cdigo tal como qued en <a href=\"../velocidad-y-seo-con-el-ssr-de-angular-universal/\">Velocidad y SEO con el SSR de Angular Universal</a>. Al finalizar tendrs una aplicacin que adapta a la cultura del usuario.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h1 id=\"1-Traducciones-y-contenido\"><a href=\"#1-Traducciones-y-contenido\" class=\"headerlink\" title=\"1 Traducciones y contenido\"></a>1 Traducciones y contenido</h1><p>Traducir una aplicacin es el primer paso para que un usuario la acepte y comprenda mejor. Afecta a los datos que venga dese un API, y afecta a los textos fijos que acompaan a los datos.</p><p>Como estamos viendo Angular en frontend, me centrar en el problema de los literales en las <em>templates</em>. Existen varias estrategias para tratarlo, aqu veremos la oficial. Se apuesta por dos principios:</p><ul><li><p>El programador vea el texto en la plantilla en el idioma nativo escogido para el desarrollo. As puede hacerse una idea del tamao y apariencia inicial y facilita mucho la legibilidad del HTML.</p></li><li><p>El usuario descargue la aplicacin especfica para su idioma, de forma que no necesite llamadas extra ni resolucin dinmica para los textos y menajes fijos.</p></li></ul><h2 id=\"1-1-xi18n\"><a href=\"#1-1-xi18n\" class=\"headerlink\" title=\"1.1 xi18n\"></a>1.1 xi18n</h2><p>Para cumplir con esos criterios se necesita extraer del cdigo los literales que se van traducir. Para ello se usa una herramienta y un convenio.</p><p>La herramienta es <code>xi18n</code> que viene con el CLI. El convenio es la directiva <code>i18n</code> que viene con Angular. El uso es muy sencillo, como puedes ver este ejemplo.</p><p><code>apps\\warehouse\\src\\app\\app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span> <span class=\"attr\">i18n</span>&gt;</span>Welcome to the Angular Builders Warehouse<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"../assets/Warehouse-Building.jpg\"</span></span></span><br><span class=\"line\"><span class=\"tag\">     <span class=\"attr\">alt</span>=<span class=\"string\">\"Warehouse building\"</span></span></span><br><span class=\"line\"><span class=\"tag\">     <span class=\"attr\">i18n-alt</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">footer</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://angular.builders\"</span></span></span><br><span class=\"line\"><span class=\"tag\">     <span class=\"attr\">target</span>=<span class=\"string\">\"blank\"</span>&gt;</span>Angular.Builders: <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">i18n</span>&gt;</span>a store of resources for developers and software architects.<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">footer</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Para la extraccin se recomienda, como siempre, crear un script en el <code>package.json</code></p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"i18n:warehouse\"</span>: <span class=\"string\">\"ng xi18n warehouse --output-path src/locale\"</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Atencin IVY: por el momento debemos desactivar el renderizador <em>Ivy</em> para poder realizar la extraccin.</p></blockquote><p><code>apps\\warehouse\\tsconfig.app.json</code></p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"attr\">\"angularCompilerOptions\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"enableIvy\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Aparecer un fichero <em>xml</em> un tanto feo: <code>/src/locale/messages.xlf</code>. Aunque es procesable automticamente, por ahora vamos a usarlo de forma manual. Para empezar crea una copia y nmbrala incluyendo el idioma destino. Por ejemplo<code>messages.es.xlf</code></p><p>Slo tendrs que duplicar cada etiqueta <code>source</code> en su equivalente traducido <code>target</code> y traducirlo, claro. Te pongo aqu un ejemplo de como quedara.</p><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">trans-unit</span> <span class=\"attr\">id</span>=<span class=\"string\">\"5c08a98fac06c803712ab27dbb81d889af5ef5fb\"</span> <span class=\"attr\">datatype</span>=<span class=\"string\">\"html\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">source</span>&gt;</span>Welcome to the Angular Builders Warehouse<span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">target</span>&gt;</span>Bienvenido al almacn de Angular Builders<span class=\"tag\">&lt;/<span class=\"name\">target</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context-group</span> <span class=\"attr\">purpose</span>=<span class=\"string\">\"location\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context</span> <span class=\"attr\">context-type</span>=<span class=\"string\">\"sourcefile\"</span>&gt;</span>src/app/app.component.html<span class=\"tag\">&lt;/<span class=\"name\">context</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context</span> <span class=\"attr\">context-type</span>=<span class=\"string\">\"linenumber\"</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">context</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">context-group</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">trans-unit</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Necesitars crear tantos ficheros como idiomas tengas que mantener. Si son muchos te recomiendo usar alguna herramienta. Tampoco debes olvidarte de realizar este proceso ante cada despliegue para incorporar los posibles cambios.</p><p>Y hablando de despliegue..</p><h2 id=\"1-2-Build-configurations\"><a href=\"#1-2-Build-configurations\" class=\"headerlink\" title=\"1.2 Build configurations\"></a>1.2 Build configurations</h2><p>Una vez que tenemos las traducciones en los ficheros de idioma, ahora hay que compilarlos para generar una versin distribuible especfica para cada idioma. De nuevo esto es un proceso un tanto tedioso la primera vez, y que desde luego merece ser automatizado.</p><p>Se trata de crear una nueva entrada en la rama <code>architect/build/configurations</code> de tu aplicacin en el fichero <code>angular.json</code>.</p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"production-es\": &#123;</span><br><span class=\"line\">  \"fileReplacements\": [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"replace\"</span>: <span class=\"string\">\"apps/warehouse/src/environments/environment.ts\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"with\"</span>: <span class=\"string\">\"apps/warehouse/src/environments/environment.prod.es.ts\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  \"outputPath\": \"dist/apps/warehouse/es/\",</span><br><span class=\"line\">  \"i18nFile\": \"apps/warehouse/src/locale/messages.es.xlf\",</span><br><span class=\"line\">  \"i18nFormat\": \"xlf\",</span><br><span class=\"line\">  \"i18nLocale\": \"es\",</span><br><span class=\"line\">  \"baseHref\": \"es\",</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Esencialmente se le dicen las rutas y los ficheros que debe utilizar durante el proceso de construccin. Para usarla definimos un par de scripts. Uno para la construccin en s mediante <code>ng build</code> y el otro para poder ver el resultado con un servidor de ficheros estticos.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"build:warehouse-es\"</span>: <span class=\"string\">\"ng build warehouse --configuration=production-es\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"start:warehouse-es\"</span>: <span class=\"string\">\"npm run build:warehouse-es &amp;&amp; angular-http-server --path ./dist/apps/warehouse/es\"</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"2-Adaptaciones-culturales-de-tiempo-y-moneda\"><a href=\"#2-Adaptaciones-culturales-de-tiempo-y-moneda\" class=\"headerlink\" title=\"2 Adaptaciones culturales de tiempo y moneda\"></a>2 Adaptaciones culturales de tiempo y moneda</h1><p>Pero no todo van a ser textos. Tambin hay fechas, nmero, imgenes Se necesitan hacer pequeas adaptaciones en un montn de lugares. En Angular, algunas son casi gratis.</p><h2 id=\"2-1-Registro-manual-en-app-module-o-Auto-registro-en-angular-json\"><a href=\"#2-1-Registro-manual-en-app-module-o-Auto-registro-en-angular-json\" class=\"headerlink\" title=\"2.1 Registro manual en app.module o Auto registro en angular.json\"></a>2.1 Registro manual en app.module o Auto registro en angular.json</h2><p>Habrs usado <em>pipes</em> como <code>date</code> o <code>number</code> desde el da que empezaste con Angular. Si no haces nada especial seguro que te choc ver que las fechas y los nmeros en formato norte americano. Es el que viene de fbrica, pero e fcil cambiarlo.</p><h3 id=\"Manual\"><a href=\"#Manual\" class=\"headerlink\" title=\"Manual\"></a>Manual</h3><p>Puedes asignar la cultura en tu aplicacin de forma implcita registrndola al inicio del mdulo raz. La clave est en importar el fichero con las definiciones particulares de tu cultura.</p><p>Todo est descargado en node-modules. Pero slo se empaqueta y enva al navegador la cultura seleccionada.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; registerLocaleData &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> localeEs <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/locales/es'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">registerLocaleData(localeEs);</span><br></pre></td></tr></table></figure><h3 id=\"Automatico\"><a href=\"#Automatico\" class=\"headerlink\" title=\"Automtico\"></a>Automtico</h3><p>Otra forma es usar el fichero <code>package.json</code> para configurarlo. Puedes establece la cultura deseada en la propiedad <code>i18nLocale</code>.</p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"i18nLocale\": \"es\"</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Tiempo-moneda-y-contenido\"><a href=\"#2-2-Tiempo-moneda-y-contenido\" class=\"headerlink\" title=\"2.2 Tiempo, moneda y contenido\"></a>2.2 Tiempo, moneda y contenido</h2><p>En cualquier caso, todos los pipes deAngular empezarn a comportarse educadamente conforme a la cultura establecida.</p><p><code>apps\\warehouse\\src\\app\\app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">article</span> <span class=\"attr\">class</span>=<span class=\"string\">\"card\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; building.date | date:'long' &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>$&#123;&#123; building.value | number &#125;&#125;<span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span> &#123;&#123; building.status &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">article</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>apps\\warehouse\\src\\app\\app.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> building = &#123;</span><br><span class=\"line\">  date: <span class=\"built_in\">Date</span>.now(),</span><br><span class=\"line\">  value: <span class=\"number\">2345.897</span>,</span><br><span class=\"line\">  status: <span class=\"string\">'buy'</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.building.status === <span class=\"string\">'buy'</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.building.status = environment.buy;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.building.status = environment.sell;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Otra cosa pueden ser pequeos textos, lgica , iconos o clases css. A veces todo esto vara de un pas a otro. Esas variaciones puedes almacenarla en ficheros externos o dentro del cdigo. Pero si optas por esto ultimo entonces es mejor que uses los <em>environments</em> para almacenar configuraciones especficas.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Original environment.prod.ts</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  buy: <span class=\"string\">'for buy'</span>,</span><br><span class=\"line\">  sell: <span class=\"string\">'for sell'</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"># En espaol environment.prod.es.ts</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  buy: <span class=\"string\">'para comprar'</span>,</span><br><span class=\"line\">  sell: <span class=\"string\">'para vender'</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora ya tienes una aplicacin que se puede desplegar adaptada a las preferencias culturales de tus usuarios. Contina tu formacin avanzada para crear aplicaciones ms all del framework con los <a href=\"../elementos-Angular-para-los-Web-Components/\">Elementos Angular para los Web Components</a> y vers como aprendes a programar con Angular 8.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-18_i18n.png\" alt=\"internacionalizacion-y-puesta-en-produccion-con-Angular\"></p><p>Las aplicaciones web, son la expresin perfecta del mundo globalizado en el que vivimos. Preparar tu aplicacin para ese mundo se conoce como <em>internationalization</em>, o recortadamente <strong>i18n</strong>. Pero globalizar no significa caf con leche para todos. Atender a las necesidades especficas de tus usuarios es el proceso de <strong>localization</strong>.</p><p>Para empezar esto afecta las traducciones de los contenidos: sean datos o textos fijos. Pero tambin a las adaptaciones culturales para la presentacin de fechas, nmeros, iconos En Angular tenemos herramientas y soluciones para poner en marcha proyectos globalizados.</p>","more":"<p>Partiendo del cdigo tal como qued en <a href=\"../velocidad-y-seo-con-el-ssr-de-angular-universal/\">Velocidad y SEO con el SSR de Angular Universal</a>. Al finalizar tendrs una aplicacin que adapta a la cultura del usuario.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h1 id=\"1-Traducciones-y-contenido\"><a href=\"#1-Traducciones-y-contenido\" class=\"headerlink\" title=\"1 Traducciones y contenido\"></a>1 Traducciones y contenido</h1><p>Traducir una aplicacin es el primer paso para que un usuario la acepte y comprenda mejor. Afecta a los datos que venga dese un API, y afecta a los textos fijos que acompaan a los datos.</p><p>Como estamos viendo Angular en frontend, me centrar en el problema de los literales en las <em>templates</em>. Existen varias estrategias para tratarlo, aqu veremos la oficial. Se apuesta por dos principios:</p><ul><li><p>El programador vea el texto en la plantilla en el idioma nativo escogido para el desarrollo. As puede hacerse una idea del tamao y apariencia inicial y facilita mucho la legibilidad del HTML.</p></li><li><p>El usuario descargue la aplicacin especfica para su idioma, de forma que no necesite llamadas extra ni resolucin dinmica para los textos y menajes fijos.</p></li></ul><h2 id=\"1-1-xi18n\"><a href=\"#1-1-xi18n\" class=\"headerlink\" title=\"1.1 xi18n\"></a>1.1 xi18n</h2><p>Para cumplir con esos criterios se necesita extraer del cdigo los literales que se van traducir. Para ello se usa una herramienta y un convenio.</p><p>La herramienta es <code>xi18n</code> que viene con el CLI. El convenio es la directiva <code>i18n</code> que viene con Angular. El uso es muy sencillo, como puedes ver este ejemplo.</p><p><code>apps\\warehouse\\src\\app\\app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span> <span class=\"attr\">i18n</span>&gt;</span>Welcome to the Angular Builders Warehouse<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"../assets/Warehouse-Building.jpg\"</span></span></span><br><span class=\"line\"><span class=\"tag\">     <span class=\"attr\">alt</span>=<span class=\"string\">\"Warehouse building\"</span></span></span><br><span class=\"line\"><span class=\"tag\">     <span class=\"attr\">i18n-alt</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">footer</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://angular.builders\"</span></span></span><br><span class=\"line\"><span class=\"tag\">     <span class=\"attr\">target</span>=<span class=\"string\">\"blank\"</span>&gt;</span>Angular.Builders: <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">i18n</span>&gt;</span>a store of resources for developers and software architects.<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">footer</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Para la extraccin se recomienda, como siempre, crear un script en el <code>package.json</code></p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"i18n:warehouse\"</span>: <span class=\"string\">\"ng xi18n warehouse --output-path src/locale\"</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Atencin IVY: por el momento debemos desactivar el renderizador <em>Ivy</em> para poder realizar la extraccin.</p></blockquote><p><code>apps\\warehouse\\tsconfig.app.json</code></p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"attr\">\"angularCompilerOptions\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"enableIvy\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Aparecer un fichero <em>xml</em> un tanto feo: <code>/src/locale/messages.xlf</code>. Aunque es procesable automticamente, por ahora vamos a usarlo de forma manual. Para empezar crea una copia y nmbrala incluyendo el idioma destino. Por ejemplo<code>messages.es.xlf</code></p><p>Slo tendrs que duplicar cada etiqueta <code>source</code> en su equivalente traducido <code>target</code> y traducirlo, claro. Te pongo aqu un ejemplo de como quedara.</p><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">trans-unit</span> <span class=\"attr\">id</span>=<span class=\"string\">\"5c08a98fac06c803712ab27dbb81d889af5ef5fb\"</span> <span class=\"attr\">datatype</span>=<span class=\"string\">\"html\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">source</span>&gt;</span>Welcome to the Angular Builders Warehouse<span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">target</span>&gt;</span>Bienvenido al almacn de Angular Builders<span class=\"tag\">&lt;/<span class=\"name\">target</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context-group</span> <span class=\"attr\">purpose</span>=<span class=\"string\">\"location\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context</span> <span class=\"attr\">context-type</span>=<span class=\"string\">\"sourcefile\"</span>&gt;</span>src/app/app.component.html<span class=\"tag\">&lt;/<span class=\"name\">context</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context</span> <span class=\"attr\">context-type</span>=<span class=\"string\">\"linenumber\"</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">context</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">context-group</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">trans-unit</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Necesitars crear tantos ficheros como idiomas tengas que mantener. Si son muchos te recomiendo usar alguna herramienta. Tampoco debes olvidarte de realizar este proceso ante cada despliegue para incorporar los posibles cambios.</p><p>Y hablando de despliegue..</p><h2 id=\"1-2-Build-configurations\"><a href=\"#1-2-Build-configurations\" class=\"headerlink\" title=\"1.2 Build configurations\"></a>1.2 Build configurations</h2><p>Una vez que tenemos las traducciones en los ficheros de idioma, ahora hay que compilarlos para generar una versin distribuible especfica para cada idioma. De nuevo esto es un proceso un tanto tedioso la primera vez, y que desde luego merece ser automatizado.</p><p>Se trata de crear una nueva entrada en la rama <code>architect/build/configurations</code> de tu aplicacin en el fichero <code>angular.json</code>.</p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"production-es\": &#123;</span><br><span class=\"line\">  \"fileReplacements\": [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"replace\"</span>: <span class=\"string\">\"apps/warehouse/src/environments/environment.ts\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"with\"</span>: <span class=\"string\">\"apps/warehouse/src/environments/environment.prod.es.ts\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  \"outputPath\": \"dist/apps/warehouse/es/\",</span><br><span class=\"line\">  \"i18nFile\": \"apps/warehouse/src/locale/messages.es.xlf\",</span><br><span class=\"line\">  \"i18nFormat\": \"xlf\",</span><br><span class=\"line\">  \"i18nLocale\": \"es\",</span><br><span class=\"line\">  \"baseHref\": \"es\",</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Esencialmente se le dicen las rutas y los ficheros que debe utilizar durante el proceso de construccin. Para usarla definimos un par de scripts. Uno para la construccin en s mediante <code>ng build</code> y el otro para poder ver el resultado con un servidor de ficheros estticos.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"build:warehouse-es\"</span>: <span class=\"string\">\"ng build warehouse --configuration=production-es\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"start:warehouse-es\"</span>: <span class=\"string\">\"npm run build:warehouse-es &amp;&amp; angular-http-server --path ./dist/apps/warehouse/es\"</span>,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"2-Adaptaciones-culturales-de-tiempo-y-moneda\"><a href=\"#2-Adaptaciones-culturales-de-tiempo-y-moneda\" class=\"headerlink\" title=\"2 Adaptaciones culturales de tiempo y moneda\"></a>2 Adaptaciones culturales de tiempo y moneda</h1><p>Pero no todo van a ser textos. Tambin hay fechas, nmero, imgenes Se necesitan hacer pequeas adaptaciones en un montn de lugares. En Angular, algunas son casi gratis.</p><h2 id=\"2-1-Registro-manual-en-app-module-o-Auto-registro-en-angular-json\"><a href=\"#2-1-Registro-manual-en-app-module-o-Auto-registro-en-angular-json\" class=\"headerlink\" title=\"2.1 Registro manual en app.module o Auto registro en angular.json\"></a>2.1 Registro manual en app.module o Auto registro en angular.json</h2><p>Habrs usado <em>pipes</em> como <code>date</code> o <code>number</code> desde el da que empezaste con Angular. Si no haces nada especial seguro que te choc ver que las fechas y los nmeros en formato norte americano. Es el que viene de fbrica, pero e fcil cambiarlo.</p><h3 id=\"Manual\"><a href=\"#Manual\" class=\"headerlink\" title=\"Manual\"></a>Manual</h3><p>Puedes asignar la cultura en tu aplicacin de forma implcita registrndola al inicio del mdulo raz. La clave est en importar el fichero con las definiciones particulares de tu cultura.</p><p>Todo est descargado en node-modules. Pero slo se empaqueta y enva al navegador la cultura seleccionada.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; registerLocaleData &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> localeEs <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/locales/es'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">registerLocaleData(localeEs);</span><br></pre></td></tr></table></figure><h3 id=\"Automatico\"><a href=\"#Automatico\" class=\"headerlink\" title=\"Automtico\"></a>Automtico</h3><p>Otra forma es usar el fichero <code>package.json</code> para configurarlo. Puedes establece la cultura deseada en la propiedad <code>i18nLocale</code>.</p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"i18nLocale\": \"es\"</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Tiempo-moneda-y-contenido\"><a href=\"#2-2-Tiempo-moneda-y-contenido\" class=\"headerlink\" title=\"2.2 Tiempo, moneda y contenido\"></a>2.2 Tiempo, moneda y contenido</h2><p>En cualquier caso, todos los pipes deAngular empezarn a comportarse educadamente conforme a la cultura establecida.</p><p><code>apps\\warehouse\\src\\app\\app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">article</span> <span class=\"attr\">class</span>=<span class=\"string\">\"card\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; building.date | date:'long' &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>$&#123;&#123; building.value | number &#125;&#125;<span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span> &#123;&#123; building.status &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">article</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>apps\\warehouse\\src\\app\\app.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> building = &#123;</span><br><span class=\"line\">  date: <span class=\"built_in\">Date</span>.now(),</span><br><span class=\"line\">  value: <span class=\"number\">2345.897</span>,</span><br><span class=\"line\">  status: <span class=\"string\">'buy'</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.building.status === <span class=\"string\">'buy'</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.building.status = environment.buy;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.building.status = environment.sell;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Otra cosa pueden ser pequeos textos, lgica , iconos o clases css. A veces todo esto vara de un pas a otro. Esas variaciones puedes almacenarla en ficheros externos o dentro del cdigo. Pero si optas por esto ultimo entonces es mejor que uses los <em>environments</em> para almacenar configuraciones especficas.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Original environment.prod.ts</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  buy: <span class=\"string\">'for buy'</span>,</span><br><span class=\"line\">  sell: <span class=\"string\">'for sell'</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"># En espaol environment.prod.es.ts</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  buy: <span class=\"string\">'para comprar'</span>,</span><br><span class=\"line\">  sell: <span class=\"string\">'para vender'</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora ya tienes una aplicacin que se puede desplegar adaptada a las preferencias culturales de tus usuarios. Contina tu formacin avanzada para crear aplicaciones ms all del framework con los <a href=\"../elementos-Angular-para-los-Web-Components/\">Elementos Angular para los Web Components</a> y vers como aprendes a programar con Angular 8.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Elementos Angular para los Web Components","date":"2019-10-29T08:19:39.000Z","thumbnail":"/css/images/angular-19_elements.png","_content":"\n![elementos-Angular-para-los-Web-Components](/images/tutorial-angular-19_elements.png)\n\nLa industria web vive un momento de esplendor y le crecen los _frameworks_ como hierbas primaverales. Pero el estndar HTML no se queda atrs y evoluciona hacia tecnologas potentes y genricas. **Angular Elements** promueve la reutilizacin de cdigo en distintos frameworks para que puedas usar tus componentes Angular en otros entornos.\n\nSiendo como es Google una empresa _web first_, se esfuerzan en incorporar y adaptar de la mejor manera los estndares HTML a sus productos. Con el desarrollo de Angular siempre tuvieron la vista puesta en la tecnologa de los **Web Components**. Buscando que los usos futuros del cdigo se garantizasen ms all del framework de creacin.\n\n<!-- more -->\n\nPartiendo del cdigo tal como qued en [Internacionalizacin y puesta en produccin](../internacionalizacion-y-puesta-en-produccion-con-Angular/). Al finalizar tendrs unos componentes que podrs utilizar fuera de Angular.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n# 1. Componentes independientes del framework\n\n> Hay lcteos que aguantan ms que algunos frameworks.\n\nSeguramente este no sea el caso de Angular, ni de otros frameworks de adopcin masiva como React, Vue o Svelte. Todos ellos tienen un presente brillante y un futuro garantizado al plazo que la tecnologa pueda vislumbrar. Pero ms temprano que tarde otra tecnologa o paradigma disruptivo los desplazar. O al menos los obligar a cambiar tanto que sean irreconocibles.\n\nPara entonces, y tambin mientras tanto, nuestro cdigo ser cautivo del framework en el que naci. Pero eso cambiar con los **Web Components**.\n\n## 1.1 Origen y potencial\n\nLos **Web Components** son independientes de los _frameworks._ Esta es la idea clave; se pueden desarrollar con el estndar pelado de JavaScript o con cualquier framework moderno. Pero lo fundamental es que no exigen nada especial para ejecutarse. Esto permite la interoperabilidad y tambin extiende la vida til de tus creaciones.\n\n### Usos posibles\n\nPartiendo de dichas premisas es fcil entrever todo el potencial y casos dnde aplicarlos. Por ejemplo:\n\n- Libreras de diseo _multiplataforma_.\n\n- Migracin paulatina de aplicaciones _legacy_.\n\n- Integracin dinmica en grandes soluciones _CMS_.\n\n- Mejoras funcionales en aplicaciones _server side_.\n\n## 1.2 Estndares y tecnologa\n\nBajo el trmino Web Components se esconden diversas tecnologas. No todas ellas estn al mismo nivel de aceptacin, e incluso alguna no ha visto la luz, pero este es un esbozo de lo que tenemos:\n\n- **Shadow DOM:** Manipulacin de un rbol en memoria antes de aplicar sus cambios al verdadero.\n- **HTML templates:** Fragmentos de HTML que no se utilizan en la carga de la pgina, pero que se pueden instanciar ms adelante.\n- **ES Modules:** Inclusin de documentos JS en forma de mdulos de manera estndar y gil.\n- **Custom elements:** son etiquetas HTML con funciones encapsuladas, reutilizables y listas para usar en pginas y aplicaciones web.\n\nEl estndar:\n\n> Los **Custom Web Elements** slo requieren _HTML y JavaScript_.\n\n\nLa tecnologa:\n\n> _Angular Elements_ empaqueta tus componentes como **Custom Web Elements**.\n\n# 2. Desarrollo y despliegue con Angular\n\n### Un componente comn de Angular\n\nPartimos de un componente Angular normal y corriente. Un conversor (s, ya s que es slo un miserable multiplicador) de monedas.\n\n`libs\\currency\\src\\lib\\converter\\converter.component.html`\n\n```html\n<form>\n  <label>Amount to convert: </label>\n  <input name=\"amount\"\n         [(ngModel)]=\"amount\"\n         type=\"number\"\n         (change)=\"convert()\" />\n  <label>Converted amount: </label>\n  <input name=\"convertedAmount\"\n         [(ngModel)]=\"convertedAmount\"\n         type=\"number\"\n         readonly />\n</form>\n```\n\n`libs\\currency\\src\\lib\\converter\\converter.component.ts`\n\n```Typescript\n@Component({\n  selector: 'angular-boss-converter',\n  templateUrl: './converter.component.html',\n  styleUrls: ['./converter.component.css']\n})\nexport class ConverterComponent implements OnInit {\n  @Input() factor = 1.1;\n  @Input() amount = 0;\n  @Output() converted = new EventEmitter<number>();\n  convertedAmount = 0;\n  constructor() {}\n  ngOnInit() {\n    this.convert();\n  }\n  convert() {\n    this.convertedAmount = this.amount * this.factor;\n    this.converted.next(this.convertedAmount);\n  }\n}\n```\n\n\n### El componente sigue siendo Angular\n\nEs tan normal y corriente que puedo importar su mdulo y usarlo en cualquier aplicacin Angular.\n\n`apps\\warehouse\\src\\app\\app.module.ts`\n\n```typescript\nimport { CurrencyModule } from '@angular-boss/currency';\n\n@NgModule({\n  imports: [\n    CurrencyModule\n  ],\n})\nexport class AppModule {}\n```\n\n`apps\\warehouse\\src\\app\\app.component.html`\n\n```html\n<angular-boss-converter amount=\"100\"\n                        factor=\"1.5\"></angular-boss-converter>\n```\n\n## 2.1 Exponer los componentes\n\nPero ahora todo va a cambiar. Necesitamos un proyecto de exportacin. Nada especial. Yo le pongo aqu el prefijo external para hacer hincapi en su funcin de exportacin.\n\n`ng g @nrwl/angular:application external-currency`\n\nSi el componente a exportar ya ha sido probado, y debera, en este proyecto no necesitamos nada ms que el mdulo. As que puedes borrar tranquilamente el `AppComponent`, e incluso el `index.html`.\n\nPongmonos con la exportacin, para la cual hacen falta herramientas. Pues adelante con ellas. Incorporamos **Angular Elements**.\n\n`ng add @angular/elements`\n\nAhora ya importamos el componente en el _array_ `imports` y lo exportamos, pero no en `exports` ni tampoco en `bootstrap`. Vamos a incluirlo en `entryComponents`.\n\n`apps\\external-currency\\src\\app\\app.module.ts`\n\n```typescript\nimport { ConverterComponent, CurrencyModule } from '@angular-boss/currency';\nimport { Injector, NgModule } from '@angular/core';\nimport { createCustomElement } from '@angular/elements';\nimport { BrowserModule } from '@angular/platform-browser';\nimport 'zone.js';\n@NgModule({\n  imports: [BrowserModule, CurrencyModule],\n  entryComponents: [ConverterComponent]\n})\nexport class AppModule {\n  constructor(private injector: Injector) {}\n  ngDoBootstrap() {\n    const el = createCustomElement(ConverterComponent, {\n      injector: this.injector\n    });\n    customElements.define('external-currency-converter', el);\n  }\n}\n```\n\nLos `entryComponents` son cargados por Angular de forma imperativa, sin necesidad de incluirlos en un _html_. Menos mal porque este proyecto ni siquiera usa el `index.hml`\n\n### ngDoBootstrap\n\nJustamente la falta de componentes en el array `bootstrap` obliga a arrancar la aplicacin mediante cdigo. Esto lo hacemos programando en el _hook_ `ngDoBootstrap()`, un mtodo que ser invocado al inicio y en el meteremos la lgica necesaria para definir el **Web Component**.\n\nSon solamente dos instrucciones que usars para cada componente que quieras transformar en un elemento.\n\n```typescript\n  const el = createCustomElement(ConverterComponent, {\n    injector: this.injector\n  });\n  customElements.define('external-currency-converter', el);\n```\n\nEn la primera se crea el elemento mediante una funcin constructora que ofrece `@angular/elements`. Para ello necesita un puntero al componente original y el sistema de inyeccin de dependencias de Angular. (El cual a su vez reclamamos en el constructor del mdulo).\n\nLa segunda instruccin ya no es propia de Angular. Simplemente se le asigna al elemento recin creado el _selector tag_ por el que ser conocido.\n\n> Atencin a la importacin de `zone.js`.\n\nEs necesaria para poder usar la deteccin de cambios en aplicaciones no Angular.\n\n## 2.2 Compilacin y despliegue\n\nA partir de aqu se acab el trabajo de programacin. Y toca el ms tedioso de operaciones de compilacin y distribucin.\n\nAfortunadamente podemos aplicar la magia de `@angular/elements` y utilidades como `ngx-build-plus` para compilarlo como un Web Component.\n\n### Agregar herramientas de ayuda\n\nLo primero es instalar una herramienta que mejora el proceso de compilacin del CLI.\n\n`ng add ngx-build-plus --project external-currency`\n\nEsencialmente usa _webpack_ para empaquetar el resultado de la compilacin `build` nativa del CLI. Pero no necesitas profundizar en su interior para usarla en el da da.\n\n### Polyfills\n\nCon el Internet Explorer hemos topado. Y otros navegadores antiguos, claro. El caso es que para que entiendan este nuevo estndar, tenemos que incluir una serie de arreglos llamados _polyfills_, que rellenan los huecos de incomprensin de los viejos exploradores. As que para garantizar la compatibilidad en todos los navegadores instalamos todo lo necesario usando `ngx-build-plus`.\n\n`ng g ngx-build-plus:wc-polyfill --project external-currency`\n\nOjo que en algunas versiones se equivoca en la generacin de los _assets_ y hay que moverlos a mano.\n\n---\n\n### Compilacin\n\nYa solo falta lanzar el comando de compilacin `ng build`. Pero para ajustar un poco ms el resultado te propongo que deshabilites el nombrado con _hash_ y por supuesto que uses algunos parmetros que ha incluido `ngx-build-plus`.\n\nNombres legibles: `\"outputHashing\": \"none\",`\n\nGeneracin: `ng build --prod --single-bundle --project external-currency`\n\n# 3. Consumo en HTML\n\nYa est, el resultado se podr utilizar en cualquier aplicacin HTML. Por ejemplo en una pgina prcticamente vaca y completamente estndar.\n\n`apps\\vanilla\\index.html`\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>Vanilla Currency</title>\n    <base href=\"/apps/vanilla/\" />\n    <meta name=\"viewport\"\n          content=\"width=device-width, initial-scale=1\" />\n    <link rel=\"icon\"\n          type=\"image/x-icon\"\n          href=\"favicon.ico\" />\n  </head>\n  <body>\n    <h2>Convert money:</h2>\n    <external-currency-converter amount=\"15\"></external-currency-converter>\n  </body>\n</html>\n```\nQue no funciona? Obvio, el navegador no entiende el _tag_ `external-currency-converter`. Necesitamos el JavaScript de la compilacin anterior\n\n## 3.1 Copiar\n\nCopia los dos archivos generados en la carpeta de distribucin\n\n`dist\\apps\\external-currency`\n\nY pgalos al lado del html que quieras. Por ejemplo:\n\n`apps\\vanilla\\`\n\n## 3.2 Importar\n\nSon dos porque hay versin clsica y modular. Importa la que necesites o ambas, y ya est.\n\n```html\n  <script src=\"main-es2015.js\"\n          type=\"module\"></script>\n  <script src=\"main-es5.js\"\n          nomodule\n          defer></script>\n```\n\n> Una web HTML pura, mostrando un componente creado en Angular\n\n\nAhora ya tienes cdigo creado en Angular pero que puedes integrar en cualquier web. Todo este proceso an puede resultar tedioso, pero es el futuro. Contina tu formacin avanzada para crear aplicaciones Angular fijndote en el  [Angular Blueprint](https://github.com/angularbuilders/angular-blueprint/) creado por la iniciativa [Angular.Builders](https://angular.builders/) y vers como aprendes a programar grandes aplicaciones con Angular.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","source":"_posts/ng-19-Elementos Angular para los Web Components.md","raw":"---\ntitle: Elementos Angular para los Web Components\npermalink: elementos-Angular-para-los-Web-Components\ndate: 2019-10-29 09:19:39\ntags:\n- Angular\n- Angular8\n- Angular2\n- Elements\n- WebComponents\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-19_elements.png\n---\n\n![elementos-Angular-para-los-Web-Components](/images/tutorial-angular-19_elements.png)\n\nLa industria web vive un momento de esplendor y le crecen los _frameworks_ como hierbas primaverales. Pero el estndar HTML no se queda atrs y evoluciona hacia tecnologas potentes y genricas. **Angular Elements** promueve la reutilizacin de cdigo en distintos frameworks para que puedas usar tus componentes Angular en otros entornos.\n\nSiendo como es Google una empresa _web first_, se esfuerzan en incorporar y adaptar de la mejor manera los estndares HTML a sus productos. Con el desarrollo de Angular siempre tuvieron la vista puesta en la tecnologa de los **Web Components**. Buscando que los usos futuros del cdigo se garantizasen ms all del framework de creacin.\n\n<!-- more -->\n\nPartiendo del cdigo tal como qued en [Internacionalizacin y puesta en produccin](../internacionalizacion-y-puesta-en-produccion-con-Angular/). Al finalizar tendrs unos componentes que podrs utilizar fuera de Angular.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-boss](https://github.com/AcademiaBinaria/angular-boss)\n\n# 1. Componentes independientes del framework\n\n> Hay lcteos que aguantan ms que algunos frameworks.\n\nSeguramente este no sea el caso de Angular, ni de otros frameworks de adopcin masiva como React, Vue o Svelte. Todos ellos tienen un presente brillante y un futuro garantizado al plazo que la tecnologa pueda vislumbrar. Pero ms temprano que tarde otra tecnologa o paradigma disruptivo los desplazar. O al menos los obligar a cambiar tanto que sean irreconocibles.\n\nPara entonces, y tambin mientras tanto, nuestro cdigo ser cautivo del framework en el que naci. Pero eso cambiar con los **Web Components**.\n\n## 1.1 Origen y potencial\n\nLos **Web Components** son independientes de los _frameworks._ Esta es la idea clave; se pueden desarrollar con el estndar pelado de JavaScript o con cualquier framework moderno. Pero lo fundamental es que no exigen nada especial para ejecutarse. Esto permite la interoperabilidad y tambin extiende la vida til de tus creaciones.\n\n### Usos posibles\n\nPartiendo de dichas premisas es fcil entrever todo el potencial y casos dnde aplicarlos. Por ejemplo:\n\n- Libreras de diseo _multiplataforma_.\n\n- Migracin paulatina de aplicaciones _legacy_.\n\n- Integracin dinmica en grandes soluciones _CMS_.\n\n- Mejoras funcionales en aplicaciones _server side_.\n\n## 1.2 Estndares y tecnologa\n\nBajo el trmino Web Components se esconden diversas tecnologas. No todas ellas estn al mismo nivel de aceptacin, e incluso alguna no ha visto la luz, pero este es un esbozo de lo que tenemos:\n\n- **Shadow DOM:** Manipulacin de un rbol en memoria antes de aplicar sus cambios al verdadero.\n- **HTML templates:** Fragmentos de HTML que no se utilizan en la carga de la pgina, pero que se pueden instanciar ms adelante.\n- **ES Modules:** Inclusin de documentos JS en forma de mdulos de manera estndar y gil.\n- **Custom elements:** son etiquetas HTML con funciones encapsuladas, reutilizables y listas para usar en pginas y aplicaciones web.\n\nEl estndar:\n\n> Los **Custom Web Elements** slo requieren _HTML y JavaScript_.\n\n\nLa tecnologa:\n\n> _Angular Elements_ empaqueta tus componentes como **Custom Web Elements**.\n\n# 2. Desarrollo y despliegue con Angular\n\n### Un componente comn de Angular\n\nPartimos de un componente Angular normal y corriente. Un conversor (s, ya s que es slo un miserable multiplicador) de monedas.\n\n`libs\\currency\\src\\lib\\converter\\converter.component.html`\n\n```html\n<form>\n  <label>Amount to convert: </label>\n  <input name=\"amount\"\n         [(ngModel)]=\"amount\"\n         type=\"number\"\n         (change)=\"convert()\" />\n  <label>Converted amount: </label>\n  <input name=\"convertedAmount\"\n         [(ngModel)]=\"convertedAmount\"\n         type=\"number\"\n         readonly />\n</form>\n```\n\n`libs\\currency\\src\\lib\\converter\\converter.component.ts`\n\n```Typescript\n@Component({\n  selector: 'angular-boss-converter',\n  templateUrl: './converter.component.html',\n  styleUrls: ['./converter.component.css']\n})\nexport class ConverterComponent implements OnInit {\n  @Input() factor = 1.1;\n  @Input() amount = 0;\n  @Output() converted = new EventEmitter<number>();\n  convertedAmount = 0;\n  constructor() {}\n  ngOnInit() {\n    this.convert();\n  }\n  convert() {\n    this.convertedAmount = this.amount * this.factor;\n    this.converted.next(this.convertedAmount);\n  }\n}\n```\n\n\n### El componente sigue siendo Angular\n\nEs tan normal y corriente que puedo importar su mdulo y usarlo en cualquier aplicacin Angular.\n\n`apps\\warehouse\\src\\app\\app.module.ts`\n\n```typescript\nimport { CurrencyModule } from '@angular-boss/currency';\n\n@NgModule({\n  imports: [\n    CurrencyModule\n  ],\n})\nexport class AppModule {}\n```\n\n`apps\\warehouse\\src\\app\\app.component.html`\n\n```html\n<angular-boss-converter amount=\"100\"\n                        factor=\"1.5\"></angular-boss-converter>\n```\n\n## 2.1 Exponer los componentes\n\nPero ahora todo va a cambiar. Necesitamos un proyecto de exportacin. Nada especial. Yo le pongo aqu el prefijo external para hacer hincapi en su funcin de exportacin.\n\n`ng g @nrwl/angular:application external-currency`\n\nSi el componente a exportar ya ha sido probado, y debera, en este proyecto no necesitamos nada ms que el mdulo. As que puedes borrar tranquilamente el `AppComponent`, e incluso el `index.html`.\n\nPongmonos con la exportacin, para la cual hacen falta herramientas. Pues adelante con ellas. Incorporamos **Angular Elements**.\n\n`ng add @angular/elements`\n\nAhora ya importamos el componente en el _array_ `imports` y lo exportamos, pero no en `exports` ni tampoco en `bootstrap`. Vamos a incluirlo en `entryComponents`.\n\n`apps\\external-currency\\src\\app\\app.module.ts`\n\n```typescript\nimport { ConverterComponent, CurrencyModule } from '@angular-boss/currency';\nimport { Injector, NgModule } from '@angular/core';\nimport { createCustomElement } from '@angular/elements';\nimport { BrowserModule } from '@angular/platform-browser';\nimport 'zone.js';\n@NgModule({\n  imports: [BrowserModule, CurrencyModule],\n  entryComponents: [ConverterComponent]\n})\nexport class AppModule {\n  constructor(private injector: Injector) {}\n  ngDoBootstrap() {\n    const el = createCustomElement(ConverterComponent, {\n      injector: this.injector\n    });\n    customElements.define('external-currency-converter', el);\n  }\n}\n```\n\nLos `entryComponents` son cargados por Angular de forma imperativa, sin necesidad de incluirlos en un _html_. Menos mal porque este proyecto ni siquiera usa el `index.hml`\n\n### ngDoBootstrap\n\nJustamente la falta de componentes en el array `bootstrap` obliga a arrancar la aplicacin mediante cdigo. Esto lo hacemos programando en el _hook_ `ngDoBootstrap()`, un mtodo que ser invocado al inicio y en el meteremos la lgica necesaria para definir el **Web Component**.\n\nSon solamente dos instrucciones que usars para cada componente que quieras transformar en un elemento.\n\n```typescript\n  const el = createCustomElement(ConverterComponent, {\n    injector: this.injector\n  });\n  customElements.define('external-currency-converter', el);\n```\n\nEn la primera se crea el elemento mediante una funcin constructora que ofrece `@angular/elements`. Para ello necesita un puntero al componente original y el sistema de inyeccin de dependencias de Angular. (El cual a su vez reclamamos en el constructor del mdulo).\n\nLa segunda instruccin ya no es propia de Angular. Simplemente se le asigna al elemento recin creado el _selector tag_ por el que ser conocido.\n\n> Atencin a la importacin de `zone.js`.\n\nEs necesaria para poder usar la deteccin de cambios en aplicaciones no Angular.\n\n## 2.2 Compilacin y despliegue\n\nA partir de aqu se acab el trabajo de programacin. Y toca el ms tedioso de operaciones de compilacin y distribucin.\n\nAfortunadamente podemos aplicar la magia de `@angular/elements` y utilidades como `ngx-build-plus` para compilarlo como un Web Component.\n\n### Agregar herramientas de ayuda\n\nLo primero es instalar una herramienta que mejora el proceso de compilacin del CLI.\n\n`ng add ngx-build-plus --project external-currency`\n\nEsencialmente usa _webpack_ para empaquetar el resultado de la compilacin `build` nativa del CLI. Pero no necesitas profundizar en su interior para usarla en el da da.\n\n### Polyfills\n\nCon el Internet Explorer hemos topado. Y otros navegadores antiguos, claro. El caso es que para que entiendan este nuevo estndar, tenemos que incluir una serie de arreglos llamados _polyfills_, que rellenan los huecos de incomprensin de los viejos exploradores. As que para garantizar la compatibilidad en todos los navegadores instalamos todo lo necesario usando `ngx-build-plus`.\n\n`ng g ngx-build-plus:wc-polyfill --project external-currency`\n\nOjo que en algunas versiones se equivoca en la generacin de los _assets_ y hay que moverlos a mano.\n\n---\n\n### Compilacin\n\nYa solo falta lanzar el comando de compilacin `ng build`. Pero para ajustar un poco ms el resultado te propongo que deshabilites el nombrado con _hash_ y por supuesto que uses algunos parmetros que ha incluido `ngx-build-plus`.\n\nNombres legibles: `\"outputHashing\": \"none\",`\n\nGeneracin: `ng build --prod --single-bundle --project external-currency`\n\n# 3. Consumo en HTML\n\nYa est, el resultado se podr utilizar en cualquier aplicacin HTML. Por ejemplo en una pgina prcticamente vaca y completamente estndar.\n\n`apps\\vanilla\\index.html`\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>Vanilla Currency</title>\n    <base href=\"/apps/vanilla/\" />\n    <meta name=\"viewport\"\n          content=\"width=device-width, initial-scale=1\" />\n    <link rel=\"icon\"\n          type=\"image/x-icon\"\n          href=\"favicon.ico\" />\n  </head>\n  <body>\n    <h2>Convert money:</h2>\n    <external-currency-converter amount=\"15\"></external-currency-converter>\n  </body>\n</html>\n```\nQue no funciona? Obvio, el navegador no entiende el _tag_ `external-currency-converter`. Necesitamos el JavaScript de la compilacin anterior\n\n## 3.1 Copiar\n\nCopia los dos archivos generados en la carpeta de distribucin\n\n`dist\\apps\\external-currency`\n\nY pgalos al lado del html que quieras. Por ejemplo:\n\n`apps\\vanilla\\`\n\n## 3.2 Importar\n\nSon dos porque hay versin clsica y modular. Importa la que necesites o ambas, y ya est.\n\n```html\n  <script src=\"main-es2015.js\"\n          type=\"module\"></script>\n  <script src=\"main-es5.js\"\n          nomodule\n          defer></script>\n```\n\n> Una web HTML pura, mostrando un componente creado en Angular\n\n\nAhora ya tienes cdigo creado en Angular pero que puedes integrar en cualquier web. Todo este proceso an puede resultar tedioso, pero es el futuro. Contina tu formacin avanzada para crear aplicaciones Angular fijndote en el  [Angular Blueprint](https://github.com/angularbuilders/angular-blueprint/) creado por la iniciativa [Angular.Builders](https://angular.builders/) y vers como aprendes a programar grandes aplicaciones con Angular.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","slug":"elementos-Angular-para-los-Web-Components","published":1,"updated":"2019-10-28T16:29:59.402Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab1n000sbss310corfp5","content":"<p><img src=\"/images/tutorial-angular-19_elements.png\" alt=\"elementos-Angular-para-los-Web-Components\"></p><p>La industria web vive un momento de esplendor y le crecen los <em>frameworks</em> como hierbas primaverales. Pero el estndar HTML no se queda atrs y evoluciona hacia tecnologas potentes y genricas. <strong>Angular Elements</strong> promueve la reutilizacin de cdigo en distintos frameworks para que puedas usar tus componentes Angular en otros entornos.</p><p>Siendo como es Google una empresa <em>web first</em>, se esfuerzan en incorporar y adaptar de la mejor manera los estndares HTML a sus productos. Con el desarrollo de Angular siempre tuvieron la vista puesta en la tecnologa de los <strong>Web Components</strong>. Buscando que los usos futuros del cdigo se garantizasen ms all del framework de creacin.</p><a id=\"more\"></a><p>Partiendo del cdigo tal como qued en <a href=\"../internacionalizacion-y-puesta-en-produccion-con-Angular/\">Internacionalizacin y puesta en produccin</a>. Al finalizar tendrs unos componentes que podrs utilizar fuera de Angular.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h1 id=\"1-Componentes-independientes-del-framework\"><a href=\"#1-Componentes-independientes-del-framework\" class=\"headerlink\" title=\"1. Componentes independientes del framework\"></a>1. Componentes independientes del framework</h1><blockquote><p>Hay lcteos que aguantan ms que algunos frameworks.</p></blockquote><p>Seguramente este no sea el caso de Angular, ni de otros frameworks de adopcin masiva como React, Vue o Svelte. Todos ellos tienen un presente brillante y un futuro garantizado al plazo que la tecnologa pueda vislumbrar. Pero ms temprano que tarde otra tecnologa o paradigma disruptivo los desplazar. O al menos los obligar a cambiar tanto que sean irreconocibles.</p><p>Para entonces, y tambin mientras tanto, nuestro cdigo ser cautivo del framework en el que naci. Pero eso cambiar con los <strong>Web Components</strong>.</p><h2 id=\"1-1-Origen-y-potencial\"><a href=\"#1-1-Origen-y-potencial\" class=\"headerlink\" title=\"1.1 Origen y potencial\"></a>1.1 Origen y potencial</h2><p>Los <strong>Web Components</strong> son independientes de los <em>frameworks.</em> Esta es la idea clave; se pueden desarrollar con el estndar pelado de JavaScript o con cualquier framework moderno. Pero lo fundamental es que no exigen nada especial para ejecutarse. Esto permite la interoperabilidad y tambin extiende la vida til de tus creaciones.</p><h3 id=\"Usos-posibles\"><a href=\"#Usos-posibles\" class=\"headerlink\" title=\"Usos posibles\"></a>Usos posibles</h3><p>Partiendo de dichas premisas es fcil entrever todo el potencial y casos dnde aplicarlos. Por ejemplo:</p><ul><li><p>Libreras de diseo <em>multiplataforma</em>.</p></li><li><p>Migracin paulatina de aplicaciones <em>legacy</em>.</p></li><li><p>Integracin dinmica en grandes soluciones <em>CMS</em>.</p></li><li><p>Mejoras funcionales en aplicaciones <em>server side</em>.</p></li></ul><h2 id=\"1-2-Estandares-y-tecnologia\"><a href=\"#1-2-Estandares-y-tecnologia\" class=\"headerlink\" title=\"1.2 Estndares y tecnologa\"></a>1.2 Estndares y tecnologa</h2><p>Bajo el trmino Web Components se esconden diversas tecnologas. No todas ellas estn al mismo nivel de aceptacin, e incluso alguna no ha visto la luz, pero este es un esbozo de lo que tenemos:</p><ul><li><strong>Shadow DOM:</strong> Manipulacin de un rbol en memoria antes de aplicar sus cambios al verdadero.</li><li><strong>HTML templates:</strong> Fragmentos de HTML que no se utilizan en la carga de la pgina, pero que se pueden instanciar ms adelante.</li><li><strong>ES Modules:</strong> Inclusin de documentos JS en forma de mdulos de manera estndar y gil.</li><li><strong>Custom elements:</strong> son etiquetas HTML con funciones encapsuladas, reutilizables y listas para usar en pginas y aplicaciones web.</li></ul><p>El estndar:</p><blockquote><p>Los <strong>Custom Web Elements</strong> slo requieren <em>HTML y JavaScript</em>.</p></blockquote><p>La tecnologa:</p><blockquote><p><em>Angular Elements</em> empaqueta tus componentes como <strong>Custom Web Elements</strong>.</p></blockquote><h1 id=\"2-Desarrollo-y-despliegue-con-Angular\"><a href=\"#2-Desarrollo-y-despliegue-con-Angular\" class=\"headerlink\" title=\"2. Desarrollo y despliegue con Angular\"></a>2. Desarrollo y despliegue con Angular</h1><h3 id=\"Un-componente-comun-de-Angular\"><a href=\"#Un-componente-comun-de-Angular\" class=\"headerlink\" title=\"Un componente comn de Angular\"></a>Un componente comn de Angular</h3><p>Partimos de un componente Angular normal y corriente. Un conversor (s, ya s que es slo un miserable multiplicador) de monedas.</p><p><code>libs\\currency\\src\\lib\\converter\\converter.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Amount to convert: <span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"amount\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"amount\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         (<span class=\"attr\">change</span>)=<span class=\"string\">\"convert()\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Converted amount: <span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"convertedAmount\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"convertedAmount\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">readonly</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>libs\\currency\\src\\lib\\converter\\converter.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'angular-boss-converter'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./converter.component.html'</span>,</span><br><span class=\"line\">  styleUrls: [<span class=\"string\">'./converter.component.css'</span>]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ConverterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() factor = <span class=\"number\">1.1</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() amount = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Output</span>() converted = <span class=\"keyword\">new</span> EventEmitter&lt;<span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\">  convertedAmount = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convert();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  convert() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convertedAmount = <span class=\"keyword\">this</span>.amount * <span class=\"keyword\">this</span>.factor;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.converted.next(<span class=\"keyword\">this</span>.convertedAmount);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h3 id=\"El-componente-sigue-siendo-Angular\"><a href=\"#El-componente-sigue-siendo-Angular\" class=\"headerlink\" title=\"El componente sigue siendo Angular\"></a>El componente sigue siendo Angular</h3><p>Es tan normal y corriente que puedo importar su mdulo y usarlo en cualquier aplicacin Angular.</p><p><code>apps\\warehouse\\src\\app\\app.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; CurrencyModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular-boss/currency'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CurrencyModule</span><br><span class=\"line\">  ],</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p><code>apps\\warehouse\\src\\app\\app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">angular-boss-converter</span> <span class=\"attr\">amount</span>=<span class=\"string\">\"100\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                        <span class=\"attr\">factor</span>=<span class=\"string\">\"1.5\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">angular-boss-converter</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"2-1-Exponer-los-componentes\"><a href=\"#2-1-Exponer-los-componentes\" class=\"headerlink\" title=\"2.1 Exponer los componentes\"></a>2.1 Exponer los componentes</h2><p>Pero ahora todo va a cambiar. Necesitamos un proyecto de exportacin. Nada especial. Yo le pongo aqu el prefijo external para hacer hincapi en su funcin de exportacin.</p><p><code>ng g @nrwl/angular:application external-currency</code></p><p>Si el componente a exportar ya ha sido probado, y debera, en este proyecto no necesitamos nada ms que el mdulo. As que puedes borrar tranquilamente el <code>AppComponent</code>, e incluso el <code>index.html</code>.</p><p>Pongmonos con la exportacin, para la cual hacen falta herramientas. Pues adelante con ellas. Incorporamos <strong>Angular Elements</strong>.</p><p><code>ng add @angular/elements</code></p><p>Ahora ya importamos el componente en el <em>array</em> <code>imports</code> y lo exportamos, pero no en <code>exports</code> ni tampoco en <code>bootstrap</code>. Vamos a incluirlo en <code>entryComponents</code>.</p><p><code>apps\\external-currency\\src\\app\\app.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; ConverterComponent, CurrencyModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular-boss/currency'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Injector, NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; createCustomElement &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/elements'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; BrowserModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'zone.js'</span>;</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [BrowserModule, CurrencyModule],</span><br><span class=\"line\">  entryComponents: [ConverterComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> injector: Injector</span>) &#123;&#125;</span><br><span class=\"line\">  ngDoBootstrap() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> el = createCustomElement(ConverterComponent, &#123;</span><br><span class=\"line\">      injector: <span class=\"keyword\">this</span>.injector</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    customElements.define(<span class=\"string\">'external-currency-converter'</span>, el);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Los <code>entryComponents</code> son cargados por Angular de forma imperativa, sin necesidad de incluirlos en un <em>html</em>. Menos mal porque este proyecto ni siquiera usa el <code>index.hml</code></p><h3 id=\"ngDoBootstrap\"><a href=\"#ngDoBootstrap\" class=\"headerlink\" title=\"ngDoBootstrap\"></a>ngDoBootstrap</h3><p>Justamente la falta de componentes en el array <code>bootstrap</code> obliga a arrancar la aplicacin mediante cdigo. Esto lo hacemos programando en el <em>hook</em> <code>ngDoBootstrap()</code>, un mtodo que ser invocado al inicio y en el meteremos la lgica necesaria para definir el <strong>Web Component</strong>.</p><p>Son solamente dos instrucciones que usars para cada componente que quieras transformar en un elemento.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> el = createCustomElement(ConverterComponent, &#123;</span><br><span class=\"line\">  injector: <span class=\"keyword\">this</span>.injector</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">customElements.define(<span class=\"string\">'external-currency-converter'</span>, el);</span><br></pre></td></tr></table></figure><p>En la primera se crea el elemento mediante una funcin constructora que ofrece <code>@angular/elements</code>. Para ello necesita un puntero al componente original y el sistema de inyeccin de dependencias de Angular. (El cual a su vez reclamamos en el constructor del mdulo).</p><p>La segunda instruccin ya no es propia de Angular. Simplemente se le asigna al elemento recin creado el <em>selector tag</em> por el que ser conocido.</p><blockquote><p>Atencin a la importacin de <code>zone.js</code>.</p></blockquote><p>Es necesaria para poder usar la deteccin de cambios en aplicaciones no Angular.</p><h2 id=\"2-2-Compilacion-y-despliegue\"><a href=\"#2-2-Compilacion-y-despliegue\" class=\"headerlink\" title=\"2.2 Compilacin y despliegue\"></a>2.2 Compilacin y despliegue</h2><p>A partir de aqu se acab el trabajo de programacin. Y toca el ms tedioso de operaciones de compilacin y distribucin.</p><p>Afortunadamente podemos aplicar la magia de <code>@angular/elements</code> y utilidades como <code>ngx-build-plus</code> para compilarlo como un Web Component.</p><h3 id=\"Agregar-herramientas-de-ayuda\"><a href=\"#Agregar-herramientas-de-ayuda\" class=\"headerlink\" title=\"Agregar herramientas de ayuda\"></a>Agregar herramientas de ayuda</h3><p>Lo primero es instalar una herramienta que mejora el proceso de compilacin del CLI.</p><p><code>ng add ngx-build-plus --project external-currency</code></p><p>Esencialmente usa <em>webpack</em> para empaquetar el resultado de la compilacin <code>build</code> nativa del CLI. Pero no necesitas profundizar en su interior para usarla en el da da.</p><h3 id=\"Polyfills\"><a href=\"#Polyfills\" class=\"headerlink\" title=\"Polyfills\"></a>Polyfills</h3><p>Con el Internet Explorer hemos topado. Y otros navegadores antiguos, claro. El caso es que para que entiendan este nuevo estndar, tenemos que incluir una serie de arreglos llamados <em>polyfills</em>, que rellenan los huecos de incomprensin de los viejos exploradores. As que para garantizar la compatibilidad en todos los navegadores instalamos todo lo necesario usando <code>ngx-build-plus</code>.</p><p><code>ng g ngx-build-plus:wc-polyfill --project external-currency</code></p><p>Ojo que en algunas versiones se equivoca en la generacin de los <em>assets</em> y hay que moverlos a mano.</p><hr><h3 id=\"Compilacion\"><a href=\"#Compilacion\" class=\"headerlink\" title=\"Compilacin\"></a>Compilacin</h3><p>Ya solo falta lanzar el comando de compilacin <code>ng build</code>. Pero para ajustar un poco ms el resultado te propongo que deshabilites el nombrado con <em>hash</em> y por supuesto que uses algunos parmetros que ha incluido <code>ngx-build-plus</code>.</p><p>Nombres legibles: <code>&quot;outputHashing&quot;: &quot;none&quot;,</code></p><p>Generacin: <code>ng build --prod --single-bundle --project external-currency</code></p><h1 id=\"3-Consumo-en-HTML\"><a href=\"#3-Consumo-en-HTML\" class=\"headerlink\" title=\"3. Consumo en HTML\"></a>3. Consumo en HTML</h1><p>Ya est, el resultado se podr utilizar en cualquier aplicacin HTML. Por ejemplo en una pgina prcticamente vaca y completamente estndar.</p><p><code>apps\\vanilla\\index.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Vanilla Currency<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">base</span> <span class=\"attr\">href</span>=<span class=\"string\">\"/apps/vanilla/\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span></span></span><br><span class=\"line\"><span class=\"tag\">          <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"icon\"</span></span></span><br><span class=\"line\"><span class=\"tag\">          <span class=\"attr\">type</span>=<span class=\"string\">\"image/x-icon\"</span></span></span><br><span class=\"line\"><span class=\"tag\">          <span class=\"attr\">href</span>=<span class=\"string\">\"favicon.ico\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Convert money:<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">external-currency-converter</span> <span class=\"attr\">amount</span>=<span class=\"string\">\"15\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">external-currency-converter</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Que no funciona? Obvio, el navegador no entiende el <em>tag</em> <code>external-currency-converter</code>. Necesitamos el JavaScript de la compilacin anterior</p><h2 id=\"3-1-Copiar\"><a href=\"#3-1-Copiar\" class=\"headerlink\" title=\"3.1 Copiar\"></a>3.1 Copiar</h2><p>Copia los dos archivos generados en la carpeta de distribucin</p><p><code>dist\\apps\\external-currency</code></p><p>Y pgalos al lado del html que quieras. Por ejemplo:</p><p><code>apps\\vanilla\\</code></p><h2 id=\"3-2-Importar\"><a href=\"#3-2-Importar\" class=\"headerlink\" title=\"3.2 Importar\"></a>3.2 Importar</h2><p>Son dos porque hay versin clsica y modular. Importa la que necesites o ambas, y ya est.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"main-es2015.js\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"module\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"main-es5.js\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">nomodule</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">defer</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Una web HTML pura, mostrando un componente creado en Angular</p></blockquote><p>Ahora ya tienes cdigo creado en Angular pero que puedes integrar en cualquier web. Todo este proceso an puede resultar tedioso, pero es el futuro. Contina tu formacin avanzada para crear aplicaciones Angular fijndote en el <a href=\"https://github.com/angularbuilders/angular-blueprint/\" target=\"_blank\" rel=\"noopener\">Angular Blueprint</a> creado por la iniciativa <a href=\"https://angular.builders/\" target=\"_blank\" rel=\"noopener\">Angular.Builders</a> y vers como aprendes a programar grandes aplicaciones con Angular.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-19_elements.png\" alt=\"elementos-Angular-para-los-Web-Components\"></p><p>La industria web vive un momento de esplendor y le crecen los <em>frameworks</em> como hierbas primaverales. Pero el estndar HTML no se queda atrs y evoluciona hacia tecnologas potentes y genricas. <strong>Angular Elements</strong> promueve la reutilizacin de cdigo en distintos frameworks para que puedas usar tus componentes Angular en otros entornos.</p><p>Siendo como es Google una empresa <em>web first</em>, se esfuerzan en incorporar y adaptar de la mejor manera los estndares HTML a sus productos. Con el desarrollo de Angular siempre tuvieron la vista puesta en la tecnologa de los <strong>Web Components</strong>. Buscando que los usos futuros del cdigo se garantizasen ms all del framework de creacin.</p>","more":"<p>Partiendo del cdigo tal como qued en <a href=\"../internacionalizacion-y-puesta-en-produccion-con-Angular/\">Internacionalizacin y puesta en produccin</a>. Al finalizar tendrs unos componentes que podrs utilizar fuera de Angular.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-boss\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-boss</a></p></blockquote><h1 id=\"1-Componentes-independientes-del-framework\"><a href=\"#1-Componentes-independientes-del-framework\" class=\"headerlink\" title=\"1. Componentes independientes del framework\"></a>1. Componentes independientes del framework</h1><blockquote><p>Hay lcteos que aguantan ms que algunos frameworks.</p></blockquote><p>Seguramente este no sea el caso de Angular, ni de otros frameworks de adopcin masiva como React, Vue o Svelte. Todos ellos tienen un presente brillante y un futuro garantizado al plazo que la tecnologa pueda vislumbrar. Pero ms temprano que tarde otra tecnologa o paradigma disruptivo los desplazar. O al menos los obligar a cambiar tanto que sean irreconocibles.</p><p>Para entonces, y tambin mientras tanto, nuestro cdigo ser cautivo del framework en el que naci. Pero eso cambiar con los <strong>Web Components</strong>.</p><h2 id=\"1-1-Origen-y-potencial\"><a href=\"#1-1-Origen-y-potencial\" class=\"headerlink\" title=\"1.1 Origen y potencial\"></a>1.1 Origen y potencial</h2><p>Los <strong>Web Components</strong> son independientes de los <em>frameworks.</em> Esta es la idea clave; se pueden desarrollar con el estndar pelado de JavaScript o con cualquier framework moderno. Pero lo fundamental es que no exigen nada especial para ejecutarse. Esto permite la interoperabilidad y tambin extiende la vida til de tus creaciones.</p><h3 id=\"Usos-posibles\"><a href=\"#Usos-posibles\" class=\"headerlink\" title=\"Usos posibles\"></a>Usos posibles</h3><p>Partiendo de dichas premisas es fcil entrever todo el potencial y casos dnde aplicarlos. Por ejemplo:</p><ul><li><p>Libreras de diseo <em>multiplataforma</em>.</p></li><li><p>Migracin paulatina de aplicaciones <em>legacy</em>.</p></li><li><p>Integracin dinmica en grandes soluciones <em>CMS</em>.</p></li><li><p>Mejoras funcionales en aplicaciones <em>server side</em>.</p></li></ul><h2 id=\"1-2-Estandares-y-tecnologia\"><a href=\"#1-2-Estandares-y-tecnologia\" class=\"headerlink\" title=\"1.2 Estndares y tecnologa\"></a>1.2 Estndares y tecnologa</h2><p>Bajo el trmino Web Components se esconden diversas tecnologas. No todas ellas estn al mismo nivel de aceptacin, e incluso alguna no ha visto la luz, pero este es un esbozo de lo que tenemos:</p><ul><li><strong>Shadow DOM:</strong> Manipulacin de un rbol en memoria antes de aplicar sus cambios al verdadero.</li><li><strong>HTML templates:</strong> Fragmentos de HTML que no se utilizan en la carga de la pgina, pero que se pueden instanciar ms adelante.</li><li><strong>ES Modules:</strong> Inclusin de documentos JS en forma de mdulos de manera estndar y gil.</li><li><strong>Custom elements:</strong> son etiquetas HTML con funciones encapsuladas, reutilizables y listas para usar en pginas y aplicaciones web.</li></ul><p>El estndar:</p><blockquote><p>Los <strong>Custom Web Elements</strong> slo requieren <em>HTML y JavaScript</em>.</p></blockquote><p>La tecnologa:</p><blockquote><p><em>Angular Elements</em> empaqueta tus componentes como <strong>Custom Web Elements</strong>.</p></blockquote><h1 id=\"2-Desarrollo-y-despliegue-con-Angular\"><a href=\"#2-Desarrollo-y-despliegue-con-Angular\" class=\"headerlink\" title=\"2. Desarrollo y despliegue con Angular\"></a>2. Desarrollo y despliegue con Angular</h1><h3 id=\"Un-componente-comun-de-Angular\"><a href=\"#Un-componente-comun-de-Angular\" class=\"headerlink\" title=\"Un componente comn de Angular\"></a>Un componente comn de Angular</h3><p>Partimos de un componente Angular normal y corriente. Un conversor (s, ya s que es slo un miserable multiplicador) de monedas.</p><p><code>libs\\currency\\src\\lib\\converter\\converter.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Amount to convert: <span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"amount\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"amount\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         (<span class=\"attr\">change</span>)=<span class=\"string\">\"convert()\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Converted amount: <span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"convertedAmount\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"convertedAmount\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">readonly</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>libs\\currency\\src\\lib\\converter\\converter.component.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'angular-boss-converter'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./converter.component.html'</span>,</span><br><span class=\"line\">  styleUrls: [<span class=\"string\">'./converter.component.css'</span>]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ConverterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() factor = <span class=\"number\">1.1</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() amount = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Output</span>() converted = <span class=\"keyword\">new</span> EventEmitter&lt;<span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\">  convertedAmount = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convert();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  convert() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convertedAmount = <span class=\"keyword\">this</span>.amount * <span class=\"keyword\">this</span>.factor;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.converted.next(<span class=\"keyword\">this</span>.convertedAmount);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h3 id=\"El-componente-sigue-siendo-Angular\"><a href=\"#El-componente-sigue-siendo-Angular\" class=\"headerlink\" title=\"El componente sigue siendo Angular\"></a>El componente sigue siendo Angular</h3><p>Es tan normal y corriente que puedo importar su mdulo y usarlo en cualquier aplicacin Angular.</p><p><code>apps\\warehouse\\src\\app\\app.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; CurrencyModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular-boss/currency'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CurrencyModule</span><br><span class=\"line\">  ],</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p><code>apps\\warehouse\\src\\app\\app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">angular-boss-converter</span> <span class=\"attr\">amount</span>=<span class=\"string\">\"100\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                        <span class=\"attr\">factor</span>=<span class=\"string\">\"1.5\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">angular-boss-converter</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"2-1-Exponer-los-componentes\"><a href=\"#2-1-Exponer-los-componentes\" class=\"headerlink\" title=\"2.1 Exponer los componentes\"></a>2.1 Exponer los componentes</h2><p>Pero ahora todo va a cambiar. Necesitamos un proyecto de exportacin. Nada especial. Yo le pongo aqu el prefijo external para hacer hincapi en su funcin de exportacin.</p><p><code>ng g @nrwl/angular:application external-currency</code></p><p>Si el componente a exportar ya ha sido probado, y debera, en este proyecto no necesitamos nada ms que el mdulo. As que puedes borrar tranquilamente el <code>AppComponent</code>, e incluso el <code>index.html</code>.</p><p>Pongmonos con la exportacin, para la cual hacen falta herramientas. Pues adelante con ellas. Incorporamos <strong>Angular Elements</strong>.</p><p><code>ng add @angular/elements</code></p><p>Ahora ya importamos el componente en el <em>array</em> <code>imports</code> y lo exportamos, pero no en <code>exports</code> ni tampoco en <code>bootstrap</code>. Vamos a incluirlo en <code>entryComponents</code>.</p><p><code>apps\\external-currency\\src\\app\\app.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; ConverterComponent, CurrencyModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular-boss/currency'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Injector, NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; createCustomElement &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/elements'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; BrowserModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'zone.js'</span>;</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [BrowserModule, CurrencyModule],</span><br><span class=\"line\">  entryComponents: [ConverterComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> injector: Injector</span>) &#123;&#125;</span><br><span class=\"line\">  ngDoBootstrap() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> el = createCustomElement(ConverterComponent, &#123;</span><br><span class=\"line\">      injector: <span class=\"keyword\">this</span>.injector</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    customElements.define(<span class=\"string\">'external-currency-converter'</span>, el);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Los <code>entryComponents</code> son cargados por Angular de forma imperativa, sin necesidad de incluirlos en un <em>html</em>. Menos mal porque este proyecto ni siquiera usa el <code>index.hml</code></p><h3 id=\"ngDoBootstrap\"><a href=\"#ngDoBootstrap\" class=\"headerlink\" title=\"ngDoBootstrap\"></a>ngDoBootstrap</h3><p>Justamente la falta de componentes en el array <code>bootstrap</code> obliga a arrancar la aplicacin mediante cdigo. Esto lo hacemos programando en el <em>hook</em> <code>ngDoBootstrap()</code>, un mtodo que ser invocado al inicio y en el meteremos la lgica necesaria para definir el <strong>Web Component</strong>.</p><p>Son solamente dos instrucciones que usars para cada componente que quieras transformar en un elemento.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> el = createCustomElement(ConverterComponent, &#123;</span><br><span class=\"line\">  injector: <span class=\"keyword\">this</span>.injector</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">customElements.define(<span class=\"string\">'external-currency-converter'</span>, el);</span><br></pre></td></tr></table></figure><p>En la primera se crea el elemento mediante una funcin constructora que ofrece <code>@angular/elements</code>. Para ello necesita un puntero al componente original y el sistema de inyeccin de dependencias de Angular. (El cual a su vez reclamamos en el constructor del mdulo).</p><p>La segunda instruccin ya no es propia de Angular. Simplemente se le asigna al elemento recin creado el <em>selector tag</em> por el que ser conocido.</p><blockquote><p>Atencin a la importacin de <code>zone.js</code>.</p></blockquote><p>Es necesaria para poder usar la deteccin de cambios en aplicaciones no Angular.</p><h2 id=\"2-2-Compilacion-y-despliegue\"><a href=\"#2-2-Compilacion-y-despliegue\" class=\"headerlink\" title=\"2.2 Compilacin y despliegue\"></a>2.2 Compilacin y despliegue</h2><p>A partir de aqu se acab el trabajo de programacin. Y toca el ms tedioso de operaciones de compilacin y distribucin.</p><p>Afortunadamente podemos aplicar la magia de <code>@angular/elements</code> y utilidades como <code>ngx-build-plus</code> para compilarlo como un Web Component.</p><h3 id=\"Agregar-herramientas-de-ayuda\"><a href=\"#Agregar-herramientas-de-ayuda\" class=\"headerlink\" title=\"Agregar herramientas de ayuda\"></a>Agregar herramientas de ayuda</h3><p>Lo primero es instalar una herramienta que mejora el proceso de compilacin del CLI.</p><p><code>ng add ngx-build-plus --project external-currency</code></p><p>Esencialmente usa <em>webpack</em> para empaquetar el resultado de la compilacin <code>build</code> nativa del CLI. Pero no necesitas profundizar en su interior para usarla en el da da.</p><h3 id=\"Polyfills\"><a href=\"#Polyfills\" class=\"headerlink\" title=\"Polyfills\"></a>Polyfills</h3><p>Con el Internet Explorer hemos topado. Y otros navegadores antiguos, claro. El caso es que para que entiendan este nuevo estndar, tenemos que incluir una serie de arreglos llamados <em>polyfills</em>, que rellenan los huecos de incomprensin de los viejos exploradores. As que para garantizar la compatibilidad en todos los navegadores instalamos todo lo necesario usando <code>ngx-build-plus</code>.</p><p><code>ng g ngx-build-plus:wc-polyfill --project external-currency</code></p><p>Ojo que en algunas versiones se equivoca en la generacin de los <em>assets</em> y hay que moverlos a mano.</p><hr><h3 id=\"Compilacion\"><a href=\"#Compilacion\" class=\"headerlink\" title=\"Compilacin\"></a>Compilacin</h3><p>Ya solo falta lanzar el comando de compilacin <code>ng build</code>. Pero para ajustar un poco ms el resultado te propongo que deshabilites el nombrado con <em>hash</em> y por supuesto que uses algunos parmetros que ha incluido <code>ngx-build-plus</code>.</p><p>Nombres legibles: <code>&quot;outputHashing&quot;: &quot;none&quot;,</code></p><p>Generacin: <code>ng build --prod --single-bundle --project external-currency</code></p><h1 id=\"3-Consumo-en-HTML\"><a href=\"#3-Consumo-en-HTML\" class=\"headerlink\" title=\"3. Consumo en HTML\"></a>3. Consumo en HTML</h1><p>Ya est, el resultado se podr utilizar en cualquier aplicacin HTML. Por ejemplo en una pgina prcticamente vaca y completamente estndar.</p><p><code>apps\\vanilla\\index.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Vanilla Currency<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">base</span> <span class=\"attr\">href</span>=<span class=\"string\">\"/apps/vanilla/\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span></span></span><br><span class=\"line\"><span class=\"tag\">          <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"icon\"</span></span></span><br><span class=\"line\"><span class=\"tag\">          <span class=\"attr\">type</span>=<span class=\"string\">\"image/x-icon\"</span></span></span><br><span class=\"line\"><span class=\"tag\">          <span class=\"attr\">href</span>=<span class=\"string\">\"favicon.ico\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Convert money:<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">external-currency-converter</span> <span class=\"attr\">amount</span>=<span class=\"string\">\"15\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">external-currency-converter</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Que no funciona? Obvio, el navegador no entiende el <em>tag</em> <code>external-currency-converter</code>. Necesitamos el JavaScript de la compilacin anterior</p><h2 id=\"3-1-Copiar\"><a href=\"#3-1-Copiar\" class=\"headerlink\" title=\"3.1 Copiar\"></a>3.1 Copiar</h2><p>Copia los dos archivos generados en la carpeta de distribucin</p><p><code>dist\\apps\\external-currency</code></p><p>Y pgalos al lado del html que quieras. Por ejemplo:</p><p><code>apps\\vanilla\\</code></p><h2 id=\"3-2-Importar\"><a href=\"#3-2-Importar\" class=\"headerlink\" title=\"3.2 Importar\"></a>3.2 Importar</h2><p>Son dos porque hay versin clsica y modular. Importa la que necesites o ambas, y ya est.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"main-es2015.js\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"module\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"main-es5.js\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">nomodule</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">defer</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Una web HTML pura, mostrando un componente creado en Angular</p></blockquote><p>Ahora ya tienes cdigo creado en Angular pero que puedes integrar en cualquier web. Todo este proceso an puede resultar tedioso, pero es el futuro. Contina tu formacin avanzada para crear aplicaciones Angular fijndote en el <a href=\"https://github.com/angularbuilders/angular-blueprint/\" target=\"_blank\" rel=\"noopener\">Angular Blueprint</a> creado por la iniciativa <a href=\"https://angular.builders/\" target=\"_blank\" rel=\"noopener\">Angular.Builders</a> y vers como aprendes a programar grandes aplicaciones con Angular.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Formularios, tablas y modelos de datos en Angular","date":"2020-04-15T13:17:37.000Z","thumbnail":"/css/images/angular-3_data.png","_content":"\n![formularios-tablas-y-modelos-de-datos-en-angular](/images/tutorial-angular-3_data.png)\n\nLas **aplicaciones Angular 9 son excelentes para el tratamiento de datos** en el navegador. Su razn de ser fue la recogida de informacin mediante formularios y la presentacin de pginas dinmicas de forma sencilla.\n\nVamos a ver cmo la librera `@angular/forms` enlaza **las vistas, los controladores y los modelos**; y cmo se hace la presentacin de datos en **listas y tablas**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/), al finalizar tendrs una aplicacin que recoge y presenta datos.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Binding\n\n## 1.0 Base\n\n**Los formularios son el punto de entrada** de informacin a nuestros sistemas. Llevan con nosotros desde el inicio de la propia informtica y se han comido una buena parte del tiempo de programacin. En _Angular_ han prestado una especial atencin a ellos facilitando su desarrollo, **desde pantallas simples hasta complejos procesos**.\n\nVamos con simple ejemplo para recopilar informacin de contactos personales. Creamos una nueva ruta funcional para la gestin de contactos. Requiere ruta, enlace, mdulo y componente.\n\n```bash\nng g m contacts --route contacts --module app-routing.module\n```\n\nComo ya sabemos, adems de la creacin del mdulo y el componente, esto altera los ficheros de enrutado. As tenemos lo siguiente en `app-routing` y en `contacts-routing`:\n\n```typescript\n  // app-routing\n  {\n    path: 'contacts',\n    loadChildren: () => import('./contacts/contacts.module').then(m => m.ContactsModule)\n  },\n  // contacts-routing\n  {\n    path: '',\n    component: ContactsComponent\n  }\n```\nHay que aadir una entrada en el `SideComponent` y ya tenemos listo el armazn para continuar.\n\n```html\n<li><a routerLink=\"contacts\">Forms</a></li>\n```\n\n## 1.1 Directivas\n\nAntes de pedir informacin, vamos a prepara el terreno. Necesitamos algunos textos para instruir al usuario y, sobre todo, un lugar en dnde recoger lo que nos escriba. Para ello atacaremos a la clase controladora del nuevo componente.\n\n> Para empezar agregamos algunas propiedades. En `contacts.component.ts`:\n\n```typescript\nheader = 'Contacts';\ndescription = 'Manage your contact list';\nnumberOfContacts = 0;\ncounterStyleColor = 'green';\ncounterClass = 'warning';\nformHidden = false;\n```\n\n### 1.1.1 Enlace del modelo hacia la vista\n\nEstas propiedades pblicas son visibles desde la vista HTML. As, en `contacts.component.html` mostramos cabeceras con estilo como este.\n\n```html\n<h3>\n  {{ header }}: {{ description | uppercase }}\n</h3>\n<p [style.color]=\"counterStyleColor\">You have <mark\n        class=\"{{ counterClass }}\">{{ numberOfContacts }}</mark>\n  contacts right now.</p>\n```\n\nEste cdigo HTML es bsicamente estndar, pero est reforzado con algunos smbolos que pueden resultar extraos. Son **las directivas de Angular**. Se trata de atributos fuente que una vez compilados generan funcionalidad extra.\n\nLa manera ms directa de hacerlo es representar en la vista algn dato del modelo. Y eso se hace con las expresiones de interpolacin entre llaves. `{{ expression }}` Suelen usarse para aportar contenido a elementos html, aunque tambin a cualquier atributo.\n\nA la hora de pintar datos, a veces querremos transformarlos antes. Para eso emplearemos **los pipes de Angular**. Son funciones que adjuntaremos a las expresiones usando el carcter especial `|` llamado _pipe_. La entrada de la funcin es lo que hay a la izquierda de la tubera. La salida de la funcin es lo que se muestra.\n\nEn Angular disponemos de suficientes pipes estndar para cubrir los casos bsicos de presentacin de textos, fechas, monedas y dems.\n\nTambin tenemos formas de asignar contenido dinmico a los atributos. Basta con envolvernos entre corchetes y su valor se calcula como una expresin. Como norma general sera algo as: `[atribute]=\"expresion\"`\n\n### 1.1.2 Enlace de la vista hacia el modelo\n\nToca ahora darle la opcin al usuario de actuar sobre los datos desde la vista. Por ejemplo en `contacts.component.html` hemos creado un par de botones cuya intencin es mostrar u ocultar un formulario sobre el que trabajaremos ms adelante.\n\n```html\n<input\n  value=\"Show Form\"\n  class=\"primary\"\n  type=\"button\"\n  (click)=\"formHidden=false\"\n/>\n<input\n  value=\"Hide Form\"\n  class=\"inverse\"\n  type=\"button\"\n  (click)=\"formHidden=true\"\n/>\n<form [ngClass]=\"{'hidden':formHidden}\">\n  <fieldset>\n    <legend>Contact Form</legend>\n  </fieldset>\n</form>\n```\n\nPara ello usaremos los eventos estndar del HTML, como el _click_ de los _input_. Pero, de nuevo, usaremos smbolos propios de Angular como los parntesis `(eventName)`. En esta ocasin lo que asignaremos ser un instruccin, que ser ejecutada cuando el evento se dispare.\n\nPara ver el efecto completo, echamos mano de otra directiva propia de Angular: la `ngClass`. Esta nos sirve para aplicar estilos CSS conducidos por los datos. Se aplican o no en funcin de que se cumplan ciertas condiciones dinmicamente. En este caso el estilo _hidden_.\n\n# 2. Doble Binding\n\nHemos visto lo fcil que es mostrar datos en una pantalla. Y tampoco resulta complejo responder a eventos del usuario. Digamos que tenemos mecanismos para realizar el enlace, _binding_ en el argot de Angular, entre la vista y el modelo.\n\nLa idea es juntar ambos mecanismos en algo que permita enlazar vista y modelo en ambos sentidos. De esta forma podremos mantener sincronizados lo que el usuario ve y lo que realmente se est procesando.\n\n## 2.1 NgModel\n\nLa directiva _ngModel_ viene en un mdulo del framework llamado `FormsModule`. Hay que importarlo para poder usar su contenido, tal como hemos hecho en `contacts.module.ts`\n\n```typescript\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { ContactsRoutingModule } from './contacts-routing.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ContactsRoutingModule,\n    FormsModule\n  ]\n})\nexport class ContactsModule { }\n```\n\nA partir de ese momento podemos invocar sus directivas, yb vamos a empezar por la ms utilizada y famosa: `ngModel`.\n\n\n### Banana in a box [()]\n\nPero ojo, esta potente directiva no se jea utilizar as como as. Hay que enjaularla convenientemente entre una doble barrera de corchetes y parntesis `[()]`. Para recordarlo se puso de moda la frase _Banana in a box_ que hace referencia al _parntesis dentro del corchete_\n\n```html\n<input [(ngModel)]=\"model.property\"/>\n```\n\nUsa la comunicacin en ambos sentidos\n\n- **(banana)** : de la vista al modelo\n- **[box]** : del modelo a la vista\n\n#### Modelo\n\n> La directiva se asocia con una propiedad del controlador...\n> o mejor an, con una **propiedad del modelo** del controlador\n\nPor ejemplo podemos crear un objeto literal para representar a un contacto y trabajar sobre l\n\n```typescript\npublic contact = { name: '' };\n```\n\n#### Directiva\n\nY enlazarlo con la vista para que siempre estn sincronizados.\n\n```html\n<section>\n  <label for=\"name\">Name</label>\n  <input\n    name=\"name\"\n    type=\"text\"\n    [(ngModel)]=\"contact.name\"\n    placeholder=\"Contact name\"\n  />\n</section>\n```\n\n#### Espa\n\nMientras desarrollas, es frecuente que quieras visualizar el valor de cualquier propiedad en tiempo de ejecucin. Algo as como un `console.log()` en la pantalla.\n\n```html\n<pre>{{ contact | json }}</pre>\n```\n\nEl anterior elemento se un espa perfecto de la actividad del usuario sobre el formulario. Una cosa ms, acurdate de quitarlo antes de enviar a produccin.\n\n## 2.2 Form\n\nLa tcnica bsica de enlazar _inputs_ con propiedades puedes extenderla cuanto quieras. Pero pronto echars en falta los _check boxes, radio buttons_ y dems. Hay ms usos de las directivas en los formularios.\n\nVamos a ver cmo usarlos para actuar sobre el siguiente modelo:\n\n```typescript\npublic contact = { name: '', isVIP: false, gender: '' };\n```\n\n### 2.2.1 CheckBox\n\nQuiz nos venga bien un _checkbox_ para saber si es o no un VIP.\n\n```html\n<section>\n  <label for=\"isVIP\">Is V.I.P.</label>\n  <input name=\"isVIP\" type=\"checkbox\" [(ngModel)]=\"contact.isVIP\" />\n</section>\n```\n\n### 2.2.2 Radio Buttons\n\nY un par de _radio buttons_ para el gnero.\n\n```html\n<section>\n  <label for=\"gender\">Gender</label>\n  <input name=\"gender\" value=\"m\" type=\"radio\" [(ngModel)]=\"contact.gender\" />\n  <i>Male</i>\n  <input name=\"gender\" value=\"f\" type=\"radio\" [(ngModel)]=\"contact.gender\" />\n  <i>Female</i>\n</section>\n```\n\n# 3. Estructuras\n\nMantn siempre en mete que el HTML que escribes es cdigo fuente. No es, an, el HTML que renderizar el navegador. Es casi casi un lenguaje de programacin per se. Con sus expresiones, instrucciones y estructuras.\n\n## 3.1 \\*ngFor\n\nVamos a empezar por las **estructuras repetitivas** presentando la Directiva estructural `*ngFor`.\n\nAvanzamos con el modelo al que agregamos posibles estados laborales de nuestros contactos:\n\n```typescript\npublic workStatuses = [\n  { id: 0, description: 'unknow' },\n  { id: 1, description: 'student' },\n  { id: 2, description: 'unemployed' },\n  { id: 3, description: 'employed' }\n];\npublic contact = { name: '', isVIP: false, gender: '', workStatus: 0 };\n```\n\n> \\*ngFor\n\n```html\n<section>\n  <label for=\"workStatus\">Work Status</label>\n  <select name=\"workStatus\" [(ngModel)]=\"contact.workStatus\">\n    <option *ngFor=\"let status of workStatuses\" [value]=\"status.id\">\n      <span>{{ status.description }}</span>\n    </option>\n  </select>\n</section>\n```\n\nEs un bucle de toda la vida vamos. Pero en em medio del HTML. Lo que hace es dar vueltas sobre un array y agregar un nodo HTML para cada elemento del array.\n\n> let **iterador** of **iterable**\n\n## 3.2 \\*ngIf\n\nY ahora le toca a las **estructuras condicionales** y para ello tenemos la directiva estructural `*ngIf`\n\nVamos un paso ms en el modelo y supongamos que queremos preguntar por la empresa actual si nuestro contacto est trabajando, y en caso contrario preguntarle por sus estudios.\n\n```typescript\npublic contact = {\n  name: '',\n  isVIP: false,\n  gender: '',\n  workStatus: '0',\n  company: '',\n  education: ''\n};\n```\n\n---\n\n> \\*ngIf\n\n```html\n<section *ngIf=\"contact.workStatus=='3'; else education\">\n  <label for=\"company\">Company Name</label>\n  <input name=\"company\" type=\"text\" [(ngModel)]=\"contact.company\" />\n</section>\n<ng-template #education>\n  <section>\n    <label for=\"education\">Education</label>\n    <input name=\"education\"\n            type=\"text\"\n            [(ngModel)]=\"contact.education\"\n            placeholder=\"Education\" />\n  </section>\n</ng-template>\n```\n\nVemos incrustado en HTML el tpico _if else_ de la programacin estructurada. Quiz llame la atencin la manera de tratar el _else_. Por ahora digamos que aquellos nodos del rbol que no tienen garantizada su existencia deben recogerse dentro de un elemento propio del Angular, las `ng-template`.\n\nOtra directiva smbolo que merece la pena mencionar es el `#`. Acta como un identificador que una vez aplicado a un elemento se puede usar para acceder a el desde cualquier parte del componente.\n\nEn resumen:\n\n> if **condition** else **template**\n\n> > tambin hay _\\*ngSwitch_\n\n---\n\n# 4. Modelo y controlador\n\nEste punto nu es de Angular propiamente, pero s del lenguaje que han escogido para que desarrollemos nuestras apps: el **TypeScript**.\n\nEs como un cruce entre _JavaScript_ y _Java_ o _C#_. Digamos que le aporta tipos estticos y mejoras en cuanto expresividad si queremos usar clases o una programacin ms orientada a objetos. Es un lenguaje de ayuda al programador. Realmente puedes usar sintaxis pura de JavaScript, porque el typeScript es JavaScript con anotaciones de opcionales de tipos.\n\nAngular viene ya con las herramientas y configuraciones necesarias para _transpilar_ el TypeScript a JavaScript.\n\n## 4.1 Interfaces y modelos\n\n> Mejor interface que clase\n\nSe aconseja por una buena razn. Las interfaces en JavaScript no existen. As, mientras desarrollamos nos ayuda con _intellisense_ y noes protegen de asignaciones indebidas. Pero, en ejecucin no pesan porque no tienen contrapartida.\n\n```typescript\nexport interface Option {\n  id: number;\n  description: string;\n}\n\nexport interface Contact {\n  name: string;\n  isVIP: boolean;\n  gender: string;\n  workStatus: number | string;\n  company: string;\n  education: string;\n}\n```\n\n> tipos compuestos `number | string`\n\nEste es un lenguaje que realmente slo aplica mientras desarrollas. As que permite hacer diabluras con los tipos.\n\nSe usan para tipificar las propiedades\n\n```typescript\npublic workStatuses: Option[] = [\n    { id: 0, description: 'unknow' },\n    { id: 1, description: 'student' },\n    { id: 2, description: 'unemployed' },\n    { id: 3, description: 'employed' }\n  ];\npublic contact: Contact = {\n    name: '',\n    isVIP: false,\n    gender: '',\n    workStatus: 0,\n    company: '',\n    education: ''\n  };\npublic contacts: Contact[] = [];\n```\n\n## 4.2 ViewModel en el controlador\n\nEl controlador del componente es una clase. Por tanto tiene no solo propiedades, sino tambin mtodos.\n\n```typescript\nsaveContact() {\n  this.contacts.push({ ...this.contact });\n  this.updateCounter();\n}\n\nprivate updateCounter() {\n  this.numberOfContacts = this.contacts.length;\n  this.counterClass = this.numberOfContacts === 0 ? 'warning' : 'success';\n}\n```\n\nLos mtodos pblicos pueden, y deben, ser invocados desde las vistas. De forma que las expresiones asignadas a los eventos sean simples llamadas a mtodos para que hagan el trabajo sucio.\n\n```html\n<input value=\"Save\" type=\"submit\" (click)=\"saveContact()\" />\n```\n\n### OnInit\n\nYa hemos visto que en TypeScript, las clases puede implementar interfaces. Angular nos facilita unos cuantos para usar como _hooks_ en determinados momentos dl ciclo de vida de una componente.\n\nEn particular hay uno que ya vienen pre implementado por el generador del CLI. Se llama `OnInit` y obliga a disponer de un mtodo pblico llamado `ngOnInit()`. Lo que programes dentro ser ejecutado durante la inicializacin del componente.\n\nEs una prctica recomendable usar ese mtodo en lugar del constructor para desplegar nuestra lgica de inicio. La razn es que el constructor se ejecuta antes de la existencia completa de la vista y eso puede generar inconsistencias.\n\n```typescript\npublic workStatuses: Option[];\npublic contact: Contact;\npublic contacts: Contact[];\nconstructor() {}\npublic ngOnInit() {\n  this.workStatuses = [\n    { id: 0, description: 'unknow' },\n    { id: 1, description: 'student' },\n    { id: 2, description: 'unemployed' },\n    { id: 3, description: 'employed' }\n  ];\n  this.contact = {\n    name: '',\n    isVIP: false,\n    gender: '',\n    workStatus: 0,\n    company: '',\n    education: ''\n  };\n  this.contacts = [];\n}\n```\n\n### Repasamos\n\nAgregamos una funcionalidad que nos obliga a repasar todo lo aprendido. Un listado en el que mostrar los contactos que se recogen del formulario.\n\n```html\n<ul *ngIf=\"contacts.length>0; else empty\">\n  <li *ngFor=\"let contact of contacts\">\n    <span>{{ contact.name }}</span>\n    <input value=\"Delete\" type=\"button\" (click)=\"deleteContact(contact)\" />\n  </li>\n</ul>\n<ng-template #empty> <i>No contacts yet</i> </ng-template>\n```\n\n```typescript\ndeleteContact(contact: Contact) {\n  this.contacts = this.contacts.filter(c => c.name !== contact.name);\n  this.updateCounter();\n}\n```\n\nMira el cdigo completo de **la clase** `ContactsComponent`en el fichero `contacts.component.ts` para tener una visin completa del componente. Como ves, **las propiedades** `header, numberOfContacts, formHidden, contacts ...` se corresponden con las utilizadas en las directivas de enlace en la vista. Mientras que **los mtodos** `saveContact(), deleteContact()` son invocados desde eventos de elementos del _html_.\n\nJuntos, **la vista y su clase controladora**, resuelven un problema de interaccin con el usuario **creando un componente**. Todas las pginas que disees sern variaciones y composiciones de estos componentes.\n\n> Y esto es slo el comienzo. La idea de componente ser fundamental en la web del maana para la creacin de pginas mediante `web components`. Pero eso ya se ver ms adelante...\n\nAhora tienes una aplicacin en _Angular 9_ que recoge y muestra datos. Sigue esta serie para aadirle [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/) mientras aprendes a programar con Angular8. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-3-Formularios-tablas-y-modelos-de-datos-en-Angular.md","raw":"---\ntitle: Formularios, tablas y modelos de datos en Angular\npermalink: formularios-tablas-y-modelos-de-datos-en-angular\ndate: 2020-04-15 15:17:37\ntags:\n  - Angular\n  - Forms\n  - Tutorial\n  - Introduccin\n  - Angular9\n  - Angular2\ncategories:\n  - [Tutorial, Angular]\nthumbnail: /css/images/angular-3_data.png\n---\n\n![formularios-tablas-y-modelos-de-datos-en-angular](/images/tutorial-angular-3_data.png)\n\nLas **aplicaciones Angular 9 son excelentes para el tratamiento de datos** en el navegador. Su razn de ser fue la recogida de informacin mediante formularios y la presentacin de pginas dinmicas de forma sencilla.\n\nVamos a ver cmo la librera `@angular/forms` enlaza **las vistas, los controladores y los modelos**; y cmo se hace la presentacin de datos en **listas y tablas**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/), al finalizar tendrs una aplicacin que recoge y presenta datos.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Binding\n\n## 1.0 Base\n\n**Los formularios son el punto de entrada** de informacin a nuestros sistemas. Llevan con nosotros desde el inicio de la propia informtica y se han comido una buena parte del tiempo de programacin. En _Angular_ han prestado una especial atencin a ellos facilitando su desarrollo, **desde pantallas simples hasta complejos procesos**.\n\nVamos con simple ejemplo para recopilar informacin de contactos personales. Creamos una nueva ruta funcional para la gestin de contactos. Requiere ruta, enlace, mdulo y componente.\n\n```bash\nng g m contacts --route contacts --module app-routing.module\n```\n\nComo ya sabemos, adems de la creacin del mdulo y el componente, esto altera los ficheros de enrutado. As tenemos lo siguiente en `app-routing` y en `contacts-routing`:\n\n```typescript\n  // app-routing\n  {\n    path: 'contacts',\n    loadChildren: () => import('./contacts/contacts.module').then(m => m.ContactsModule)\n  },\n  // contacts-routing\n  {\n    path: '',\n    component: ContactsComponent\n  }\n```\nHay que aadir una entrada en el `SideComponent` y ya tenemos listo el armazn para continuar.\n\n```html\n<li><a routerLink=\"contacts\">Forms</a></li>\n```\n\n## 1.1 Directivas\n\nAntes de pedir informacin, vamos a prepara el terreno. Necesitamos algunos textos para instruir al usuario y, sobre todo, un lugar en dnde recoger lo que nos escriba. Para ello atacaremos a la clase controladora del nuevo componente.\n\n> Para empezar agregamos algunas propiedades. En `contacts.component.ts`:\n\n```typescript\nheader = 'Contacts';\ndescription = 'Manage your contact list';\nnumberOfContacts = 0;\ncounterStyleColor = 'green';\ncounterClass = 'warning';\nformHidden = false;\n```\n\n### 1.1.1 Enlace del modelo hacia la vista\n\nEstas propiedades pblicas son visibles desde la vista HTML. As, en `contacts.component.html` mostramos cabeceras con estilo como este.\n\n```html\n<h3>\n  {{ header }}: {{ description | uppercase }}\n</h3>\n<p [style.color]=\"counterStyleColor\">You have <mark\n        class=\"{{ counterClass }}\">{{ numberOfContacts }}</mark>\n  contacts right now.</p>\n```\n\nEste cdigo HTML es bsicamente estndar, pero est reforzado con algunos smbolos que pueden resultar extraos. Son **las directivas de Angular**. Se trata de atributos fuente que una vez compilados generan funcionalidad extra.\n\nLa manera ms directa de hacerlo es representar en la vista algn dato del modelo. Y eso se hace con las expresiones de interpolacin entre llaves. `{{ expression }}` Suelen usarse para aportar contenido a elementos html, aunque tambin a cualquier atributo.\n\nA la hora de pintar datos, a veces querremos transformarlos antes. Para eso emplearemos **los pipes de Angular**. Son funciones que adjuntaremos a las expresiones usando el carcter especial `|` llamado _pipe_. La entrada de la funcin es lo que hay a la izquierda de la tubera. La salida de la funcin es lo que se muestra.\n\nEn Angular disponemos de suficientes pipes estndar para cubrir los casos bsicos de presentacin de textos, fechas, monedas y dems.\n\nTambin tenemos formas de asignar contenido dinmico a los atributos. Basta con envolvernos entre corchetes y su valor se calcula como una expresin. Como norma general sera algo as: `[atribute]=\"expresion\"`\n\n### 1.1.2 Enlace de la vista hacia el modelo\n\nToca ahora darle la opcin al usuario de actuar sobre los datos desde la vista. Por ejemplo en `contacts.component.html` hemos creado un par de botones cuya intencin es mostrar u ocultar un formulario sobre el que trabajaremos ms adelante.\n\n```html\n<input\n  value=\"Show Form\"\n  class=\"primary\"\n  type=\"button\"\n  (click)=\"formHidden=false\"\n/>\n<input\n  value=\"Hide Form\"\n  class=\"inverse\"\n  type=\"button\"\n  (click)=\"formHidden=true\"\n/>\n<form [ngClass]=\"{'hidden':formHidden}\">\n  <fieldset>\n    <legend>Contact Form</legend>\n  </fieldset>\n</form>\n```\n\nPara ello usaremos los eventos estndar del HTML, como el _click_ de los _input_. Pero, de nuevo, usaremos smbolos propios de Angular como los parntesis `(eventName)`. En esta ocasin lo que asignaremos ser un instruccin, que ser ejecutada cuando el evento se dispare.\n\nPara ver el efecto completo, echamos mano de otra directiva propia de Angular: la `ngClass`. Esta nos sirve para aplicar estilos CSS conducidos por los datos. Se aplican o no en funcin de que se cumplan ciertas condiciones dinmicamente. En este caso el estilo _hidden_.\n\n# 2. Doble Binding\n\nHemos visto lo fcil que es mostrar datos en una pantalla. Y tampoco resulta complejo responder a eventos del usuario. Digamos que tenemos mecanismos para realizar el enlace, _binding_ en el argot de Angular, entre la vista y el modelo.\n\nLa idea es juntar ambos mecanismos en algo que permita enlazar vista y modelo en ambos sentidos. De esta forma podremos mantener sincronizados lo que el usuario ve y lo que realmente se est procesando.\n\n## 2.1 NgModel\n\nLa directiva _ngModel_ viene en un mdulo del framework llamado `FormsModule`. Hay que importarlo para poder usar su contenido, tal como hemos hecho en `contacts.module.ts`\n\n```typescript\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { ContactsRoutingModule } from './contacts-routing.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ContactsRoutingModule,\n    FormsModule\n  ]\n})\nexport class ContactsModule { }\n```\n\nA partir de ese momento podemos invocar sus directivas, yb vamos a empezar por la ms utilizada y famosa: `ngModel`.\n\n\n### Banana in a box [()]\n\nPero ojo, esta potente directiva no se jea utilizar as como as. Hay que enjaularla convenientemente entre una doble barrera de corchetes y parntesis `[()]`. Para recordarlo se puso de moda la frase _Banana in a box_ que hace referencia al _parntesis dentro del corchete_\n\n```html\n<input [(ngModel)]=\"model.property\"/>\n```\n\nUsa la comunicacin en ambos sentidos\n\n- **(banana)** : de la vista al modelo\n- **[box]** : del modelo a la vista\n\n#### Modelo\n\n> La directiva se asocia con una propiedad del controlador...\n> o mejor an, con una **propiedad del modelo** del controlador\n\nPor ejemplo podemos crear un objeto literal para representar a un contacto y trabajar sobre l\n\n```typescript\npublic contact = { name: '' };\n```\n\n#### Directiva\n\nY enlazarlo con la vista para que siempre estn sincronizados.\n\n```html\n<section>\n  <label for=\"name\">Name</label>\n  <input\n    name=\"name\"\n    type=\"text\"\n    [(ngModel)]=\"contact.name\"\n    placeholder=\"Contact name\"\n  />\n</section>\n```\n\n#### Espa\n\nMientras desarrollas, es frecuente que quieras visualizar el valor de cualquier propiedad en tiempo de ejecucin. Algo as como un `console.log()` en la pantalla.\n\n```html\n<pre>{{ contact | json }}</pre>\n```\n\nEl anterior elemento se un espa perfecto de la actividad del usuario sobre el formulario. Una cosa ms, acurdate de quitarlo antes de enviar a produccin.\n\n## 2.2 Form\n\nLa tcnica bsica de enlazar _inputs_ con propiedades puedes extenderla cuanto quieras. Pero pronto echars en falta los _check boxes, radio buttons_ y dems. Hay ms usos de las directivas en los formularios.\n\nVamos a ver cmo usarlos para actuar sobre el siguiente modelo:\n\n```typescript\npublic contact = { name: '', isVIP: false, gender: '' };\n```\n\n### 2.2.1 CheckBox\n\nQuiz nos venga bien un _checkbox_ para saber si es o no un VIP.\n\n```html\n<section>\n  <label for=\"isVIP\">Is V.I.P.</label>\n  <input name=\"isVIP\" type=\"checkbox\" [(ngModel)]=\"contact.isVIP\" />\n</section>\n```\n\n### 2.2.2 Radio Buttons\n\nY un par de _radio buttons_ para el gnero.\n\n```html\n<section>\n  <label for=\"gender\">Gender</label>\n  <input name=\"gender\" value=\"m\" type=\"radio\" [(ngModel)]=\"contact.gender\" />\n  <i>Male</i>\n  <input name=\"gender\" value=\"f\" type=\"radio\" [(ngModel)]=\"contact.gender\" />\n  <i>Female</i>\n</section>\n```\n\n# 3. Estructuras\n\nMantn siempre en mete que el HTML que escribes es cdigo fuente. No es, an, el HTML que renderizar el navegador. Es casi casi un lenguaje de programacin per se. Con sus expresiones, instrucciones y estructuras.\n\n## 3.1 \\*ngFor\n\nVamos a empezar por las **estructuras repetitivas** presentando la Directiva estructural `*ngFor`.\n\nAvanzamos con el modelo al que agregamos posibles estados laborales de nuestros contactos:\n\n```typescript\npublic workStatuses = [\n  { id: 0, description: 'unknow' },\n  { id: 1, description: 'student' },\n  { id: 2, description: 'unemployed' },\n  { id: 3, description: 'employed' }\n];\npublic contact = { name: '', isVIP: false, gender: '', workStatus: 0 };\n```\n\n> \\*ngFor\n\n```html\n<section>\n  <label for=\"workStatus\">Work Status</label>\n  <select name=\"workStatus\" [(ngModel)]=\"contact.workStatus\">\n    <option *ngFor=\"let status of workStatuses\" [value]=\"status.id\">\n      <span>{{ status.description }}</span>\n    </option>\n  </select>\n</section>\n```\n\nEs un bucle de toda la vida vamos. Pero en em medio del HTML. Lo que hace es dar vueltas sobre un array y agregar un nodo HTML para cada elemento del array.\n\n> let **iterador** of **iterable**\n\n## 3.2 \\*ngIf\n\nY ahora le toca a las **estructuras condicionales** y para ello tenemos la directiva estructural `*ngIf`\n\nVamos un paso ms en el modelo y supongamos que queremos preguntar por la empresa actual si nuestro contacto est trabajando, y en caso contrario preguntarle por sus estudios.\n\n```typescript\npublic contact = {\n  name: '',\n  isVIP: false,\n  gender: '',\n  workStatus: '0',\n  company: '',\n  education: ''\n};\n```\n\n---\n\n> \\*ngIf\n\n```html\n<section *ngIf=\"contact.workStatus=='3'; else education\">\n  <label for=\"company\">Company Name</label>\n  <input name=\"company\" type=\"text\" [(ngModel)]=\"contact.company\" />\n</section>\n<ng-template #education>\n  <section>\n    <label for=\"education\">Education</label>\n    <input name=\"education\"\n            type=\"text\"\n            [(ngModel)]=\"contact.education\"\n            placeholder=\"Education\" />\n  </section>\n</ng-template>\n```\n\nVemos incrustado en HTML el tpico _if else_ de la programacin estructurada. Quiz llame la atencin la manera de tratar el _else_. Por ahora digamos que aquellos nodos del rbol que no tienen garantizada su existencia deben recogerse dentro de un elemento propio del Angular, las `ng-template`.\n\nOtra directiva smbolo que merece la pena mencionar es el `#`. Acta como un identificador que una vez aplicado a un elemento se puede usar para acceder a el desde cualquier parte del componente.\n\nEn resumen:\n\n> if **condition** else **template**\n\n> > tambin hay _\\*ngSwitch_\n\n---\n\n# 4. Modelo y controlador\n\nEste punto nu es de Angular propiamente, pero s del lenguaje que han escogido para que desarrollemos nuestras apps: el **TypeScript**.\n\nEs como un cruce entre _JavaScript_ y _Java_ o _C#_. Digamos que le aporta tipos estticos y mejoras en cuanto expresividad si queremos usar clases o una programacin ms orientada a objetos. Es un lenguaje de ayuda al programador. Realmente puedes usar sintaxis pura de JavaScript, porque el typeScript es JavaScript con anotaciones de opcionales de tipos.\n\nAngular viene ya con las herramientas y configuraciones necesarias para _transpilar_ el TypeScript a JavaScript.\n\n## 4.1 Interfaces y modelos\n\n> Mejor interface que clase\n\nSe aconseja por una buena razn. Las interfaces en JavaScript no existen. As, mientras desarrollamos nos ayuda con _intellisense_ y noes protegen de asignaciones indebidas. Pero, en ejecucin no pesan porque no tienen contrapartida.\n\n```typescript\nexport interface Option {\n  id: number;\n  description: string;\n}\n\nexport interface Contact {\n  name: string;\n  isVIP: boolean;\n  gender: string;\n  workStatus: number | string;\n  company: string;\n  education: string;\n}\n```\n\n> tipos compuestos `number | string`\n\nEste es un lenguaje que realmente slo aplica mientras desarrollas. As que permite hacer diabluras con los tipos.\n\nSe usan para tipificar las propiedades\n\n```typescript\npublic workStatuses: Option[] = [\n    { id: 0, description: 'unknow' },\n    { id: 1, description: 'student' },\n    { id: 2, description: 'unemployed' },\n    { id: 3, description: 'employed' }\n  ];\npublic contact: Contact = {\n    name: '',\n    isVIP: false,\n    gender: '',\n    workStatus: 0,\n    company: '',\n    education: ''\n  };\npublic contacts: Contact[] = [];\n```\n\n## 4.2 ViewModel en el controlador\n\nEl controlador del componente es una clase. Por tanto tiene no solo propiedades, sino tambin mtodos.\n\n```typescript\nsaveContact() {\n  this.contacts.push({ ...this.contact });\n  this.updateCounter();\n}\n\nprivate updateCounter() {\n  this.numberOfContacts = this.contacts.length;\n  this.counterClass = this.numberOfContacts === 0 ? 'warning' : 'success';\n}\n```\n\nLos mtodos pblicos pueden, y deben, ser invocados desde las vistas. De forma que las expresiones asignadas a los eventos sean simples llamadas a mtodos para que hagan el trabajo sucio.\n\n```html\n<input value=\"Save\" type=\"submit\" (click)=\"saveContact()\" />\n```\n\n### OnInit\n\nYa hemos visto que en TypeScript, las clases puede implementar interfaces. Angular nos facilita unos cuantos para usar como _hooks_ en determinados momentos dl ciclo de vida de una componente.\n\nEn particular hay uno que ya vienen pre implementado por el generador del CLI. Se llama `OnInit` y obliga a disponer de un mtodo pblico llamado `ngOnInit()`. Lo que programes dentro ser ejecutado durante la inicializacin del componente.\n\nEs una prctica recomendable usar ese mtodo en lugar del constructor para desplegar nuestra lgica de inicio. La razn es que el constructor se ejecuta antes de la existencia completa de la vista y eso puede generar inconsistencias.\n\n```typescript\npublic workStatuses: Option[];\npublic contact: Contact;\npublic contacts: Contact[];\nconstructor() {}\npublic ngOnInit() {\n  this.workStatuses = [\n    { id: 0, description: 'unknow' },\n    { id: 1, description: 'student' },\n    { id: 2, description: 'unemployed' },\n    { id: 3, description: 'employed' }\n  ];\n  this.contact = {\n    name: '',\n    isVIP: false,\n    gender: '',\n    workStatus: 0,\n    company: '',\n    education: ''\n  };\n  this.contacts = [];\n}\n```\n\n### Repasamos\n\nAgregamos una funcionalidad que nos obliga a repasar todo lo aprendido. Un listado en el que mostrar los contactos que se recogen del formulario.\n\n```html\n<ul *ngIf=\"contacts.length>0; else empty\">\n  <li *ngFor=\"let contact of contacts\">\n    <span>{{ contact.name }}</span>\n    <input value=\"Delete\" type=\"button\" (click)=\"deleteContact(contact)\" />\n  </li>\n</ul>\n<ng-template #empty> <i>No contacts yet</i> </ng-template>\n```\n\n```typescript\ndeleteContact(contact: Contact) {\n  this.contacts = this.contacts.filter(c => c.name !== contact.name);\n  this.updateCounter();\n}\n```\n\nMira el cdigo completo de **la clase** `ContactsComponent`en el fichero `contacts.component.ts` para tener una visin completa del componente. Como ves, **las propiedades** `header, numberOfContacts, formHidden, contacts ...` se corresponden con las utilizadas en las directivas de enlace en la vista. Mientras que **los mtodos** `saveContact(), deleteContact()` son invocados desde eventos de elementos del _html_.\n\nJuntos, **la vista y su clase controladora**, resuelven un problema de interaccin con el usuario **creando un componente**. Todas las pginas que disees sern variaciones y composiciones de estos componentes.\n\n> Y esto es slo el comienzo. La idea de componente ser fundamental en la web del maana para la creacin de pginas mediante `web components`. Pero eso ya se ver ms adelante...\n\nAhora tienes una aplicacin en _Angular 9_ que recoge y muestra datos. Sigue esta serie para aadirle [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/) mientras aprendes a programar con Angular8. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"formularios-tablas-y-modelos-de-datos-en-angular","published":1,"updated":"2020-04-15T12:36:41.003Z","_id":"ck70mab1o000tbss3n6h3iecn","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-3_data.png\" alt=\"formularios-tablas-y-modelos-de-datos-en-angular\"></p><p>Las <strong>aplicaciones Angular 9 son excelentes para el tratamiento de datos</strong> en el navegador. Su razn de ser fue la recogida de informacin mediante formularios y la presentacin de pginas dinmicas de forma sencilla.</p><p>Vamos a ver cmo la librera <code>@angular/forms</code> enlaza <strong>las vistas, los controladores y los modelos</strong>; y cmo se hace la presentacin de datos en <strong>listas y tablas</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a>, al finalizar tendrs una aplicacin que recoge y presenta datos.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Binding\"><a href=\"#1-Binding\" class=\"headerlink\" title=\"1. Binding\"></a>1. Binding</h1><h2 id=\"1-0-Base\"><a href=\"#1-0-Base\" class=\"headerlink\" title=\"1.0 Base\"></a>1.0 Base</h2><p><strong>Los formularios son el punto de entrada</strong> de informacin a nuestros sistemas. Llevan con nosotros desde el inicio de la propia informtica y se han comido una buena parte del tiempo de programacin. En <em>Angular</em> han prestado una especial atencin a ellos facilitando su desarrollo, <strong>desde pantallas simples hasta complejos procesos</strong>.</p><p>Vamos con simple ejemplo para recopilar informacin de contactos personales. Creamos una nueva ruta funcional para la gestin de contactos. Requiere ruta, enlace, mdulo y componente.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m contacts --route contacts --module app-routing.module</span><br></pre></td></tr></table></figure><p>Como ya sabemos, adems de la creacin del mdulo y el componente, esto altera los ficheros de enrutado. As tenemos lo siguiente en <code>app-routing</code> y en <code>contacts-routing</code>:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app-routing</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'contacts'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./contacts/contacts.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.ContactsModule)</span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"><span class=\"comment\">// contacts-routing</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">''</span>,</span><br><span class=\"line\">  component: ContactsComponent</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Hay que aadir una entrada en el <code>SideComponent</code> y ya tenemos listo el armazn para continuar.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"contacts\"</span>&gt;</span>Forms<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-1-Directivas\"><a href=\"#1-1-Directivas\" class=\"headerlink\" title=\"1.1 Directivas\"></a>1.1 Directivas</h2><p>Antes de pedir informacin, vamos a prepara el terreno. Necesitamos algunos textos para instruir al usuario y, sobre todo, un lugar en dnde recoger lo que nos escriba. Para ello atacaremos a la clase controladora del nuevo componente.</p><blockquote><p>Para empezar agregamos algunas propiedades. En <code>contacts.component.ts</code>:</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">header = <span class=\"string\">'Contacts'</span>;</span><br><span class=\"line\">description = <span class=\"string\">'Manage your contact list'</span>;</span><br><span class=\"line\">numberOfContacts = <span class=\"number\">0</span>;</span><br><span class=\"line\">counterStyleColor = <span class=\"string\">'green'</span>;</span><br><span class=\"line\">counterClass = <span class=\"string\">'warning'</span>;</span><br><span class=\"line\">formHidden = <span class=\"literal\">false</span>;</span><br></pre></td></tr></table></figure><h3 id=\"1-1-1-Enlace-del-modelo-hacia-la-vista\"><a href=\"#1-1-1-Enlace-del-modelo-hacia-la-vista\" class=\"headerlink\" title=\"1.1.1 Enlace del modelo hacia la vista\"></a>1.1.1 Enlace del modelo hacia la vista</h3><p>Estas propiedades pblicas son visibles desde la vista HTML. As, en <code>contacts.component.html</code> mostramos cabeceras con estilo como este.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\">  &#123;&#123; header &#125;&#125;: &#123;&#123; description | uppercase &#125;&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span> [<span class=\"attr\">style.color</span>]=<span class=\"string\">\"counterStyleColor\"</span>&gt;</span>You have <span class=\"tag\">&lt;<span class=\"name\">mark</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">class</span>=<span class=\"string\">\"&#123;&#123; counterClass &#125;&#125;\"</span>&gt;</span>&#123;&#123; numberOfContacts &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">mark</span>&gt;</span></span><br><span class=\"line\">  contacts right now.<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Este cdigo HTML es bsicamente estndar, pero est reforzado con algunos smbolos que pueden resultar extraos. Son <strong>las directivas de Angular</strong>. Se trata de atributos fuente que una vez compilados generan funcionalidad extra.</p><p>La manera ms directa de hacerlo es representar en la vista algn dato del modelo. Y eso se hace con las expresiones de interpolacin entre llaves. <code></code> Suelen usarse para aportar contenido a elementos html, aunque tambin a cualquier atributo.</p><p>A la hora de pintar datos, a veces querremos transformarlos antes. Para eso emplearemos <strong>los pipes de Angular</strong>. Son funciones que adjuntaremos a las expresiones usando el carcter especial <code>|</code> llamado <em>pipe</em>. La entrada de la funcin es lo que hay a la izquierda de la tubera. La salida de la funcin es lo que se muestra.</p><p>En Angular disponemos de suficientes pipes estndar para cubrir los casos bsicos de presentacin de textos, fechas, monedas y dems.</p><p>Tambin tenemos formas de asignar contenido dinmico a los atributos. Basta con envolvernos entre corchetes y su valor se calcula como una expresin. Como norma general sera algo as: <code>[atribute]=&quot;expresion&quot;</code></p><h3 id=\"1-1-2-Enlace-de-la-vista-hacia-el-modelo\"><a href=\"#1-1-2-Enlace-de-la-vista-hacia-el-modelo\" class=\"headerlink\" title=\"1.1.2 Enlace de la vista hacia el modelo\"></a>1.1.2 Enlace de la vista hacia el modelo</h3><p>Toca ahora darle la opcin al usuario de actuar sobre los datos desde la vista. Por ejemplo en <code>contacts.component.html</code> hemos creado un par de botones cuya intencin es mostrar u ocultar un formulario sobre el que trabajaremos ms adelante.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">value</span>=<span class=\"string\">\"Show Form\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">class</span>=<span class=\"string\">\"primary\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  (<span class=\"attr\">click</span>)=<span class=\"string\">\"formHidden=false\"</span></span></span><br><span class=\"line\"><span class=\"tag\">/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">value</span>=<span class=\"string\">\"Hide Form\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">class</span>=<span class=\"string\">\"inverse\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  (<span class=\"attr\">click</span>)=<span class=\"string\">\"formHidden=true\"</span></span></span><br><span class=\"line\"><span class=\"tag\">/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> [<span class=\"attr\">ngClass</span>]=<span class=\"string\">\"&#123;'hidden':formHidden&#125;\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">legend</span>&gt;</span>Contact Form<span class=\"tag\">&lt;/<span class=\"name\">legend</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Para ello usaremos los eventos estndar del HTML, como el <em>click</em> de los <em>input</em>. Pero, de nuevo, usaremos smbolos propios de Angular como los parntesis <code>(eventName)</code>. En esta ocasin lo que asignaremos ser un instruccin, que ser ejecutada cuando el evento se dispare.</p><p>Para ver el efecto completo, echamos mano de otra directiva propia de Angular: la <code>ngClass</code>. Esta nos sirve para aplicar estilos CSS conducidos por los datos. Se aplican o no en funcin de que se cumplan ciertas condiciones dinmicamente. En este caso el estilo <em>hidden</em>.</p><h1 id=\"2-Doble-Binding\"><a href=\"#2-Doble-Binding\" class=\"headerlink\" title=\"2. Doble Binding\"></a>2. Doble Binding</h1><p>Hemos visto lo fcil que es mostrar datos en una pantalla. Y tampoco resulta complejo responder a eventos del usuario. Digamos que tenemos mecanismos para realizar el enlace, <em>binding</em> en el argot de Angular, entre la vista y el modelo.</p><p>La idea es juntar ambos mecanismos en algo que permita enlazar vista y modelo en ambos sentidos. De esta forma podremos mantener sincronizados lo que el usuario ve y lo que realmente se est procesando.</p><h2 id=\"2-1-NgModel\"><a href=\"#2-1-NgModel\" class=\"headerlink\" title=\"2.1 NgModel\"></a>2.1 NgModel</h2><p>La directiva <em>ngModel</em> viene en un mdulo del framework llamado <code>FormsModule</code>. Hay que importarlo para poder usar su contenido, tal como hemos hecho en <code>contacts.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; CommonModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; FormsModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; ContactsRoutingModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./contacts-routing.module'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    ContactsRoutingModule,</span><br><span class=\"line\">    FormsModule</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ContactsModule &#123; &#125;</span><br></pre></td></tr></table></figure><p>A partir de ese momento podemos invocar sus directivas, yb vamos a empezar por la ms utilizada y famosa: <code>ngModel</code>.</p><h3 id=\"Banana-in-a-box\"><a href=\"#Banana-in-a-box\" class=\"headerlink\" title=\"Banana in a box [()]\"></a>Banana in a box [()]</h3><p>Pero ojo, esta potente directiva no se jea utilizar as como as. Hay que enjaularla convenientemente entre una doble barrera de corchetes y parntesis <code>[()]</code>. Para recordarlo se puso de moda la frase <em>Banana in a box</em> que hace referencia al <em>parntesis dentro del corchete</em></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"model.property\"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>Usa la comunicacin en ambos sentidos</p><ul><li><strong>(banana)</strong> : de la vista al modelo</li><li><strong>[box]</strong> : del modelo a la vista</li></ul><h4 id=\"Modelo\"><a href=\"#Modelo\" class=\"headerlink\" title=\"Modelo\"></a>Modelo</h4><blockquote><p>La directiva se asocia con una propiedad del controlador<br>o mejor an, con una <strong>propiedad del modelo</strong> del controlador</p></blockquote><p>Por ejemplo podemos crear un objeto literal para representar a un contacto y trabajar sobre l</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span> &#125;;</span><br></pre></td></tr></table></figure><h4 id=\"Directiva\"><a href=\"#Directiva\" class=\"headerlink\" title=\"Directiva\"></a>Directiva</h4><p>Y enlazarlo con la vista para que siempre estn sincronizados.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"name\"</span>&gt;</span>Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">placeholder</span>=<span class=\"string\">\"Contact name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id=\"Espia\"><a href=\"#Espia\" class=\"headerlink\" title=\"Espa\"></a>Espa</h4><p>Mientras desarrollas, es frecuente que quieras visualizar el valor de cualquier propiedad en tiempo de ejecucin. Algo as como un <code>console.log()</code> en la pantalla.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; contact | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>El anterior elemento se un espa perfecto de la actividad del usuario sobre el formulario. Una cosa ms, acurdate de quitarlo antes de enviar a produccin.</p><h2 id=\"2-2-Form\"><a href=\"#2-2-Form\" class=\"headerlink\" title=\"2.2 Form\"></a>2.2 Form</h2><p>La tcnica bsica de enlazar <em>inputs</em> con propiedades puedes extenderla cuanto quieras. Pero pronto echars en falta los <em>check boxes, radio buttons</em> y dems. Hay ms usos de las directivas en los formularios.</p><p>Vamos a ver cmo usarlos para actuar sobre el siguiente modelo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span>, isVIP: <span class=\"literal\">false</span>, gender: <span class=\"string\">''</span> &#125;;</span><br></pre></td></tr></table></figure><h3 id=\"2-2-1-CheckBox\"><a href=\"#2-2-1-CheckBox\" class=\"headerlink\" title=\"2.2.1 CheckBox\"></a>2.2.1 CheckBox</h3><p>Quiz nos venga bien un <em>checkbox</em> para saber si es o no un VIP.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"isVIP\"</span>&gt;</span>Is V.I.P.<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"isVIP\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"checkbox\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.isVIP\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"2-2-2-Radio-Buttons\"><a href=\"#2-2-2-Radio-Buttons\" class=\"headerlink\" title=\"2.2.2 Radio Buttons\"></a>2.2.2 Radio Buttons</h3><p>Y un par de <em>radio buttons</em> para el gnero.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"gender\"</span>&gt;</span>Gender<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"gender\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"m\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"radio\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.gender\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>Male<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"gender\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"f\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"radio\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.gender\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>Female<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"3-Estructuras\"><a href=\"#3-Estructuras\" class=\"headerlink\" title=\"3. Estructuras\"></a>3. Estructuras</h1><p>Mantn siempre en mete que el HTML que escribes es cdigo fuente. No es, an, el HTML que renderizar el navegador. Es casi casi un lenguaje de programacin per se. Con sus expresiones, instrucciones y estructuras.</p><h2 id=\"3-1-ngFor\"><a href=\"#3-1-ngFor\" class=\"headerlink\" title=\"3.1 *ngFor\"></a>3.1 *ngFor</h2><p>Vamos a empezar por las <strong>estructuras repetitivas</strong> presentando la Directiva estructural <code>*ngFor</code>.</p><p>Avanzamos con el modelo al que agregamos posibles estados laborales de nuestros contactos:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses = [</span><br><span class=\"line\">  &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span>, isVIP: <span class=\"literal\">false</span>, gender: <span class=\"string\">''</span>, workStatus: <span class=\"number\">0</span> &#125;;</span><br></pre></td></tr></table></figure><blockquote><p>*ngFor</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"workStatus\"</span>&gt;</span>Work Status<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">name</span>=<span class=\"string\">\"workStatus\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.workStatus\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">option</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let status of workStatuses\"</span> [<span class=\"attr\">value</span>]=<span class=\"string\">\"status.id\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; status.description &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Es un bucle de toda la vida vamos. Pero en em medio del HTML. Lo que hace es dar vueltas sobre un array y agregar un nodo HTML para cada elemento del array.</p><blockquote><p>let <strong>iterador</strong> of <strong>iterable</strong></p></blockquote><h2 id=\"3-2-ngIf\"><a href=\"#3-2-ngIf\" class=\"headerlink\" title=\"3.2 *ngIf\"></a>3.2 *ngIf</h2><p>Y ahora le toca a las <strong>estructuras condicionales</strong> y para ello tenemos la directiva estructural <code>*ngIf</code></p><p>Vamos un paso ms en el modelo y supongamos que queremos preguntar por la empresa actual si nuestro contacto est trabajando, y en caso contrario preguntarle por sus estudios.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123;</span><br><span class=\"line\">  name: <span class=\"string\">''</span>,</span><br><span class=\"line\">  isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">  gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">  workStatus: <span class=\"string\">'0'</span>,</span><br><span class=\"line\">  company: <span class=\"string\">''</span>,</span><br><span class=\"line\">  education: <span class=\"string\">''</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure><hr><blockquote><p>*ngIf</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"contact.workStatus=='3'; else education\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"company\"</span>&gt;</span>Company Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"company\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.company\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ng-template</span> #<span class=\"attr\">education</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"education\"</span>&gt;</span>Education<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"education\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.education\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">placeholder</span>=<span class=\"string\">\"Education\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Vemos incrustado en HTML el tpico <em>if else</em> de la programacin estructurada. Quiz llame la atencin la manera de tratar el <em>else</em>. Por ahora digamos que aquellos nodos del rbol que no tienen garantizada su existencia deben recogerse dentro de un elemento propio del Angular, las <code>ng-template</code>.</p><p>Otra directiva smbolo que merece la pena mencionar es el <code>#</code>. Acta como un identificador que una vez aplicado a un elemento se puede usar para acceder a el desde cualquier parte del componente.</p><p>En resumen:</p><blockquote><p>if <strong>condition</strong> else <strong>template</strong></p></blockquote><blockquote><blockquote><p>tambin hay <em>*ngSwitch</em></p></blockquote></blockquote><hr><h1 id=\"4-Modelo-y-controlador\"><a href=\"#4-Modelo-y-controlador\" class=\"headerlink\" title=\"4. Modelo y controlador\"></a>4. Modelo y controlador</h1><p>Este punto nu es de Angular propiamente, pero s del lenguaje que han escogido para que desarrollemos nuestras apps: el <strong>TypeScript</strong>.</p><p>Es como un cruce entre <em>JavaScript</em> y <em>Java</em> o <em>C#</em>. Digamos que le aporta tipos estticos y mejoras en cuanto expresividad si queremos usar clases o una programacin ms orientada a objetos. Es un lenguaje de ayuda al programador. Realmente puedes usar sintaxis pura de JavaScript, porque el typeScript es JavaScript con anotaciones de opcionales de tipos.</p><p>Angular viene ya con las herramientas y configuraciones necesarias para <em>transpilar</em> el TypeScript a JavaScript.</p><h2 id=\"4-1-Interfaces-y-modelos\"><a href=\"#4-1-Interfaces-y-modelos\" class=\"headerlink\" title=\"4.1 Interfaces y modelos\"></a>4.1 Interfaces y modelos</h2><blockquote><p>Mejor interface que clase</p></blockquote><p>Se aconseja por una buena razn. Las interfaces en JavaScript no existen. As, mientras desarrollamos nos ayuda con <em>intellisense</em> y noes protegen de asignaciones indebidas. Pero, en ejecucin no pesan porque no tienen contrapartida.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Option &#123;</span><br><span class=\"line\">  id: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  description: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Contact &#123;</span><br><span class=\"line\">  name: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  isVIP: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  gender: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  workStatus: <span class=\"built_in\">number</span> | <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  company: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  education: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>tipos compuestos <code>number | string</code></p></blockquote><p>Este es un lenguaje que realmente slo aplica mientras desarrollas. As que permite hacer diabluras con los tipos.</p><p>Se usan para tipificar las propiedades</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses: Option[] = [</span><br><span class=\"line\">    &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">  ];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact: Contact = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">''</span>,</span><br><span class=\"line\">    isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">    workStatus: <span class=\"number\">0</span>,</span><br><span class=\"line\">    company: <span class=\"string\">''</span>,</span><br><span class=\"line\">    education: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"><span class=\"keyword\">public</span> contacts: Contact[] = [];</span><br></pre></td></tr></table></figure><h2 id=\"4-2-ViewModel-en-el-controlador\"><a href=\"#4-2-ViewModel-en-el-controlador\" class=\"headerlink\" title=\"4.2 ViewModel en el controlador\"></a>4.2 ViewModel en el controlador</h2><p>El controlador del componente es una clase. Por tanto tiene no solo propiedades, sino tambin mtodos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">saveContact() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts.push(&#123; ...this.contact &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.updateCounter();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> updateCounter() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.numberOfContacts = <span class=\"keyword\">this</span>.contacts.length;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.counterClass = <span class=\"keyword\">this</span>.numberOfContacts === <span class=\"number\">0</span> ? <span class=\"string\">'warning'</span> : <span class=\"string\">'success'</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Los mtodos pblicos pueden, y deben, ser invocados desde las vistas. De forma que las expresiones asignadas a los eventos sean simples llamadas a mtodos para que hagan el trabajo sucio.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Save\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"saveContact()\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"OnInit\"><a href=\"#OnInit\" class=\"headerlink\" title=\"OnInit\"></a>OnInit</h3><p>Ya hemos visto que en TypeScript, las clases puede implementar interfaces. Angular nos facilita unos cuantos para usar como <em>hooks</em> en determinados momentos dl ciclo de vida de una componente.</p><p>En particular hay uno que ya vienen pre implementado por el generador del CLI. Se llama <code>OnInit</code> y obliga a disponer de un mtodo pblico llamado <code>ngOnInit()</code>. Lo que programes dentro ser ejecutado durante la inicializacin del componente.</p><p>Es una prctica recomendable usar ese mtodo en lugar del constructor para desplegar nuestra lgica de inicio. La razn es que el constructor se ejecuta antes de la existencia completa de la vista y eso puede generar inconsistencias.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses: Option[];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact: Contact;</span><br><span class=\"line\"><span class=\"keyword\">public</span> contacts: Contact[];</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.workStatuses = [</span><br><span class=\"line\">    &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">  ];</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contact = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">''</span>,</span><br><span class=\"line\">    isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">    workStatus: <span class=\"number\">0</span>,</span><br><span class=\"line\">    company: <span class=\"string\">''</span>,</span><br><span class=\"line\">    education: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts = [];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h3 id=\"Repasamos\"><a href=\"#Repasamos\" class=\"headerlink\" title=\"Repasamos\"></a>Repasamos</h3><p>Agregamos una funcionalidad que nos obliga a repasar todo lo aprendido. Un listado en el que mostrar los contactos que se recogen del formulario.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"contacts.length&gt;0; else empty\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let contact of contacts\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; contact.name &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Delete\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"deleteContact(contact)\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ng-template</span> #<span class=\"attr\">empty</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>No contacts yet<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deleteContact(contact: Contact) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts = <span class=\"keyword\">this</span>.contacts.filter(<span class=\"function\"><span class=\"params\">c</span> =&gt;</span> c.name !== contact.name);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.updateCounter();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Mira el cdigo completo de <strong>la clase</strong> <code>ContactsComponent</code>en el fichero <code>contacts.component.ts</code> para tener una visin completa del componente. Como ves, <strong>las propiedades</strong> <code>header, numberOfContacts, formHidden, contacts ...</code> se corresponden con las utilizadas en las directivas de enlace en la vista. Mientras que <strong>los mtodos</strong> <code>saveContact(), deleteContact()</code> son invocados desde eventos de elementos del <em>html</em>.</p><p>Juntos, <strong>la vista y su clase controladora</strong>, resuelven un problema de interaccin con el usuario <strong>creando un componente</strong>. Todas las pginas que disees sern variaciones y composiciones de estos componentes.</p><blockquote><p>Y esto es slo el comienzo. La idea de componente ser fundamental en la web del maana para la creacin de pginas mediante <code>web components</code>. Pero eso ya se ver ms adelante</p></blockquote><p>Ahora tienes una aplicacin en <em>Angular 9</em> que recoge y muestra datos. Sigue esta serie para aadirle <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a> mientras aprendes a programar con Angular8. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-3_data.png\" alt=\"formularios-tablas-y-modelos-de-datos-en-angular\"></p><p>Las <strong>aplicaciones Angular 9 son excelentes para el tratamiento de datos</strong> en el navegador. Su razn de ser fue la recogida de informacin mediante formularios y la presentacin de pginas dinmicas de forma sencilla.</p><p>Vamos a ver cmo la librera <code>@angular/forms</code> enlaza <strong>las vistas, los controladores y los modelos</strong>; y cmo se hace la presentacin de datos en <strong>listas y tablas</strong>.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a>, al finalizar tendrs una aplicacin que recoge y presenta datos.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Binding\"><a href=\"#1-Binding\" class=\"headerlink\" title=\"1. Binding\"></a>1. Binding</h1><h2 id=\"1-0-Base\"><a href=\"#1-0-Base\" class=\"headerlink\" title=\"1.0 Base\"></a>1.0 Base</h2><p><strong>Los formularios son el punto de entrada</strong> de informacin a nuestros sistemas. Llevan con nosotros desde el inicio de la propia informtica y se han comido una buena parte del tiempo de programacin. En <em>Angular</em> han prestado una especial atencin a ellos facilitando su desarrollo, <strong>desde pantallas simples hasta complejos procesos</strong>.</p><p>Vamos con simple ejemplo para recopilar informacin de contactos personales. Creamos una nueva ruta funcional para la gestin de contactos. Requiere ruta, enlace, mdulo y componente.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m contacts --route contacts --module app-routing.module</span><br></pre></td></tr></table></figure><p>Como ya sabemos, adems de la creacin del mdulo y el componente, esto altera los ficheros de enrutado. As tenemos lo siguiente en <code>app-routing</code> y en <code>contacts-routing</code>:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app-routing</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'contacts'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./contacts/contacts.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.ContactsModule)</span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"><span class=\"comment\">// contacts-routing</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">''</span>,</span><br><span class=\"line\">  component: ContactsComponent</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Hay que aadir una entrada en el <code>SideComponent</code> y ya tenemos listo el armazn para continuar.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"contacts\"</span>&gt;</span>Forms<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-1-Directivas\"><a href=\"#1-1-Directivas\" class=\"headerlink\" title=\"1.1 Directivas\"></a>1.1 Directivas</h2><p>Antes de pedir informacin, vamos a prepara el terreno. Necesitamos algunos textos para instruir al usuario y, sobre todo, un lugar en dnde recoger lo que nos escriba. Para ello atacaremos a la clase controladora del nuevo componente.</p><blockquote><p>Para empezar agregamos algunas propiedades. En <code>contacts.component.ts</code>:</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">header = <span class=\"string\">'Contacts'</span>;</span><br><span class=\"line\">description = <span class=\"string\">'Manage your contact list'</span>;</span><br><span class=\"line\">numberOfContacts = <span class=\"number\">0</span>;</span><br><span class=\"line\">counterStyleColor = <span class=\"string\">'green'</span>;</span><br><span class=\"line\">counterClass = <span class=\"string\">'warning'</span>;</span><br><span class=\"line\">formHidden = <span class=\"literal\">false</span>;</span><br></pre></td></tr></table></figure><h3 id=\"1-1-1-Enlace-del-modelo-hacia-la-vista\"><a href=\"#1-1-1-Enlace-del-modelo-hacia-la-vista\" class=\"headerlink\" title=\"1.1.1 Enlace del modelo hacia la vista\"></a>1.1.1 Enlace del modelo hacia la vista</h3><p>Estas propiedades pblicas son visibles desde la vista HTML. As, en <code>contacts.component.html</code> mostramos cabeceras con estilo como este.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\">  &#123;&#123; header &#125;&#125;: &#123;&#123; description | uppercase &#125;&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span> [<span class=\"attr\">style.color</span>]=<span class=\"string\">\"counterStyleColor\"</span>&gt;</span>You have <span class=\"tag\">&lt;<span class=\"name\">mark</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">class</span>=<span class=\"string\">\"&#123;&#123; counterClass &#125;&#125;\"</span>&gt;</span>&#123;&#123; numberOfContacts &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">mark</span>&gt;</span></span><br><span class=\"line\">  contacts right now.<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Este cdigo HTML es bsicamente estndar, pero est reforzado con algunos smbolos que pueden resultar extraos. Son <strong>las directivas de Angular</strong>. Se trata de atributos fuente que una vez compilados generan funcionalidad extra.</p><p>La manera ms directa de hacerlo es representar en la vista algn dato del modelo. Y eso se hace con las expresiones de interpolacin entre llaves. <code></code> Suelen usarse para aportar contenido a elementos html, aunque tambin a cualquier atributo.</p><p>A la hora de pintar datos, a veces querremos transformarlos antes. Para eso emplearemos <strong>los pipes de Angular</strong>. Son funciones que adjuntaremos a las expresiones usando el carcter especial <code>|</code> llamado <em>pipe</em>. La entrada de la funcin es lo que hay a la izquierda de la tubera. La salida de la funcin es lo que se muestra.</p><p>En Angular disponemos de suficientes pipes estndar para cubrir los casos bsicos de presentacin de textos, fechas, monedas y dems.</p><p>Tambin tenemos formas de asignar contenido dinmico a los atributos. Basta con envolvernos entre corchetes y su valor se calcula como una expresin. Como norma general sera algo as: <code>[atribute]=&quot;expresion&quot;</code></p><h3 id=\"1-1-2-Enlace-de-la-vista-hacia-el-modelo\"><a href=\"#1-1-2-Enlace-de-la-vista-hacia-el-modelo\" class=\"headerlink\" title=\"1.1.2 Enlace de la vista hacia el modelo\"></a>1.1.2 Enlace de la vista hacia el modelo</h3><p>Toca ahora darle la opcin al usuario de actuar sobre los datos desde la vista. Por ejemplo en <code>contacts.component.html</code> hemos creado un par de botones cuya intencin es mostrar u ocultar un formulario sobre el que trabajaremos ms adelante.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">value</span>=<span class=\"string\">\"Show Form\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">class</span>=<span class=\"string\">\"primary\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  (<span class=\"attr\">click</span>)=<span class=\"string\">\"formHidden=false\"</span></span></span><br><span class=\"line\"><span class=\"tag\">/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">value</span>=<span class=\"string\">\"Hide Form\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">class</span>=<span class=\"string\">\"inverse\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  (<span class=\"attr\">click</span>)=<span class=\"string\">\"formHidden=true\"</span></span></span><br><span class=\"line\"><span class=\"tag\">/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> [<span class=\"attr\">ngClass</span>]=<span class=\"string\">\"&#123;'hidden':formHidden&#125;\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">legend</span>&gt;</span>Contact Form<span class=\"tag\">&lt;/<span class=\"name\">legend</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Para ello usaremos los eventos estndar del HTML, como el <em>click</em> de los <em>input</em>. Pero, de nuevo, usaremos smbolos propios de Angular como los parntesis <code>(eventName)</code>. En esta ocasin lo que asignaremos ser un instruccin, que ser ejecutada cuando el evento se dispare.</p><p>Para ver el efecto completo, echamos mano de otra directiva propia de Angular: la <code>ngClass</code>. Esta nos sirve para aplicar estilos CSS conducidos por los datos. Se aplican o no en funcin de que se cumplan ciertas condiciones dinmicamente. En este caso el estilo <em>hidden</em>.</p><h1 id=\"2-Doble-Binding\"><a href=\"#2-Doble-Binding\" class=\"headerlink\" title=\"2. Doble Binding\"></a>2. Doble Binding</h1><p>Hemos visto lo fcil que es mostrar datos en una pantalla. Y tampoco resulta complejo responder a eventos del usuario. Digamos que tenemos mecanismos para realizar el enlace, <em>binding</em> en el argot de Angular, entre la vista y el modelo.</p><p>La idea es juntar ambos mecanismos en algo que permita enlazar vista y modelo en ambos sentidos. De esta forma podremos mantener sincronizados lo que el usuario ve y lo que realmente se est procesando.</p><h2 id=\"2-1-NgModel\"><a href=\"#2-1-NgModel\" class=\"headerlink\" title=\"2.1 NgModel\"></a>2.1 NgModel</h2><p>La directiva <em>ngModel</em> viene en un mdulo del framework llamado <code>FormsModule</code>. Hay que importarlo para poder usar su contenido, tal como hemos hecho en <code>contacts.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; CommonModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; FormsModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; ContactsRoutingModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./contacts-routing.module'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    ContactsRoutingModule,</span><br><span class=\"line\">    FormsModule</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ContactsModule &#123; &#125;</span><br></pre></td></tr></table></figure><p>A partir de ese momento podemos invocar sus directivas, yb vamos a empezar por la ms utilizada y famosa: <code>ngModel</code>.</p><h3 id=\"Banana-in-a-box\"><a href=\"#Banana-in-a-box\" class=\"headerlink\" title=\"Banana in a box [()]\"></a>Banana in a box [()]</h3><p>Pero ojo, esta potente directiva no se jea utilizar as como as. Hay que enjaularla convenientemente entre una doble barrera de corchetes y parntesis <code>[()]</code>. Para recordarlo se puso de moda la frase <em>Banana in a box</em> que hace referencia al <em>parntesis dentro del corchete</em></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"model.property\"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>Usa la comunicacin en ambos sentidos</p><ul><li><strong>(banana)</strong> : de la vista al modelo</li><li><strong>[box]</strong> : del modelo a la vista</li></ul><h4 id=\"Modelo\"><a href=\"#Modelo\" class=\"headerlink\" title=\"Modelo\"></a>Modelo</h4><blockquote><p>La directiva se asocia con una propiedad del controlador<br>o mejor an, con una <strong>propiedad del modelo</strong> del controlador</p></blockquote><p>Por ejemplo podemos crear un objeto literal para representar a un contacto y trabajar sobre l</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span> &#125;;</span><br></pre></td></tr></table></figure><h4 id=\"Directiva\"><a href=\"#Directiva\" class=\"headerlink\" title=\"Directiva\"></a>Directiva</h4><p>Y enlazarlo con la vista para que siempre estn sincronizados.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"name\"</span>&gt;</span>Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">placeholder</span>=<span class=\"string\">\"Contact name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">  /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id=\"Espia\"><a href=\"#Espia\" class=\"headerlink\" title=\"Espa\"></a>Espa</h4><p>Mientras desarrollas, es frecuente que quieras visualizar el valor de cualquier propiedad en tiempo de ejecucin. Algo as como un <code>console.log()</code> en la pantalla.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; contact | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>El anterior elemento se un espa perfecto de la actividad del usuario sobre el formulario. Una cosa ms, acurdate de quitarlo antes de enviar a produccin.</p><h2 id=\"2-2-Form\"><a href=\"#2-2-Form\" class=\"headerlink\" title=\"2.2 Form\"></a>2.2 Form</h2><p>La tcnica bsica de enlazar <em>inputs</em> con propiedades puedes extenderla cuanto quieras. Pero pronto echars en falta los <em>check boxes, radio buttons</em> y dems. Hay ms usos de las directivas en los formularios.</p><p>Vamos a ver cmo usarlos para actuar sobre el siguiente modelo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span>, isVIP: <span class=\"literal\">false</span>, gender: <span class=\"string\">''</span> &#125;;</span><br></pre></td></tr></table></figure><h3 id=\"2-2-1-CheckBox\"><a href=\"#2-2-1-CheckBox\" class=\"headerlink\" title=\"2.2.1 CheckBox\"></a>2.2.1 CheckBox</h3><p>Quiz nos venga bien un <em>checkbox</em> para saber si es o no un VIP.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"isVIP\"</span>&gt;</span>Is V.I.P.<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"isVIP\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"checkbox\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.isVIP\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"2-2-2-Radio-Buttons\"><a href=\"#2-2-2-Radio-Buttons\" class=\"headerlink\" title=\"2.2.2 Radio Buttons\"></a>2.2.2 Radio Buttons</h3><p>Y un par de <em>radio buttons</em> para el gnero.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"gender\"</span>&gt;</span>Gender<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"gender\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"m\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"radio\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.gender\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>Male<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"gender\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"f\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"radio\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.gender\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>Female<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"3-Estructuras\"><a href=\"#3-Estructuras\" class=\"headerlink\" title=\"3. Estructuras\"></a>3. Estructuras</h1><p>Mantn siempre en mete que el HTML que escribes es cdigo fuente. No es, an, el HTML que renderizar el navegador. Es casi casi un lenguaje de programacin per se. Con sus expresiones, instrucciones y estructuras.</p><h2 id=\"3-1-ngFor\"><a href=\"#3-1-ngFor\" class=\"headerlink\" title=\"3.1 *ngFor\"></a>3.1 *ngFor</h2><p>Vamos a empezar por las <strong>estructuras repetitivas</strong> presentando la Directiva estructural <code>*ngFor</code>.</p><p>Avanzamos con el modelo al que agregamos posibles estados laborales de nuestros contactos:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses = [</span><br><span class=\"line\">  &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span>, isVIP: <span class=\"literal\">false</span>, gender: <span class=\"string\">''</span>, workStatus: <span class=\"number\">0</span> &#125;;</span><br></pre></td></tr></table></figure><blockquote><p>*ngFor</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"workStatus\"</span>&gt;</span>Work Status<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">name</span>=<span class=\"string\">\"workStatus\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.workStatus\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">option</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let status of workStatuses\"</span> [<span class=\"attr\">value</span>]=<span class=\"string\">\"status.id\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; status.description &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Es un bucle de toda la vida vamos. Pero en em medio del HTML. Lo que hace es dar vueltas sobre un array y agregar un nodo HTML para cada elemento del array.</p><blockquote><p>let <strong>iterador</strong> of <strong>iterable</strong></p></blockquote><h2 id=\"3-2-ngIf\"><a href=\"#3-2-ngIf\" class=\"headerlink\" title=\"3.2 *ngIf\"></a>3.2 *ngIf</h2><p>Y ahora le toca a las <strong>estructuras condicionales</strong> y para ello tenemos la directiva estructural <code>*ngIf</code></p><p>Vamos un paso ms en el modelo y supongamos que queremos preguntar por la empresa actual si nuestro contacto est trabajando, y en caso contrario preguntarle por sus estudios.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123;</span><br><span class=\"line\">  name: <span class=\"string\">''</span>,</span><br><span class=\"line\">  isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">  gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">  workStatus: <span class=\"string\">'0'</span>,</span><br><span class=\"line\">  company: <span class=\"string\">''</span>,</span><br><span class=\"line\">  education: <span class=\"string\">''</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure><hr><blockquote><p>*ngIf</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"contact.workStatus=='3'; else education\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"company\"</span>&gt;</span>Company Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"company\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.company\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ng-template</span> #<span class=\"attr\">education</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"education\"</span>&gt;</span>Education<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"education\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.education\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">placeholder</span>=<span class=\"string\">\"Education\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Vemos incrustado en HTML el tpico <em>if else</em> de la programacin estructurada. Quiz llame la atencin la manera de tratar el <em>else</em>. Por ahora digamos que aquellos nodos del rbol que no tienen garantizada su existencia deben recogerse dentro de un elemento propio del Angular, las <code>ng-template</code>.</p><p>Otra directiva smbolo que merece la pena mencionar es el <code>#</code>. Acta como un identificador que una vez aplicado a un elemento se puede usar para acceder a el desde cualquier parte del componente.</p><p>En resumen:</p><blockquote><p>if <strong>condition</strong> else <strong>template</strong></p></blockquote><blockquote><blockquote><p>tambin hay <em>*ngSwitch</em></p></blockquote></blockquote><hr><h1 id=\"4-Modelo-y-controlador\"><a href=\"#4-Modelo-y-controlador\" class=\"headerlink\" title=\"4. Modelo y controlador\"></a>4. Modelo y controlador</h1><p>Este punto nu es de Angular propiamente, pero s del lenguaje que han escogido para que desarrollemos nuestras apps: el <strong>TypeScript</strong>.</p><p>Es como un cruce entre <em>JavaScript</em> y <em>Java</em> o <em>C#</em>. Digamos que le aporta tipos estticos y mejoras en cuanto expresividad si queremos usar clases o una programacin ms orientada a objetos. Es un lenguaje de ayuda al programador. Realmente puedes usar sintaxis pura de JavaScript, porque el typeScript es JavaScript con anotaciones de opcionales de tipos.</p><p>Angular viene ya con las herramientas y configuraciones necesarias para <em>transpilar</em> el TypeScript a JavaScript.</p><h2 id=\"4-1-Interfaces-y-modelos\"><a href=\"#4-1-Interfaces-y-modelos\" class=\"headerlink\" title=\"4.1 Interfaces y modelos\"></a>4.1 Interfaces y modelos</h2><blockquote><p>Mejor interface que clase</p></blockquote><p>Se aconseja por una buena razn. Las interfaces en JavaScript no existen. As, mientras desarrollamos nos ayuda con <em>intellisense</em> y noes protegen de asignaciones indebidas. Pero, en ejecucin no pesan porque no tienen contrapartida.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Option &#123;</span><br><span class=\"line\">  id: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  description: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Contact &#123;</span><br><span class=\"line\">  name: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  isVIP: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  gender: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  workStatus: <span class=\"built_in\">number</span> | <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  company: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  education: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>tipos compuestos <code>number | string</code></p></blockquote><p>Este es un lenguaje que realmente slo aplica mientras desarrollas. As que permite hacer diabluras con los tipos.</p><p>Se usan para tipificar las propiedades</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses: Option[] = [</span><br><span class=\"line\">    &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">  ];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact: Contact = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">''</span>,</span><br><span class=\"line\">    isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">    workStatus: <span class=\"number\">0</span>,</span><br><span class=\"line\">    company: <span class=\"string\">''</span>,</span><br><span class=\"line\">    education: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"><span class=\"keyword\">public</span> contacts: Contact[] = [];</span><br></pre></td></tr></table></figure><h2 id=\"4-2-ViewModel-en-el-controlador\"><a href=\"#4-2-ViewModel-en-el-controlador\" class=\"headerlink\" title=\"4.2 ViewModel en el controlador\"></a>4.2 ViewModel en el controlador</h2><p>El controlador del componente es una clase. Por tanto tiene no solo propiedades, sino tambin mtodos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">saveContact() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts.push(&#123; ...this.contact &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.updateCounter();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> updateCounter() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.numberOfContacts = <span class=\"keyword\">this</span>.contacts.length;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.counterClass = <span class=\"keyword\">this</span>.numberOfContacts === <span class=\"number\">0</span> ? <span class=\"string\">'warning'</span> : <span class=\"string\">'success'</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Los mtodos pblicos pueden, y deben, ser invocados desde las vistas. De forma que las expresiones asignadas a los eventos sean simples llamadas a mtodos para que hagan el trabajo sucio.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Save\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"saveContact()\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"OnInit\"><a href=\"#OnInit\" class=\"headerlink\" title=\"OnInit\"></a>OnInit</h3><p>Ya hemos visto que en TypeScript, las clases puede implementar interfaces. Angular nos facilita unos cuantos para usar como <em>hooks</em> en determinados momentos dl ciclo de vida de una componente.</p><p>En particular hay uno que ya vienen pre implementado por el generador del CLI. Se llama <code>OnInit</code> y obliga a disponer de un mtodo pblico llamado <code>ngOnInit()</code>. Lo que programes dentro ser ejecutado durante la inicializacin del componente.</p><p>Es una prctica recomendable usar ese mtodo en lugar del constructor para desplegar nuestra lgica de inicio. La razn es que el constructor se ejecuta antes de la existencia completa de la vista y eso puede generar inconsistencias.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses: Option[];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact: Contact;</span><br><span class=\"line\"><span class=\"keyword\">public</span> contacts: Contact[];</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.workStatuses = [</span><br><span class=\"line\">    &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">  ];</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contact = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">''</span>,</span><br><span class=\"line\">    isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">    workStatus: <span class=\"number\">0</span>,</span><br><span class=\"line\">    company: <span class=\"string\">''</span>,</span><br><span class=\"line\">    education: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts = [];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h3 id=\"Repasamos\"><a href=\"#Repasamos\" class=\"headerlink\" title=\"Repasamos\"></a>Repasamos</h3><p>Agregamos una funcionalidad que nos obliga a repasar todo lo aprendido. Un listado en el que mostrar los contactos que se recogen del formulario.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"contacts.length&gt;0; else empty\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let contact of contacts\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; contact.name &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Delete\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"deleteContact(contact)\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ng-template</span> #<span class=\"attr\">empty</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>No contacts yet<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deleteContact(contact: Contact) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts = <span class=\"keyword\">this</span>.contacts.filter(<span class=\"function\"><span class=\"params\">c</span> =&gt;</span> c.name !== contact.name);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.updateCounter();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Mira el cdigo completo de <strong>la clase</strong> <code>ContactsComponent</code>en el fichero <code>contacts.component.ts</code> para tener una visin completa del componente. Como ves, <strong>las propiedades</strong> <code>header, numberOfContacts, formHidden, contacts ...</code> se corresponden con las utilizadas en las directivas de enlace en la vista. Mientras que <strong>los mtodos</strong> <code>saveContact(), deleteContact()</code> son invocados desde eventos de elementos del <em>html</em>.</p><p>Juntos, <strong>la vista y su clase controladora</strong>, resuelven un problema de interaccin con el usuario <strong>creando un componente</strong>. Todas las pginas que disees sern variaciones y composiciones de estos componentes.</p><blockquote><p>Y esto es slo el comienzo. La idea de componente ser fundamental en la web del maana para la creacin de pginas mediante <code>web components</code>. Pero eso ya se ver ms adelante</p></blockquote><p>Ahora tienes una aplicacin en <em>Angular 9</em> que recoge y muestra datos. Sigue esta serie para aadirle <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a> mientras aprendes a programar con Angular8. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Flujo de datos entre componentes Angular","date":"2020-04-16T14:10:44.000Z","thumbnail":"/css/images/angular-4_flow.png","_content":"![flujo-de-datos-entre-componentes-angular](/images/tutorial-angular-4_flow.png)\n\nLos desarrollos profesionales son complicados pero **con Angular tenemos soluciones de comunicacin simples para pantallas complejas**. Mediante el desarrollo de componentes atmicos y reutilizables Angular 9 favorece la implementacin de buenas prcticas.\n\nCrear y comunicar muchos componentes puede llevarnos a cdigo difcil de seguir. La librera `@angular/forms` ofrece *tuberas de comunicacin* para **mantener el flujo de datos bajo control**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/). Al finalizar tendrs una aplicacin que reparte la responsabilidad de recoger y presentar datos en componentes.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n\n# 1. Comunicacin entre componentes\n\nLas aplicaciones web en las que destaca Angular suelen ser complejas y con mucha variedad funcional en diversas pginas. A menudo esas pginas estn repletas de formularios, informes y botones. La solucin viene de mano del viejo principio _divide y vencers_: **La componentizacin**\n\n## 1.1. Necesidad de comunicacin\n\nEl _framework_ permite y recomienda repartir el trabajo en mltiples componentes de responsabilidad nica. Tambin es prctica comn el crear pginas especficas para situaciones concretas aunque relacionadas. Por supuesto que estructuras como el men de navegacin o secciones de estado general necesitan conocer datos provenientes de las pginas. Nada est completamente asilado. Esto nos enfrenta la problema de **comunicar componentes**.\n\n## 1.2. Escenarios\n\nLas situaciones que te encontrars caern en alguna de estas tres categoras para las que hay soluciones especficas.\n\n### Comunicar componentes acoplados\nSolemos empezar creando un componente por pgina. Pero es normal que esa pgina se complique y la solucin a la complejidad es la **divisin en componentes y reparto de responsabilidades**. Dado que estn en una misma pgina existe cierto acoplamiento entre ellos y eso nos facilitar la comunicacin.\n\n### Comunicar componentes en pginas distintas\nCuando los componentes se cargan en rutas distintas ya no hay forma de comunicarlos directamente. Pero lo resolveremos fcilmente **usando las capacidades del router.**\n\n### Comunicar componentes entre estructuras dinmicas\nLa situacin ms compleja se da cuando queremos comunicar componentes o servicios desacoplados pero sin cambio de pgina. En este caso har falta un **mediador observable**.\n\n\n# 2. El patrn Contendor / Presentadores\n\nEn **arquitectura de software** cuando encontramos una solucin a un problema recurrente le ponemos un nombre y tratamos de utilizarlo siempre que podemos. Obviamente es una eleccin del programador y siempre tiene un coste que debe valorar. Aqu la ventaja buscada es claramente una: **el reparto de responsabilidades**.\n\n## 2.1 El patrn\n\nEn este caso **el patrn contenedor/presentadores** estipula que haya un nico componente responsable de obtener, mutar y guardar el estado. Ser el componente contenedor. Los presentadores sern responsables de.. ejem, presentar la informacin y los elementos de interaccin con el usuario. Las ventajas derivadas son: mayor facilidad para el _testeo_ y mayores posibilidades de reutilizacin de presentadores.\n\n> A este patrn a veces se le conoce como _parent/children_ por la jerarqua HTML que genera.\n\nVeamos una implementacin sencilla. Haremos una interfaz mnima para simular el manejo de un coche. Habr pedales de aceleracin y freno, y un cuadro dnde se refleje la velocidad. Para todo ello vamos a usa el _Angular CLI_ y crear un mdulo y sus componentes base.\n\n```console\nng g m car --route car --module app-routing.module\nng g c car/car/display-presenter\nng g c car/car/pedals-presenter\n```\n\n## 2.2 El contenedor\n\nEn el componente contenedor tendremos **una vista muy sencilla y un controlador ms complejo**. La vista solamente ser la composicin de los componentes presentadores, pero el controlador tendr que obtener datos, aplicarles lgica de negocio y guardarlos cuando corresponda.\n\n> No es habitual asignarle un sufijo al nombre del componente para indicar que es el contenedor. Suele ser suficiente el verlo en la raz de la jerarqua de carpetas.\n\n```html\n<ab-display-presenter [model]=\"car.name\"\n                      [currentSpeed]=\"car.currentSpeed\"\n                      [topSpeed]=\"car.maxSpeed\"\n                      [units]=\"'Km/h'\">\n</ab-display-presenter>\n<ab-pedals-presenter (brake)=\"onBrake($event)\"\n                     [brakeDisabled]=\"disableBrake\"\n                     (throttle)=\"onThrottle($event)\"\n                     [throttleDisabled]=\"disableThrottle\">\n</ab-pedals-presenter>\n```\n\nObviamente este HTML visto as an no ser funcional. Por supuesto, los componentes presentadores existen, pero... Qu son esos atributos tan raros?\n\nVemos que usa los componentes presentadores `DisplayPresenter` y `PedalsPresenter` envindoles informacin y suscribindose a sus eventos. Concretaremos esta funcionalidad ms adelante.\n\nAhora sigamos en la parte lgica de nuestro componente contenedor. Es la clase controlador y se ocupa de obtener y manipular los datos.\n\n```typescript\nexport class CarComponent implements OnInit {\n  car: CarModel;\n  disableBrake: boolean;\n  disableThrottle: boolean;\n\n  constructor() {}\n\n  ngOnInit(): void {\n    this.car = { name: 'Roadster', maxSpeed: 120, currentSpeed: 0 };\n    this.checkLimits();\n  }\n  onBrake(drive: number) {\n    this.car.currentSpeed -= this.getDelta(drive);\n    this.checkLimits();\n  }\n  onThrottle(drive: number) {\n    this.car.currentSpeed += this.getDelta(drive);\n    this.checkLimits();\n  }\n\n  private getDelta = (drive: number) => drive + (this.car.maxSpeed - this.car.currentSpeed) / 10;\n  private checkLimits() {\n    this.disableBrake = false;\n    this.disableThrottle = false;\n    if (this.car.currentSpeed <= 0) {\n      this.car.currentSpeed = 0;\n      this.disableBrake = true;\n    } else if (this.car.currentSpeed >= this.car.maxSpeed) {\n      this.car.currentSpeed = this.car.maxSpeed;\n      this.disableThrottle = true;\n    }\n  }\n}\n```\n\nLo dicho, _la clase controladora del componente contenedor retiene el grueso de la funcionalidad_. En este caso inicializar una instancia de un coche y mantener sus velocidad en los lmites lgicos respondiendo a las acciones del usuario conductor.\n\n\n## 2.3 Envo hacia el presentador con @Input()\n\nEsta comunicacin _hacia abajo_ enva la informacin **desde el contenedor hacia el presentador**. Es similar a como una plantilla recibe la informacin desde el controlador.\n\n\n### @Input()\n\nPara que una vista muestre datos tiene que usar directivas como `{{ model }}` asociada a una propiedad pblica de la clase componente. Se supone que dicha clase es la responsable de su valor. Pero tambin puede **recibirlo desde el exterior**. La novedad es hacer que lo reciba va *html*.\n\n```html\n<h3> {{ model }} </h3>\n<h4> Top speed: {{ topSpeed | number:'1.0-0' }}</h4>\n<div>\n  <div [ngClass]=\"getSpeedClass()\">\n    {{ currentSpeed | number:'1.2-2' }} {{ units }}\n  </div>\n  <progress [value]=\"currentSpeed\"\n            [max]=\"topSpeed\">\n  </progress>\n</div>\n```\n\n\nEmpieza por decorar con `@Input()` la propiedad que quieres usar desde fuera. Por ejemplo un cdigo como este del archivo `display.component.ts`.\n\n```typescript\nexport class DisplayPresenterComponent implements OnInit {\n  @Input() model: string;\n  @Input() currentSpeed: number;\n  @Input() topSpeed: number;\n  @Input() units: string;\n\n  constructor() {}\n\n  ngOnInit(): void {}\n\n  getSpeedClass = () => (this.currentSpeed < this.getThreshold() ? 'good' : 'warning');\n\n  private getThreshold = () => this.topSpeed * 0.8;\n}\n```\n\nAhora puedes enviarle datos a este componente desde el *html* de su consumidor. Por ejemplo desde `car.component.html` le puedo enviar una variable o cualquier expresin evaluable. Recordemos como usa `[propiedad]=\"expresion\"` en el elemento presentador.\n\n```html\n<ab-display-presenter [model]=\"car.name\"\n                      [currentSpeed]=\"car.currentSpeed\"\n                      [topSpeed]=\"car.maxSpeed\"\n                      [units]=\"'Km/h'\">\n</ab-display-presenter>\n```\n\nEn la clase controladora del presentador quedan responsabilidades reducidas a temas especficos como determinar las clases _css_ apropiadas o transformar los datos para su presentacin.\n\nEstoy usando al componente de nivel inferior como un presentador; mientras que el contenedor superior acta como controlador. Este mismo patrn puede y debe repetirse hasta **descomponer las vistas en estructuras ridculamente simples** que nos eviten repeticiones absurdas en cdigo.\n\nDe esta forma es fcil crear componentes reutilizables; y queda muy limpio el **envo de datos hacia abajo**. Pero, y hacia arriba?.\n\n\n## 2.4. Respuesta del presentador con @Output()\n\nLos componentes de nivel inferior no slo se dedican a presentar datos, tambin presentan controles. Con ellos el usuario podr crear, modificar o eliminar los datos que quiera. Aunque no directamente; para hacerlo **comunican el cambio requerido al contenedor de nivel superior**.\n\n### @Output()\n\nPor ejemplo, el componente `PedalsComponent` permite acelerar y frenar. Bueno, realmente permite que el usuario diga que lo quiere hacer; los cambios se harn ms arriba. Veamos lo bsico del `pedals.component.html` antes de nada:\n\n```html\n<h4> Pedals: </h4>\n<form>\n  <input value=\"brake \"\n         class=\"secondary\"\n         type=\"button\"\n         [disabled]=\"brakeDisabled\"\n         (click)=\"brake.emit(1)\" />\n  <input value=\"throttle \"\n         class=\"tertiary\"\n         type=\"button\"\n         [disabled]=\"throttleDisabled\"\n         (click)=\"throttle.emit(1)\" />\n</form>\n```\n\nClaramente son un par de botones que con el evento `(click)` responden a acciones del usuario. En este caso se manifiesta una intencin de acelerar o frenar el coche. Pero el mtodo del controlador no acta directamente sobre los datos.\n\n> Si lo hiciera sera ms difcil gestionar los cambios e imposibilitara el uso de inmutables o tcnicas ms avanzadas de programacin que se vern ms adelante...\n\nEn su lugar, lo que hace es **emitir un evento** confiando que alguien lo reciba y acte en consecuencia. Por ejemplo la emisin de la instruccin de frenado se realiza mediante la propiedad `brake` decorada con `@Output() brake = new EventEmitter<number>();`. Dicha propiedad ser una instancia de un emisor de eventos que mediante el mtodo `.next()` va a emitir la seal de frenado hacia arriba.\n\n```typescript\nexport class PedalsPresenterComponent implements OnInit {\n  @Input() brakeDisabled: boolean;\n  @Input() throttleDisabled: boolean;\n  @Output() brake = new EventEmitter<number>();\n  @Output() throttle = new EventEmitter<number>();\n\n  constructor() {}\n\n  ngOnInit(): void {}\n}\n```\n\nMientras tanto, **en el contenedor la vista se subscribe al evento** `(brake)` como si este fuese un evento nativo y llama a los mtodos que manipulan los datos de verdad.\n\n```html\n<ab-pedals-presenter (brake)=\"onBrake($event)\"\n                     [brakeDisabled]=\"disableBrake\"\n                     (throttle)=\"onThrottle($event)\"\n                     [throttleDisabled]=\"disableThrottle\">\n</ab-pedals-presenter>\n```\n\nLas propiedades *output* tambin pueden enviar argumentos que sern recibidos mediante el identificador `$event` propio del framework. Se declaran especificando el tipo del argumento en el genrico del constructor de `EventEmitter<any>`.\n\n\nEn el controlador ya podemos operar con los datos. El mtodo `onBrake(drive: number)` accede y modifica el valor de la velocidad y lo notifica automticamente hacia abajo.\n\nDe esta manera se cierra el crculo. Los componentes de bajo nivel pueden **recibir datos para ser presentados o emitir eventos para modificarlos**. El componente de nivel superior es el **nico responsable de obtener y actuar** sobre los datos.\n\n\n# 3. Comunicaciones entre pginas o estructuras\n\n## 3.1 Comunicacin entre distintas pginas\n\nEn las aplicaciones hay **comunicaciones de estado ms all de la pgina actual**. La comunicacin entre pginas es responsabilidad del `@angular/router`. Una vez activada una ruta, el sistema carga un componente en el `<router-outlet>` correspondiente. No hay forma de comunicarse hacia _(arriba) o [abajo]_ con algo desconocido. De una pgina a otra tampoco es problema pues la comunicacin va mediante los parmetros de la *url*.\n\nYa hemos usado esta comunicacin anteriormente en el tema [2-spa](../paginas-y-rutas-angular-spa/) el componente `CoursesComponent` es capaz de recibir por parmetros una identificacin de un autor. Esa informacin es el resultado de una accin del usuario en otra pantalla programada en el componente `HomeComponent`. Por tanto es una comunicacin entre componentes que viven en pginas distintas, visto desde muy arriba es una situacin en la que ambos son *controladores hermanos*.\n\n> Desde luego habr que mejorar el acceso y control de los datos que por ahora es muy rudimentario. Lo haremos en prximos pasos. Primero mediante  [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/) y despus usando [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/)\n\n## 2.2 Comunicacin entre estructuras desacopladas\n\nAn estando en la misma ruta, no siempre se podrn conocer los componentes, por ejemplo el `HeaderComponent` nunca podr acceder al `PedalsPresenterComponent`; y por tanto no se podrn usar sus `[propiedades] y (eventos)`\n\n### 2.2.1 El layout principal y los componentes por rutas o pginas.\n\nEsta es una situacin habitual, quieres **comunicar la vista de negocio activa con elementos generales** de la pgina. Por ejemplo podras querer mostrar la velocidad mxima alcanzada en la barra del men o un un mensaje emergente cada vez que se alcance la velocidad lmite. En este caso, el `<router-outlet>` es una barrera que impide usar el patrn contenedor-presentador pues no se puede predecir el contenido dinmico que carga el `RouterOutlet`.\n\n### 2.2.2 Mltiples niveles de presentadores.\n\nCuando las pantallas se hacen realmente complejas empiezan a surgir **rboles de componentes** de muchos niveles de profundidad. En estas situaciones mantener un nico controlador a nivel raz es poco prctico. Enviar hacia abajo las `[propiedades]` es tedioso, pero peor an es hacer burbujear los `(eventos)` por varias capas de presentadores.\n\nLa solucin en ambos casos pasa por permitir que *algunos componentes presentadores tengan su propio control de datos*. Este tipo de comunicaciones tcnicamente se resuelve mediante *Observables* y merece un captulo especial que se ver ms adelante en esta serie. Incluso en situaciones complejas habr que optar por patrones avanzados de gestin de estado como pueda ser *Redux*.\n\nPor ahora tienes una aplicacin en *Angular* que comunica datos y cambios entre componentes de una misma pgina. Sigue el tutorial para aadirle [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/) mientras aprendes a programar con Angular 8. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","source":"_posts/ng-4-Flujo-de-datos-entre-componentes-Angular.md","raw":"---\ntitle: Flujo de datos entre componentes Angular\npermalink: flujo-de-datos-entre-componentes-angular\ndate: 2020-04-16 16:10:44\ntags:\n- Angular\n- Components\n- Tutorial\n- Introduccin\n- Angular9\n- Angular2\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-4_flow.png\n---\n![flujo-de-datos-entre-componentes-angular](/images/tutorial-angular-4_flow.png)\n\nLos desarrollos profesionales son complicados pero **con Angular tenemos soluciones de comunicacin simples para pantallas complejas**. Mediante el desarrollo de componentes atmicos y reutilizables Angular 9 favorece la implementacin de buenas prcticas.\n\nCrear y comunicar muchos componentes puede llevarnos a cdigo difcil de seguir. La librera `@angular/forms` ofrece *tuberas de comunicacin* para **mantener el flujo de datos bajo control**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/). Al finalizar tendrs una aplicacin que reparte la responsabilidad de recoger y presentar datos en componentes.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n\n# 1. Comunicacin entre componentes\n\nLas aplicaciones web en las que destaca Angular suelen ser complejas y con mucha variedad funcional en diversas pginas. A menudo esas pginas estn repletas de formularios, informes y botones. La solucin viene de mano del viejo principio _divide y vencers_: **La componentizacin**\n\n## 1.1. Necesidad de comunicacin\n\nEl _framework_ permite y recomienda repartir el trabajo en mltiples componentes de responsabilidad nica. Tambin es prctica comn el crear pginas especficas para situaciones concretas aunque relacionadas. Por supuesto que estructuras como el men de navegacin o secciones de estado general necesitan conocer datos provenientes de las pginas. Nada est completamente asilado. Esto nos enfrenta la problema de **comunicar componentes**.\n\n## 1.2. Escenarios\n\nLas situaciones que te encontrars caern en alguna de estas tres categoras para las que hay soluciones especficas.\n\n### Comunicar componentes acoplados\nSolemos empezar creando un componente por pgina. Pero es normal que esa pgina se complique y la solucin a la complejidad es la **divisin en componentes y reparto de responsabilidades**. Dado que estn en una misma pgina existe cierto acoplamiento entre ellos y eso nos facilitar la comunicacin.\n\n### Comunicar componentes en pginas distintas\nCuando los componentes se cargan en rutas distintas ya no hay forma de comunicarlos directamente. Pero lo resolveremos fcilmente **usando las capacidades del router.**\n\n### Comunicar componentes entre estructuras dinmicas\nLa situacin ms compleja se da cuando queremos comunicar componentes o servicios desacoplados pero sin cambio de pgina. En este caso har falta un **mediador observable**.\n\n\n# 2. El patrn Contendor / Presentadores\n\nEn **arquitectura de software** cuando encontramos una solucin a un problema recurrente le ponemos un nombre y tratamos de utilizarlo siempre que podemos. Obviamente es una eleccin del programador y siempre tiene un coste que debe valorar. Aqu la ventaja buscada es claramente una: **el reparto de responsabilidades**.\n\n## 2.1 El patrn\n\nEn este caso **el patrn contenedor/presentadores** estipula que haya un nico componente responsable de obtener, mutar y guardar el estado. Ser el componente contenedor. Los presentadores sern responsables de.. ejem, presentar la informacin y los elementos de interaccin con el usuario. Las ventajas derivadas son: mayor facilidad para el _testeo_ y mayores posibilidades de reutilizacin de presentadores.\n\n> A este patrn a veces se le conoce como _parent/children_ por la jerarqua HTML que genera.\n\nVeamos una implementacin sencilla. Haremos una interfaz mnima para simular el manejo de un coche. Habr pedales de aceleracin y freno, y un cuadro dnde se refleje la velocidad. Para todo ello vamos a usa el _Angular CLI_ y crear un mdulo y sus componentes base.\n\n```console\nng g m car --route car --module app-routing.module\nng g c car/car/display-presenter\nng g c car/car/pedals-presenter\n```\n\n## 2.2 El contenedor\n\nEn el componente contenedor tendremos **una vista muy sencilla y un controlador ms complejo**. La vista solamente ser la composicin de los componentes presentadores, pero el controlador tendr que obtener datos, aplicarles lgica de negocio y guardarlos cuando corresponda.\n\n> No es habitual asignarle un sufijo al nombre del componente para indicar que es el contenedor. Suele ser suficiente el verlo en la raz de la jerarqua de carpetas.\n\n```html\n<ab-display-presenter [model]=\"car.name\"\n                      [currentSpeed]=\"car.currentSpeed\"\n                      [topSpeed]=\"car.maxSpeed\"\n                      [units]=\"'Km/h'\">\n</ab-display-presenter>\n<ab-pedals-presenter (brake)=\"onBrake($event)\"\n                     [brakeDisabled]=\"disableBrake\"\n                     (throttle)=\"onThrottle($event)\"\n                     [throttleDisabled]=\"disableThrottle\">\n</ab-pedals-presenter>\n```\n\nObviamente este HTML visto as an no ser funcional. Por supuesto, los componentes presentadores existen, pero... Qu son esos atributos tan raros?\n\nVemos que usa los componentes presentadores `DisplayPresenter` y `PedalsPresenter` envindoles informacin y suscribindose a sus eventos. Concretaremos esta funcionalidad ms adelante.\n\nAhora sigamos en la parte lgica de nuestro componente contenedor. Es la clase controlador y se ocupa de obtener y manipular los datos.\n\n```typescript\nexport class CarComponent implements OnInit {\n  car: CarModel;\n  disableBrake: boolean;\n  disableThrottle: boolean;\n\n  constructor() {}\n\n  ngOnInit(): void {\n    this.car = { name: 'Roadster', maxSpeed: 120, currentSpeed: 0 };\n    this.checkLimits();\n  }\n  onBrake(drive: number) {\n    this.car.currentSpeed -= this.getDelta(drive);\n    this.checkLimits();\n  }\n  onThrottle(drive: number) {\n    this.car.currentSpeed += this.getDelta(drive);\n    this.checkLimits();\n  }\n\n  private getDelta = (drive: number) => drive + (this.car.maxSpeed - this.car.currentSpeed) / 10;\n  private checkLimits() {\n    this.disableBrake = false;\n    this.disableThrottle = false;\n    if (this.car.currentSpeed <= 0) {\n      this.car.currentSpeed = 0;\n      this.disableBrake = true;\n    } else if (this.car.currentSpeed >= this.car.maxSpeed) {\n      this.car.currentSpeed = this.car.maxSpeed;\n      this.disableThrottle = true;\n    }\n  }\n}\n```\n\nLo dicho, _la clase controladora del componente contenedor retiene el grueso de la funcionalidad_. En este caso inicializar una instancia de un coche y mantener sus velocidad en los lmites lgicos respondiendo a las acciones del usuario conductor.\n\n\n## 2.3 Envo hacia el presentador con @Input()\n\nEsta comunicacin _hacia abajo_ enva la informacin **desde el contenedor hacia el presentador**. Es similar a como una plantilla recibe la informacin desde el controlador.\n\n\n### @Input()\n\nPara que una vista muestre datos tiene que usar directivas como `{{ model }}` asociada a una propiedad pblica de la clase componente. Se supone que dicha clase es la responsable de su valor. Pero tambin puede **recibirlo desde el exterior**. La novedad es hacer que lo reciba va *html*.\n\n```html\n<h3> {{ model }} </h3>\n<h4> Top speed: {{ topSpeed | number:'1.0-0' }}</h4>\n<div>\n  <div [ngClass]=\"getSpeedClass()\">\n    {{ currentSpeed | number:'1.2-2' }} {{ units }}\n  </div>\n  <progress [value]=\"currentSpeed\"\n            [max]=\"topSpeed\">\n  </progress>\n</div>\n```\n\n\nEmpieza por decorar con `@Input()` la propiedad que quieres usar desde fuera. Por ejemplo un cdigo como este del archivo `display.component.ts`.\n\n```typescript\nexport class DisplayPresenterComponent implements OnInit {\n  @Input() model: string;\n  @Input() currentSpeed: number;\n  @Input() topSpeed: number;\n  @Input() units: string;\n\n  constructor() {}\n\n  ngOnInit(): void {}\n\n  getSpeedClass = () => (this.currentSpeed < this.getThreshold() ? 'good' : 'warning');\n\n  private getThreshold = () => this.topSpeed * 0.8;\n}\n```\n\nAhora puedes enviarle datos a este componente desde el *html* de su consumidor. Por ejemplo desde `car.component.html` le puedo enviar una variable o cualquier expresin evaluable. Recordemos como usa `[propiedad]=\"expresion\"` en el elemento presentador.\n\n```html\n<ab-display-presenter [model]=\"car.name\"\n                      [currentSpeed]=\"car.currentSpeed\"\n                      [topSpeed]=\"car.maxSpeed\"\n                      [units]=\"'Km/h'\">\n</ab-display-presenter>\n```\n\nEn la clase controladora del presentador quedan responsabilidades reducidas a temas especficos como determinar las clases _css_ apropiadas o transformar los datos para su presentacin.\n\nEstoy usando al componente de nivel inferior como un presentador; mientras que el contenedor superior acta como controlador. Este mismo patrn puede y debe repetirse hasta **descomponer las vistas en estructuras ridculamente simples** que nos eviten repeticiones absurdas en cdigo.\n\nDe esta forma es fcil crear componentes reutilizables; y queda muy limpio el **envo de datos hacia abajo**. Pero, y hacia arriba?.\n\n\n## 2.4. Respuesta del presentador con @Output()\n\nLos componentes de nivel inferior no slo se dedican a presentar datos, tambin presentan controles. Con ellos el usuario podr crear, modificar o eliminar los datos que quiera. Aunque no directamente; para hacerlo **comunican el cambio requerido al contenedor de nivel superior**.\n\n### @Output()\n\nPor ejemplo, el componente `PedalsComponent` permite acelerar y frenar. Bueno, realmente permite que el usuario diga que lo quiere hacer; los cambios se harn ms arriba. Veamos lo bsico del `pedals.component.html` antes de nada:\n\n```html\n<h4> Pedals: </h4>\n<form>\n  <input value=\"brake \"\n         class=\"secondary\"\n         type=\"button\"\n         [disabled]=\"brakeDisabled\"\n         (click)=\"brake.emit(1)\" />\n  <input value=\"throttle \"\n         class=\"tertiary\"\n         type=\"button\"\n         [disabled]=\"throttleDisabled\"\n         (click)=\"throttle.emit(1)\" />\n</form>\n```\n\nClaramente son un par de botones que con el evento `(click)` responden a acciones del usuario. En este caso se manifiesta una intencin de acelerar o frenar el coche. Pero el mtodo del controlador no acta directamente sobre los datos.\n\n> Si lo hiciera sera ms difcil gestionar los cambios e imposibilitara el uso de inmutables o tcnicas ms avanzadas de programacin que se vern ms adelante...\n\nEn su lugar, lo que hace es **emitir un evento** confiando que alguien lo reciba y acte en consecuencia. Por ejemplo la emisin de la instruccin de frenado se realiza mediante la propiedad `brake` decorada con `@Output() brake = new EventEmitter<number>();`. Dicha propiedad ser una instancia de un emisor de eventos que mediante el mtodo `.next()` va a emitir la seal de frenado hacia arriba.\n\n```typescript\nexport class PedalsPresenterComponent implements OnInit {\n  @Input() brakeDisabled: boolean;\n  @Input() throttleDisabled: boolean;\n  @Output() brake = new EventEmitter<number>();\n  @Output() throttle = new EventEmitter<number>();\n\n  constructor() {}\n\n  ngOnInit(): void {}\n}\n```\n\nMientras tanto, **en el contenedor la vista se subscribe al evento** `(brake)` como si este fuese un evento nativo y llama a los mtodos que manipulan los datos de verdad.\n\n```html\n<ab-pedals-presenter (brake)=\"onBrake($event)\"\n                     [brakeDisabled]=\"disableBrake\"\n                     (throttle)=\"onThrottle($event)\"\n                     [throttleDisabled]=\"disableThrottle\">\n</ab-pedals-presenter>\n```\n\nLas propiedades *output* tambin pueden enviar argumentos que sern recibidos mediante el identificador `$event` propio del framework. Se declaran especificando el tipo del argumento en el genrico del constructor de `EventEmitter<any>`.\n\n\nEn el controlador ya podemos operar con los datos. El mtodo `onBrake(drive: number)` accede y modifica el valor de la velocidad y lo notifica automticamente hacia abajo.\n\nDe esta manera se cierra el crculo. Los componentes de bajo nivel pueden **recibir datos para ser presentados o emitir eventos para modificarlos**. El componente de nivel superior es el **nico responsable de obtener y actuar** sobre los datos.\n\n\n# 3. Comunicaciones entre pginas o estructuras\n\n## 3.1 Comunicacin entre distintas pginas\n\nEn las aplicaciones hay **comunicaciones de estado ms all de la pgina actual**. La comunicacin entre pginas es responsabilidad del `@angular/router`. Una vez activada una ruta, el sistema carga un componente en el `<router-outlet>` correspondiente. No hay forma de comunicarse hacia _(arriba) o [abajo]_ con algo desconocido. De una pgina a otra tampoco es problema pues la comunicacin va mediante los parmetros de la *url*.\n\nYa hemos usado esta comunicacin anteriormente en el tema [2-spa](../paginas-y-rutas-angular-spa/) el componente `CoursesComponent` es capaz de recibir por parmetros una identificacin de un autor. Esa informacin es el resultado de una accin del usuario en otra pantalla programada en el componente `HomeComponent`. Por tanto es una comunicacin entre componentes que viven en pginas distintas, visto desde muy arriba es una situacin en la que ambos son *controladores hermanos*.\n\n> Desde luego habr que mejorar el acceso y control de los datos que por ahora es muy rudimentario. Lo haremos en prximos pasos. Primero mediante  [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/) y despus usando [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/)\n\n## 2.2 Comunicacin entre estructuras desacopladas\n\nAn estando en la misma ruta, no siempre se podrn conocer los componentes, por ejemplo el `HeaderComponent` nunca podr acceder al `PedalsPresenterComponent`; y por tanto no se podrn usar sus `[propiedades] y (eventos)`\n\n### 2.2.1 El layout principal y los componentes por rutas o pginas.\n\nEsta es una situacin habitual, quieres **comunicar la vista de negocio activa con elementos generales** de la pgina. Por ejemplo podras querer mostrar la velocidad mxima alcanzada en la barra del men o un un mensaje emergente cada vez que se alcance la velocidad lmite. En este caso, el `<router-outlet>` es una barrera que impide usar el patrn contenedor-presentador pues no se puede predecir el contenido dinmico que carga el `RouterOutlet`.\n\n### 2.2.2 Mltiples niveles de presentadores.\n\nCuando las pantallas se hacen realmente complejas empiezan a surgir **rboles de componentes** de muchos niveles de profundidad. En estas situaciones mantener un nico controlador a nivel raz es poco prctico. Enviar hacia abajo las `[propiedades]` es tedioso, pero peor an es hacer burbujear los `(eventos)` por varias capas de presentadores.\n\nLa solucin en ambos casos pasa por permitir que *algunos componentes presentadores tengan su propio control de datos*. Este tipo de comunicaciones tcnicamente se resuelve mediante *Observables* y merece un captulo especial que se ver ms adelante en esta serie. Incluso en situaciones complejas habr que optar por patrones avanzados de gestin de estado como pueda ser *Redux*.\n\nPor ahora tienes una aplicacin en *Angular* que comunica datos y cambios entre componentes de una misma pgina. Sigue el tutorial para aadirle [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/) mientras aprendes a programar con Angular 8. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","slug":"flujo-de-datos-entre-componentes-angular","published":1,"updated":"2020-04-16T12:06:06.435Z","_id":"ck70mab1p000ubss3xcqml524","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-4_flow.png\" alt=\"flujo-de-datos-entre-componentes-angular\"></p><p>Los desarrollos profesionales son complicados pero <strong>con Angular tenemos soluciones de comunicacin simples para pantallas complejas</strong>. Mediante el desarrollo de componentes atmicos y reutilizables Angular 9 favorece la implementacin de buenas prcticas.</p><p>Crear y comunicar muchos componentes puede llevarnos a cdigo difcil de seguir. La librera <code>@angular/forms</code> ofrece <em>tuberas de comunicacin</em> para <strong>mantener el flujo de datos bajo control</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a>. Al finalizar tendrs una aplicacin que reparte la responsabilidad de recoger y presentar datos en componentes.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Comunicacion-entre-componentes\"><a href=\"#1-Comunicacion-entre-componentes\" class=\"headerlink\" title=\"1. Comunicacin entre componentes\"></a>1. Comunicacin entre componentes</h1><p>Las aplicaciones web en las que destaca Angular suelen ser complejas y con mucha variedad funcional en diversas pginas. A menudo esas pginas estn repletas de formularios, informes y botones. La solucin viene de mano del viejo principio <em>divide y vencers</em>: <strong>La componentizacin</strong></p><h2 id=\"1-1-Necesidad-de-comunicacion\"><a href=\"#1-1-Necesidad-de-comunicacion\" class=\"headerlink\" title=\"1.1. Necesidad de comunicacin\"></a>1.1. Necesidad de comunicacin</h2><p>El <em>framework</em> permite y recomienda repartir el trabajo en mltiples componentes de responsabilidad nica. Tambin es prctica comn el crear pginas especficas para situaciones concretas aunque relacionadas. Por supuesto que estructuras como el men de navegacin o secciones de estado general necesitan conocer datos provenientes de las pginas. Nada est completamente asilado. Esto nos enfrenta la problema de <strong>comunicar componentes</strong>.</p><h2 id=\"1-2-Escenarios\"><a href=\"#1-2-Escenarios\" class=\"headerlink\" title=\"1.2. Escenarios\"></a>1.2. Escenarios</h2><p>Las situaciones que te encontrars caern en alguna de estas tres categoras para las que hay soluciones especficas.</p><h3 id=\"Comunicar-componentes-acoplados\"><a href=\"#Comunicar-componentes-acoplados\" class=\"headerlink\" title=\"Comunicar componentes acoplados\"></a>Comunicar componentes acoplados</h3><p>Solemos empezar creando un componente por pgina. Pero es normal que esa pgina se complique y la solucin a la complejidad es la <strong>divisin en componentes y reparto de responsabilidades</strong>. Dado que estn en una misma pgina existe cierto acoplamiento entre ellos y eso nos facilitar la comunicacin.</p><h3 id=\"Comunicar-componentes-en-paginas-distintas\"><a href=\"#Comunicar-componentes-en-paginas-distintas\" class=\"headerlink\" title=\"Comunicar componentes en pginas distintas\"></a>Comunicar componentes en pginas distintas</h3><p>Cuando los componentes se cargan en rutas distintas ya no hay forma de comunicarlos directamente. Pero lo resolveremos fcilmente <strong>usando las capacidades del router.</strong></p><h3 id=\"Comunicar-componentes-entre-estructuras-dinamicas\"><a href=\"#Comunicar-componentes-entre-estructuras-dinamicas\" class=\"headerlink\" title=\"Comunicar componentes entre estructuras dinmicas\"></a>Comunicar componentes entre estructuras dinmicas</h3><p>La situacin ms compleja se da cuando queremos comunicar componentes o servicios desacoplados pero sin cambio de pgina. En este caso har falta un <strong>mediador observable</strong>.</p><h1 id=\"2-El-patron-Contendor-Presentadores\"><a href=\"#2-El-patron-Contendor-Presentadores\" class=\"headerlink\" title=\"2. El patrn Contendor / Presentadores\"></a>2. El patrn Contendor / Presentadores</h1><p>En <strong>arquitectura de software</strong> cuando encontramos una solucin a un problema recurrente le ponemos un nombre y tratamos de utilizarlo siempre que podemos. Obviamente es una eleccin del programador y siempre tiene un coste que debe valorar. Aqu la ventaja buscada es claramente una: <strong>el reparto de responsabilidades</strong>.</p><h2 id=\"2-1-El-patron\"><a href=\"#2-1-El-patron\" class=\"headerlink\" title=\"2.1 El patrn\"></a>2.1 El patrn</h2><p>En este caso <strong>el patrn contenedor/presentadores</strong> estipula que haya un nico componente responsable de obtener, mutar y guardar el estado. Ser el componente contenedor. Los presentadores sern responsables de.. ejem, presentar la informacin y los elementos de interaccin con el usuario. Las ventajas derivadas son: mayor facilidad para el <em>testeo</em> y mayores posibilidades de reutilizacin de presentadores.</p><blockquote><p>A este patrn a veces se le conoce como <em>parent/children</em> por la jerarqua HTML que genera.</p></blockquote><p>Veamos una implementacin sencilla. Haremos una interfaz mnima para simular el manejo de un coche. Habr pedales de aceleracin y freno, y un cuadro dnde se refleje la velocidad. Para todo ello vamos a usa el <em>Angular CLI</em> y crear un mdulo y sus componentes base.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m car --route car --module app-routing.module</span><br><span class=\"line\">ng g c car/car/display-presenter</span><br><span class=\"line\">ng g c car/car/pedals-presenter</span><br></pre></td></tr></table></figure><h2 id=\"2-2-El-contenedor\"><a href=\"#2-2-El-contenedor\" class=\"headerlink\" title=\"2.2 El contenedor\"></a>2.2 El contenedor</h2><p>En el componente contenedor tendremos <strong>una vista muy sencilla y un controlador ms complejo</strong>. La vista solamente ser la composicin de los componentes presentadores, pero el controlador tendr que obtener datos, aplicarles lgica de negocio y guardarlos cuando corresponda.</p><blockquote><p>No es habitual asignarle un sufijo al nombre del componente para indicar que es el contenedor. Suele ser suficiente el verlo en la raz de la jerarqua de carpetas.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-display-presenter</span> [<span class=\"attr\">model</span>]=<span class=\"string\">\"car.name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">currentSpeed</span>]=<span class=\"string\">\"car.currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">topSpeed</span>]=<span class=\"string\">\"car.maxSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">units</span>]=<span class=\"string\">\"'Km/h'\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ab-display-presenter</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-pedals-presenter</span> (<span class=\"attr\">brake</span>)=<span class=\"string\">\"onBrake($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     [<span class=\"attr\">brakeDisabled</span>]=<span class=\"string\">\"disableBrake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     (<span class=\"attr\">throttle</span>)=<span class=\"string\">\"onThrottle($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     [<span class=\"attr\">throttleDisabled</span>]=<span class=\"string\">\"disableThrottle\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ab-pedals-presenter</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Obviamente este HTML visto as an no ser funcional. Por supuesto, los componentes presentadores existen, pero Qu son esos atributos tan raros?</p><p>Vemos que usa los componentes presentadores <code>DisplayPresenter</code> y <code>PedalsPresenter</code> envindoles informacin y suscribindose a sus eventos. Concretaremos esta funcionalidad ms adelante.</p><p>Ahora sigamos en la parte lgica de nuestro componente contenedor. Es la clase controlador y se ocupa de obtener y manipular los datos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CarComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  car: CarModel;</span><br><span class=\"line\">  disableBrake: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  disableThrottle: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit(): <span class=\"built_in\">void</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.car = &#123; name: <span class=\"string\">'Roadster'</span>, maxSpeed: <span class=\"number\">120</span>, currentSpeed: <span class=\"number\">0</span> &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  onBrake(drive: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.car.currentSpeed -= <span class=\"keyword\">this</span>.getDelta(drive);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  onThrottle(drive: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.car.currentSpeed += <span class=\"keyword\">this</span>.getDelta(drive);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> getDelta = <span class=\"function\">(<span class=\"params\">drive: <span class=\"built_in\">number</span></span>) =&gt;</span> drive + (<span class=\"keyword\">this</span>.car.maxSpeed - <span class=\"keyword\">this</span>.car.currentSpeed) / <span class=\"number\">10</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> checkLimits() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.disableBrake = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.disableThrottle = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.car.currentSpeed &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.car.currentSpeed = <span class=\"number\">0</span>;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.disableBrake = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.car.currentSpeed &gt;= <span class=\"keyword\">this</span>.car.maxSpeed) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.car.currentSpeed = <span class=\"keyword\">this</span>.car.maxSpeed;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.disableThrottle = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Lo dicho, <em>la clase controladora del componente contenedor retiene el grueso de la funcionalidad</em>. En este caso inicializar una instancia de un coche y mantener sus velocidad en los lmites lgicos respondiendo a las acciones del usuario conductor.</p><h2 id=\"2-3-Envio-hacia-el-presentador-con-Input\"><a href=\"#2-3-Envio-hacia-el-presentador-con-Input\" class=\"headerlink\" title=\"2.3 Envo hacia el presentador con @Input()\"></a>2.3 Envo hacia el presentador con @Input()</h2><p>Esta comunicacin <em>hacia abajo</em> enva la informacin <strong>desde el contenedor hacia el presentador</strong>. Es similar a como una plantilla recibe la informacin desde el controlador.</p><h3 id=\"Input\"><a href=\"#Input\" class=\"headerlink\" title=\"@Input()\"></a>@Input()</h3><p>Para que una vista muestre datos tiene que usar directivas como <code></code> asociada a una propiedad pblica de la clase componente. Se supone que dicha clase es la responsable de su valor. Pero tambin puede <strong>recibirlo desde el exterior</strong>. La novedad es hacer que lo reciba va <em>html</em>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> &#123;&#123; model &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span> Top speed: &#123;&#123; topSpeed | number:'1.0-0' &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">ngClass</span>]=<span class=\"string\">\"getSpeedClass()\"</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; currentSpeed | number:'1.2-2' &#125;&#125; &#123;&#123; units &#125;&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">progress</span> [<span class=\"attr\">value</span>]=<span class=\"string\">\"currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">max</span>]=<span class=\"string\">\"topSpeed\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">progress</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Empieza por decorar con <code>@Input()</code> la propiedad que quieres usar desde fuera. Por ejemplo un cdigo como este del archivo <code>display.component.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> DisplayPresenterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() model: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() currentSpeed: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() topSpeed: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() units: <span class=\"built_in\">string</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit(): <span class=\"built_in\">void</span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  getSpeedClass = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> (<span class=\"keyword\">this</span>.currentSpeed &lt; <span class=\"keyword\">this</span>.getThreshold() ? <span class=\"string\">'good'</span> : <span class=\"string\">'warning'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> getThreshold = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.topSpeed * <span class=\"number\">0.8</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora puedes enviarle datos a este componente desde el <em>html</em> de su consumidor. Por ejemplo desde <code>car.component.html</code> le puedo enviar una variable o cualquier expresin evaluable. Recordemos como usa <code>[propiedad]=&quot;expresion&quot;</code> en el elemento presentador.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-display-presenter</span> [<span class=\"attr\">model</span>]=<span class=\"string\">\"car.name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">currentSpeed</span>]=<span class=\"string\">\"car.currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">topSpeed</span>]=<span class=\"string\">\"car.maxSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">units</span>]=<span class=\"string\">\"'Km/h'\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ab-display-presenter</span>&gt;</span></span><br></pre></td></tr></table></figure><p>En la clase controladora del presentador quedan responsabilidades reducidas a temas especficos como determinar las clases <em>css</em> apropiadas o transformar los datos para su presentacin.</p><p>Estoy usando al componente de nivel inferior como un presentador; mientras que el contenedor superior acta como controlador. Este mismo patrn puede y debe repetirse hasta <strong>descomponer las vistas en estructuras ridculamente simples</strong> que nos eviten repeticiones absurdas en cdigo.</p><p>De esta forma es fcil crear componentes reutilizables; y queda muy limpio el <strong>envo de datos hacia abajo</strong>. Pero, y hacia arriba?.</p><h2 id=\"2-4-Respuesta-del-presentador-con-Output\"><a href=\"#2-4-Respuesta-del-presentador-con-Output\" class=\"headerlink\" title=\"2.4. Respuesta del presentador con @Output()\"></a>2.4. Respuesta del presentador con @Output()</h2><p>Los componentes de nivel inferior no slo se dedican a presentar datos, tambin presentan controles. Con ellos el usuario podr crear, modificar o eliminar los datos que quiera. Aunque no directamente; para hacerlo <strong>comunican el cambio requerido al contenedor de nivel superior</strong>.</p><h3 id=\"Output\"><a href=\"#Output\" class=\"headerlink\" title=\"@Output()\"></a>@Output()</h3><p>Por ejemplo, el componente <code>PedalsComponent</code> permite acelerar y frenar. Bueno, realmente permite que el usuario diga que lo quiere hacer; los cambios se harn ms arriba. Veamos lo bsico del <code>pedals.component.html</code> antes de nada:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span> Pedals: <span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"brake \"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">class</span>=<span class=\"string\">\"secondary\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"brakeDisabled\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         (<span class=\"attr\">click</span>)=<span class=\"string\">\"brake.emit(1)\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"throttle \"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">class</span>=<span class=\"string\">\"tertiary\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"throttleDisabled\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         (<span class=\"attr\">click</span>)=<span class=\"string\">\"throttle.emit(1)\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Claramente son un par de botones que con el evento <code>(click)</code> responden a acciones del usuario. En este caso se manifiesta una intencin de acelerar o frenar el coche. Pero el mtodo del controlador no acta directamente sobre los datos.</p><blockquote><p>Si lo hiciera sera ms difcil gestionar los cambios e imposibilitara el uso de inmutables o tcnicas ms avanzadas de programacin que se vern ms adelante</p></blockquote><p>En su lugar, lo que hace es <strong>emitir un evento</strong> confiando que alguien lo reciba y acte en consecuencia. Por ejemplo la emisin de la instruccin de frenado se realiza mediante la propiedad <code>brake</code> decorada con <code>@Output() brake = new EventEmitter&lt;number&gt;();</code>. Dicha propiedad ser una instancia de un emisor de eventos que mediante el mtodo <code>.next()</code> va a emitir la seal de frenado hacia arriba.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> PedalsPresenterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() brakeDisabled: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() throttleDisabled: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Output</span>() brake = <span class=\"keyword\">new</span> EventEmitter&lt;<span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\">  <span class=\"meta\">@Output</span>() throttle = <span class=\"keyword\">new</span> EventEmitter&lt;<span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit(): <span class=\"built_in\">void</span> &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Mientras tanto, <strong>en el contenedor la vista se subscribe al evento</strong> <code>(brake)</code> como si este fuese un evento nativo y llama a los mtodos que manipulan los datos de verdad.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-pedals-presenter</span> (<span class=\"attr\">brake</span>)=<span class=\"string\">\"onBrake($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     [<span class=\"attr\">brakeDisabled</span>]=<span class=\"string\">\"disableBrake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     (<span class=\"attr\">throttle</span>)=<span class=\"string\">\"onThrottle($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     [<span class=\"attr\">throttleDisabled</span>]=<span class=\"string\">\"disableThrottle\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ab-pedals-presenter</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Las propiedades <em>output</em> tambin pueden enviar argumentos que sern recibidos mediante el identificador <code>$event</code> propio del framework. Se declaran especificando el tipo del argumento en el genrico del constructor de <code>EventEmitter&lt;any&gt;</code>.</p><p>En el controlador ya podemos operar con los datos. El mtodo <code>onBrake(drive: number)</code> accede y modifica el valor de la velocidad y lo notifica automticamente hacia abajo.</p><p>De esta manera se cierra el crculo. Los componentes de bajo nivel pueden <strong>recibir datos para ser presentados o emitir eventos para modificarlos</strong>. El componente de nivel superior es el <strong>nico responsable de obtener y actuar</strong> sobre los datos.</p><h1 id=\"3-Comunicaciones-entre-paginas-o-estructuras\"><a href=\"#3-Comunicaciones-entre-paginas-o-estructuras\" class=\"headerlink\" title=\"3. Comunicaciones entre pginas o estructuras\"></a>3. Comunicaciones entre pginas o estructuras</h1><h2 id=\"3-1-Comunicacion-entre-distintas-paginas\"><a href=\"#3-1-Comunicacion-entre-distintas-paginas\" class=\"headerlink\" title=\"3.1 Comunicacin entre distintas pginas\"></a>3.1 Comunicacin entre distintas pginas</h2><p>En las aplicaciones hay <strong>comunicaciones de estado ms all de la pgina actual</strong>. La comunicacin entre pginas es responsabilidad del <code>@angular/router</code>. Una vez activada una ruta, el sistema carga un componente en el <code>&lt;router-outlet&gt;</code> correspondiente. No hay forma de comunicarse hacia <em>(arriba) o [abajo]</em> con algo desconocido. De una pgina a otra tampoco es problema pues la comunicacin va mediante los parmetros de la <em>url</em>.</p><p>Ya hemos usado esta comunicacin anteriormente en el tema <a href=\"../paginas-y-rutas-angular-spa/\">2-spa</a> el componente <code>CoursesComponent</code> es capaz de recibir por parmetros una identificacin de un autor. Esa informacin es el resultado de una accin del usuario en otra pantalla programada en el componente <code>HomeComponent</code>. Por tanto es una comunicacin entre componentes que viven en pginas distintas, visto desde muy arriba es una situacin en la que ambos son <em>controladores hermanos</em>.</p><blockquote><p>Desde luego habr que mejorar el acceso y control de los datos que por ahora es muy rudimentario. Lo haremos en prximos pasos. Primero mediante <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a> y despus usando <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a></p></blockquote><h2 id=\"2-2-Comunicacion-entre-estructuras-desacopladas\"><a href=\"#2-2-Comunicacion-entre-estructuras-desacopladas\" class=\"headerlink\" title=\"2.2 Comunicacin entre estructuras desacopladas\"></a>2.2 Comunicacin entre estructuras desacopladas</h2><p>An estando en la misma ruta, no siempre se podrn conocer los componentes, por ejemplo el <code>HeaderComponent</code> nunca podr acceder al <code>PedalsPresenterComponent</code>; y por tanto no se podrn usar sus <code>[propiedades] y (eventos)</code></p><h3 id=\"2-2-1-El-layout-principal-y-los-componentes-por-rutas-o-paginas\"><a href=\"#2-2-1-El-layout-principal-y-los-componentes-por-rutas-o-paginas\" class=\"headerlink\" title=\"2.2.1 El layout principal y los componentes por rutas o pginas.\"></a>2.2.1 El layout principal y los componentes por rutas o pginas.</h3><p>Esta es una situacin habitual, quieres <strong>comunicar la vista de negocio activa con elementos generales</strong> de la pgina. Por ejemplo podras querer mostrar la velocidad mxima alcanzada en la barra del men o un un mensaje emergente cada vez que se alcance la velocidad lmite. En este caso, el <code>&lt;router-outlet&gt;</code> es una barrera que impide usar el patrn contenedor-presentador pues no se puede predecir el contenido dinmico que carga el <code>RouterOutlet</code>.</p><h3 id=\"2-2-2-Multiples-niveles-de-presentadores\"><a href=\"#2-2-2-Multiples-niveles-de-presentadores\" class=\"headerlink\" title=\"2.2.2 Mltiples niveles de presentadores.\"></a>2.2.2 Mltiples niveles de presentadores.</h3><p>Cuando las pantallas se hacen realmente complejas empiezan a surgir <strong>rboles de componentes</strong> de muchos niveles de profundidad. En estas situaciones mantener un nico controlador a nivel raz es poco prctico. Enviar hacia abajo las <code>[propiedades]</code> es tedioso, pero peor an es hacer burbujear los <code>(eventos)</code> por varias capas de presentadores.</p><p>La solucin en ambos casos pasa por permitir que <em>algunos componentes presentadores tengan su propio control de datos</em>. Este tipo de comunicaciones tcnicamente se resuelve mediante <em>Observables</em> y merece un captulo especial que se ver ms adelante en esta serie. Incluso en situaciones complejas habr que optar por patrones avanzados de gestin de estado como pueda ser <em>Redux</em>.</p><p>Por ahora tienes una aplicacin en <em>Angular</em> que comunica datos y cambios entre componentes de una misma pgina. Sigue el tutorial para aadirle <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a> mientras aprendes a programar con Angular 8. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-4_flow.png\" alt=\"flujo-de-datos-entre-componentes-angular\"></p><p>Los desarrollos profesionales son complicados pero <strong>con Angular tenemos soluciones de comunicacin simples para pantallas complejas</strong>. Mediante el desarrollo de componentes atmicos y reutilizables Angular 9 favorece la implementacin de buenas prcticas.</p><p>Crear y comunicar muchos componentes puede llevarnos a cdigo difcil de seguir. La librera <code>@angular/forms</code> ofrece <em>tuberas de comunicacin</em> para <strong>mantener el flujo de datos bajo control</strong>.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a>. Al finalizar tendrs una aplicacin que reparte la responsabilidad de recoger y presentar datos en componentes.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Comunicacion-entre-componentes\"><a href=\"#1-Comunicacion-entre-componentes\" class=\"headerlink\" title=\"1. Comunicacin entre componentes\"></a>1. Comunicacin entre componentes</h1><p>Las aplicaciones web en las que destaca Angular suelen ser complejas y con mucha variedad funcional en diversas pginas. A menudo esas pginas estn repletas de formularios, informes y botones. La solucin viene de mano del viejo principio <em>divide y vencers</em>: <strong>La componentizacin</strong></p><h2 id=\"1-1-Necesidad-de-comunicacion\"><a href=\"#1-1-Necesidad-de-comunicacion\" class=\"headerlink\" title=\"1.1. Necesidad de comunicacin\"></a>1.1. Necesidad de comunicacin</h2><p>El <em>framework</em> permite y recomienda repartir el trabajo en mltiples componentes de responsabilidad nica. Tambin es prctica comn el crear pginas especficas para situaciones concretas aunque relacionadas. Por supuesto que estructuras como el men de navegacin o secciones de estado general necesitan conocer datos provenientes de las pginas. Nada est completamente asilado. Esto nos enfrenta la problema de <strong>comunicar componentes</strong>.</p><h2 id=\"1-2-Escenarios\"><a href=\"#1-2-Escenarios\" class=\"headerlink\" title=\"1.2. Escenarios\"></a>1.2. Escenarios</h2><p>Las situaciones que te encontrars caern en alguna de estas tres categoras para las que hay soluciones especficas.</p><h3 id=\"Comunicar-componentes-acoplados\"><a href=\"#Comunicar-componentes-acoplados\" class=\"headerlink\" title=\"Comunicar componentes acoplados\"></a>Comunicar componentes acoplados</h3><p>Solemos empezar creando un componente por pgina. Pero es normal que esa pgina se complique y la solucin a la complejidad es la <strong>divisin en componentes y reparto de responsabilidades</strong>. Dado que estn en una misma pgina existe cierto acoplamiento entre ellos y eso nos facilitar la comunicacin.</p><h3 id=\"Comunicar-componentes-en-paginas-distintas\"><a href=\"#Comunicar-componentes-en-paginas-distintas\" class=\"headerlink\" title=\"Comunicar componentes en pginas distintas\"></a>Comunicar componentes en pginas distintas</h3><p>Cuando los componentes se cargan en rutas distintas ya no hay forma de comunicarlos directamente. Pero lo resolveremos fcilmente <strong>usando las capacidades del router.</strong></p><h3 id=\"Comunicar-componentes-entre-estructuras-dinamicas\"><a href=\"#Comunicar-componentes-entre-estructuras-dinamicas\" class=\"headerlink\" title=\"Comunicar componentes entre estructuras dinmicas\"></a>Comunicar componentes entre estructuras dinmicas</h3><p>La situacin ms compleja se da cuando queremos comunicar componentes o servicios desacoplados pero sin cambio de pgina. En este caso har falta un <strong>mediador observable</strong>.</p><h1 id=\"2-El-patron-Contendor-Presentadores\"><a href=\"#2-El-patron-Contendor-Presentadores\" class=\"headerlink\" title=\"2. El patrn Contendor / Presentadores\"></a>2. El patrn Contendor / Presentadores</h1><p>En <strong>arquitectura de software</strong> cuando encontramos una solucin a un problema recurrente le ponemos un nombre y tratamos de utilizarlo siempre que podemos. Obviamente es una eleccin del programador y siempre tiene un coste que debe valorar. Aqu la ventaja buscada es claramente una: <strong>el reparto de responsabilidades</strong>.</p><h2 id=\"2-1-El-patron\"><a href=\"#2-1-El-patron\" class=\"headerlink\" title=\"2.1 El patrn\"></a>2.1 El patrn</h2><p>En este caso <strong>el patrn contenedor/presentadores</strong> estipula que haya un nico componente responsable de obtener, mutar y guardar el estado. Ser el componente contenedor. Los presentadores sern responsables de.. ejem, presentar la informacin y los elementos de interaccin con el usuario. Las ventajas derivadas son: mayor facilidad para el <em>testeo</em> y mayores posibilidades de reutilizacin de presentadores.</p><blockquote><p>A este patrn a veces se le conoce como <em>parent/children</em> por la jerarqua HTML que genera.</p></blockquote><p>Veamos una implementacin sencilla. Haremos una interfaz mnima para simular el manejo de un coche. Habr pedales de aceleracin y freno, y un cuadro dnde se refleje la velocidad. Para todo ello vamos a usa el <em>Angular CLI</em> y crear un mdulo y sus componentes base.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m car --route car --module app-routing.module</span><br><span class=\"line\">ng g c car/car/display-presenter</span><br><span class=\"line\">ng g c car/car/pedals-presenter</span><br></pre></td></tr></table></figure><h2 id=\"2-2-El-contenedor\"><a href=\"#2-2-El-contenedor\" class=\"headerlink\" title=\"2.2 El contenedor\"></a>2.2 El contenedor</h2><p>En el componente contenedor tendremos <strong>una vista muy sencilla y un controlador ms complejo</strong>. La vista solamente ser la composicin de los componentes presentadores, pero el controlador tendr que obtener datos, aplicarles lgica de negocio y guardarlos cuando corresponda.</p><blockquote><p>No es habitual asignarle un sufijo al nombre del componente para indicar que es el contenedor. Suele ser suficiente el verlo en la raz de la jerarqua de carpetas.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-display-presenter</span> [<span class=\"attr\">model</span>]=<span class=\"string\">\"car.name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">currentSpeed</span>]=<span class=\"string\">\"car.currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">topSpeed</span>]=<span class=\"string\">\"car.maxSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">units</span>]=<span class=\"string\">\"'Km/h'\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ab-display-presenter</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-pedals-presenter</span> (<span class=\"attr\">brake</span>)=<span class=\"string\">\"onBrake($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     [<span class=\"attr\">brakeDisabled</span>]=<span class=\"string\">\"disableBrake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     (<span class=\"attr\">throttle</span>)=<span class=\"string\">\"onThrottle($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     [<span class=\"attr\">throttleDisabled</span>]=<span class=\"string\">\"disableThrottle\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ab-pedals-presenter</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Obviamente este HTML visto as an no ser funcional. Por supuesto, los componentes presentadores existen, pero Qu son esos atributos tan raros?</p><p>Vemos que usa los componentes presentadores <code>DisplayPresenter</code> y <code>PedalsPresenter</code> envindoles informacin y suscribindose a sus eventos. Concretaremos esta funcionalidad ms adelante.</p><p>Ahora sigamos en la parte lgica de nuestro componente contenedor. Es la clase controlador y se ocupa de obtener y manipular los datos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CarComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  car: CarModel;</span><br><span class=\"line\">  disableBrake: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  disableThrottle: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit(): <span class=\"built_in\">void</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.car = &#123; name: <span class=\"string\">'Roadster'</span>, maxSpeed: <span class=\"number\">120</span>, currentSpeed: <span class=\"number\">0</span> &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  onBrake(drive: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.car.currentSpeed -= <span class=\"keyword\">this</span>.getDelta(drive);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  onThrottle(drive: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.car.currentSpeed += <span class=\"keyword\">this</span>.getDelta(drive);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> getDelta = <span class=\"function\">(<span class=\"params\">drive: <span class=\"built_in\">number</span></span>) =&gt;</span> drive + (<span class=\"keyword\">this</span>.car.maxSpeed - <span class=\"keyword\">this</span>.car.currentSpeed) / <span class=\"number\">10</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> checkLimits() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.disableBrake = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.disableThrottle = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.car.currentSpeed &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.car.currentSpeed = <span class=\"number\">0</span>;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.disableBrake = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.car.currentSpeed &gt;= <span class=\"keyword\">this</span>.car.maxSpeed) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.car.currentSpeed = <span class=\"keyword\">this</span>.car.maxSpeed;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.disableThrottle = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Lo dicho, <em>la clase controladora del componente contenedor retiene el grueso de la funcionalidad</em>. En este caso inicializar una instancia de un coche y mantener sus velocidad en los lmites lgicos respondiendo a las acciones del usuario conductor.</p><h2 id=\"2-3-Envio-hacia-el-presentador-con-Input\"><a href=\"#2-3-Envio-hacia-el-presentador-con-Input\" class=\"headerlink\" title=\"2.3 Envo hacia el presentador con @Input()\"></a>2.3 Envo hacia el presentador con @Input()</h2><p>Esta comunicacin <em>hacia abajo</em> enva la informacin <strong>desde el contenedor hacia el presentador</strong>. Es similar a como una plantilla recibe la informacin desde el controlador.</p><h3 id=\"Input\"><a href=\"#Input\" class=\"headerlink\" title=\"@Input()\"></a>@Input()</h3><p>Para que una vista muestre datos tiene que usar directivas como <code></code> asociada a una propiedad pblica de la clase componente. Se supone que dicha clase es la responsable de su valor. Pero tambin puede <strong>recibirlo desde el exterior</strong>. La novedad es hacer que lo reciba va <em>html</em>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> &#123;&#123; model &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span> Top speed: &#123;&#123; topSpeed | number:'1.0-0' &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">ngClass</span>]=<span class=\"string\">\"getSpeedClass()\"</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; currentSpeed | number:'1.2-2' &#125;&#125; &#123;&#123; units &#125;&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">progress</span> [<span class=\"attr\">value</span>]=<span class=\"string\">\"currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">max</span>]=<span class=\"string\">\"topSpeed\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">progress</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Empieza por decorar con <code>@Input()</code> la propiedad que quieres usar desde fuera. Por ejemplo un cdigo como este del archivo <code>display.component.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> DisplayPresenterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() model: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() currentSpeed: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() topSpeed: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() units: <span class=\"built_in\">string</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit(): <span class=\"built_in\">void</span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  getSpeedClass = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> (<span class=\"keyword\">this</span>.currentSpeed &lt; <span class=\"keyword\">this</span>.getThreshold() ? <span class=\"string\">'good'</span> : <span class=\"string\">'warning'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> getThreshold = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.topSpeed * <span class=\"number\">0.8</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora puedes enviarle datos a este componente desde el <em>html</em> de su consumidor. Por ejemplo desde <code>car.component.html</code> le puedo enviar una variable o cualquier expresin evaluable. Recordemos como usa <code>[propiedad]=&quot;expresion&quot;</code> en el elemento presentador.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-display-presenter</span> [<span class=\"attr\">model</span>]=<span class=\"string\">\"car.name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">currentSpeed</span>]=<span class=\"string\">\"car.currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">topSpeed</span>]=<span class=\"string\">\"car.maxSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      [<span class=\"attr\">units</span>]=<span class=\"string\">\"'Km/h'\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ab-display-presenter</span>&gt;</span></span><br></pre></td></tr></table></figure><p>En la clase controladora del presentador quedan responsabilidades reducidas a temas especficos como determinar las clases <em>css</em> apropiadas o transformar los datos para su presentacin.</p><p>Estoy usando al componente de nivel inferior como un presentador; mientras que el contenedor superior acta como controlador. Este mismo patrn puede y debe repetirse hasta <strong>descomponer las vistas en estructuras ridculamente simples</strong> que nos eviten repeticiones absurdas en cdigo.</p><p>De esta forma es fcil crear componentes reutilizables; y queda muy limpio el <strong>envo de datos hacia abajo</strong>. Pero, y hacia arriba?.</p><h2 id=\"2-4-Respuesta-del-presentador-con-Output\"><a href=\"#2-4-Respuesta-del-presentador-con-Output\" class=\"headerlink\" title=\"2.4. Respuesta del presentador con @Output()\"></a>2.4. Respuesta del presentador con @Output()</h2><p>Los componentes de nivel inferior no slo se dedican a presentar datos, tambin presentan controles. Con ellos el usuario podr crear, modificar o eliminar los datos que quiera. Aunque no directamente; para hacerlo <strong>comunican el cambio requerido al contenedor de nivel superior</strong>.</p><h3 id=\"Output\"><a href=\"#Output\" class=\"headerlink\" title=\"@Output()\"></a>@Output()</h3><p>Por ejemplo, el componente <code>PedalsComponent</code> permite acelerar y frenar. Bueno, realmente permite que el usuario diga que lo quiere hacer; los cambios se harn ms arriba. Veamos lo bsico del <code>pedals.component.html</code> antes de nada:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span> Pedals: <span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"brake \"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">class</span>=<span class=\"string\">\"secondary\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"brakeDisabled\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         (<span class=\"attr\">click</span>)=<span class=\"string\">\"brake.emit(1)\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"throttle \"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">class</span>=<span class=\"string\">\"tertiary\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"throttleDisabled\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         (<span class=\"attr\">click</span>)=<span class=\"string\">\"throttle.emit(1)\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Claramente son un par de botones que con el evento <code>(click)</code> responden a acciones del usuario. En este caso se manifiesta una intencin de acelerar o frenar el coche. Pero el mtodo del controlador no acta directamente sobre los datos.</p><blockquote><p>Si lo hiciera sera ms difcil gestionar los cambios e imposibilitara el uso de inmutables o tcnicas ms avanzadas de programacin que se vern ms adelante</p></blockquote><p>En su lugar, lo que hace es <strong>emitir un evento</strong> confiando que alguien lo reciba y acte en consecuencia. Por ejemplo la emisin de la instruccin de frenado se realiza mediante la propiedad <code>brake</code> decorada con <code>@Output() brake = new EventEmitter&lt;number&gt;();</code>. Dicha propiedad ser una instancia de un emisor de eventos que mediante el mtodo <code>.next()</code> va a emitir la seal de frenado hacia arriba.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> PedalsPresenterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() brakeDisabled: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() throttleDisabled: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Output</span>() brake = <span class=\"keyword\">new</span> EventEmitter&lt;<span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\">  <span class=\"meta\">@Output</span>() throttle = <span class=\"keyword\">new</span> EventEmitter&lt;<span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit(): <span class=\"built_in\">void</span> &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Mientras tanto, <strong>en el contenedor la vista se subscribe al evento</strong> <code>(brake)</code> como si este fuese un evento nativo y llama a los mtodos que manipulan los datos de verdad.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-pedals-presenter</span> (<span class=\"attr\">brake</span>)=<span class=\"string\">\"onBrake($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     [<span class=\"attr\">brakeDisabled</span>]=<span class=\"string\">\"disableBrake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     (<span class=\"attr\">throttle</span>)=<span class=\"string\">\"onThrottle($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                     [<span class=\"attr\">throttleDisabled</span>]=<span class=\"string\">\"disableThrottle\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ab-pedals-presenter</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Las propiedades <em>output</em> tambin pueden enviar argumentos que sern recibidos mediante el identificador <code>$event</code> propio del framework. Se declaran especificando el tipo del argumento en el genrico del constructor de <code>EventEmitter&lt;any&gt;</code>.</p><p>En el controlador ya podemos operar con los datos. El mtodo <code>onBrake(drive: number)</code> accede y modifica el valor de la velocidad y lo notifica automticamente hacia abajo.</p><p>De esta manera se cierra el crculo. Los componentes de bajo nivel pueden <strong>recibir datos para ser presentados o emitir eventos para modificarlos</strong>. El componente de nivel superior es el <strong>nico responsable de obtener y actuar</strong> sobre los datos.</p><h1 id=\"3-Comunicaciones-entre-paginas-o-estructuras\"><a href=\"#3-Comunicaciones-entre-paginas-o-estructuras\" class=\"headerlink\" title=\"3. Comunicaciones entre pginas o estructuras\"></a>3. Comunicaciones entre pginas o estructuras</h1><h2 id=\"3-1-Comunicacion-entre-distintas-paginas\"><a href=\"#3-1-Comunicacion-entre-distintas-paginas\" class=\"headerlink\" title=\"3.1 Comunicacin entre distintas pginas\"></a>3.1 Comunicacin entre distintas pginas</h2><p>En las aplicaciones hay <strong>comunicaciones de estado ms all de la pgina actual</strong>. La comunicacin entre pginas es responsabilidad del <code>@angular/router</code>. Una vez activada una ruta, el sistema carga un componente en el <code>&lt;router-outlet&gt;</code> correspondiente. No hay forma de comunicarse hacia <em>(arriba) o [abajo]</em> con algo desconocido. De una pgina a otra tampoco es problema pues la comunicacin va mediante los parmetros de la <em>url</em>.</p><p>Ya hemos usado esta comunicacin anteriormente en el tema <a href=\"../paginas-y-rutas-angular-spa/\">2-spa</a> el componente <code>CoursesComponent</code> es capaz de recibir por parmetros una identificacin de un autor. Esa informacin es el resultado de una accin del usuario en otra pantalla programada en el componente <code>HomeComponent</code>. Por tanto es una comunicacin entre componentes que viven en pginas distintas, visto desde muy arriba es una situacin en la que ambos son <em>controladores hermanos</em>.</p><blockquote><p>Desde luego habr que mejorar el acceso y control de los datos que por ahora es muy rudimentario. Lo haremos en prximos pasos. Primero mediante <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a> y despus usando <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a></p></blockquote><h2 id=\"2-2-Comunicacion-entre-estructuras-desacopladas\"><a href=\"#2-2-Comunicacion-entre-estructuras-desacopladas\" class=\"headerlink\" title=\"2.2 Comunicacin entre estructuras desacopladas\"></a>2.2 Comunicacin entre estructuras desacopladas</h2><p>An estando en la misma ruta, no siempre se podrn conocer los componentes, por ejemplo el <code>HeaderComponent</code> nunca podr acceder al <code>PedalsPresenterComponent</code>; y por tanto no se podrn usar sus <code>[propiedades] y (eventos)</code></p><h3 id=\"2-2-1-El-layout-principal-y-los-componentes-por-rutas-o-paginas\"><a href=\"#2-2-1-El-layout-principal-y-los-componentes-por-rutas-o-paginas\" class=\"headerlink\" title=\"2.2.1 El layout principal y los componentes por rutas o pginas.\"></a>2.2.1 El layout principal y los componentes por rutas o pginas.</h3><p>Esta es una situacin habitual, quieres <strong>comunicar la vista de negocio activa con elementos generales</strong> de la pgina. Por ejemplo podras querer mostrar la velocidad mxima alcanzada en la barra del men o un un mensaje emergente cada vez que se alcance la velocidad lmite. En este caso, el <code>&lt;router-outlet&gt;</code> es una barrera que impide usar el patrn contenedor-presentador pues no se puede predecir el contenido dinmico que carga el <code>RouterOutlet</code>.</p><h3 id=\"2-2-2-Multiples-niveles-de-presentadores\"><a href=\"#2-2-2-Multiples-niveles-de-presentadores\" class=\"headerlink\" title=\"2.2.2 Mltiples niveles de presentadores.\"></a>2.2.2 Mltiples niveles de presentadores.</h3><p>Cuando las pantallas se hacen realmente complejas empiezan a surgir <strong>rboles de componentes</strong> de muchos niveles de profundidad. En estas situaciones mantener un nico controlador a nivel raz es poco prctico. Enviar hacia abajo las <code>[propiedades]</code> es tedioso, pero peor an es hacer burbujear los <code>(eventos)</code> por varias capas de presentadores.</p><p>La solucin en ambos casos pasa por permitir que <em>algunos componentes presentadores tengan su propio control de datos</em>. Este tipo de comunicaciones tcnicamente se resuelve mediante <em>Observables</em> y merece un captulo especial que se ver ms adelante en esta serie. Incluso en situaciones complejas habr que optar por patrones avanzados de gestin de estado como pueda ser <em>Redux</em>.</p><p>Por ahora tienes una aplicacin en <em>Angular</em> que comunica datos y cambios entre componentes de una misma pgina. Sigue el tutorial para aadirle <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a> mientras aprendes a programar con Angular 8. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Servicios inyectables en Angular","date":"2020-04-17T08:54:58.000Z","thumbnail":"/css/images/angular-5_inject.png","_content":"\n![servicios-inyectables-en-Angular](/images/tutorial-angular-5_inject.png)\n\nLa presentacin, la lgica y el manejo de datos son tres capas de abstraccin que usamos los programadores para mantener organizado nuestro cdigo. En Angular, la presentacin es cosa de los componentes. **La lgica y los datos tienen su lugar en servicios compartidos**.\n\nPara que los componentes consuman los servicios de forma controlada tenemos proveedores _inyectables_ en la librera `@angular/core` con los que realizar **la inyeccin de dependencias**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/). Al finalizar tendrs una aplicacin que comunica componentes entre pginas, reparte responsabilidades y gestiona claramente sus dependencias.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Inyeccin de dependencias\n\nComo casi todo en Angular, **los servicios son clases TypeScript**. Su propsito es contener lgica de negocio, clases para acceso a datos o utilidades de infraestructura. Estas clases son perfectamente instanciables desde cualquier otro fichero que las importe. Pero Angular nos sugiere y facilita que usemos su sistema de inyeccin de dependencias.\n\nEste sistema se basa en convenios y configuraciones que controlan la instancia concreta que ser inyectada al objeto dependiente. Ahora vers cmo funciona la **[Dependency Injection](https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias) en Angular**.\n\nComo demostracin vamos a trabajar con un par de utilidades para conversin de unidades. Crear un mdulo y un componente en el que visualizarlo.\n\n```shell\nng g m converter --route converter --module app-routing.module\n```\n\n## 1.1 Generacin de servicios\n\nLa particularidad de las clases de servicios est en su decorador: `@Injectable()`. Esta funcin viene en el `@angular/core` e **indica que esta clase puede ser inyectada** dinmicamente a quien la demande. Aunque es muy sencillo crearlos a mano, el CLI nos ofrece su comando especializado para crear servicios. Estos son ejemplos de instrucciones para crear un _service_.\n\n```shell\nng g s converter/calculator\n```\n\nEl resultado es el fichero `calculator.service.ts` con su decorador que toma una _class_ normal y produce algo _injectable_. Veamos una implementacin mnima:\n\n```typescript\n@Injectable({\n  providedIn: 'root',\n})\nexport class CalculatorService {\n  private milesPerKilometer = 0.62137;\n  private kilometersPerMile = 1.609;\n\n  constructor() {}\n\n  fromKilometersToMiles = (kilometers: number): number => kilometers * this.milesPerKilometer;\n  fromMilesToKilometers = (miles: number): number => miles * this.kilometersPerMile;\n}\n```\n\nAhora tienes centralizado en este servicio la lgica de datos que tenemos hasta el momento. Los dems componentes la podrn utilizar.\n\n## 1.2 Consumo de dependencias\n\nDeclarar y decorar la clase no es suficiente para poder reclamarla. Necesitas **registrarla como un proveedor en algn mdulo**. Desde Angular 6 los servicios se auto-proveen en el mdulo raz mediante la configuracin `providedIn: 'root'` de su decorador.\n\n> Esto es til y cmodo en una gran cantidad de casos. El mdulo raz es visible para toda la aplicacin de forma que cualquier componente puede reclamar un servicio suyo sin problema. Excepto que el problema sea el tamao. El mdulo raz se carga al arrancar y todas sus referencias van el _bundle_ principal. Si queremos repartir el peso debemos llevar ciertos servicios al mdulo funcional que los necesite.\n\nVamos a consumir este servicio en el `converter.component.ts`. Al consumo de los servicios inyectables se le conoce como _dependencia_. Cada componente o servicio puede **declarar en su constructor sus dependencias** hacia servicios inyectables. El convenio exige que se especifique el tipo esperado\n\n```typescript\nexport class ConverterComponent implements OnInit {\n  public kilometers = 0;\n  public miles: number;\n\n  constructor(private calculatorService: CalculatorService) {}\n\n  ngOnInit() {\n    this.convert();\n  }\n  convert() {\n    this.miles = this.calculatorService.fromKilometersToMiles(this.kilometers);\n  }\n}\n```\n\n> Agregar el modificador de alcance `private` o `public` en la declaracin de argumentos hace que _TypeScript_ genere una propiedad inicializada con el valor recibido. Es azcar sintctico para no tener que declarar la propiedad y asignarle el valor del argumento manualmente. En resumen, los [constructores en TypeScrip](https://kendaleiv.com/typescript-constructor-assignment-public-and-private-keywords/) admiten argumentos que transforman en propiedades. Mantenemos privado el `converterService` para evitar su uso desde la vista.\n\n```html\n<h2>Distance Converter.</h2>\n<h3>From Europe to USA</h3>\n<form>\n  <fieldset>\n    <section>\n      <label for=\"kilometers\">Kilometers</label>\n      <input name=\"kilometers\"\n             type=\"number\"\n             [(ngModel)]=\"kilometers\"\n             placeholder=\"0\" />\n    </section>\n  </fieldset>\n  <input value=\"Convert\"\n         type=\"button\"\n         (click)=\"convert()\" />\n</form>\n<section>\n  <h4>{{ miles | number:'1.2-2' }} miles</h4>\n</section>\n<a [routerLink]=\"['dynamic']\">Go to Abstract Culture Converter Sample</a>\n```\n\n# 2. Inversin del control\n\nUn concepto ntimamente relacionado con la inyeccin de dependencias es el de [**Inversion of Control**](https://en.wikipedia.org/wiki/Inversion_of_control). El componente dependiente expresa sus necesidades, pero es el _framework_ el que en ltima instancia decide lo que recibir. Vemos entonces que **el invocado cede el control al invocador**.\n\nCuando proveemos un servicio en Angular, el comportamiento por defecto es el de proveer un _singleton_ pero hay ms opciones. Si se usa el objeto `provider` con `useClass` , `useValue` y `useFactory` podemos controlar el proceso de inyeccin.\n\nSe crea un [_singleton_](https://es.wikipedia.org/wiki/Singleton) por cada mdulo en el que se provea un servicio. Normalmente si el servicio es para un slo mdulo funcional se provee en este y nada ms. Si va a ser compartido gana la opcin de auto proveerlo en el raz, garantizando as su disponibilidad en cualquier otro mdulo de la aplicacin.\n\nEn un mdulo cualquiera, siempre podramos agregar un servicio a su array de _providers_.\n\n```typescript\n@NgModule({\n  declarations: [...],\n  imports: [...],\n  providers: [ CalculatorService ]\n})\n```\n\nPero siempre ser **una instancia nica por mdulo**. Si un _singleton_ no es lo adecuado, entonces puedes proveer el mismo servicio en distintos mdulos. De esa forma se crear una instancia distinta para cada uno. Si se provee la misma clase en dos o ms mdulos se genera una instancia en cada uno de ellos. Los componentes recibirn la instancia del mdulo jerrquicamente ms cercano.\n\n> Incluso es posible usar el array `providers:[]` en la decoracin de un componente o de otro servicio. Haciendo as an ms granular la eleccin de instancia.\n\nVeamos un ejemplo extendiendo el problema del conversor de unidades de forma que se pueda escoger una **estrategia** de conversin en base a una cultura concreta. Para empezar necesitamos una interfaz, un servicio base que la implemente y un componente que lo consuma.\n\n```shell\nng g interface converter/dynamic-converter/culture-converter\nng g service converter/dynamic-converter/culture\nng g component converter/dynamic-converter/dynamic-converter\n```\n\n```typeScript\nexport interface CultureConverter {\n  sourceCulture: string;\n  targetCulture: string;\n  convertDistance: (source: number) => number;\n}\n```\n\n```typescript\nexport abstract class CultureService implements CultureConverter {\n  sourceCulture: string;\n  targetCulture: string;\n  convertDistance: (source: number) => number;\n\n  constructor() {}\n}\n```\n\n```typeScript\nexport class CultureConverterComponent implements OnInit {\n  public source: string;\n  public target: string;\n  public sourceUnits = 0;\n  public targetUnits: number;\n\n  constructor(private cultureService:CultureService){ }\n\n  public ngOnInit() {\n    this.source = this.cultureService.sourceCulture;\n    this.target = this.cultureService.targetCulture;\n    this.convert();\n  }\n  public convert() {\n    this.targetUnits = this.cultureService.convertDistance(this.sourceUnits);\n  }\n}\n```\n\n```html\n<h2>Culture Converter.</h2>\n<h3>From {{ source }} to {{ target }}</h3>\n<form>\n  <fieldset>\n    <section>\n      <label for=\"sourceUnits\">Distance</label>\n      <input name=\"sourceUnits\" type=\"number\" [(ngModel)]=\"sourceUnits\" placeholder=\"0\" />\n    </section>\n  </fieldset>\n  <input value=\"Convert\" type=\"button\" (click)=\"convert()\" />\n</form>\n<section>\n  <h4>Distance {{ targetUnits | number:'1.2-2' }}</h4>\n</section>\n```\n\n## 2.2 Implementaciones\n\nEl `CultureConverterComponent` depende de `CultureService` el cual implementa de forma abstracta la interfaz `CultureConverter`. Pero eso no es para nada funcional. Vamos a crear dos implementaciones especficas para Europa y USA. Estas clases concretas se apoyarn en el anteriormente creado `CalculatorService` que necesita algo ms de cdigo para hacer conversiones de distancia en ambos sentidos.\n\n```typescript\nexport class CalculatorService {\n  private milesPerKilometer = 0.62137;\n  private kilometersPerMile = 1.609;\n\n  constructor() {}\n\n  fromKilometersToMiles = (kilometers: number): number => kilometers * this.milesPerKilometer;\n  fromMilesToKilometers = (miles: number): number => miles * this.kilometersPerMile;\n}\n```\n\n```console\nng g s converter/dynamic-converter/european\nng g s converter/dynamic-converter/american\n```\n\nY aqu est el primero de los dos servicios concretos. Implementando una conversin de millas a kilmetros\n\n```typescript\n@Injectable()\nexport class EuropeanService extends CultureService {\n  sourceCulture = 'USA';\n  targetCulture = 'Europe';\n  constructor(private calculatorService: CalculatorService) { super(); }\n  public convertDistance = this.calculatorService.fromMilesToKilometers;\n}\n```\n\nY aqu el segundo que extiende la clase abstracta pasando a millas\n\n```typescript\n@Injectable()\nexport class AmericanService extends CultureService {\n  sourceCulture = 'Europe';\n  targetCulture = 'USA';\n  constructor(private calculatorService: CalculatorService) { super(); }\n  public convertDistance = this.calculatorService.fromKilometersToMiles;\n}\n```\n\n## 2.3 Provisin manual\n\nPor ejemplo si queremos utilizar la implementacin concreta de USA lo indicamos en el mdulo que lo consuma.\n\n```typescript\n{\n providers: [\n    {\n      provide: CultureService,\n      useClass: AmericanService,\n    },\n  ],\n}\n```\n\nEl componente reclama una instancia de `CultureService` y le damos otra con la misma interfaz. De esta forma podramos tener mdulos distintos, cada uno con su propia estrategia de conversin.\n\n## 2.4 Factora\n\nUna situacin muy comn es poder elegir dinmicamente la implementacin concreta. Para ello necesitamos una funcin factora que con alguna lgica escoja la estrategia concreta.\n\n```typescript\nconst cultureFactory = (calculatorService: CalculatorService) => {\n  if (environment.unitsCulture === 'metric') {\n    return new EuropeanService(calculatorService);\n  } else {\n    return new AmericanService(calculatorService);\n  }\n};\n{\n  providers: [\n    {\n      provide: CultureService,\n      useFactory: cultureFactory,\n      deps: [CalculatorService],\n    },\n  ];\n}\n```\n\nDe esta forma la aplicacin se comportar distinto en funcin de una variable de entorno.\n\nYa tenemos la aplicacin mucho mejor estructurada, pero el almacn de datos es mejorable. Se mantienen los datos _hard-coded_, muy incmodo para actualizar; y en memoria, poco fiable y voltil. Lo ms habitual es guardar y recuperar la informacin en un servidor _http_. Sigue esta serie para aadir [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/) mientras aprendes a programar con Angular. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-5-Servicios-inyectables-en-Angular.md","raw":"---\ntitle: Servicios inyectables en Angular\npermalink: servicios-inyectables-en-Angular\ndate: 2020-04-17 10:54:58\ntags:\n  - Angular\n  - Servicios\n  - DI\n  - Tutorial\n  - Introduccin\n  - Angular9\n  - Angular2\ncategories:\n  - [Tutorial, Angular]\nthumbnail: /css/images/angular-5_inject.png\n---\n\n![servicios-inyectables-en-Angular](/images/tutorial-angular-5_inject.png)\n\nLa presentacin, la lgica y el manejo de datos son tres capas de abstraccin que usamos los programadores para mantener organizado nuestro cdigo. En Angular, la presentacin es cosa de los componentes. **La lgica y los datos tienen su lugar en servicios compartidos**.\n\nPara que los componentes consuman los servicios de forma controlada tenemos proveedores _inyectables_ en la librera `@angular/core` con los que realizar **la inyeccin de dependencias**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/). Al finalizar tendrs una aplicacin que comunica componentes entre pginas, reparte responsabilidades y gestiona claramente sus dependencias.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Inyeccin de dependencias\n\nComo casi todo en Angular, **los servicios son clases TypeScript**. Su propsito es contener lgica de negocio, clases para acceso a datos o utilidades de infraestructura. Estas clases son perfectamente instanciables desde cualquier otro fichero que las importe. Pero Angular nos sugiere y facilita que usemos su sistema de inyeccin de dependencias.\n\nEste sistema se basa en convenios y configuraciones que controlan la instancia concreta que ser inyectada al objeto dependiente. Ahora vers cmo funciona la **[Dependency Injection](https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias) en Angular**.\n\nComo demostracin vamos a trabajar con un par de utilidades para conversin de unidades. Crear un mdulo y un componente en el que visualizarlo.\n\n```shell\nng g m converter --route converter --module app-routing.module\n```\n\n## 1.1 Generacin de servicios\n\nLa particularidad de las clases de servicios est en su decorador: `@Injectable()`. Esta funcin viene en el `@angular/core` e **indica que esta clase puede ser inyectada** dinmicamente a quien la demande. Aunque es muy sencillo crearlos a mano, el CLI nos ofrece su comando especializado para crear servicios. Estos son ejemplos de instrucciones para crear un _service_.\n\n```shell\nng g s converter/calculator\n```\n\nEl resultado es el fichero `calculator.service.ts` con su decorador que toma una _class_ normal y produce algo _injectable_. Veamos una implementacin mnima:\n\n```typescript\n@Injectable({\n  providedIn: 'root',\n})\nexport class CalculatorService {\n  private milesPerKilometer = 0.62137;\n  private kilometersPerMile = 1.609;\n\n  constructor() {}\n\n  fromKilometersToMiles = (kilometers: number): number => kilometers * this.milesPerKilometer;\n  fromMilesToKilometers = (miles: number): number => miles * this.kilometersPerMile;\n}\n```\n\nAhora tienes centralizado en este servicio la lgica de datos que tenemos hasta el momento. Los dems componentes la podrn utilizar.\n\n## 1.2 Consumo de dependencias\n\nDeclarar y decorar la clase no es suficiente para poder reclamarla. Necesitas **registrarla como un proveedor en algn mdulo**. Desde Angular 6 los servicios se auto-proveen en el mdulo raz mediante la configuracin `providedIn: 'root'` de su decorador.\n\n> Esto es til y cmodo en una gran cantidad de casos. El mdulo raz es visible para toda la aplicacin de forma que cualquier componente puede reclamar un servicio suyo sin problema. Excepto que el problema sea el tamao. El mdulo raz se carga al arrancar y todas sus referencias van el _bundle_ principal. Si queremos repartir el peso debemos llevar ciertos servicios al mdulo funcional que los necesite.\n\nVamos a consumir este servicio en el `converter.component.ts`. Al consumo de los servicios inyectables se le conoce como _dependencia_. Cada componente o servicio puede **declarar en su constructor sus dependencias** hacia servicios inyectables. El convenio exige que se especifique el tipo esperado\n\n```typescript\nexport class ConverterComponent implements OnInit {\n  public kilometers = 0;\n  public miles: number;\n\n  constructor(private calculatorService: CalculatorService) {}\n\n  ngOnInit() {\n    this.convert();\n  }\n  convert() {\n    this.miles = this.calculatorService.fromKilometersToMiles(this.kilometers);\n  }\n}\n```\n\n> Agregar el modificador de alcance `private` o `public` en la declaracin de argumentos hace que _TypeScript_ genere una propiedad inicializada con el valor recibido. Es azcar sintctico para no tener que declarar la propiedad y asignarle el valor del argumento manualmente. En resumen, los [constructores en TypeScrip](https://kendaleiv.com/typescript-constructor-assignment-public-and-private-keywords/) admiten argumentos que transforman en propiedades. Mantenemos privado el `converterService` para evitar su uso desde la vista.\n\n```html\n<h2>Distance Converter.</h2>\n<h3>From Europe to USA</h3>\n<form>\n  <fieldset>\n    <section>\n      <label for=\"kilometers\">Kilometers</label>\n      <input name=\"kilometers\"\n             type=\"number\"\n             [(ngModel)]=\"kilometers\"\n             placeholder=\"0\" />\n    </section>\n  </fieldset>\n  <input value=\"Convert\"\n         type=\"button\"\n         (click)=\"convert()\" />\n</form>\n<section>\n  <h4>{{ miles | number:'1.2-2' }} miles</h4>\n</section>\n<a [routerLink]=\"['dynamic']\">Go to Abstract Culture Converter Sample</a>\n```\n\n# 2. Inversin del control\n\nUn concepto ntimamente relacionado con la inyeccin de dependencias es el de [**Inversion of Control**](https://en.wikipedia.org/wiki/Inversion_of_control). El componente dependiente expresa sus necesidades, pero es el _framework_ el que en ltima instancia decide lo que recibir. Vemos entonces que **el invocado cede el control al invocador**.\n\nCuando proveemos un servicio en Angular, el comportamiento por defecto es el de proveer un _singleton_ pero hay ms opciones. Si se usa el objeto `provider` con `useClass` , `useValue` y `useFactory` podemos controlar el proceso de inyeccin.\n\nSe crea un [_singleton_](https://es.wikipedia.org/wiki/Singleton) por cada mdulo en el que se provea un servicio. Normalmente si el servicio es para un slo mdulo funcional se provee en este y nada ms. Si va a ser compartido gana la opcin de auto proveerlo en el raz, garantizando as su disponibilidad en cualquier otro mdulo de la aplicacin.\n\nEn un mdulo cualquiera, siempre podramos agregar un servicio a su array de _providers_.\n\n```typescript\n@NgModule({\n  declarations: [...],\n  imports: [...],\n  providers: [ CalculatorService ]\n})\n```\n\nPero siempre ser **una instancia nica por mdulo**. Si un _singleton_ no es lo adecuado, entonces puedes proveer el mismo servicio en distintos mdulos. De esa forma se crear una instancia distinta para cada uno. Si se provee la misma clase en dos o ms mdulos se genera una instancia en cada uno de ellos. Los componentes recibirn la instancia del mdulo jerrquicamente ms cercano.\n\n> Incluso es posible usar el array `providers:[]` en la decoracin de un componente o de otro servicio. Haciendo as an ms granular la eleccin de instancia.\n\nVeamos un ejemplo extendiendo el problema del conversor de unidades de forma que se pueda escoger una **estrategia** de conversin en base a una cultura concreta. Para empezar necesitamos una interfaz, un servicio base que la implemente y un componente que lo consuma.\n\n```shell\nng g interface converter/dynamic-converter/culture-converter\nng g service converter/dynamic-converter/culture\nng g component converter/dynamic-converter/dynamic-converter\n```\n\n```typeScript\nexport interface CultureConverter {\n  sourceCulture: string;\n  targetCulture: string;\n  convertDistance: (source: number) => number;\n}\n```\n\n```typescript\nexport abstract class CultureService implements CultureConverter {\n  sourceCulture: string;\n  targetCulture: string;\n  convertDistance: (source: number) => number;\n\n  constructor() {}\n}\n```\n\n```typeScript\nexport class CultureConverterComponent implements OnInit {\n  public source: string;\n  public target: string;\n  public sourceUnits = 0;\n  public targetUnits: number;\n\n  constructor(private cultureService:CultureService){ }\n\n  public ngOnInit() {\n    this.source = this.cultureService.sourceCulture;\n    this.target = this.cultureService.targetCulture;\n    this.convert();\n  }\n  public convert() {\n    this.targetUnits = this.cultureService.convertDistance(this.sourceUnits);\n  }\n}\n```\n\n```html\n<h2>Culture Converter.</h2>\n<h3>From {{ source }} to {{ target }}</h3>\n<form>\n  <fieldset>\n    <section>\n      <label for=\"sourceUnits\">Distance</label>\n      <input name=\"sourceUnits\" type=\"number\" [(ngModel)]=\"sourceUnits\" placeholder=\"0\" />\n    </section>\n  </fieldset>\n  <input value=\"Convert\" type=\"button\" (click)=\"convert()\" />\n</form>\n<section>\n  <h4>Distance {{ targetUnits | number:'1.2-2' }}</h4>\n</section>\n```\n\n## 2.2 Implementaciones\n\nEl `CultureConverterComponent` depende de `CultureService` el cual implementa de forma abstracta la interfaz `CultureConverter`. Pero eso no es para nada funcional. Vamos a crear dos implementaciones especficas para Europa y USA. Estas clases concretas se apoyarn en el anteriormente creado `CalculatorService` que necesita algo ms de cdigo para hacer conversiones de distancia en ambos sentidos.\n\n```typescript\nexport class CalculatorService {\n  private milesPerKilometer = 0.62137;\n  private kilometersPerMile = 1.609;\n\n  constructor() {}\n\n  fromKilometersToMiles = (kilometers: number): number => kilometers * this.milesPerKilometer;\n  fromMilesToKilometers = (miles: number): number => miles * this.kilometersPerMile;\n}\n```\n\n```console\nng g s converter/dynamic-converter/european\nng g s converter/dynamic-converter/american\n```\n\nY aqu est el primero de los dos servicios concretos. Implementando una conversin de millas a kilmetros\n\n```typescript\n@Injectable()\nexport class EuropeanService extends CultureService {\n  sourceCulture = 'USA';\n  targetCulture = 'Europe';\n  constructor(private calculatorService: CalculatorService) { super(); }\n  public convertDistance = this.calculatorService.fromMilesToKilometers;\n}\n```\n\nY aqu el segundo que extiende la clase abstracta pasando a millas\n\n```typescript\n@Injectable()\nexport class AmericanService extends CultureService {\n  sourceCulture = 'Europe';\n  targetCulture = 'USA';\n  constructor(private calculatorService: CalculatorService) { super(); }\n  public convertDistance = this.calculatorService.fromKilometersToMiles;\n}\n```\n\n## 2.3 Provisin manual\n\nPor ejemplo si queremos utilizar la implementacin concreta de USA lo indicamos en el mdulo que lo consuma.\n\n```typescript\n{\n providers: [\n    {\n      provide: CultureService,\n      useClass: AmericanService,\n    },\n  ],\n}\n```\n\nEl componente reclama una instancia de `CultureService` y le damos otra con la misma interfaz. De esta forma podramos tener mdulos distintos, cada uno con su propia estrategia de conversin.\n\n## 2.4 Factora\n\nUna situacin muy comn es poder elegir dinmicamente la implementacin concreta. Para ello necesitamos una funcin factora que con alguna lgica escoja la estrategia concreta.\n\n```typescript\nconst cultureFactory = (calculatorService: CalculatorService) => {\n  if (environment.unitsCulture === 'metric') {\n    return new EuropeanService(calculatorService);\n  } else {\n    return new AmericanService(calculatorService);\n  }\n};\n{\n  providers: [\n    {\n      provide: CultureService,\n      useFactory: cultureFactory,\n      deps: [CalculatorService],\n    },\n  ];\n}\n```\n\nDe esta forma la aplicacin se comportar distinto en funcin de una variable de entorno.\n\nYa tenemos la aplicacin mucho mejor estructurada, pero el almacn de datos es mejorable. Se mantienen los datos _hard-coded_, muy incmodo para actualizar; y en memoria, poco fiable y voltil. Lo ms habitual es guardar y recuperar la informacin en un servidor _http_. Sigue esta serie para aadir [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/) mientras aprendes a programar con Angular. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"servicios-inyectables-en-Angular","published":1,"updated":"2020-04-17T08:35:28.074Z","_id":"ck70mab1r000vbss32jkppmvg","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-5_inject.png\" alt=\"servicios-inyectables-en-Angular\"></p><p>La presentacin, la lgica y el manejo de datos son tres capas de abstraccin que usamos los programadores para mantener organizado nuestro cdigo. En Angular, la presentacin es cosa de los componentes. <strong>La lgica y los datos tienen su lugar en servicios compartidos</strong>.</p><p>Para que los componentes consuman los servicios de forma controlada tenemos proveedores <em>inyectables</em> en la librera <code>@angular/core</code> con los que realizar <strong>la inyeccin de dependencias</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a>. Al finalizar tendrs una aplicacin que comunica componentes entre pginas, reparte responsabilidades y gestiona claramente sus dependencias.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Inyeccion-de-dependencias\"><a href=\"#1-Inyeccion-de-dependencias\" class=\"headerlink\" title=\"1. Inyeccin de dependencias\"></a>1. Inyeccin de dependencias</h1><p>Como casi todo en Angular, <strong>los servicios son clases TypeScript</strong>. Su propsito es contener lgica de negocio, clases para acceso a datos o utilidades de infraestructura. Estas clases son perfectamente instanciables desde cualquier otro fichero que las importe. Pero Angular nos sugiere y facilita que usemos su sistema de inyeccin de dependencias.</p><p>Este sistema se basa en convenios y configuraciones que controlan la instancia concreta que ser inyectada al objeto dependiente. Ahora vers cmo funciona la <strong><a href=\"https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias\" target=\"_blank\" rel=\"noopener\">Dependency Injection</a> en Angular</strong>.</p><p>Como demostracin vamos a trabajar con un par de utilidades para conversin de unidades. Crear un mdulo y un componente en el que visualizarlo.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m converter --route converter --module app-routing.module</span><br></pre></td></tr></table></figure><h2 id=\"1-1-Generacion-de-servicios\"><a href=\"#1-1-Generacion-de-servicios\" class=\"headerlink\" title=\"1.1 Generacin de servicios\"></a>1.1 Generacin de servicios</h2><p>La particularidad de las clases de servicios est en su decorador: <code>@Injectable()</code>. Esta funcin viene en el <code>@angular/core</code> e <strong>indica que esta clase puede ser inyectada</strong> dinmicamente a quien la demande. Aunque es muy sencillo crearlos a mano, el CLI nos ofrece su comando especializado para crear servicios. Estos son ejemplos de instrucciones para crear un <em>service</em>.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s converter/calculator</span><br></pre></td></tr></table></figure><p>El resultado es el fichero <code>calculator.service.ts</code> con su decorador que toma una <em>class</em> normal y produce algo <em>injectable</em>. Veamos una implementacin mnima:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span>,</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CalculatorService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> milesPerKilometer = <span class=\"number\">0.62137</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> kilometersPerMile = <span class=\"number\">1.609</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  fromKilometersToMiles = (kilometers: <span class=\"built_in\">number</span>): <span class=\"function\"><span class=\"params\">number</span> =&gt;</span> kilometers * <span class=\"keyword\">this</span>.milesPerKilometer;</span><br><span class=\"line\">  fromMilesToKilometers = (miles: <span class=\"built_in\">number</span>): <span class=\"function\"><span class=\"params\">number</span> =&gt;</span> miles * <span class=\"keyword\">this</span>.kilometersPerMile;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora tienes centralizado en este servicio la lgica de datos que tenemos hasta el momento. Los dems componentes la podrn utilizar.</p><h2 id=\"1-2-Consumo-de-dependencias\"><a href=\"#1-2-Consumo-de-dependencias\" class=\"headerlink\" title=\"1.2 Consumo de dependencias\"></a>1.2 Consumo de dependencias</h2><p>Declarar y decorar la clase no es suficiente para poder reclamarla. Necesitas <strong>registrarla como un proveedor en algn mdulo</strong>. Desde Angular 6 los servicios se auto-proveen en el mdulo raz mediante la configuracin <code>providedIn: &#39;root&#39;</code> de su decorador.</p><blockquote><p>Esto es til y cmodo en una gran cantidad de casos. El mdulo raz es visible para toda la aplicacin de forma que cualquier componente puede reclamar un servicio suyo sin problema. Excepto que el problema sea el tamao. El mdulo raz se carga al arrancar y todas sus referencias van el <em>bundle</em> principal. Si queremos repartir el peso debemos llevar ciertos servicios al mdulo funcional que los necesite.</p></blockquote><p>Vamos a consumir este servicio en el <code>converter.component.ts</code>. Al consumo de los servicios inyectables se le conoce como <em>dependencia</em>. Cada componente o servicio puede <strong>declarar en su constructor sus dependencias</strong> hacia servicios inyectables. El convenio exige que se especifique el tipo esperado</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ConverterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> kilometers = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> miles: <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> calculatorService: CalculatorService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convert();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  convert() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.miles = <span class=\"keyword\">this</span>.calculatorService.fromKilometersToMiles(<span class=\"keyword\">this</span>.kilometers);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Agregar el modificador de alcance <code>private</code> o <code>public</code> en la declaracin de argumentos hace que <em>TypeScript</em> genere una propiedad inicializada con el valor recibido. Es azcar sintctico para no tener que declarar la propiedad y asignarle el valor del argumento manualmente. En resumen, los <a href=\"https://kendaleiv.com/typescript-constructor-assignment-public-and-private-keywords/\" target=\"_blank\" rel=\"noopener\">constructores en TypeScrip</a> admiten argumentos que transforman en propiedades. Mantenemos privado el <code>converterService</code> para evitar su uso desde la vista.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Distance Converter.<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>From Europe to USA<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"kilometers\"</span>&gt;</span>Kilometers<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"kilometers\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"kilometers\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             <span class=\"attr\">placeholder</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Convert\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         (<span class=\"attr\">click</span>)=<span class=\"string\">\"convert()\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>&#123;&#123; miles | number:'1.2-2' &#125;&#125; miles<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['dynamic']\"</span>&gt;</span>Go to Abstract Culture Converter Sample<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"2-Inversion-del-control\"><a href=\"#2-Inversion-del-control\" class=\"headerlink\" title=\"2. Inversin del control\"></a>2. Inversin del control</h1><p>Un concepto ntimamente relacionado con la inyeccin de dependencias es el de <a href=\"https://en.wikipedia.org/wiki/Inversion_of_control\" target=\"_blank\" rel=\"noopener\"><strong>Inversion of Control</strong></a>. El componente dependiente expresa sus necesidades, pero es el <em>framework</em> el que en ltima instancia decide lo que recibir. Vemos entonces que <strong>el invocado cede el control al invocador</strong>.</p><p>Cuando proveemos un servicio en Angular, el comportamiento por defecto es el de proveer un <em>singleton</em> pero hay ms opciones. Si se usa el objeto <code>provider</code> con <code>useClass</code> , <code>useValue</code> y <code>useFactory</code> podemos controlar el proceso de inyeccin.</p><p>Se crea un <a href=\"https://es.wikipedia.org/wiki/Singleton\" target=\"_blank\" rel=\"noopener\"><em>singleton</em></a> por cada mdulo en el que se provea un servicio. Normalmente si el servicio es para un slo mdulo funcional se provee en este y nada ms. Si va a ser compartido gana la opcin de auto proveerlo en el raz, garantizando as su disponibilidad en cualquier otro mdulo de la aplicacin.</p><p>En un mdulo cualquiera, siempre podramos agregar un servicio a su array de <em>providers</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [...],</span><br><span class=\"line\">  imports: [...],</span><br><span class=\"line\">  providers: [ CalculatorService ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure><p>Pero siempre ser <strong>una instancia nica por mdulo</strong>. Si un <em>singleton</em> no es lo adecuado, entonces puedes proveer el mismo servicio en distintos mdulos. De esa forma se crear una instancia distinta para cada uno. Si se provee la misma clase en dos o ms mdulos se genera una instancia en cada uno de ellos. Los componentes recibirn la instancia del mdulo jerrquicamente ms cercano.</p><blockquote><p>Incluso es posible usar el array <code>providers:[]</code> en la decoracin de un componente o de otro servicio. Haciendo as an ms granular la eleccin de instancia.</p></blockquote><p>Veamos un ejemplo extendiendo el problema del conversor de unidades de forma que se pueda escoger una <strong>estrategia</strong> de conversin en base a una cultura concreta. Para empezar necesitamos una interfaz, un servicio base que la implemente y un componente que lo consuma.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g interface converter/dynamic-converter/culture-converter</span><br><span class=\"line\">ng g service converter/dynamic-converter/culture</span><br><span class=\"line\">ng g component converter/dynamic-converter/dynamic-converter</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> CultureConverter &#123;</span><br><span class=\"line\">  sourceCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  targetCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  convertDistance: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">class</span> CultureService <span class=\"keyword\">implements</span> CultureConverter &#123;</span><br><span class=\"line\">  sourceCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  targetCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  convertDistance: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CultureConverterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> source: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> target: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> sourceUnits = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> targetUnits: <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> cultureService:CultureService</span>)&#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.source = <span class=\"keyword\">this</span>.cultureService.sourceCulture;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.target = <span class=\"keyword\">this</span>.cultureService.targetCulture;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convert();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> convert() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.targetUnits = <span class=\"keyword\">this</span>.cultureService.convertDistance(<span class=\"keyword\">this</span>.sourceUnits);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Culture Converter.<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>From &#123;&#123; source &#125;&#125; to &#123;&#123; target &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"sourceUnits\"</span>&gt;</span>Distance<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"sourceUnits\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"sourceUnits\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Convert\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"convert()\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>Distance &#123;&#123; targetUnits | number:'1.2-2' &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"2-2-Implementaciones\"><a href=\"#2-2-Implementaciones\" class=\"headerlink\" title=\"2.2 Implementaciones\"></a>2.2 Implementaciones</h2><p>El <code>CultureConverterComponent</code> depende de <code>CultureService</code> el cual implementa de forma abstracta la interfaz <code>CultureConverter</code>. Pero eso no es para nada funcional. Vamos a crear dos implementaciones especficas para Europa y USA. Estas clases concretas se apoyarn en el anteriormente creado <code>CalculatorService</code> que necesita algo ms de cdigo para hacer conversiones de distancia en ambos sentidos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CalculatorService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> milesPerKilometer = <span class=\"number\">0.62137</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> kilometersPerMile = <span class=\"number\">1.609</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  fromKilometersToMiles = (kilometers: <span class=\"built_in\">number</span>): <span class=\"function\"><span class=\"params\">number</span> =&gt;</span> kilometers * <span class=\"keyword\">this</span>.milesPerKilometer;</span><br><span class=\"line\">  fromMilesToKilometers = (miles: <span class=\"built_in\">number</span>): <span class=\"function\"><span class=\"params\">number</span> =&gt;</span> miles * <span class=\"keyword\">this</span>.kilometersPerMile;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s converter/dynamic-converter/european</span><br><span class=\"line\">ng g s converter/dynamic-converter/american</span><br></pre></td></tr></table></figure><p>Y aqu est el primero de los dos servicios concretos. Implementando una conversin de millas a kilmetros</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Injectable</span>()</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> EuropeanService <span class=\"keyword\">extends</span> CultureService &#123;</span><br><span class=\"line\">  sourceCulture = <span class=\"string\">'USA'</span>;</span><br><span class=\"line\">  targetCulture = <span class=\"string\">'Europe'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> calculatorService: CalculatorService</span>) &#123; <span class=\"keyword\">super</span>(); &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> convertDistance = <span class=\"keyword\">this</span>.calculatorService.fromMilesToKilometers;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y aqu el segundo que extiende la clase abstracta pasando a millas</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Injectable</span>()</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AmericanService <span class=\"keyword\">extends</span> CultureService &#123;</span><br><span class=\"line\">  sourceCulture = <span class=\"string\">'Europe'</span>;</span><br><span class=\"line\">  targetCulture = <span class=\"string\">'USA'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> calculatorService: CalculatorService</span>) &#123; <span class=\"keyword\">super</span>(); &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> convertDistance = <span class=\"keyword\">this</span>.calculatorService.fromKilometersToMiles;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Provision-manual\"><a href=\"#2-3-Provision-manual\" class=\"headerlink\" title=\"2.3 Provisin manual\"></a>2.3 Provisin manual</h2><p>Por ejemplo si queremos utilizar la implementacin concreta de USA lo indicamos en el mdulo que lo consuma.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\"> providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: CultureService,</span><br><span class=\"line\">      useClass: AmericanService,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ],</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>El componente reclama una instancia de <code>CultureService</code> y le damos otra con la misma interfaz. De esta forma podramos tener mdulos distintos, cada uno con su propia estrategia de conversin.</p><h2 id=\"2-4-Factoria\"><a href=\"#2-4-Factoria\" class=\"headerlink\" title=\"2.4 Factora\"></a>2.4 Factora</h2><p>Una situacin muy comn es poder elegir dinmicamente la implementacin concreta. Para ello necesitamos una funcin factora que con alguna lgica escoja la estrategia concreta.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> cultureFactory = <span class=\"function\">(<span class=\"params\">calculatorService: CalculatorService</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (environment.unitsCulture === <span class=\"string\">'metric'</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> EuropeanService(calculatorService);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> AmericanService(calculatorService);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: CultureService,</span><br><span class=\"line\">      useFactory: cultureFactory,</span><br><span class=\"line\">      deps: [CalculatorService],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>De esta forma la aplicacin se comportar distinto en funcin de una variable de entorno.</p><p>Ya tenemos la aplicacin mucho mejor estructurada, pero el almacn de datos es mejorable. Se mantienen los datos <em>hard-coded</em>, muy incmodo para actualizar; y en memoria, poco fiable y voltil. Lo ms habitual es guardar y recuperar la informacin en un servidor <em>http</em>. Sigue esta serie para aadir <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a> mientras aprendes a programar con Angular. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-5_inject.png\" alt=\"servicios-inyectables-en-Angular\"></p><p>La presentacin, la lgica y el manejo de datos son tres capas de abstraccin que usamos los programadores para mantener organizado nuestro cdigo. En Angular, la presentacin es cosa de los componentes. <strong>La lgica y los datos tienen su lugar en servicios compartidos</strong>.</p><p>Para que los componentes consuman los servicios de forma controlada tenemos proveedores <em>inyectables</em> en la librera <code>@angular/core</code> con los que realizar <strong>la inyeccin de dependencias</strong>.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a>. Al finalizar tendrs una aplicacin que comunica componentes entre pginas, reparte responsabilidades y gestiona claramente sus dependencias.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Inyeccion-de-dependencias\"><a href=\"#1-Inyeccion-de-dependencias\" class=\"headerlink\" title=\"1. Inyeccin de dependencias\"></a>1. Inyeccin de dependencias</h1><p>Como casi todo en Angular, <strong>los servicios son clases TypeScript</strong>. Su propsito es contener lgica de negocio, clases para acceso a datos o utilidades de infraestructura. Estas clases son perfectamente instanciables desde cualquier otro fichero que las importe. Pero Angular nos sugiere y facilita que usemos su sistema de inyeccin de dependencias.</p><p>Este sistema se basa en convenios y configuraciones que controlan la instancia concreta que ser inyectada al objeto dependiente. Ahora vers cmo funciona la <strong><a href=\"https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias\" target=\"_blank\" rel=\"noopener\">Dependency Injection</a> en Angular</strong>.</p><p>Como demostracin vamos a trabajar con un par de utilidades para conversin de unidades. Crear un mdulo y un componente en el que visualizarlo.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m converter --route converter --module app-routing.module</span><br></pre></td></tr></table></figure><h2 id=\"1-1-Generacion-de-servicios\"><a href=\"#1-1-Generacion-de-servicios\" class=\"headerlink\" title=\"1.1 Generacin de servicios\"></a>1.1 Generacin de servicios</h2><p>La particularidad de las clases de servicios est en su decorador: <code>@Injectable()</code>. Esta funcin viene en el <code>@angular/core</code> e <strong>indica que esta clase puede ser inyectada</strong> dinmicamente a quien la demande. Aunque es muy sencillo crearlos a mano, el CLI nos ofrece su comando especializado para crear servicios. Estos son ejemplos de instrucciones para crear un <em>service</em>.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s converter/calculator</span><br></pre></td></tr></table></figure><p>El resultado es el fichero <code>calculator.service.ts</code> con su decorador que toma una <em>class</em> normal y produce algo <em>injectable</em>. Veamos una implementacin mnima:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span>,</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CalculatorService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> milesPerKilometer = <span class=\"number\">0.62137</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> kilometersPerMile = <span class=\"number\">1.609</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  fromKilometersToMiles = (kilometers: <span class=\"built_in\">number</span>): <span class=\"function\"><span class=\"params\">number</span> =&gt;</span> kilometers * <span class=\"keyword\">this</span>.milesPerKilometer;</span><br><span class=\"line\">  fromMilesToKilometers = (miles: <span class=\"built_in\">number</span>): <span class=\"function\"><span class=\"params\">number</span> =&gt;</span> miles * <span class=\"keyword\">this</span>.kilometersPerMile;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora tienes centralizado en este servicio la lgica de datos que tenemos hasta el momento. Los dems componentes la podrn utilizar.</p><h2 id=\"1-2-Consumo-de-dependencias\"><a href=\"#1-2-Consumo-de-dependencias\" class=\"headerlink\" title=\"1.2 Consumo de dependencias\"></a>1.2 Consumo de dependencias</h2><p>Declarar y decorar la clase no es suficiente para poder reclamarla. Necesitas <strong>registrarla como un proveedor en algn mdulo</strong>. Desde Angular 6 los servicios se auto-proveen en el mdulo raz mediante la configuracin <code>providedIn: &#39;root&#39;</code> de su decorador.</p><blockquote><p>Esto es til y cmodo en una gran cantidad de casos. El mdulo raz es visible para toda la aplicacin de forma que cualquier componente puede reclamar un servicio suyo sin problema. Excepto que el problema sea el tamao. El mdulo raz se carga al arrancar y todas sus referencias van el <em>bundle</em> principal. Si queremos repartir el peso debemos llevar ciertos servicios al mdulo funcional que los necesite.</p></blockquote><p>Vamos a consumir este servicio en el <code>converter.component.ts</code>. Al consumo de los servicios inyectables se le conoce como <em>dependencia</em>. Cada componente o servicio puede <strong>declarar en su constructor sus dependencias</strong> hacia servicios inyectables. El convenio exige que se especifique el tipo esperado</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ConverterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> kilometers = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> miles: <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> calculatorService: CalculatorService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convert();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  convert() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.miles = <span class=\"keyword\">this</span>.calculatorService.fromKilometersToMiles(<span class=\"keyword\">this</span>.kilometers);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Agregar el modificador de alcance <code>private</code> o <code>public</code> en la declaracin de argumentos hace que <em>TypeScript</em> genere una propiedad inicializada con el valor recibido. Es azcar sintctico para no tener que declarar la propiedad y asignarle el valor del argumento manualmente. En resumen, los <a href=\"https://kendaleiv.com/typescript-constructor-assignment-public-and-private-keywords/\" target=\"_blank\" rel=\"noopener\">constructores en TypeScrip</a> admiten argumentos que transforman en propiedades. Mantenemos privado el <code>converterService</code> para evitar su uso desde la vista.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Distance Converter.<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>From Europe to USA<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"kilometers\"</span>&gt;</span>Kilometers<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"kilometers\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"kilometers\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             <span class=\"attr\">placeholder</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Convert\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         (<span class=\"attr\">click</span>)=<span class=\"string\">\"convert()\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>&#123;&#123; miles | number:'1.2-2' &#125;&#125; miles<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['dynamic']\"</span>&gt;</span>Go to Abstract Culture Converter Sample<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"2-Inversion-del-control\"><a href=\"#2-Inversion-del-control\" class=\"headerlink\" title=\"2. Inversin del control\"></a>2. Inversin del control</h1><p>Un concepto ntimamente relacionado con la inyeccin de dependencias es el de <a href=\"https://en.wikipedia.org/wiki/Inversion_of_control\" target=\"_blank\" rel=\"noopener\"><strong>Inversion of Control</strong></a>. El componente dependiente expresa sus necesidades, pero es el <em>framework</em> el que en ltima instancia decide lo que recibir. Vemos entonces que <strong>el invocado cede el control al invocador</strong>.</p><p>Cuando proveemos un servicio en Angular, el comportamiento por defecto es el de proveer un <em>singleton</em> pero hay ms opciones. Si se usa el objeto <code>provider</code> con <code>useClass</code> , <code>useValue</code> y <code>useFactory</code> podemos controlar el proceso de inyeccin.</p><p>Se crea un <a href=\"https://es.wikipedia.org/wiki/Singleton\" target=\"_blank\" rel=\"noopener\"><em>singleton</em></a> por cada mdulo en el que se provea un servicio. Normalmente si el servicio es para un slo mdulo funcional se provee en este y nada ms. Si va a ser compartido gana la opcin de auto proveerlo en el raz, garantizando as su disponibilidad en cualquier otro mdulo de la aplicacin.</p><p>En un mdulo cualquiera, siempre podramos agregar un servicio a su array de <em>providers</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [...],</span><br><span class=\"line\">  imports: [...],</span><br><span class=\"line\">  providers: [ CalculatorService ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure><p>Pero siempre ser <strong>una instancia nica por mdulo</strong>. Si un <em>singleton</em> no es lo adecuado, entonces puedes proveer el mismo servicio en distintos mdulos. De esa forma se crear una instancia distinta para cada uno. Si se provee la misma clase en dos o ms mdulos se genera una instancia en cada uno de ellos. Los componentes recibirn la instancia del mdulo jerrquicamente ms cercano.</p><blockquote><p>Incluso es posible usar el array <code>providers:[]</code> en la decoracin de un componente o de otro servicio. Haciendo as an ms granular la eleccin de instancia.</p></blockquote><p>Veamos un ejemplo extendiendo el problema del conversor de unidades de forma que se pueda escoger una <strong>estrategia</strong> de conversin en base a una cultura concreta. Para empezar necesitamos una interfaz, un servicio base que la implemente y un componente que lo consuma.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g interface converter/dynamic-converter/culture-converter</span><br><span class=\"line\">ng g service converter/dynamic-converter/culture</span><br><span class=\"line\">ng g component converter/dynamic-converter/dynamic-converter</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> CultureConverter &#123;</span><br><span class=\"line\">  sourceCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  targetCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  convertDistance: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">class</span> CultureService <span class=\"keyword\">implements</span> CultureConverter &#123;</span><br><span class=\"line\">  sourceCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  targetCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  convertDistance: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CultureConverterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> source: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> target: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> sourceUnits = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> targetUnits: <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> cultureService:CultureService</span>)&#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.source = <span class=\"keyword\">this</span>.cultureService.sourceCulture;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.target = <span class=\"keyword\">this</span>.cultureService.targetCulture;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convert();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> convert() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.targetUnits = <span class=\"keyword\">this</span>.cultureService.convertDistance(<span class=\"keyword\">this</span>.sourceUnits);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Culture Converter.<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>From &#123;&#123; source &#125;&#125; to &#123;&#123; target &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"sourceUnits\"</span>&gt;</span>Distance<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"sourceUnits\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"sourceUnits\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Convert\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"convert()\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>Distance &#123;&#123; targetUnits | number:'1.2-2' &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"2-2-Implementaciones\"><a href=\"#2-2-Implementaciones\" class=\"headerlink\" title=\"2.2 Implementaciones\"></a>2.2 Implementaciones</h2><p>El <code>CultureConverterComponent</code> depende de <code>CultureService</code> el cual implementa de forma abstracta la interfaz <code>CultureConverter</code>. Pero eso no es para nada funcional. Vamos a crear dos implementaciones especficas para Europa y USA. Estas clases concretas se apoyarn en el anteriormente creado <code>CalculatorService</code> que necesita algo ms de cdigo para hacer conversiones de distancia en ambos sentidos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CalculatorService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> milesPerKilometer = <span class=\"number\">0.62137</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> kilometersPerMile = <span class=\"number\">1.609</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  fromKilometersToMiles = (kilometers: <span class=\"built_in\">number</span>): <span class=\"function\"><span class=\"params\">number</span> =&gt;</span> kilometers * <span class=\"keyword\">this</span>.milesPerKilometer;</span><br><span class=\"line\">  fromMilesToKilometers = (miles: <span class=\"built_in\">number</span>): <span class=\"function\"><span class=\"params\">number</span> =&gt;</span> miles * <span class=\"keyword\">this</span>.kilometersPerMile;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s converter/dynamic-converter/european</span><br><span class=\"line\">ng g s converter/dynamic-converter/american</span><br></pre></td></tr></table></figure><p>Y aqu est el primero de los dos servicios concretos. Implementando una conversin de millas a kilmetros</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Injectable</span>()</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> EuropeanService <span class=\"keyword\">extends</span> CultureService &#123;</span><br><span class=\"line\">  sourceCulture = <span class=\"string\">'USA'</span>;</span><br><span class=\"line\">  targetCulture = <span class=\"string\">'Europe'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> calculatorService: CalculatorService</span>) &#123; <span class=\"keyword\">super</span>(); &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> convertDistance = <span class=\"keyword\">this</span>.calculatorService.fromMilesToKilometers;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y aqu el segundo que extiende la clase abstracta pasando a millas</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Injectable</span>()</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AmericanService <span class=\"keyword\">extends</span> CultureService &#123;</span><br><span class=\"line\">  sourceCulture = <span class=\"string\">'Europe'</span>;</span><br><span class=\"line\">  targetCulture = <span class=\"string\">'USA'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> calculatorService: CalculatorService</span>) &#123; <span class=\"keyword\">super</span>(); &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> convertDistance = <span class=\"keyword\">this</span>.calculatorService.fromKilometersToMiles;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Provision-manual\"><a href=\"#2-3-Provision-manual\" class=\"headerlink\" title=\"2.3 Provisin manual\"></a>2.3 Provisin manual</h2><p>Por ejemplo si queremos utilizar la implementacin concreta de USA lo indicamos en el mdulo que lo consuma.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\"> providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: CultureService,</span><br><span class=\"line\">      useClass: AmericanService,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ],</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>El componente reclama una instancia de <code>CultureService</code> y le damos otra con la misma interfaz. De esta forma podramos tener mdulos distintos, cada uno con su propia estrategia de conversin.</p><h2 id=\"2-4-Factoria\"><a href=\"#2-4-Factoria\" class=\"headerlink\" title=\"2.4 Factora\"></a>2.4 Factora</h2><p>Una situacin muy comn es poder elegir dinmicamente la implementacin concreta. Para ello necesitamos una funcin factora que con alguna lgica escoja la estrategia concreta.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> cultureFactory = <span class=\"function\">(<span class=\"params\">calculatorService: CalculatorService</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (environment.unitsCulture === <span class=\"string\">'metric'</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> EuropeanService(calculatorService);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> AmericanService(calculatorService);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: CultureService,</span><br><span class=\"line\">      useFactory: cultureFactory,</span><br><span class=\"line\">      deps: [CalculatorService],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>De esta forma la aplicacin se comportar distinto en funcin de una variable de entorno.</p><p>Ya tenemos la aplicacin mucho mejor estructurada, pero el almacn de datos es mejorable. Se mantienen los datos <em>hard-coded</em>, muy incmodo para actualizar; y en memoria, poco fiable y voltil. Lo ms habitual es guardar y recuperar la informacin en un servidor <em>http</em>. Sigue esta serie para aadir <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a> mientras aprendes a programar con Angular. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Comunicaciones http en Angular","date":"2020-04-18T09:06:00.000Z","thumbnail":"/css/images/angular-6_http.png","_content":"\n![comunicaciones-http-en-Angular](/images/tutorial-angular-6_http.png)\n\nLas comunicaciones _http_ son una pieza fundamental del desarrollo web, y en **Angular** siempre han sido potentes y fciles. Siempre?, bueno cuando apareci Angular 2 echbamos en falta algunas cosillas... y adems la librera *RxJS* y sus *streams* son intimidantes para los novatos.\n\nPero en la versin Angular 9 **consumir un servicio REST** puede ser cosa de nios si aprendes a jugar con los _observables_ y los servicios de la librera `@angular/common/http`. Conseguirs realizar **comunicaciones http asncronas en Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/). Al finalizar tendrs una aplicacin que almacena y recupera los datos consumiendo un servicio REST usando las tecnologas de Angular Http.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. El servicio HttpClient\n\nComo demostracin vamos a consumir un API pblica con datos de [cotizacin de monedas](https://exchangeratesapi.io/). Crear un mdulo y un componente en el que visualizar las divisas y despus las transformaremos para guardarlas en un servicio propio.\n\n```shell\nng g m money --route money --module app-routing.module\n```\n\n## 1.1 Importacin y declaracin de servicios\n\nLa librera `@angular/common/http` trae el mdulo `HttpClientModule` con el servicio inyectable `HttpClient`. Lo primero es importar dicho mdulo.\n\n```typescript\nimport { HttpClientModule } from '@angular/common/http';\n@NgModule({\n  declarations: [MoneyComponent],\n  imports: [CommonModule, MoneyRoutingModule, HttpClientModule],\n})\nexport class MoneyModule {}\n```\n\nEn tu componente tienes que reclamar la dependencia al servicio para poder usarla. Atencin a la importacin pues hay ms clases con el nombre `HttpClient`. Debe quedar algo as:\n\n```typescript\nimport { HttpClient } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'ab-money',\n  templateUrl: './money.component.html',\n  styles: []\n})\nexport class MoneyComponent implements OnInit {\n  constructor(private httpClient: HttpClient) {}\n\n  ngOnInit() {}\n}\n```\n\nA partir de este momento slo queda invocar los mtodos REST en la propiedad `this.http`.\n\n## 1.2 Obtencin de datos\n\nPara cada verbo _http_ tenemos su mtodo en el servicio `HttpClient`. Su primer parmetro ser la *url* a la que invocar. Empecemos por el `get` que automticamente solicita y devuelve objetos _JSON_ desde un API. Por ejemplo para obtener [las ltimas cotizaciones de las principales divisas](https://api.exchangeratesapi.io/latest?symbols=USD,GBP,CHF,JPY) lo haremos as:\n\n\n```typescript\nexport class RatesComponent implements OnInit {\n  private urlapi\n    = 'https://api.exchangeratesapi.io/latest';\n  public currentEuroRates: any = null;\n\n  constructor(private httpClient: HttpClient) {}\n\n  ngOnInit() {\n    this.getCurrentEuroRates();\n  }\n\n  private getCurrentEuroRates() {\n    const currencies = 'USD,GBP,CHF,JPY';\n    const url = `${this.urlapi}?symbols=${currencies}`;\n    this.httpClient\n      .get(url)\n      .subscribe(apiData => (this.currentEuroRates = apiData));\n  }\n}\n```\n\n> El mtodo _get_ retorna un objeto observable. Los observables _http_ han de consumirse mediante el mtodo _subscribe_ para que realmente se lancen. Dicho mtodo _subscribe_ admite hasta tres _callbacks_ para responder a tres sucesos posibles. Retorno de datos correcto, retorno de un error y seal de finalizacin. La sintaxis original ofrece tres argumentos opcionales para enviarles las funciones callback `susbcribe(data, err, end)`. En este ejemplo solo hemos usado el primero.\n\nOtra sintaxis ms reciente sustituye los tres argumentos funcionales por un un nico objeto. La ventaja es que puedes usar clases con lgica comn, reutilizarlos en distintas suscripciones, o simplemente tener el cdigo un poco ms organizadito.\n\n```typescript\nobservable$.susbcribe({\n  next: function(data){},\n  error: function(err){},\n  complete: function(){}\n  })\n```\nLa presentacin en la vista slo tiene que acceder a la propiedad dnde se hayan cargado las respuestas tratadas en el _callback_ de la suscripcin.\n\n```html\n<h2> Currency Rates. </h2>\n<h3> From Euro to the world </h3>\n<pre>{{ currentEuroRates | json }}</pre>\n```\n\n\n## 1.3 Envo de datos\n\nSupongamos que, una vez recibidas las cotizaciones, pretendemos transformarlas y almacenarlas en otro servicio. Por ejemplo un objeto para cada da y moneda. El envo en este caso ser con el mtodo _post_ al que se le pasar la ruta del _end point_ y el objeto _payload_ que se enviar al servidor.\n\nVamos a agregar una propiedad y un par de mtodos al `rates-component.ts`. La idea es obtener un array de cotizaciones aa partir del objeto previo, y guardarla una por una.\n\n```typescript\nthis.httpClient\n      .post(url, payloadObject)\n      .subscribe();\n```\n> Atencin a los mtodos `subscribe()`. Aunque vayan vacos son imprescindibles para que se ejecute la llamada. Esto puede resultar contra intuitivo, pero la verdad es que los observables Http de Angular slo trabajan si hay alguien mirando.\n\n\n## 1.4 Actualizacin de datos\n\nUn par de seudo ejemplos ms para acabar de entender la mecnica bsica de `HttpClient`. Podemos fijar el tipo de datos esperado en cualquier llamada. De hecho es recomendable que tengas un interfaz para cada respuesta esperada.\n\n```typescript\npublic update() {\n  this.httpClient.delete(itemResourceUrl, newValue).subscribe();\n}\npublic delete() {\n  this.httpClient.delete(itemResourceUrl).subscribe();\n}\n```\n\nY hasta aqu lo bsico de comunicaciones *http*. Fcil verdad?. Pero la vida real raramente es tan sencilla. Si quieres enfrentarte a algo ms duro debes prepararte y dominar los observables *RxJS*.\n\nLo que viene a partir de ahora requerir tiempo y concentracin. Si continas adelante esto ya no ser *your grandpas http anymore*.\n\n # 2 Observables\n\nLas **comunicaciones** entre navegadores y servidores son varios rdenes de magnitud ms lentas que las operaciones en memoria. Por tanto deben realizarse de manera asncrona para garantizar una buena experiencia al usuario.\n\nEsta experiencia no siempre fue tan buena para el programador. Sobre todo con las primeras comunicaciones _AJAX_ basadas en el paso de funciones _callback_. La aparicin de las _promises_ mejor la claridad del cdigo, y ahora con los _Observables_ tenemos adems una gran potencia para manipular la **informacin asncrona**.\n\n> El patrn `Observable` fue implementado por Microsoft en la librera [_Reactive Extensions_](http://reactivex.io/intro.html) ms conocida como `RxJs`. El equipo de Angular decidi utilizarla para el desarrollo de las comunicaciones asncronas. Esta extensa librera puede resultar intimidante en un primer vistazo. Pero con muy poco conocimiento puedes programar casi todas las funcionalidades que se te ocurran.\n\nLo primero es importar el cdigo, de forma similar a cualquier otra clase o funcin. Por ejemplo para empezar basta con `import { Observable } from \"rxjs/Observable\";`. Tendremos la clase usada por angular para observar el respuesta *http*.\n\nPero esta es una clase genrica donde sus instancias admiten la manipulacin interna de tipos ms o menos concretos. Por eso ves en el ejemplo que algunas funciones retornan el tipo esperado `: Observable<MyClass>`, o si no saben que tipo esperar se conforman con `: Observable<any>`.\n\nEn cualquier caso, **toda operacin asncrona retornar una instancia observable** a la cual habr que subscribirse para recibir los datos o los errores, cuando termine.\n\nAunque a veces no se ver el _subscribe_...\n\nYa tenemos el programa comunicado por _http_ con un servidor; aunque por ahora de forma annima y sin ninguna seguridad. Necesitamos aumentar el conocimiento actual de los observables, del _httpClient_ con los interceptores y ya estaremos cerca de resolverlo. Sigue esta serie para aadirle [vigilancia y seguridad en Angular](../vigilancia-y-seguridad-en-Angular/) mientras aprendes a programar con Angular. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-6-comunicaciones-http-en-angular.md","raw":"---\ntitle: Comunicaciones http en Angular\npermalink: comunicaciones-http-en-Angular\ndate: 2020-04-18 11:06:00\ntags:\n- Angular\n- http\n- RxJS\n- Observables\n- Tutorial\n- Introduccin\n- Angular9\n- Angular2\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-6_http.png\n---\n\n![comunicaciones-http-en-Angular](/images/tutorial-angular-6_http.png)\n\nLas comunicaciones _http_ son una pieza fundamental del desarrollo web, y en **Angular** siempre han sido potentes y fciles. Siempre?, bueno cuando apareci Angular 2 echbamos en falta algunas cosillas... y adems la librera *RxJS* y sus *streams* son intimidantes para los novatos.\n\nPero en la versin Angular 9 **consumir un servicio REST** puede ser cosa de nios si aprendes a jugar con los _observables_ y los servicios de la librera `@angular/common/http`. Conseguirs realizar **comunicaciones http asncronas en Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/). Al finalizar tendrs una aplicacin que almacena y recupera los datos consumiendo un servicio REST usando las tecnologas de Angular Http.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. El servicio HttpClient\n\nComo demostracin vamos a consumir un API pblica con datos de [cotizacin de monedas](https://exchangeratesapi.io/). Crear un mdulo y un componente en el que visualizar las divisas y despus las transformaremos para guardarlas en un servicio propio.\n\n```shell\nng g m money --route money --module app-routing.module\n```\n\n## 1.1 Importacin y declaracin de servicios\n\nLa librera `@angular/common/http` trae el mdulo `HttpClientModule` con el servicio inyectable `HttpClient`. Lo primero es importar dicho mdulo.\n\n```typescript\nimport { HttpClientModule } from '@angular/common/http';\n@NgModule({\n  declarations: [MoneyComponent],\n  imports: [CommonModule, MoneyRoutingModule, HttpClientModule],\n})\nexport class MoneyModule {}\n```\n\nEn tu componente tienes que reclamar la dependencia al servicio para poder usarla. Atencin a la importacin pues hay ms clases con el nombre `HttpClient`. Debe quedar algo as:\n\n```typescript\nimport { HttpClient } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'ab-money',\n  templateUrl: './money.component.html',\n  styles: []\n})\nexport class MoneyComponent implements OnInit {\n  constructor(private httpClient: HttpClient) {}\n\n  ngOnInit() {}\n}\n```\n\nA partir de este momento slo queda invocar los mtodos REST en la propiedad `this.http`.\n\n## 1.2 Obtencin de datos\n\nPara cada verbo _http_ tenemos su mtodo en el servicio `HttpClient`. Su primer parmetro ser la *url* a la que invocar. Empecemos por el `get` que automticamente solicita y devuelve objetos _JSON_ desde un API. Por ejemplo para obtener [las ltimas cotizaciones de las principales divisas](https://api.exchangeratesapi.io/latest?symbols=USD,GBP,CHF,JPY) lo haremos as:\n\n\n```typescript\nexport class RatesComponent implements OnInit {\n  private urlapi\n    = 'https://api.exchangeratesapi.io/latest';\n  public currentEuroRates: any = null;\n\n  constructor(private httpClient: HttpClient) {}\n\n  ngOnInit() {\n    this.getCurrentEuroRates();\n  }\n\n  private getCurrentEuroRates() {\n    const currencies = 'USD,GBP,CHF,JPY';\n    const url = `${this.urlapi}?symbols=${currencies}`;\n    this.httpClient\n      .get(url)\n      .subscribe(apiData => (this.currentEuroRates = apiData));\n  }\n}\n```\n\n> El mtodo _get_ retorna un objeto observable. Los observables _http_ han de consumirse mediante el mtodo _subscribe_ para que realmente se lancen. Dicho mtodo _subscribe_ admite hasta tres _callbacks_ para responder a tres sucesos posibles. Retorno de datos correcto, retorno de un error y seal de finalizacin. La sintaxis original ofrece tres argumentos opcionales para enviarles las funciones callback `susbcribe(data, err, end)`. En este ejemplo solo hemos usado el primero.\n\nOtra sintaxis ms reciente sustituye los tres argumentos funcionales por un un nico objeto. La ventaja es que puedes usar clases con lgica comn, reutilizarlos en distintas suscripciones, o simplemente tener el cdigo un poco ms organizadito.\n\n```typescript\nobservable$.susbcribe({\n  next: function(data){},\n  error: function(err){},\n  complete: function(){}\n  })\n```\nLa presentacin en la vista slo tiene que acceder a la propiedad dnde se hayan cargado las respuestas tratadas en el _callback_ de la suscripcin.\n\n```html\n<h2> Currency Rates. </h2>\n<h3> From Euro to the world </h3>\n<pre>{{ currentEuroRates | json }}</pre>\n```\n\n\n## 1.3 Envo de datos\n\nSupongamos que, una vez recibidas las cotizaciones, pretendemos transformarlas y almacenarlas en otro servicio. Por ejemplo un objeto para cada da y moneda. El envo en este caso ser con el mtodo _post_ al que se le pasar la ruta del _end point_ y el objeto _payload_ que se enviar al servidor.\n\nVamos a agregar una propiedad y un par de mtodos al `rates-component.ts`. La idea es obtener un array de cotizaciones aa partir del objeto previo, y guardarla una por una.\n\n```typescript\nthis.httpClient\n      .post(url, payloadObject)\n      .subscribe();\n```\n> Atencin a los mtodos `subscribe()`. Aunque vayan vacos son imprescindibles para que se ejecute la llamada. Esto puede resultar contra intuitivo, pero la verdad es que los observables Http de Angular slo trabajan si hay alguien mirando.\n\n\n## 1.4 Actualizacin de datos\n\nUn par de seudo ejemplos ms para acabar de entender la mecnica bsica de `HttpClient`. Podemos fijar el tipo de datos esperado en cualquier llamada. De hecho es recomendable que tengas un interfaz para cada respuesta esperada.\n\n```typescript\npublic update() {\n  this.httpClient.delete(itemResourceUrl, newValue).subscribe();\n}\npublic delete() {\n  this.httpClient.delete(itemResourceUrl).subscribe();\n}\n```\n\nY hasta aqu lo bsico de comunicaciones *http*. Fcil verdad?. Pero la vida real raramente es tan sencilla. Si quieres enfrentarte a algo ms duro debes prepararte y dominar los observables *RxJS*.\n\nLo que viene a partir de ahora requerir tiempo y concentracin. Si continas adelante esto ya no ser *your grandpas http anymore*.\n\n # 2 Observables\n\nLas **comunicaciones** entre navegadores y servidores son varios rdenes de magnitud ms lentas que las operaciones en memoria. Por tanto deben realizarse de manera asncrona para garantizar una buena experiencia al usuario.\n\nEsta experiencia no siempre fue tan buena para el programador. Sobre todo con las primeras comunicaciones _AJAX_ basadas en el paso de funciones _callback_. La aparicin de las _promises_ mejor la claridad del cdigo, y ahora con los _Observables_ tenemos adems una gran potencia para manipular la **informacin asncrona**.\n\n> El patrn `Observable` fue implementado por Microsoft en la librera [_Reactive Extensions_](http://reactivex.io/intro.html) ms conocida como `RxJs`. El equipo de Angular decidi utilizarla para el desarrollo de las comunicaciones asncronas. Esta extensa librera puede resultar intimidante en un primer vistazo. Pero con muy poco conocimiento puedes programar casi todas las funcionalidades que se te ocurran.\n\nLo primero es importar el cdigo, de forma similar a cualquier otra clase o funcin. Por ejemplo para empezar basta con `import { Observable } from \"rxjs/Observable\";`. Tendremos la clase usada por angular para observar el respuesta *http*.\n\nPero esta es una clase genrica donde sus instancias admiten la manipulacin interna de tipos ms o menos concretos. Por eso ves en el ejemplo que algunas funciones retornan el tipo esperado `: Observable<MyClass>`, o si no saben que tipo esperar se conforman con `: Observable<any>`.\n\nEn cualquier caso, **toda operacin asncrona retornar una instancia observable** a la cual habr que subscribirse para recibir los datos o los errores, cuando termine.\n\nAunque a veces no se ver el _subscribe_...\n\nYa tenemos el programa comunicado por _http_ con un servidor; aunque por ahora de forma annima y sin ninguna seguridad. Necesitamos aumentar el conocimiento actual de los observables, del _httpClient_ con los interceptores y ya estaremos cerca de resolverlo. Sigue esta serie para aadirle [vigilancia y seguridad en Angular](../vigilancia-y-seguridad-en-Angular/) mientras aprendes a programar con Angular. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"comunicaciones-http-en-Angular","published":1,"updated":"2020-04-19T09:36:30.336Z","_id":"ck70mab1u000wbss3kjj51lg9","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-6_http.png\" alt=\"comunicaciones-http-en-Angular\"></p><p>Las comunicaciones <em>http</em> son una pieza fundamental del desarrollo web, y en <strong>Angular</strong> siempre han sido potentes y fciles. Siempre?, bueno cuando apareci Angular 2 echbamos en falta algunas cosillas y adems la librera <em>RxJS</em> y sus <em>streams</em> son intimidantes para los novatos.</p><p>Pero en la versin Angular 9 <strong>consumir un servicio REST</strong> puede ser cosa de nios si aprendes a jugar con los <em>observables</em> y los servicios de la librera <code>@angular/common/http</code>. Conseguirs realizar <strong>comunicaciones http asncronas en Angular</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a>. Al finalizar tendrs una aplicacin que almacena y recupera los datos consumiendo un servicio REST usando las tecnologas de Angular Http.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-El-servicio-HttpClient\"><a href=\"#1-El-servicio-HttpClient\" class=\"headerlink\" title=\"1. El servicio HttpClient\"></a>1. El servicio HttpClient</h1><p>Como demostracin vamos a consumir un API pblica con datos de <a href=\"https://exchangeratesapi.io/\" target=\"_blank\" rel=\"noopener\">cotizacin de monedas</a>. Crear un mdulo y un componente en el que visualizar las divisas y despus las transformaremos para guardarlas en un servicio propio.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m money --route money --module app-routing.module</span><br></pre></td></tr></table></figure><h2 id=\"1-1-Importacion-y-declaracion-de-servicios\"><a href=\"#1-1-Importacion-y-declaracion-de-servicios\" class=\"headerlink\" title=\"1.1 Importacin y declaracin de servicios\"></a>1.1 Importacin y declaracin de servicios</h2><p>La librera <code>@angular/common/http</code> trae el mdulo <code>HttpClientModule</code> con el servicio inyectable <code>HttpClient</code>. Lo primero es importar dicho mdulo.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpClientModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [MoneyComponent],</span><br><span class=\"line\">  imports: [CommonModule, MoneyRoutingModule, HttpClientModule],</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> MoneyModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>En tu componente tienes que reclamar la dependencia al servicio para poder usarla. Atencin a la importacin pues hay ms clases con el nombre <code>HttpClient</code>. Debe quedar algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpClient &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-money'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./money.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> MoneyComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>A partir de este momento slo queda invocar los mtodos REST en la propiedad <code>this.http</code>.</p><h2 id=\"1-2-Obtencion-de-datos\"><a href=\"#1-2-Obtencion-de-datos\" class=\"headerlink\" title=\"1.2 Obtencin de datos\"></a>1.2 Obtencin de datos</h2><p>Para cada verbo <em>http</em> tenemos su mtodo en el servicio <code>HttpClient</code>. Su primer parmetro ser la <em>url</em> a la que invocar. Empecemos por el <code>get</code> que automticamente solicita y devuelve objetos <em>JSON</em> desde un API. Por ejemplo para obtener <a href=\"https://api.exchangeratesapi.io/latest?symbols=USD,GBP,CHF,JPY\" target=\"_blank\" rel=\"noopener\">las ltimas cotizaciones de las principales divisas</a> lo haremos as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> urlapi</span><br><span class=\"line\">    = <span class=\"string\">'https://api.exchangeratesapi.io/latest'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> currentEuroRates: <span class=\"built_in\">any</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.getCurrentEuroRates();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> getCurrentEuroRates() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> currencies = <span class=\"string\">'USD,GBP,CHF,JPY'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> url = <span class=\"string\">`<span class=\"subst\">$&#123;this.urlapi&#125;</span>?symbols=<span class=\"subst\">$&#123;currencies&#125;</span>`</span>;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">      .get(url)</span><br><span class=\"line\">      .subscribe(<span class=\"function\"><span class=\"params\">apiData</span> =&gt;</span> (<span class=\"keyword\">this</span>.currentEuroRates = apiData));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El mtodo <em>get</em> retorna un objeto observable. Los observables <em>http</em> han de consumirse mediante el mtodo <em>subscribe</em> para que realmente se lancen. Dicho mtodo <em>subscribe</em> admite hasta tres <em>callbacks</em> para responder a tres sucesos posibles. Retorno de datos correcto, retorno de un error y seal de finalizacin. La sintaxis original ofrece tres argumentos opcionales para enviarles las funciones callback <code>susbcribe(data, err, end)</code>. En este ejemplo solo hemos usado el primero.</p></blockquote><p>Otra sintaxis ms reciente sustituye los tres argumentos funcionales por un un nico objeto. La ventaja es que puedes usar clases con lgica comn, reutilizarlos en distintas suscripciones, o simplemente tener el cdigo un poco ms organizadito.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">observable$.susbcribe(&#123;</span><br><span class=\"line\">  next: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;&#125;,</span><br><span class=\"line\">  error: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>)</span>&#123;&#125;,</span><br><span class=\"line\">  complete: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;&#125;</span><br><span class=\"line\">  &#125;)</span><br></pre></td></tr></table></figure><p>La presentacin en la vista slo tiene que acceder a la propiedad dnde se hayan cargado las respuestas tratadas en el <em>callback</em> de la suscripcin.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> Currency Rates. <span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> From Euro to the world <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; currentEuroRates | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-3-Envio-de-datos\"><a href=\"#1-3-Envio-de-datos\" class=\"headerlink\" title=\"1.3 Envo de datos\"></a>1.3 Envo de datos</h2><p>Supongamos que, una vez recibidas las cotizaciones, pretendemos transformarlas y almacenarlas en otro servicio. Por ejemplo un objeto para cada da y moneda. El envo en este caso ser con el mtodo <em>post</em> al que se le pasar la ruta del <em>end point</em> y el objeto <em>payload</em> que se enviar al servidor.</p><p>Vamos a agregar una propiedad y un par de mtodos al <code>rates-component.ts</code>. La idea es obtener un array de cotizaciones aa partir del objeto previo, y guardarla una por una.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">      .post(url, payloadObject)</span><br><span class=\"line\">      .subscribe();</span><br></pre></td></tr></table></figure><blockquote><p>Atencin a los mtodos <code>subscribe()</code>. Aunque vayan vacos son imprescindibles para que se ejecute la llamada. Esto puede resultar contra intuitivo, pero la verdad es que los observables Http de Angular slo trabajan si hay alguien mirando.</p></blockquote><h2 id=\"1-4-Actualizacion-de-datos\"><a href=\"#1-4-Actualizacion-de-datos\" class=\"headerlink\" title=\"1.4 Actualizacin de datos\"></a>1.4 Actualizacin de datos</h2><p>Un par de seudo ejemplos ms para acabar de entender la mecnica bsica de <code>HttpClient</code>. Podemos fijar el tipo de datos esperado en cualquier llamada. De hecho es recomendable que tengas un interfaz para cada respuesta esperada.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> update() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.delete(itemResourceUrl, newValue).subscribe();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">delete</span>() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.delete(itemResourceUrl).subscribe();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y hasta aqu lo bsico de comunicaciones <em>http</em>. Fcil verdad?. Pero la vida real raramente es tan sencilla. Si quieres enfrentarte a algo ms duro debes prepararte y dominar los observables <em>RxJS</em>.</p><p>Lo que viene a partir de ahora requerir tiempo y concentracin. Si continas adelante esto ya no ser <em>your grandpas http anymore</em>.</p><h1 id=\"2-Observables\"><a href=\"#2-Observables\" class=\"headerlink\" title=\"2 Observables\"></a>2 Observables</h1><p>Las <strong>comunicaciones</strong> entre navegadores y servidores son varios rdenes de magnitud ms lentas que las operaciones en memoria. Por tanto deben realizarse de manera asncrona para garantizar una buena experiencia al usuario.</p><p>Esta experiencia no siempre fue tan buena para el programador. Sobre todo con las primeras comunicaciones <em>AJAX</em> basadas en el paso de funciones <em>callback</em>. La aparicin de las <em>promises</em> mejor la claridad del cdigo, y ahora con los <em>Observables</em> tenemos adems una gran potencia para manipular la <strong>informacin asncrona</strong>.</p><blockquote><p>El patrn <code>Observable</code> fue implementado por Microsoft en la librera <a href=\"http://reactivex.io/intro.html\" target=\"_blank\" rel=\"noopener\"><em>Reactive Extensions</em></a> ms conocida como <code>RxJs</code>. El equipo de Angular decidi utilizarla para el desarrollo de las comunicaciones asncronas. Esta extensa librera puede resultar intimidante en un primer vistazo. Pero con muy poco conocimiento puedes programar casi todas las funcionalidades que se te ocurran.</p></blockquote><p>Lo primero es importar el cdigo, de forma similar a cualquier otra clase o funcin. Por ejemplo para empezar basta con <code>import { Observable } from &quot;rxjs/Observable&quot;;</code>. Tendremos la clase usada por angular para observar el respuesta <em>http</em>.</p><p>Pero esta es una clase genrica donde sus instancias admiten la manipulacin interna de tipos ms o menos concretos. Por eso ves en el ejemplo que algunas funciones retornan el tipo esperado <code>: Observable&lt;MyClass&gt;</code>, o si no saben que tipo esperar se conforman con <code>: Observable&lt;any&gt;</code>.</p><p>En cualquier caso, <strong>toda operacin asncrona retornar una instancia observable</strong> a la cual habr que subscribirse para recibir los datos o los errores, cuando termine.</p><p>Aunque a veces no se ver el <em>subscribe</em></p><p>Ya tenemos el programa comunicado por <em>http</em> con un servidor; aunque por ahora de forma annima y sin ninguna seguridad. Necesitamos aumentar el conocimiento actual de los observables, del <em>httpClient</em> con los interceptores y ya estaremos cerca de resolverlo. Sigue esta serie para aadirle <a href=\"../vigilancia-y-seguridad-en-Angular/\">vigilancia y seguridad en Angular</a> mientras aprendes a programar con Angular. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-6_http.png\" alt=\"comunicaciones-http-en-Angular\"></p><p>Las comunicaciones <em>http</em> son una pieza fundamental del desarrollo web, y en <strong>Angular</strong> siempre han sido potentes y fciles. Siempre?, bueno cuando apareci Angular 2 echbamos en falta algunas cosillas y adems la librera <em>RxJS</em> y sus <em>streams</em> son intimidantes para los novatos.</p><p>Pero en la versin Angular 9 <strong>consumir un servicio REST</strong> puede ser cosa de nios si aprendes a jugar con los <em>observables</em> y los servicios de la librera <code>@angular/common/http</code>. Conseguirs realizar <strong>comunicaciones http asncronas en Angular</strong>.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a>. Al finalizar tendrs una aplicacin que almacena y recupera los datos consumiendo un servicio REST usando las tecnologas de Angular Http.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-El-servicio-HttpClient\"><a href=\"#1-El-servicio-HttpClient\" class=\"headerlink\" title=\"1. El servicio HttpClient\"></a>1. El servicio HttpClient</h1><p>Como demostracin vamos a consumir un API pblica con datos de <a href=\"https://exchangeratesapi.io/\" target=\"_blank\" rel=\"noopener\">cotizacin de monedas</a>. Crear un mdulo y un componente en el que visualizar las divisas y despus las transformaremos para guardarlas en un servicio propio.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m money --route money --module app-routing.module</span><br></pre></td></tr></table></figure><h2 id=\"1-1-Importacion-y-declaracion-de-servicios\"><a href=\"#1-1-Importacion-y-declaracion-de-servicios\" class=\"headerlink\" title=\"1.1 Importacin y declaracin de servicios\"></a>1.1 Importacin y declaracin de servicios</h2><p>La librera <code>@angular/common/http</code> trae el mdulo <code>HttpClientModule</code> con el servicio inyectable <code>HttpClient</code>. Lo primero es importar dicho mdulo.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpClientModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [MoneyComponent],</span><br><span class=\"line\">  imports: [CommonModule, MoneyRoutingModule, HttpClientModule],</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> MoneyModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>En tu componente tienes que reclamar la dependencia al servicio para poder usarla. Atencin a la importacin pues hay ms clases con el nombre <code>HttpClient</code>. Debe quedar algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpClient &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-money'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./money.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> MoneyComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>A partir de este momento slo queda invocar los mtodos REST en la propiedad <code>this.http</code>.</p><h2 id=\"1-2-Obtencion-de-datos\"><a href=\"#1-2-Obtencion-de-datos\" class=\"headerlink\" title=\"1.2 Obtencin de datos\"></a>1.2 Obtencin de datos</h2><p>Para cada verbo <em>http</em> tenemos su mtodo en el servicio <code>HttpClient</code>. Su primer parmetro ser la <em>url</em> a la que invocar. Empecemos por el <code>get</code> que automticamente solicita y devuelve objetos <em>JSON</em> desde un API. Por ejemplo para obtener <a href=\"https://api.exchangeratesapi.io/latest?symbols=USD,GBP,CHF,JPY\" target=\"_blank\" rel=\"noopener\">las ltimas cotizaciones de las principales divisas</a> lo haremos as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> urlapi</span><br><span class=\"line\">    = <span class=\"string\">'https://api.exchangeratesapi.io/latest'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> currentEuroRates: <span class=\"built_in\">any</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.getCurrentEuroRates();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> getCurrentEuroRates() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> currencies = <span class=\"string\">'USD,GBP,CHF,JPY'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> url = <span class=\"string\">`<span class=\"subst\">$&#123;this.urlapi&#125;</span>?symbols=<span class=\"subst\">$&#123;currencies&#125;</span>`</span>;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">      .get(url)</span><br><span class=\"line\">      .subscribe(<span class=\"function\"><span class=\"params\">apiData</span> =&gt;</span> (<span class=\"keyword\">this</span>.currentEuroRates = apiData));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El mtodo <em>get</em> retorna un objeto observable. Los observables <em>http</em> han de consumirse mediante el mtodo <em>subscribe</em> para que realmente se lancen. Dicho mtodo <em>subscribe</em> admite hasta tres <em>callbacks</em> para responder a tres sucesos posibles. Retorno de datos correcto, retorno de un error y seal de finalizacin. La sintaxis original ofrece tres argumentos opcionales para enviarles las funciones callback <code>susbcribe(data, err, end)</code>. En este ejemplo solo hemos usado el primero.</p></blockquote><p>Otra sintaxis ms reciente sustituye los tres argumentos funcionales por un un nico objeto. La ventaja es que puedes usar clases con lgica comn, reutilizarlos en distintas suscripciones, o simplemente tener el cdigo un poco ms organizadito.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">observable$.susbcribe(&#123;</span><br><span class=\"line\">  next: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>)</span>&#123;&#125;,</span><br><span class=\"line\">  error: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err</span>)</span>&#123;&#125;,</span><br><span class=\"line\">  complete: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;&#125;</span><br><span class=\"line\">  &#125;)</span><br></pre></td></tr></table></figure><p>La presentacin en la vista slo tiene que acceder a la propiedad dnde se hayan cargado las respuestas tratadas en el <em>callback</em> de la suscripcin.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> Currency Rates. <span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> From Euro to the world <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; currentEuroRates | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-3-Envio-de-datos\"><a href=\"#1-3-Envio-de-datos\" class=\"headerlink\" title=\"1.3 Envo de datos\"></a>1.3 Envo de datos</h2><p>Supongamos que, una vez recibidas las cotizaciones, pretendemos transformarlas y almacenarlas en otro servicio. Por ejemplo un objeto para cada da y moneda. El envo en este caso ser con el mtodo <em>post</em> al que se le pasar la ruta del <em>end point</em> y el objeto <em>payload</em> que se enviar al servidor.</p><p>Vamos a agregar una propiedad y un par de mtodos al <code>rates-component.ts</code>. La idea es obtener un array de cotizaciones aa partir del objeto previo, y guardarla una por una.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">      .post(url, payloadObject)</span><br><span class=\"line\">      .subscribe();</span><br></pre></td></tr></table></figure><blockquote><p>Atencin a los mtodos <code>subscribe()</code>. Aunque vayan vacos son imprescindibles para que se ejecute la llamada. Esto puede resultar contra intuitivo, pero la verdad es que los observables Http de Angular slo trabajan si hay alguien mirando.</p></blockquote><h2 id=\"1-4-Actualizacion-de-datos\"><a href=\"#1-4-Actualizacion-de-datos\" class=\"headerlink\" title=\"1.4 Actualizacin de datos\"></a>1.4 Actualizacin de datos</h2><p>Un par de seudo ejemplos ms para acabar de entender la mecnica bsica de <code>HttpClient</code>. Podemos fijar el tipo de datos esperado en cualquier llamada. De hecho es recomendable que tengas un interfaz para cada respuesta esperada.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> update() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.delete(itemResourceUrl, newValue).subscribe();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">delete</span>() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.delete(itemResourceUrl).subscribe();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y hasta aqu lo bsico de comunicaciones <em>http</em>. Fcil verdad?. Pero la vida real raramente es tan sencilla. Si quieres enfrentarte a algo ms duro debes prepararte y dominar los observables <em>RxJS</em>.</p><p>Lo que viene a partir de ahora requerir tiempo y concentracin. Si continas adelante esto ya no ser <em>your grandpas http anymore</em>.</p><h1 id=\"2-Observables\"><a href=\"#2-Observables\" class=\"headerlink\" title=\"2 Observables\"></a>2 Observables</h1><p>Las <strong>comunicaciones</strong> entre navegadores y servidores son varios rdenes de magnitud ms lentas que las operaciones en memoria. Por tanto deben realizarse de manera asncrona para garantizar una buena experiencia al usuario.</p><p>Esta experiencia no siempre fue tan buena para el programador. Sobre todo con las primeras comunicaciones <em>AJAX</em> basadas en el paso de funciones <em>callback</em>. La aparicin de las <em>promises</em> mejor la claridad del cdigo, y ahora con los <em>Observables</em> tenemos adems una gran potencia para manipular la <strong>informacin asncrona</strong>.</p><blockquote><p>El patrn <code>Observable</code> fue implementado por Microsoft en la librera <a href=\"http://reactivex.io/intro.html\" target=\"_blank\" rel=\"noopener\"><em>Reactive Extensions</em></a> ms conocida como <code>RxJs</code>. El equipo de Angular decidi utilizarla para el desarrollo de las comunicaciones asncronas. Esta extensa librera puede resultar intimidante en un primer vistazo. Pero con muy poco conocimiento puedes programar casi todas las funcionalidades que se te ocurran.</p></blockquote><p>Lo primero es importar el cdigo, de forma similar a cualquier otra clase o funcin. Por ejemplo para empezar basta con <code>import { Observable } from &quot;rxjs/Observable&quot;;</code>. Tendremos la clase usada por angular para observar el respuesta <em>http</em>.</p><p>Pero esta es una clase genrica donde sus instancias admiten la manipulacin interna de tipos ms o menos concretos. Por eso ves en el ejemplo que algunas funciones retornan el tipo esperado <code>: Observable&lt;MyClass&gt;</code>, o si no saben que tipo esperar se conforman con <code>: Observable&lt;any&gt;</code>.</p><p>En cualquier caso, <strong>toda operacin asncrona retornar una instancia observable</strong> a la cual habr que subscribirse para recibir los datos o los errores, cuando termine.</p><p>Aunque a veces no se ver el <em>subscribe</em></p><p>Ya tenemos el programa comunicado por <em>http</em> con un servidor; aunque por ahora de forma annima y sin ninguna seguridad. Necesitamos aumentar el conocimiento actual de los observables, del <em>httpClient</em> con los interceptores y ya estaremos cerca de resolverlo. Sigue esta serie para aadirle <a href=\"../vigilancia-y-seguridad-en-Angular/\">vigilancia y seguridad en Angular</a> mientras aprendes a programar con Angular. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Vigilancia y seguridad en Angular","date":"2020-04-19T09:49:27.000Z","thumbnail":"/css/images/angular-7_watch.png","_content":"\n![vigilancia-y-seguridad-en-Angular](/images/tutorial-angular-7_watch.png)\n\nLa **vigilancia** de los datos y la informacin en tiempo real al usuario son dos pilares del desarrollo con Angular en el lado del navegador. La **seguridad** de los datos realmente es una responsabilidad compartida entre el servidor y el cliente.\n\nVeremos ambos aspectos del desarrollo, pues estn muy relacionados con la programacin asncrona y el dominio de los observables. Sentaremos las bases para unas **comunicaciones seguras y fluidas en Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Comunicaciones http en Angular](../comunicaciones-http-en-Angular/). Al finalizar tendrs una aplicacin que comunica a los usuarios cualquier informacin relevante y que gestiona de forma centralizada las respuestas de un servicio REST.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Observables para monitorizar datos\n\nHemos visto varias tcnicas para comunicar informacin dentro de una aplicacin Angular. Empezamos por conocer el [flujo entre componentes](../flujo-de-datos-entre-componentes-angular/) de una misma rama del DOM. Tambin enviamos datos en los [parmetros de una ruta](../paginas-y-rutas-angular-spa/). Y obviamente podemos usar [un servicio comn](../servicios-inyectables-en-Angular/) para guardar informacin compartida. Pero en este caso, Cundo se actualiza? Cmo saber si ha cambiado?. Lo resolveremos con `Observables`.\n\nPara ilustrar este tema vamos a crear una web que muestra los datos de los prximos 5 lanzamientos espaciales. Y despus un sencillo sistema de notificaciones que simula las comunicaciones de la Nasa. Empezaremos creando un mdulo para los propsitos de este laboratorio.\n\n```console\nng g m rockets --route rockets --module app-routing.module\n```\n\nY en el componente tendremos que usar llamadas http pero sin suscripciones manuales. En su lugar nos quedamos con el observable y lo consumimos desde la vista con una de mis pipes preferidas: ` | async`\n\n```typescript\n  private rocketsApi = 'https://launchlibrary.net/1.4/';\n  public nextLaunches$: Observable<any> = null;\n\n  constructor(private httpClient: HttpClient) {}\n\n  ngOnInit() {\n    this.getNextLaunches();\n  }\n\n  private getNextLaunches() {\n    const url = this.rocketsApi + 'launch/next/5';\n    this.nextLaunches$ = this.httpClient.get<any>(url);\n  }\n```\n\nEn la plantilla accedemos al observable. La tubera se suscribe y retorna el resultado cuando se reciba. El _pipe_ `json` nos permite ver el resultado.\n\n```html\n<h3> Next 5 rocket launches </h3>\n<pre>{{ nextLaunches$ | async | json }}</pre>\n```\n\nY eso es todo. Casi nunca tendrs que suscribirte en cdigo. Deja que ese trabajo sucio lo haga el _pipe async_.\nPero, siempre hay un pero, rara vez los datos te vendrn tal cual los necesitas. Casi seguro que en ocasiones habr que filtrarlos, ordenarlos y sobre todo aplicarles alguna trasformacin. Para ello, antes tienes que saber un poco ms de observables.\n\n# 2 Observables\n\nLa librera [RxJS](https://www.learnrxjs.io/) es enorme y Angular hace un uso extenso de ella. En este tutorial [se ha visto desde el punto de vista del consumidor](../comunicaciones-http-en-Angular). Es decir, nos hemos suscrito a fuentes observables. Para avanzar tendremos que poder emitir, o mejor dicho producir, informacin.\n\n## 2.1 Productores simples of y from\n\nLos constructores ms sencillos de la librera son **funciones que emiten valores estticos** o secuencias a intervalos regulares. Para familiarizarte con ellos te propongo que juegues con cdigo como este:\n\n```typescript\nvalue$ = of(new Date().getMilliseconds());\nvalue$.subscribe(r=> console.log(r));\nstream$ = from([1, 'two', '***']);\nstream$.subscribe(r=> console.log(r));\nlist$ = of(['N', 'S', 'E', 'W']);\nlist$.subscribe(r=> console.log(r));\n```\n\n## 2.2 Operadores simples map y tap\n\nTratamos a los observables como un flujo, un _stream_ de datos; algo similar a un riachuelo de gotas de agua. A cada dato recibido le podemos aplicar funciones; sera como aplicar algn tratamiento al agua del riachuelo. Vamos a empezar con dos categoras de acciones: las que transforma en contenido, y la que tienen efectos secundarios.\n\nPara ello disponemos de unas funciones de primer orden llamadas operadores. Estas funciones reciben como argumento a otras funciones en las que t programas las acciones de transformacin o efecto.\n\nEl operador de transformacin se llama `map()` y el de efectos se llama `tap()`. Ambos se pueden usar cuantas veces se quiera y en cualquier orden. Slo hay que meterlos dentro de una funcin superior. La funcin `pipe()`; que da nombre al proceso: entubar el stream.\n\n```typescript\nnumbers$ = from([1, 2, 3, 4]);\ndoubles$ = numbers$\n  .pipe(\n    map(x=> 2 * x ),\n    tap(x=Z console.log(x)) // 2 4 6 8\n    );\n```\n\n\nApliquemos esto a los cohetes. Por ejemplo editando y transformando los datos recibidos desde el api:\n\n```typescript\nprivate getNextLaunches() {\n  const url = this.rocketsApi + 'launch/next/5';\n  this.nextLaunches$ = this.httpClient.get<any>(url).pipe(\n    map(apiData => apiData.launches),\n    map(launchesArray =>\n      launchesArray.map(launch => ({\n        name: launch.name,\n        status: launch.status,\n        scheduled: launch.net,\n      }))\n    ),\n    map(customLaunches =>\n      customLaunches.map(launch => ({\n        ...launch,\n        statusColor: launch.status === 1 ? 'green' : 'red',\n      }))\n    ),\n    tap(rockets => console.log('num rockets:' + rockets.length)),\n    tap(() => console.log('ha pasado algo')),\n    map(()=>{\n      const a =2;\n    })\n  );\n}\n```\n\nDe esta forma la _template_ ya recibe los datos listos para presentar de una manera ms vistosa y limpia.\n\n\n```html\n<ul *ngIf=\"nextLaunches$ | async as nextLaunches; else loading\">\n  <li *ngFor=\"let launch of nextLaunches\"\n      [style.color]=\"launch.statusColor\">\n    <b>{{ launch.name }}</b><i>{{ launch.scheduled }}</i>\n  </li>\n</ul>\n<ng-template #loading>\n  <i>Loading rocket data... </i>\n</ng-template>\n```\n\n# 3 Un store de notificaciones\n\n## 3.1 Subject y BehaviorSubject\n\nLos anteriores constructores se basan en datos estticos. Resuelvan algunas situaciones, pero necesitamos algo que emita **cambios dinmicos**. Y eso se realiza con los _Subjects_, una especie de emisores temticos a los que suscribirse.\n\nHay varios tipos pero para empezar nos vamos a fijar en dos: el `Subject()` y el `BehaviorSubject(initialData)`. La diferencia es que el primero slo emite las cosas segn ocurren. Si alguien se suscribe tarde no conocer el pasado. Esto suele generar problemas de sincronizacin. El _Behavior_ en cambio notifica el ltimo valor conocido a cualquiera que se suscriba. De esa forma no importa si te suscribes antes o despus de la obtencin de un dato.\n\nJuega con el siguiente ejemplo:\n\n```typescript\nconst data = {name:'', value:0};\n\nconst need_sync$ = new Subject<any>();\n// on time\nneed_sync.subscribe(r=> console.log(r));\nneed_sync.next(data);\n// too late\nneed_sync.subscribe(r=> console.log(r));\n\nconst no_hurry$ = new BehaviorSubject<any>(this.data);\n// its ok\nno_hurry.subscribe(r=> console.log(r));\nno_hurry.next(data);\n// its also ok\nno_hurry.subscribe(r=> console.log(r));\n```\n\n## 3.2 Un Store de notificaciones\n\nUsaremos el `BehaviorSubject` como notificador principal entre componentes de Angular. Por ejemplo podemos montar un sistema de notificaciones sencillo. Empecemos por crear un servicio:\n\n```bash\nng g m rockets/nasa --route nasa --module rockets/rockets-routing.module\nng g c rockets/nasa/houston\nng g c rockets/nasa/florida\n```\n\n  Este servicio es la implementacin ms sencilla posible de un gestor de estados. Cabe destacar que :\n\n```typescript\nexport class MissionsComunicationService {\n  private messages: object[] = [{ icon: '', subject: 'Crew on board' }];\n  private messages$ = new BehaviorSubject<any[]>(this.messages);\n\n  constructor() {}\n\n  public getMessages$ = () => this.messages$.asObservable();\n\n  public sendMessage = (message: object) => {\n    this.messages.push(message);\n    this.messages$.next(this.messages);\n  };\n}\n```\n\n- Mantienen el estado privado para evitar manipulaciones\n- Recibe de forma controlada las acciones de cambio\n- Emite clones del estado\n- Expone observables para que se suscriban los interesados.\n\n> Podra adaptar a la nomenclatura usada por patrones de gestin de estado ms avanzados como es **Redux**, y usar el siguiente convenio: _Store_ como almacn, _select$()_ como publicador de cambios observable y _dispatch_ como encargado de procesar una accin de cambio de estado.\n\n## 3.3 Desacoplados pero conectados\n\nUna vez que hemos centralizado el control de cambios de una parte de la aplicacin, es hora de que lo usen los componentes o servicios involucrados. Solo necesitan recibir la instancia va dependencia. **No hay ms acoplamiento entre emisores y receptores.**\n\n### Emisin\n\nVeamos un ejemplo, un tanto forzado,  consistente en dos componentes que se comunican sin conocerse. Esta es la vista con un formulario para enviar mensajes\n\n```html\n<h4>Houston mission control</h4>\n<p><button> Start count down </button></p>\n<p><button> Ignition </button></p>\n<p><button> Abort </button></p>\n```\n\nLa parte interesante est en el controlador. Dependencia y uso del servicio del almacn de notificaciones\n\n```typescript\nexport class HoustonComponent implements OnInit {\n  constructor(private missionsComunicationService: MissionsComunicationService) {}\n\n  ngOnInit(): void {}\n\n  onStartClick() {\n    this.missionsComunicationService.sendMessage({ icon: '', subject: 'Start count down' });\n  }\n  onIgnitionClick() {\n    this.missionsComunicationService.sendMessage({ icon: '', subject: 'Ignition' });\n  }\n  onAbortClick() {\n    this.missionsComunicationService.sendMessage({ icon: '', subject: 'Abort' });\n  }\n}\n```\n\n### Recepcin\n\nLa recepcin es igual de sencilla. En el controlador reclamamos la misma dependencia para el uso del servicio del almacn de notificaciones.\n\n```typescript\nexport class FloridaComponent implements OnInit {\n  messages$: Observable<any>;\n\n  constructor(private missionsComunicationService: MissionsComunicationService) {}\n\n  ngOnInit(): void {\n    this.messages$ = this.missionsComunicationService.getMessages$();\n  }\n}\n```\n\nEn la vista pondremos un listado de notificaciones que se alimenta de un array emitido por un observable.\n\n```html\n<h4>Florida launch pad</h4>\n<p> Mission log</p>\n<ul>\n  <li *ngFor=\"let message of messages$ | async\">{{ message }}</li>\n</ul>\n```\n\nEs importante recalcar que **no importa el orden de suscripcin**. Estos dos componentes podran _vivir_ en mdulos distintos, verse en la misma pgina o inicializarse en cualquier orden... El receptor se entera siempre de todos los cambios; y adems recibe el ltimo estado conocido nada ms suscribirse.\n\n\n\nTenemos ahora a nuestro usuario puntualmente informado de todo lo que sucede. Hemos utilizado **patrones de arquitectura de software** como el observable y la inversin del control. El resultado es una serie de componentes y servicios poco acoplados que intercambian informacin en tiempo real.\n\nPero hay temas ms avanzados con los que continuar. Sigue esta serie para introducir ms temas de seguridad y crear tus [formularios reactivos con Angular](../formularios-reactivos-con-Angular/) mientras aprendes a programar con Angular. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-7-Vigilancia-y-seguridad-en-Angular.md","raw":"---\ntitle: Vigilancia y seguridad en Angular\npermalink: vigilancia-y-seguridad-en-Angular\ndate: 2020-04-19 11:49:27\ntags:\n- Angular\n- http\n- Observables\n- Tutorial\n- Introduccin\n- Angular9\n- Angular2\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-7_watch.png\n---\n\n![vigilancia-y-seguridad-en-Angular](/images/tutorial-angular-7_watch.png)\n\nLa **vigilancia** de los datos y la informacin en tiempo real al usuario son dos pilares del desarrollo con Angular en el lado del navegador. La **seguridad** de los datos realmente es una responsabilidad compartida entre el servidor y el cliente.\n\nVeremos ambos aspectos del desarrollo, pues estn muy relacionados con la programacin asncrona y el dominio de los observables. Sentaremos las bases para unas **comunicaciones seguras y fluidas en Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Comunicaciones http en Angular](../comunicaciones-http-en-Angular/). Al finalizar tendrs una aplicacin que comunica a los usuarios cualquier informacin relevante y que gestiona de forma centralizada las respuestas de un servicio REST.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Observables para monitorizar datos\n\nHemos visto varias tcnicas para comunicar informacin dentro de una aplicacin Angular. Empezamos por conocer el [flujo entre componentes](../flujo-de-datos-entre-componentes-angular/) de una misma rama del DOM. Tambin enviamos datos en los [parmetros de una ruta](../paginas-y-rutas-angular-spa/). Y obviamente podemos usar [un servicio comn](../servicios-inyectables-en-Angular/) para guardar informacin compartida. Pero en este caso, Cundo se actualiza? Cmo saber si ha cambiado?. Lo resolveremos con `Observables`.\n\nPara ilustrar este tema vamos a crear una web que muestra los datos de los prximos 5 lanzamientos espaciales. Y despus un sencillo sistema de notificaciones que simula las comunicaciones de la Nasa. Empezaremos creando un mdulo para los propsitos de este laboratorio.\n\n```console\nng g m rockets --route rockets --module app-routing.module\n```\n\nY en el componente tendremos que usar llamadas http pero sin suscripciones manuales. En su lugar nos quedamos con el observable y lo consumimos desde la vista con una de mis pipes preferidas: ` | async`\n\n```typescript\n  private rocketsApi = 'https://launchlibrary.net/1.4/';\n  public nextLaunches$: Observable<any> = null;\n\n  constructor(private httpClient: HttpClient) {}\n\n  ngOnInit() {\n    this.getNextLaunches();\n  }\n\n  private getNextLaunches() {\n    const url = this.rocketsApi + 'launch/next/5';\n    this.nextLaunches$ = this.httpClient.get<any>(url);\n  }\n```\n\nEn la plantilla accedemos al observable. La tubera se suscribe y retorna el resultado cuando se reciba. El _pipe_ `json` nos permite ver el resultado.\n\n```html\n<h3> Next 5 rocket launches </h3>\n<pre>{{ nextLaunches$ | async | json }}</pre>\n```\n\nY eso es todo. Casi nunca tendrs que suscribirte en cdigo. Deja que ese trabajo sucio lo haga el _pipe async_.\nPero, siempre hay un pero, rara vez los datos te vendrn tal cual los necesitas. Casi seguro que en ocasiones habr que filtrarlos, ordenarlos y sobre todo aplicarles alguna trasformacin. Para ello, antes tienes que saber un poco ms de observables.\n\n# 2 Observables\n\nLa librera [RxJS](https://www.learnrxjs.io/) es enorme y Angular hace un uso extenso de ella. En este tutorial [se ha visto desde el punto de vista del consumidor](../comunicaciones-http-en-Angular). Es decir, nos hemos suscrito a fuentes observables. Para avanzar tendremos que poder emitir, o mejor dicho producir, informacin.\n\n## 2.1 Productores simples of y from\n\nLos constructores ms sencillos de la librera son **funciones que emiten valores estticos** o secuencias a intervalos regulares. Para familiarizarte con ellos te propongo que juegues con cdigo como este:\n\n```typescript\nvalue$ = of(new Date().getMilliseconds());\nvalue$.subscribe(r=> console.log(r));\nstream$ = from([1, 'two', '***']);\nstream$.subscribe(r=> console.log(r));\nlist$ = of(['N', 'S', 'E', 'W']);\nlist$.subscribe(r=> console.log(r));\n```\n\n## 2.2 Operadores simples map y tap\n\nTratamos a los observables como un flujo, un _stream_ de datos; algo similar a un riachuelo de gotas de agua. A cada dato recibido le podemos aplicar funciones; sera como aplicar algn tratamiento al agua del riachuelo. Vamos a empezar con dos categoras de acciones: las que transforma en contenido, y la que tienen efectos secundarios.\n\nPara ello disponemos de unas funciones de primer orden llamadas operadores. Estas funciones reciben como argumento a otras funciones en las que t programas las acciones de transformacin o efecto.\n\nEl operador de transformacin se llama `map()` y el de efectos se llama `tap()`. Ambos se pueden usar cuantas veces se quiera y en cualquier orden. Slo hay que meterlos dentro de una funcin superior. La funcin `pipe()`; que da nombre al proceso: entubar el stream.\n\n```typescript\nnumbers$ = from([1, 2, 3, 4]);\ndoubles$ = numbers$\n  .pipe(\n    map(x=> 2 * x ),\n    tap(x=Z console.log(x)) // 2 4 6 8\n    );\n```\n\n\nApliquemos esto a los cohetes. Por ejemplo editando y transformando los datos recibidos desde el api:\n\n```typescript\nprivate getNextLaunches() {\n  const url = this.rocketsApi + 'launch/next/5';\n  this.nextLaunches$ = this.httpClient.get<any>(url).pipe(\n    map(apiData => apiData.launches),\n    map(launchesArray =>\n      launchesArray.map(launch => ({\n        name: launch.name,\n        status: launch.status,\n        scheduled: launch.net,\n      }))\n    ),\n    map(customLaunches =>\n      customLaunches.map(launch => ({\n        ...launch,\n        statusColor: launch.status === 1 ? 'green' : 'red',\n      }))\n    ),\n    tap(rockets => console.log('num rockets:' + rockets.length)),\n    tap(() => console.log('ha pasado algo')),\n    map(()=>{\n      const a =2;\n    })\n  );\n}\n```\n\nDe esta forma la _template_ ya recibe los datos listos para presentar de una manera ms vistosa y limpia.\n\n\n```html\n<ul *ngIf=\"nextLaunches$ | async as nextLaunches; else loading\">\n  <li *ngFor=\"let launch of nextLaunches\"\n      [style.color]=\"launch.statusColor\">\n    <b>{{ launch.name }}</b><i>{{ launch.scheduled }}</i>\n  </li>\n</ul>\n<ng-template #loading>\n  <i>Loading rocket data... </i>\n</ng-template>\n```\n\n# 3 Un store de notificaciones\n\n## 3.1 Subject y BehaviorSubject\n\nLos anteriores constructores se basan en datos estticos. Resuelvan algunas situaciones, pero necesitamos algo que emita **cambios dinmicos**. Y eso se realiza con los _Subjects_, una especie de emisores temticos a los que suscribirse.\n\nHay varios tipos pero para empezar nos vamos a fijar en dos: el `Subject()` y el `BehaviorSubject(initialData)`. La diferencia es que el primero slo emite las cosas segn ocurren. Si alguien se suscribe tarde no conocer el pasado. Esto suele generar problemas de sincronizacin. El _Behavior_ en cambio notifica el ltimo valor conocido a cualquiera que se suscriba. De esa forma no importa si te suscribes antes o despus de la obtencin de un dato.\n\nJuega con el siguiente ejemplo:\n\n```typescript\nconst data = {name:'', value:0};\n\nconst need_sync$ = new Subject<any>();\n// on time\nneed_sync.subscribe(r=> console.log(r));\nneed_sync.next(data);\n// too late\nneed_sync.subscribe(r=> console.log(r));\n\nconst no_hurry$ = new BehaviorSubject<any>(this.data);\n// its ok\nno_hurry.subscribe(r=> console.log(r));\nno_hurry.next(data);\n// its also ok\nno_hurry.subscribe(r=> console.log(r));\n```\n\n## 3.2 Un Store de notificaciones\n\nUsaremos el `BehaviorSubject` como notificador principal entre componentes de Angular. Por ejemplo podemos montar un sistema de notificaciones sencillo. Empecemos por crear un servicio:\n\n```bash\nng g m rockets/nasa --route nasa --module rockets/rockets-routing.module\nng g c rockets/nasa/houston\nng g c rockets/nasa/florida\n```\n\n  Este servicio es la implementacin ms sencilla posible de un gestor de estados. Cabe destacar que :\n\n```typescript\nexport class MissionsComunicationService {\n  private messages: object[] = [{ icon: '', subject: 'Crew on board' }];\n  private messages$ = new BehaviorSubject<any[]>(this.messages);\n\n  constructor() {}\n\n  public getMessages$ = () => this.messages$.asObservable();\n\n  public sendMessage = (message: object) => {\n    this.messages.push(message);\n    this.messages$.next(this.messages);\n  };\n}\n```\n\n- Mantienen el estado privado para evitar manipulaciones\n- Recibe de forma controlada las acciones de cambio\n- Emite clones del estado\n- Expone observables para que se suscriban los interesados.\n\n> Podra adaptar a la nomenclatura usada por patrones de gestin de estado ms avanzados como es **Redux**, y usar el siguiente convenio: _Store_ como almacn, _select$()_ como publicador de cambios observable y _dispatch_ como encargado de procesar una accin de cambio de estado.\n\n## 3.3 Desacoplados pero conectados\n\nUna vez que hemos centralizado el control de cambios de una parte de la aplicacin, es hora de que lo usen los componentes o servicios involucrados. Solo necesitan recibir la instancia va dependencia. **No hay ms acoplamiento entre emisores y receptores.**\n\n### Emisin\n\nVeamos un ejemplo, un tanto forzado,  consistente en dos componentes que se comunican sin conocerse. Esta es la vista con un formulario para enviar mensajes\n\n```html\n<h4>Houston mission control</h4>\n<p><button> Start count down </button></p>\n<p><button> Ignition </button></p>\n<p><button> Abort </button></p>\n```\n\nLa parte interesante est en el controlador. Dependencia y uso del servicio del almacn de notificaciones\n\n```typescript\nexport class HoustonComponent implements OnInit {\n  constructor(private missionsComunicationService: MissionsComunicationService) {}\n\n  ngOnInit(): void {}\n\n  onStartClick() {\n    this.missionsComunicationService.sendMessage({ icon: '', subject: 'Start count down' });\n  }\n  onIgnitionClick() {\n    this.missionsComunicationService.sendMessage({ icon: '', subject: 'Ignition' });\n  }\n  onAbortClick() {\n    this.missionsComunicationService.sendMessage({ icon: '', subject: 'Abort' });\n  }\n}\n```\n\n### Recepcin\n\nLa recepcin es igual de sencilla. En el controlador reclamamos la misma dependencia para el uso del servicio del almacn de notificaciones.\n\n```typescript\nexport class FloridaComponent implements OnInit {\n  messages$: Observable<any>;\n\n  constructor(private missionsComunicationService: MissionsComunicationService) {}\n\n  ngOnInit(): void {\n    this.messages$ = this.missionsComunicationService.getMessages$();\n  }\n}\n```\n\nEn la vista pondremos un listado de notificaciones que se alimenta de un array emitido por un observable.\n\n```html\n<h4>Florida launch pad</h4>\n<p> Mission log</p>\n<ul>\n  <li *ngFor=\"let message of messages$ | async\">{{ message }}</li>\n</ul>\n```\n\nEs importante recalcar que **no importa el orden de suscripcin**. Estos dos componentes podran _vivir_ en mdulos distintos, verse en la misma pgina o inicializarse en cualquier orden... El receptor se entera siempre de todos los cambios; y adems recibe el ltimo estado conocido nada ms suscribirse.\n\n\n\nTenemos ahora a nuestro usuario puntualmente informado de todo lo que sucede. Hemos utilizado **patrones de arquitectura de software** como el observable y la inversin del control. El resultado es una serie de componentes y servicios poco acoplados que intercambian informacin en tiempo real.\n\nPero hay temas ms avanzados con los que continuar. Sigue esta serie para introducir ms temas de seguridad y crear tus [formularios reactivos con Angular](../formularios-reactivos-con-Angular/) mientras aprendes a programar con Angular. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"vigilancia-y-seguridad-en-Angular","published":1,"updated":"2020-04-19T09:36:30.387Z","_id":"ck70mab1v000xbss3rcjrlu1p","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-7_watch.png\" alt=\"vigilancia-y-seguridad-en-Angular\"></p><p>La <strong>vigilancia</strong> de los datos y la informacin en tiempo real al usuario son dos pilares del desarrollo con Angular en el lado del navegador. La <strong>seguridad</strong> de los datos realmente es una responsabilidad compartida entre el servidor y el cliente.</p><p>Veremos ambos aspectos del desarrollo, pues estn muy relacionados con la programacin asncrona y el dominio de los observables. Sentaremos las bases para unas <strong>comunicaciones seguras y fluidas en Angular</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones http en Angular</a>. Al finalizar tendrs una aplicacin que comunica a los usuarios cualquier informacin relevante y que gestiona de forma centralizada las respuestas de un servicio REST.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Observables-para-monitorizar-datos\"><a href=\"#1-Observables-para-monitorizar-datos\" class=\"headerlink\" title=\"1. Observables para monitorizar datos\"></a>1. Observables para monitorizar datos</h1><p>Hemos visto varias tcnicas para comunicar informacin dentro de una aplicacin Angular. Empezamos por conocer el <a href=\"../flujo-de-datos-entre-componentes-angular/\">flujo entre componentes</a> de una misma rama del DOM. Tambin enviamos datos en los <a href=\"../paginas-y-rutas-angular-spa/\">parmetros de una ruta</a>. Y obviamente podemos usar <a href=\"../servicios-inyectables-en-Angular/\">un servicio comn</a> para guardar informacin compartida. Pero en este caso, Cundo se actualiza? Cmo saber si ha cambiado?. Lo resolveremos con <code>Observables</code>.</p><p>Para ilustrar este tema vamos a crear una web que muestra los datos de los prximos 5 lanzamientos espaciales. Y despus un sencillo sistema de notificaciones que simula las comunicaciones de la Nasa. Empezaremos creando un mdulo para los propsitos de este laboratorio.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m rockets --route rockets --module app-routing.module</span><br></pre></td></tr></table></figure><p>Y en el componente tendremos que usar llamadas http pero sin suscripciones manuales. En su lugar nos quedamos con el observable y lo consumimos desde la vista con una de mis pipes preferidas: <code>| async</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> rocketsApi = <span class=\"string\">'https://launchlibrary.net/1.4/'</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> nextLaunches$: Observable&lt;<span class=\"built_in\">any</span>&gt; = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">ngOnInit() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.getNextLaunches();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> getNextLaunches() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"keyword\">this</span>.rocketsApi + <span class=\"string\">'launch/next/5'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.nextLaunches$ = <span class=\"keyword\">this</span>.httpClient.get&lt;<span class=\"built_in\">any</span>&gt;(url);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>En la plantilla accedemos al observable. La tubera se suscribe y retorna el resultado cuando se reciba. El <em>pipe</em> <code>json</code> nos permite ver el resultado.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> Next 5 rocket launches <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; nextLaunches$ | async | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y eso es todo. Casi nunca tendrs que suscribirte en cdigo. Deja que ese trabajo sucio lo haga el <em>pipe async</em>.<br>Pero, siempre hay un pero, rara vez los datos te vendrn tal cual los necesitas. Casi seguro que en ocasiones habr que filtrarlos, ordenarlos y sobre todo aplicarles alguna trasformacin. Para ello, antes tienes que saber un poco ms de observables.</p><h1 id=\"2-Observables\"><a href=\"#2-Observables\" class=\"headerlink\" title=\"2 Observables\"></a>2 Observables</h1><p>La librera <a href=\"https://www.learnrxjs.io/\" target=\"_blank\" rel=\"noopener\">RxJS</a> es enorme y Angular hace un uso extenso de ella. En este tutorial <a href=\"../comunicaciones-http-en-Angular\">se ha visto desde el punto de vista del consumidor</a>. Es decir, nos hemos suscrito a fuentes observables. Para avanzar tendremos que poder emitir, o mejor dicho producir, informacin.</p><h2 id=\"2-1-Productores-simples-of-y-from\"><a href=\"#2-1-Productores-simples-of-y-from\" class=\"headerlink\" title=\"2.1 Productores simples of y from\"></a>2.1 Productores simples of y from</h2><p>Los constructores ms sencillos de la librera son <strong>funciones que emiten valores estticos</strong> o secuencias a intervalos regulares. Para familiarizarte con ellos te propongo que juegues con cdigo como este:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">value$ = of(<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getMilliseconds());</span><br><span class=\"line\">value$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">stream$ = <span class=\"keyword\">from</span>([<span class=\"number\">1</span>, <span class=\"string\">'two'</span>, <span class=\"string\">'***'</span>]);</span><br><span class=\"line\">stream$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">list$ = of([<span class=\"string\">'N'</span>, <span class=\"string\">'S'</span>, <span class=\"string\">'E'</span>, <span class=\"string\">'W'</span>]);</span><br><span class=\"line\">list$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Operadores-simples-map-y-tap\"><a href=\"#2-2-Operadores-simples-map-y-tap\" class=\"headerlink\" title=\"2.2 Operadores simples map y tap\"></a>2.2 Operadores simples map y tap</h2><p>Tratamos a los observables como un flujo, un <em>stream</em> de datos; algo similar a un riachuelo de gotas de agua. A cada dato recibido le podemos aplicar funciones; sera como aplicar algn tratamiento al agua del riachuelo. Vamos a empezar con dos categoras de acciones: las que transforma en contenido, y la que tienen efectos secundarios.</p><p>Para ello disponemos de unas funciones de primer orden llamadas operadores. Estas funciones reciben como argumento a otras funciones en las que t programas las acciones de transformacin o efecto.</p><p>El operador de transformacin se llama <code>map()</code> y el de efectos se llama <code>tap()</code>. Ambos se pueden usar cuantas veces se quiera y en cualquier orden. Slo hay que meterlos dentro de una funcin superior. La funcin <code>pipe()</code>; que da nombre al proceso: entubar el stream.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numbers$ = <span class=\"keyword\">from</span>([<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>]);</span><br><span class=\"line\">doubles$ = numbers$</span><br><span class=\"line\">  .pipe(</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">x</span>=&gt;</span> <span class=\"number\">2</span> * x ),</span><br><span class=\"line\">    tap(x=Z <span class=\"built_in\">console</span>.log(x)) <span class=\"comment\">// 2 4 6 8</span></span><br><span class=\"line\">    );</span><br></pre></td></tr></table></figure><p>Apliquemos esto a los cohetes. Por ejemplo editando y transformando los datos recibidos desde el api:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> getNextLaunches() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"keyword\">this</span>.rocketsApi + <span class=\"string\">'launch/next/5'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.nextLaunches$ = <span class=\"keyword\">this</span>.httpClient.get&lt;<span class=\"built_in\">any</span>&gt;(url).pipe(</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">apiData</span> =&gt;</span> apiData.launches),</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">launchesArray</span> =&gt;</span></span><br><span class=\"line\">      launchesArray.map(<span class=\"function\"><span class=\"params\">launch</span> =&gt;</span> (&#123;</span><br><span class=\"line\">        name: launch.name,</span><br><span class=\"line\">        status: launch.status,</span><br><span class=\"line\">        scheduled: launch.net,</span><br><span class=\"line\">      &#125;))</span><br><span class=\"line\">    ),</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">customLaunches</span> =&gt;</span></span><br><span class=\"line\">      customLaunches.map(<span class=\"function\"><span class=\"params\">launch</span> =&gt;</span> (&#123;</span><br><span class=\"line\">        ...launch,</span><br><span class=\"line\">        statusColor: launch.status === <span class=\"number\">1</span> ? <span class=\"string\">'green'</span> : <span class=\"string\">'red'</span>,</span><br><span class=\"line\">      &#125;))</span><br><span class=\"line\">    ),</span><br><span class=\"line\">    tap(<span class=\"function\"><span class=\"params\">rockets</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">'num rockets:'</span> + rockets.length)),</span><br><span class=\"line\">    tap(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">'ha pasado algo'</span>)),</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">()</span>=&gt;</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> a =<span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>De esta forma la <em>template</em> ya recibe los datos listos para presentar de una manera ms vistosa y limpia.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"nextLaunches$ | async as nextLaunches; else loading\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let launch of nextLaunches\"</span></span></span><br><span class=\"line\"><span class=\"tag\">      [<span class=\"attr\">style.color</span>]=<span class=\"string\">\"launch.statusColor\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">b</span>&gt;</span>&#123;&#123; launch.name &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">b</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>&#123;&#123; launch.scheduled &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ng-template</span> #<span class=\"attr\">loading</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>Loading rocket data... <span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"3-Un-store-de-notificaciones\"><a href=\"#3-Un-store-de-notificaciones\" class=\"headerlink\" title=\"3 Un store de notificaciones\"></a>3 Un store de notificaciones</h1><h2 id=\"3-1-Subject-y-BehaviorSubject\"><a href=\"#3-1-Subject-y-BehaviorSubject\" class=\"headerlink\" title=\"3.1 Subject y BehaviorSubject\"></a>3.1 Subject y BehaviorSubject</h2><p>Los anteriores constructores se basan en datos estticos. Resuelvan algunas situaciones, pero necesitamos algo que emita <strong>cambios dinmicos</strong>. Y eso se realiza con los <em>Subjects</em>, una especie de emisores temticos a los que suscribirse.</p><p>Hay varios tipos pero para empezar nos vamos a fijar en dos: el <code>Subject()</code> y el <code>BehaviorSubject(initialData)</code>. La diferencia es que el primero slo emite las cosas segn ocurren. Si alguien se suscribe tarde no conocer el pasado. Esto suele generar problemas de sincronizacin. El <em>Behavior</em> en cambio notifica el ltimo valor conocido a cualquiera que se suscriba. De esa forma no importa si te suscribes antes o despus de la obtencin de un dato.</p><p>Juega con el siguiente ejemplo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> data = &#123;name:<span class=\"string\">''</span>, value:<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> need_sync$ = <span class=\"keyword\">new</span> Subject&lt;<span class=\"built_in\">any</span>&gt;();</span><br><span class=\"line\"><span class=\"comment\">// on time</span></span><br><span class=\"line\">need_sync.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">need_sync.next(data);</span><br><span class=\"line\"><span class=\"comment\">// too late</span></span><br><span class=\"line\">need_sync.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> no_hurry$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">any</span>&gt;(<span class=\"keyword\">this</span>.data);</span><br><span class=\"line\"><span class=\"comment\">// its ok</span></span><br><span class=\"line\">no_hurry.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">no_hurry.next(data);</span><br><span class=\"line\"><span class=\"comment\">// its also ok</span></span><br><span class=\"line\">no_hurry.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Un-Store-de-notificaciones\"><a href=\"#3-2-Un-Store-de-notificaciones\" class=\"headerlink\" title=\"3.2 Un Store de notificaciones\"></a>3.2 Un Store de notificaciones</h2><p>Usaremos el <code>BehaviorSubject</code> como notificador principal entre componentes de Angular. Por ejemplo podemos montar un sistema de notificaciones sencillo. Empecemos por crear un servicio:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m rockets/nasa --route nasa --module rockets/rockets-routing.module</span><br><span class=\"line\">ng g c rockets/nasa/houston</span><br><span class=\"line\">ng g c rockets/nasa/florida</span><br></pre></td></tr></table></figure><p>Este servicio es la implementacin ms sencilla posible de un gestor de estados. Cabe destacar que :</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> MissionsComunicationService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> messages: object[] = [&#123; icon: <span class=\"string\">''</span>, subject: <span class=\"string\">'Crew on board'</span> &#125;];</span><br><span class=\"line\">  <span class=\"keyword\">private</span> messages$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">any</span>[]&gt;(<span class=\"keyword\">this</span>.messages);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> getMessages$ = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.messages$.asObservable();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> sendMessage = <span class=\"function\">(<span class=\"params\">message: object</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.messages.push(message);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.messages$.next(<span class=\"keyword\">this</span>.messages);</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><ul><li>Mantienen el estado privado para evitar manipulaciones</li><li>Recibe de forma controlada las acciones de cambio</li><li>Emite clones del estado</li><li>Expone observables para que se suscriban los interesados.</li></ul><blockquote><p>Podra adaptar a la nomenclatura usada por patrones de gestin de estado ms avanzados como es <strong>Redux</strong>, y usar el siguiente convenio: <em>Store</em> como almacn, <em>select$()</em> como publicador de cambios observable y <em>dispatch</em> como encargado de procesar una accin de cambio de estado.</p></blockquote><h2 id=\"3-3-Desacoplados-pero-conectados\"><a href=\"#3-3-Desacoplados-pero-conectados\" class=\"headerlink\" title=\"3.3 Desacoplados pero conectados\"></a>3.3 Desacoplados pero conectados</h2><p>Una vez que hemos centralizado el control de cambios de una parte de la aplicacin, es hora de que lo usen los componentes o servicios involucrados. Solo necesitan recibir la instancia va dependencia. <strong>No hay ms acoplamiento entre emisores y receptores.</strong></p><h3 id=\"Emision\"><a href=\"#Emision\" class=\"headerlink\" title=\"Emisin\"></a>Emisin</h3><p>Veamos un ejemplo, un tanto forzado, consistente en dos componentes que se comunican sin conocerse. Esta es la vista con un formulario para enviar mensajes</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>Houston mission control<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">button</span>&gt;</span> Start count down <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">button</span>&gt;</span> Ignition <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">button</span>&gt;</span> Abort <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La parte interesante est en el controlador. Dependencia y uso del servicio del almacn de notificaciones</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> HoustonComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> missionsComunicationService: MissionsComunicationService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit(): <span class=\"built_in\">void</span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  onStartClick() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.missionsComunicationService.sendMessage(&#123; icon: <span class=\"string\">''</span>, subject: <span class=\"string\">'Start count down'</span> &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  onIgnitionClick() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.missionsComunicationService.sendMessage(&#123; icon: <span class=\"string\">''</span>, subject: <span class=\"string\">'Ignition'</span> &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  onAbortClick() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.missionsComunicationService.sendMessage(&#123; icon: <span class=\"string\">''</span>, subject: <span class=\"string\">'Abort'</span> &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h3 id=\"Recepcion\"><a href=\"#Recepcion\" class=\"headerlink\" title=\"Recepcin\"></a>Recepcin</h3><p>La recepcin es igual de sencilla. En el controlador reclamamos la misma dependencia para el uso del servicio del almacn de notificaciones.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> FloridaComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  messages$: Observable&lt;<span class=\"built_in\">any</span>&gt;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> missionsComunicationService: MissionsComunicationService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit(): <span class=\"built_in\">void</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.messages$ = <span class=\"keyword\">this</span>.missionsComunicationService.getMessages$();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>En la vista pondremos un listado de notificaciones que se alimenta de un array emitido por un observable.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>Florida launch pad<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span> Mission log<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let message of messages$ | async\"</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Es importante recalcar que <strong>no importa el orden de suscripcin</strong>. Estos dos componentes podran <em>vivir</em> en mdulos distintos, verse en la misma pgina o inicializarse en cualquier orden El receptor se entera siempre de todos los cambios; y adems recibe el ltimo estado conocido nada ms suscribirse.</p><p>Tenemos ahora a nuestro usuario puntualmente informado de todo lo que sucede. Hemos utilizado <strong>patrones de arquitectura de software</strong> como el observable y la inversin del control. El resultado es una serie de componentes y servicios poco acoplados que intercambian informacin en tiempo real.</p><p>Pero hay temas ms avanzados con los que continuar. Sigue esta serie para introducir ms temas de seguridad y crear tus <a href=\"../formularios-reactivos-con-Angular/\">formularios reactivos con Angular</a> mientras aprendes a programar con Angular. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-7_watch.png\" alt=\"vigilancia-y-seguridad-en-Angular\"></p><p>La <strong>vigilancia</strong> de los datos y la informacin en tiempo real al usuario son dos pilares del desarrollo con Angular en el lado del navegador. La <strong>seguridad</strong> de los datos realmente es una responsabilidad compartida entre el servidor y el cliente.</p><p>Veremos ambos aspectos del desarrollo, pues estn muy relacionados con la programacin asncrona y el dominio de los observables. Sentaremos las bases para unas <strong>comunicaciones seguras y fluidas en Angular</strong>.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones http en Angular</a>. Al finalizar tendrs una aplicacin que comunica a los usuarios cualquier informacin relevante y que gestiona de forma centralizada las respuestas de un servicio REST.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Observables-para-monitorizar-datos\"><a href=\"#1-Observables-para-monitorizar-datos\" class=\"headerlink\" title=\"1. Observables para monitorizar datos\"></a>1. Observables para monitorizar datos</h1><p>Hemos visto varias tcnicas para comunicar informacin dentro de una aplicacin Angular. Empezamos por conocer el <a href=\"../flujo-de-datos-entre-componentes-angular/\">flujo entre componentes</a> de una misma rama del DOM. Tambin enviamos datos en los <a href=\"../paginas-y-rutas-angular-spa/\">parmetros de una ruta</a>. Y obviamente podemos usar <a href=\"../servicios-inyectables-en-Angular/\">un servicio comn</a> para guardar informacin compartida. Pero en este caso, Cundo se actualiza? Cmo saber si ha cambiado?. Lo resolveremos con <code>Observables</code>.</p><p>Para ilustrar este tema vamos a crear una web que muestra los datos de los prximos 5 lanzamientos espaciales. Y despus un sencillo sistema de notificaciones que simula las comunicaciones de la Nasa. Empezaremos creando un mdulo para los propsitos de este laboratorio.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m rockets --route rockets --module app-routing.module</span><br></pre></td></tr></table></figure><p>Y en el componente tendremos que usar llamadas http pero sin suscripciones manuales. En su lugar nos quedamos con el observable y lo consumimos desde la vista con una de mis pipes preferidas: <code>| async</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> rocketsApi = <span class=\"string\">'https://launchlibrary.net/1.4/'</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> nextLaunches$: Observable&lt;<span class=\"built_in\">any</span>&gt; = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">ngOnInit() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.getNextLaunches();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> getNextLaunches() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"keyword\">this</span>.rocketsApi + <span class=\"string\">'launch/next/5'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.nextLaunches$ = <span class=\"keyword\">this</span>.httpClient.get&lt;<span class=\"built_in\">any</span>&gt;(url);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>En la plantilla accedemos al observable. La tubera se suscribe y retorna el resultado cuando se reciba. El <em>pipe</em> <code>json</code> nos permite ver el resultado.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> Next 5 rocket launches <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; nextLaunches$ | async | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y eso es todo. Casi nunca tendrs que suscribirte en cdigo. Deja que ese trabajo sucio lo haga el <em>pipe async</em>.<br>Pero, siempre hay un pero, rara vez los datos te vendrn tal cual los necesitas. Casi seguro que en ocasiones habr que filtrarlos, ordenarlos y sobre todo aplicarles alguna trasformacin. Para ello, antes tienes que saber un poco ms de observables.</p><h1 id=\"2-Observables\"><a href=\"#2-Observables\" class=\"headerlink\" title=\"2 Observables\"></a>2 Observables</h1><p>La librera <a href=\"https://www.learnrxjs.io/\" target=\"_blank\" rel=\"noopener\">RxJS</a> es enorme y Angular hace un uso extenso de ella. En este tutorial <a href=\"../comunicaciones-http-en-Angular\">se ha visto desde el punto de vista del consumidor</a>. Es decir, nos hemos suscrito a fuentes observables. Para avanzar tendremos que poder emitir, o mejor dicho producir, informacin.</p><h2 id=\"2-1-Productores-simples-of-y-from\"><a href=\"#2-1-Productores-simples-of-y-from\" class=\"headerlink\" title=\"2.1 Productores simples of y from\"></a>2.1 Productores simples of y from</h2><p>Los constructores ms sencillos de la librera son <strong>funciones que emiten valores estticos</strong> o secuencias a intervalos regulares. Para familiarizarte con ellos te propongo que juegues con cdigo como este:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">value$ = of(<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getMilliseconds());</span><br><span class=\"line\">value$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">stream$ = <span class=\"keyword\">from</span>([<span class=\"number\">1</span>, <span class=\"string\">'two'</span>, <span class=\"string\">'***'</span>]);</span><br><span class=\"line\">stream$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">list$ = of([<span class=\"string\">'N'</span>, <span class=\"string\">'S'</span>, <span class=\"string\">'E'</span>, <span class=\"string\">'W'</span>]);</span><br><span class=\"line\">list$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Operadores-simples-map-y-tap\"><a href=\"#2-2-Operadores-simples-map-y-tap\" class=\"headerlink\" title=\"2.2 Operadores simples map y tap\"></a>2.2 Operadores simples map y tap</h2><p>Tratamos a los observables como un flujo, un <em>stream</em> de datos; algo similar a un riachuelo de gotas de agua. A cada dato recibido le podemos aplicar funciones; sera como aplicar algn tratamiento al agua del riachuelo. Vamos a empezar con dos categoras de acciones: las que transforma en contenido, y la que tienen efectos secundarios.</p><p>Para ello disponemos de unas funciones de primer orden llamadas operadores. Estas funciones reciben como argumento a otras funciones en las que t programas las acciones de transformacin o efecto.</p><p>El operador de transformacin se llama <code>map()</code> y el de efectos se llama <code>tap()</code>. Ambos se pueden usar cuantas veces se quiera y en cualquier orden. Slo hay que meterlos dentro de una funcin superior. La funcin <code>pipe()</code>; que da nombre al proceso: entubar el stream.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numbers$ = <span class=\"keyword\">from</span>([<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>]);</span><br><span class=\"line\">doubles$ = numbers$</span><br><span class=\"line\">  .pipe(</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">x</span>=&gt;</span> <span class=\"number\">2</span> * x ),</span><br><span class=\"line\">    tap(x=Z <span class=\"built_in\">console</span>.log(x)) <span class=\"comment\">// 2 4 6 8</span></span><br><span class=\"line\">    );</span><br></pre></td></tr></table></figure><p>Apliquemos esto a los cohetes. Por ejemplo editando y transformando los datos recibidos desde el api:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> getNextLaunches() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"keyword\">this</span>.rocketsApi + <span class=\"string\">'launch/next/5'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.nextLaunches$ = <span class=\"keyword\">this</span>.httpClient.get&lt;<span class=\"built_in\">any</span>&gt;(url).pipe(</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">apiData</span> =&gt;</span> apiData.launches),</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">launchesArray</span> =&gt;</span></span><br><span class=\"line\">      launchesArray.map(<span class=\"function\"><span class=\"params\">launch</span> =&gt;</span> (&#123;</span><br><span class=\"line\">        name: launch.name,</span><br><span class=\"line\">        status: launch.status,</span><br><span class=\"line\">        scheduled: launch.net,</span><br><span class=\"line\">      &#125;))</span><br><span class=\"line\">    ),</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">customLaunches</span> =&gt;</span></span><br><span class=\"line\">      customLaunches.map(<span class=\"function\"><span class=\"params\">launch</span> =&gt;</span> (&#123;</span><br><span class=\"line\">        ...launch,</span><br><span class=\"line\">        statusColor: launch.status === <span class=\"number\">1</span> ? <span class=\"string\">'green'</span> : <span class=\"string\">'red'</span>,</span><br><span class=\"line\">      &#125;))</span><br><span class=\"line\">    ),</span><br><span class=\"line\">    tap(<span class=\"function\"><span class=\"params\">rockets</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">'num rockets:'</span> + rockets.length)),</span><br><span class=\"line\">    tap(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">'ha pasado algo'</span>)),</span><br><span class=\"line\">    map(<span class=\"function\"><span class=\"params\">()</span>=&gt;</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> a =<span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>De esta forma la <em>template</em> ya recibe los datos listos para presentar de una manera ms vistosa y limpia.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"nextLaunches$ | async as nextLaunches; else loading\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let launch of nextLaunches\"</span></span></span><br><span class=\"line\"><span class=\"tag\">      [<span class=\"attr\">style.color</span>]=<span class=\"string\">\"launch.statusColor\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">b</span>&gt;</span>&#123;&#123; launch.name &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">b</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>&#123;&#123; launch.scheduled &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ng-template</span> #<span class=\"attr\">loading</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>Loading rocket data... <span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"3-Un-store-de-notificaciones\"><a href=\"#3-Un-store-de-notificaciones\" class=\"headerlink\" title=\"3 Un store de notificaciones\"></a>3 Un store de notificaciones</h1><h2 id=\"3-1-Subject-y-BehaviorSubject\"><a href=\"#3-1-Subject-y-BehaviorSubject\" class=\"headerlink\" title=\"3.1 Subject y BehaviorSubject\"></a>3.1 Subject y BehaviorSubject</h2><p>Los anteriores constructores se basan en datos estticos. Resuelvan algunas situaciones, pero necesitamos algo que emita <strong>cambios dinmicos</strong>. Y eso se realiza con los <em>Subjects</em>, una especie de emisores temticos a los que suscribirse.</p><p>Hay varios tipos pero para empezar nos vamos a fijar en dos: el <code>Subject()</code> y el <code>BehaviorSubject(initialData)</code>. La diferencia es que el primero slo emite las cosas segn ocurren. Si alguien se suscribe tarde no conocer el pasado. Esto suele generar problemas de sincronizacin. El <em>Behavior</em> en cambio notifica el ltimo valor conocido a cualquiera que se suscriba. De esa forma no importa si te suscribes antes o despus de la obtencin de un dato.</p><p>Juega con el siguiente ejemplo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> data = &#123;name:<span class=\"string\">''</span>, value:<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> need_sync$ = <span class=\"keyword\">new</span> Subject&lt;<span class=\"built_in\">any</span>&gt;();</span><br><span class=\"line\"><span class=\"comment\">// on time</span></span><br><span class=\"line\">need_sync.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">need_sync.next(data);</span><br><span class=\"line\"><span class=\"comment\">// too late</span></span><br><span class=\"line\">need_sync.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> no_hurry$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">any</span>&gt;(<span class=\"keyword\">this</span>.data);</span><br><span class=\"line\"><span class=\"comment\">// its ok</span></span><br><span class=\"line\">no_hurry.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">no_hurry.next(data);</span><br><span class=\"line\"><span class=\"comment\">// its also ok</span></span><br><span class=\"line\">no_hurry.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Un-Store-de-notificaciones\"><a href=\"#3-2-Un-Store-de-notificaciones\" class=\"headerlink\" title=\"3.2 Un Store de notificaciones\"></a>3.2 Un Store de notificaciones</h2><p>Usaremos el <code>BehaviorSubject</code> como notificador principal entre componentes de Angular. Por ejemplo podemos montar un sistema de notificaciones sencillo. Empecemos por crear un servicio:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m rockets/nasa --route nasa --module rockets/rockets-routing.module</span><br><span class=\"line\">ng g c rockets/nasa/houston</span><br><span class=\"line\">ng g c rockets/nasa/florida</span><br></pre></td></tr></table></figure><p>Este servicio es la implementacin ms sencilla posible de un gestor de estados. Cabe destacar que :</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> MissionsComunicationService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> messages: object[] = [&#123; icon: <span class=\"string\">''</span>, subject: <span class=\"string\">'Crew on board'</span> &#125;];</span><br><span class=\"line\">  <span class=\"keyword\">private</span> messages$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">any</span>[]&gt;(<span class=\"keyword\">this</span>.messages);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> getMessages$ = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.messages$.asObservable();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> sendMessage = <span class=\"function\">(<span class=\"params\">message: object</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.messages.push(message);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.messages$.next(<span class=\"keyword\">this</span>.messages);</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><ul><li>Mantienen el estado privado para evitar manipulaciones</li><li>Recibe de forma controlada las acciones de cambio</li><li>Emite clones del estado</li><li>Expone observables para que se suscriban los interesados.</li></ul><blockquote><p>Podra adaptar a la nomenclatura usada por patrones de gestin de estado ms avanzados como es <strong>Redux</strong>, y usar el siguiente convenio: <em>Store</em> como almacn, <em>select$()</em> como publicador de cambios observable y <em>dispatch</em> como encargado de procesar una accin de cambio de estado.</p></blockquote><h2 id=\"3-3-Desacoplados-pero-conectados\"><a href=\"#3-3-Desacoplados-pero-conectados\" class=\"headerlink\" title=\"3.3 Desacoplados pero conectados\"></a>3.3 Desacoplados pero conectados</h2><p>Una vez que hemos centralizado el control de cambios de una parte de la aplicacin, es hora de que lo usen los componentes o servicios involucrados. Solo necesitan recibir la instancia va dependencia. <strong>No hay ms acoplamiento entre emisores y receptores.</strong></p><h3 id=\"Emision\"><a href=\"#Emision\" class=\"headerlink\" title=\"Emisin\"></a>Emisin</h3><p>Veamos un ejemplo, un tanto forzado, consistente en dos componentes que se comunican sin conocerse. Esta es la vista con un formulario para enviar mensajes</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>Houston mission control<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">button</span>&gt;</span> Start count down <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">button</span>&gt;</span> Ignition <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">button</span>&gt;</span> Abort <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La parte interesante est en el controlador. Dependencia y uso del servicio del almacn de notificaciones</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> HoustonComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> missionsComunicationService: MissionsComunicationService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit(): <span class=\"built_in\">void</span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  onStartClick() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.missionsComunicationService.sendMessage(&#123; icon: <span class=\"string\">''</span>, subject: <span class=\"string\">'Start count down'</span> &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  onIgnitionClick() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.missionsComunicationService.sendMessage(&#123; icon: <span class=\"string\">''</span>, subject: <span class=\"string\">'Ignition'</span> &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  onAbortClick() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.missionsComunicationService.sendMessage(&#123; icon: <span class=\"string\">''</span>, subject: <span class=\"string\">'Abort'</span> &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h3 id=\"Recepcion\"><a href=\"#Recepcion\" class=\"headerlink\" title=\"Recepcin\"></a>Recepcin</h3><p>La recepcin es igual de sencilla. En el controlador reclamamos la misma dependencia para el uso del servicio del almacn de notificaciones.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> FloridaComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  messages$: Observable&lt;<span class=\"built_in\">any</span>&gt;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> missionsComunicationService: MissionsComunicationService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit(): <span class=\"built_in\">void</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.messages$ = <span class=\"keyword\">this</span>.missionsComunicationService.getMessages$();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>En la vista pondremos un listado de notificaciones que se alimenta de un array emitido por un observable.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>Florida launch pad<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span> Mission log<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let message of messages$ | async\"</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Es importante recalcar que <strong>no importa el orden de suscripcin</strong>. Estos dos componentes podran <em>vivir</em> en mdulos distintos, verse en la misma pgina o inicializarse en cualquier orden El receptor se entera siempre de todos los cambios; y adems recibe el ltimo estado conocido nada ms suscribirse.</p><p>Tenemos ahora a nuestro usuario puntualmente informado de todo lo que sucede. Hemos utilizado <strong>patrones de arquitectura de software</strong> como el observable y la inversin del control. El resultado es una serie de componentes y servicios poco acoplados que intercambian informacin en tiempo real.</p><p>Pero hay temas ms avanzados con los que continuar. Sigue esta serie para introducir ms temas de seguridad y crear tus <a href=\"../formularios-reactivos-con-Angular/\">formularios reactivos con Angular</a> mientras aprendes a programar con Angular. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Formularios reactivos con Angular","date":"2019-03-12T09:59:27.000Z","thumbnail":"/css/images/angular-8_reactive.png","_content":"\n![formularios-reactivos-con-Angular](/images/tutorial-angular-8_reactive.png)\n\nEl **doble enlace automtico** entre elementos *html* y propiedades de objetos fue el primer gran xito de **Angular**. Ese _doble-binding_ facilita mucho el desarrollo de formularios. Pero esa magia tienen un coste en escalabilidad; impacta en el tiempo de ejecucin y adems dificulta la validacin y el mantenimiento de formularios complejos.\n\nLa solucin en Angular 8 pasa por desacoplar el modelo y la vista, introduciendo una capa que gestione ese doble enlace. Los servicios y directivas del mdulo `ReactiveFormsModule` que viene en la librera `@angular/forms` permiten programar **formularios reactivos conducidos por el cdigo**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Vigilancia y seguridad en Angular](../vigilancia-y-seguridad-en-Angular/). Al finalizar tendrs una aplicacin con formularios _model driven_ fciles de mantener y validar.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-basic/8-reactive](https://github.com/AcademiaBinaria/angular-basic/tree/master/src/app/8-reactive/security)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Basic](https://academiabinaria.github.io/angular-basic/)\n\n\n# 1 Desacople entre vista y modelo\n\nLa directiva `[(ngModel)]=\"model.property\"` con su popular _banana in a box_ establece el doble enlace entre el elemento de la vista al que se le aplica y una propiedad del modelo. Los cambios en la vista son trasladados automticamente al modelo, y al revs; cualquier cambio en el modelo se refleja inmediatamente en la vista.\n\nSe pueden establecer validaciones y configurar los eventos que disparan las actualizaciones; pero todo ello usando ms y ms atributos y directivas en la plantilla. Son los formularios _template driven_ que degeneran en un *html* farragoso y difcil de mantener.\n\n> Vamos a crear un formulario de registro de usuarios usando los formularios _model driven_. Para ello voy a crear el mdulo _security_ con el componente _register_ y los enganchar a la ruta _security/register_.\n\nEl mdulo de seguridad y su configuracin lazy en el raz:\n\n```console\nng g m security --routing true\nng g c security/register\n```\n\n```typescript\n{\n  path: 'security',\n  loadChildren: () => import('./8-reactive/security/security.module').then(m => m.SecurityModule)\n},\n```\nEl componente de registro y su ruta asignada:\n\n```typescript\nconst routes: Routes = [\n  {\n    path: 'register',\n    component: RegisterComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'register'\n  }\n];\n```\n\n```html\n<a routerLink=\"security/register\" class=\"button\">Register</a>\n```\n\n## 1.1 Form Builder\n\nEntra en accin el  `FormBuilder`, un servicio del que han de depender los componentes que quieran desacoplar el modelo de la vista. Se usa para construir un formulario creando un `FormGroup`, (un grupo de controles) que realiza un seguimiento del valor y estado de cambio y validez de los datos.\n\nPara poder usarlo tenemos que importar el mdulo de Angular en el que viene declarado, el `ReactiveFormModule`.\n\n```typescript\nimport { ReactiveFormsModule } from '@angular/forms';\n@NgModule({\n  declarations: [RegisterComponent],\n  imports: [\n    CommonModule,\n    SecurityRoutingModule,\n    ReactiveFormsModule\n  ]\n})\nexport class SecurityModule { }\n```\n\nVeamos un ejemplo mnimo de su declaracin en `register.component.ts`.\n\n```typescript\nexport class RegisterComponent implements OnInit {\n  public formGroup: FormGroup;\n\n  constructor( private formBuilder: FormBuilder ) { }\n\n  public ngOnInit() {\n    this.buildForm();\n  }\n  private buildForm(){\n    this.formGroup = this.formBuilder.group({});\n  }\n}\n```\n## 1.2 Form control\n\nEl formulario se define como un **grupo de controles**. Cada control tendr un nombre y una configuracin. Esa definicin permite establecer un valor inicial al control.\n\n```typescript\nprivate buildForm() {\n  const dateLength = 10;\n  const today = new Date().toISOString().substring(0, dateLength);\n  const name = 'JOHN DOE';\n  this.formGroup = this.formBuilder.group({\n    registeredOn: today,\n    name: name.toLowerCase(),\n    email: 'john@angular.io',\n    password: ''\n  });\n}\n```\n\nComo ves, es fcil asignar valores por defecto. Incluso es un buen momento para modificar o transformar datos previos para ajustarlos a cmo los ver el usuario; sin necesidad de cambiar los datos de base.\n\n## 1.3 Form view\n\nMientras tanto en la vista html... Este trabajo previo y extra que tienes que hacer en el controlador se recompensa con una **mayor limpieza en la vista**. Lo nico necesario ser asignar por nombre el elemento html con el control _typescript_ que lo gestionar.\n\n>Para ello usaremos dos directivas que vienen dentro del mdulo _reactivo_ son `[formGroup]=\"objetoFormulario\"` para el formulario en su conjunto, y `formControlName=\"nombreDelControl\"` para cada control.\n\n```html\n<form [formGroup]=\"formGroup\">\n  <label for=\"registeredOn\">Registered On</label>\n  <input name=\"registeredOn\"\n        formControlName=\"registeredOn\"\n        type=\"date\" />\n  <label for=\"name\">Name</label>\n  <input name=\"name\"\n        formControlName=\"name\"\n        type=\"text\" />\n  <label for=\"email\">E-mail</label>\n  <input name=\"email\"\n        formControlName=\"email\"\n        type=\"email\" />\n  <label for=\"password\">Password</label>\n  <input name=\"password\"\n        formControlName=\"password\"\n        type=\"password\" />\n</form>\n```\n\n# 2 Validacin y estados\n\nLa validacin es una pieza clave de la entrada de datos en cualquier aplicacin. Es el primer **frente de defensa ante errores de usuarios**; ya sean involuntarios o deliberados.\n\nDichas validaciones se solan realizar agregando atributos html tales como el archiconocido `required`. Pero todo eso ahora se traslada a la configuracin de cada control, donde podrs establecer una o varias reglas de validacin sin mancharte con html.\n\n## 2.1 Validadores predefinidos y personalizados\n\nDe nuevo tienes distintas sobrecargas que te permiten resolver limpiamente casos sencillos de una sola validacin, o usar bateras de reglas que vienen predefinidas como funciones en el objeto `Validators` del _framework_.\n\n```typescript\nprivate buildForm() {\n  const dateLength = 10;\n  const today = new Date().toISOString().substring(0, dateLength);\n  const name = 'JOHN DOE';\n  const minPassLength = 4;\n  this.formGroup = this.formBuilder.group({\n    registeredOn: today,\n    name: [name.toLowerCase(), Validators.required],\n    email: ['john@angular.io', [\n      Validators.required, Validators.email\n    ]],\n    password: ['', [\n      Validators.required, Validators.minLength(minPassLength)\n    ]]\n  });\n}\n```\n\nA estas validaciones integradas se puede aadir otras creadas por el programador. Incluso con ejecucin asncrona para validaciones realizadas en el servidor.\n\nPor ejemplo podemos agregar una validacin especfica a las contraseas\n\n```typescript\npassword: ['', [\n  Validators.required,\n  Validators.minLength(minPassLength),\n  this.validatePassword\n]]\n```\nLo nico que se necesita es una funcin que recibe como argumento el control a validar. El resultado debe ser un `null` si todo va bien. Y cualquier otra cosa en caso de fallo. Te muestro una propuesta para que puedas crear tus propios validadores.\n\n```typescript\nprivate validatePassword(control: AbstractControl) {\n  const password = control.value;\n  let error = null;\n  if (!password.includes('$')) {\n    error = { ...error, dollar: 'needs a dollar symbol' };\n  }\n  if (!parseFloat(password[0])) {\n    error = { ...error, number: 'must start with a number' };\n  }\n  return error;\n}\n```\n\n## 2.2 Estados de cambio y validacin\n\nUna vez establecidas las reglas, es hora de aplicarlas y avisar al usuario en caso de que se incumplan. Los formularios y controles reactivos estn gestionados por **mquinas de estados** que determinan en todo momento la situacin de cada control y del formulario en si mismo.\n\n### 2.2.1 Estados de validacin\n\nAl establecer una o ms reglas para uno o ms controles activamos el sistema de chequeo y control del estado de cada control y del formulario en su conjunto.\n\nLa mquina de estados de validacin contempla los siguientes estados mutuamente excluyentes:\n\n- **VALID**: el control ha pasado todos los chequeos\n- **INVALID**: el control ha fallado al menos en una regla.\n- **PENDING**: el control est en medio de un proceso de validacin\n- **DISABLED**: el control est desactivado y exento de validacin\n\nCuando un control incumple con alguna regla de validacin, estas se reflejan en su propiedad `errors` que ser un objeto con una propiedad por cada regla insatisfecha y un valor o mensaje de ayuda guardado en dicha propiedad.\n\n### 2.2.2 Estados de modificacin\n\nLos controles, y el formulario, se someten a otra mquina de estados que monitoriza el valor del control y sus cambios.\n\nLa mquina de estados de cambio contempla entre otros los siguientes:\n\n- **PRINSTINE**: el valor del control no ha sido cambiado por el usuario\n- **DIRTY**: el usuario ha modificado el valor del control.\n- **TOUCHED**: el usuario ha tocado el control lanzando un evento `blur` al salir.\n- **UNTOUCHED**: el usuario no ha tocado y salido del control lanzando ningn evento `blur`.\n\nComo en el caso de los estados de validacin, el formulario tambin se somete a estos estados en funcin de cmo estn sus controles.\n\nVeamos su aplicacin primero en el caso general del formulario. Uno de los usos ms inmediatos es deshabilitar el botn de envo cuando la validacin de algn control falla.\n\n```html\n<button (click)=\"register()\"\n    [disabled]=\"formGroup.invalid\">Register me!</button>\n```\n\n> Por cierto, este sistema de gestin de los controles del formulario oculta la parte ms valiosa (el valor que se pretende almacenar) en la propiedad `value` del formulario. Contendr un objeto con las mismas propiedades usadas durante la definicin del formulario, cada una con el valor actual del control asociado.\n\n```typescript\npublic register() {\n  const user = this.formGroup.value;\n  console.log(user);\n}\n```\n\nLa validacin particular para cada control permite informar al usuario del fallo concreto. Es una **buena prctica de usabilidad** el esperar a que edite un control antes de mostrarle el fallo. Y tambin es muy habitual usar la misma estrategia para cada control.\n\nLo que no queremos es llevar de vuelta la lgica a la vista; as que lo recomendado es crear una **funcin auxiliar para mostrar los errores** de validacin.\n\n```typescript\npublic getError(controlName: string): string {\n  let error = '';\n  const control = this.formGroup.get(controlName);\n  if (control.touched && control.errors != null) {\n    error = JSON.stringify(control.errors);\n  }\n  return error;\n}\n```\nEn la vista colocaremos adecuadamente los mensajes para facilitarle la correccin al usuario.\n\n```html\n<span>{{ getError('name')}}</span>\n<span>{{ getError('email')}}</span>\n<span>{{ getError('password')}}</span>\n```\n\nYa tenemos formularios reactivos conducidos por los datos que te permitirn construir pantallas complejas manteniendo el control en el modelo y dejando la vista despejada. Como resumen podemos decir que vamos a programar ms en TypeScript que en Html. La ventaja del desacople es que podremos controlar lo que enviamos y recibimos de la vista. As se pueden aplicar formatos, validaciones y transformaciones entre lo que presentamos y lo que enviamos hacia los servicios.\n\n# 3. Un gestor de credenciales\n\nVamos a provechar el conocimiento sobre _Interceptores_ y _Observables_ para montar un pequeo sistema de gestin de credenciales. La idea es detectar respuestas a llamadas no autenticadas y redirigir al usuario a nuestra pantalla de registro.\n\nSi el usuario se registra correctamente recibiremos un _token_ que lo identifica. Lo que haremos ser guardarlo y usarlo en el resto de las llamadas.\n\n## 3.1 Deteccin y redireccin de intrusos\n\nEmpezar por crea un servicio para el interceptor de fallos de seguridad y un componente que invocar deliberadamente a un API protegida.\n\n```console\nng g s security/auth-interceptor\nng g c security/secret\n```\n\nAl componente _secret_ le asignaremos la ruta _security/secret_\n\n```html\n  <a routerLink=\"security/register\" class=\"button\">Register</a>\n```\n\n```typescript\nconst routes: Routes = [\n  {\n    path: 'register',\n    component: RegisterComponent\n  },\n  {\n    path: 'secret',\n    component: SecretComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'secret'\n  }\n];\n```\nEn cuanto al interceptor, haremos como ya hemos visto en el tema [7-watch](../vigilancia-y-seguridad-en-Angular/). Lo primero ser proveerlo invirtiendo el control que nos cede el `HttpClient`.\n\n```typescript\n@NgModule({\n  declarations: [RegisterComponent, SecretComponent],\n  imports: [CommonModule, SecurityRoutingModule, ReactiveFormsModule, HttpClientModule],\n  providers: [\n    {\n      provide: HTTP_INTERCEPTORS,\n      useClass: AuthInterceptorService,\n      multi: true\n    }\n  ]\n})\nexport class SecurityModule {}\n```\n\nLuego codificar la implementacin de la interfaz `HttpInterceptor`. En este caso me interesan las respuestas con **error 401**. Emplear el `Router` de Angular para obligar al usuario a visitar la pgina de registro cuando esto ocurra.\n\n```typescript\nexport class AuthInterceptorService implements HttpInterceptor {\n  constructor(private router: Router) {}\n\n  public intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n    return next.handle(req).pipe(catchError(this.handleError.bind(this)));\n  }\n  private handleError(err) {\n    const unauthorized_code = 401;\n    if (err instanceof HttpErrorResponse) {\n      if (err.status === unauthorized_code) {\n        this.router.navigate(['security/register']);\n      }\n    }\n    return throwError(err);\n  }\n}\n```\n\n## 3.2 Almacenamiento y uso del token\n\nAntes de nada volveremos al tema de los observables y su uso como **intermediarios entre objetos desacoplados**. Para ello crear un servicio para almacenar y distribuir el _token_ de identificacin de usuarios.\n\n```console\nng g s security/token_store\n```\n\n```typescript\nexport class TokenStoreService {\n  private token = '';\n  private token$ = new BehaviorSubject<string>('');\n\n  constructor() {}\n\n  public select$ = () => this.token$.asObservable();\n  public dispatch(token) {\n    this.token = token;\n    this.token$.next(this.token);\n  }\n}\n```\n\nDe vuelta en el componente `RegisterComponent`. Tenemos que enviar las credenciales al API para su aceptacin. Si todo va bien, nos devolvern un _token_ que identifica al usuario. Es momento de usar al `TokenStore` para transmitir la noticia por toda la aplicacin.\n\n```typescript\npublic register() {\n  const url = 'https://api-base.herokuapp.com/api/pub/credentials/registration';\n  const user = this.formGroup.value;\n  this.httpClient.post<any>(url, user)\n    .subscribe(res => this.tokenStore.dispatch(res.token));\n}\n```\n\n---\n\nPor ltimo volvemos al `AuthInterceptorService` en el que nos suscribiremos a los cambios acerca del _token_.\n\n```typescript\nprivate token = '';\nconstructor(private router: Router, private tokenStore: TokenStoreService) {\n  this.tokenStore.select$()\n    .subscribe(token => (this.token = token));\n}\n```\n\nY lo usaremos en las cabeceras de todas las llamadas.\n\n\n```typescript\npublic intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n  const authHeader = { Authorization: 'bearer ' + this.token };\n  const authReq = req.clone({ setHeaders: authHeader });\n  return next.handle(authReq)\n    .pipe(catchError(this.handleError.bind(this)));\n}\n```\n\nYa sabes lo bsico de Angular; pero puedes usar mucho ms conociendo su ecosistema. Sigue esta serie para agregar libreras y usar los esquemas de  [Material Design y CLI de Angular](../Material-Design-y-CLI-de-Angular/) mientras aprendes a programar con Angular. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-8-Formularios-reactivos-con-Angular.md","raw":"---\ntitle: Formularios reactivos con Angular\npermalink: formularios-reactivos-con-Angular\ndate: 2019-03-12 10:59:27\ntags:\n- Angular\n- Angular8\n- Angular2\n- reactiveForms\n- Tutorial\n- Introduccin\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-8_reactive.png\n---\n\n![formularios-reactivos-con-Angular](/images/tutorial-angular-8_reactive.png)\n\nEl **doble enlace automtico** entre elementos *html* y propiedades de objetos fue el primer gran xito de **Angular**. Ese _doble-binding_ facilita mucho el desarrollo de formularios. Pero esa magia tienen un coste en escalabilidad; impacta en el tiempo de ejecucin y adems dificulta la validacin y el mantenimiento de formularios complejos.\n\nLa solucin en Angular 8 pasa por desacoplar el modelo y la vista, introduciendo una capa que gestione ese doble enlace. Los servicios y directivas del mdulo `ReactiveFormsModule` que viene en la librera `@angular/forms` permiten programar **formularios reactivos conducidos por el cdigo**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Vigilancia y seguridad en Angular](../vigilancia-y-seguridad-en-Angular/). Al finalizar tendrs una aplicacin con formularios _model driven_ fciles de mantener y validar.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-basic/8-reactive](https://github.com/AcademiaBinaria/angular-basic/tree/master/src/app/8-reactive/security)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Basic](https://academiabinaria.github.io/angular-basic/)\n\n\n# 1 Desacople entre vista y modelo\n\nLa directiva `[(ngModel)]=\"model.property\"` con su popular _banana in a box_ establece el doble enlace entre el elemento de la vista al que se le aplica y una propiedad del modelo. Los cambios en la vista son trasladados automticamente al modelo, y al revs; cualquier cambio en el modelo se refleja inmediatamente en la vista.\n\nSe pueden establecer validaciones y configurar los eventos que disparan las actualizaciones; pero todo ello usando ms y ms atributos y directivas en la plantilla. Son los formularios _template driven_ que degeneran en un *html* farragoso y difcil de mantener.\n\n> Vamos a crear un formulario de registro de usuarios usando los formularios _model driven_. Para ello voy a crear el mdulo _security_ con el componente _register_ y los enganchar a la ruta _security/register_.\n\nEl mdulo de seguridad y su configuracin lazy en el raz:\n\n```console\nng g m security --routing true\nng g c security/register\n```\n\n```typescript\n{\n  path: 'security',\n  loadChildren: () => import('./8-reactive/security/security.module').then(m => m.SecurityModule)\n},\n```\nEl componente de registro y su ruta asignada:\n\n```typescript\nconst routes: Routes = [\n  {\n    path: 'register',\n    component: RegisterComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'register'\n  }\n];\n```\n\n```html\n<a routerLink=\"security/register\" class=\"button\">Register</a>\n```\n\n## 1.1 Form Builder\n\nEntra en accin el  `FormBuilder`, un servicio del que han de depender los componentes que quieran desacoplar el modelo de la vista. Se usa para construir un formulario creando un `FormGroup`, (un grupo de controles) que realiza un seguimiento del valor y estado de cambio y validez de los datos.\n\nPara poder usarlo tenemos que importar el mdulo de Angular en el que viene declarado, el `ReactiveFormModule`.\n\n```typescript\nimport { ReactiveFormsModule } from '@angular/forms';\n@NgModule({\n  declarations: [RegisterComponent],\n  imports: [\n    CommonModule,\n    SecurityRoutingModule,\n    ReactiveFormsModule\n  ]\n})\nexport class SecurityModule { }\n```\n\nVeamos un ejemplo mnimo de su declaracin en `register.component.ts`.\n\n```typescript\nexport class RegisterComponent implements OnInit {\n  public formGroup: FormGroup;\n\n  constructor( private formBuilder: FormBuilder ) { }\n\n  public ngOnInit() {\n    this.buildForm();\n  }\n  private buildForm(){\n    this.formGroup = this.formBuilder.group({});\n  }\n}\n```\n## 1.2 Form control\n\nEl formulario se define como un **grupo de controles**. Cada control tendr un nombre y una configuracin. Esa definicin permite establecer un valor inicial al control.\n\n```typescript\nprivate buildForm() {\n  const dateLength = 10;\n  const today = new Date().toISOString().substring(0, dateLength);\n  const name = 'JOHN DOE';\n  this.formGroup = this.formBuilder.group({\n    registeredOn: today,\n    name: name.toLowerCase(),\n    email: 'john@angular.io',\n    password: ''\n  });\n}\n```\n\nComo ves, es fcil asignar valores por defecto. Incluso es un buen momento para modificar o transformar datos previos para ajustarlos a cmo los ver el usuario; sin necesidad de cambiar los datos de base.\n\n## 1.3 Form view\n\nMientras tanto en la vista html... Este trabajo previo y extra que tienes que hacer en el controlador se recompensa con una **mayor limpieza en la vista**. Lo nico necesario ser asignar por nombre el elemento html con el control _typescript_ que lo gestionar.\n\n>Para ello usaremos dos directivas que vienen dentro del mdulo _reactivo_ son `[formGroup]=\"objetoFormulario\"` para el formulario en su conjunto, y `formControlName=\"nombreDelControl\"` para cada control.\n\n```html\n<form [formGroup]=\"formGroup\">\n  <label for=\"registeredOn\">Registered On</label>\n  <input name=\"registeredOn\"\n        formControlName=\"registeredOn\"\n        type=\"date\" />\n  <label for=\"name\">Name</label>\n  <input name=\"name\"\n        formControlName=\"name\"\n        type=\"text\" />\n  <label for=\"email\">E-mail</label>\n  <input name=\"email\"\n        formControlName=\"email\"\n        type=\"email\" />\n  <label for=\"password\">Password</label>\n  <input name=\"password\"\n        formControlName=\"password\"\n        type=\"password\" />\n</form>\n```\n\n# 2 Validacin y estados\n\nLa validacin es una pieza clave de la entrada de datos en cualquier aplicacin. Es el primer **frente de defensa ante errores de usuarios**; ya sean involuntarios o deliberados.\n\nDichas validaciones se solan realizar agregando atributos html tales como el archiconocido `required`. Pero todo eso ahora se traslada a la configuracin de cada control, donde podrs establecer una o varias reglas de validacin sin mancharte con html.\n\n## 2.1 Validadores predefinidos y personalizados\n\nDe nuevo tienes distintas sobrecargas que te permiten resolver limpiamente casos sencillos de una sola validacin, o usar bateras de reglas que vienen predefinidas como funciones en el objeto `Validators` del _framework_.\n\n```typescript\nprivate buildForm() {\n  const dateLength = 10;\n  const today = new Date().toISOString().substring(0, dateLength);\n  const name = 'JOHN DOE';\n  const minPassLength = 4;\n  this.formGroup = this.formBuilder.group({\n    registeredOn: today,\n    name: [name.toLowerCase(), Validators.required],\n    email: ['john@angular.io', [\n      Validators.required, Validators.email\n    ]],\n    password: ['', [\n      Validators.required, Validators.minLength(minPassLength)\n    ]]\n  });\n}\n```\n\nA estas validaciones integradas se puede aadir otras creadas por el programador. Incluso con ejecucin asncrona para validaciones realizadas en el servidor.\n\nPor ejemplo podemos agregar una validacin especfica a las contraseas\n\n```typescript\npassword: ['', [\n  Validators.required,\n  Validators.minLength(minPassLength),\n  this.validatePassword\n]]\n```\nLo nico que se necesita es una funcin que recibe como argumento el control a validar. El resultado debe ser un `null` si todo va bien. Y cualquier otra cosa en caso de fallo. Te muestro una propuesta para que puedas crear tus propios validadores.\n\n```typescript\nprivate validatePassword(control: AbstractControl) {\n  const password = control.value;\n  let error = null;\n  if (!password.includes('$')) {\n    error = { ...error, dollar: 'needs a dollar symbol' };\n  }\n  if (!parseFloat(password[0])) {\n    error = { ...error, number: 'must start with a number' };\n  }\n  return error;\n}\n```\n\n## 2.2 Estados de cambio y validacin\n\nUna vez establecidas las reglas, es hora de aplicarlas y avisar al usuario en caso de que se incumplan. Los formularios y controles reactivos estn gestionados por **mquinas de estados** que determinan en todo momento la situacin de cada control y del formulario en si mismo.\n\n### 2.2.1 Estados de validacin\n\nAl establecer una o ms reglas para uno o ms controles activamos el sistema de chequeo y control del estado de cada control y del formulario en su conjunto.\n\nLa mquina de estados de validacin contempla los siguientes estados mutuamente excluyentes:\n\n- **VALID**: el control ha pasado todos los chequeos\n- **INVALID**: el control ha fallado al menos en una regla.\n- **PENDING**: el control est en medio de un proceso de validacin\n- **DISABLED**: el control est desactivado y exento de validacin\n\nCuando un control incumple con alguna regla de validacin, estas se reflejan en su propiedad `errors` que ser un objeto con una propiedad por cada regla insatisfecha y un valor o mensaje de ayuda guardado en dicha propiedad.\n\n### 2.2.2 Estados de modificacin\n\nLos controles, y el formulario, se someten a otra mquina de estados que monitoriza el valor del control y sus cambios.\n\nLa mquina de estados de cambio contempla entre otros los siguientes:\n\n- **PRINSTINE**: el valor del control no ha sido cambiado por el usuario\n- **DIRTY**: el usuario ha modificado el valor del control.\n- **TOUCHED**: el usuario ha tocado el control lanzando un evento `blur` al salir.\n- **UNTOUCHED**: el usuario no ha tocado y salido del control lanzando ningn evento `blur`.\n\nComo en el caso de los estados de validacin, el formulario tambin se somete a estos estados en funcin de cmo estn sus controles.\n\nVeamos su aplicacin primero en el caso general del formulario. Uno de los usos ms inmediatos es deshabilitar el botn de envo cuando la validacin de algn control falla.\n\n```html\n<button (click)=\"register()\"\n    [disabled]=\"formGroup.invalid\">Register me!</button>\n```\n\n> Por cierto, este sistema de gestin de los controles del formulario oculta la parte ms valiosa (el valor que se pretende almacenar) en la propiedad `value` del formulario. Contendr un objeto con las mismas propiedades usadas durante la definicin del formulario, cada una con el valor actual del control asociado.\n\n```typescript\npublic register() {\n  const user = this.formGroup.value;\n  console.log(user);\n}\n```\n\nLa validacin particular para cada control permite informar al usuario del fallo concreto. Es una **buena prctica de usabilidad** el esperar a que edite un control antes de mostrarle el fallo. Y tambin es muy habitual usar la misma estrategia para cada control.\n\nLo que no queremos es llevar de vuelta la lgica a la vista; as que lo recomendado es crear una **funcin auxiliar para mostrar los errores** de validacin.\n\n```typescript\npublic getError(controlName: string): string {\n  let error = '';\n  const control = this.formGroup.get(controlName);\n  if (control.touched && control.errors != null) {\n    error = JSON.stringify(control.errors);\n  }\n  return error;\n}\n```\nEn la vista colocaremos adecuadamente los mensajes para facilitarle la correccin al usuario.\n\n```html\n<span>{{ getError('name')}}</span>\n<span>{{ getError('email')}}</span>\n<span>{{ getError('password')}}</span>\n```\n\nYa tenemos formularios reactivos conducidos por los datos que te permitirn construir pantallas complejas manteniendo el control en el modelo y dejando la vista despejada. Como resumen podemos decir que vamos a programar ms en TypeScript que en Html. La ventaja del desacople es que podremos controlar lo que enviamos y recibimos de la vista. As se pueden aplicar formatos, validaciones y transformaciones entre lo que presentamos y lo que enviamos hacia los servicios.\n\n# 3. Un gestor de credenciales\n\nVamos a provechar el conocimiento sobre _Interceptores_ y _Observables_ para montar un pequeo sistema de gestin de credenciales. La idea es detectar respuestas a llamadas no autenticadas y redirigir al usuario a nuestra pantalla de registro.\n\nSi el usuario se registra correctamente recibiremos un _token_ que lo identifica. Lo que haremos ser guardarlo y usarlo en el resto de las llamadas.\n\n## 3.1 Deteccin y redireccin de intrusos\n\nEmpezar por crea un servicio para el interceptor de fallos de seguridad y un componente que invocar deliberadamente a un API protegida.\n\n```console\nng g s security/auth-interceptor\nng g c security/secret\n```\n\nAl componente _secret_ le asignaremos la ruta _security/secret_\n\n```html\n  <a routerLink=\"security/register\" class=\"button\">Register</a>\n```\n\n```typescript\nconst routes: Routes = [\n  {\n    path: 'register',\n    component: RegisterComponent\n  },\n  {\n    path: 'secret',\n    component: SecretComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'secret'\n  }\n];\n```\nEn cuanto al interceptor, haremos como ya hemos visto en el tema [7-watch](../vigilancia-y-seguridad-en-Angular/). Lo primero ser proveerlo invirtiendo el control que nos cede el `HttpClient`.\n\n```typescript\n@NgModule({\n  declarations: [RegisterComponent, SecretComponent],\n  imports: [CommonModule, SecurityRoutingModule, ReactiveFormsModule, HttpClientModule],\n  providers: [\n    {\n      provide: HTTP_INTERCEPTORS,\n      useClass: AuthInterceptorService,\n      multi: true\n    }\n  ]\n})\nexport class SecurityModule {}\n```\n\nLuego codificar la implementacin de la interfaz `HttpInterceptor`. En este caso me interesan las respuestas con **error 401**. Emplear el `Router` de Angular para obligar al usuario a visitar la pgina de registro cuando esto ocurra.\n\n```typescript\nexport class AuthInterceptorService implements HttpInterceptor {\n  constructor(private router: Router) {}\n\n  public intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n    return next.handle(req).pipe(catchError(this.handleError.bind(this)));\n  }\n  private handleError(err) {\n    const unauthorized_code = 401;\n    if (err instanceof HttpErrorResponse) {\n      if (err.status === unauthorized_code) {\n        this.router.navigate(['security/register']);\n      }\n    }\n    return throwError(err);\n  }\n}\n```\n\n## 3.2 Almacenamiento y uso del token\n\nAntes de nada volveremos al tema de los observables y su uso como **intermediarios entre objetos desacoplados**. Para ello crear un servicio para almacenar y distribuir el _token_ de identificacin de usuarios.\n\n```console\nng g s security/token_store\n```\n\n```typescript\nexport class TokenStoreService {\n  private token = '';\n  private token$ = new BehaviorSubject<string>('');\n\n  constructor() {}\n\n  public select$ = () => this.token$.asObservable();\n  public dispatch(token) {\n    this.token = token;\n    this.token$.next(this.token);\n  }\n}\n```\n\nDe vuelta en el componente `RegisterComponent`. Tenemos que enviar las credenciales al API para su aceptacin. Si todo va bien, nos devolvern un _token_ que identifica al usuario. Es momento de usar al `TokenStore` para transmitir la noticia por toda la aplicacin.\n\n```typescript\npublic register() {\n  const url = 'https://api-base.herokuapp.com/api/pub/credentials/registration';\n  const user = this.formGroup.value;\n  this.httpClient.post<any>(url, user)\n    .subscribe(res => this.tokenStore.dispatch(res.token));\n}\n```\n\n---\n\nPor ltimo volvemos al `AuthInterceptorService` en el que nos suscribiremos a los cambios acerca del _token_.\n\n```typescript\nprivate token = '';\nconstructor(private router: Router, private tokenStore: TokenStoreService) {\n  this.tokenStore.select$()\n    .subscribe(token => (this.token = token));\n}\n```\n\nY lo usaremos en las cabeceras de todas las llamadas.\n\n\n```typescript\npublic intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n  const authHeader = { Authorization: 'bearer ' + this.token };\n  const authReq = req.clone({ setHeaders: authHeader });\n  return next.handle(authReq)\n    .pipe(catchError(this.handleError.bind(this)));\n}\n```\n\nYa sabes lo bsico de Angular; pero puedes usar mucho ms conociendo su ecosistema. Sigue esta serie para agregar libreras y usar los esquemas de  [Material Design y CLI de Angular](../Material-Design-y-CLI-de-Angular/) mientras aprendes a programar con Angular. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"formularios-reactivos-con-Angular","published":1,"updated":"2019-10-16T14:23:01.036Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab1w000ybss3jayylryo","content":"<p><img src=\"/images/tutorial-angular-8_reactive.png\" alt=\"formularios-reactivos-con-Angular\"></p><p>El <strong>doble enlace automtico</strong> entre elementos <em>html</em> y propiedades de objetos fue el primer gran xito de <strong>Angular</strong>. Ese <em>doble-binding</em> facilita mucho el desarrollo de formularios. Pero esa magia tienen un coste en escalabilidad; impacta en el tiempo de ejecucin y adems dificulta la validacin y el mantenimiento de formularios complejos.</p><p>La solucin en Angular 8 pasa por desacoplar el modelo y la vista, introduciendo una capa que gestione ese doble enlace. Los servicios y directivas del mdulo <code>ReactiveFormsModule</code> que viene en la librera <code>@angular/forms</code> permiten programar <strong>formularios reactivos conducidos por el cdigo</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../vigilancia-y-seguridad-en-Angular/\">Vigilancia y seguridad en Angular</a>. Al finalizar tendrs una aplicacin con formularios <em>model driven</em> fciles de mantener y validar.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/tree/master/src/app/8-reactive/security\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic/8-reactive</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-basic/\" target=\"_blank\" rel=\"noopener\">Angular Basic</a></p></blockquote></blockquote><h1 id=\"1-Desacople-entre-vista-y-modelo\"><a href=\"#1-Desacople-entre-vista-y-modelo\" class=\"headerlink\" title=\"1 Desacople entre vista y modelo\"></a>1 Desacople entre vista y modelo</h1><p>La directiva <code>[(ngModel)]=&quot;model.property&quot;</code> con su popular <em>banana in a box</em> establece el doble enlace entre el elemento de la vista al que se le aplica y una propiedad del modelo. Los cambios en la vista son trasladados automticamente al modelo, y al revs; cualquier cambio en el modelo se refleja inmediatamente en la vista.</p><p>Se pueden establecer validaciones y configurar los eventos que disparan las actualizaciones; pero todo ello usando ms y ms atributos y directivas en la plantilla. Son los formularios <em>template driven</em> que degeneran en un <em>html</em> farragoso y difcil de mantener.</p><blockquote><p>Vamos a crear un formulario de registro de usuarios usando los formularios <em>model driven</em>. Para ello voy a crear el mdulo <em>security</em> con el componente <em>register</em> y los enganchar a la ruta <em>security/register</em>.</p></blockquote><p>El mdulo de seguridad y su configuracin lazy en el raz:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m security --routing true</span><br><span class=\"line\">ng g c security/register</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'security'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./8-reactive/security/security.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.SecurityModule)</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><p>El componente de registro y su ruta asignada:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'register'</span>,</span><br><span class=\"line\">    component: RegisterComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'register'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"security/register\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span>Register<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-1-Form-Builder\"><a href=\"#1-1-Form-Builder\" class=\"headerlink\" title=\"1.1 Form Builder\"></a>1.1 Form Builder</h2><p>Entra en accin el <code>FormBuilder</code>, un servicio del que han de depender los componentes que quieran desacoplar el modelo de la vista. Se usa para construir un formulario creando un <code>FormGroup</code>, (un grupo de controles) que realiza un seguimiento del valor y estado de cambio y validez de los datos.</p><p>Para poder usarlo tenemos que importar el mdulo de Angular en el que viene declarado, el <code>ReactiveFormModule</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; ReactiveFormsModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [RegisterComponent],</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    SecurityRoutingModule,</span><br><span class=\"line\">    ReactiveFormsModule</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SecurityModule &#123; &#125;</span><br></pre></td></tr></table></figure><p>Veamos un ejemplo mnimo de su declaracin en <code>register.component.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RegisterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> formGroup: FormGroup;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"> <span class=\"keyword\">private</span> formBuilder: FormBuilder </span>) &#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.buildForm();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> buildForm()&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;&#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"1-2-Form-control\"><a href=\"#1-2-Form-control\" class=\"headerlink\" title=\"1.2 Form control\"></a>1.2 Form control</h2><p>El formulario se define como un <strong>grupo de controles</strong>. Cada control tendr un nombre y una configuracin. Esa definicin permite establecer un valor inicial al control.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> buildForm() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dateLength = <span class=\"number\">10</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> today = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString().substring(<span class=\"number\">0</span>, dateLength);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> name = <span class=\"string\">'JOHN DOE'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;</span><br><span class=\"line\">    registeredOn: today,</span><br><span class=\"line\">    name: name.toLowerCase(),</span><br><span class=\"line\">    email: <span class=\"string\">'john@angular.io'</span>,</span><br><span class=\"line\">    password: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Como ves, es fcil asignar valores por defecto. Incluso es un buen momento para modificar o transformar datos previos para ajustarlos a cmo los ver el usuario; sin necesidad de cambiar los datos de base.</p><h2 id=\"1-3-Form-view\"><a href=\"#1-3-Form-view\" class=\"headerlink\" title=\"1.3 Form view\"></a>1.3 Form view</h2><p>Mientras tanto en la vista html Este trabajo previo y extra que tienes que hacer en el controlador se recompensa con una <strong>mayor limpieza en la vista</strong>. Lo nico necesario ser asignar por nombre el elemento html con el control <em>typescript</em> que lo gestionar.</p><blockquote><p>Para ello usaremos dos directivas que vienen dentro del mdulo <em>reactivo</em> son <code>[formGroup]=&quot;objetoFormulario&quot;</code> para el formulario en su conjunto, y <code>formControlName=&quot;nombreDelControl&quot;</code> para cada control.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> [<span class=\"attr\">formGroup</span>]=<span class=\"string\">\"formGroup\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"registeredOn\"</span>&gt;</span>Registered On<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"registeredOn\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"registeredOn\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"date\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"name\"</span>&gt;</span>Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"email\"</span>&gt;</span>E-mail<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"email\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"email\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"email\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"password\"</span>&gt;</span>Password<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"password\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"password\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"2-Validacion-y-estados\"><a href=\"#2-Validacion-y-estados\" class=\"headerlink\" title=\"2 Validacin y estados\"></a>2 Validacin y estados</h1><p>La validacin es una pieza clave de la entrada de datos en cualquier aplicacin. Es el primer <strong>frente de defensa ante errores de usuarios</strong>; ya sean involuntarios o deliberados.</p><p>Dichas validaciones se solan realizar agregando atributos html tales como el archiconocido <code>required</code>. Pero todo eso ahora se traslada a la configuracin de cada control, donde podrs establecer una o varias reglas de validacin sin mancharte con html.</p><h2 id=\"2-1-Validadores-predefinidos-y-personalizados\"><a href=\"#2-1-Validadores-predefinidos-y-personalizados\" class=\"headerlink\" title=\"2.1 Validadores predefinidos y personalizados\"></a>2.1 Validadores predefinidos y personalizados</h2><p>De nuevo tienes distintas sobrecargas que te permiten resolver limpiamente casos sencillos de una sola validacin, o usar bateras de reglas que vienen predefinidas como funciones en el objeto <code>Validators</code> del <em>framework</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> buildForm() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dateLength = <span class=\"number\">10</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> today = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString().substring(<span class=\"number\">0</span>, dateLength);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> name = <span class=\"string\">'JOHN DOE'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> minPassLength = <span class=\"number\">4</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;</span><br><span class=\"line\">    registeredOn: today,</span><br><span class=\"line\">    name: [name.toLowerCase(), Validators.required],</span><br><span class=\"line\">    email: [<span class=\"string\">'john@angular.io'</span>, [</span><br><span class=\"line\">      Validators.required, Validators.email</span><br><span class=\"line\">    ]],</span><br><span class=\"line\">    password: [<span class=\"string\">''</span>, [</span><br><span class=\"line\">      Validators.required, Validators.minLength(minPassLength)</span><br><span class=\"line\">    ]]</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>A estas validaciones integradas se puede aadir otras creadas por el programador. Incluso con ejecucin asncrona para validaciones realizadas en el servidor.</p><p>Por ejemplo podemos agregar una validacin especfica a las contraseas</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">password: [<span class=\"string\">''</span>, [</span><br><span class=\"line\">  Validators.required,</span><br><span class=\"line\">  Validators.minLength(minPassLength),</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.validatePassword</span><br><span class=\"line\">]]</span><br></pre></td></tr></table></figure><p>Lo nico que se necesita es una funcin que recibe como argumento el control a validar. El resultado debe ser un <code>null</code> si todo va bien. Y cualquier otra cosa en caso de fallo. Te muestro una propuesta para que puedas crear tus propios validadores.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> validatePassword(control: AbstractControl) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> password = control.value;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> error = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!password.includes(<span class=\"string\">'$'</span>)) &#123;</span><br><span class=\"line\">    error = &#123; ...error, dollar: <span class=\"string\">'needs a dollar symbol'</span> &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"built_in\">parseFloat</span>(password[<span class=\"number\">0</span>])) &#123;</span><br><span class=\"line\">    error = &#123; ...error, <span class=\"built_in\">number</span>: <span class=\"string\">'must start with a number'</span> &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> error;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Estados-de-cambio-y-validacion\"><a href=\"#2-2-Estados-de-cambio-y-validacion\" class=\"headerlink\" title=\"2.2 Estados de cambio y validacin\"></a>2.2 Estados de cambio y validacin</h2><p>Una vez establecidas las reglas, es hora de aplicarlas y avisar al usuario en caso de que se incumplan. Los formularios y controles reactivos estn gestionados por <strong>mquinas de estados</strong> que determinan en todo momento la situacin de cada control y del formulario en si mismo.</p><h3 id=\"2-2-1-Estados-de-validacion\"><a href=\"#2-2-1-Estados-de-validacion\" class=\"headerlink\" title=\"2.2.1 Estados de validacin\"></a>2.2.1 Estados de validacin</h3><p>Al establecer una o ms reglas para uno o ms controles activamos el sistema de chequeo y control del estado de cada control y del formulario en su conjunto.</p><p>La mquina de estados de validacin contempla los siguientes estados mutuamente excluyentes:</p><ul><li><strong>VALID</strong>: el control ha pasado todos los chequeos</li><li><strong>INVALID</strong>: el control ha fallado al menos en una regla.</li><li><strong>PENDING</strong>: el control est en medio de un proceso de validacin</li><li><strong>DISABLED</strong>: el control est desactivado y exento de validacin</li></ul><p>Cuando un control incumple con alguna regla de validacin, estas se reflejan en su propiedad <code>errors</code> que ser un objeto con una propiedad por cada regla insatisfecha y un valor o mensaje de ayuda guardado en dicha propiedad.</p><h3 id=\"2-2-2-Estados-de-modificacion\"><a href=\"#2-2-2-Estados-de-modificacion\" class=\"headerlink\" title=\"2.2.2 Estados de modificacin\"></a>2.2.2 Estados de modificacin</h3><p>Los controles, y el formulario, se someten a otra mquina de estados que monitoriza el valor del control y sus cambios.</p><p>La mquina de estados de cambio contempla entre otros los siguientes:</p><ul><li><strong>PRINSTINE</strong>: el valor del control no ha sido cambiado por el usuario</li><li><strong>DIRTY</strong>: el usuario ha modificado el valor del control.</li><li><strong>TOUCHED</strong>: el usuario ha tocado el control lanzando un evento <code>blur</code> al salir.</li><li><strong>UNTOUCHED</strong>: el usuario no ha tocado y salido del control lanzando ningn evento <code>blur</code>.</li></ul><p>Como en el caso de los estados de validacin, el formulario tambin se somete a estos estados en funcin de cmo estn sus controles.</p><p>Veamos su aplicacin primero en el caso general del formulario. Uno de los usos ms inmediatos es deshabilitar el botn de envo cuando la validacin de algn control falla.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"register()\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"formGroup.invalid\"</span>&gt;</span>Register me!<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Por cierto, este sistema de gestin de los controles del formulario oculta la parte ms valiosa (el valor que se pretende almacenar) en la propiedad <code>value</code> del formulario. Contendr un objeto con las mismas propiedades usadas durante la definicin del formulario, cada una con el valor actual del control asociado.</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> register() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> user = <span class=\"keyword\">this</span>.formGroup.value;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(user);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>La validacin particular para cada control permite informar al usuario del fallo concreto. Es una <strong>buena prctica de usabilidad</strong> el esperar a que edite un control antes de mostrarle el fallo. Y tambin es muy habitual usar la misma estrategia para cada control.</p><p>Lo que no queremos es llevar de vuelta la lgica a la vista; as que lo recomendado es crear una <strong>funcin auxiliar para mostrar los errores</strong> de validacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> getError(controlName: <span class=\"built_in\">string</span>): <span class=\"built_in\">string</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> error = <span class=\"string\">''</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> control = <span class=\"keyword\">this</span>.formGroup.get(controlName);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (control.touched &amp;&amp; control.errors != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">    error = <span class=\"built_in\">JSON</span>.stringify(control.errors);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> error;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>En la vista colocaremos adecuadamente los mensajes para facilitarle la correccin al usuario.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('name')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('email')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('password')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Ya tenemos formularios reactivos conducidos por los datos que te permitirn construir pantallas complejas manteniendo el control en el modelo y dejando la vista despejada. Como resumen podemos decir que vamos a programar ms en TypeScript que en Html. La ventaja del desacople es que podremos controlar lo que enviamos y recibimos de la vista. As se pueden aplicar formatos, validaciones y transformaciones entre lo que presentamos y lo que enviamos hacia los servicios.</p><h1 id=\"3-Un-gestor-de-credenciales\"><a href=\"#3-Un-gestor-de-credenciales\" class=\"headerlink\" title=\"3. Un gestor de credenciales\"></a>3. Un gestor de credenciales</h1><p>Vamos a provechar el conocimiento sobre <em>Interceptores</em> y <em>Observables</em> para montar un pequeo sistema de gestin de credenciales. La idea es detectar respuestas a llamadas no autenticadas y redirigir al usuario a nuestra pantalla de registro.</p><p>Si el usuario se registra correctamente recibiremos un <em>token</em> que lo identifica. Lo que haremos ser guardarlo y usarlo en el resto de las llamadas.</p><h2 id=\"3-1-Deteccion-y-redireccion-de-intrusos\"><a href=\"#3-1-Deteccion-y-redireccion-de-intrusos\" class=\"headerlink\" title=\"3.1 Deteccin y redireccin de intrusos\"></a>3.1 Deteccin y redireccin de intrusos</h2><p>Empezar por crea un servicio para el interceptor de fallos de seguridad y un componente que invocar deliberadamente a un API protegida.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s security/auth-interceptor</span><br><span class=\"line\">ng g c security/secret</span><br></pre></td></tr></table></figure><p>Al componente <em>secret</em> le asignaremos la ruta <em>security/secret</em></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"security/register\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span>Register<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'register'</span>,</span><br><span class=\"line\">    component: RegisterComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'secret'</span>,</span><br><span class=\"line\">    component: SecretComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'secret'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>En cuanto al interceptor, haremos como ya hemos visto en el tema <a href=\"../vigilancia-y-seguridad-en-Angular/\">7-watch</a>. Lo primero ser proveerlo invirtiendo el control que nos cede el <code>HttpClient</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [RegisterComponent, SecretComponent],</span><br><span class=\"line\">  imports: [CommonModule, SecurityRoutingModule, ReactiveFormsModule, HttpClientModule],</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: HTTP_INTERCEPTORS,</span><br><span class=\"line\">      useClass: AuthInterceptorService,</span><br><span class=\"line\">      multi: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SecurityModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Luego codificar la implementacin de la interfaz <code>HttpInterceptor</code>. En este caso me interesan las respuestas con <strong>error 401</strong>. Emplear el <code>Router</code> de Angular para obligar al usuario a visitar la pgina de registro cuando esto ocurra.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AuthInterceptorService <span class=\"keyword\">implements</span> HttpInterceptor &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> router: Router</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"keyword\">this</span>.handleError.bind(<span class=\"keyword\">this</span>)));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> handleError(err) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> unauthorized_code = <span class=\"number\">401</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err <span class=\"keyword\">instanceof</span> HttpErrorResponse) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (err.status === unauthorized_code) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.router.navigate([<span class=\"string\">'security/register'</span>]);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> throwError(err);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Almacenamiento-y-uso-del-token\"><a href=\"#3-2-Almacenamiento-y-uso-del-token\" class=\"headerlink\" title=\"3.2 Almacenamiento y uso del token\"></a>3.2 Almacenamiento y uso del token</h2><p>Antes de nada volveremos al tema de los observables y su uso como <strong>intermediarios entre objetos desacoplados</strong>. Para ello crear un servicio para almacenar y distribuir el <em>token</em> de identificacin de usuarios.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s security/token_store</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> TokenStoreService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> token = <span class=\"string\">''</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> token$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">string</span>&gt;(<span class=\"string\">''</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> select$ = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.token$.asObservable();</span><br><span class=\"line\">  <span class=\"keyword\">public</span> dispatch(token) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.token = token;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.token$.next(<span class=\"keyword\">this</span>.token);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>De vuelta en el componente <code>RegisterComponent</code>. Tenemos que enviar las credenciales al API para su aceptacin. Si todo va bien, nos devolvern un <em>token</em> que identifica al usuario. Es momento de usar al <code>TokenStore</code> para transmitir la noticia por toda la aplicacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> register() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"string\">'https://api-base.herokuapp.com/api/pub/credentials/registration'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> user = <span class=\"keyword\">this</span>.formGroup.value;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.post&lt;<span class=\"built_in\">any</span>&gt;(url, user)</span><br><span class=\"line\">    .subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> <span class=\"keyword\">this</span>.tokenStore.dispatch(res.token));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><p>Por ltimo volvemos al <code>AuthInterceptorService</code> en el que nos suscribiremos a los cambios acerca del <em>token</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> token = <span class=\"string\">''</span>;</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> router: Router, <span class=\"keyword\">private</span> tokenStore: TokenStoreService</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.tokenStore.select$()</span><br><span class=\"line\">    .subscribe(<span class=\"function\"><span class=\"params\">token</span> =&gt;</span> (<span class=\"keyword\">this</span>.token = token));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y lo usaremos en las cabeceras de todas las llamadas.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> authHeader = &#123; Authorization: <span class=\"string\">'bearer '</span> + <span class=\"keyword\">this</span>.token &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> authReq = req.clone(&#123; setHeaders: authHeader &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> next.handle(authReq)</span><br><span class=\"line\">    .pipe(catchError(<span class=\"keyword\">this</span>.handleError.bind(<span class=\"keyword\">this</span>)));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ya sabes lo bsico de Angular; pero puedes usar mucho ms conociendo su ecosistema. Sigue esta serie para agregar libreras y usar los esquemas de <a href=\"../Material-Design-y-CLI-de-Angular/\">Material Design y CLI de Angular</a> mientras aprendes a programar con Angular. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-8_reactive.png\" alt=\"formularios-reactivos-con-Angular\"></p><p>El <strong>doble enlace automtico</strong> entre elementos <em>html</em> y propiedades de objetos fue el primer gran xito de <strong>Angular</strong>. Ese <em>doble-binding</em> facilita mucho el desarrollo de formularios. Pero esa magia tienen un coste en escalabilidad; impacta en el tiempo de ejecucin y adems dificulta la validacin y el mantenimiento de formularios complejos.</p><p>La solucin en Angular 8 pasa por desacoplar el modelo y la vista, introduciendo una capa que gestione ese doble enlace. Los servicios y directivas del mdulo <code>ReactiveFormsModule</code> que viene en la librera <code>@angular/forms</code> permiten programar <strong>formularios reactivos conducidos por el cdigo</strong>.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../vigilancia-y-seguridad-en-Angular/\">Vigilancia y seguridad en Angular</a>. Al finalizar tendrs una aplicacin con formularios <em>model driven</em> fciles de mantener y validar.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/tree/master/src/app/8-reactive/security\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic/8-reactive</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-basic/\" target=\"_blank\" rel=\"noopener\">Angular Basic</a></p></blockquote></blockquote><h1 id=\"1-Desacople-entre-vista-y-modelo\"><a href=\"#1-Desacople-entre-vista-y-modelo\" class=\"headerlink\" title=\"1 Desacople entre vista y modelo\"></a>1 Desacople entre vista y modelo</h1><p>La directiva <code>[(ngModel)]=&quot;model.property&quot;</code> con su popular <em>banana in a box</em> establece el doble enlace entre el elemento de la vista al que se le aplica y una propiedad del modelo. Los cambios en la vista son trasladados automticamente al modelo, y al revs; cualquier cambio en el modelo se refleja inmediatamente en la vista.</p><p>Se pueden establecer validaciones y configurar los eventos que disparan las actualizaciones; pero todo ello usando ms y ms atributos y directivas en la plantilla. Son los formularios <em>template driven</em> que degeneran en un <em>html</em> farragoso y difcil de mantener.</p><blockquote><p>Vamos a crear un formulario de registro de usuarios usando los formularios <em>model driven</em>. Para ello voy a crear el mdulo <em>security</em> con el componente <em>register</em> y los enganchar a la ruta <em>security/register</em>.</p></blockquote><p>El mdulo de seguridad y su configuracin lazy en el raz:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m security --routing true</span><br><span class=\"line\">ng g c security/register</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'security'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./8-reactive/security/security.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.SecurityModule)</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><p>El componente de registro y su ruta asignada:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'register'</span>,</span><br><span class=\"line\">    component: RegisterComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'register'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"security/register\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span>Register<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-1-Form-Builder\"><a href=\"#1-1-Form-Builder\" class=\"headerlink\" title=\"1.1 Form Builder\"></a>1.1 Form Builder</h2><p>Entra en accin el <code>FormBuilder</code>, un servicio del que han de depender los componentes que quieran desacoplar el modelo de la vista. Se usa para construir un formulario creando un <code>FormGroup</code>, (un grupo de controles) que realiza un seguimiento del valor y estado de cambio y validez de los datos.</p><p>Para poder usarlo tenemos que importar el mdulo de Angular en el que viene declarado, el <code>ReactiveFormModule</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; ReactiveFormsModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [RegisterComponent],</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    SecurityRoutingModule,</span><br><span class=\"line\">    ReactiveFormsModule</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SecurityModule &#123; &#125;</span><br></pre></td></tr></table></figure><p>Veamos un ejemplo mnimo de su declaracin en <code>register.component.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RegisterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> formGroup: FormGroup;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"> <span class=\"keyword\">private</span> formBuilder: FormBuilder </span>) &#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.buildForm();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> buildForm()&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;&#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"1-2-Form-control\"><a href=\"#1-2-Form-control\" class=\"headerlink\" title=\"1.2 Form control\"></a>1.2 Form control</h2><p>El formulario se define como un <strong>grupo de controles</strong>. Cada control tendr un nombre y una configuracin. Esa definicin permite establecer un valor inicial al control.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> buildForm() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dateLength = <span class=\"number\">10</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> today = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString().substring(<span class=\"number\">0</span>, dateLength);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> name = <span class=\"string\">'JOHN DOE'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;</span><br><span class=\"line\">    registeredOn: today,</span><br><span class=\"line\">    name: name.toLowerCase(),</span><br><span class=\"line\">    email: <span class=\"string\">'john@angular.io'</span>,</span><br><span class=\"line\">    password: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Como ves, es fcil asignar valores por defecto. Incluso es un buen momento para modificar o transformar datos previos para ajustarlos a cmo los ver el usuario; sin necesidad de cambiar los datos de base.</p><h2 id=\"1-3-Form-view\"><a href=\"#1-3-Form-view\" class=\"headerlink\" title=\"1.3 Form view\"></a>1.3 Form view</h2><p>Mientras tanto en la vista html Este trabajo previo y extra que tienes que hacer en el controlador se recompensa con una <strong>mayor limpieza en la vista</strong>. Lo nico necesario ser asignar por nombre el elemento html con el control <em>typescript</em> que lo gestionar.</p><blockquote><p>Para ello usaremos dos directivas que vienen dentro del mdulo <em>reactivo</em> son <code>[formGroup]=&quot;objetoFormulario&quot;</code> para el formulario en su conjunto, y <code>formControlName=&quot;nombreDelControl&quot;</code> para cada control.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> [<span class=\"attr\">formGroup</span>]=<span class=\"string\">\"formGroup\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"registeredOn\"</span>&gt;</span>Registered On<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"registeredOn\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"registeredOn\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"date\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"name\"</span>&gt;</span>Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"email\"</span>&gt;</span>E-mail<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"email\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"email\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"email\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"password\"</span>&gt;</span>Password<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"password\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"password\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"2-Validacion-y-estados\"><a href=\"#2-Validacion-y-estados\" class=\"headerlink\" title=\"2 Validacin y estados\"></a>2 Validacin y estados</h1><p>La validacin es una pieza clave de la entrada de datos en cualquier aplicacin. Es el primer <strong>frente de defensa ante errores de usuarios</strong>; ya sean involuntarios o deliberados.</p><p>Dichas validaciones se solan realizar agregando atributos html tales como el archiconocido <code>required</code>. Pero todo eso ahora se traslada a la configuracin de cada control, donde podrs establecer una o varias reglas de validacin sin mancharte con html.</p><h2 id=\"2-1-Validadores-predefinidos-y-personalizados\"><a href=\"#2-1-Validadores-predefinidos-y-personalizados\" class=\"headerlink\" title=\"2.1 Validadores predefinidos y personalizados\"></a>2.1 Validadores predefinidos y personalizados</h2><p>De nuevo tienes distintas sobrecargas que te permiten resolver limpiamente casos sencillos de una sola validacin, o usar bateras de reglas que vienen predefinidas como funciones en el objeto <code>Validators</code> del <em>framework</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> buildForm() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dateLength = <span class=\"number\">10</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> today = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString().substring(<span class=\"number\">0</span>, dateLength);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> name = <span class=\"string\">'JOHN DOE'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> minPassLength = <span class=\"number\">4</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;</span><br><span class=\"line\">    registeredOn: today,</span><br><span class=\"line\">    name: [name.toLowerCase(), Validators.required],</span><br><span class=\"line\">    email: [<span class=\"string\">'john@angular.io'</span>, [</span><br><span class=\"line\">      Validators.required, Validators.email</span><br><span class=\"line\">    ]],</span><br><span class=\"line\">    password: [<span class=\"string\">''</span>, [</span><br><span class=\"line\">      Validators.required, Validators.minLength(minPassLength)</span><br><span class=\"line\">    ]]</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>A estas validaciones integradas se puede aadir otras creadas por el programador. Incluso con ejecucin asncrona para validaciones realizadas en el servidor.</p><p>Por ejemplo podemos agregar una validacin especfica a las contraseas</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">password: [<span class=\"string\">''</span>, [</span><br><span class=\"line\">  Validators.required,</span><br><span class=\"line\">  Validators.minLength(minPassLength),</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.validatePassword</span><br><span class=\"line\">]]</span><br></pre></td></tr></table></figure><p>Lo nico que se necesita es una funcin que recibe como argumento el control a validar. El resultado debe ser un <code>null</code> si todo va bien. Y cualquier otra cosa en caso de fallo. Te muestro una propuesta para que puedas crear tus propios validadores.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> validatePassword(control: AbstractControl) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> password = control.value;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> error = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!password.includes(<span class=\"string\">'$'</span>)) &#123;</span><br><span class=\"line\">    error = &#123; ...error, dollar: <span class=\"string\">'needs a dollar symbol'</span> &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"built_in\">parseFloat</span>(password[<span class=\"number\">0</span>])) &#123;</span><br><span class=\"line\">    error = &#123; ...error, <span class=\"built_in\">number</span>: <span class=\"string\">'must start with a number'</span> &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> error;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Estados-de-cambio-y-validacion\"><a href=\"#2-2-Estados-de-cambio-y-validacion\" class=\"headerlink\" title=\"2.2 Estados de cambio y validacin\"></a>2.2 Estados de cambio y validacin</h2><p>Una vez establecidas las reglas, es hora de aplicarlas y avisar al usuario en caso de que se incumplan. Los formularios y controles reactivos estn gestionados por <strong>mquinas de estados</strong> que determinan en todo momento la situacin de cada control y del formulario en si mismo.</p><h3 id=\"2-2-1-Estados-de-validacion\"><a href=\"#2-2-1-Estados-de-validacion\" class=\"headerlink\" title=\"2.2.1 Estados de validacin\"></a>2.2.1 Estados de validacin</h3><p>Al establecer una o ms reglas para uno o ms controles activamos el sistema de chequeo y control del estado de cada control y del formulario en su conjunto.</p><p>La mquina de estados de validacin contempla los siguientes estados mutuamente excluyentes:</p><ul><li><strong>VALID</strong>: el control ha pasado todos los chequeos</li><li><strong>INVALID</strong>: el control ha fallado al menos en una regla.</li><li><strong>PENDING</strong>: el control est en medio de un proceso de validacin</li><li><strong>DISABLED</strong>: el control est desactivado y exento de validacin</li></ul><p>Cuando un control incumple con alguna regla de validacin, estas se reflejan en su propiedad <code>errors</code> que ser un objeto con una propiedad por cada regla insatisfecha y un valor o mensaje de ayuda guardado en dicha propiedad.</p><h3 id=\"2-2-2-Estados-de-modificacion\"><a href=\"#2-2-2-Estados-de-modificacion\" class=\"headerlink\" title=\"2.2.2 Estados de modificacin\"></a>2.2.2 Estados de modificacin</h3><p>Los controles, y el formulario, se someten a otra mquina de estados que monitoriza el valor del control y sus cambios.</p><p>La mquina de estados de cambio contempla entre otros los siguientes:</p><ul><li><strong>PRINSTINE</strong>: el valor del control no ha sido cambiado por el usuario</li><li><strong>DIRTY</strong>: el usuario ha modificado el valor del control.</li><li><strong>TOUCHED</strong>: el usuario ha tocado el control lanzando un evento <code>blur</code> al salir.</li><li><strong>UNTOUCHED</strong>: el usuario no ha tocado y salido del control lanzando ningn evento <code>blur</code>.</li></ul><p>Como en el caso de los estados de validacin, el formulario tambin se somete a estos estados en funcin de cmo estn sus controles.</p><p>Veamos su aplicacin primero en el caso general del formulario. Uno de los usos ms inmediatos es deshabilitar el botn de envo cuando la validacin de algn control falla.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"register()\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"formGroup.invalid\"</span>&gt;</span>Register me!<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Por cierto, este sistema de gestin de los controles del formulario oculta la parte ms valiosa (el valor que se pretende almacenar) en la propiedad <code>value</code> del formulario. Contendr un objeto con las mismas propiedades usadas durante la definicin del formulario, cada una con el valor actual del control asociado.</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> register() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> user = <span class=\"keyword\">this</span>.formGroup.value;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(user);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>La validacin particular para cada control permite informar al usuario del fallo concreto. Es una <strong>buena prctica de usabilidad</strong> el esperar a que edite un control antes de mostrarle el fallo. Y tambin es muy habitual usar la misma estrategia para cada control.</p><p>Lo que no queremos es llevar de vuelta la lgica a la vista; as que lo recomendado es crear una <strong>funcin auxiliar para mostrar los errores</strong> de validacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> getError(controlName: <span class=\"built_in\">string</span>): <span class=\"built_in\">string</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> error = <span class=\"string\">''</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> control = <span class=\"keyword\">this</span>.formGroup.get(controlName);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (control.touched &amp;&amp; control.errors != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">    error = <span class=\"built_in\">JSON</span>.stringify(control.errors);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> error;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>En la vista colocaremos adecuadamente los mensajes para facilitarle la correccin al usuario.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('name')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('email')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('password')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Ya tenemos formularios reactivos conducidos por los datos que te permitirn construir pantallas complejas manteniendo el control en el modelo y dejando la vista despejada. Como resumen podemos decir que vamos a programar ms en TypeScript que en Html. La ventaja del desacople es que podremos controlar lo que enviamos y recibimos de la vista. As se pueden aplicar formatos, validaciones y transformaciones entre lo que presentamos y lo que enviamos hacia los servicios.</p><h1 id=\"3-Un-gestor-de-credenciales\"><a href=\"#3-Un-gestor-de-credenciales\" class=\"headerlink\" title=\"3. Un gestor de credenciales\"></a>3. Un gestor de credenciales</h1><p>Vamos a provechar el conocimiento sobre <em>Interceptores</em> y <em>Observables</em> para montar un pequeo sistema de gestin de credenciales. La idea es detectar respuestas a llamadas no autenticadas y redirigir al usuario a nuestra pantalla de registro.</p><p>Si el usuario se registra correctamente recibiremos un <em>token</em> que lo identifica. Lo que haremos ser guardarlo y usarlo en el resto de las llamadas.</p><h2 id=\"3-1-Deteccion-y-redireccion-de-intrusos\"><a href=\"#3-1-Deteccion-y-redireccion-de-intrusos\" class=\"headerlink\" title=\"3.1 Deteccin y redireccin de intrusos\"></a>3.1 Deteccin y redireccin de intrusos</h2><p>Empezar por crea un servicio para el interceptor de fallos de seguridad y un componente que invocar deliberadamente a un API protegida.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s security/auth-interceptor</span><br><span class=\"line\">ng g c security/secret</span><br></pre></td></tr></table></figure><p>Al componente <em>secret</em> le asignaremos la ruta <em>security/secret</em></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"security/register\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span>Register<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'register'</span>,</span><br><span class=\"line\">    component: RegisterComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'secret'</span>,</span><br><span class=\"line\">    component: SecretComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'secret'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>En cuanto al interceptor, haremos como ya hemos visto en el tema <a href=\"../vigilancia-y-seguridad-en-Angular/\">7-watch</a>. Lo primero ser proveerlo invirtiendo el control que nos cede el <code>HttpClient</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [RegisterComponent, SecretComponent],</span><br><span class=\"line\">  imports: [CommonModule, SecurityRoutingModule, ReactiveFormsModule, HttpClientModule],</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: HTTP_INTERCEPTORS,</span><br><span class=\"line\">      useClass: AuthInterceptorService,</span><br><span class=\"line\">      multi: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SecurityModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Luego codificar la implementacin de la interfaz <code>HttpInterceptor</code>. En este caso me interesan las respuestas con <strong>error 401</strong>. Emplear el <code>Router</code> de Angular para obligar al usuario a visitar la pgina de registro cuando esto ocurra.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AuthInterceptorService <span class=\"keyword\">implements</span> HttpInterceptor &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> router: Router</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"keyword\">this</span>.handleError.bind(<span class=\"keyword\">this</span>)));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> handleError(err) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> unauthorized_code = <span class=\"number\">401</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err <span class=\"keyword\">instanceof</span> HttpErrorResponse) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (err.status === unauthorized_code) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.router.navigate([<span class=\"string\">'security/register'</span>]);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> throwError(err);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Almacenamiento-y-uso-del-token\"><a href=\"#3-2-Almacenamiento-y-uso-del-token\" class=\"headerlink\" title=\"3.2 Almacenamiento y uso del token\"></a>3.2 Almacenamiento y uso del token</h2><p>Antes de nada volveremos al tema de los observables y su uso como <strong>intermediarios entre objetos desacoplados</strong>. Para ello crear un servicio para almacenar y distribuir el <em>token</em> de identificacin de usuarios.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s security/token_store</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> TokenStoreService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> token = <span class=\"string\">''</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> token$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">string</span>&gt;(<span class=\"string\">''</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> select$ = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.token$.asObservable();</span><br><span class=\"line\">  <span class=\"keyword\">public</span> dispatch(token) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.token = token;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.token$.next(<span class=\"keyword\">this</span>.token);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>De vuelta en el componente <code>RegisterComponent</code>. Tenemos que enviar las credenciales al API para su aceptacin. Si todo va bien, nos devolvern un <em>token</em> que identifica al usuario. Es momento de usar al <code>TokenStore</code> para transmitir la noticia por toda la aplicacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> register() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"string\">'https://api-base.herokuapp.com/api/pub/credentials/registration'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> user = <span class=\"keyword\">this</span>.formGroup.value;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.post&lt;<span class=\"built_in\">any</span>&gt;(url, user)</span><br><span class=\"line\">    .subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> <span class=\"keyword\">this</span>.tokenStore.dispatch(res.token));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><p>Por ltimo volvemos al <code>AuthInterceptorService</code> en el que nos suscribiremos a los cambios acerca del <em>token</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> token = <span class=\"string\">''</span>;</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> router: Router, <span class=\"keyword\">private</span> tokenStore: TokenStoreService</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.tokenStore.select$()</span><br><span class=\"line\">    .subscribe(<span class=\"function\"><span class=\"params\">token</span> =&gt;</span> (<span class=\"keyword\">this</span>.token = token));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y lo usaremos en las cabeceras de todas las llamadas.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> authHeader = &#123; Authorization: <span class=\"string\">'bearer '</span> + <span class=\"keyword\">this</span>.token &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> authReq = req.clone(&#123; setHeaders: authHeader &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> next.handle(authReq)</span><br><span class=\"line\">    .pipe(catchError(<span class=\"keyword\">this</span>.handleError.bind(<span class=\"keyword\">this</span>)));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ya sabes lo bsico de Angular; pero puedes usar mucho ms conociendo su ecosistema. Sigue esta serie para agregar libreras y usar los esquemas de <a href=\"../Material-Design-y-CLI-de-Angular/\">Material Design y CLI de Angular</a> mientras aprendes a programar con Angular. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Material Design y CLI de Angular","date":"2019-03-14T17:59:27.000Z","thumbnail":"/css/images/angular-9_material.png","_content":"\n![Material-Design-y-CLI-de-Angular](/images/tutorial-angular-9_material.png)\n\nEl _ecosistema_ de Angular est repleto de libreras para desarrolladores profesionales. Algunas hacen uso de los **schematics**, y entre ellas destaca [Angular Material](https://material.angular.io/). Esta implementacin de la casa de la gua de diseo _Material Design_ de Google usa las capacidades de estas plantillas del CLI que permiten agregar libreras y generar cdigo.\n\nUn programador Angular debe **dominar el CLI** y debe conocer los beneficios que aporta un repositorio de multi-proyecto. Hay escenarios complejos muy adecuaos para estos _mono-repos_. Pero con el CLI es muy sencillo crear y usar nuevas aplicaciones dentro de un repositorio.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Formularios reactivos con Angular](../formularios-reactivos-con-Angular/). Al finalizar tendrs, en el mismo repositorio, una nueva aplicacin con la apariencia y usabilidad de _Material design_.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-basic/projects/schemat/](https://github.com/AcademiaBinaria/angular-basic/tree/master/projects/schemat)\n>\n> > Tienes una versin desplegada operativa para probar [Schemat](https://academiabinaria.github.io/angular-basic/schemat/)\n\n# 1. Repositorio multi-proyecto\n\nEl primer comando que se usa al empezar con angular es `ng new mi-aplicacion`. Desde ese momento tu mundo es la carpeta `/src` en la que se genera el cdigo y en la que vas a desarrollar.\n\nPero con el tiempo, ciertos proyectos crecen y hay que dividirlos. O quizs surjan aplicaciones hermanas. Angular CLI permite disponer de ms de un proyecto **compartiendo repositorio y configuracin**.\n\n## 1.1 Carpetas src y projects\n\nDado un repositorio inicial, para agregar una nueva aplicacin usaremos el viejo comando _generate_. Por ejemplo voy a crear una aplicacin en la que usar las capacidades de los **schematics** y de **material**; la llamar _schemat_\n\n```console\nng g application schemat --routing\n```\n\nEsta aplicacin comparte la configuracin bsica de `angular.json` y las dependencias y scripts de `package.json`. Su cdigo especfico va en la carpeta `projects` destinada a los nuevos proyectos generados tras haber creado el repo inicial.\n\n\n## 1.2 Compilacin multi - proyecto\n\nA partir de ahora cada comando del CLI debera ir asociado a un proyecto concreto. Digo debera porque an `angular.json` puedes establecer un proyecto por defecto, que si no dices lo contrario ser el inicial.\n\nPero, es buena prctica crear scripts especficos en el `package.json` para iniciar y compilar cada proyecto.\n\n```\n\"start:schemat\": \"ng serve schemat --aot -o --port 4271\",\n\"build:prod:schemat\": \"ng build schemat --prod\",\n```\n\n# 2. Instalacin y configuracin de Material\n\nPor muchas funcionalidades que aporte un _framework_ como Angular, siempre necesitaremos echar mano de alguna **librera de terceros**. Normalmente eso implica instalarla con _npm_, importar sus mdulos en Angular y en ocasiones alguna configuracin extra.\n\nPero algunos proyectos ha adoptado la librera _schematics_ para facilitar la adopcin de sus libreras. Es el caso de **Angular Material**.\n\n## 2.1 Agregar dependencias con schematics\n\nPara agregar _Material_ un proyecto basta con usar el comando `add` del CLI.\n\n```console\nng add @angular/material --project=schemat\n```\n\nEsto instalar y anotar la dependencia de `@angular/material` y otros paquetes necesarios. Pero adems los registrar en `AppModule` y lo configurar.\n\n## 2.2 Estilos, iconos y temas bsicos\n\nEn el `index.html` se insertarn los enlaces a las hojas de estilos con fuentes e iconos. En el `styles.css` podremos importar el tema de _Material_ que nos guste.\n\n```css\n@import '~@angular/material/prebuilt-themes/indigo-pink.css';\n```\n\n# 3. Componentes bsicos\n\n**Angular Material** es mucho ms que un _css_. El proyecto te ofrece ms de una docena de componentes visuales para crear pginas web de aspecto y comportamiento profesional.\n\nPor si fuera poco, ofrece sus propias plantillas de _schematics_, de forma que podemos crear pantallas con el CLI y luego trabajar sobre ellas.\n\n## 3.1 Navegacin y layout\n\nPara empezar vamos a crear el armazn de la aplicacin, con su men y su espacio para cargar contenido. Despus pondremos la primera piedra con un dashboard en la raz de la web.\n\n### 3.1.1 Navegacin\n\nAl control que har de _shell_ le llaman `nav` por sus capacidades de navegacin. Lo usaremos para generar un componente. La novedad ser que la plantilla a partir de la cual se crea no viene por defecto y tenemos que especificarla con ms detalle.\n\n``` console\nng g @angular/material:nav shell --project=schemat\n```\nEL resultado es un componente normal, muy adecuado para sustituir todo lo pre-generado por el cli en`app.component.html`\n\n```html\n<app-shell></app-shell>\n```\n\n### 3.1.2 Dashboard\n\nPara la ruta raz eleg un cuadro de mando. De nuevo es una generacin a partir de una plantilla especfica. En este caso le he llamado `Home`.\n\n``` console\nng g @angular/material:dashboard home --project=schemat\n```\n\nAsociamos el componente a la ruta en `app-routing`\n\n```typescript\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent\n  }\n];\n```\nY le buscamos un lugar tanto al enlace como al `RouterOutlet` en el previamente generado `shell.component.html`.\n\n```html\n<a mat-list-item [routerLink]=\"['/']\">Home</a>\n<!-- Add Content Here -->\n<router-outlet></router-outlet>\n```\n\n## 3.2 Componentes bsicos\n\nPor supuesto que una librera de esta envergadura tienen soluciones para todo tipo de situaciones visuales. Para las ms comunes incluso ofrecen una plantilla en sus _schematics_ que permite generar prototipos funcionales de formularios, tablas y hasta rboles.\n\n### 3.2.1 Formularios\n\nPuedes generar un **formulario** para crear contactos y despus modificarlo o usarlo como gua para crear cualquier otro.\n\n``` console\nng g @angular/material:address-form contact --project=schemat\n```\n\n### 3.2.2 Tablas\n\nTambin nos muestran cmo hacer **listados**, con datos de ejemplo incluidos.\n\n``` console\nng g @angular/material:table elements --project=schemat\n```\nEl ejemplo permite adems ver los datos en pginas y configurar su comportamiento.\n\n```html\n<mat-paginator #paginator\n    [length]=\"dataSource.data.length\"\n    [pageIndex]=\"0\"\n    [pageSize]=\"5\"\n    [pageSizeOptions]=\"[5, 10, 15, 20]\">\n</mat-paginator>\n```\n### 3.2.3 rboles\n\nTermino con un ejemplo de algo reciente, **el rbol**. Este componente se resisti pero por peticin popular acabaron integrndolo y ahora puedes mostrar datos jerrquicos como ms les gusta a los usuarios: en forma de rboles.\n\n``` console\nng g @angular/material:tree source --project=schemat\n```\nPor supuesto que hay ms opciones, todas bien explicadas en la [documentacin de Angular Material](https://material.angular.io/components/categories). Es una solucin muy recomendable para aplicaciones de gestin, o simplemente para que se vean muy bien en Android y recuerden al _look and feel_ de todo lo que hace Google.\n\nCon este conocimiento finalizas tu [introduccin a Angular](../tag/Introduccion/).  En el tutorial avanzado aprenders ms cosas para programar con Angular 8.Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-9-Material-Design-y-CLI-de-Angular.md","raw":"---\ntitle: Material Design y CLI de Angular\npermalink: Material-Design-y-CLI-de-Angular\ndate: 2019-03-14 18:59:27\ntags:\n- Angular\n- Angular7\n- Angular2\n- material\n- Tutorial\n- Introduccin\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-9_material.png\n---\n\n![Material-Design-y-CLI-de-Angular](/images/tutorial-angular-9_material.png)\n\nEl _ecosistema_ de Angular est repleto de libreras para desarrolladores profesionales. Algunas hacen uso de los **schematics**, y entre ellas destaca [Angular Material](https://material.angular.io/). Esta implementacin de la casa de la gua de diseo _Material Design_ de Google usa las capacidades de estas plantillas del CLI que permiten agregar libreras y generar cdigo.\n\nUn programador Angular debe **dominar el CLI** y debe conocer los beneficios que aporta un repositorio de multi-proyecto. Hay escenarios complejos muy adecuaos para estos _mono-repos_. Pero con el CLI es muy sencillo crear y usar nuevas aplicaciones dentro de un repositorio.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Formularios reactivos con Angular](../formularios-reactivos-con-Angular/). Al finalizar tendrs, en el mismo repositorio, una nueva aplicacin con la apariencia y usabilidad de _Material design_.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-basic/projects/schemat/](https://github.com/AcademiaBinaria/angular-basic/tree/master/projects/schemat)\n>\n> > Tienes una versin desplegada operativa para probar [Schemat](https://academiabinaria.github.io/angular-basic/schemat/)\n\n# 1. Repositorio multi-proyecto\n\nEl primer comando que se usa al empezar con angular es `ng new mi-aplicacion`. Desde ese momento tu mundo es la carpeta `/src` en la que se genera el cdigo y en la que vas a desarrollar.\n\nPero con el tiempo, ciertos proyectos crecen y hay que dividirlos. O quizs surjan aplicaciones hermanas. Angular CLI permite disponer de ms de un proyecto **compartiendo repositorio y configuracin**.\n\n## 1.1 Carpetas src y projects\n\nDado un repositorio inicial, para agregar una nueva aplicacin usaremos el viejo comando _generate_. Por ejemplo voy a crear una aplicacin en la que usar las capacidades de los **schematics** y de **material**; la llamar _schemat_\n\n```console\nng g application schemat --routing\n```\n\nEsta aplicacin comparte la configuracin bsica de `angular.json` y las dependencias y scripts de `package.json`. Su cdigo especfico va en la carpeta `projects` destinada a los nuevos proyectos generados tras haber creado el repo inicial.\n\n\n## 1.2 Compilacin multi - proyecto\n\nA partir de ahora cada comando del CLI debera ir asociado a un proyecto concreto. Digo debera porque an `angular.json` puedes establecer un proyecto por defecto, que si no dices lo contrario ser el inicial.\n\nPero, es buena prctica crear scripts especficos en el `package.json` para iniciar y compilar cada proyecto.\n\n```\n\"start:schemat\": \"ng serve schemat --aot -o --port 4271\",\n\"build:prod:schemat\": \"ng build schemat --prod\",\n```\n\n# 2. Instalacin y configuracin de Material\n\nPor muchas funcionalidades que aporte un _framework_ como Angular, siempre necesitaremos echar mano de alguna **librera de terceros**. Normalmente eso implica instalarla con _npm_, importar sus mdulos en Angular y en ocasiones alguna configuracin extra.\n\nPero algunos proyectos ha adoptado la librera _schematics_ para facilitar la adopcin de sus libreras. Es el caso de **Angular Material**.\n\n## 2.1 Agregar dependencias con schematics\n\nPara agregar _Material_ un proyecto basta con usar el comando `add` del CLI.\n\n```console\nng add @angular/material --project=schemat\n```\n\nEsto instalar y anotar la dependencia de `@angular/material` y otros paquetes necesarios. Pero adems los registrar en `AppModule` y lo configurar.\n\n## 2.2 Estilos, iconos y temas bsicos\n\nEn el `index.html` se insertarn los enlaces a las hojas de estilos con fuentes e iconos. En el `styles.css` podremos importar el tema de _Material_ que nos guste.\n\n```css\n@import '~@angular/material/prebuilt-themes/indigo-pink.css';\n```\n\n# 3. Componentes bsicos\n\n**Angular Material** es mucho ms que un _css_. El proyecto te ofrece ms de una docena de componentes visuales para crear pginas web de aspecto y comportamiento profesional.\n\nPor si fuera poco, ofrece sus propias plantillas de _schematics_, de forma que podemos crear pantallas con el CLI y luego trabajar sobre ellas.\n\n## 3.1 Navegacin y layout\n\nPara empezar vamos a crear el armazn de la aplicacin, con su men y su espacio para cargar contenido. Despus pondremos la primera piedra con un dashboard en la raz de la web.\n\n### 3.1.1 Navegacin\n\nAl control que har de _shell_ le llaman `nav` por sus capacidades de navegacin. Lo usaremos para generar un componente. La novedad ser que la plantilla a partir de la cual se crea no viene por defecto y tenemos que especificarla con ms detalle.\n\n``` console\nng g @angular/material:nav shell --project=schemat\n```\nEL resultado es un componente normal, muy adecuado para sustituir todo lo pre-generado por el cli en`app.component.html`\n\n```html\n<app-shell></app-shell>\n```\n\n### 3.1.2 Dashboard\n\nPara la ruta raz eleg un cuadro de mando. De nuevo es una generacin a partir de una plantilla especfica. En este caso le he llamado `Home`.\n\n``` console\nng g @angular/material:dashboard home --project=schemat\n```\n\nAsociamos el componente a la ruta en `app-routing`\n\n```typescript\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent\n  }\n];\n```\nY le buscamos un lugar tanto al enlace como al `RouterOutlet` en el previamente generado `shell.component.html`.\n\n```html\n<a mat-list-item [routerLink]=\"['/']\">Home</a>\n<!-- Add Content Here -->\n<router-outlet></router-outlet>\n```\n\n## 3.2 Componentes bsicos\n\nPor supuesto que una librera de esta envergadura tienen soluciones para todo tipo de situaciones visuales. Para las ms comunes incluso ofrecen una plantilla en sus _schematics_ que permite generar prototipos funcionales de formularios, tablas y hasta rboles.\n\n### 3.2.1 Formularios\n\nPuedes generar un **formulario** para crear contactos y despus modificarlo o usarlo como gua para crear cualquier otro.\n\n``` console\nng g @angular/material:address-form contact --project=schemat\n```\n\n### 3.2.2 Tablas\n\nTambin nos muestran cmo hacer **listados**, con datos de ejemplo incluidos.\n\n``` console\nng g @angular/material:table elements --project=schemat\n```\nEl ejemplo permite adems ver los datos en pginas y configurar su comportamiento.\n\n```html\n<mat-paginator #paginator\n    [length]=\"dataSource.data.length\"\n    [pageIndex]=\"0\"\n    [pageSize]=\"5\"\n    [pageSizeOptions]=\"[5, 10, 15, 20]\">\n</mat-paginator>\n```\n### 3.2.3 rboles\n\nTermino con un ejemplo de algo reciente, **el rbol**. Este componente se resisti pero por peticin popular acabaron integrndolo y ahora puedes mostrar datos jerrquicos como ms les gusta a los usuarios: en forma de rboles.\n\n``` console\nng g @angular/material:tree source --project=schemat\n```\nPor supuesto que hay ms opciones, todas bien explicadas en la [documentacin de Angular Material](https://material.angular.io/components/categories). Es una solucin muy recomendable para aplicaciones de gestin, o simplemente para que se vean muy bien en Android y recuerden al _look and feel_ de todo lo que hace Google.\n\nCon este conocimiento finalizas tu [introduccin a Angular](../tag/Introduccion/).  En el tutorial avanzado aprenders ms cosas para programar con Angular 8.Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"Material-Design-y-CLI-de-Angular","published":1,"updated":"2019-10-16T14:23:01.038Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab1y000zbss3erjwsjdv","content":"<p><img src=\"/images/tutorial-angular-9_material.png\" alt=\"Material-Design-y-CLI-de-Angular\"></p><p>El <em>ecosistema</em> de Angular est repleto de libreras para desarrolladores profesionales. Algunas hacen uso de los <strong>schematics</strong>, y entre ellas destaca <a href=\"https://material.angular.io/\" target=\"_blank\" rel=\"noopener\">Angular Material</a>. Esta implementacin de la casa de la gua de diseo <em>Material Design</em> de Google usa las capacidades de estas plantillas del CLI que permiten agregar libreras y generar cdigo.</p><p>Un programador Angular debe <strong>dominar el CLI</strong> y debe conocer los beneficios que aporta un repositorio de multi-proyecto. Hay escenarios complejos muy adecuaos para estos <em>mono-repos</em>. Pero con el CLI es muy sencillo crear y usar nuevas aplicaciones dentro de un repositorio.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../formularios-reactivos-con-Angular/\">Formularios reactivos con Angular</a>. Al finalizar tendrs, en el mismo repositorio, una nueva aplicacin con la apariencia y usabilidad de <em>Material design</em>.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/tree/master/projects/schemat\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic/projects/schemat/</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-basic/schemat/\" target=\"_blank\" rel=\"noopener\">Schemat</a></p></blockquote></blockquote><h1 id=\"1-Repositorio-multi-proyecto\"><a href=\"#1-Repositorio-multi-proyecto\" class=\"headerlink\" title=\"1. Repositorio multi-proyecto\"></a>1. Repositorio multi-proyecto</h1><p>El primer comando que se usa al empezar con angular es <code>ng new mi-aplicacion</code>. Desde ese momento tu mundo es la carpeta <code>/src</code> en la que se genera el cdigo y en la que vas a desarrollar.</p><p>Pero con el tiempo, ciertos proyectos crecen y hay que dividirlos. O quizs surjan aplicaciones hermanas. Angular CLI permite disponer de ms de un proyecto <strong>compartiendo repositorio y configuracin</strong>.</p><h2 id=\"1-1-Carpetas-src-y-projects\"><a href=\"#1-1-Carpetas-src-y-projects\" class=\"headerlink\" title=\"1.1 Carpetas src y projects\"></a>1.1 Carpetas src y projects</h2><p>Dado un repositorio inicial, para agregar una nueva aplicacin usaremos el viejo comando <em>generate</em>. Por ejemplo voy a crear una aplicacin en la que usar las capacidades de los <strong>schematics</strong> y de <strong>material</strong>; la llamar <em>schemat</em></p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g application schemat --routing</span><br></pre></td></tr></table></figure><p>Esta aplicacin comparte la configuracin bsica de <code>angular.json</code> y las dependencias y scripts de <code>package.json</code>. Su cdigo especfico va en la carpeta <code>projects</code> destinada a los nuevos proyectos generados tras haber creado el repo inicial.</p><h2 id=\"1-2-Compilacion-multi-proyecto\"><a href=\"#1-2-Compilacion-multi-proyecto\" class=\"headerlink\" title=\"1.2 Compilacin multi - proyecto\"></a>1.2 Compilacin multi - proyecto</h2><p>A partir de ahora cada comando del CLI debera ir asociado a un proyecto concreto. Digo debera porque an <code>angular.json</code> puedes establecer un proyecto por defecto, que si no dices lo contrario ser el inicial.</p><p>Pero, es buena prctica crear scripts especficos en el <code>package.json</code> para iniciar y compilar cada proyecto.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;start:schemat&quot;: &quot;ng serve schemat --aot -o --port 4271&quot;,</span><br><span class=\"line\">&quot;build:prod:schemat&quot;: &quot;ng build schemat --prod&quot;,</span><br></pre></td></tr></table></figure><h1 id=\"2-Instalacion-y-configuracion-de-Material\"><a href=\"#2-Instalacion-y-configuracion-de-Material\" class=\"headerlink\" title=\"2. Instalacin y configuracin de Material\"></a>2. Instalacin y configuracin de Material</h1><p>Por muchas funcionalidades que aporte un <em>framework</em> como Angular, siempre necesitaremos echar mano de alguna <strong>librera de terceros</strong>. Normalmente eso implica instalarla con <em>npm</em>, importar sus mdulos en Angular y en ocasiones alguna configuracin extra.</p><p>Pero algunos proyectos ha adoptado la librera <em>schematics</em> para facilitar la adopcin de sus libreras. Es el caso de <strong>Angular Material</strong>.</p><h2 id=\"2-1-Agregar-dependencias-con-schematics\"><a href=\"#2-1-Agregar-dependencias-con-schematics\" class=\"headerlink\" title=\"2.1 Agregar dependencias con schematics\"></a>2.1 Agregar dependencias con schematics</h2><p>Para agregar <em>Material</em> un proyecto basta con usar el comando <code>add</code> del CLI.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng add @angular/material --project=schemat</span><br></pre></td></tr></table></figure><p>Esto instalar y anotar la dependencia de <code>@angular/material</code> y otros paquetes necesarios. Pero adems los registrar en <code>AppModule</code> y lo configurar.</p><h2 id=\"2-2-Estilos-iconos-y-temas-basicos\"><a href=\"#2-2-Estilos-iconos-y-temas-basicos\" class=\"headerlink\" title=\"2.2 Estilos, iconos y temas bsicos\"></a>2.2 Estilos, iconos y temas bsicos</h2><p>En el <code>index.html</code> se insertarn los enlaces a las hojas de estilos con fuentes e iconos. En el <code>styles.css</code> podremos importar el tema de <em>Material</em> que nos guste.</p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@<span class=\"keyword\">import</span> <span class=\"string\">'~@angular/material/prebuilt-themes/indigo-pink.css'</span>;</span><br></pre></td></tr></table></figure><h1 id=\"3-Componentes-basicos\"><a href=\"#3-Componentes-basicos\" class=\"headerlink\" title=\"3. Componentes bsicos\"></a>3. Componentes bsicos</h1><p><strong>Angular Material</strong> es mucho ms que un <em>css</em>. El proyecto te ofrece ms de una docena de componentes visuales para crear pginas web de aspecto y comportamiento profesional.</p><p>Por si fuera poco, ofrece sus propias plantillas de <em>schematics</em>, de forma que podemos crear pantallas con el CLI y luego trabajar sobre ellas.</p><h2 id=\"3-1-Navegacion-y-layout\"><a href=\"#3-1-Navegacion-y-layout\" class=\"headerlink\" title=\"3.1 Navegacin y layout\"></a>3.1 Navegacin y layout</h2><p>Para empezar vamos a crear el armazn de la aplicacin, con su men y su espacio para cargar contenido. Despus pondremos la primera piedra con un dashboard en la raz de la web.</p><h3 id=\"3-1-1-Navegacion\"><a href=\"#3-1-1-Navegacion\" class=\"headerlink\" title=\"3.1.1 Navegacin\"></a>3.1.1 Navegacin</h3><p>Al control que har de <em>shell</em> le llaman <code>nav</code> por sus capacidades de navegacin. Lo usaremos para generar un componente. La novedad ser que la plantilla a partir de la cual se crea no viene por defecto y tenemos que especificarla con ms detalle.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:nav shell --project=schemat</span><br></pre></td></tr></table></figure><p>EL resultado es un componente normal, muy adecuado para sustituir todo lo pre-generado por el cli en<code>app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-shell</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-shell</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"3-1-2-Dashboard\"><a href=\"#3-1-2-Dashboard\" class=\"headerlink\" title=\"3.1.2 Dashboard\"></a>3.1.2 Dashboard</h3><p>Para la ruta raz eleg un cuadro de mando. De nuevo es una generacin a partir de una plantilla especfica. En este caso le he llamado <code>Home</code>.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:dashboard home --project=schemat</span><br></pre></td></tr></table></figure><p>Asociamos el componente a la ruta en <code>app-routing</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>Y le buscamos un lugar tanto al enlace como al <code>RouterOutlet</code> en el previamente generado <code>shell.component.html</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">mat-list-item</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/']\"</span>&gt;</span>Home<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Add Content Here --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"3-2-Componentes-basicos\"><a href=\"#3-2-Componentes-basicos\" class=\"headerlink\" title=\"3.2 Componentes bsicos\"></a>3.2 Componentes bsicos</h2><p>Por supuesto que una librera de esta envergadura tienen soluciones para todo tipo de situaciones visuales. Para las ms comunes incluso ofrecen una plantilla en sus <em>schematics</em> que permite generar prototipos funcionales de formularios, tablas y hasta rboles.</p><h3 id=\"3-2-1-Formularios\"><a href=\"#3-2-1-Formularios\" class=\"headerlink\" title=\"3.2.1 Formularios\"></a>3.2.1 Formularios</h3><p>Puedes generar un <strong>formulario</strong> para crear contactos y despus modificarlo o usarlo como gua para crear cualquier otro.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:address-form contact --project=schemat</span><br></pre></td></tr></table></figure><h3 id=\"3-2-2-Tablas\"><a href=\"#3-2-2-Tablas\" class=\"headerlink\" title=\"3.2.2 Tablas\"></a>3.2.2 Tablas</h3><p>Tambin nos muestran cmo hacer <strong>listados</strong>, con datos de ejemplo incluidos.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:table elements --project=schemat</span><br></pre></td></tr></table></figure><p>El ejemplo permite adems ver los datos en pginas y configurar su comportamiento.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mat-paginator</span> #<span class=\"attr\">paginator</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">length</span>]=<span class=\"string\">\"dataSource.data.length\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageIndex</span>]=<span class=\"string\">\"0\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageSize</span>]=<span class=\"string\">\"5\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageSizeOptions</span>]=<span class=\"string\">\"[5, 10, 15, 20]\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mat-paginator</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"3-2-3-Arboles\"><a href=\"#3-2-3-Arboles\" class=\"headerlink\" title=\"3.2.3 rboles\"></a>3.2.3 rboles</h3><p>Termino con un ejemplo de algo reciente, <strong>el rbol</strong>. Este componente se resisti pero por peticin popular acabaron integrndolo y ahora puedes mostrar datos jerrquicos como ms les gusta a los usuarios: en forma de rboles.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:tree source --project=schemat</span><br></pre></td></tr></table></figure><p>Por supuesto que hay ms opciones, todas bien explicadas en la <a href=\"https://material.angular.io/components/categories\" target=\"_blank\" rel=\"noopener\">documentacin de Angular Material</a>. Es una solucin muy recomendable para aplicaciones de gestin, o simplemente para que se vean muy bien en Android y recuerden al <em>look and feel</em> de todo lo que hace Google.</p><p>Con este conocimiento finalizas tu <a href=\"../tag/Introduccion/\">introduccin a Angular</a>. En el tutorial avanzado aprenders ms cosas para programar con Angular 8.Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-9_material.png\" alt=\"Material-Design-y-CLI-de-Angular\"></p><p>El <em>ecosistema</em> de Angular est repleto de libreras para desarrolladores profesionales. Algunas hacen uso de los <strong>schematics</strong>, y entre ellas destaca <a href=\"https://material.angular.io/\" target=\"_blank\" rel=\"noopener\">Angular Material</a>. Esta implementacin de la casa de la gua de diseo <em>Material Design</em> de Google usa las capacidades de estas plantillas del CLI que permiten agregar libreras y generar cdigo.</p><p>Un programador Angular debe <strong>dominar el CLI</strong> y debe conocer los beneficios que aporta un repositorio de multi-proyecto. Hay escenarios complejos muy adecuaos para estos <em>mono-repos</em>. Pero con el CLI es muy sencillo crear y usar nuevas aplicaciones dentro de un repositorio.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../formularios-reactivos-con-Angular/\">Formularios reactivos con Angular</a>. Al finalizar tendrs, en el mismo repositorio, una nueva aplicacin con la apariencia y usabilidad de <em>Material design</em>.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/tree/master/projects/schemat\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic/projects/schemat/</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-basic/schemat/\" target=\"_blank\" rel=\"noopener\">Schemat</a></p></blockquote></blockquote><h1 id=\"1-Repositorio-multi-proyecto\"><a href=\"#1-Repositorio-multi-proyecto\" class=\"headerlink\" title=\"1. Repositorio multi-proyecto\"></a>1. Repositorio multi-proyecto</h1><p>El primer comando que se usa al empezar con angular es <code>ng new mi-aplicacion</code>. Desde ese momento tu mundo es la carpeta <code>/src</code> en la que se genera el cdigo y en la que vas a desarrollar.</p><p>Pero con el tiempo, ciertos proyectos crecen y hay que dividirlos. O quizs surjan aplicaciones hermanas. Angular CLI permite disponer de ms de un proyecto <strong>compartiendo repositorio y configuracin</strong>.</p><h2 id=\"1-1-Carpetas-src-y-projects\"><a href=\"#1-1-Carpetas-src-y-projects\" class=\"headerlink\" title=\"1.1 Carpetas src y projects\"></a>1.1 Carpetas src y projects</h2><p>Dado un repositorio inicial, para agregar una nueva aplicacin usaremos el viejo comando <em>generate</em>. Por ejemplo voy a crear una aplicacin en la que usar las capacidades de los <strong>schematics</strong> y de <strong>material</strong>; la llamar <em>schemat</em></p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g application schemat --routing</span><br></pre></td></tr></table></figure><p>Esta aplicacin comparte la configuracin bsica de <code>angular.json</code> y las dependencias y scripts de <code>package.json</code>. Su cdigo especfico va en la carpeta <code>projects</code> destinada a los nuevos proyectos generados tras haber creado el repo inicial.</p><h2 id=\"1-2-Compilacion-multi-proyecto\"><a href=\"#1-2-Compilacion-multi-proyecto\" class=\"headerlink\" title=\"1.2 Compilacin multi - proyecto\"></a>1.2 Compilacin multi - proyecto</h2><p>A partir de ahora cada comando del CLI debera ir asociado a un proyecto concreto. Digo debera porque an <code>angular.json</code> puedes establecer un proyecto por defecto, que si no dices lo contrario ser el inicial.</p><p>Pero, es buena prctica crear scripts especficos en el <code>package.json</code> para iniciar y compilar cada proyecto.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;start:schemat&quot;: &quot;ng serve schemat --aot -o --port 4271&quot;,</span><br><span class=\"line\">&quot;build:prod:schemat&quot;: &quot;ng build schemat --prod&quot;,</span><br></pre></td></tr></table></figure><h1 id=\"2-Instalacion-y-configuracion-de-Material\"><a href=\"#2-Instalacion-y-configuracion-de-Material\" class=\"headerlink\" title=\"2. Instalacin y configuracin de Material\"></a>2. Instalacin y configuracin de Material</h1><p>Por muchas funcionalidades que aporte un <em>framework</em> como Angular, siempre necesitaremos echar mano de alguna <strong>librera de terceros</strong>. Normalmente eso implica instalarla con <em>npm</em>, importar sus mdulos en Angular y en ocasiones alguna configuracin extra.</p><p>Pero algunos proyectos ha adoptado la librera <em>schematics</em> para facilitar la adopcin de sus libreras. Es el caso de <strong>Angular Material</strong>.</p><h2 id=\"2-1-Agregar-dependencias-con-schematics\"><a href=\"#2-1-Agregar-dependencias-con-schematics\" class=\"headerlink\" title=\"2.1 Agregar dependencias con schematics\"></a>2.1 Agregar dependencias con schematics</h2><p>Para agregar <em>Material</em> un proyecto basta con usar el comando <code>add</code> del CLI.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng add @angular/material --project=schemat</span><br></pre></td></tr></table></figure><p>Esto instalar y anotar la dependencia de <code>@angular/material</code> y otros paquetes necesarios. Pero adems los registrar en <code>AppModule</code> y lo configurar.</p><h2 id=\"2-2-Estilos-iconos-y-temas-basicos\"><a href=\"#2-2-Estilos-iconos-y-temas-basicos\" class=\"headerlink\" title=\"2.2 Estilos, iconos y temas bsicos\"></a>2.2 Estilos, iconos y temas bsicos</h2><p>En el <code>index.html</code> se insertarn los enlaces a las hojas de estilos con fuentes e iconos. En el <code>styles.css</code> podremos importar el tema de <em>Material</em> que nos guste.</p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@<span class=\"keyword\">import</span> <span class=\"string\">'~@angular/material/prebuilt-themes/indigo-pink.css'</span>;</span><br></pre></td></tr></table></figure><h1 id=\"3-Componentes-basicos\"><a href=\"#3-Componentes-basicos\" class=\"headerlink\" title=\"3. Componentes bsicos\"></a>3. Componentes bsicos</h1><p><strong>Angular Material</strong> es mucho ms que un <em>css</em>. El proyecto te ofrece ms de una docena de componentes visuales para crear pginas web de aspecto y comportamiento profesional.</p><p>Por si fuera poco, ofrece sus propias plantillas de <em>schematics</em>, de forma que podemos crear pantallas con el CLI y luego trabajar sobre ellas.</p><h2 id=\"3-1-Navegacion-y-layout\"><a href=\"#3-1-Navegacion-y-layout\" class=\"headerlink\" title=\"3.1 Navegacin y layout\"></a>3.1 Navegacin y layout</h2><p>Para empezar vamos a crear el armazn de la aplicacin, con su men y su espacio para cargar contenido. Despus pondremos la primera piedra con un dashboard en la raz de la web.</p><h3 id=\"3-1-1-Navegacion\"><a href=\"#3-1-1-Navegacion\" class=\"headerlink\" title=\"3.1.1 Navegacin\"></a>3.1.1 Navegacin</h3><p>Al control que har de <em>shell</em> le llaman <code>nav</code> por sus capacidades de navegacin. Lo usaremos para generar un componente. La novedad ser que la plantilla a partir de la cual se crea no viene por defecto y tenemos que especificarla con ms detalle.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:nav shell --project=schemat</span><br></pre></td></tr></table></figure><p>EL resultado es un componente normal, muy adecuado para sustituir todo lo pre-generado por el cli en<code>app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-shell</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-shell</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"3-1-2-Dashboard\"><a href=\"#3-1-2-Dashboard\" class=\"headerlink\" title=\"3.1.2 Dashboard\"></a>3.1.2 Dashboard</h3><p>Para la ruta raz eleg un cuadro de mando. De nuevo es una generacin a partir de una plantilla especfica. En este caso le he llamado <code>Home</code>.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:dashboard home --project=schemat</span><br></pre></td></tr></table></figure><p>Asociamos el componente a la ruta en <code>app-routing</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>Y le buscamos un lugar tanto al enlace como al <code>RouterOutlet</code> en el previamente generado <code>shell.component.html</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">mat-list-item</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/']\"</span>&gt;</span>Home<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Add Content Here --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"3-2-Componentes-basicos\"><a href=\"#3-2-Componentes-basicos\" class=\"headerlink\" title=\"3.2 Componentes bsicos\"></a>3.2 Componentes bsicos</h2><p>Por supuesto que una librera de esta envergadura tienen soluciones para todo tipo de situaciones visuales. Para las ms comunes incluso ofrecen una plantilla en sus <em>schematics</em> que permite generar prototipos funcionales de formularios, tablas y hasta rboles.</p><h3 id=\"3-2-1-Formularios\"><a href=\"#3-2-1-Formularios\" class=\"headerlink\" title=\"3.2.1 Formularios\"></a>3.2.1 Formularios</h3><p>Puedes generar un <strong>formulario</strong> para crear contactos y despus modificarlo o usarlo como gua para crear cualquier otro.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:address-form contact --project=schemat</span><br></pre></td></tr></table></figure><h3 id=\"3-2-2-Tablas\"><a href=\"#3-2-2-Tablas\" class=\"headerlink\" title=\"3.2.2 Tablas\"></a>3.2.2 Tablas</h3><p>Tambin nos muestran cmo hacer <strong>listados</strong>, con datos de ejemplo incluidos.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:table elements --project=schemat</span><br></pre></td></tr></table></figure><p>El ejemplo permite adems ver los datos en pginas y configurar su comportamiento.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mat-paginator</span> #<span class=\"attr\">paginator</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">length</span>]=<span class=\"string\">\"dataSource.data.length\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageIndex</span>]=<span class=\"string\">\"0\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageSize</span>]=<span class=\"string\">\"5\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageSizeOptions</span>]=<span class=\"string\">\"[5, 10, 15, 20]\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mat-paginator</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"3-2-3-Arboles\"><a href=\"#3-2-3-Arboles\" class=\"headerlink\" title=\"3.2.3 rboles\"></a>3.2.3 rboles</h3><p>Termino con un ejemplo de algo reciente, <strong>el rbol</strong>. Este componente se resisti pero por peticin popular acabaron integrndolo y ahora puedes mostrar datos jerrquicos como ms les gusta a los usuarios: en forma de rboles.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:tree source --project=schemat</span><br></pre></td></tr></table></figure><p>Por supuesto que hay ms opciones, todas bien explicadas en la <a href=\"https://material.angular.io/components/categories\" target=\"_blank\" rel=\"noopener\">documentacin de Angular Material</a>. Es una solucin muy recomendable para aplicaciones de gestin, o simplemente para que se vean muy bien en Android y recuerden al <em>look and feel</em> de todo lo que hace Google.</p><p>Con este conocimiento finalizas tu <a href=\"../tag/Introduccion/\">introduccin a Angular</a>. En el tutorial avanzado aprenders ms cosas para programar con Angular 8.Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Hola Angular CLI","date":"2020-03-04T17:54:00.000Z","thumbnail":"/css/images/angular-0_cli.png","_content":"\n![hola-angular-cli](/images/tutorial-angular-0_cli.png)\n\n**Angular en su versin 9 es la plataforma perfecta para el desarrollo** profesional de aplicaciones modernas. **El Angular CLI es la herramienta** adecuada para generar aplicaciones Angular. Juntos son imbatibles en cuanto a velocidad en desarrollo y a potencia en ejecucin.\n\n<!-- more -->\n\nEl comnmente conocido como **AngularCLI** o _angular cli_ o _angular-cli_ o _CLI a secas_ es la herramienta de lnea de comandos estndar para **crear, depurar y publicar aplicaciones Angular**. En su actual **versin 9** es ms potente y verstil que nunca y es muy sencillo dominar los aspectos bsicos.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Instalacin de Angular CLI 9\n\nAngular es una plataforma de desarrollo dogmtica y llave en mano. Para empezar, como en casi cualquier desarrollo **necesitars [NodeJS](https://nodejs.org/en/) y su manejador de de paquetes _npm_**. Tenerlos actualizados es un mandamiento bsico para un desarrollador web. Comprueba tu versin con el siguiente comando:\n\n```console\nnode -v\n```\n\nEmpieza con una **instalacin global** que te permita usar la herramienta desde cualquier directorio. Comprueba la versin instalada y accede a la ayuda en lnea. La ayuda est disponible tanto de modo general como para cada comando que vayas a usar.\n\nInstrucciones para instalar Angular CLI.\n\n```console\n$ npm i -g @angular/cli@latest\n$ ng version\n$ ng help\n$ ng new --help\n```\n\n# 2. Crear y ejecutar una aplicacin Angular 9\n\nUna vez que hayas instalado el CLI de manera global ya puedes empezar a usarlo en tu directorio de trabajo. El primer comando ser `ng new` que te va a **generar toda una aplicacin funcional** y las configuraciones necesarias para su depuracin, pruebas y ejecucin.\n\nComo novedad, en las ltimas versiones, el CLI te preguntar por algunas opciones para crear tu aplicacin. Eso es porque no todos los desarrollos son iguales. Se puede configurar el tipo, el estilo y muchas ms cosas, tanto de forma interactiva como mediante opciones en lnea de comandos.\n\nLo ms habitual es usar la configuracin que viene por defecto, pero tambin se pueden crear soluciones a medida. Te muestro unos ejemplos para que pruebes y te familiarices con la herramienta. Para ms informacin mira la documentacin del comando [ng new](https://angular.io/cli/new).\n\n## 2.1 Bsica\n\n```console\nng new unaAppMuyCorriente\ncd unaAppMuyCorriente\nnpm start\n```\n\n## 2.2 Minimalista\n\n```console\nng new minimalista -s -S -t\ncd minimalista\nnpm start\n```\n\n## 2.3 Profesional\n\n```console\nng new profesional -p acme --routing true\ncd profesional\nnpm start\n```\n\n## 2.4 Empresarial\n\n```console\nng new empresarial --create-application false\ncd empresarial\nng generate application compras -p acme --routing true\nnpm start\n```\n\nUna vez finalizada la instalacin de todas las libreras necesarias puedes bajar a la carpeta recin creada y ejecutar el comando standard de _npm_ para el arranque de cualquier aplicacin: `npm start`. Si todo va bien, en unos segundo podrs visitar [http://localhost:4000](http://localhost:4000) para ver en marcha la aplicacin. Lo veremos con ms detalle en el apartado de configuracin.\n\n> ejemplo: La aplicacin que sirve de ejemplo a este tutorial fue creada con este comando:\n\n```console\nng new angular-basic -p ab --style css --routing\n```\n\n# 3. Estructura de una aplicacin Angular\n\nUna vez generada y comprobada la ejecucin, toca estudiar cmo es la estructura de la aplicacin. Para ello revisa carpeta a carpeta. Las malas noticias son que hay **una enorme cantidad de ficheros y carpetas**, las buenas son que como vers, casi todo es **configuracin e infraestructura**.\n\n## 3.1 Visual Studio Code\n\nPara ver y editar los ficheros te vale cualquier editor de cdigo, pero yo uso y te recomiendo [VSCode](https://code.visualstudio.com/). Es un **gran editor, gratuito y multiplataforma**. Viene con un terminal integrado y puedes mejorarlo instalando extensiones desde una galera del propio editor.\n\nTe recomiendo instalar un paquete de extensiones ya configurado y preparado para el desarrollo de aplicaciones con _Angular_, se llama [Angular Essentials](https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials). Con eso y el [Material Icon Theme](https://marketplace.visualstudio.com/items?itemName=PKief.material-icon-theme) vers _Angular en colores_.\n\n## 3.2 Carpetas y Ficheros principales\n\nVolviendo a la **estructura de ficheros y carpetas** te encontrars con muchos archivos de distintos tipos. Si eres completamente nuevo en Angular, te llamar la atencin las extensiones `.ts`. Son para ficheros [_TypeScript_](https://www.typescriptlang.org/), una evolucin del _JavaScript_ con facilidades para el programador. Por ahora slo tienes que familiarizarte con estos:\n\n- **angular.json** _: configuracin del propio CLI. La madre de todos los configuradores_\n- **package.json** _: dependencias de libreras y scripts_\n- **src/** _: la carpeta donde estn los archivos fuentes_\n  - **index.html** _: un fichero HTML ndice estndar_\n  - **main.ts** _: fichero TypeScript de arranque de la aplicacin_\n  - **app/** _: la carpeta con el cdigo especfico de tu aplicacin_\n    - **app.module.ts** _: la aplicacin es un rbol de mdulos, y este es su raz_\n    - **app.component.ts** _: la pgina es un rbol de componentes, y este es su raz_\n    - **app.component.html** _: tiene una parte visual, esta es su vista_\n\nEcha un vistazo a estos ficheros, pronto los modificaremos para sentirnos programadores.\n\n# 4. Edicin\n\nAngular CLI instala y configura un conjunto de herramientas que te harn la vida ms fcil. Entre otras, destaca la capacidad de **recargar la aplicacin en caliente** en cuanto guardas tu trabajo como programador. En esta ltima versin, la 9, se ha mejorado el proceso y es realmente rpido.\n\nPara probarlo slo tienes que dejar arrancada la aplicacin con el comando `npm start`; **cambiar un fichero de cdigo y comprobar el resultado** en el navegador. Te propongo empezar como en cualquier otro lenguaje; por el famoso _hola mundo_.\n\n## 4.1 Hola Mundo\n\nAbre el fichero `app.component.ts` y busca dentro de l una clase llamada `AppComponent`. Encontrars que tiene una propiedad `title`. Asgnale el saludo de rigor: `title = 'angular - basic: hello world ;-)';`. Guarda y comprueba cmo tu navegador **se habr actualizado automticamente**.\n\nToda **esta magia depende de una cadena de comandos** que lanzan distintas herramientas previamente instaladas y configuradas por el CLI. Entre ellas cabe mencionar a [_WebPack_](https://webpack.github.io/), un coloso que afortunadamente viene instalado y preparado para funcionar de manera transparente.\n\n## 4.2 npm start\n\nEsta es una lista no exhaustiva de lo que sucede.\n\n1. npm start\n2. ng serve\n3. webpack server en http://localhost:4200\n   1. vigilancia de cambios sobre la carpeta src/\n   2. live reload\n   3. compilado de la aplicacin\n   4. recarga del navegador\n\nCambia a tu antojo el `app.component.ts` o su hermano `app.component.html` y comprueba los cambios de manera inmediata en tu navegador.\n\n# 5. Configuracin\n\nEl CLI 9 viene con pilas incluidas, se puede usar desde el primer momento. Slo quedan pequeas mejoras que hacer. Por ejemplo ajustar el `package.json` y agregar libreras de terceros.\n\n## 5.1 Package.json\n\nEl `package.json` es el fichero estndar de _npm_ donde se almacenan las **dependencias de terceros**. Contiene las libreras que necesita la aplicacin para ejecutarse, por ejemplo todas las de _Angular 9_. Y tambin las herramientas que necesita el programador, por ejemplo el propio _AngularCLI_;\n\n```json\n{\n  \"dependencies\": {\n    \"@angular/core\": \"~9.1.1\"\n  },\n  \"devDependencies\": {\n    \"@angular/cli\": \"~9.1.1\"\n  }\n}\n```\n\nOtro uso del `package.json` es servir de **contenedor de scripts** para automatizar tareas de operaciones rutinarias. Por ejemplo, el comando estndar `npm start` ejecutar el contenido asignado en el fichero _json_, originalmente `ng serve`. Esto lanza el servidor de pruebas con sus opciones por defecto.\n\nPero el **comando [ng serve](https://angular.io/cli/serve)** admite muchas configuraciones. Te propongo que uses esta para activar un modo de compilacin ms rpido y seguro, y para que se abra el navegador de forma automtica en cuanto lances el servidor. Y adems te recomiendo que uses un puerto especfico para cada aplicacin.\n\nOtras configuraciones en produccin\n\n```json\n{\n  \"start\": \"ng serve -o --port 4290\"\n}\n```\n\n## 5.2 Estilos y libreras de terceros\n\nLas libreras que vienen de fbrica tienen todo lo necesario para crear aplicaciones. Pero raro es el caso en que no necesitemos **algn que otro producto de terceros**. Ya sean utilidades como _[date-fns](https://date-fns.org/)_, libreras grficas como _[chart.js](http://www.chartjs.org/)_ o la aplicacin de estilos y componentes visuales de _frameworks como Bootstrap o MaterialDesign_. Pero todos se instalan de igual forma. Descargndolos con _npm_ y adjuntndolos en el `angular.json`.\n\nEstas colecciones de archivos los usa el _cli_ a travs de _webpack_ para incluirlos **minificados y concatenados en un fichero _bundle_ sustituyendo a las clsicas etiquetas html**.Todo, el html y sus estilos, se construir en el cliente a partir de instrucciones JavaScript. De esta forma el fichero `index.html` apenas tendrs que tocarlo, salvo para algunas etiquetas de meta informacin.\n\n```html\n<meta name=\"description\" content=\"A sample project for learning Angular ;-)\" />\n<meta name=\"keywords\" content=\"Angular Sample Tutorial Ejemplo\" />\n<meta name=\"author\" content=\"Alberto Basalo\" />\n```\n\n## 5.3 Environments\n\nLa carpeta `environments/` contiene dos ficheros, y puede contener ms, para cada entorno de distribucin necesario. En cdigo siempre importaremos el fichero base, pero durante la compilacin el CLI lo sustituir por el adecuado.\n\n```typescript\ntitle = environment.appName + 'hello world ;-)';\n```\n\n## 5.4 Assets\n\nLos ficheros de la carpeta `assets/` se copian tal cual al despliegue. Es un buen lugar para logos, imgenes y ficheros de datos estticos.\n\nPor ejemplo, en el `app.component.html` he sustituido la imagen incrustada del Angular con un logo propio.\n\n```html\n<img width=\"100\" src=\"./assets/logo.png\" />\n```\n\n# 6. Angular 9, el CLI 9 y su ecosistema\n\nAlgunos consejos y herramientas tiles que rodean al mundo Angular.\n\nPero si la lnea de comandos te suena muy antigua y lo tuyo son las interfaces grficas, ests de suerte. El reciente proyecto [Angular Console](https://angularconsole.com/) te permite generar y ejecutar comandos desde una cmoda interfaz grfica.\n\nUna mejora digna de mencin es la capacidad de presupuestar tamaos de los ficheros generados. De esa forma podemos controlar el peso y tiempo de descarga de la aplicacin.\n\nPara garantizar la limpieza del cdigo conviene usar herramientas como [Prettier](https://prettier.io/) y configurarlas para su compatibilidad con Angular.\n\nLos ltimos toques antes de publicar pueden incluir el _script de analytics_ en el `index.html` y ajustes de retro-compatibilidad en el fichero `polyfills.ts`.\n\nLuego un comando y listo para publicar en _github pages_. `ng add angular-cli-ghpages`.\n\n> Te recomiendo que te familiarices y uses mucho estos _scripts_ en el `package.json` para poder lanzarlos ms tarde.\n\n```json\n{\n   \"scripts\": {\n    \"ng\": \"ng\",\n    \"start\": \"ng serve -o --port 4290\",\n    \"start:prod\": \"npm run build:prod && npm run http-server\",\n    \"build\": \"ng build\",\n    \"build:prod\": \"ng build --prod\",\n    \"deploy\": \"ng deploy --baseHref=/angular-basic/\",\n    \"test\": \"ng test\",\n    \"lint\": \"ng lint\",\n    \"e2e\": \"ng e2e\"\n  },\n}\n```\n\nComprueba las ejecuciones de los distintos _scripts_. Con `npm start` no se generan ficheros fsicos. Todos es en memoria para mayor velocidad de re-compilacin mientras desarrollas. En cambio `npm run build:prod` crear una carpeta `./dist/angular-basic` en la que dejar los archivos necesarios para ejecucin. Por ltimo `npm run deploy` los prepara para enviar compilados a un rama estndar de publicacin listos para desplegarse en las [_github pages_](https://pages.github.com/).\n\nOtros enlaces de inters sobre el ecosistema Angular.\n\n- [Extensiones Esenciales](https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials)\n- [Prettier](https://prettier.io/)\n- [TsLint-Prettier](https://github.com/prettier/tslint-config-prettier)\n- [Angular Console](https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console)\n- [Angular Material](https://material.angular.io/)\n- [Bootstrap](https://ng-bootstrap.github.io/#/home)\n- [Augury](https://augury.rangle.io/)\n- [Apollo GraphQL](https://www.apollographql.com/docs/)\n- [Ionic](https://ionicframework.com/)\n- [Angular Console](https://angularconsole.com/)\n\nPara complementar tu conocimiento te recomiendo la [documentacin de Angular/CLI](https://angular.io/cli) y este artculo avanzado que trata la configuracin del CLI en profundidad [Angular CLI under the hood](https://medium.com/dailyjs/angular-cli-6-under-the-hood-builders-demystified-f0690ebcf01)\n\nEsto es slo el principio, _Angular CLI 9_ puede hacer mucho ms por ti; descbrelo en esta serie tutorial para aprender a programar con Angular 9. En el prximo artculo crearemos una [Base para una aplicacin Angular](../base-aplicacion-angular/). Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng_0-Hola-Angular-CLI.md","raw":"---\ntitle: Hola Angular CLI\npermalink: hola-angular-cli\ndate: 2020-03-04 18:54:00\ntags:\n  - Angular\n  - CLI\n  - Tutorial\n  - Introduccin\n  - Angular9\n  - Angular2\ncategories:\n  - [Tutorial, Angular]\nthumbnail: /css/images/angular-0_cli.png\n---\n\n![hola-angular-cli](/images/tutorial-angular-0_cli.png)\n\n**Angular en su versin 9 es la plataforma perfecta para el desarrollo** profesional de aplicaciones modernas. **El Angular CLI es la herramienta** adecuada para generar aplicaciones Angular. Juntos son imbatibles en cuanto a velocidad en desarrollo y a potencia en ejecucin.\n\n<!-- more -->\n\nEl comnmente conocido como **AngularCLI** o _angular cli_ o _angular-cli_ o _CLI a secas_ es la herramienta de lnea de comandos estndar para **crear, depurar y publicar aplicaciones Angular**. En su actual **versin 9** es ms potente y verstil que nunca y es muy sencillo dominar los aspectos bsicos.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Instalacin de Angular CLI 9\n\nAngular es una plataforma de desarrollo dogmtica y llave en mano. Para empezar, como en casi cualquier desarrollo **necesitars [NodeJS](https://nodejs.org/en/) y su manejador de de paquetes _npm_**. Tenerlos actualizados es un mandamiento bsico para un desarrollador web. Comprueba tu versin con el siguiente comando:\n\n```console\nnode -v\n```\n\nEmpieza con una **instalacin global** que te permita usar la herramienta desde cualquier directorio. Comprueba la versin instalada y accede a la ayuda en lnea. La ayuda est disponible tanto de modo general como para cada comando que vayas a usar.\n\nInstrucciones para instalar Angular CLI.\n\n```console\n$ npm i -g @angular/cli@latest\n$ ng version\n$ ng help\n$ ng new --help\n```\n\n# 2. Crear y ejecutar una aplicacin Angular 9\n\nUna vez que hayas instalado el CLI de manera global ya puedes empezar a usarlo en tu directorio de trabajo. El primer comando ser `ng new` que te va a **generar toda una aplicacin funcional** y las configuraciones necesarias para su depuracin, pruebas y ejecucin.\n\nComo novedad, en las ltimas versiones, el CLI te preguntar por algunas opciones para crear tu aplicacin. Eso es porque no todos los desarrollos son iguales. Se puede configurar el tipo, el estilo y muchas ms cosas, tanto de forma interactiva como mediante opciones en lnea de comandos.\n\nLo ms habitual es usar la configuracin que viene por defecto, pero tambin se pueden crear soluciones a medida. Te muestro unos ejemplos para que pruebes y te familiarices con la herramienta. Para ms informacin mira la documentacin del comando [ng new](https://angular.io/cli/new).\n\n## 2.1 Bsica\n\n```console\nng new unaAppMuyCorriente\ncd unaAppMuyCorriente\nnpm start\n```\n\n## 2.2 Minimalista\n\n```console\nng new minimalista -s -S -t\ncd minimalista\nnpm start\n```\n\n## 2.3 Profesional\n\n```console\nng new profesional -p acme --routing true\ncd profesional\nnpm start\n```\n\n## 2.4 Empresarial\n\n```console\nng new empresarial --create-application false\ncd empresarial\nng generate application compras -p acme --routing true\nnpm start\n```\n\nUna vez finalizada la instalacin de todas las libreras necesarias puedes bajar a la carpeta recin creada y ejecutar el comando standard de _npm_ para el arranque de cualquier aplicacin: `npm start`. Si todo va bien, en unos segundo podrs visitar [http://localhost:4000](http://localhost:4000) para ver en marcha la aplicacin. Lo veremos con ms detalle en el apartado de configuracin.\n\n> ejemplo: La aplicacin que sirve de ejemplo a este tutorial fue creada con este comando:\n\n```console\nng new angular-basic -p ab --style css --routing\n```\n\n# 3. Estructura de una aplicacin Angular\n\nUna vez generada y comprobada la ejecucin, toca estudiar cmo es la estructura de la aplicacin. Para ello revisa carpeta a carpeta. Las malas noticias son que hay **una enorme cantidad de ficheros y carpetas**, las buenas son que como vers, casi todo es **configuracin e infraestructura**.\n\n## 3.1 Visual Studio Code\n\nPara ver y editar los ficheros te vale cualquier editor de cdigo, pero yo uso y te recomiendo [VSCode](https://code.visualstudio.com/). Es un **gran editor, gratuito y multiplataforma**. Viene con un terminal integrado y puedes mejorarlo instalando extensiones desde una galera del propio editor.\n\nTe recomiendo instalar un paquete de extensiones ya configurado y preparado para el desarrollo de aplicaciones con _Angular_, se llama [Angular Essentials](https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials). Con eso y el [Material Icon Theme](https://marketplace.visualstudio.com/items?itemName=PKief.material-icon-theme) vers _Angular en colores_.\n\n## 3.2 Carpetas y Ficheros principales\n\nVolviendo a la **estructura de ficheros y carpetas** te encontrars con muchos archivos de distintos tipos. Si eres completamente nuevo en Angular, te llamar la atencin las extensiones `.ts`. Son para ficheros [_TypeScript_](https://www.typescriptlang.org/), una evolucin del _JavaScript_ con facilidades para el programador. Por ahora slo tienes que familiarizarte con estos:\n\n- **angular.json** _: configuracin del propio CLI. La madre de todos los configuradores_\n- **package.json** _: dependencias de libreras y scripts_\n- **src/** _: la carpeta donde estn los archivos fuentes_\n  - **index.html** _: un fichero HTML ndice estndar_\n  - **main.ts** _: fichero TypeScript de arranque de la aplicacin_\n  - **app/** _: la carpeta con el cdigo especfico de tu aplicacin_\n    - **app.module.ts** _: la aplicacin es un rbol de mdulos, y este es su raz_\n    - **app.component.ts** _: la pgina es un rbol de componentes, y este es su raz_\n    - **app.component.html** _: tiene una parte visual, esta es su vista_\n\nEcha un vistazo a estos ficheros, pronto los modificaremos para sentirnos programadores.\n\n# 4. Edicin\n\nAngular CLI instala y configura un conjunto de herramientas que te harn la vida ms fcil. Entre otras, destaca la capacidad de **recargar la aplicacin en caliente** en cuanto guardas tu trabajo como programador. En esta ltima versin, la 9, se ha mejorado el proceso y es realmente rpido.\n\nPara probarlo slo tienes que dejar arrancada la aplicacin con el comando `npm start`; **cambiar un fichero de cdigo y comprobar el resultado** en el navegador. Te propongo empezar como en cualquier otro lenguaje; por el famoso _hola mundo_.\n\n## 4.1 Hola Mundo\n\nAbre el fichero `app.component.ts` y busca dentro de l una clase llamada `AppComponent`. Encontrars que tiene una propiedad `title`. Asgnale el saludo de rigor: `title = 'angular - basic: hello world ;-)';`. Guarda y comprueba cmo tu navegador **se habr actualizado automticamente**.\n\nToda **esta magia depende de una cadena de comandos** que lanzan distintas herramientas previamente instaladas y configuradas por el CLI. Entre ellas cabe mencionar a [_WebPack_](https://webpack.github.io/), un coloso que afortunadamente viene instalado y preparado para funcionar de manera transparente.\n\n## 4.2 npm start\n\nEsta es una lista no exhaustiva de lo que sucede.\n\n1. npm start\n2. ng serve\n3. webpack server en http://localhost:4200\n   1. vigilancia de cambios sobre la carpeta src/\n   2. live reload\n   3. compilado de la aplicacin\n   4. recarga del navegador\n\nCambia a tu antojo el `app.component.ts` o su hermano `app.component.html` y comprueba los cambios de manera inmediata en tu navegador.\n\n# 5. Configuracin\n\nEl CLI 9 viene con pilas incluidas, se puede usar desde el primer momento. Slo quedan pequeas mejoras que hacer. Por ejemplo ajustar el `package.json` y agregar libreras de terceros.\n\n## 5.1 Package.json\n\nEl `package.json` es el fichero estndar de _npm_ donde se almacenan las **dependencias de terceros**. Contiene las libreras que necesita la aplicacin para ejecutarse, por ejemplo todas las de _Angular 9_. Y tambin las herramientas que necesita el programador, por ejemplo el propio _AngularCLI_;\n\n```json\n{\n  \"dependencies\": {\n    \"@angular/core\": \"~9.1.1\"\n  },\n  \"devDependencies\": {\n    \"@angular/cli\": \"~9.1.1\"\n  }\n}\n```\n\nOtro uso del `package.json` es servir de **contenedor de scripts** para automatizar tareas de operaciones rutinarias. Por ejemplo, el comando estndar `npm start` ejecutar el contenido asignado en el fichero _json_, originalmente `ng serve`. Esto lanza el servidor de pruebas con sus opciones por defecto.\n\nPero el **comando [ng serve](https://angular.io/cli/serve)** admite muchas configuraciones. Te propongo que uses esta para activar un modo de compilacin ms rpido y seguro, y para que se abra el navegador de forma automtica en cuanto lances el servidor. Y adems te recomiendo que uses un puerto especfico para cada aplicacin.\n\nOtras configuraciones en produccin\n\n```json\n{\n  \"start\": \"ng serve -o --port 4290\"\n}\n```\n\n## 5.2 Estilos y libreras de terceros\n\nLas libreras que vienen de fbrica tienen todo lo necesario para crear aplicaciones. Pero raro es el caso en que no necesitemos **algn que otro producto de terceros**. Ya sean utilidades como _[date-fns](https://date-fns.org/)_, libreras grficas como _[chart.js](http://www.chartjs.org/)_ o la aplicacin de estilos y componentes visuales de _frameworks como Bootstrap o MaterialDesign_. Pero todos se instalan de igual forma. Descargndolos con _npm_ y adjuntndolos en el `angular.json`.\n\nEstas colecciones de archivos los usa el _cli_ a travs de _webpack_ para incluirlos **minificados y concatenados en un fichero _bundle_ sustituyendo a las clsicas etiquetas html**.Todo, el html y sus estilos, se construir en el cliente a partir de instrucciones JavaScript. De esta forma el fichero `index.html` apenas tendrs que tocarlo, salvo para algunas etiquetas de meta informacin.\n\n```html\n<meta name=\"description\" content=\"A sample project for learning Angular ;-)\" />\n<meta name=\"keywords\" content=\"Angular Sample Tutorial Ejemplo\" />\n<meta name=\"author\" content=\"Alberto Basalo\" />\n```\n\n## 5.3 Environments\n\nLa carpeta `environments/` contiene dos ficheros, y puede contener ms, para cada entorno de distribucin necesario. En cdigo siempre importaremos el fichero base, pero durante la compilacin el CLI lo sustituir por el adecuado.\n\n```typescript\ntitle = environment.appName + 'hello world ;-)';\n```\n\n## 5.4 Assets\n\nLos ficheros de la carpeta `assets/` se copian tal cual al despliegue. Es un buen lugar para logos, imgenes y ficheros de datos estticos.\n\nPor ejemplo, en el `app.component.html` he sustituido la imagen incrustada del Angular con un logo propio.\n\n```html\n<img width=\"100\" src=\"./assets/logo.png\" />\n```\n\n# 6. Angular 9, el CLI 9 y su ecosistema\n\nAlgunos consejos y herramientas tiles que rodean al mundo Angular.\n\nPero si la lnea de comandos te suena muy antigua y lo tuyo son las interfaces grficas, ests de suerte. El reciente proyecto [Angular Console](https://angularconsole.com/) te permite generar y ejecutar comandos desde una cmoda interfaz grfica.\n\nUna mejora digna de mencin es la capacidad de presupuestar tamaos de los ficheros generados. De esa forma podemos controlar el peso y tiempo de descarga de la aplicacin.\n\nPara garantizar la limpieza del cdigo conviene usar herramientas como [Prettier](https://prettier.io/) y configurarlas para su compatibilidad con Angular.\n\nLos ltimos toques antes de publicar pueden incluir el _script de analytics_ en el `index.html` y ajustes de retro-compatibilidad en el fichero `polyfills.ts`.\n\nLuego un comando y listo para publicar en _github pages_. `ng add angular-cli-ghpages`.\n\n> Te recomiendo que te familiarices y uses mucho estos _scripts_ en el `package.json` para poder lanzarlos ms tarde.\n\n```json\n{\n   \"scripts\": {\n    \"ng\": \"ng\",\n    \"start\": \"ng serve -o --port 4290\",\n    \"start:prod\": \"npm run build:prod && npm run http-server\",\n    \"build\": \"ng build\",\n    \"build:prod\": \"ng build --prod\",\n    \"deploy\": \"ng deploy --baseHref=/angular-basic/\",\n    \"test\": \"ng test\",\n    \"lint\": \"ng lint\",\n    \"e2e\": \"ng e2e\"\n  },\n}\n```\n\nComprueba las ejecuciones de los distintos _scripts_. Con `npm start` no se generan ficheros fsicos. Todos es en memoria para mayor velocidad de re-compilacin mientras desarrollas. En cambio `npm run build:prod` crear una carpeta `./dist/angular-basic` en la que dejar los archivos necesarios para ejecucin. Por ltimo `npm run deploy` los prepara para enviar compilados a un rama estndar de publicacin listos para desplegarse en las [_github pages_](https://pages.github.com/).\n\nOtros enlaces de inters sobre el ecosistema Angular.\n\n- [Extensiones Esenciales](https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials)\n- [Prettier](https://prettier.io/)\n- [TsLint-Prettier](https://github.com/prettier/tslint-config-prettier)\n- [Angular Console](https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console)\n- [Angular Material](https://material.angular.io/)\n- [Bootstrap](https://ng-bootstrap.github.io/#/home)\n- [Augury](https://augury.rangle.io/)\n- [Apollo GraphQL](https://www.apollographql.com/docs/)\n- [Ionic](https://ionicframework.com/)\n- [Angular Console](https://angularconsole.com/)\n\nPara complementar tu conocimiento te recomiendo la [documentacin de Angular/CLI](https://angular.io/cli) y este artculo avanzado que trata la configuracin del CLI en profundidad [Angular CLI under the hood](https://medium.com/dailyjs/angular-cli-6-under-the-hood-builders-demystified-f0690ebcf01)\n\nEsto es slo el principio, _Angular CLI 9_ puede hacer mucho ms por ti; descbrelo en esta serie tutorial para aprender a programar con Angular 9. En el prximo artculo crearemos una [Base para una aplicacin Angular](../base-aplicacion-angular/). Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"hola-angular-cli","published":1,"updated":"2020-04-13T09:19:05.228Z","_id":"ck70mab1z0010bss313urhf08","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-0_cli.png\" alt=\"hola-angular-cli\"></p><p><strong>Angular en su versin 9 es la plataforma perfecta para el desarrollo</strong> profesional de aplicaciones modernas. <strong>El Angular CLI es la herramienta</strong> adecuada para generar aplicaciones Angular. Juntos son imbatibles en cuanto a velocidad en desarrollo y a potencia en ejecucin.</p><a id=\"more\"></a><p>El comnmente conocido como <strong>AngularCLI</strong> o <em>angular cli</em> o <em>angular-cli</em> o <em>CLI a secas</em> es la herramienta de lnea de comandos estndar para <strong>crear, depurar y publicar aplicaciones Angular</strong>. En su actual <strong>versin 9</strong> es ms potente y verstil que nunca y es muy sencillo dominar los aspectos bsicos.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Instalacion-de-Angular-CLI-9\"><a href=\"#1-Instalacion-de-Angular-CLI-9\" class=\"headerlink\" title=\"1. Instalacin de Angular CLI 9\"></a>1. Instalacin de Angular CLI 9</h1><p>Angular es una plataforma de desarrollo dogmtica y llave en mano. Para empezar, como en casi cualquier desarrollo <strong>necesitars <a href=\"https://nodejs.org/en/\" target=\"_blank\" rel=\"noopener\">NodeJS</a> y su manejador de de paquetes <em>npm</em></strong>. Tenerlos actualizados es un mandamiento bsico para un desarrollador web. Comprueba tu versin con el siguiente comando:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br></pre></td></tr></table></figure><p>Empieza con una <strong>instalacin global</strong> que te permita usar la herramienta desde cualquier directorio. Comprueba la versin instalada y accede a la ayuda en lnea. La ayuda est disponible tanto de modo general como para cada comando que vayas a usar.</p><p>Instrucciones para instalar Angular CLI.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> npm i -g @angular/cli@latest</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng version</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng <span class=\"built_in\">help</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng new --<span class=\"built_in\">help</span></span></span><br></pre></td></tr></table></figure><h1 id=\"2-Crear-y-ejecutar-una-aplicacion-Angular-9\"><a href=\"#2-Crear-y-ejecutar-una-aplicacion-Angular-9\" class=\"headerlink\" title=\"2. Crear y ejecutar una aplicacin Angular 9\"></a>2. Crear y ejecutar una aplicacin Angular 9</h1><p>Una vez que hayas instalado el CLI de manera global ya puedes empezar a usarlo en tu directorio de trabajo. El primer comando ser <code>ng new</code> que te va a <strong>generar toda una aplicacin funcional</strong> y las configuraciones necesarias para su depuracin, pruebas y ejecucin.</p><p>Como novedad, en las ltimas versiones, el CLI te preguntar por algunas opciones para crear tu aplicacin. Eso es porque no todos los desarrollos son iguales. Se puede configurar el tipo, el estilo y muchas ms cosas, tanto de forma interactiva como mediante opciones en lnea de comandos.</p><p>Lo ms habitual es usar la configuracin que viene por defecto, pero tambin se pueden crear soluciones a medida. Te muestro unos ejemplos para que pruebes y te familiarices con la herramienta. Para ms informacin mira la documentacin del comando <a href=\"https://angular.io/cli/new\" target=\"_blank\" rel=\"noopener\">ng new</a>.</p><h2 id=\"2-1-Basica\"><a href=\"#2-1-Basica\" class=\"headerlink\" title=\"2.1 Bsica\"></a>2.1 Bsica</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new unaAppMuyCorriente</span><br><span class=\"line\">cd unaAppMuyCorriente</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Minimalista\"><a href=\"#2-2-Minimalista\" class=\"headerlink\" title=\"2.2 Minimalista\"></a>2.2 Minimalista</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new minimalista -s -S -t</span><br><span class=\"line\">cd minimalista</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Profesional\"><a href=\"#2-3-Profesional\" class=\"headerlink\" title=\"2.3 Profesional\"></a>2.3 Profesional</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new profesional -p acme --routing true</span><br><span class=\"line\">cd profesional</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-4-Empresarial\"><a href=\"#2-4-Empresarial\" class=\"headerlink\" title=\"2.4 Empresarial\"></a>2.4 Empresarial</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new empresarial --create-application false</span><br><span class=\"line\">cd empresarial</span><br><span class=\"line\">ng generate application compras -p acme --routing true</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><p>Una vez finalizada la instalacin de todas las libreras necesarias puedes bajar a la carpeta recin creada y ejecutar el comando standard de <em>npm</em> para el arranque de cualquier aplicacin: <code>npm start</code>. Si todo va bien, en unos segundo podrs visitar <a href=\"http://localhost:4000\" target=\"_blank\" rel=\"noopener\">http://localhost:4000</a> para ver en marcha la aplicacin. Lo veremos con ms detalle en el apartado de configuracin.</p><blockquote><p>ejemplo: La aplicacin que sirve de ejemplo a este tutorial fue creada con este comando:</p></blockquote><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new angular-basic -p ab --style css --routing</span><br></pre></td></tr></table></figure><h1 id=\"3-Estructura-de-una-aplicacion-Angular\"><a href=\"#3-Estructura-de-una-aplicacion-Angular\" class=\"headerlink\" title=\"3. Estructura de una aplicacin Angular\"></a>3. Estructura de una aplicacin Angular</h1><p>Una vez generada y comprobada la ejecucin, toca estudiar cmo es la estructura de la aplicacin. Para ello revisa carpeta a carpeta. Las malas noticias son que hay <strong>una enorme cantidad de ficheros y carpetas</strong>, las buenas son que como vers, casi todo es <strong>configuracin e infraestructura</strong>.</p><h2 id=\"3-1-Visual-Studio-Code\"><a href=\"#3-1-Visual-Studio-Code\" class=\"headerlink\" title=\"3.1 Visual Studio Code\"></a>3.1 Visual Studio Code</h2><p>Para ver y editar los ficheros te vale cualquier editor de cdigo, pero yo uso y te recomiendo <a href=\"https://code.visualstudio.com/\" target=\"_blank\" rel=\"noopener\">VSCode</a>. Es un <strong>gran editor, gratuito y multiplataforma</strong>. Viene con un terminal integrado y puedes mejorarlo instalando extensiones desde una galera del propio editor.</p><p>Te recomiendo instalar un paquete de extensiones ya configurado y preparado para el desarrollo de aplicaciones con <em>Angular</em>, se llama <a href=\"https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials\" target=\"_blank\" rel=\"noopener\">Angular Essentials</a>. Con eso y el <a href=\"https://marketplace.visualstudio.com/items?itemName=PKief.material-icon-theme\" target=\"_blank\" rel=\"noopener\">Material Icon Theme</a> vers <em>Angular en colores</em>.</p><h2 id=\"3-2-Carpetas-y-Ficheros-principales\"><a href=\"#3-2-Carpetas-y-Ficheros-principales\" class=\"headerlink\" title=\"3.2 Carpetas y Ficheros principales\"></a>3.2 Carpetas y Ficheros principales</h2><p>Volviendo a la <strong>estructura de ficheros y carpetas</strong> te encontrars con muchos archivos de distintos tipos. Si eres completamente nuevo en Angular, te llamar la atencin las extensiones <code>.ts</code>. Son para ficheros <a href=\"https://www.typescriptlang.org/\" target=\"_blank\" rel=\"noopener\"><em>TypeScript</em></a>, una evolucin del <em>JavaScript</em> con facilidades para el programador. Por ahora slo tienes que familiarizarte con estos:</p><ul><li><strong>angular.json</strong> <em>: configuracin del propio CLI. La madre de todos los configuradores</em></li><li><strong>package.json</strong> <em>: dependencias de libreras y scripts</em></li><li><strong>src/</strong> <em>: la carpeta donde estn los archivos fuentes</em><ul><li><strong>index.html</strong> <em>: un fichero HTML ndice estndar</em></li><li><strong>main.ts</strong> <em>: fichero TypeScript de arranque de la aplicacin</em></li><li><strong>app/</strong> <em>: la carpeta con el cdigo especfico de tu aplicacin</em><ul><li><strong>app.module.ts</strong> <em>: la aplicacin es un rbol de mdulos, y este es su raz</em></li><li><strong>app.component.ts</strong> <em>: la pgina es un rbol de componentes, y este es su raz</em></li><li><strong>app.component.html</strong> <em>: tiene una parte visual, esta es su vista</em></li></ul></li></ul></li></ul><p>Echa un vistazo a estos ficheros, pronto los modificaremos para sentirnos programadores.</p><h1 id=\"4-Edicion\"><a href=\"#4-Edicion\" class=\"headerlink\" title=\"4. Edicin\"></a>4. Edicin</h1><p>Angular CLI instala y configura un conjunto de herramientas que te harn la vida ms fcil. Entre otras, destaca la capacidad de <strong>recargar la aplicacin en caliente</strong> en cuanto guardas tu trabajo como programador. En esta ltima versin, la 9, se ha mejorado el proceso y es realmente rpido.</p><p>Para probarlo slo tienes que dejar arrancada la aplicacin con el comando <code>npm start</code>; <strong>cambiar un fichero de cdigo y comprobar el resultado</strong> en el navegador. Te propongo empezar como en cualquier otro lenguaje; por el famoso <em>hola mundo</em>.</p><h2 id=\"4-1-Hola-Mundo\"><a href=\"#4-1-Hola-Mundo\" class=\"headerlink\" title=\"4.1 Hola Mundo\"></a>4.1 Hola Mundo</h2><p>Abre el fichero <code>app.component.ts</code> y busca dentro de l una clase llamada <code>AppComponent</code>. Encontrars que tiene una propiedad <code>title</code>. Asgnale el saludo de rigor: <code>title = &#39;angular - basic: hello world ;-)&#39;;</code>. Guarda y comprueba cmo tu navegador <strong>se habr actualizado automticamente</strong>.</p><p>Toda <strong>esta magia depende de una cadena de comandos</strong> que lanzan distintas herramientas previamente instaladas y configuradas por el CLI. Entre ellas cabe mencionar a <a href=\"https://webpack.github.io/\" target=\"_blank\" rel=\"noopener\"><em>WebPack</em></a>, un coloso que afortunadamente viene instalado y preparado para funcionar de manera transparente.</p><h2 id=\"4-2-npm-start\"><a href=\"#4-2-npm-start\" class=\"headerlink\" title=\"4.2 npm start\"></a>4.2 npm start</h2><p>Esta es una lista no exhaustiva de lo que sucede.</p><ol><li>npm start</li><li>ng serve</li><li>webpack server en <a href=\"http://localhost:4200\" target=\"_blank\" rel=\"noopener\">http://localhost:4200</a><ol><li>vigilancia de cambios sobre la carpeta src/</li><li>live reload</li><li>compilado de la aplicacin</li><li>recarga del navegador</li></ol></li></ol><p>Cambia a tu antojo el <code>app.component.ts</code> o su hermano <code>app.component.html</code> y comprueba los cambios de manera inmediata en tu navegador.</p><h1 id=\"5-Configuracion\"><a href=\"#5-Configuracion\" class=\"headerlink\" title=\"5. Configuracin\"></a>5. Configuracin</h1><p>El CLI 9 viene con pilas incluidas, se puede usar desde el primer momento. Slo quedan pequeas mejoras que hacer. Por ejemplo ajustar el <code>package.json</code> y agregar libreras de terceros.</p><h2 id=\"5-1-Package-json\"><a href=\"#5-1-Package-json\" class=\"headerlink\" title=\"5.1 Package.json\"></a>5.1 Package.json</h2><p>El <code>package.json</code> es el fichero estndar de <em>npm</em> donde se almacenan las <strong>dependencias de terceros</strong>. Contiene las libreras que necesita la aplicacin para ejecutarse, por ejemplo todas las de <em>Angular 9</em>. Y tambin las herramientas que necesita el programador, por ejemplo el propio <em>AngularCLI</em>;</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"dependencies\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"@angular/core\"</span>: <span class=\"string\">\"~9.1.1\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"devDependencies\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"@angular/cli\"</span>: <span class=\"string\">\"~9.1.1\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Otro uso del <code>package.json</code> es servir de <strong>contenedor de scripts</strong> para automatizar tareas de operaciones rutinarias. Por ejemplo, el comando estndar <code>npm start</code> ejecutar el contenido asignado en el fichero <em>json</em>, originalmente <code>ng serve</code>. Esto lanza el servidor de pruebas con sus opciones por defecto.</p><p>Pero el <strong>comando <a href=\"https://angular.io/cli/serve\" target=\"_blank\" rel=\"noopener\">ng serve</a></strong> admite muchas configuraciones. Te propongo que uses esta para activar un modo de compilacin ms rpido y seguro, y para que se abra el navegador de forma automtica en cuanto lances el servidor. Y adems te recomiendo que uses un puerto especfico para cada aplicacin.</p><p>Otras configuraciones en produccin</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"start\"</span>: <span class=\"string\">\"ng serve -o --port 4290\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"5-2-Estilos-y-librerias-de-terceros\"><a href=\"#5-2-Estilos-y-librerias-de-terceros\" class=\"headerlink\" title=\"5.2 Estilos y libreras de terceros\"></a>5.2 Estilos y libreras de terceros</h2><p>Las libreras que vienen de fbrica tienen todo lo necesario para crear aplicaciones. Pero raro es el caso en que no necesitemos <strong>algn que otro producto de terceros</strong>. Ya sean utilidades como <em><a href=\"https://date-fns.org/\" target=\"_blank\" rel=\"noopener\">date-fns</a></em>, libreras grficas como <em><a href=\"http://www.chartjs.org/\" target=\"_blank\" rel=\"noopener\">chart.js</a></em> o la aplicacin de estilos y componentes visuales de <em>frameworks como Bootstrap o MaterialDesign</em>. Pero todos se instalan de igual forma. Descargndolos con <em>npm</em> y adjuntndolos en el <code>angular.json</code>.</p><p>Estas colecciones de archivos los usa el <em>cli</em> a travs de <em>webpack</em> para incluirlos <strong>minificados y concatenados en un fichero <em>bundle</em> sustituyendo a las clsicas etiquetas html</strong>.Todo, el html y sus estilos, se construir en el cliente a partir de instrucciones JavaScript. De esta forma el fichero <code>index.html</code> apenas tendrs que tocarlo, salvo para algunas etiquetas de meta informacin.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"description\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"A sample project for learning Angular ;-)\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"keywords\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"Angular Sample Tutorial Ejemplo\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"author\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"Alberto Basalo\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"5-3-Environments\"><a href=\"#5-3-Environments\" class=\"headerlink\" title=\"5.3 Environments\"></a>5.3 Environments</h2><p>La carpeta <code>environments/</code> contiene dos ficheros, y puede contener ms, para cada entorno de distribucin necesario. En cdigo siempre importaremos el fichero base, pero durante la compilacin el CLI lo sustituir por el adecuado.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title = environment.appName + <span class=\"string\">'hello world ;-)'</span>;</span><br></pre></td></tr></table></figure><h2 id=\"5-4-Assets\"><a href=\"#5-4-Assets\" class=\"headerlink\" title=\"5.4 Assets\"></a>5.4 Assets</h2><p>Los ficheros de la carpeta <code>assets/</code> se copian tal cual al despliegue. Es un buen lugar para logos, imgenes y ficheros de datos estticos.</p><p>Por ejemplo, en el <code>app.component.html</code> he sustituido la imagen incrustada del Angular con un logo propio.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">width</span>=<span class=\"string\">\"100\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./assets/logo.png\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"6-Angular-9-el-CLI-9-y-su-ecosistema\"><a href=\"#6-Angular-9-el-CLI-9-y-su-ecosistema\" class=\"headerlink\" title=\"6. Angular 9, el CLI 9 y su ecosistema\"></a>6. Angular 9, el CLI 9 y su ecosistema</h1><p>Algunos consejos y herramientas tiles que rodean al mundo Angular.</p><p>Pero si la lnea de comandos te suena muy antigua y lo tuyo son las interfaces grficas, ests de suerte. El reciente proyecto <a href=\"https://angularconsole.com/\" target=\"_blank\" rel=\"noopener\">Angular Console</a> te permite generar y ejecutar comandos desde una cmoda interfaz grfica.</p><p>Una mejora digna de mencin es la capacidad de presupuestar tamaos de los ficheros generados. De esa forma podemos controlar el peso y tiempo de descarga de la aplicacin.</p><p>Para garantizar la limpieza del cdigo conviene usar herramientas como <a href=\"https://prettier.io/\" target=\"_blank\" rel=\"noopener\">Prettier</a> y configurarlas para su compatibilidad con Angular.</p><p>Los ltimos toques antes de publicar pueden incluir el <em>script de analytics</em> en el <code>index.html</code> y ajustes de retro-compatibilidad en el fichero <code>polyfills.ts</code>.</p><p>Luego un comando y listo para publicar en <em>github pages</em>. <code>ng add angular-cli-ghpages</code>.</p><blockquote><p>Te recomiendo que te familiarices y uses mucho estos <em>scripts</em> en el <code>package.json</code> para poder lanzarlos ms tarde.</p></blockquote><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">   <span class=\"attr\">\"scripts\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"ng\"</span>: <span class=\"string\">\"ng\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"start\"</span>: <span class=\"string\">\"ng serve -o --port 4290\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"start:prod\"</span>: <span class=\"string\">\"npm run build:prod &amp;&amp; npm run http-server\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"build\"</span>: <span class=\"string\">\"ng build\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"build:prod\"</span>: <span class=\"string\">\"ng build --prod\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"deploy\"</span>: <span class=\"string\">\"ng deploy --baseHref=/angular-basic/\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"test\"</span>: <span class=\"string\">\"ng test\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"lint\"</span>: <span class=\"string\">\"ng lint\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"e2e\"</span>: <span class=\"string\">\"ng e2e\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Comprueba las ejecuciones de los distintos <em>scripts</em>. Con <code>npm start</code> no se generan ficheros fsicos. Todos es en memoria para mayor velocidad de re-compilacin mientras desarrollas. En cambio <code>npm run build:prod</code> crear una carpeta <code>./dist/angular-basic</code> en la que dejar los archivos necesarios para ejecucin. Por ltimo <code>npm run deploy</code> los prepara para enviar compilados a un rama estndar de publicacin listos para desplegarse en las <a href=\"https://pages.github.com/\" target=\"_blank\" rel=\"noopener\"><em>github pages</em></a>.</p><p>Otros enlaces de inters sobre el ecosistema Angular.</p><ul><li><a href=\"https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials\" target=\"_blank\" rel=\"noopener\">Extensiones Esenciales</a></li><li><a href=\"https://prettier.io/\" target=\"_blank\" rel=\"noopener\">Prettier</a></li><li><a href=\"https://github.com/prettier/tslint-config-prettier\" target=\"_blank\" rel=\"noopener\">TsLint-Prettier</a></li><li><a href=\"https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console\" target=\"_blank\" rel=\"noopener\">Angular Console</a></li><li><a href=\"https://material.angular.io/\" target=\"_blank\" rel=\"noopener\">Angular Material</a></li><li><a href=\"https://ng-bootstrap.github.io/#/home\" target=\"_blank\" rel=\"noopener\">Bootstrap</a></li><li><a href=\"https://augury.rangle.io/\" target=\"_blank\" rel=\"noopener\">Augury</a></li><li><a href=\"https://www.apollographql.com/docs/\" target=\"_blank\" rel=\"noopener\">Apollo GraphQL</a></li><li><a href=\"https://ionicframework.com/\" target=\"_blank\" rel=\"noopener\">Ionic</a></li><li><a href=\"https://angularconsole.com/\" target=\"_blank\" rel=\"noopener\">Angular Console</a></li></ul><p>Para complementar tu conocimiento te recomiendo la <a href=\"https://angular.io/cli\" target=\"_blank\" rel=\"noopener\">documentacin de Angular/CLI</a> y este artculo avanzado que trata la configuracin del CLI en profundidad <a href=\"https://medium.com/dailyjs/angular-cli-6-under-the-hood-builders-demystified-f0690ebcf01\" target=\"_blank\" rel=\"noopener\">Angular CLI under the hood</a></p><p>Esto es slo el principio, <em>Angular CLI 9</em> puede hacer mucho ms por ti; descbrelo en esta serie tutorial para aprender a programar con Angular 9. En el prximo artculo crearemos una <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a>. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-0_cli.png\" alt=\"hola-angular-cli\"></p><p><strong>Angular en su versin 9 es la plataforma perfecta para el desarrollo</strong> profesional de aplicaciones modernas. <strong>El Angular CLI es la herramienta</strong> adecuada para generar aplicaciones Angular. Juntos son imbatibles en cuanto a velocidad en desarrollo y a potencia en ejecucin.</p>","more":"<p>El comnmente conocido como <strong>AngularCLI</strong> o <em>angular cli</em> o <em>angular-cli</em> o <em>CLI a secas</em> es la herramienta de lnea de comandos estndar para <strong>crear, depurar y publicar aplicaciones Angular</strong>. En su actual <strong>versin 9</strong> es ms potente y verstil que nunca y es muy sencillo dominar los aspectos bsicos.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Instalacion-de-Angular-CLI-9\"><a href=\"#1-Instalacion-de-Angular-CLI-9\" class=\"headerlink\" title=\"1. Instalacin de Angular CLI 9\"></a>1. Instalacin de Angular CLI 9</h1><p>Angular es una plataforma de desarrollo dogmtica y llave en mano. Para empezar, como en casi cualquier desarrollo <strong>necesitars <a href=\"https://nodejs.org/en/\" target=\"_blank\" rel=\"noopener\">NodeJS</a> y su manejador de de paquetes <em>npm</em></strong>. Tenerlos actualizados es un mandamiento bsico para un desarrollador web. Comprueba tu versin con el siguiente comando:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br></pre></td></tr></table></figure><p>Empieza con una <strong>instalacin global</strong> que te permita usar la herramienta desde cualquier directorio. Comprueba la versin instalada y accede a la ayuda en lnea. La ayuda est disponible tanto de modo general como para cada comando que vayas a usar.</p><p>Instrucciones para instalar Angular CLI.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> npm i -g @angular/cli@latest</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng version</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng <span class=\"built_in\">help</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng new --<span class=\"built_in\">help</span></span></span><br></pre></td></tr></table></figure><h1 id=\"2-Crear-y-ejecutar-una-aplicacion-Angular-9\"><a href=\"#2-Crear-y-ejecutar-una-aplicacion-Angular-9\" class=\"headerlink\" title=\"2. Crear y ejecutar una aplicacin Angular 9\"></a>2. Crear y ejecutar una aplicacin Angular 9</h1><p>Una vez que hayas instalado el CLI de manera global ya puedes empezar a usarlo en tu directorio de trabajo. El primer comando ser <code>ng new</code> que te va a <strong>generar toda una aplicacin funcional</strong> y las configuraciones necesarias para su depuracin, pruebas y ejecucin.</p><p>Como novedad, en las ltimas versiones, el CLI te preguntar por algunas opciones para crear tu aplicacin. Eso es porque no todos los desarrollos son iguales. Se puede configurar el tipo, el estilo y muchas ms cosas, tanto de forma interactiva como mediante opciones en lnea de comandos.</p><p>Lo ms habitual es usar la configuracin que viene por defecto, pero tambin se pueden crear soluciones a medida. Te muestro unos ejemplos para que pruebes y te familiarices con la herramienta. Para ms informacin mira la documentacin del comando <a href=\"https://angular.io/cli/new\" target=\"_blank\" rel=\"noopener\">ng new</a>.</p><h2 id=\"2-1-Basica\"><a href=\"#2-1-Basica\" class=\"headerlink\" title=\"2.1 Bsica\"></a>2.1 Bsica</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new unaAppMuyCorriente</span><br><span class=\"line\">cd unaAppMuyCorriente</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Minimalista\"><a href=\"#2-2-Minimalista\" class=\"headerlink\" title=\"2.2 Minimalista\"></a>2.2 Minimalista</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new minimalista -s -S -t</span><br><span class=\"line\">cd minimalista</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Profesional\"><a href=\"#2-3-Profesional\" class=\"headerlink\" title=\"2.3 Profesional\"></a>2.3 Profesional</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new profesional -p acme --routing true</span><br><span class=\"line\">cd profesional</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-4-Empresarial\"><a href=\"#2-4-Empresarial\" class=\"headerlink\" title=\"2.4 Empresarial\"></a>2.4 Empresarial</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new empresarial --create-application false</span><br><span class=\"line\">cd empresarial</span><br><span class=\"line\">ng generate application compras -p acme --routing true</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><p>Una vez finalizada la instalacin de todas las libreras necesarias puedes bajar a la carpeta recin creada y ejecutar el comando standard de <em>npm</em> para el arranque de cualquier aplicacin: <code>npm start</code>. Si todo va bien, en unos segundo podrs visitar <a href=\"http://localhost:4000\" target=\"_blank\" rel=\"noopener\">http://localhost:4000</a> para ver en marcha la aplicacin. Lo veremos con ms detalle en el apartado de configuracin.</p><blockquote><p>ejemplo: La aplicacin que sirve de ejemplo a este tutorial fue creada con este comando:</p></blockquote><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new angular-basic -p ab --style css --routing</span><br></pre></td></tr></table></figure><h1 id=\"3-Estructura-de-una-aplicacion-Angular\"><a href=\"#3-Estructura-de-una-aplicacion-Angular\" class=\"headerlink\" title=\"3. Estructura de una aplicacin Angular\"></a>3. Estructura de una aplicacin Angular</h1><p>Una vez generada y comprobada la ejecucin, toca estudiar cmo es la estructura de la aplicacin. Para ello revisa carpeta a carpeta. Las malas noticias son que hay <strong>una enorme cantidad de ficheros y carpetas</strong>, las buenas son que como vers, casi todo es <strong>configuracin e infraestructura</strong>.</p><h2 id=\"3-1-Visual-Studio-Code\"><a href=\"#3-1-Visual-Studio-Code\" class=\"headerlink\" title=\"3.1 Visual Studio Code\"></a>3.1 Visual Studio Code</h2><p>Para ver y editar los ficheros te vale cualquier editor de cdigo, pero yo uso y te recomiendo <a href=\"https://code.visualstudio.com/\" target=\"_blank\" rel=\"noopener\">VSCode</a>. Es un <strong>gran editor, gratuito y multiplataforma</strong>. Viene con un terminal integrado y puedes mejorarlo instalando extensiones desde una galera del propio editor.</p><p>Te recomiendo instalar un paquete de extensiones ya configurado y preparado para el desarrollo de aplicaciones con <em>Angular</em>, se llama <a href=\"https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials\" target=\"_blank\" rel=\"noopener\">Angular Essentials</a>. Con eso y el <a href=\"https://marketplace.visualstudio.com/items?itemName=PKief.material-icon-theme\" target=\"_blank\" rel=\"noopener\">Material Icon Theme</a> vers <em>Angular en colores</em>.</p><h2 id=\"3-2-Carpetas-y-Ficheros-principales\"><a href=\"#3-2-Carpetas-y-Ficheros-principales\" class=\"headerlink\" title=\"3.2 Carpetas y Ficheros principales\"></a>3.2 Carpetas y Ficheros principales</h2><p>Volviendo a la <strong>estructura de ficheros y carpetas</strong> te encontrars con muchos archivos de distintos tipos. Si eres completamente nuevo en Angular, te llamar la atencin las extensiones <code>.ts</code>. Son para ficheros <a href=\"https://www.typescriptlang.org/\" target=\"_blank\" rel=\"noopener\"><em>TypeScript</em></a>, una evolucin del <em>JavaScript</em> con facilidades para el programador. Por ahora slo tienes que familiarizarte con estos:</p><ul><li><strong>angular.json</strong> <em>: configuracin del propio CLI. La madre de todos los configuradores</em></li><li><strong>package.json</strong> <em>: dependencias de libreras y scripts</em></li><li><strong>src/</strong> <em>: la carpeta donde estn los archivos fuentes</em><ul><li><strong>index.html</strong> <em>: un fichero HTML ndice estndar</em></li><li><strong>main.ts</strong> <em>: fichero TypeScript de arranque de la aplicacin</em></li><li><strong>app/</strong> <em>: la carpeta con el cdigo especfico de tu aplicacin</em><ul><li><strong>app.module.ts</strong> <em>: la aplicacin es un rbol de mdulos, y este es su raz</em></li><li><strong>app.component.ts</strong> <em>: la pgina es un rbol de componentes, y este es su raz</em></li><li><strong>app.component.html</strong> <em>: tiene una parte visual, esta es su vista</em></li></ul></li></ul></li></ul><p>Echa un vistazo a estos ficheros, pronto los modificaremos para sentirnos programadores.</p><h1 id=\"4-Edicion\"><a href=\"#4-Edicion\" class=\"headerlink\" title=\"4. Edicin\"></a>4. Edicin</h1><p>Angular CLI instala y configura un conjunto de herramientas que te harn la vida ms fcil. Entre otras, destaca la capacidad de <strong>recargar la aplicacin en caliente</strong> en cuanto guardas tu trabajo como programador. En esta ltima versin, la 9, se ha mejorado el proceso y es realmente rpido.</p><p>Para probarlo slo tienes que dejar arrancada la aplicacin con el comando <code>npm start</code>; <strong>cambiar un fichero de cdigo y comprobar el resultado</strong> en el navegador. Te propongo empezar como en cualquier otro lenguaje; por el famoso <em>hola mundo</em>.</p><h2 id=\"4-1-Hola-Mundo\"><a href=\"#4-1-Hola-Mundo\" class=\"headerlink\" title=\"4.1 Hola Mundo\"></a>4.1 Hola Mundo</h2><p>Abre el fichero <code>app.component.ts</code> y busca dentro de l una clase llamada <code>AppComponent</code>. Encontrars que tiene una propiedad <code>title</code>. Asgnale el saludo de rigor: <code>title = &#39;angular - basic: hello world ;-)&#39;;</code>. Guarda y comprueba cmo tu navegador <strong>se habr actualizado automticamente</strong>.</p><p>Toda <strong>esta magia depende de una cadena de comandos</strong> que lanzan distintas herramientas previamente instaladas y configuradas por el CLI. Entre ellas cabe mencionar a <a href=\"https://webpack.github.io/\" target=\"_blank\" rel=\"noopener\"><em>WebPack</em></a>, un coloso que afortunadamente viene instalado y preparado para funcionar de manera transparente.</p><h2 id=\"4-2-npm-start\"><a href=\"#4-2-npm-start\" class=\"headerlink\" title=\"4.2 npm start\"></a>4.2 npm start</h2><p>Esta es una lista no exhaustiva de lo que sucede.</p><ol><li>npm start</li><li>ng serve</li><li>webpack server en <a href=\"http://localhost:4200\" target=\"_blank\" rel=\"noopener\">http://localhost:4200</a><ol><li>vigilancia de cambios sobre la carpeta src/</li><li>live reload</li><li>compilado de la aplicacin</li><li>recarga del navegador</li></ol></li></ol><p>Cambia a tu antojo el <code>app.component.ts</code> o su hermano <code>app.component.html</code> y comprueba los cambios de manera inmediata en tu navegador.</p><h1 id=\"5-Configuracion\"><a href=\"#5-Configuracion\" class=\"headerlink\" title=\"5. Configuracin\"></a>5. Configuracin</h1><p>El CLI 9 viene con pilas incluidas, se puede usar desde el primer momento. Slo quedan pequeas mejoras que hacer. Por ejemplo ajustar el <code>package.json</code> y agregar libreras de terceros.</p><h2 id=\"5-1-Package-json\"><a href=\"#5-1-Package-json\" class=\"headerlink\" title=\"5.1 Package.json\"></a>5.1 Package.json</h2><p>El <code>package.json</code> es el fichero estndar de <em>npm</em> donde se almacenan las <strong>dependencias de terceros</strong>. Contiene las libreras que necesita la aplicacin para ejecutarse, por ejemplo todas las de <em>Angular 9</em>. Y tambin las herramientas que necesita el programador, por ejemplo el propio <em>AngularCLI</em>;</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"dependencies\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"@angular/core\"</span>: <span class=\"string\">\"~9.1.1\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"devDependencies\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"@angular/cli\"</span>: <span class=\"string\">\"~9.1.1\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Otro uso del <code>package.json</code> es servir de <strong>contenedor de scripts</strong> para automatizar tareas de operaciones rutinarias. Por ejemplo, el comando estndar <code>npm start</code> ejecutar el contenido asignado en el fichero <em>json</em>, originalmente <code>ng serve</code>. Esto lanza el servidor de pruebas con sus opciones por defecto.</p><p>Pero el <strong>comando <a href=\"https://angular.io/cli/serve\" target=\"_blank\" rel=\"noopener\">ng serve</a></strong> admite muchas configuraciones. Te propongo que uses esta para activar un modo de compilacin ms rpido y seguro, y para que se abra el navegador de forma automtica en cuanto lances el servidor. Y adems te recomiendo que uses un puerto especfico para cada aplicacin.</p><p>Otras configuraciones en produccin</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"start\"</span>: <span class=\"string\">\"ng serve -o --port 4290\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"5-2-Estilos-y-librerias-de-terceros\"><a href=\"#5-2-Estilos-y-librerias-de-terceros\" class=\"headerlink\" title=\"5.2 Estilos y libreras de terceros\"></a>5.2 Estilos y libreras de terceros</h2><p>Las libreras que vienen de fbrica tienen todo lo necesario para crear aplicaciones. Pero raro es el caso en que no necesitemos <strong>algn que otro producto de terceros</strong>. Ya sean utilidades como <em><a href=\"https://date-fns.org/\" target=\"_blank\" rel=\"noopener\">date-fns</a></em>, libreras grficas como <em><a href=\"http://www.chartjs.org/\" target=\"_blank\" rel=\"noopener\">chart.js</a></em> o la aplicacin de estilos y componentes visuales de <em>frameworks como Bootstrap o MaterialDesign</em>. Pero todos se instalan de igual forma. Descargndolos con <em>npm</em> y adjuntndolos en el <code>angular.json</code>.</p><p>Estas colecciones de archivos los usa el <em>cli</em> a travs de <em>webpack</em> para incluirlos <strong>minificados y concatenados en un fichero <em>bundle</em> sustituyendo a las clsicas etiquetas html</strong>.Todo, el html y sus estilos, se construir en el cliente a partir de instrucciones JavaScript. De esta forma el fichero <code>index.html</code> apenas tendrs que tocarlo, salvo para algunas etiquetas de meta informacin.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"description\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"A sample project for learning Angular ;-)\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"keywords\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"Angular Sample Tutorial Ejemplo\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"author\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"Alberto Basalo\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"5-3-Environments\"><a href=\"#5-3-Environments\" class=\"headerlink\" title=\"5.3 Environments\"></a>5.3 Environments</h2><p>La carpeta <code>environments/</code> contiene dos ficheros, y puede contener ms, para cada entorno de distribucin necesario. En cdigo siempre importaremos el fichero base, pero durante la compilacin el CLI lo sustituir por el adecuado.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title = environment.appName + <span class=\"string\">'hello world ;-)'</span>;</span><br></pre></td></tr></table></figure><h2 id=\"5-4-Assets\"><a href=\"#5-4-Assets\" class=\"headerlink\" title=\"5.4 Assets\"></a>5.4 Assets</h2><p>Los ficheros de la carpeta <code>assets/</code> se copian tal cual al despliegue. Es un buen lugar para logos, imgenes y ficheros de datos estticos.</p><p>Por ejemplo, en el <code>app.component.html</code> he sustituido la imagen incrustada del Angular con un logo propio.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">width</span>=<span class=\"string\">\"100\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./assets/logo.png\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"6-Angular-9-el-CLI-9-y-su-ecosistema\"><a href=\"#6-Angular-9-el-CLI-9-y-su-ecosistema\" class=\"headerlink\" title=\"6. Angular 9, el CLI 9 y su ecosistema\"></a>6. Angular 9, el CLI 9 y su ecosistema</h1><p>Algunos consejos y herramientas tiles que rodean al mundo Angular.</p><p>Pero si la lnea de comandos te suena muy antigua y lo tuyo son las interfaces grficas, ests de suerte. El reciente proyecto <a href=\"https://angularconsole.com/\" target=\"_blank\" rel=\"noopener\">Angular Console</a> te permite generar y ejecutar comandos desde una cmoda interfaz grfica.</p><p>Una mejora digna de mencin es la capacidad de presupuestar tamaos de los ficheros generados. De esa forma podemos controlar el peso y tiempo de descarga de la aplicacin.</p><p>Para garantizar la limpieza del cdigo conviene usar herramientas como <a href=\"https://prettier.io/\" target=\"_blank\" rel=\"noopener\">Prettier</a> y configurarlas para su compatibilidad con Angular.</p><p>Los ltimos toques antes de publicar pueden incluir el <em>script de analytics</em> en el <code>index.html</code> y ajustes de retro-compatibilidad en el fichero <code>polyfills.ts</code>.</p><p>Luego un comando y listo para publicar en <em>github pages</em>. <code>ng add angular-cli-ghpages</code>.</p><blockquote><p>Te recomiendo que te familiarices y uses mucho estos <em>scripts</em> en el <code>package.json</code> para poder lanzarlos ms tarde.</p></blockquote><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">   <span class=\"attr\">\"scripts\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"ng\"</span>: <span class=\"string\">\"ng\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"start\"</span>: <span class=\"string\">\"ng serve -o --port 4290\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"start:prod\"</span>: <span class=\"string\">\"npm run build:prod &amp;&amp; npm run http-server\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"build\"</span>: <span class=\"string\">\"ng build\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"build:prod\"</span>: <span class=\"string\">\"ng build --prod\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"deploy\"</span>: <span class=\"string\">\"ng deploy --baseHref=/angular-basic/\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"test\"</span>: <span class=\"string\">\"ng test\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"lint\"</span>: <span class=\"string\">\"ng lint\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"e2e\"</span>: <span class=\"string\">\"ng e2e\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Comprueba las ejecuciones de los distintos <em>scripts</em>. Con <code>npm start</code> no se generan ficheros fsicos. Todos es en memoria para mayor velocidad de re-compilacin mientras desarrollas. En cambio <code>npm run build:prod</code> crear una carpeta <code>./dist/angular-basic</code> en la que dejar los archivos necesarios para ejecucin. Por ltimo <code>npm run deploy</code> los prepara para enviar compilados a un rama estndar de publicacin listos para desplegarse en las <a href=\"https://pages.github.com/\" target=\"_blank\" rel=\"noopener\"><em>github pages</em></a>.</p><p>Otros enlaces de inters sobre el ecosistema Angular.</p><ul><li><a href=\"https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials\" target=\"_blank\" rel=\"noopener\">Extensiones Esenciales</a></li><li><a href=\"https://prettier.io/\" target=\"_blank\" rel=\"noopener\">Prettier</a></li><li><a href=\"https://github.com/prettier/tslint-config-prettier\" target=\"_blank\" rel=\"noopener\">TsLint-Prettier</a></li><li><a href=\"https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console\" target=\"_blank\" rel=\"noopener\">Angular Console</a></li><li><a href=\"https://material.angular.io/\" target=\"_blank\" rel=\"noopener\">Angular Material</a></li><li><a href=\"https://ng-bootstrap.github.io/#/home\" target=\"_blank\" rel=\"noopener\">Bootstrap</a></li><li><a href=\"https://augury.rangle.io/\" target=\"_blank\" rel=\"noopener\">Augury</a></li><li><a href=\"https://www.apollographql.com/docs/\" target=\"_blank\" rel=\"noopener\">Apollo GraphQL</a></li><li><a href=\"https://ionicframework.com/\" target=\"_blank\" rel=\"noopener\">Ionic</a></li><li><a href=\"https://angularconsole.com/\" target=\"_blank\" rel=\"noopener\">Angular Console</a></li></ul><p>Para complementar tu conocimiento te recomiendo la <a href=\"https://angular.io/cli\" target=\"_blank\" rel=\"noopener\">documentacin de Angular/CLI</a> y este artculo avanzado que trata la configuracin del CLI en profundidad <a href=\"https://medium.com/dailyjs/angular-cli-6-under-the-hood-builders-demystified-f0690ebcf01\" target=\"_blank\" rel=\"noopener\">Angular CLI under the hood</a></p><p>Esto es slo el principio, <em>Angular CLI 9</em> puede hacer mucho ms por ti; descbrelo en esta serie tutorial para aprender a programar con Angular 9. En el prximo artculo crearemos una <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a>. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Base para una aplicacin Angular","date":"2020-03-06T16:57:00.000Z","thumbnail":"/css/images/angular-1_base.png","_content":"\n![base-aplicacion-angular](/images/tutorial-angular-1_base.png)\n\nVamos a crear una **base sobre la que programar una aplicacin Angular 9** profesional. Usaremos el _CLI_ para generar una estructura sobre la que crecer. Ser como una semilla para un desarrollo controlado.\nLa idea de rbol se usa en muchas analogas informticas. La emplearemos en dos conceptos bsicos en Angular: **los mdulos y los componentes**.\n\n<!-- more -->\n\nPartimos de la aplicacin tal cmo la dejamos en el [Hola Mundo en Angular](../hola-angular-cli/). Al finalizar tendrs un esqueleto del que colgar mdulos y componentes funcionales.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Mdulos\n\nLos mdulos son **contenedores para almacenar los componentes y servicios** de una aplicacin. En Angular cada programa se puede ver como un rbol de mdulos jerrquico. A partir de un mdulo raz se enlazan otros mdulos en un proceso llamado importacin.\n\n## 1.1 Anatoma de un mdulo\n\nAntes de usar cualquier mdulo hay que conocerlo. En Angular **los mdulos de declaran como clases de TypeScript**. Estas clases, habitualmente vacas, son decoradas con una funcin especial. Es la funcin `@NgModule()` que recibe un objeto como nico argumento. En las propiedades de ese objeto es donde se configura el mdulo.\n\nMira el mdulo `AppModule` original que genera el CLI en el fichero `app.module.ts`.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\n### 1.1.1 Importacin de otros mdulos\n\nEl mdulo `App` tambin se conoce como **mdulo raz** porque de l surgen las dems ramas que conforman una aplicacin. La asignacin de los nodos hijos se realiza en la propiedad `imports:[]`, que es un array de punteros a otros mdulos.\n\n> En la situacin original el mdulo principal depende un mdulo _custom_ pre-generado (el `AppRoutingModule` que usars ms adelante) y de otro _del framework_ para la presentacin en el navegador (el `BrowserModule`).\n\nVeremos esto con ms profundidad en el punto 4.\n\n## 1.2 Generacin de mdulos\n\nHasta ahora los mdulos involucrados son libreras de terceros o que se crearon mgicamente con la aplicacin. Es hora de **crear tu primer mdulo**. Para eso usaremos otro comando del _cli_, el `ng generate module`. En una ventana del terminal escribe:\n\n```bash\nng g m layout\n```\n\nEsta es la sintaxis abreviada del comando [`ng generate`](https://angular.io/cli/generate) el cual dispone de varios planos de construccin o _schematics_. El que he usado aqu es el de [`module`](https://angular.io/cli/generate#module-command) para la construccin de mdulos.\n\n> Si no te gusta teclear en la terminal, tambin puedes lanzar estos comandos desde [Nx Angular Console](https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console)\n\nEl resultado es la creacin del fichero `layout/layout.module.ts` con la declaracin y decoracin del mdulo `LayoutModule`.\nEste mdulo te servir de **contenedor para guardar componentes** y otros servicios esenciales para nuestra aplicacin. Pero eso lo veremos ms adelante.\n\n```typescript\n@NgModule({\n  imports: [],\n  declarations: []\n})\nexport class LayoutModule {}\n```\n\nPor ahora hay que asegurar que **este mdulo ser importado por el raz, el AppModule**. Para ello comprobaremos que la lnea de importacin del mdulo principal est parecida a esto:\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, LayoutModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\n> El mdulo raz, al igual que como vers ms tarde con el componente raz, es un tanto especial. Su nombre oficial es App, aunque todo la documentacin se refiere a l como raz o root.\n\n# 2. Componentes\n\nLos mdulos son contenedores. Lo primero que vamos a guardar en ellos sern componentes. **Los componentes son los bloques bsicos de construccin de las pginas web en Angular**. Contienen una parte visual en `html` (la Vista) y una funcional en `Typescript` (el Controlador).\n\n> La aplicacin original que crea el CLI nos regala un primer componente de ejemplo en el fichero `app.component.ts`. Segn la configuracin del CLI este componente puede haber sido creado en un slo fichero o hasta cuatro: (el controlador, con la vista y los estilos en ficheros propios y fichero extra para pruebas unitarias).\n\n## 2.1 Anatoma de un componente\n\nLos componentes, como el resto de artefactos en Angular, sern **clases TypeScript decoradas** con funciones especficas. En este caso la funcin es `@Component()` que recibe un objeto de definicin de componente. Igual que en el caso de los mdulos contiene las propiedades en las que configurar el componente.\n\n```typescript\nimport { Component } from '@angular/core';\n\n@Component({\n  selector: 'ab-root',\n  templateUrl: './app.component.html',\n  styles: []\n})\nexport class AppComponent {}\n```\n\n**Los componentes definen nuevas etiquetas HTML** para ser usados dentro de otros componentes. Excepcionalmente en este caso por ser el componente raz se consume en el pgina `index.html`. El nombre de la nueva etiqueta se conoce como _selector_. En este caso la propiedad `selector: \"ab-root\"` permite el uso de este componente dentro de otro con esta invocacin `<ab-root></ab-root>`. En este caso el componente raz.\n\n> Particularidades del componente raz. Su nombre oficial es `AppComponent`, y su selector debera llamarse `ab-app`. Est formado a partir del prefijo de la aplicacin `ab` y su nombre oficioso `root`. Si no se dice lo contrario el prefijo `app` se usar en todos los componentes propios, pue es asignado por defecto durante la generacin de la aplicacin. Yo prefiero personalizarlo usando el modificador `--prefix` o `-p` durante el inicio `ng new`.\n\nVolviendo al componente raz; est destinado a ser usado en la pgina principal, en el `index.html`. Eso obliga a registrarlo de una manera especial en el mdulo raz. Hay que incluirlo en el array `bootstrap: [AppComponent]`, es ah donde se incluyen los componentes con la capacidad de lanzar _bootstrap_ la aplicacin.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, LayoutModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\nY en el `index.html`\n\n```html\n<body>\n  <ab-root></ab-root>\n</body>\n```\n\n**La plantilla representa la parte visual** del componente. De forma simplificada, o cuando tiene poco contenido, puede escribirse directamente en la propiedad `template` del objeto decorador. Pero es ms frecuente encontrar la plantilla en su propio fichero _html_ y referenciarlo como una ruta relativa en la propiedad `templateUrl`.\n\nLa propiedad **`styles` y su gemela `stylesUrl` permiten asignar estilos** _CSS, SASS o LESS_ al componente. Estos estilos se incrustan durante la compilacin en los nodos del _DOM_ generado. Son exclusivos del componente y facilitan el diseo y maquetacin granular de las aplicaciones.\n\nLos estilos, ausentes en este ejemplo, podran incluirse como un array de cadenas, o llevarse a un fichero propio como en el caso de la vista.\n\n```html\n<div style=\"text-align:center\">\n  <h1>Welcome to {{ title }}!</h1>\n  <img width=\"100\" src=\"./assets/logo.png\" />\n</div>\n...\n```\n\n**En la clase del componente nos encontraremos la implementacin de su funcionalidad**. Normalmente expondr propiedades y mtodos para ser consumidos e invocados de forma declarativa desde la vista.\n\nUna aplicacin web en Angular se monta como un **rbol de componentes**. El componente raz ya viene creado y convenientemente declarado; ahora toca darle contenido mediante una estructura de pgina y las vistas funcionales.\n\n## 2.2 Generacin de componentes\n\nPara **crear nuevos componentes** vamos a usar de nuevo el comando `generate` del _CLI_ . Pero ahora con los planos para construir un componente. La [sintaxis completa](https://angular.io/cli/generate#component-command) del comando `ng generate component` o abreviadamente `ng g c` permite crear componentes en diversas formas.\n\nCasi **todas las pginas tienen una estructura** similar que de forma simplista queda en tres componentes. Uno para la barra de navegacin, otro para el pie de pgina y otro intermedio para el contenido principal.\n\nEjecuta en una terminal estos comandos para que generen los componentes y comprueba el resultado en el editor.\n\n```shell\nng g c layout/header --export\nng g c layout/nav --export\nng g c layout/aside --export\nng g c layout/footer --export\n```\n\nFjate en un componente como el Header y en el fichero `header.component.ts`. Su estructura es igual a la del componente raz. Destaca que el nombre del componente coincide con el nombre del selector: `app-header` y `HeaderComponent`. Esto ser lo normal a partir de ahora. Slo el componente raz tiene la excepcin de que su nombre `App` no coincide con su selector `root`.\n\n```typescript\nimport { Component, OnInit } from '@angular/core';\n@Component({\n  selector: 'ab-header',\n  templateUrl: './header.component.html',\n  styles: []\n})\nexport class HeaderComponent implements OnInit {\n  constructor() {}\n  ngOnInit() {}\n}\n```\n\nY esta es su vista asociada. La cual es de nuevo una composicin de otros selectores. Estamos creando un frondoso rbol de componentes.\n\n```html\n<header>\n  <strong> {{ title }} </strong>\n</header>\n```\n\n## 2.3 Estilos en los componentes\n\nLa aplicacin de estilos y css en los componentes merecera un tema aparte. Para empezar quiero que seas consciente de que lo que programes es cdigo fuente. Lo escribirs en TypeScript, algo muy parecido al Html y los estilos en Css, LASS, SCSS...\n\nPero todo ese cdigo fuente no es lo que ejecuta el navegador. Ni mucho menos. Antes tiene que compilarse y generar JavaScript, que al ejecutarse en el navegador crea de nuevo Html, JS y estilos...\n\nEstos estilos van ya incrustados entre los elementos. Y Angular los aplica componente a componente, sin herencia ni transmisin a los descendientes. Este es el comportamiento por defecto. Por supuesto, todo es customizable. Pero en este curso lo dejaremos tal cual viene de fbrica.\n\nAs que los estilos se definen en el fichero apropiado. Se puede usa los selectores de clase e identificador estndar de CSS. Pero tambin se puede usar el selector propio `:host` el cual apunta al elemento html que crear el componente cuando se ejecute.\n\nPor ejemplo en `app.component.css`\n\n```css\n:host {\n  min-height: 100vh;\n}\n:host > main {\n  display: flex;\n  flex: 1 1 auto;\n  flex-direction: column;\n}\n:host > main > article {\n  flex: 1 1 auto;\n}\n\n@media (min-width: 768px) {\n  :host > main {\n    flex-direction: row;\n  }\n}\n\n```\n\n# 3 Visibilidad entre componentes\n\nLa clave del cdigo limpio es **exponer funcionalidad de manera expresiva pero ocultar la implementacin**. Esto es sencillo con los lenguajes de POO, pero en HTML no era nada fcil. Con la **programacin basada en componentes** podemos crear pantallas complejas, reutilizables y que a su vez contengan y oculten la complejidad interna a sus consumidores.\n\n## 3.1 Componentes pblicos y privados\n\nLos componentes no deciden por s mismos su **visibilidad**. Cuando un componente es generado se declara en un mdulo contenedor en su propiedad `declares:[]`. Eso lo hace visible y utilizable por cualquier otro componente del mismo mdulo. Pero **si quieres usarlo desde fuera tendrs que exportarlo**. Eso se hace en la propiedad `exports:[]` del mdulo en el que se crea.\n\nLa exportacin debe hacerse a mano incluyendo el componente en el array, o indicarse con el _flag_ `--export` para que lo haga el _cli_. Esto es lo que se ha hecho en el mdulo _Layout_ para poder exportar el componente `header`.\n\n```typescript\n@NgModule({\n  declarations: [HeaderComponent, FooterComponent, NavComponent, AsideComponent],\n  imports: [CommonModule, RouterModule],\n  exports: [HeaderComponent, FooterComponent, NavComponent, AsideComponent],\n})\nexport class LayoutModule {}\n```\n\n> **Los componentes privados suelen ser sencillos**. A veces son creados para ser especficamente consumidos dentro de otros componentes. En esas situaciones interesa que sean privados y que generen poco ruido. Incluso, en casos extremadamente simples, si usamos el modificador `--flat` ni siquiera generan carpeta propia.\n\nPor supuesto que `HeaderComponent` necesitar la propiedad `title` y tambin la moveremos desde `app.component.ts`. Dejando de esa manera el componente raz en los huesos.\n\n## 3.2 Importacin y exportacin entre mdulos\n\nQue un componente sea pblico es la primera condicin para que se consuma fuera de su mdulo. Ahora falta que quin lo quiera usar, utilice el selector `<ab-header>` importe su mdulo `LayoutModule`. Esto lo haremos en el `AppModule` para que lo use el `AppComponent`.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, LayoutModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\nComo regla general, **cuando en una plantilla se incruste otro componente**, Angular lo buscar dentro del propio mdulo en el que pretende usarse. Si no lo encuentra entonces lo buscar entre los componentes exportados por los mdulos que hayan sido importados por el actual contenedor.\n\n### 3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript\n\nSi es la primera vez que ves cdigo TypeScript te llamarn la atencin las primeras lneas de cada fichero. En el `app.module.ts` son algo as:\n\n```typescript\nimport { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\n```\n\nEstas **sentencias de importacin son propias del lenguaje** y nada tienen que ver con Angular. En ellas se indica que este fichero importa el contenido de otros ficheros _TypeScript_. La importacin se realiza en base a convenios personalizables. Si empieza con `./` entonces se busca a travs de la ruta fsica relativa al fichero actual. En otro caso se busca en el directorio `node_modules` y se trata como cdigo de terceros.\n\n> En general no tendrs que preocuparte de estas importaciones fsicas, pues el _VSCode_ y las extensiones esenciales se encargan de hacerlo automticamente segn lo uses en tu cdigo\n\n# 4. Transitividad y Organizacin\n\n## 4.1 Transitividad en una cadena de mdulos\n\nUn problema que reforzar tu conocimiento sobre el sistema modular surgir al mover la etiqueta `<router-outlet></router-outlet>` del `app.component.html` al componente _Main_. En su vista `main.component.html` tendrs algo as.\n\n```html\n<h2>Here are some links to help you start:</h2>\n<ul>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://angular.io/tutorial\">Tour of Heroes</a></h2>\n  </li>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://angular.io/cli\">CLI Documentation</a></h2>\n  </li>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://blog.angular.io/\">Angular blog</a></h2>\n  </li>\n</ul>\n<router-outlet></router-outlet>\n```\n\nTodo son etiquetas _html_ estndar salvo la ltima `<router-outlet></router-outlet>`. El propsito de este componte lo veremos en la prxima leccin dedicada a enrutado. Pero por ahora ms que una ayuda es un dolor de cabeza. Resulta que el `RouterOutletComponent` est declarado en un mdulo del _framework_ llamado `RouterModule`. Dicho mdulo fue importado de manera automtica durante la generacin del cdigo inicial, pero Dnde?.\n\nComo digo el tema del enrutado es un [captulo aparte](../paginas-y-rutas-angular-spa/), pero las relaciones de los mdulos debes conocerlas cuanto antes. Durante la generacin inicial se crearon dos mdulos: el `AppModule`, ya estudiado, y su asistente para enrutado `AppRoutingModule`. Este ltimo an no lo hemos visitado. Su contenido es:\n\n```typescript\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nconst routes: Routes = [];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nObviando la por ahora intil instruccin `.forRoutes(routes)`, llama la atencin que este mdulo es dependiente del famoso `RouterModule`, es decir lo importa en su array `imports:[]`. Pero adems va y lo exporta haciendo uso de la interesante **propiedad transitiva de los mdulos**. Cada mdulo puede exportar sus propios componentes o los de terceros. Incluso puede exportar todo un mdulo al completo. Al hacerlo as, el `AppRoutingModule` est poniendo a disposicin del `AppModule` todo el contenido de `RouterModule`, incluido el por ahora fastidioso `RouterOutletComponent`.\n\n## 4.2 Organizacin de la aplicacin en mdulos\n\nTodos los programas tiene partes repetitivas. Los principios de **organizacin y cdigo limpio** nos permiten identificarlas y reutilizarlas. Con los componentes ocurre lo mismo. El mdulo y los componentes recin creados suelen ser comunes a casi todas las aplicaciones. Estos y otros muchos surgirn de manera natural durante el desarrollo de una aplicacin para ser utilizados en mltiples pginas.\n\nSon **componentes de infraestructura**. Conviene guardarlos en una carpeta especial. Aqu la he llamado _shared_, pero _tools_, _common_, o _lib_ suelen ser otros nombres habituales. Para reforzar tu prctica con el CLI escribe el siguiente comando que aprovecharemos en el futuro.\n\n```bash\nng g m shared\nng g c shared/go-home --export=true\n```\n\n```html\n<a href=\"\"> Go home </a>\n```\n\nY puedo usarlo por ejemplo en el Header\n\n```html\n<header>\n  <ab-go-home></ab-go-home><strong> {{ title }} </strong>\n</header>\n```\n\n> En esta aplicacin hasta ahora no es nada funcional,!y ya tiene una docena de cosas entre mdulos y componentes!. Puede parecer sobre-ingeniera, pero a la larga le vers sentido. Por ahora te permitir practicar con la creacin de mdulos y componentes.\n\n### Un ejemplo prctico recopilatorio para la pgina _home_.\n\n```bash\nng g m home -m app.module.ts\nng g c home/home --export --flat\n```\n\n### home.component.html\n```html\n<h2> Welcome  !</h2>\n<nav>\n  <p>\n    <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\"> Curso de Introduccin</a>\n  </p>\n  <p>\n    <a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\"> Curso Avanzado</a>\n  </p>\n</nav>\n```\n\nY podemos incluir este componente en el contenido del layout del componente principal `AppComponent`.\n\n```html\n<ab-header></ab-header>\n<main>\n  <ab-nav></ab-nav>\n  <article>\n    <router-outlet></router-outlet>\n    <ab-home></ab-home>\n  </article>\n  <ab-aside></ab-aside>\n</main>\n<ab-footer></ab-footer>\n```\n\n### El bosque de mdulos a vista de pjaro\n\n```\nAppModule\n|\n+--AppRoutingModule\n|  |\n|  +--RouterModule\n|\n+--BrowserModule\n|\n+--HomeModule\n|\n+--LayoutModule\n   |\n   +--CommonModule\n   |\n   +--RouterModule\n   |\n   +--SharedModule\n```\n\n### El bosque de componentes a vista de pjaro\n\n```\nAppComponent\n  |\n  +--HeaderComponent\n  |\n  +--NavComponent\n  |\n  +--RouterOutletComponent\n  |\n  +--HomeComponent\n  |\n  +--FooterComponent\n\n```\n\nCon esto tendrs una base para una aplicacin _Angular 9_. Sigue esta serie para aadirle funcionalidad mediante [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/) mientras aprendes a programar con Angular9. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng_1-Base-aplicacion-Angular.md","raw":"---\ntitle: Base para una aplicacin Angular\npermalink: base-aplicacion-angular\ndate: 2020-03-06 17:57:00\ntags:\n  - Angular\n  - CLI\n  - Tutorial\n  - Introduccin\n  - Angular9\n  - Angular2\ncategories:\n  - [Tutorial, Angular]\nthumbnail: /css/images/angular-1_base.png\n---\n\n![base-aplicacion-angular](/images/tutorial-angular-1_base.png)\n\nVamos a crear una **base sobre la que programar una aplicacin Angular 9** profesional. Usaremos el _CLI_ para generar una estructura sobre la que crecer. Ser como una semilla para un desarrollo controlado.\nLa idea de rbol se usa en muchas analogas informticas. La emplearemos en dos conceptos bsicos en Angular: **los mdulos y los componentes**.\n\n<!-- more -->\n\nPartimos de la aplicacin tal cmo la dejamos en el [Hola Mundo en Angular](../hola-angular-cli/). Al finalizar tendrs un esqueleto del que colgar mdulos y componentes funcionales.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Mdulos\n\nLos mdulos son **contenedores para almacenar los componentes y servicios** de una aplicacin. En Angular cada programa se puede ver como un rbol de mdulos jerrquico. A partir de un mdulo raz se enlazan otros mdulos en un proceso llamado importacin.\n\n## 1.1 Anatoma de un mdulo\n\nAntes de usar cualquier mdulo hay que conocerlo. En Angular **los mdulos de declaran como clases de TypeScript**. Estas clases, habitualmente vacas, son decoradas con una funcin especial. Es la funcin `@NgModule()` que recibe un objeto como nico argumento. En las propiedades de ese objeto es donde se configura el mdulo.\n\nMira el mdulo `AppModule` original que genera el CLI en el fichero `app.module.ts`.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\n### 1.1.1 Importacin de otros mdulos\n\nEl mdulo `App` tambin se conoce como **mdulo raz** porque de l surgen las dems ramas que conforman una aplicacin. La asignacin de los nodos hijos se realiza en la propiedad `imports:[]`, que es un array de punteros a otros mdulos.\n\n> En la situacin original el mdulo principal depende un mdulo _custom_ pre-generado (el `AppRoutingModule` que usars ms adelante) y de otro _del framework_ para la presentacin en el navegador (el `BrowserModule`).\n\nVeremos esto con ms profundidad en el punto 4.\n\n## 1.2 Generacin de mdulos\n\nHasta ahora los mdulos involucrados son libreras de terceros o que se crearon mgicamente con la aplicacin. Es hora de **crear tu primer mdulo**. Para eso usaremos otro comando del _cli_, el `ng generate module`. En una ventana del terminal escribe:\n\n```bash\nng g m layout\n```\n\nEsta es la sintaxis abreviada del comando [`ng generate`](https://angular.io/cli/generate) el cual dispone de varios planos de construccin o _schematics_. El que he usado aqu es el de [`module`](https://angular.io/cli/generate#module-command) para la construccin de mdulos.\n\n> Si no te gusta teclear en la terminal, tambin puedes lanzar estos comandos desde [Nx Angular Console](https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console)\n\nEl resultado es la creacin del fichero `layout/layout.module.ts` con la declaracin y decoracin del mdulo `LayoutModule`.\nEste mdulo te servir de **contenedor para guardar componentes** y otros servicios esenciales para nuestra aplicacin. Pero eso lo veremos ms adelante.\n\n```typescript\n@NgModule({\n  imports: [],\n  declarations: []\n})\nexport class LayoutModule {}\n```\n\nPor ahora hay que asegurar que **este mdulo ser importado por el raz, el AppModule**. Para ello comprobaremos que la lnea de importacin del mdulo principal est parecida a esto:\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, LayoutModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\n> El mdulo raz, al igual que como vers ms tarde con el componente raz, es un tanto especial. Su nombre oficial es App, aunque todo la documentacin se refiere a l como raz o root.\n\n# 2. Componentes\n\nLos mdulos son contenedores. Lo primero que vamos a guardar en ellos sern componentes. **Los componentes son los bloques bsicos de construccin de las pginas web en Angular**. Contienen una parte visual en `html` (la Vista) y una funcional en `Typescript` (el Controlador).\n\n> La aplicacin original que crea el CLI nos regala un primer componente de ejemplo en el fichero `app.component.ts`. Segn la configuracin del CLI este componente puede haber sido creado en un slo fichero o hasta cuatro: (el controlador, con la vista y los estilos en ficheros propios y fichero extra para pruebas unitarias).\n\n## 2.1 Anatoma de un componente\n\nLos componentes, como el resto de artefactos en Angular, sern **clases TypeScript decoradas** con funciones especficas. En este caso la funcin es `@Component()` que recibe un objeto de definicin de componente. Igual que en el caso de los mdulos contiene las propiedades en las que configurar el componente.\n\n```typescript\nimport { Component } from '@angular/core';\n\n@Component({\n  selector: 'ab-root',\n  templateUrl: './app.component.html',\n  styles: []\n})\nexport class AppComponent {}\n```\n\n**Los componentes definen nuevas etiquetas HTML** para ser usados dentro de otros componentes. Excepcionalmente en este caso por ser el componente raz se consume en el pgina `index.html`. El nombre de la nueva etiqueta se conoce como _selector_. En este caso la propiedad `selector: \"ab-root\"` permite el uso de este componente dentro de otro con esta invocacin `<ab-root></ab-root>`. En este caso el componente raz.\n\n> Particularidades del componente raz. Su nombre oficial es `AppComponent`, y su selector debera llamarse `ab-app`. Est formado a partir del prefijo de la aplicacin `ab` y su nombre oficioso `root`. Si no se dice lo contrario el prefijo `app` se usar en todos los componentes propios, pue es asignado por defecto durante la generacin de la aplicacin. Yo prefiero personalizarlo usando el modificador `--prefix` o `-p` durante el inicio `ng new`.\n\nVolviendo al componente raz; est destinado a ser usado en la pgina principal, en el `index.html`. Eso obliga a registrarlo de una manera especial en el mdulo raz. Hay que incluirlo en el array `bootstrap: [AppComponent]`, es ah donde se incluyen los componentes con la capacidad de lanzar _bootstrap_ la aplicacin.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, LayoutModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\nY en el `index.html`\n\n```html\n<body>\n  <ab-root></ab-root>\n</body>\n```\n\n**La plantilla representa la parte visual** del componente. De forma simplificada, o cuando tiene poco contenido, puede escribirse directamente en la propiedad `template` del objeto decorador. Pero es ms frecuente encontrar la plantilla en su propio fichero _html_ y referenciarlo como una ruta relativa en la propiedad `templateUrl`.\n\nLa propiedad **`styles` y su gemela `stylesUrl` permiten asignar estilos** _CSS, SASS o LESS_ al componente. Estos estilos se incrustan durante la compilacin en los nodos del _DOM_ generado. Son exclusivos del componente y facilitan el diseo y maquetacin granular de las aplicaciones.\n\nLos estilos, ausentes en este ejemplo, podran incluirse como un array de cadenas, o llevarse a un fichero propio como en el caso de la vista.\n\n```html\n<div style=\"text-align:center\">\n  <h1>Welcome to {{ title }}!</h1>\n  <img width=\"100\" src=\"./assets/logo.png\" />\n</div>\n...\n```\n\n**En la clase del componente nos encontraremos la implementacin de su funcionalidad**. Normalmente expondr propiedades y mtodos para ser consumidos e invocados de forma declarativa desde la vista.\n\nUna aplicacin web en Angular se monta como un **rbol de componentes**. El componente raz ya viene creado y convenientemente declarado; ahora toca darle contenido mediante una estructura de pgina y las vistas funcionales.\n\n## 2.2 Generacin de componentes\n\nPara **crear nuevos componentes** vamos a usar de nuevo el comando `generate` del _CLI_ . Pero ahora con los planos para construir un componente. La [sintaxis completa](https://angular.io/cli/generate#component-command) del comando `ng generate component` o abreviadamente `ng g c` permite crear componentes en diversas formas.\n\nCasi **todas las pginas tienen una estructura** similar que de forma simplista queda en tres componentes. Uno para la barra de navegacin, otro para el pie de pgina y otro intermedio para el contenido principal.\n\nEjecuta en una terminal estos comandos para que generen los componentes y comprueba el resultado en el editor.\n\n```shell\nng g c layout/header --export\nng g c layout/nav --export\nng g c layout/aside --export\nng g c layout/footer --export\n```\n\nFjate en un componente como el Header y en el fichero `header.component.ts`. Su estructura es igual a la del componente raz. Destaca que el nombre del componente coincide con el nombre del selector: `app-header` y `HeaderComponent`. Esto ser lo normal a partir de ahora. Slo el componente raz tiene la excepcin de que su nombre `App` no coincide con su selector `root`.\n\n```typescript\nimport { Component, OnInit } from '@angular/core';\n@Component({\n  selector: 'ab-header',\n  templateUrl: './header.component.html',\n  styles: []\n})\nexport class HeaderComponent implements OnInit {\n  constructor() {}\n  ngOnInit() {}\n}\n```\n\nY esta es su vista asociada. La cual es de nuevo una composicin de otros selectores. Estamos creando un frondoso rbol de componentes.\n\n```html\n<header>\n  <strong> {{ title }} </strong>\n</header>\n```\n\n## 2.3 Estilos en los componentes\n\nLa aplicacin de estilos y css en los componentes merecera un tema aparte. Para empezar quiero que seas consciente de que lo que programes es cdigo fuente. Lo escribirs en TypeScript, algo muy parecido al Html y los estilos en Css, LASS, SCSS...\n\nPero todo ese cdigo fuente no es lo que ejecuta el navegador. Ni mucho menos. Antes tiene que compilarse y generar JavaScript, que al ejecutarse en el navegador crea de nuevo Html, JS y estilos...\n\nEstos estilos van ya incrustados entre los elementos. Y Angular los aplica componente a componente, sin herencia ni transmisin a los descendientes. Este es el comportamiento por defecto. Por supuesto, todo es customizable. Pero en este curso lo dejaremos tal cual viene de fbrica.\n\nAs que los estilos se definen en el fichero apropiado. Se puede usa los selectores de clase e identificador estndar de CSS. Pero tambin se puede usar el selector propio `:host` el cual apunta al elemento html que crear el componente cuando se ejecute.\n\nPor ejemplo en `app.component.css`\n\n```css\n:host {\n  min-height: 100vh;\n}\n:host > main {\n  display: flex;\n  flex: 1 1 auto;\n  flex-direction: column;\n}\n:host > main > article {\n  flex: 1 1 auto;\n}\n\n@media (min-width: 768px) {\n  :host > main {\n    flex-direction: row;\n  }\n}\n\n```\n\n# 3 Visibilidad entre componentes\n\nLa clave del cdigo limpio es **exponer funcionalidad de manera expresiva pero ocultar la implementacin**. Esto es sencillo con los lenguajes de POO, pero en HTML no era nada fcil. Con la **programacin basada en componentes** podemos crear pantallas complejas, reutilizables y que a su vez contengan y oculten la complejidad interna a sus consumidores.\n\n## 3.1 Componentes pblicos y privados\n\nLos componentes no deciden por s mismos su **visibilidad**. Cuando un componente es generado se declara en un mdulo contenedor en su propiedad `declares:[]`. Eso lo hace visible y utilizable por cualquier otro componente del mismo mdulo. Pero **si quieres usarlo desde fuera tendrs que exportarlo**. Eso se hace en la propiedad `exports:[]` del mdulo en el que se crea.\n\nLa exportacin debe hacerse a mano incluyendo el componente en el array, o indicarse con el _flag_ `--export` para que lo haga el _cli_. Esto es lo que se ha hecho en el mdulo _Layout_ para poder exportar el componente `header`.\n\n```typescript\n@NgModule({\n  declarations: [HeaderComponent, FooterComponent, NavComponent, AsideComponent],\n  imports: [CommonModule, RouterModule],\n  exports: [HeaderComponent, FooterComponent, NavComponent, AsideComponent],\n})\nexport class LayoutModule {}\n```\n\n> **Los componentes privados suelen ser sencillos**. A veces son creados para ser especficamente consumidos dentro de otros componentes. En esas situaciones interesa que sean privados y que generen poco ruido. Incluso, en casos extremadamente simples, si usamos el modificador `--flat` ni siquiera generan carpeta propia.\n\nPor supuesto que `HeaderComponent` necesitar la propiedad `title` y tambin la moveremos desde `app.component.ts`. Dejando de esa manera el componente raz en los huesos.\n\n## 3.2 Importacin y exportacin entre mdulos\n\nQue un componente sea pblico es la primera condicin para que se consuma fuera de su mdulo. Ahora falta que quin lo quiera usar, utilice el selector `<ab-header>` importe su mdulo `LayoutModule`. Esto lo haremos en el `AppModule` para que lo use el `AppComponent`.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, LayoutModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\nComo regla general, **cuando en una plantilla se incruste otro componente**, Angular lo buscar dentro del propio mdulo en el que pretende usarse. Si no lo encuentra entonces lo buscar entre los componentes exportados por los mdulos que hayan sido importados por el actual contenedor.\n\n### 3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript\n\nSi es la primera vez que ves cdigo TypeScript te llamarn la atencin las primeras lneas de cada fichero. En el `app.module.ts` son algo as:\n\n```typescript\nimport { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\n```\n\nEstas **sentencias de importacin son propias del lenguaje** y nada tienen que ver con Angular. En ellas se indica que este fichero importa el contenido de otros ficheros _TypeScript_. La importacin se realiza en base a convenios personalizables. Si empieza con `./` entonces se busca a travs de la ruta fsica relativa al fichero actual. En otro caso se busca en el directorio `node_modules` y se trata como cdigo de terceros.\n\n> En general no tendrs que preocuparte de estas importaciones fsicas, pues el _VSCode_ y las extensiones esenciales se encargan de hacerlo automticamente segn lo uses en tu cdigo\n\n# 4. Transitividad y Organizacin\n\n## 4.1 Transitividad en una cadena de mdulos\n\nUn problema que reforzar tu conocimiento sobre el sistema modular surgir al mover la etiqueta `<router-outlet></router-outlet>` del `app.component.html` al componente _Main_. En su vista `main.component.html` tendrs algo as.\n\n```html\n<h2>Here are some links to help you start:</h2>\n<ul>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://angular.io/tutorial\">Tour of Heroes</a></h2>\n  </li>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://angular.io/cli\">CLI Documentation</a></h2>\n  </li>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://blog.angular.io/\">Angular blog</a></h2>\n  </li>\n</ul>\n<router-outlet></router-outlet>\n```\n\nTodo son etiquetas _html_ estndar salvo la ltima `<router-outlet></router-outlet>`. El propsito de este componte lo veremos en la prxima leccin dedicada a enrutado. Pero por ahora ms que una ayuda es un dolor de cabeza. Resulta que el `RouterOutletComponent` est declarado en un mdulo del _framework_ llamado `RouterModule`. Dicho mdulo fue importado de manera automtica durante la generacin del cdigo inicial, pero Dnde?.\n\nComo digo el tema del enrutado es un [captulo aparte](../paginas-y-rutas-angular-spa/), pero las relaciones de los mdulos debes conocerlas cuanto antes. Durante la generacin inicial se crearon dos mdulos: el `AppModule`, ya estudiado, y su asistente para enrutado `AppRoutingModule`. Este ltimo an no lo hemos visitado. Su contenido es:\n\n```typescript\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nconst routes: Routes = [];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nObviando la por ahora intil instruccin `.forRoutes(routes)`, llama la atencin que este mdulo es dependiente del famoso `RouterModule`, es decir lo importa en su array `imports:[]`. Pero adems va y lo exporta haciendo uso de la interesante **propiedad transitiva de los mdulos**. Cada mdulo puede exportar sus propios componentes o los de terceros. Incluso puede exportar todo un mdulo al completo. Al hacerlo as, el `AppRoutingModule` est poniendo a disposicin del `AppModule` todo el contenido de `RouterModule`, incluido el por ahora fastidioso `RouterOutletComponent`.\n\n## 4.2 Organizacin de la aplicacin en mdulos\n\nTodos los programas tiene partes repetitivas. Los principios de **organizacin y cdigo limpio** nos permiten identificarlas y reutilizarlas. Con los componentes ocurre lo mismo. El mdulo y los componentes recin creados suelen ser comunes a casi todas las aplicaciones. Estos y otros muchos surgirn de manera natural durante el desarrollo de una aplicacin para ser utilizados en mltiples pginas.\n\nSon **componentes de infraestructura**. Conviene guardarlos en una carpeta especial. Aqu la he llamado _shared_, pero _tools_, _common_, o _lib_ suelen ser otros nombres habituales. Para reforzar tu prctica con el CLI escribe el siguiente comando que aprovecharemos en el futuro.\n\n```bash\nng g m shared\nng g c shared/go-home --export=true\n```\n\n```html\n<a href=\"\"> Go home </a>\n```\n\nY puedo usarlo por ejemplo en el Header\n\n```html\n<header>\n  <ab-go-home></ab-go-home><strong> {{ title }} </strong>\n</header>\n```\n\n> En esta aplicacin hasta ahora no es nada funcional,!y ya tiene una docena de cosas entre mdulos y componentes!. Puede parecer sobre-ingeniera, pero a la larga le vers sentido. Por ahora te permitir practicar con la creacin de mdulos y componentes.\n\n### Un ejemplo prctico recopilatorio para la pgina _home_.\n\n```bash\nng g m home -m app.module.ts\nng g c home/home --export --flat\n```\n\n### home.component.html\n```html\n<h2> Welcome  !</h2>\n<nav>\n  <p>\n    <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\"> Curso de Introduccin</a>\n  </p>\n  <p>\n    <a href=\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\"> Curso Avanzado</a>\n  </p>\n</nav>\n```\n\nY podemos incluir este componente en el contenido del layout del componente principal `AppComponent`.\n\n```html\n<ab-header></ab-header>\n<main>\n  <ab-nav></ab-nav>\n  <article>\n    <router-outlet></router-outlet>\n    <ab-home></ab-home>\n  </article>\n  <ab-aside></ab-aside>\n</main>\n<ab-footer></ab-footer>\n```\n\n### El bosque de mdulos a vista de pjaro\n\n```\nAppModule\n|\n+--AppRoutingModule\n|  |\n|  +--RouterModule\n|\n+--BrowserModule\n|\n+--HomeModule\n|\n+--LayoutModule\n   |\n   +--CommonModule\n   |\n   +--RouterModule\n   |\n   +--SharedModule\n```\n\n### El bosque de componentes a vista de pjaro\n\n```\nAppComponent\n  |\n  +--HeaderComponent\n  |\n  +--NavComponent\n  |\n  +--RouterOutletComponent\n  |\n  +--HomeComponent\n  |\n  +--FooterComponent\n\n```\n\nCon esto tendrs una base para una aplicacin _Angular 9_. Sigue esta serie para aadirle funcionalidad mediante [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/) mientras aprendes a programar con Angular9. Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"base-aplicacion-angular","published":1,"updated":"2020-04-15T10:34:44.898Z","_id":"ck70mab200011bss3jtdcnbgy","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-1_base.png\" alt=\"base-aplicacion-angular\"></p><p>Vamos a crear una <strong>base sobre la que programar una aplicacin Angular 9</strong> profesional. Usaremos el <em>CLI</em> para generar una estructura sobre la que crecer. Ser como una semilla para un desarrollo controlado.<br>La idea de rbol se usa en muchas analogas informticas. La emplearemos en dos conceptos bsicos en Angular: <strong>los mdulos y los componentes</strong>.</p><a id=\"more\"></a><p>Partimos de la aplicacin tal cmo la dejamos en el <a href=\"../hola-angular-cli/\">Hola Mundo en Angular</a>. Al finalizar tendrs un esqueleto del que colgar mdulos y componentes funcionales.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Modulos\"><a href=\"#1-Modulos\" class=\"headerlink\" title=\"1. Mdulos\"></a>1. Mdulos</h1><p>Los mdulos son <strong>contenedores para almacenar los componentes y servicios</strong> de una aplicacin. En Angular cada programa se puede ver como un rbol de mdulos jerrquico. A partir de un mdulo raz se enlazan otros mdulos en un proceso llamado importacin.</p><h2 id=\"1-1-Anatomia-de-un-modulo\"><a href=\"#1-1-Anatomia-de-un-modulo\" class=\"headerlink\" title=\"1.1 Anatoma de un mdulo\"></a>1.1 Anatoma de un mdulo</h2><p>Antes de usar cualquier mdulo hay que conocerlo. En Angular <strong>los mdulos de declaran como clases de TypeScript</strong>. Estas clases, habitualmente vacas, son decoradas con una funcin especial. Es la funcin <code>@NgModule()</code> que recibe un objeto como nico argumento. En las propiedades de ese objeto es donde se configura el mdulo.</p><p>Mira el mdulo <code>AppModule</code> original que genera el CLI en el fichero <code>app.module.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id=\"1-1-1-Importacion-de-otros-modulos\"><a href=\"#1-1-1-Importacion-de-otros-modulos\" class=\"headerlink\" title=\"1.1.1 Importacin de otros mdulos\"></a>1.1.1 Importacin de otros mdulos</h3><p>El mdulo <code>App</code> tambin se conoce como <strong>mdulo raz</strong> porque de l surgen las dems ramas que conforman una aplicacin. La asignacin de los nodos hijos se realiza en la propiedad <code>imports:[]</code>, que es un array de punteros a otros mdulos.</p><blockquote><p>En la situacin original el mdulo principal depende un mdulo <em>custom</em> pre-generado (el <code>AppRoutingModule</code> que usars ms adelante) y de otro <em>del framework</em> para la presentacin en el navegador (el <code>BrowserModule</code>).</p></blockquote><p>Veremos esto con ms profundidad en el punto 4.</p><h2 id=\"1-2-Generacion-de-modulos\"><a href=\"#1-2-Generacion-de-modulos\" class=\"headerlink\" title=\"1.2 Generacin de mdulos\"></a>1.2 Generacin de mdulos</h2><p>Hasta ahora los mdulos involucrados son libreras de terceros o que se crearon mgicamente con la aplicacin. Es hora de <strong>crear tu primer mdulo</strong>. Para eso usaremos otro comando del <em>cli</em>, el <code>ng generate module</code>. En una ventana del terminal escribe:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m layout</span><br></pre></td></tr></table></figure><p>Esta es la sintaxis abreviada del comando <a href=\"https://angular.io/cli/generate\" target=\"_blank\" rel=\"noopener\"><code>ng generate</code></a> el cual dispone de varios planos de construccin o <em>schematics</em>. El que he usado aqu es el de <a href=\"https://angular.io/cli/generate#module-command\" target=\"_blank\" rel=\"noopener\"><code>module</code></a> para la construccin de mdulos.</p><blockquote><p>Si no te gusta teclear en la terminal, tambin puedes lanzar estos comandos desde <a href=\"https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console\" target=\"_blank\" rel=\"noopener\">Nx Angular Console</a></p></blockquote><p>El resultado es la creacin del fichero <code>layout/layout.module.ts</code> con la declaracin y decoracin del mdulo <code>LayoutModule</code>.<br>Este mdulo te servir de <strong>contenedor para guardar componentes</strong> y otros servicios esenciales para nuestra aplicacin. Pero eso lo veremos ms adelante.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [],</span><br><span class=\"line\">  declarations: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> LayoutModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Por ahora hay que asegurar que <strong>este mdulo ser importado por el raz, el AppModule</strong>. Para ello comprobaremos que la lnea de importacin del mdulo principal est parecida a esto:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, LayoutModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El mdulo raz, al igual que como vers ms tarde con el componente raz, es un tanto especial. Su nombre oficial es App, aunque todo la documentacin se refiere a l como raz o root.</p></blockquote><h1 id=\"2-Componentes\"><a href=\"#2-Componentes\" class=\"headerlink\" title=\"2. Componentes\"></a>2. Componentes</h1><p>Los mdulos son contenedores. Lo primero que vamos a guardar en ellos sern componentes. <strong>Los componentes son los bloques bsicos de construccin de las pginas web en Angular</strong>. Contienen una parte visual en <code>html</code> (la Vista) y una funcional en <code>Typescript</code> (el Controlador).</p><blockquote><p>La aplicacin original que crea el CLI nos regala un primer componente de ejemplo en el fichero <code>app.component.ts</code>. Segn la configuracin del CLI este componente puede haber sido creado en un slo fichero o hasta cuatro: (el controlador, con la vista y los estilos en ficheros propios y fichero extra para pruebas unitarias).</p></blockquote><h2 id=\"2-1-Anatomia-de-un-componente\"><a href=\"#2-1-Anatomia-de-un-componente\" class=\"headerlink\" title=\"2.1 Anatoma de un componente\"></a>2.1 Anatoma de un componente</h2><p>Los componentes, como el resto de artefactos en Angular, sern <strong>clases TypeScript decoradas</strong> con funciones especficas. En este caso la funcin es <code>@Component()</code> que recibe un objeto de definicin de componente. Igual que en el caso de los mdulos contiene las propiedades en las que configurar el componente.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-root'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./app.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;&#125;</span><br></pre></td></tr></table></figure><p><strong>Los componentes definen nuevas etiquetas HTML</strong> para ser usados dentro de otros componentes. Excepcionalmente en este caso por ser el componente raz se consume en el pgina <code>index.html</code>. El nombre de la nueva etiqueta se conoce como <em>selector</em>. En este caso la propiedad <code>selector: &quot;ab-root&quot;</code> permite el uso de este componente dentro de otro con esta invocacin <code>&lt;ab-root&gt;&lt;/ab-root&gt;</code>. En este caso el componente raz.</p><blockquote><p>Particularidades del componente raz. Su nombre oficial es <code>AppComponent</code>, y su selector debera llamarse <code>ab-app</code>. Est formado a partir del prefijo de la aplicacin <code>ab</code> y su nombre oficioso <code>root</code>. Si no se dice lo contrario el prefijo <code>app</code> se usar en todos los componentes propios, pue es asignado por defecto durante la generacin de la aplicacin. Yo prefiero personalizarlo usando el modificador <code>--prefix</code> o <code>-p</code> durante el inicio <code>ng new</code>.</p></blockquote><p>Volviendo al componente raz; est destinado a ser usado en la pgina principal, en el <code>index.html</code>. Eso obliga a registrarlo de una manera especial en el mdulo raz. Hay que incluirlo en el array <code>bootstrap: [AppComponent]</code>, es ah donde se incluyen los componentes con la capacidad de lanzar <em>bootstrap</em> la aplicacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, LayoutModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Y en el <code>index.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ab-root</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-root</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>La plantilla representa la parte visual</strong> del componente. De forma simplificada, o cuando tiene poco contenido, puede escribirse directamente en la propiedad <code>template</code> del objeto decorador. Pero es ms frecuente encontrar la plantilla en su propio fichero <em>html</em> y referenciarlo como una ruta relativa en la propiedad <code>templateUrl</code>.</p><p>La propiedad <strong><code>styles</code> y su gemela <code>stylesUrl</code> permiten asignar estilos</strong> <em>CSS, SASS o LESS</em> al componente. Estos estilos se incrustan durante la compilacin en los nodos del <em>DOM</em> generado. Son exclusivos del componente y facilitan el diseo y maquetacin granular de las aplicaciones.</p><p>Los estilos, ausentes en este ejemplo, podran incluirse como un array de cadenas, o llevarse a un fichero propio como en el caso de la vista.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"text-align:center\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Welcome to &#123;&#123; title &#125;&#125;!<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">width</span>=<span class=\"string\">\"100\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./assets/logo.png\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure><p><strong>En la clase del componente nos encontraremos la implementacin de su funcionalidad</strong>. Normalmente expondr propiedades y mtodos para ser consumidos e invocados de forma declarativa desde la vista.</p><p>Una aplicacin web en Angular se monta como un <strong>rbol de componentes</strong>. El componente raz ya viene creado y convenientemente declarado; ahora toca darle contenido mediante una estructura de pgina y las vistas funcionales.</p><h2 id=\"2-2-Generacion-de-componentes\"><a href=\"#2-2-Generacion-de-componentes\" class=\"headerlink\" title=\"2.2 Generacin de componentes\"></a>2.2 Generacin de componentes</h2><p>Para <strong>crear nuevos componentes</strong> vamos a usar de nuevo el comando <code>generate</code> del <em>CLI</em> . Pero ahora con los planos para construir un componente. La <a href=\"https://angular.io/cli/generate#component-command\" target=\"_blank\" rel=\"noopener\">sintaxis completa</a> del comando <code>ng generate component</code> o abreviadamente <code>ng g c</code> permite crear componentes en diversas formas.</p><p>Casi <strong>todas las pginas tienen una estructura</strong> similar que de forma simplista queda en tres componentes. Uno para la barra de navegacin, otro para el pie de pgina y otro intermedio para el contenido principal.</p><p>Ejecuta en una terminal estos comandos para que generen los componentes y comprueba el resultado en el editor.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c layout/header --export</span><br><span class=\"line\">ng g c layout/nav --export</span><br><span class=\"line\">ng g c layout/aside --export</span><br><span class=\"line\">ng g c layout/footer --export</span><br></pre></td></tr></table></figure><p>Fjate en un componente como el Header y en el fichero <code>header.component.ts</code>. Su estructura es igual a la del componente raz. Destaca que el nombre del componente coincide con el nombre del selector: <code>app-header</code> y <code>HeaderComponent</code>. Esto ser lo normal a partir de ahora. Slo el componente raz tiene la excepcin de que su nombre <code>App</code> no coincide con su selector <code>root</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-header'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./header.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> HeaderComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y esta es su vista asociada. La cual es de nuevo una composicin de otros selectores. Estamos creando un frondoso rbol de componentes.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span> &#123;&#123; title &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"2-3-Estilos-en-los-componentes\"><a href=\"#2-3-Estilos-en-los-componentes\" class=\"headerlink\" title=\"2.3 Estilos en los componentes\"></a>2.3 Estilos en los componentes</h2><p>La aplicacin de estilos y css en los componentes merecera un tema aparte. Para empezar quiero que seas consciente de que lo que programes es cdigo fuente. Lo escribirs en TypeScript, algo muy parecido al Html y los estilos en Css, LASS, SCSS</p><p>Pero todo ese cdigo fuente no es lo que ejecuta el navegador. Ni mucho menos. Antes tiene que compilarse y generar JavaScript, que al ejecutarse en el navegador crea de nuevo Html, JS y estilos</p><p>Estos estilos van ya incrustados entre los elementos. Y Angular los aplica componente a componente, sin herencia ni transmisin a los descendientes. Este es el comportamiento por defecto. Por supuesto, todo es customizable. Pero en este curso lo dejaremos tal cual viene de fbrica.</p><p>As que los estilos se definen en el fichero apropiado. Se puede usa los selectores de clase e identificador estndar de CSS. Pero tambin se puede usar el selector propio <code>:host</code> el cual apunta al elemento html que crear el componente cuando se ejecute.</p><p>Por ejemplo en <code>app.component.css</code></p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-pseudo\">:host</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">min-height</span>: <span class=\"number\">100vh</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-pseudo\">:host</span> &gt; <span class=\"selector-tag\">main</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">  <span class=\"attribute\">flex</span>: <span class=\"number\">1</span> <span class=\"number\">1</span> auto;</span><br><span class=\"line\">  <span class=\"attribute\">flex-direction</span>: column;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-pseudo\">:host</span> &gt; <span class=\"selector-tag\">main</span> &gt; <span class=\"selector-tag\">article</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">flex</span>: <span class=\"number\">1</span> <span class=\"number\">1</span> auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">@<span class=\"keyword\">media</span> (min-width: <span class=\"number\">768px</span>) &#123;</span><br><span class=\"line\">  <span class=\"selector-pseudo\">:host</span> &gt; <span class=\"selector-tag\">main</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">flex-direction</span>: row;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"3-Visibilidad-entre-componentes\"><a href=\"#3-Visibilidad-entre-componentes\" class=\"headerlink\" title=\"3 Visibilidad entre componentes\"></a>3 Visibilidad entre componentes</h1><p>La clave del cdigo limpio es <strong>exponer funcionalidad de manera expresiva pero ocultar la implementacin</strong>. Esto es sencillo con los lenguajes de POO, pero en HTML no era nada fcil. Con la <strong>programacin basada en componentes</strong> podemos crear pantallas complejas, reutilizables y que a su vez contengan y oculten la complejidad interna a sus consumidores.</p><h2 id=\"3-1-Componentes-publicos-y-privados\"><a href=\"#3-1-Componentes-publicos-y-privados\" class=\"headerlink\" title=\"3.1 Componentes pblicos y privados\"></a>3.1 Componentes pblicos y privados</h2><p>Los componentes no deciden por s mismos su <strong>visibilidad</strong>. Cuando un componente es generado se declara en un mdulo contenedor en su propiedad <code>declares:[]</code>. Eso lo hace visible y utilizable por cualquier otro componente del mismo mdulo. Pero <strong>si quieres usarlo desde fuera tendrs que exportarlo</strong>. Eso se hace en la propiedad <code>exports:[]</code> del mdulo en el que se crea.</p><p>La exportacin debe hacerse a mano incluyendo el componente en el array, o indicarse con el <em>flag</em> <code>--export</code> para que lo haga el <em>cli</em>. Esto es lo que se ha hecho en el mdulo <em>Layout</em> para poder exportar el componente <code>header</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [HeaderComponent, FooterComponent, NavComponent, AsideComponent],</span><br><span class=\"line\">  imports: [CommonModule, RouterModule],</span><br><span class=\"line\">  exports: [HeaderComponent, FooterComponent, NavComponent, AsideComponent],</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> LayoutModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>Los componentes privados suelen ser sencillos</strong>. A veces son creados para ser especficamente consumidos dentro de otros componentes. En esas situaciones interesa que sean privados y que generen poco ruido. Incluso, en casos extremadamente simples, si usamos el modificador <code>--flat</code> ni siquiera generan carpeta propia.</p></blockquote><p>Por supuesto que <code>HeaderComponent</code> necesitar la propiedad <code>title</code> y tambin la moveremos desde <code>app.component.ts</code>. Dejando de esa manera el componente raz en los huesos.</p><h2 id=\"3-2-Importacion-y-exportacion-entre-modulos\"><a href=\"#3-2-Importacion-y-exportacion-entre-modulos\" class=\"headerlink\" title=\"3.2 Importacin y exportacin entre mdulos\"></a>3.2 Importacin y exportacin entre mdulos</h2><p>Que un componente sea pblico es la primera condicin para que se consuma fuera de su mdulo. Ahora falta que quin lo quiera usar, utilice el selector <code>&lt;ab-header&gt;</code> importe su mdulo <code>LayoutModule</code>. Esto lo haremos en el <code>AppModule</code> para que lo use el <code>AppComponent</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, LayoutModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Como regla general, <strong>cuando en una plantilla se incruste otro componente</strong>, Angular lo buscar dentro del propio mdulo en el que pretende usarse. Si no lo encuentra entonces lo buscar entre los componentes exportados por los mdulos que hayan sido importados por el actual contenedor.</p><h3 id=\"3-2-1-Dos-mundos-paralelos-imports-de-Angular-e-import-de-TypeScript\"><a href=\"#3-2-1-Dos-mundos-paralelos-imports-de-Angular-e-import-de-TypeScript\" class=\"headerlink\" title=\"3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript\"></a>3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript</h3><p>Si es la primera vez que ves cdigo TypeScript te llamarn la atencin las primeras lneas de cada fichero. En el <code>app.module.ts</code> son algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; BrowserModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppRoutingModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app-routing.module'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.component'</span>;</span><br></pre></td></tr></table></figure><p>Estas <strong>sentencias de importacin son propias del lenguaje</strong> y nada tienen que ver con Angular. En ellas se indica que este fichero importa el contenido de otros ficheros <em>TypeScript</em>. La importacin se realiza en base a convenios personalizables. Si empieza con <code>./</code> entonces se busca a travs de la ruta fsica relativa al fichero actual. En otro caso se busca en el directorio <code>node_modules</code> y se trata como cdigo de terceros.</p><blockquote><p>En general no tendrs que preocuparte de estas importaciones fsicas, pues el <em>VSCode</em> y las extensiones esenciales se encargan de hacerlo automticamente segn lo uses en tu cdigo</p></blockquote><h1 id=\"4-Transitividad-y-Organizacion\"><a href=\"#4-Transitividad-y-Organizacion\" class=\"headerlink\" title=\"4. Transitividad y Organizacin\"></a>4. Transitividad y Organizacin</h1><h2 id=\"4-1-Transitividad-en-una-cadena-de-modulos\"><a href=\"#4-1-Transitividad-en-una-cadena-de-modulos\" class=\"headerlink\" title=\"4.1 Transitividad en una cadena de mdulos\"></a>4.1 Transitividad en una cadena de mdulos</h2><p>Un problema que reforzar tu conocimiento sobre el sistema modular surgir al mover la etiqueta <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code> del <code>app.component.html</code> al componente <em>Main</em>. En su vista <code>main.component.html</code> tendrs algo as.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Here are some links to help you start:<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://angular.io/tutorial\"</span>&gt;</span>Tour of Heroes<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://angular.io/cli\"</span>&gt;</span>CLI Documentation<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://blog.angular.io/\"</span>&gt;</span>Angular blog<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Todo son etiquetas <em>html</em> estndar salvo la ltima <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>. El propsito de este componte lo veremos en la prxima leccin dedicada a enrutado. Pero por ahora ms que una ayuda es un dolor de cabeza. Resulta que el <code>RouterOutletComponent</code> est declarado en un mdulo del <em>framework</em> llamado <code>RouterModule</code>. Dicho mdulo fue importado de manera automtica durante la generacin del cdigo inicial, pero Dnde?.</p><p>Como digo el tema del enrutado es un <a href=\"../paginas-y-rutas-angular-spa/\">captulo aparte</a>, pero las relaciones de los mdulos debes conocerlas cuanto antes. Durante la generacin inicial se crearon dos mdulos: el <code>AppModule</code>, ya estudiado, y su asistente para enrutado <code>AppRoutingModule</code>. Este ltimo an no lo hemos visitado. Su contenido es:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Obviando la por ahora intil instruccin <code>.forRoutes(routes)</code>, llama la atencin que este mdulo es dependiente del famoso <code>RouterModule</code>, es decir lo importa en su array <code>imports:[]</code>. Pero adems va y lo exporta haciendo uso de la interesante <strong>propiedad transitiva de los mdulos</strong>. Cada mdulo puede exportar sus propios componentes o los de terceros. Incluso puede exportar todo un mdulo al completo. Al hacerlo as, el <code>AppRoutingModule</code> est poniendo a disposicin del <code>AppModule</code> todo el contenido de <code>RouterModule</code>, incluido el por ahora fastidioso <code>RouterOutletComponent</code>.</p><h2 id=\"4-2-Organizacion-de-la-aplicacion-en-modulos\"><a href=\"#4-2-Organizacion-de-la-aplicacion-en-modulos\" class=\"headerlink\" title=\"4.2 Organizacin de la aplicacin en mdulos\"></a>4.2 Organizacin de la aplicacin en mdulos</h2><p>Todos los programas tiene partes repetitivas. Los principios de <strong>organizacin y cdigo limpio</strong> nos permiten identificarlas y reutilizarlas. Con los componentes ocurre lo mismo. El mdulo y los componentes recin creados suelen ser comunes a casi todas las aplicaciones. Estos y otros muchos surgirn de manera natural durante el desarrollo de una aplicacin para ser utilizados en mltiples pginas.</p><p>Son <strong>componentes de infraestructura</strong>. Conviene guardarlos en una carpeta especial. Aqu la he llamado <em>shared</em>, pero <em>tools</em>, <em>common</em>, o <em>lib</em> suelen ser otros nombres habituales. Para reforzar tu prctica con el CLI escribe el siguiente comando que aprovecharemos en el futuro.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m shared</span><br><span class=\"line\">ng g c shared/go-home --<span class=\"built_in\">export</span>=<span class=\"literal\">true</span></span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"\"</span>&gt;</span> Go home <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y puedo usarlo por ejemplo en el Header</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ab-go-home</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-go-home</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span> &#123;&#123; title &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>En esta aplicacin hasta ahora no es nada funcional,!y ya tiene una docena de cosas entre mdulos y componentes!. Puede parecer sobre-ingeniera, pero a la larga le vers sentido. Por ahora te permitir practicar con la creacin de mdulos y componentes.</p></blockquote><h3 id=\"Un-ejemplo-practico-recopilatorio-para-la-pagina-home\"><a href=\"#Un-ejemplo-practico-recopilatorio-para-la-pagina-home\" class=\"headerlink\" title=\"Un ejemplo prctico recopilatorio para la pgina home.\"></a>Un ejemplo prctico recopilatorio para la pgina <em>home</em>.</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m home -m app.module.ts</span><br><span class=\"line\">ng g c home/home --<span class=\"built_in\">export</span> --flat</span><br></pre></td></tr></table></figure><h3 id=\"home-component-html\"><a href=\"#home-component-html\" class=\"headerlink\" title=\"home.component.html\"></a>home.component.html</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> Welcome  !<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">nav</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\"</span>&gt;</span> Curso de Introduccin<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\"</span>&gt;</span> Curso Avanzado<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y podemos incluir este componente en el contenido del layout del componente principal <code>AppComponent</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-header</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-header</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ab-nav</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-nav</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">article</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ab-home</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-home</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">article</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ab-aside</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-aside</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-footer</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-footer</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"El-bosque-de-modulos-a-vista-de-pajaro\"><a href=\"#El-bosque-de-modulos-a-vista-de-pajaro\" class=\"headerlink\" title=\"El bosque de mdulos a vista de pjaro\"></a>El bosque de mdulos a vista de pjaro</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AppModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--AppRoutingModule</span><br><span class=\"line\">|  |</span><br><span class=\"line\">|  +--RouterModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--BrowserModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--HomeModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--LayoutModule</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--CommonModule</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--RouterModule</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--SharedModule</span><br></pre></td></tr></table></figure><h3 id=\"El-bosque-de-componentes-a-vista-de-pajaro\"><a href=\"#El-bosque-de-componentes-a-vista-de-pajaro\" class=\"headerlink\" title=\"El bosque de componentes a vista de pjaro\"></a>El bosque de componentes a vista de pjaro</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AppComponent</span><br><span class=\"line\">  |</span><br><span class=\"line\">  +--HeaderComponent</span><br><span class=\"line\">  |</span><br><span class=\"line\">  +--NavComponent</span><br><span class=\"line\">  |</span><br><span class=\"line\">  +--RouterOutletComponent</span><br><span class=\"line\">  |</span><br><span class=\"line\">  +--HomeComponent</span><br><span class=\"line\">  |</span><br><span class=\"line\">  +--FooterComponent</span><br></pre></td></tr></table></figure><p>Con esto tendrs una base para una aplicacin <em>Angular 9</em>. Sigue esta serie para aadirle funcionalidad mediante <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a> mientras aprendes a programar con Angular9. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-1_base.png\" alt=\"base-aplicacion-angular\"></p><p>Vamos a crear una <strong>base sobre la que programar una aplicacin Angular 9</strong> profesional. Usaremos el <em>CLI</em> para generar una estructura sobre la que crecer. Ser como una semilla para un desarrollo controlado.<br>La idea de rbol se usa en muchas analogas informticas. La emplearemos en dos conceptos bsicos en Angular: <strong>los mdulos y los componentes</strong>.</p>","more":"<p>Partimos de la aplicacin tal cmo la dejamos en el <a href=\"../hola-angular-cli/\">Hola Mundo en Angular</a>. Al finalizar tendrs un esqueleto del que colgar mdulos y componentes funcionales.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Modulos\"><a href=\"#1-Modulos\" class=\"headerlink\" title=\"1. Mdulos\"></a>1. Mdulos</h1><p>Los mdulos son <strong>contenedores para almacenar los componentes y servicios</strong> de una aplicacin. En Angular cada programa se puede ver como un rbol de mdulos jerrquico. A partir de un mdulo raz se enlazan otros mdulos en un proceso llamado importacin.</p><h2 id=\"1-1-Anatomia-de-un-modulo\"><a href=\"#1-1-Anatomia-de-un-modulo\" class=\"headerlink\" title=\"1.1 Anatoma de un mdulo\"></a>1.1 Anatoma de un mdulo</h2><p>Antes de usar cualquier mdulo hay que conocerlo. En Angular <strong>los mdulos de declaran como clases de TypeScript</strong>. Estas clases, habitualmente vacas, son decoradas con una funcin especial. Es la funcin <code>@NgModule()</code> que recibe un objeto como nico argumento. En las propiedades de ese objeto es donde se configura el mdulo.</p><p>Mira el mdulo <code>AppModule</code> original que genera el CLI en el fichero <code>app.module.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id=\"1-1-1-Importacion-de-otros-modulos\"><a href=\"#1-1-1-Importacion-de-otros-modulos\" class=\"headerlink\" title=\"1.1.1 Importacin de otros mdulos\"></a>1.1.1 Importacin de otros mdulos</h3><p>El mdulo <code>App</code> tambin se conoce como <strong>mdulo raz</strong> porque de l surgen las dems ramas que conforman una aplicacin. La asignacin de los nodos hijos se realiza en la propiedad <code>imports:[]</code>, que es un array de punteros a otros mdulos.</p><blockquote><p>En la situacin original el mdulo principal depende un mdulo <em>custom</em> pre-generado (el <code>AppRoutingModule</code> que usars ms adelante) y de otro <em>del framework</em> para la presentacin en el navegador (el <code>BrowserModule</code>).</p></blockquote><p>Veremos esto con ms profundidad en el punto 4.</p><h2 id=\"1-2-Generacion-de-modulos\"><a href=\"#1-2-Generacion-de-modulos\" class=\"headerlink\" title=\"1.2 Generacin de mdulos\"></a>1.2 Generacin de mdulos</h2><p>Hasta ahora los mdulos involucrados son libreras de terceros o que se crearon mgicamente con la aplicacin. Es hora de <strong>crear tu primer mdulo</strong>. Para eso usaremos otro comando del <em>cli</em>, el <code>ng generate module</code>. En una ventana del terminal escribe:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m layout</span><br></pre></td></tr></table></figure><p>Esta es la sintaxis abreviada del comando <a href=\"https://angular.io/cli/generate\" target=\"_blank\" rel=\"noopener\"><code>ng generate</code></a> el cual dispone de varios planos de construccin o <em>schematics</em>. El que he usado aqu es el de <a href=\"https://angular.io/cli/generate#module-command\" target=\"_blank\" rel=\"noopener\"><code>module</code></a> para la construccin de mdulos.</p><blockquote><p>Si no te gusta teclear en la terminal, tambin puedes lanzar estos comandos desde <a href=\"https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console\" target=\"_blank\" rel=\"noopener\">Nx Angular Console</a></p></blockquote><p>El resultado es la creacin del fichero <code>layout/layout.module.ts</code> con la declaracin y decoracin del mdulo <code>LayoutModule</code>.<br>Este mdulo te servir de <strong>contenedor para guardar componentes</strong> y otros servicios esenciales para nuestra aplicacin. Pero eso lo veremos ms adelante.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [],</span><br><span class=\"line\">  declarations: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> LayoutModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Por ahora hay que asegurar que <strong>este mdulo ser importado por el raz, el AppModule</strong>. Para ello comprobaremos que la lnea de importacin del mdulo principal est parecida a esto:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, LayoutModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El mdulo raz, al igual que como vers ms tarde con el componente raz, es un tanto especial. Su nombre oficial es App, aunque todo la documentacin se refiere a l como raz o root.</p></blockquote><h1 id=\"2-Componentes\"><a href=\"#2-Componentes\" class=\"headerlink\" title=\"2. Componentes\"></a>2. Componentes</h1><p>Los mdulos son contenedores. Lo primero que vamos a guardar en ellos sern componentes. <strong>Los componentes son los bloques bsicos de construccin de las pginas web en Angular</strong>. Contienen una parte visual en <code>html</code> (la Vista) y una funcional en <code>Typescript</code> (el Controlador).</p><blockquote><p>La aplicacin original que crea el CLI nos regala un primer componente de ejemplo en el fichero <code>app.component.ts</code>. Segn la configuracin del CLI este componente puede haber sido creado en un slo fichero o hasta cuatro: (el controlador, con la vista y los estilos en ficheros propios y fichero extra para pruebas unitarias).</p></blockquote><h2 id=\"2-1-Anatomia-de-un-componente\"><a href=\"#2-1-Anatomia-de-un-componente\" class=\"headerlink\" title=\"2.1 Anatoma de un componente\"></a>2.1 Anatoma de un componente</h2><p>Los componentes, como el resto de artefactos en Angular, sern <strong>clases TypeScript decoradas</strong> con funciones especficas. En este caso la funcin es <code>@Component()</code> que recibe un objeto de definicin de componente. Igual que en el caso de los mdulos contiene las propiedades en las que configurar el componente.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-root'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./app.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;&#125;</span><br></pre></td></tr></table></figure><p><strong>Los componentes definen nuevas etiquetas HTML</strong> para ser usados dentro de otros componentes. Excepcionalmente en este caso por ser el componente raz se consume en el pgina <code>index.html</code>. El nombre de la nueva etiqueta se conoce como <em>selector</em>. En este caso la propiedad <code>selector: &quot;ab-root&quot;</code> permite el uso de este componente dentro de otro con esta invocacin <code>&lt;ab-root&gt;&lt;/ab-root&gt;</code>. En este caso el componente raz.</p><blockquote><p>Particularidades del componente raz. Su nombre oficial es <code>AppComponent</code>, y su selector debera llamarse <code>ab-app</code>. Est formado a partir del prefijo de la aplicacin <code>ab</code> y su nombre oficioso <code>root</code>. Si no se dice lo contrario el prefijo <code>app</code> se usar en todos los componentes propios, pue es asignado por defecto durante la generacin de la aplicacin. Yo prefiero personalizarlo usando el modificador <code>--prefix</code> o <code>-p</code> durante el inicio <code>ng new</code>.</p></blockquote><p>Volviendo al componente raz; est destinado a ser usado en la pgina principal, en el <code>index.html</code>. Eso obliga a registrarlo de una manera especial en el mdulo raz. Hay que incluirlo en el array <code>bootstrap: [AppComponent]</code>, es ah donde se incluyen los componentes con la capacidad de lanzar <em>bootstrap</em> la aplicacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, LayoutModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Y en el <code>index.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ab-root</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-root</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>La plantilla representa la parte visual</strong> del componente. De forma simplificada, o cuando tiene poco contenido, puede escribirse directamente en la propiedad <code>template</code> del objeto decorador. Pero es ms frecuente encontrar la plantilla en su propio fichero <em>html</em> y referenciarlo como una ruta relativa en la propiedad <code>templateUrl</code>.</p><p>La propiedad <strong><code>styles</code> y su gemela <code>stylesUrl</code> permiten asignar estilos</strong> <em>CSS, SASS o LESS</em> al componente. Estos estilos se incrustan durante la compilacin en los nodos del <em>DOM</em> generado. Son exclusivos del componente y facilitan el diseo y maquetacin granular de las aplicaciones.</p><p>Los estilos, ausentes en este ejemplo, podran incluirse como un array de cadenas, o llevarse a un fichero propio como en el caso de la vista.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"text-align:center\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Welcome to &#123;&#123; title &#125;&#125;!<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">width</span>=<span class=\"string\">\"100\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./assets/logo.png\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure><p><strong>En la clase del componente nos encontraremos la implementacin de su funcionalidad</strong>. Normalmente expondr propiedades y mtodos para ser consumidos e invocados de forma declarativa desde la vista.</p><p>Una aplicacin web en Angular se monta como un <strong>rbol de componentes</strong>. El componente raz ya viene creado y convenientemente declarado; ahora toca darle contenido mediante una estructura de pgina y las vistas funcionales.</p><h2 id=\"2-2-Generacion-de-componentes\"><a href=\"#2-2-Generacion-de-componentes\" class=\"headerlink\" title=\"2.2 Generacin de componentes\"></a>2.2 Generacin de componentes</h2><p>Para <strong>crear nuevos componentes</strong> vamos a usar de nuevo el comando <code>generate</code> del <em>CLI</em> . Pero ahora con los planos para construir un componente. La <a href=\"https://angular.io/cli/generate#component-command\" target=\"_blank\" rel=\"noopener\">sintaxis completa</a> del comando <code>ng generate component</code> o abreviadamente <code>ng g c</code> permite crear componentes en diversas formas.</p><p>Casi <strong>todas las pginas tienen una estructura</strong> similar que de forma simplista queda en tres componentes. Uno para la barra de navegacin, otro para el pie de pgina y otro intermedio para el contenido principal.</p><p>Ejecuta en una terminal estos comandos para que generen los componentes y comprueba el resultado en el editor.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c layout/header --export</span><br><span class=\"line\">ng g c layout/nav --export</span><br><span class=\"line\">ng g c layout/aside --export</span><br><span class=\"line\">ng g c layout/footer --export</span><br></pre></td></tr></table></figure><p>Fjate en un componente como el Header y en el fichero <code>header.component.ts</code>. Su estructura es igual a la del componente raz. Destaca que el nombre del componente coincide con el nombre del selector: <code>app-header</code> y <code>HeaderComponent</code>. Esto ser lo normal a partir de ahora. Slo el componente raz tiene la excepcin de que su nombre <code>App</code> no coincide con su selector <code>root</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'ab-header'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./header.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> HeaderComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y esta es su vista asociada. La cual es de nuevo una composicin de otros selectores. Estamos creando un frondoso rbol de componentes.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span> &#123;&#123; title &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"2-3-Estilos-en-los-componentes\"><a href=\"#2-3-Estilos-en-los-componentes\" class=\"headerlink\" title=\"2.3 Estilos en los componentes\"></a>2.3 Estilos en los componentes</h2><p>La aplicacin de estilos y css en los componentes merecera un tema aparte. Para empezar quiero que seas consciente de que lo que programes es cdigo fuente. Lo escribirs en TypeScript, algo muy parecido al Html y los estilos en Css, LASS, SCSS</p><p>Pero todo ese cdigo fuente no es lo que ejecuta el navegador. Ni mucho menos. Antes tiene que compilarse y generar JavaScript, que al ejecutarse en el navegador crea de nuevo Html, JS y estilos</p><p>Estos estilos van ya incrustados entre los elementos. Y Angular los aplica componente a componente, sin herencia ni transmisin a los descendientes. Este es el comportamiento por defecto. Por supuesto, todo es customizable. Pero en este curso lo dejaremos tal cual viene de fbrica.</p><p>As que los estilos se definen en el fichero apropiado. Se puede usa los selectores de clase e identificador estndar de CSS. Pero tambin se puede usar el selector propio <code>:host</code> el cual apunta al elemento html que crear el componente cuando se ejecute.</p><p>Por ejemplo en <code>app.component.css</code></p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-pseudo\">:host</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">min-height</span>: <span class=\"number\">100vh</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-pseudo\">:host</span> &gt; <span class=\"selector-tag\">main</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">  <span class=\"attribute\">flex</span>: <span class=\"number\">1</span> <span class=\"number\">1</span> auto;</span><br><span class=\"line\">  <span class=\"attribute\">flex-direction</span>: column;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-pseudo\">:host</span> &gt; <span class=\"selector-tag\">main</span> &gt; <span class=\"selector-tag\">article</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">flex</span>: <span class=\"number\">1</span> <span class=\"number\">1</span> auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">@<span class=\"keyword\">media</span> (min-width: <span class=\"number\">768px</span>) &#123;</span><br><span class=\"line\">  <span class=\"selector-pseudo\">:host</span> &gt; <span class=\"selector-tag\">main</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">flex-direction</span>: row;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"3-Visibilidad-entre-componentes\"><a href=\"#3-Visibilidad-entre-componentes\" class=\"headerlink\" title=\"3 Visibilidad entre componentes\"></a>3 Visibilidad entre componentes</h1><p>La clave del cdigo limpio es <strong>exponer funcionalidad de manera expresiva pero ocultar la implementacin</strong>. Esto es sencillo con los lenguajes de POO, pero en HTML no era nada fcil. Con la <strong>programacin basada en componentes</strong> podemos crear pantallas complejas, reutilizables y que a su vez contengan y oculten la complejidad interna a sus consumidores.</p><h2 id=\"3-1-Componentes-publicos-y-privados\"><a href=\"#3-1-Componentes-publicos-y-privados\" class=\"headerlink\" title=\"3.1 Componentes pblicos y privados\"></a>3.1 Componentes pblicos y privados</h2><p>Los componentes no deciden por s mismos su <strong>visibilidad</strong>. Cuando un componente es generado se declara en un mdulo contenedor en su propiedad <code>declares:[]</code>. Eso lo hace visible y utilizable por cualquier otro componente del mismo mdulo. Pero <strong>si quieres usarlo desde fuera tendrs que exportarlo</strong>. Eso se hace en la propiedad <code>exports:[]</code> del mdulo en el que se crea.</p><p>La exportacin debe hacerse a mano incluyendo el componente en el array, o indicarse con el <em>flag</em> <code>--export</code> para que lo haga el <em>cli</em>. Esto es lo que se ha hecho en el mdulo <em>Layout</em> para poder exportar el componente <code>header</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [HeaderComponent, FooterComponent, NavComponent, AsideComponent],</span><br><span class=\"line\">  imports: [CommonModule, RouterModule],</span><br><span class=\"line\">  exports: [HeaderComponent, FooterComponent, NavComponent, AsideComponent],</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> LayoutModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>Los componentes privados suelen ser sencillos</strong>. A veces son creados para ser especficamente consumidos dentro de otros componentes. En esas situaciones interesa que sean privados y que generen poco ruido. Incluso, en casos extremadamente simples, si usamos el modificador <code>--flat</code> ni siquiera generan carpeta propia.</p></blockquote><p>Por supuesto que <code>HeaderComponent</code> necesitar la propiedad <code>title</code> y tambin la moveremos desde <code>app.component.ts</code>. Dejando de esa manera el componente raz en los huesos.</p><h2 id=\"3-2-Importacion-y-exportacion-entre-modulos\"><a href=\"#3-2-Importacion-y-exportacion-entre-modulos\" class=\"headerlink\" title=\"3.2 Importacin y exportacin entre mdulos\"></a>3.2 Importacin y exportacin entre mdulos</h2><p>Que un componente sea pblico es la primera condicin para que se consuma fuera de su mdulo. Ahora falta que quin lo quiera usar, utilice el selector <code>&lt;ab-header&gt;</code> importe su mdulo <code>LayoutModule</code>. Esto lo haremos en el <code>AppModule</code> para que lo use el <code>AppComponent</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, LayoutModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Como regla general, <strong>cuando en una plantilla se incruste otro componente</strong>, Angular lo buscar dentro del propio mdulo en el que pretende usarse. Si no lo encuentra entonces lo buscar entre los componentes exportados por los mdulos que hayan sido importados por el actual contenedor.</p><h3 id=\"3-2-1-Dos-mundos-paralelos-imports-de-Angular-e-import-de-TypeScript\"><a href=\"#3-2-1-Dos-mundos-paralelos-imports-de-Angular-e-import-de-TypeScript\" class=\"headerlink\" title=\"3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript\"></a>3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript</h3><p>Si es la primera vez que ves cdigo TypeScript te llamarn la atencin las primeras lneas de cada fichero. En el <code>app.module.ts</code> son algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; BrowserModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppRoutingModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app-routing.module'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.component'</span>;</span><br></pre></td></tr></table></figure><p>Estas <strong>sentencias de importacin son propias del lenguaje</strong> y nada tienen que ver con Angular. En ellas se indica que este fichero importa el contenido de otros ficheros <em>TypeScript</em>. La importacin se realiza en base a convenios personalizables. Si empieza con <code>./</code> entonces se busca a travs de la ruta fsica relativa al fichero actual. En otro caso se busca en el directorio <code>node_modules</code> y se trata como cdigo de terceros.</p><blockquote><p>En general no tendrs que preocuparte de estas importaciones fsicas, pues el <em>VSCode</em> y las extensiones esenciales se encargan de hacerlo automticamente segn lo uses en tu cdigo</p></blockquote><h1 id=\"4-Transitividad-y-Organizacion\"><a href=\"#4-Transitividad-y-Organizacion\" class=\"headerlink\" title=\"4. Transitividad y Organizacin\"></a>4. Transitividad y Organizacin</h1><h2 id=\"4-1-Transitividad-en-una-cadena-de-modulos\"><a href=\"#4-1-Transitividad-en-una-cadena-de-modulos\" class=\"headerlink\" title=\"4.1 Transitividad en una cadena de mdulos\"></a>4.1 Transitividad en una cadena de mdulos</h2><p>Un problema que reforzar tu conocimiento sobre el sistema modular surgir al mover la etiqueta <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code> del <code>app.component.html</code> al componente <em>Main</em>. En su vista <code>main.component.html</code> tendrs algo as.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Here are some links to help you start:<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://angular.io/tutorial\"</span>&gt;</span>Tour of Heroes<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://angular.io/cli\"</span>&gt;</span>CLI Documentation<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://blog.angular.io/\"</span>&gt;</span>Angular blog<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Todo son etiquetas <em>html</em> estndar salvo la ltima <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>. El propsito de este componte lo veremos en la prxima leccin dedicada a enrutado. Pero por ahora ms que una ayuda es un dolor de cabeza. Resulta que el <code>RouterOutletComponent</code> est declarado en un mdulo del <em>framework</em> llamado <code>RouterModule</code>. Dicho mdulo fue importado de manera automtica durante la generacin del cdigo inicial, pero Dnde?.</p><p>Como digo el tema del enrutado es un <a href=\"../paginas-y-rutas-angular-spa/\">captulo aparte</a>, pero las relaciones de los mdulos debes conocerlas cuanto antes. Durante la generacin inicial se crearon dos mdulos: el <code>AppModule</code>, ya estudiado, y su asistente para enrutado <code>AppRoutingModule</code>. Este ltimo an no lo hemos visitado. Su contenido es:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Obviando la por ahora intil instruccin <code>.forRoutes(routes)</code>, llama la atencin que este mdulo es dependiente del famoso <code>RouterModule</code>, es decir lo importa en su array <code>imports:[]</code>. Pero adems va y lo exporta haciendo uso de la interesante <strong>propiedad transitiva de los mdulos</strong>. Cada mdulo puede exportar sus propios componentes o los de terceros. Incluso puede exportar todo un mdulo al completo. Al hacerlo as, el <code>AppRoutingModule</code> est poniendo a disposicin del <code>AppModule</code> todo el contenido de <code>RouterModule</code>, incluido el por ahora fastidioso <code>RouterOutletComponent</code>.</p><h2 id=\"4-2-Organizacion-de-la-aplicacion-en-modulos\"><a href=\"#4-2-Organizacion-de-la-aplicacion-en-modulos\" class=\"headerlink\" title=\"4.2 Organizacin de la aplicacin en mdulos\"></a>4.2 Organizacin de la aplicacin en mdulos</h2><p>Todos los programas tiene partes repetitivas. Los principios de <strong>organizacin y cdigo limpio</strong> nos permiten identificarlas y reutilizarlas. Con los componentes ocurre lo mismo. El mdulo y los componentes recin creados suelen ser comunes a casi todas las aplicaciones. Estos y otros muchos surgirn de manera natural durante el desarrollo de una aplicacin para ser utilizados en mltiples pginas.</p><p>Son <strong>componentes de infraestructura</strong>. Conviene guardarlos en una carpeta especial. Aqu la he llamado <em>shared</em>, pero <em>tools</em>, <em>common</em>, o <em>lib</em> suelen ser otros nombres habituales. Para reforzar tu prctica con el CLI escribe el siguiente comando que aprovecharemos en el futuro.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m shared</span><br><span class=\"line\">ng g c shared/go-home --<span class=\"built_in\">export</span>=<span class=\"literal\">true</span></span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"\"</span>&gt;</span> Go home <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y puedo usarlo por ejemplo en el Header</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ab-go-home</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-go-home</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span> &#123;&#123; title &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>En esta aplicacin hasta ahora no es nada funcional,!y ya tiene una docena de cosas entre mdulos y componentes!. Puede parecer sobre-ingeniera, pero a la larga le vers sentido. Por ahora te permitir practicar con la creacin de mdulos y componentes.</p></blockquote><h3 id=\"Un-ejemplo-practico-recopilatorio-para-la-pagina-home\"><a href=\"#Un-ejemplo-practico-recopilatorio-para-la-pagina-home\" class=\"headerlink\" title=\"Un ejemplo prctico recopilatorio para la pgina home.\"></a>Un ejemplo prctico recopilatorio para la pgina <em>home</em>.</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m home -m app.module.ts</span><br><span class=\"line\">ng g c home/home --<span class=\"built_in\">export</span> --flat</span><br></pre></td></tr></table></figure><h3 id=\"home-component-html\"><a href=\"#home-component-html\" class=\"headerlink\" title=\"home.component.html\"></a>home.component.html</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> Welcome  !<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">nav</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\"</span>&gt;</span> Curso de Introduccin<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://www.trainingit.es/curso-angular-avanzado/?promo=angular.builders\"</span>&gt;</span> Curso Avanzado<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y podemos incluir este componente en el contenido del layout del componente principal <code>AppComponent</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-header</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-header</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ab-nav</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-nav</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">article</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ab-home</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-home</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">article</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ab-aside</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-aside</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-footer</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-footer</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"El-bosque-de-modulos-a-vista-de-pajaro\"><a href=\"#El-bosque-de-modulos-a-vista-de-pajaro\" class=\"headerlink\" title=\"El bosque de mdulos a vista de pjaro\"></a>El bosque de mdulos a vista de pjaro</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AppModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--AppRoutingModule</span><br><span class=\"line\">|  |</span><br><span class=\"line\">|  +--RouterModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--BrowserModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--HomeModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--LayoutModule</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--CommonModule</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--RouterModule</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--SharedModule</span><br></pre></td></tr></table></figure><h3 id=\"El-bosque-de-componentes-a-vista-de-pajaro\"><a href=\"#El-bosque-de-componentes-a-vista-de-pajaro\" class=\"headerlink\" title=\"El bosque de componentes a vista de pjaro\"></a>El bosque de componentes a vista de pjaro</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AppComponent</span><br><span class=\"line\">  |</span><br><span class=\"line\">  +--HeaderComponent</span><br><span class=\"line\">  |</span><br><span class=\"line\">  +--NavComponent</span><br><span class=\"line\">  |</span><br><span class=\"line\">  +--RouterOutletComponent</span><br><span class=\"line\">  |</span><br><span class=\"line\">  +--HomeComponent</span><br><span class=\"line\">  |</span><br><span class=\"line\">  +--FooterComponent</span><br></pre></td></tr></table></figure><p>Con esto tendrs una base para una aplicacin <em>Angular 9</em>. Sigue esta serie para aadirle funcionalidad mediante <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a> mientras aprendes a programar con Angular9. Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Pginas y rutas Angular SPA","date":"2020-04-14T11:41:14.000Z","thumbnail":"/css/images/angular-2_spa.png","_content":"\n![paginas-y-rutas-angular-spa](/images/tutorial-angular-2_spa.png)\n\nLas **aplicaciones Angular 9 son conjuntos de pginas enrutadas** en el propio navegador. Son las conocidas _SPA, Single Page Applications_. Estas apps liberan al servidor de una parte del trabajo reduciendo la cantidad de llamadas y mejorando la percepcin de velocidad del usuario.\n\nEn este tutorial aprenders a crear una Angular SPA fcilmente usando `@angular/router`, **el enrutador de Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Base para una aplicacin Angular](../base-aplicacion-angular/). Seguimos usando el concepto de rbol, ahora como analoga de **las rutas y las vistas** asociadas. Al finalizar tendrs una angular SPA con vistas asociadas a sus rutas.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Rutas\n\nEs raro que una aplicacin web resuelva o exponga toda su funcionalidad e informacin e una nica vista. Lo habitual es que **se desplieguen mltiples pginas en distintas direrecciones**. Hasta hace unos aos la nica opcin era que el servidor procesase dicha ruta y remitiese el contenido listo para visualizar en el navegador.\n\nEsto significa mucho trabajo para el servidor, mucho contenido para la red y poca responsabilidad para los navegadores. Para las aplicaciones empresariales parece razonable distribuir esa carga, y **que sea el navegador el que prepare la vista** ejecutando instrucciones y solicitando datos.\n\nY una de las responsabilidades de las que se har cargo es la de **procesar las rutas y determinar cual ser la vista** que se deba mostrar en cada direccin. Veamos cmo lo resuelve Angular.\n\nAl crear la aplicacin hice uso del flag `routing` en el comando de generacin del _CLI_.\n\nRecordemos:\n\n```terminal\nng new angular-basic --routing\n```\n\nEsto caus la aparicin de no uno, sino dos mdulos gemelos en la raz de la aplicacin. Has estudiado el `AppModule` verdadero mdulo raz, y ahora vers en profundidad a su gemelo: el\n**mdulo de enrutado** `AppRoutingModule` y el uso que hace del `RouterModule`.\n\n## 1.1 RouterModule\n\nCon lo que hemos aprendido sobre mdulos y sus dependencias podemos entender que\n`AppRoutingModule` importa, configura y exportar al `RouterModule`. Y que a su vez `AppModule` al importar a `AppRoutingModule` dispone de todo lo necesario para realizar el enrutado.\n\nLa ruta de dependencias de mdulos queda tal que as:\n\n```\nRouterModule -> AppRoutingModule -> AppModule\n```\n\nHasta ahora los mdulos haban sido meros contendores. Algo similar a los espacios de nombres. Pero al ser clases puede tener cdigo y por tanto exponer funcionalidad. De hecho, el `RouterModule` expone un par de mtodos de configuracin. Se llaman `.forRoot(routes:Routes)` y `.forChild(routes:Routes)` y se usan a nivel raz o todas las dems situaciones respectivamente.\n\nAmbos reciben una estructura que mantiene un array de rutas y las instrucciones a ejecutar cuando dichas rutas se activen. Las rutas pueden ser estticas o usar comodines. Las acciones pueden ser de eleccin de componente para la vista, diferir el trabajo a otro mdulo o redirigir al usuario a otra ruta.\n\n### Mdulos componentes y rutas\n\nVemos un primer ejemplo para el enrutador a nivel raz. Partimos del par mdulo-componente para la pgina _Home_. Hasta ahora se vea en la aplicacin porque estaba incrustado a mano en medio del _layout_ principal.\n\nLo que haremos a continuacin es **asignar este componente a una ruta**, y que slo se vea cuando le toque a dicha ruta. Claro que en este caso es la ruta vaca, y por ahora es la nica as que no cambiar gran cosa. Pero, de este modo Angular sabr que mostrar en cada ruta para cuando hay ms.\n\n```typescript\nimport { Routes, RouterModule } from '@angular/router';\nimport { HomeComponent } from './home/home.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent,\n  }\n];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\n## 1.2 Router Outlet\n\nEl caso es que necesitamos mostrar un componente u otro en funcin de una ruta. Por tanto habr que eliminar la referencia explcita a `<ab-home>` y confiar en algo que ya estaba presente pero que no habamos estudiado, el `<router-outlet>`.\n\nEste es un componente que viene con el `RouterModule` y acta como un **contenedor dinmico**, incrustando el componente adecuado apara cada ruta. El contenido de `main.component.ts`, ahora ser dinmico\n\n```html\n<main>\n  <p>\n    Fork this <a href=\"https://github.com/AcademiaBinaria/angular-basic\">Repository</a>\n  </p>\n  <router-outlet></router-outlet>\n</main>\n```\n\n## 1.3 Router Link\n\nOtra novedad que podemos, y debemos, empezar a usar es la directiva `routerLink`. **Una directiva es una extensin del HTML propia de Angular.** Se emplea como si fuese un atributo de cualquier elemento y durante la compilacin genera el cdigo estndar necesario para que lo entiendan los navegadores.\n\nEn concreto esta directiva, que tambin viene en el mdulo `routerModule`, se usa en sustitucin del atributo estndar `href`. Inicialmente nos basta con saber que instruye al navegador para que no solicite la ruta al servidor, sino que el propio cdigo local de javaScript se encargar de procesarla.\n\nAs, por ejemplo en el nico y sencillo componente compartido del que disponemos, decidimos usarla para que las idas y venidas entre nuestras rutas no requieran de recarga en el servidor.\n\nEn el `src\\app\\shared\\go-home\\go-home.component.html`\n```html\n<a routerLink=\"\"> Go home </a>\n```\n\n> Recuerda, `routerLink` es una _Directiva_\n>>Como un atributo, pero con superpoderes\n\nPor ahora, _simplemente_ mantiene la gestin de las rutas en el lado del navegador.\n\n# 2 Lazy Loading\n\nTal com hemos procedido para la ruta vaca, podramos continuar con todas las dems. Por ejemplo una ruta muy comn sera la tpica _Acerca de_ o dicho en modo _url_: `/about`. Lo que haramos sera generarle un mdulo con un un componente y luego asignar dicho componente a la tabla de rutas con algo as:\n\n```typescript\nimport { Routes, RouterModule } from '@angular/router';\nimport { HomeComponent } from './home/home.component';\nimport { AboutComponent } from './about/about.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent,\n  },\n  {\n    path: 'about',\n    component: AboutUsComponent,\n  }\n];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nPodramos, pero no lo haremos. Por qu? Pues por una **cuestin de pesos y velocidad**. Tal como se ve en el cdigo, para poder asignar un componente a una ruta antes tenemos que haberlo importado. Y eso significa que parar a formar parte del cdigo que se _transpile_, empaquete y enve al navegador.\n\nEs decir, el sufrido usuario se va a **descargar la definicin de los componentes antes de visitarlos**. Es ms, se descargar componentes de rutas que quiz nunca visite. A esta tcnica se la conoce como _eager loading_ y, en general y hablando as a la bruto, debemos evitarla en favor de otra conocida como _lazy loading_.\n\n\n## 2.1 Webpack y los bundles por ruta\n\nPara implementarla se necesitan un par de cooperantes. En particular y sobre todo el empaquetador _Webpack_.\n\nEl objetivo es **diferir la descarga de las rutas no visitadas** y para ello querremos empaquetar cada ruta en un _bundle_. Esto requiere al menos un mdulo por ruta y adoptar un convenio especial para que  _webpack_ inicie nuevos empaquetados en mltiples puntos.\n\n### Crear los componentes en mdulos con enrutado\n\nPor complejo que suene en la prctica es muy sencillo. Basta con usar el comando adecuado del CLI. Por ejemplo para el caso del _Acerca de_ emplearamos una instruccin como esta:\n\n```bash\nng g m about --route=about -m app-routing.module.ts\n```\nNo es ms que la generacin de un nuevo mdulo pero con el _flag_ `--route=` que le indica al CLI que debe tratarlo como una nueva ruta. Este sper comando genera dos mdulos, un componente y adems los registra automticamente. Veamos el resultado:\n\nEn el mdulo de enrutado raz tenemos un nuevo camino, pero con una sintaxis distinta.\n\n```typescript\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent,\n  },\n  {\n    path: 'about',\n    loadChildren: () => import('./about/about.module').then(m => m.AboutModule),\n  },\n];\n```\n\nLo que dice es que cuando se active la ruta `about` entonces se le transfiera el control a otro mdulo mediante una instruccin asncrona. De esta forma ase consiguen dos cosas: por un lado al no usar ningn componente explcito no hay que importarlo; por otro lado la descarga del mdulo que resuelva el problema se ejecutar en segundo plano y slo si el usuario visita la ruta.\n\n## 2.2 El enrutador delegado\n\nClaro que slo hemos visto la mitad de la pelcula. La instruccin `loadChildren` delega el enrutado en otro mdulo; el `AboutModule` que fue creado por el cli. Dicho mdulo depende a su vez de otro de enrutamiento local, el `AboutRoutingModule`.\n\nEste mdulo de enrutamiento es similar al ya conocido `AppRoutingModule`, pero se activa y por tanto acta, a partir de una ruta ya procesada por su padre. Su contenido es similar a esto:\n\n\n```typescript\nimport { AboutComponent } from './about.component';\n\nconst routes: Routes = [{ path: '', component: AboutComponent }];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class AboutRoutingModule {}\n```\n\nTres cosas llaman la atencin. Para empezar la ruta est vaca de nuevo. Pero eso es por que se concatena a la anteriormente evaluada. Es decir, el segmento `about` est ya descontado. Segundo, a este nivel volvemos a indicar un componente concreto y por tanto necesitamos importarlo. Por ltimo y hablando de importaciones, el `RouterModule` se configura ahora como una rama hija del rbol de rutas principal. Lo hace con el mtodo `.forChild(routes: Routes)`.\n\n> Comprueba en ejecucin cmo se descargan los _bundles_ segn navegas.\n\n### La navegacin lazy permite la descarga diferida al navegar por las rutas.\n\n# 3. Rutas anidadas\n\nHay muchas situaciones que **por cuestiones de usabilidad anidamos navegaciones**. Por ejemplo una tienda online, te permite escoger categoras, y despus vistas distintas de sus productos como listados o fichas. En las aplicaciones de gestin es frecuente encontrarse con estructuras tipo tab o mens de actuacin parciales.\n\nEstas situaciones se resuelven la tecnologa denominada _nested routes_ y requiere del conocimiento de una nueva propiedad de las rutas.\n\n## 3.1 Children\n\nAntes de nada supongamos que en la pgina about queremos mostrar dos categoras de informacin. Por un lado enlaces de inters sobre esta aplicacin y por otro una informacin bsica sobre la misma.\n\nCrearamos por tanto un par de componentes como estos.\n\n```bash\nng g c about/about/links\nng g c about/about/info\n```\n\nPero, en lugar de asignarles ya un camino especfico a cada uno, lo que haremos ser incrustarlos como hijos del componente `AboutComponent`. Para ello escribimos algo as en `about-routing.module.ts`\n\n```typescript\nconst routes: Routes = [\n  {\n    path: '',\n    component: AboutComponent,\n    children: [\n      {\n        path: 'links',\n        component: LinksComponent\n      },\n      {\n        path: 'info',\n        component: InfoComponent\n      }\n    ]\n  }\n];\n```\n\nEsto es slo el primer paso.\n\n## 3.2 RouterOutlet anidado\n\nPara que los hijos acaben apareciendo dnde deben, hay que usar un segundo `<router-outlet>`. Esta vez dentro de la vista del componente padre. En `AboutComponent` :\n\n```html\n<h3>About us</h3>\n<header>\n  <p>\n    <a routerLink=\"links\"\n       class=\"button\"> Tutorial Links </ab-home>\n  </p>\n  <p>\n    <a routerLink=\"info\"\n       class=\"button\"> More Info </a>\n  </p>\n</header>\n<router-outlet></router-outlet>\n```\n\nAhora este componente acta como una micro aplicacin; con su men y su espacio de carga dinmica.\n\n# 4 Rutas paramtricas\n\nSi hay algo que poco tardar en aparecer ser la necesidad de presentar **informacin distinta pero con un formato similar**. De nuevo ejemplos archiconocidos sern una pgina para un producto, un artculo en un blog, una ficha de empleado o el seguimiento de un pedido.\n\nEn estas situaciones queremos que parte de la ruta identifique al elemento concreto que vamos a mostrar, y a ese identificador le llamaremos **parmetro**. Ojo, es similar pero no exactamente un `queryParameter`.\n\n## 4.1 Variables en la ruta\n\nPor ejemplo, supongamos una academia que quiere mostrar una lista de cursos y una pgina para cada uno. Para empezar crear un mdulo enrutado como este:\n\n```bash\nng g m courses --route=courses -m app-routing.module.ts\n```\n\nEntre otras cosas modificar el `AppRoutingModule` incrustando una nueva entrada como esta:\n\n```typescript\n{\n  path: 'courses',\n  loadChildren: () => import('./courses/courses.module').then(m => m.CoursesModule)\n},\n```\n\nPero nosotros despus vamos a realizar un cambio en la gestin local, incorporando un nuevo segmento al camino. Le asignamos el valor `:slug`.\n\n```typescript\nconst routes: Routes = [\n  {\n    path: ':slug',\n    component: CoursesComponent\n    }\n];\n```\n\nEn este caso el `:` indica que lo que viene no es un texto literal, si no **una variable**. Un parmetro en nuestro argot. El nombre es cosa del programador, el usuario nunca lo ver. En este caso me he decidido por usar el trmino _slug_ muy empleado para introducir ttulos dentro de las url.\n\nAhora ya resuelve rutas como: _/courses/introduccion_ o _/courses/avanzado_\n\nOtra cosa ser qu hacer cuando esas rutas se activen.\n\n## 4.2 ActivatedRoute\n\nEntramos quiz en la parte ms compleja, pero que como siempre es igual te la puedes tomar como una receta para todas tus aplicaciones.\n\nVeamos antes el contenido del fichero `courses.component.ts` relacionado con la obtencin del parmetro de la ruta activa:\n\n```typescript\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { environment } from '../../environments/environment';\n\nexport class CoursesComponent implements OnInit {\n  course: any;\n  constructor(route: ActivatedRoute) {\n    route.params.subscribe(params => {\n      const courseSlug = params.slug;\n      this.course = environment.courses.find(c => c.slug === courseSlug);\n    });\n  }\n  ngOnInit() {}\n}\n```\n\nPor partes, que es la primera vez que vemos tanto cdigo en este tutorial. Para empezar y ya que **los componentes son clases**, entonces podrn tener propiedades, mtodos y constructores. As que aparecen la propiedad `course:any` sin tipo concreto. Y el constructor que recibe una argumento de tipo `ActivatedRoute`\n\n**Angular adopta y promueve el uso de varios patones de arquitectura de software**. Uno de ellos es la inyeccin de dependencias, a la que dedicamos un tema en este tutorial. Por ahora nos basta con saber  que el framework nos inyectar una instancia de la clase `ActivatedRoute` en la variable argumento `route`.\n\nDespus viene un cdigo intimidante pero que tambin es siempre del mismo tipo. La dificultad radica en usar programacin asncrona, a la que tambin dedicamos ms de un tema. Simplificando, lo que nos dice es que si nos suscribimos a l, entonces nos notificar los cambios en los parmetros para que hagamos uso de ellos.\n\nEn este caso, buscamos el curso solicitado en un sencillo array. Y despus se lo mostramos al usuario con tcnicas de presentacin dinmica propias de Angular que tambin se ven ms adelante en este curso.\n\n```html\n<h3> {{ course.title }}</h3>\n<p>{{course.description}}</p>\n<p>\n  <a href=\"{{course.url}}\"\n     target=\"_blank\">{{course.url}}</a>\n</p>\n<p>\n  <ab-go-home></ab-go-home>\n</p>\n```\n\nEnlazamos todo cambiando los `href` del par de anclas del `HomeComponent`. Ahora usamos el enrutamiento local mediante `routerLink`.\n\n```html\n<h2> Welcome  !</h2>\n<nav>\n  <p>\n    <a routerLink=\"courses/introduccion\"> Introduccin</a>\n  </p>\n  <p>\n    <a routerLink=\"courses/avanzado\"> Avanzado</a>\n  </p>\n</nav>\n```\n\n# 5 Redirecciones\n\nHay situaciones en las que dada una ruta, queremos **enviar al usuario a otra pgina**. A veces por una simple decisin de renombrado de rutas. Otras quiz respondiendo a problemas o acciones inesperadas del usuario.\n\nPor ejemplo, vamos ver un tratamiento genrico del caso _not found_. Para empezar crearemos una ruta especfica para indicarle al usuario que la ruta que buscaba no existe.\n\n```terminal\nng g m not-found --route=not-found -m app-routing.module.ts\n```\n\nYa sabemos lo que ocurre. Un nuevo mdulo y una ruta diferida a nivel raz  `not-found`.\n\n```typescript\n{\n  path: 'not-found',\n  loadChildren: () => import('./not-found/not-found.module').then(m => m.NotFoundModule),\n},\n```\n\nQue localmente se asigna al componente `NotFoundComponent`.\n\n```typescript\n{\n  path: '',\n  component: NotFoundComponent,\n},\n```\n\n\n> Pero, nadie va voluntariamente a esa ruta\n\n>> Slo los que se pierden\n\nAs que hay que obligarles. Para eso usamos un nuevo comando de la configuracin de rutas, el `redirectTo`. Y lo asignamos a todas aquellas rutas desconocidas usando un el comodn `**`\n\n```typescript\n{\n  path: '**',\n  redirectTo: 'not-found'\n}\n```\n\nEsta entrada especial debe situarse **al final del _array_ de las rutas conocidas**. Angular evala la ruta actual contra todas las disponibles de arriba a abajo. La primer que resuelva el _match_ gana.\n\nEl conjunto de rutas de nuestra aplicacin a estas alturas queda como sigue:\n\n```typescript\nimport { Routes, RouterModule } from '@angular/router';\nimport { HomeComponent } from './home/home.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent,\n  },\n  {\n    path: 'about',\n    loadChildren: () => import('./about-us/about-us.module').then(m => m.AboutUsModule),\n  },\n  {\n    path: 'courses',\n    loadChildren: () => import('./courses/courses.module').then(m => m.CoursesModule)\n  },\n  {\n    path: 'not-found',\n    loadChildren: () => import('./not-found/not-found.module').then(m => m.NotFoundModule),\n  },\n  {\n    path: '**',\n    redirectTo: 'not-found',\n  },\n];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nLa parte vistosa es crear el contenido para el  `NotFoundComponent`.\n\n```html\n<h3>404</h3>\n<p>  not-found works!</p>\n<ab-go-home></ab-go-home>\n```\n\nCon esto tendrs una aplicacin SPA en _Angular_. Sigue esta serie para aadirle [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/) mientras aprendes a programar con Angular9.Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng_2-Paginas-y-rutas-Angular-SPA.md","raw":"---\ntitle: Pginas y rutas Angular SPA\npermalink: paginas-y-rutas-angular-spa\ndate: 2020-04-14 13:41:14\ntags:\n  - Angular\n  - SPA\n  - Routing\n  - Tutorial\n  - Introduccin\n  - Angular9\n  - Angular2\ncategories:\n  - [Tutorial, Angular]\nthumbnail: /css/images/angular-2_spa.png\n---\n\n![paginas-y-rutas-angular-spa](/images/tutorial-angular-2_spa.png)\n\nLas **aplicaciones Angular 9 son conjuntos de pginas enrutadas** en el propio navegador. Son las conocidas _SPA, Single Page Applications_. Estas apps liberan al servidor de una parte del trabajo reduciendo la cantidad de llamadas y mejorando la percepcin de velocidad del usuario.\n\nEn este tutorial aprenders a crear una Angular SPA fcilmente usando `@angular/router`, **el enrutador de Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal como qued en [Base para una aplicacin Angular](../base-aplicacion-angular/). Seguimos usando el concepto de rbol, ahora como analoga de **las rutas y las vistas** asociadas. Al finalizar tendrs una angular SPA con vistas asociadas a sus rutas.\n\n> Cdigo asociado a este tutorial en _GitHub_: [AcademiaBinaria/angular-basic](https://github.com/AcademiaBinaria/angular-basic/)\n\n# 1. Rutas\n\nEs raro que una aplicacin web resuelva o exponga toda su funcionalidad e informacin e una nica vista. Lo habitual es que **se desplieguen mltiples pginas en distintas direrecciones**. Hasta hace unos aos la nica opcin era que el servidor procesase dicha ruta y remitiese el contenido listo para visualizar en el navegador.\n\nEsto significa mucho trabajo para el servidor, mucho contenido para la red y poca responsabilidad para los navegadores. Para las aplicaciones empresariales parece razonable distribuir esa carga, y **que sea el navegador el que prepare la vista** ejecutando instrucciones y solicitando datos.\n\nY una de las responsabilidades de las que se har cargo es la de **procesar las rutas y determinar cual ser la vista** que se deba mostrar en cada direccin. Veamos cmo lo resuelve Angular.\n\nAl crear la aplicacin hice uso del flag `routing` en el comando de generacin del _CLI_.\n\nRecordemos:\n\n```terminal\nng new angular-basic --routing\n```\n\nEsto caus la aparicin de no uno, sino dos mdulos gemelos en la raz de la aplicacin. Has estudiado el `AppModule` verdadero mdulo raz, y ahora vers en profundidad a su gemelo: el\n**mdulo de enrutado** `AppRoutingModule` y el uso que hace del `RouterModule`.\n\n## 1.1 RouterModule\n\nCon lo que hemos aprendido sobre mdulos y sus dependencias podemos entender que\n`AppRoutingModule` importa, configura y exportar al `RouterModule`. Y que a su vez `AppModule` al importar a `AppRoutingModule` dispone de todo lo necesario para realizar el enrutado.\n\nLa ruta de dependencias de mdulos queda tal que as:\n\n```\nRouterModule -> AppRoutingModule -> AppModule\n```\n\nHasta ahora los mdulos haban sido meros contendores. Algo similar a los espacios de nombres. Pero al ser clases puede tener cdigo y por tanto exponer funcionalidad. De hecho, el `RouterModule` expone un par de mtodos de configuracin. Se llaman `.forRoot(routes:Routes)` y `.forChild(routes:Routes)` y se usan a nivel raz o todas las dems situaciones respectivamente.\n\nAmbos reciben una estructura que mantiene un array de rutas y las instrucciones a ejecutar cuando dichas rutas se activen. Las rutas pueden ser estticas o usar comodines. Las acciones pueden ser de eleccin de componente para la vista, diferir el trabajo a otro mdulo o redirigir al usuario a otra ruta.\n\n### Mdulos componentes y rutas\n\nVemos un primer ejemplo para el enrutador a nivel raz. Partimos del par mdulo-componente para la pgina _Home_. Hasta ahora se vea en la aplicacin porque estaba incrustado a mano en medio del _layout_ principal.\n\nLo que haremos a continuacin es **asignar este componente a una ruta**, y que slo se vea cuando le toque a dicha ruta. Claro que en este caso es la ruta vaca, y por ahora es la nica as que no cambiar gran cosa. Pero, de este modo Angular sabr que mostrar en cada ruta para cuando hay ms.\n\n```typescript\nimport { Routes, RouterModule } from '@angular/router';\nimport { HomeComponent } from './home/home.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent,\n  }\n];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\n## 1.2 Router Outlet\n\nEl caso es que necesitamos mostrar un componente u otro en funcin de una ruta. Por tanto habr que eliminar la referencia explcita a `<ab-home>` y confiar en algo que ya estaba presente pero que no habamos estudiado, el `<router-outlet>`.\n\nEste es un componente que viene con el `RouterModule` y acta como un **contenedor dinmico**, incrustando el componente adecuado apara cada ruta. El contenido de `main.component.ts`, ahora ser dinmico\n\n```html\n<main>\n  <p>\n    Fork this <a href=\"https://github.com/AcademiaBinaria/angular-basic\">Repository</a>\n  </p>\n  <router-outlet></router-outlet>\n</main>\n```\n\n## 1.3 Router Link\n\nOtra novedad que podemos, y debemos, empezar a usar es la directiva `routerLink`. **Una directiva es una extensin del HTML propia de Angular.** Se emplea como si fuese un atributo de cualquier elemento y durante la compilacin genera el cdigo estndar necesario para que lo entiendan los navegadores.\n\nEn concreto esta directiva, que tambin viene en el mdulo `routerModule`, se usa en sustitucin del atributo estndar `href`. Inicialmente nos basta con saber que instruye al navegador para que no solicite la ruta al servidor, sino que el propio cdigo local de javaScript se encargar de procesarla.\n\nAs, por ejemplo en el nico y sencillo componente compartido del que disponemos, decidimos usarla para que las idas y venidas entre nuestras rutas no requieran de recarga en el servidor.\n\nEn el `src\\app\\shared\\go-home\\go-home.component.html`\n```html\n<a routerLink=\"\"> Go home </a>\n```\n\n> Recuerda, `routerLink` es una _Directiva_\n>>Como un atributo, pero con superpoderes\n\nPor ahora, _simplemente_ mantiene la gestin de las rutas en el lado del navegador.\n\n# 2 Lazy Loading\n\nTal com hemos procedido para la ruta vaca, podramos continuar con todas las dems. Por ejemplo una ruta muy comn sera la tpica _Acerca de_ o dicho en modo _url_: `/about`. Lo que haramos sera generarle un mdulo con un un componente y luego asignar dicho componente a la tabla de rutas con algo as:\n\n```typescript\nimport { Routes, RouterModule } from '@angular/router';\nimport { HomeComponent } from './home/home.component';\nimport { AboutComponent } from './about/about.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent,\n  },\n  {\n    path: 'about',\n    component: AboutUsComponent,\n  }\n];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nPodramos, pero no lo haremos. Por qu? Pues por una **cuestin de pesos y velocidad**. Tal como se ve en el cdigo, para poder asignar un componente a una ruta antes tenemos que haberlo importado. Y eso significa que parar a formar parte del cdigo que se _transpile_, empaquete y enve al navegador.\n\nEs decir, el sufrido usuario se va a **descargar la definicin de los componentes antes de visitarlos**. Es ms, se descargar componentes de rutas que quiz nunca visite. A esta tcnica se la conoce como _eager loading_ y, en general y hablando as a la bruto, debemos evitarla en favor de otra conocida como _lazy loading_.\n\n\n## 2.1 Webpack y los bundles por ruta\n\nPara implementarla se necesitan un par de cooperantes. En particular y sobre todo el empaquetador _Webpack_.\n\nEl objetivo es **diferir la descarga de las rutas no visitadas** y para ello querremos empaquetar cada ruta en un _bundle_. Esto requiere al menos un mdulo por ruta y adoptar un convenio especial para que  _webpack_ inicie nuevos empaquetados en mltiples puntos.\n\n### Crear los componentes en mdulos con enrutado\n\nPor complejo que suene en la prctica es muy sencillo. Basta con usar el comando adecuado del CLI. Por ejemplo para el caso del _Acerca de_ emplearamos una instruccin como esta:\n\n```bash\nng g m about --route=about -m app-routing.module.ts\n```\nNo es ms que la generacin de un nuevo mdulo pero con el _flag_ `--route=` que le indica al CLI que debe tratarlo como una nueva ruta. Este sper comando genera dos mdulos, un componente y adems los registra automticamente. Veamos el resultado:\n\nEn el mdulo de enrutado raz tenemos un nuevo camino, pero con una sintaxis distinta.\n\n```typescript\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent,\n  },\n  {\n    path: 'about',\n    loadChildren: () => import('./about/about.module').then(m => m.AboutModule),\n  },\n];\n```\n\nLo que dice es que cuando se active la ruta `about` entonces se le transfiera el control a otro mdulo mediante una instruccin asncrona. De esta forma ase consiguen dos cosas: por un lado al no usar ningn componente explcito no hay que importarlo; por otro lado la descarga del mdulo que resuelva el problema se ejecutar en segundo plano y slo si el usuario visita la ruta.\n\n## 2.2 El enrutador delegado\n\nClaro que slo hemos visto la mitad de la pelcula. La instruccin `loadChildren` delega el enrutado en otro mdulo; el `AboutModule` que fue creado por el cli. Dicho mdulo depende a su vez de otro de enrutamiento local, el `AboutRoutingModule`.\n\nEste mdulo de enrutamiento es similar al ya conocido `AppRoutingModule`, pero se activa y por tanto acta, a partir de una ruta ya procesada por su padre. Su contenido es similar a esto:\n\n\n```typescript\nimport { AboutComponent } from './about.component';\n\nconst routes: Routes = [{ path: '', component: AboutComponent }];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class AboutRoutingModule {}\n```\n\nTres cosas llaman la atencin. Para empezar la ruta est vaca de nuevo. Pero eso es por que se concatena a la anteriormente evaluada. Es decir, el segmento `about` est ya descontado. Segundo, a este nivel volvemos a indicar un componente concreto y por tanto necesitamos importarlo. Por ltimo y hablando de importaciones, el `RouterModule` se configura ahora como una rama hija del rbol de rutas principal. Lo hace con el mtodo `.forChild(routes: Routes)`.\n\n> Comprueba en ejecucin cmo se descargan los _bundles_ segn navegas.\n\n### La navegacin lazy permite la descarga diferida al navegar por las rutas.\n\n# 3. Rutas anidadas\n\nHay muchas situaciones que **por cuestiones de usabilidad anidamos navegaciones**. Por ejemplo una tienda online, te permite escoger categoras, y despus vistas distintas de sus productos como listados o fichas. En las aplicaciones de gestin es frecuente encontrarse con estructuras tipo tab o mens de actuacin parciales.\n\nEstas situaciones se resuelven la tecnologa denominada _nested routes_ y requiere del conocimiento de una nueva propiedad de las rutas.\n\n## 3.1 Children\n\nAntes de nada supongamos que en la pgina about queremos mostrar dos categoras de informacin. Por un lado enlaces de inters sobre esta aplicacin y por otro una informacin bsica sobre la misma.\n\nCrearamos por tanto un par de componentes como estos.\n\n```bash\nng g c about/about/links\nng g c about/about/info\n```\n\nPero, en lugar de asignarles ya un camino especfico a cada uno, lo que haremos ser incrustarlos como hijos del componente `AboutComponent`. Para ello escribimos algo as en `about-routing.module.ts`\n\n```typescript\nconst routes: Routes = [\n  {\n    path: '',\n    component: AboutComponent,\n    children: [\n      {\n        path: 'links',\n        component: LinksComponent\n      },\n      {\n        path: 'info',\n        component: InfoComponent\n      }\n    ]\n  }\n];\n```\n\nEsto es slo el primer paso.\n\n## 3.2 RouterOutlet anidado\n\nPara que los hijos acaben apareciendo dnde deben, hay que usar un segundo `<router-outlet>`. Esta vez dentro de la vista del componente padre. En `AboutComponent` :\n\n```html\n<h3>About us</h3>\n<header>\n  <p>\n    <a routerLink=\"links\"\n       class=\"button\"> Tutorial Links </ab-home>\n  </p>\n  <p>\n    <a routerLink=\"info\"\n       class=\"button\"> More Info </a>\n  </p>\n</header>\n<router-outlet></router-outlet>\n```\n\nAhora este componente acta como una micro aplicacin; con su men y su espacio de carga dinmica.\n\n# 4 Rutas paramtricas\n\nSi hay algo que poco tardar en aparecer ser la necesidad de presentar **informacin distinta pero con un formato similar**. De nuevo ejemplos archiconocidos sern una pgina para un producto, un artculo en un blog, una ficha de empleado o el seguimiento de un pedido.\n\nEn estas situaciones queremos que parte de la ruta identifique al elemento concreto que vamos a mostrar, y a ese identificador le llamaremos **parmetro**. Ojo, es similar pero no exactamente un `queryParameter`.\n\n## 4.1 Variables en la ruta\n\nPor ejemplo, supongamos una academia que quiere mostrar una lista de cursos y una pgina para cada uno. Para empezar crear un mdulo enrutado como este:\n\n```bash\nng g m courses --route=courses -m app-routing.module.ts\n```\n\nEntre otras cosas modificar el `AppRoutingModule` incrustando una nueva entrada como esta:\n\n```typescript\n{\n  path: 'courses',\n  loadChildren: () => import('./courses/courses.module').then(m => m.CoursesModule)\n},\n```\n\nPero nosotros despus vamos a realizar un cambio en la gestin local, incorporando un nuevo segmento al camino. Le asignamos el valor `:slug`.\n\n```typescript\nconst routes: Routes = [\n  {\n    path: ':slug',\n    component: CoursesComponent\n    }\n];\n```\n\nEn este caso el `:` indica que lo que viene no es un texto literal, si no **una variable**. Un parmetro en nuestro argot. El nombre es cosa del programador, el usuario nunca lo ver. En este caso me he decidido por usar el trmino _slug_ muy empleado para introducir ttulos dentro de las url.\n\nAhora ya resuelve rutas como: _/courses/introduccion_ o _/courses/avanzado_\n\nOtra cosa ser qu hacer cuando esas rutas se activen.\n\n## 4.2 ActivatedRoute\n\nEntramos quiz en la parte ms compleja, pero que como siempre es igual te la puedes tomar como una receta para todas tus aplicaciones.\n\nVeamos antes el contenido del fichero `courses.component.ts` relacionado con la obtencin del parmetro de la ruta activa:\n\n```typescript\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { environment } from '../../environments/environment';\n\nexport class CoursesComponent implements OnInit {\n  course: any;\n  constructor(route: ActivatedRoute) {\n    route.params.subscribe(params => {\n      const courseSlug = params.slug;\n      this.course = environment.courses.find(c => c.slug === courseSlug);\n    });\n  }\n  ngOnInit() {}\n}\n```\n\nPor partes, que es la primera vez que vemos tanto cdigo en este tutorial. Para empezar y ya que **los componentes son clases**, entonces podrn tener propiedades, mtodos y constructores. As que aparecen la propiedad `course:any` sin tipo concreto. Y el constructor que recibe una argumento de tipo `ActivatedRoute`\n\n**Angular adopta y promueve el uso de varios patones de arquitectura de software**. Uno de ellos es la inyeccin de dependencias, a la que dedicamos un tema en este tutorial. Por ahora nos basta con saber  que el framework nos inyectar una instancia de la clase `ActivatedRoute` en la variable argumento `route`.\n\nDespus viene un cdigo intimidante pero que tambin es siempre del mismo tipo. La dificultad radica en usar programacin asncrona, a la que tambin dedicamos ms de un tema. Simplificando, lo que nos dice es que si nos suscribimos a l, entonces nos notificar los cambios en los parmetros para que hagamos uso de ellos.\n\nEn este caso, buscamos el curso solicitado en un sencillo array. Y despus se lo mostramos al usuario con tcnicas de presentacin dinmica propias de Angular que tambin se ven ms adelante en este curso.\n\n```html\n<h3> {{ course.title }}</h3>\n<p>{{course.description}}</p>\n<p>\n  <a href=\"{{course.url}}\"\n     target=\"_blank\">{{course.url}}</a>\n</p>\n<p>\n  <ab-go-home></ab-go-home>\n</p>\n```\n\nEnlazamos todo cambiando los `href` del par de anclas del `HomeComponent`. Ahora usamos el enrutamiento local mediante `routerLink`.\n\n```html\n<h2> Welcome  !</h2>\n<nav>\n  <p>\n    <a routerLink=\"courses/introduccion\"> Introduccin</a>\n  </p>\n  <p>\n    <a routerLink=\"courses/avanzado\"> Avanzado</a>\n  </p>\n</nav>\n```\n\n# 5 Redirecciones\n\nHay situaciones en las que dada una ruta, queremos **enviar al usuario a otra pgina**. A veces por una simple decisin de renombrado de rutas. Otras quiz respondiendo a problemas o acciones inesperadas del usuario.\n\nPor ejemplo, vamos ver un tratamiento genrico del caso _not found_. Para empezar crearemos una ruta especfica para indicarle al usuario que la ruta que buscaba no existe.\n\n```terminal\nng g m not-found --route=not-found -m app-routing.module.ts\n```\n\nYa sabemos lo que ocurre. Un nuevo mdulo y una ruta diferida a nivel raz  `not-found`.\n\n```typescript\n{\n  path: 'not-found',\n  loadChildren: () => import('./not-found/not-found.module').then(m => m.NotFoundModule),\n},\n```\n\nQue localmente se asigna al componente `NotFoundComponent`.\n\n```typescript\n{\n  path: '',\n  component: NotFoundComponent,\n},\n```\n\n\n> Pero, nadie va voluntariamente a esa ruta\n\n>> Slo los que se pierden\n\nAs que hay que obligarles. Para eso usamos un nuevo comando de la configuracin de rutas, el `redirectTo`. Y lo asignamos a todas aquellas rutas desconocidas usando un el comodn `**`\n\n```typescript\n{\n  path: '**',\n  redirectTo: 'not-found'\n}\n```\n\nEsta entrada especial debe situarse **al final del _array_ de las rutas conocidas**. Angular evala la ruta actual contra todas las disponibles de arriba a abajo. La primer que resuelva el _match_ gana.\n\nEl conjunto de rutas de nuestra aplicacin a estas alturas queda como sigue:\n\n```typescript\nimport { Routes, RouterModule } from '@angular/router';\nimport { HomeComponent } from './home/home.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent,\n  },\n  {\n    path: 'about',\n    loadChildren: () => import('./about-us/about-us.module').then(m => m.AboutUsModule),\n  },\n  {\n    path: 'courses',\n    loadChildren: () => import('./courses/courses.module').then(m => m.CoursesModule)\n  },\n  {\n    path: 'not-found',\n    loadChildren: () => import('./not-found/not-found.module').then(m => m.NotFoundModule),\n  },\n  {\n    path: '**',\n    redirectTo: 'not-found',\n  },\n];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nLa parte vistosa es crear el contenido para el  `NotFoundComponent`.\n\n```html\n<h3>404</h3>\n<p>  not-found works!</p>\n<ab-go-home></ab-go-home>\n```\n\nCon esto tendrs una aplicacin SPA en _Angular_. Sigue esta serie para aadirle [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/) mientras aprendes a programar con Angular9.Todos esos detalles se tratan en el [curso bsico online](https://www.trainingit.es/curso-angular-basico/?promo=angular.builders) que imparto con TrainingIT o a medida para tu empresa.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"paginas-y-rutas-angular-spa","published":1,"updated":"2020-04-14T11:38:06.875Z","_id":"ck70mab200012bss3ayjzqo7y","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-2_spa.png\" alt=\"paginas-y-rutas-angular-spa\"></p><p>Las <strong>aplicaciones Angular 9 son conjuntos de pginas enrutadas</strong> en el propio navegador. Son las conocidas <em>SPA, Single Page Applications</em>. Estas apps liberan al servidor de una parte del trabajo reduciendo la cantidad de llamadas y mejorando la percepcin de velocidad del usuario.</p><p>En este tutorial aprenders a crear una Angular SPA fcilmente usando <code>@angular/router</code>, <strong>el enrutador de Angular</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal como qued en <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a>. Seguimos usando el concepto de rbol, ahora como analoga de <strong>las rutas y las vistas</strong> asociadas. Al finalizar tendrs una angular SPA con vistas asociadas a sus rutas.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Rutas\"><a href=\"#1-Rutas\" class=\"headerlink\" title=\"1. Rutas\"></a>1. Rutas</h1><p>Es raro que una aplicacin web resuelva o exponga toda su funcionalidad e informacin e una nica vista. Lo habitual es que <strong>se desplieguen mltiples pginas en distintas direrecciones</strong>. Hasta hace unos aos la nica opcin era que el servidor procesase dicha ruta y remitiese el contenido listo para visualizar en el navegador.</p><p>Esto significa mucho trabajo para el servidor, mucho contenido para la red y poca responsabilidad para los navegadores. Para las aplicaciones empresariales parece razonable distribuir esa carga, y <strong>que sea el navegador el que prepare la vista</strong> ejecutando instrucciones y solicitando datos.</p><p>Y una de las responsabilidades de las que se har cargo es la de <strong>procesar las rutas y determinar cual ser la vista</strong> que se deba mostrar en cada direccin. Veamos cmo lo resuelve Angular.</p><p>Al crear la aplicacin hice uso del flag <code>routing</code> en el comando de generacin del <em>CLI</em>.</p><p>Recordemos:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new angular-basic --routing</span><br></pre></td></tr></table></figure><p>Esto caus la aparicin de no uno, sino dos mdulos gemelos en la raz de la aplicacin. Has estudiado el <code>AppModule</code> verdadero mdulo raz, y ahora vers en profundidad a su gemelo: el<br><strong>mdulo de enrutado</strong> <code>AppRoutingModule</code> y el uso que hace del <code>RouterModule</code>.</p><h2 id=\"1-1-RouterModule\"><a href=\"#1-1-RouterModule\" class=\"headerlink\" title=\"1.1 RouterModule\"></a>1.1 RouterModule</h2><p>Con lo que hemos aprendido sobre mdulos y sus dependencias podemos entender que<br><code>AppRoutingModule</code> importa, configura y exportar al <code>RouterModule</code>. Y que a su vez <code>AppModule</code> al importar a <code>AppRoutingModule</code> dispone de todo lo necesario para realizar el enrutado.</p><p>La ruta de dependencias de mdulos queda tal que as:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RouterModule -&gt; AppRoutingModule -&gt; AppModule</span><br></pre></td></tr></table></figure><p>Hasta ahora los mdulos haban sido meros contendores. Algo similar a los espacios de nombres. Pero al ser clases puede tener cdigo y por tanto exponer funcionalidad. De hecho, el <code>RouterModule</code> expone un par de mtodos de configuracin. Se llaman <code>.forRoot(routes:Routes)</code> y <code>.forChild(routes:Routes)</code> y se usan a nivel raz o todas las dems situaciones respectivamente.</p><p>Ambos reciben una estructura que mantiene un array de rutas y las instrucciones a ejecutar cuando dichas rutas se activen. Las rutas pueden ser estticas o usar comodines. Las acciones pueden ser de eleccin de componente para la vista, diferir el trabajo a otro mdulo o redirigir al usuario a otra ruta.</p><h3 id=\"Modulos-componentes-y-rutas\"><a href=\"#Modulos-componentes-y-rutas\" class=\"headerlink\" title=\"Mdulos componentes y rutas\"></a>Mdulos componentes y rutas</h3><p>Vemos un primer ejemplo para el enrutador a nivel raz. Partimos del par mdulo-componente para la pgina <em>Home</em>. Hasta ahora se vea en la aplicacin porque estaba incrustado a mano en medio del <em>layout</em> principal.</p><p>Lo que haremos a continuacin es <strong>asignar este componente a una ruta</strong>, y que slo se vea cuando le toque a dicha ruta. Claro que en este caso es la ruta vaca, y por ahora es la nica as que no cambiar gran cosa. Pero, de este modo Angular sabr que mostrar en cada ruta para cuando hay ms.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; HomeComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home/home.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent,</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><h2 id=\"1-2-Router-Outlet\"><a href=\"#1-2-Router-Outlet\" class=\"headerlink\" title=\"1.2 Router Outlet\"></a>1.2 Router Outlet</h2><p>El caso es que necesitamos mostrar un componente u otro en funcin de una ruta. Por tanto habr que eliminar la referencia explcita a <code>&lt;ab-home&gt;</code> y confiar en algo que ya estaba presente pero que no habamos estudiado, el <code>&lt;router-outlet&gt;</code>.</p><p>Este es un componente que viene con el <code>RouterModule</code> y acta como un <strong>contenedor dinmico</strong>, incrustando el componente adecuado apara cada ruta. El contenido de <code>main.component.ts</code>, ahora ser dinmico</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    Fork this <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://github.com/AcademiaBinaria/angular-basic\"</span>&gt;</span>Repository<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">main</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-3-Router-Link\"><a href=\"#1-3-Router-Link\" class=\"headerlink\" title=\"1.3 Router Link\"></a>1.3 Router Link</h2><p>Otra novedad que podemos, y debemos, empezar a usar es la directiva <code>routerLink</code>. <strong>Una directiva es una extensin del HTML propia de Angular.</strong> Se emplea como si fuese un atributo de cualquier elemento y durante la compilacin genera el cdigo estndar necesario para que lo entiendan los navegadores.</p><p>En concreto esta directiva, que tambin viene en el mdulo <code>routerModule</code>, se usa en sustitucin del atributo estndar <code>href</code>. Inicialmente nos basta con saber que instruye al navegador para que no solicite la ruta al servidor, sino que el propio cdigo local de javaScript se encargar de procesarla.</p><p>As, por ejemplo en el nico y sencillo componente compartido del que disponemos, decidimos usarla para que las idas y venidas entre nuestras rutas no requieran de recarga en el servidor.</p><p>En el <code>src\\app\\shared\\go-home\\go-home.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"\"</span>&gt;</span> Go home <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Recuerda, <code>routerLink</code> es una <em>Directiva</em></p><blockquote><p>Como un atributo, pero con superpoderes</p></blockquote></blockquote><p>Por ahora, <em>simplemente</em> mantiene la gestin de las rutas en el lado del navegador.</p><h1 id=\"2-Lazy-Loading\"><a href=\"#2-Lazy-Loading\" class=\"headerlink\" title=\"2 Lazy Loading\"></a>2 Lazy Loading</h1><p>Tal com hemos procedido para la ruta vaca, podramos continuar con todas las dems. Por ejemplo una ruta muy comn sera la tpica <em>Acerca de</em> o dicho en modo <em>url</em>: <code>/about</code>. Lo que haramos sera generarle un mdulo con un un componente y luego asignar dicho componente a la tabla de rutas con algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; HomeComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home/home.component'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AboutComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./about/about.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'about'</span>,</span><br><span class=\"line\">    component: AboutUsComponent,</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Podramos, pero no lo haremos. Por qu? Pues por una <strong>cuestin de pesos y velocidad</strong>. Tal como se ve en el cdigo, para poder asignar un componente a una ruta antes tenemos que haberlo importado. Y eso significa que parar a formar parte del cdigo que se <em>transpile</em>, empaquete y enve al navegador.</p><p>Es decir, el sufrido usuario se va a <strong>descargar la definicin de los componentes antes de visitarlos</strong>. Es ms, se descargar componentes de rutas que quiz nunca visite. A esta tcnica se la conoce como <em>eager loading</em> y, en general y hablando as a la bruto, debemos evitarla en favor de otra conocida como <em>lazy loading</em>.</p><h2 id=\"2-1-Webpack-y-los-bundles-por-ruta\"><a href=\"#2-1-Webpack-y-los-bundles-por-ruta\" class=\"headerlink\" title=\"2.1 Webpack y los bundles por ruta\"></a>2.1 Webpack y los bundles por ruta</h2><p>Para implementarla se necesitan un par de cooperantes. En particular y sobre todo el empaquetador <em>Webpack</em>.</p><p>El objetivo es <strong>diferir la descarga de las rutas no visitadas</strong> y para ello querremos empaquetar cada ruta en un <em>bundle</em>. Esto requiere al menos un mdulo por ruta y adoptar un convenio especial para que <em>webpack</em> inicie nuevos empaquetados en mltiples puntos.</p><h3 id=\"Crear-los-componentes-en-modulos-con-enrutado\"><a href=\"#Crear-los-componentes-en-modulos-con-enrutado\" class=\"headerlink\" title=\"Crear los componentes en mdulos con enrutado\"></a>Crear los componentes en mdulos con enrutado</h3><p>Por complejo que suene en la prctica es muy sencillo. Basta con usar el comando adecuado del CLI. Por ejemplo para el caso del <em>Acerca de</em> emplearamos una instruccin como esta:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m about --route=about -m app-routing.module.ts</span><br></pre></td></tr></table></figure><p>No es ms que la generacin de un nuevo mdulo pero con el <em>flag</em> <code>--route=</code> que le indica al CLI que debe tratarlo como una nueva ruta. Este sper comando genera dos mdulos, un componente y adems los registra automticamente. Veamos el resultado:</p><p>En el mdulo de enrutado raz tenemos un nuevo camino, pero con una sintaxis distinta.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'about'</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./about/about.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.AboutModule),</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>Lo que dice es que cuando se active la ruta <code>about</code> entonces se le transfiera el control a otro mdulo mediante una instruccin asncrona. De esta forma ase consiguen dos cosas: por un lado al no usar ningn componente explcito no hay que importarlo; por otro lado la descarga del mdulo que resuelva el problema se ejecutar en segundo plano y slo si el usuario visita la ruta.</p><h2 id=\"2-2-El-enrutador-delegado\"><a href=\"#2-2-El-enrutador-delegado\" class=\"headerlink\" title=\"2.2 El enrutador delegado\"></a>2.2 El enrutador delegado</h2><p>Claro que slo hemos visto la mitad de la pelcula. La instruccin <code>loadChildren</code> delega el enrutado en otro mdulo; el <code>AboutModule</code> que fue creado por el cli. Dicho mdulo depende a su vez de otro de enrutamiento local, el <code>AboutRoutingModule</code>.</p><p>Este mdulo de enrutamiento es similar al ya conocido <code>AppRoutingModule</code>, pero se activa y por tanto acta, a partir de una ruta ya procesada por su padre. Su contenido es similar a esto:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; AboutComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./about.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [&#123; path: <span class=\"string\">''</span>, component: AboutComponent &#125;];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forChild(routes)],</span><br><span class=\"line\">  exports: [RouterModule],</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AboutRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Tres cosas llaman la atencin. Para empezar la ruta est vaca de nuevo. Pero eso es por que se concatena a la anteriormente evaluada. Es decir, el segmento <code>about</code> est ya descontado. Segundo, a este nivel volvemos a indicar un componente concreto y por tanto necesitamos importarlo. Por ltimo y hablando de importaciones, el <code>RouterModule</code> se configura ahora como una rama hija del rbol de rutas principal. Lo hace con el mtodo <code>.forChild(routes: Routes)</code>.</p><blockquote><p>Comprueba en ejecucin cmo se descargan los <em>bundles</em> segn navegas.</p></blockquote><h3 id=\"La-navegacion-lazy-permite-la-descarga-diferida-al-navegar-por-las-rutas\"><a href=\"#La-navegacion-lazy-permite-la-descarga-diferida-al-navegar-por-las-rutas\" class=\"headerlink\" title=\"La navegacin lazy permite la descarga diferida al navegar por las rutas.\"></a>La navegacin lazy permite la descarga diferida al navegar por las rutas.</h3><h1 id=\"3-Rutas-anidadas\"><a href=\"#3-Rutas-anidadas\" class=\"headerlink\" title=\"3. Rutas anidadas\"></a>3. Rutas anidadas</h1><p>Hay muchas situaciones que <strong>por cuestiones de usabilidad anidamos navegaciones</strong>. Por ejemplo una tienda online, te permite escoger categoras, y despus vistas distintas de sus productos como listados o fichas. En las aplicaciones de gestin es frecuente encontrarse con estructuras tipo tab o mens de actuacin parciales.</p><p>Estas situaciones se resuelven la tecnologa denominada <em>nested routes</em> y requiere del conocimiento de una nueva propiedad de las rutas.</p><h2 id=\"3-1-Children\"><a href=\"#3-1-Children\" class=\"headerlink\" title=\"3.1 Children\"></a>3.1 Children</h2><p>Antes de nada supongamos que en la pgina about queremos mostrar dos categoras de informacin. Por un lado enlaces de inters sobre esta aplicacin y por otro una informacin bsica sobre la misma.</p><p>Crearamos por tanto un par de componentes como estos.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c about/about/links</span><br><span class=\"line\">ng g c about/about/info</span><br></pre></td></tr></table></figure><p>Pero, en lugar de asignarles ya un camino especfico a cada uno, lo que haremos ser incrustarlos como hijos del componente <code>AboutComponent</code>. Para ello escribimos algo as en <code>about-routing.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: AboutComponent,</span><br><span class=\"line\">    children: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        path: <span class=\"string\">'links'</span>,</span><br><span class=\"line\">        component: LinksComponent</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        path: <span class=\"string\">'info'</span>,</span><br><span class=\"line\">        component: InfoComponent</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>Esto es slo el primer paso.</p><h2 id=\"3-2-RouterOutlet-anidado\"><a href=\"#3-2-RouterOutlet-anidado\" class=\"headerlink\" title=\"3.2 RouterOutlet anidado\"></a>3.2 RouterOutlet anidado</h2><p>Para que los hijos acaben apareciendo dnde deben, hay que usar un segundo <code>&lt;router-outlet&gt;</code>. Esta vez dentro de la vista del componente padre. En <code>AboutComponent</code> :</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>About us<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"links\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> Tutorial Links <span class=\"tag\">&lt;/<span class=\"name\">ab-home</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"info\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> More Info <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Ahora este componente acta como una micro aplicacin; con su men y su espacio de carga dinmica.</p><h1 id=\"4-Rutas-parametricas\"><a href=\"#4-Rutas-parametricas\" class=\"headerlink\" title=\"4 Rutas paramtricas\"></a>4 Rutas paramtricas</h1><p>Si hay algo que poco tardar en aparecer ser la necesidad de presentar <strong>informacin distinta pero con un formato similar</strong>. De nuevo ejemplos archiconocidos sern una pgina para un producto, un artculo en un blog, una ficha de empleado o el seguimiento de un pedido.</p><p>En estas situaciones queremos que parte de la ruta identifique al elemento concreto que vamos a mostrar, y a ese identificador le llamaremos <strong>parmetro</strong>. Ojo, es similar pero no exactamente un <code>queryParameter</code>.</p><h2 id=\"4-1-Variables-en-la-ruta\"><a href=\"#4-1-Variables-en-la-ruta\" class=\"headerlink\" title=\"4.1 Variables en la ruta\"></a>4.1 Variables en la ruta</h2><p>Por ejemplo, supongamos una academia que quiere mostrar una lista de cursos y una pgina para cada uno. Para empezar crear un mdulo enrutado como este:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m courses --route=courses -m app-routing.module.ts</span><br></pre></td></tr></table></figure><p>Entre otras cosas modificar el <code>AppRoutingModule</code> incrustando una nueva entrada como esta:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'courses'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./courses/courses.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.CoursesModule)</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><p>Pero nosotros despus vamos a realizar un cambio en la gestin local, incorporando un nuevo segmento al camino. Le asignamos el valor <code>:slug</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">':slug'</span>,</span><br><span class=\"line\">    component: CoursesComponent</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>En este caso el <code>:</code> indica que lo que viene no es un texto literal, si no <strong>una variable</strong>. Un parmetro en nuestro argot. El nombre es cosa del programador, el usuario nunca lo ver. En este caso me he decidido por usar el trmino <em>slug</em> muy empleado para introducir ttulos dentro de las url.</p><p>Ahora ya resuelve rutas como: <em>/courses/introduccion</em> o <em>/courses/avanzado</em></p><p>Otra cosa ser qu hacer cuando esas rutas se activen.</p><h2 id=\"4-2-ActivatedRoute\"><a href=\"#4-2-ActivatedRoute\" class=\"headerlink\" title=\"4.2 ActivatedRoute\"></a>4.2 ActivatedRoute</h2><p>Entramos quiz en la parte ms compleja, pero que como siempre es igual te la puedes tomar como una receta para todas tus aplicaciones.</p><p>Veamos antes el contenido del fichero <code>courses.component.ts</code> relacionado con la obtencin del parmetro de la ruta activa:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; ActivatedRoute &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; environment &#125; <span class=\"keyword\">from</span> <span class=\"string\">'../../environments/environment'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CoursesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  course: <span class=\"built_in\">any</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\">route: ActivatedRoute</span>) &#123;</span><br><span class=\"line\">    route.params.subscribe(<span class=\"function\"><span class=\"params\">params</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> courseSlug = params.slug;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.course = environment.courses.find(<span class=\"function\"><span class=\"params\">c</span> =&gt;</span> c.slug === courseSlug);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Por partes, que es la primera vez que vemos tanto cdigo en este tutorial. Para empezar y ya que <strong>los componentes son clases</strong>, entonces podrn tener propiedades, mtodos y constructores. As que aparecen la propiedad <code>course:any</code> sin tipo concreto. Y el constructor que recibe una argumento de tipo <code>ActivatedRoute</code></p><p><strong>Angular adopta y promueve el uso de varios patones de arquitectura de software</strong>. Uno de ellos es la inyeccin de dependencias, a la que dedicamos un tema en este tutorial. Por ahora nos basta con saber que el framework nos inyectar una instancia de la clase <code>ActivatedRoute</code> en la variable argumento <code>route</code>.</p><p>Despus viene un cdigo intimidante pero que tambin es siempre del mismo tipo. La dificultad radica en usar programacin asncrona, a la que tambin dedicamos ms de un tema. Simplificando, lo que nos dice es que si nos suscribimos a l, entonces nos notificar los cambios en los parmetros para que hagamos uso de ellos.</p><p>En este caso, buscamos el curso solicitado en un sencillo array. Y despus se lo mostramos al usuario con tcnicas de presentacin dinmica propias de Angular que tambin se ven ms adelante en este curso.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> &#123;&#123; course.title &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123;course.description&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"&#123;&#123;course.url&#125;&#125;\"</span></span></span><br><span class=\"line\"><span class=\"tag\">     <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span>&gt;</span>&#123;&#123;course.url&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ab-go-home</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-go-home</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Enlazamos todo cambiando los <code>href</code> del par de anclas del <code>HomeComponent</code>. Ahora usamos el enrutamiento local mediante <code>routerLink</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> Welcome  !<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">nav</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"courses/introduccion\"</span>&gt;</span> Introduccin<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"courses/avanzado\"</span>&gt;</span> Avanzado<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"5-Redirecciones\"><a href=\"#5-Redirecciones\" class=\"headerlink\" title=\"5 Redirecciones\"></a>5 Redirecciones</h1><p>Hay situaciones en las que dada una ruta, queremos <strong>enviar al usuario a otra pgina</strong>. A veces por una simple decisin de renombrado de rutas. Otras quiz respondiendo a problemas o acciones inesperadas del usuario.</p><p>Por ejemplo, vamos ver un tratamiento genrico del caso <em>not found</em>. Para empezar crearemos una ruta especfica para indicarle al usuario que la ruta que buscaba no existe.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m not-found --route&#x3D;not-found -m app-routing.module.ts</span><br></pre></td></tr></table></figure><p>Ya sabemos lo que ocurre. Un nuevo mdulo y una ruta diferida a nivel raz <code>not-found</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'not-found'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./not-found/not-found.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.NotFoundModule),</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><p>Que localmente se asigna al componente <code>NotFoundComponent</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">''</span>,</span><br><span class=\"line\">  component: NotFoundComponent,</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><blockquote><p>Pero, nadie va voluntariamente a esa ruta</p></blockquote><blockquote><blockquote><p>Slo los que se pierden</p></blockquote></blockquote><p>As que hay que obligarles. Para eso usamos un nuevo comando de la configuracin de rutas, el <code>redirectTo</code>. Y lo asignamos a todas aquellas rutas desconocidas usando un el comodn <code>**</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">  redirectTo: <span class=\"string\">'not-found'</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Esta entrada especial debe situarse <strong>al final del <em>array</em> de las rutas conocidas</strong>. Angular evala la ruta actual contra todas las disponibles de arriba a abajo. La primer que resuelva el <em>match</em> gana.</p><p>El conjunto de rutas de nuestra aplicacin a estas alturas queda como sigue:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; HomeComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home/home.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'about'</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./about-us/about-us.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.AboutUsModule),</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'courses'</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./courses/courses.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.CoursesModule)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'not-found'</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./not-found/not-found.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.NotFoundModule),</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'not-found'</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>La parte vistosa es crear el contenido para el <code>NotFoundComponent</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>404<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>  not-found works!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-go-home</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-go-home</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Con esto tendrs una aplicacin SPA en <em>Angular</em>. Sigue esta serie para aadirle <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a> mientras aprendes a programar con Angular9.Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-2_spa.png\" alt=\"paginas-y-rutas-angular-spa\"></p><p>Las <strong>aplicaciones Angular 9 son conjuntos de pginas enrutadas</strong> en el propio navegador. Son las conocidas <em>SPA, Single Page Applications</em>. Estas apps liberan al servidor de una parte del trabajo reduciendo la cantidad de llamadas y mejorando la percepcin de velocidad del usuario.</p><p>En este tutorial aprenders a crear una Angular SPA fcilmente usando <code>@angular/router</code>, <strong>el enrutador de Angular</strong>.</p>","more":"<p>Partiendo de la aplicacin tal como qued en <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a>. Seguimos usando el concepto de rbol, ahora como analoga de <strong>las rutas y las vistas</strong> asociadas. Al finalizar tendrs una angular SPA con vistas asociadas a sus rutas.</p><blockquote><p>Cdigo asociado a este tutorial en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-basic/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-basic</a></p></blockquote><h1 id=\"1-Rutas\"><a href=\"#1-Rutas\" class=\"headerlink\" title=\"1. Rutas\"></a>1. Rutas</h1><p>Es raro que una aplicacin web resuelva o exponga toda su funcionalidad e informacin e una nica vista. Lo habitual es que <strong>se desplieguen mltiples pginas en distintas direrecciones</strong>. Hasta hace unos aos la nica opcin era que el servidor procesase dicha ruta y remitiese el contenido listo para visualizar en el navegador.</p><p>Esto significa mucho trabajo para el servidor, mucho contenido para la red y poca responsabilidad para los navegadores. Para las aplicaciones empresariales parece razonable distribuir esa carga, y <strong>que sea el navegador el que prepare la vista</strong> ejecutando instrucciones y solicitando datos.</p><p>Y una de las responsabilidades de las que se har cargo es la de <strong>procesar las rutas y determinar cual ser la vista</strong> que se deba mostrar en cada direccin. Veamos cmo lo resuelve Angular.</p><p>Al crear la aplicacin hice uso del flag <code>routing</code> en el comando de generacin del <em>CLI</em>.</p><p>Recordemos:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new angular-basic --routing</span><br></pre></td></tr></table></figure><p>Esto caus la aparicin de no uno, sino dos mdulos gemelos en la raz de la aplicacin. Has estudiado el <code>AppModule</code> verdadero mdulo raz, y ahora vers en profundidad a su gemelo: el<br><strong>mdulo de enrutado</strong> <code>AppRoutingModule</code> y el uso que hace del <code>RouterModule</code>.</p><h2 id=\"1-1-RouterModule\"><a href=\"#1-1-RouterModule\" class=\"headerlink\" title=\"1.1 RouterModule\"></a>1.1 RouterModule</h2><p>Con lo que hemos aprendido sobre mdulos y sus dependencias podemos entender que<br><code>AppRoutingModule</code> importa, configura y exportar al <code>RouterModule</code>. Y que a su vez <code>AppModule</code> al importar a <code>AppRoutingModule</code> dispone de todo lo necesario para realizar el enrutado.</p><p>La ruta de dependencias de mdulos queda tal que as:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RouterModule -&gt; AppRoutingModule -&gt; AppModule</span><br></pre></td></tr></table></figure><p>Hasta ahora los mdulos haban sido meros contendores. Algo similar a los espacios de nombres. Pero al ser clases puede tener cdigo y por tanto exponer funcionalidad. De hecho, el <code>RouterModule</code> expone un par de mtodos de configuracin. Se llaman <code>.forRoot(routes:Routes)</code> y <code>.forChild(routes:Routes)</code> y se usan a nivel raz o todas las dems situaciones respectivamente.</p><p>Ambos reciben una estructura que mantiene un array de rutas y las instrucciones a ejecutar cuando dichas rutas se activen. Las rutas pueden ser estticas o usar comodines. Las acciones pueden ser de eleccin de componente para la vista, diferir el trabajo a otro mdulo o redirigir al usuario a otra ruta.</p><h3 id=\"Modulos-componentes-y-rutas\"><a href=\"#Modulos-componentes-y-rutas\" class=\"headerlink\" title=\"Mdulos componentes y rutas\"></a>Mdulos componentes y rutas</h3><p>Vemos un primer ejemplo para el enrutador a nivel raz. Partimos del par mdulo-componente para la pgina <em>Home</em>. Hasta ahora se vea en la aplicacin porque estaba incrustado a mano en medio del <em>layout</em> principal.</p><p>Lo que haremos a continuacin es <strong>asignar este componente a una ruta</strong>, y que slo se vea cuando le toque a dicha ruta. Claro que en este caso es la ruta vaca, y por ahora es la nica as que no cambiar gran cosa. Pero, de este modo Angular sabr que mostrar en cada ruta para cuando hay ms.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; HomeComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home/home.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent,</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><h2 id=\"1-2-Router-Outlet\"><a href=\"#1-2-Router-Outlet\" class=\"headerlink\" title=\"1.2 Router Outlet\"></a>1.2 Router Outlet</h2><p>El caso es que necesitamos mostrar un componente u otro en funcin de una ruta. Por tanto habr que eliminar la referencia explcita a <code>&lt;ab-home&gt;</code> y confiar en algo que ya estaba presente pero que no habamos estudiado, el <code>&lt;router-outlet&gt;</code>.</p><p>Este es un componente que viene con el <code>RouterModule</code> y acta como un <strong>contenedor dinmico</strong>, incrustando el componente adecuado apara cada ruta. El contenido de <code>main.component.ts</code>, ahora ser dinmico</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">main</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    Fork this <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://github.com/AcademiaBinaria/angular-basic\"</span>&gt;</span>Repository<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">main</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-3-Router-Link\"><a href=\"#1-3-Router-Link\" class=\"headerlink\" title=\"1.3 Router Link\"></a>1.3 Router Link</h2><p>Otra novedad que podemos, y debemos, empezar a usar es la directiva <code>routerLink</code>. <strong>Una directiva es una extensin del HTML propia de Angular.</strong> Se emplea como si fuese un atributo de cualquier elemento y durante la compilacin genera el cdigo estndar necesario para que lo entiendan los navegadores.</p><p>En concreto esta directiva, que tambin viene en el mdulo <code>routerModule</code>, se usa en sustitucin del atributo estndar <code>href</code>. Inicialmente nos basta con saber que instruye al navegador para que no solicite la ruta al servidor, sino que el propio cdigo local de javaScript se encargar de procesarla.</p><p>As, por ejemplo en el nico y sencillo componente compartido del que disponemos, decidimos usarla para que las idas y venidas entre nuestras rutas no requieran de recarga en el servidor.</p><p>En el <code>src\\app\\shared\\go-home\\go-home.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"\"</span>&gt;</span> Go home <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Recuerda, <code>routerLink</code> es una <em>Directiva</em></p><blockquote><p>Como un atributo, pero con superpoderes</p></blockquote></blockquote><p>Por ahora, <em>simplemente</em> mantiene la gestin de las rutas en el lado del navegador.</p><h1 id=\"2-Lazy-Loading\"><a href=\"#2-Lazy-Loading\" class=\"headerlink\" title=\"2 Lazy Loading\"></a>2 Lazy Loading</h1><p>Tal com hemos procedido para la ruta vaca, podramos continuar con todas las dems. Por ejemplo una ruta muy comn sera la tpica <em>Acerca de</em> o dicho en modo <em>url</em>: <code>/about</code>. Lo que haramos sera generarle un mdulo con un un componente y luego asignar dicho componente a la tabla de rutas con algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; HomeComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home/home.component'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AboutComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./about/about.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'about'</span>,</span><br><span class=\"line\">    component: AboutUsComponent,</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Podramos, pero no lo haremos. Por qu? Pues por una <strong>cuestin de pesos y velocidad</strong>. Tal como se ve en el cdigo, para poder asignar un componente a una ruta antes tenemos que haberlo importado. Y eso significa que parar a formar parte del cdigo que se <em>transpile</em>, empaquete y enve al navegador.</p><p>Es decir, el sufrido usuario se va a <strong>descargar la definicin de los componentes antes de visitarlos</strong>. Es ms, se descargar componentes de rutas que quiz nunca visite. A esta tcnica se la conoce como <em>eager loading</em> y, en general y hablando as a la bruto, debemos evitarla en favor de otra conocida como <em>lazy loading</em>.</p><h2 id=\"2-1-Webpack-y-los-bundles-por-ruta\"><a href=\"#2-1-Webpack-y-los-bundles-por-ruta\" class=\"headerlink\" title=\"2.1 Webpack y los bundles por ruta\"></a>2.1 Webpack y los bundles por ruta</h2><p>Para implementarla se necesitan un par de cooperantes. En particular y sobre todo el empaquetador <em>Webpack</em>.</p><p>El objetivo es <strong>diferir la descarga de las rutas no visitadas</strong> y para ello querremos empaquetar cada ruta en un <em>bundle</em>. Esto requiere al menos un mdulo por ruta y adoptar un convenio especial para que <em>webpack</em> inicie nuevos empaquetados en mltiples puntos.</p><h3 id=\"Crear-los-componentes-en-modulos-con-enrutado\"><a href=\"#Crear-los-componentes-en-modulos-con-enrutado\" class=\"headerlink\" title=\"Crear los componentes en mdulos con enrutado\"></a>Crear los componentes en mdulos con enrutado</h3><p>Por complejo que suene en la prctica es muy sencillo. Basta con usar el comando adecuado del CLI. Por ejemplo para el caso del <em>Acerca de</em> emplearamos una instruccin como esta:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m about --route=about -m app-routing.module.ts</span><br></pre></td></tr></table></figure><p>No es ms que la generacin de un nuevo mdulo pero con el <em>flag</em> <code>--route=</code> que le indica al CLI que debe tratarlo como una nueva ruta. Este sper comando genera dos mdulos, un componente y adems los registra automticamente. Veamos el resultado:</p><p>En el mdulo de enrutado raz tenemos un nuevo camino, pero con una sintaxis distinta.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'about'</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./about/about.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.AboutModule),</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>Lo que dice es que cuando se active la ruta <code>about</code> entonces se le transfiera el control a otro mdulo mediante una instruccin asncrona. De esta forma ase consiguen dos cosas: por un lado al no usar ningn componente explcito no hay que importarlo; por otro lado la descarga del mdulo que resuelva el problema se ejecutar en segundo plano y slo si el usuario visita la ruta.</p><h2 id=\"2-2-El-enrutador-delegado\"><a href=\"#2-2-El-enrutador-delegado\" class=\"headerlink\" title=\"2.2 El enrutador delegado\"></a>2.2 El enrutador delegado</h2><p>Claro que slo hemos visto la mitad de la pelcula. La instruccin <code>loadChildren</code> delega el enrutado en otro mdulo; el <code>AboutModule</code> que fue creado por el cli. Dicho mdulo depende a su vez de otro de enrutamiento local, el <code>AboutRoutingModule</code>.</p><p>Este mdulo de enrutamiento es similar al ya conocido <code>AppRoutingModule</code>, pero se activa y por tanto acta, a partir de una ruta ya procesada por su padre. Su contenido es similar a esto:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; AboutComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./about.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [&#123; path: <span class=\"string\">''</span>, component: AboutComponent &#125;];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forChild(routes)],</span><br><span class=\"line\">  exports: [RouterModule],</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AboutRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Tres cosas llaman la atencin. Para empezar la ruta est vaca de nuevo. Pero eso es por que se concatena a la anteriormente evaluada. Es decir, el segmento <code>about</code> est ya descontado. Segundo, a este nivel volvemos a indicar un componente concreto y por tanto necesitamos importarlo. Por ltimo y hablando de importaciones, el <code>RouterModule</code> se configura ahora como una rama hija del rbol de rutas principal. Lo hace con el mtodo <code>.forChild(routes: Routes)</code>.</p><blockquote><p>Comprueba en ejecucin cmo se descargan los <em>bundles</em> segn navegas.</p></blockquote><h3 id=\"La-navegacion-lazy-permite-la-descarga-diferida-al-navegar-por-las-rutas\"><a href=\"#La-navegacion-lazy-permite-la-descarga-diferida-al-navegar-por-las-rutas\" class=\"headerlink\" title=\"La navegacin lazy permite la descarga diferida al navegar por las rutas.\"></a>La navegacin lazy permite la descarga diferida al navegar por las rutas.</h3><h1 id=\"3-Rutas-anidadas\"><a href=\"#3-Rutas-anidadas\" class=\"headerlink\" title=\"3. Rutas anidadas\"></a>3. Rutas anidadas</h1><p>Hay muchas situaciones que <strong>por cuestiones de usabilidad anidamos navegaciones</strong>. Por ejemplo una tienda online, te permite escoger categoras, y despus vistas distintas de sus productos como listados o fichas. En las aplicaciones de gestin es frecuente encontrarse con estructuras tipo tab o mens de actuacin parciales.</p><p>Estas situaciones se resuelven la tecnologa denominada <em>nested routes</em> y requiere del conocimiento de una nueva propiedad de las rutas.</p><h2 id=\"3-1-Children\"><a href=\"#3-1-Children\" class=\"headerlink\" title=\"3.1 Children\"></a>3.1 Children</h2><p>Antes de nada supongamos que en la pgina about queremos mostrar dos categoras de informacin. Por un lado enlaces de inters sobre esta aplicacin y por otro una informacin bsica sobre la misma.</p><p>Crearamos por tanto un par de componentes como estos.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c about/about/links</span><br><span class=\"line\">ng g c about/about/info</span><br></pre></td></tr></table></figure><p>Pero, en lugar de asignarles ya un camino especfico a cada uno, lo que haremos ser incrustarlos como hijos del componente <code>AboutComponent</code>. Para ello escribimos algo as en <code>about-routing.module.ts</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: AboutComponent,</span><br><span class=\"line\">    children: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        path: <span class=\"string\">'links'</span>,</span><br><span class=\"line\">        component: LinksComponent</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        path: <span class=\"string\">'info'</span>,</span><br><span class=\"line\">        component: InfoComponent</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>Esto es slo el primer paso.</p><h2 id=\"3-2-RouterOutlet-anidado\"><a href=\"#3-2-RouterOutlet-anidado\" class=\"headerlink\" title=\"3.2 RouterOutlet anidado\"></a>3.2 RouterOutlet anidado</h2><p>Para que los hijos acaben apareciendo dnde deben, hay que usar un segundo <code>&lt;router-outlet&gt;</code>. Esta vez dentro de la vista del componente padre. En <code>AboutComponent</code> :</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>About us<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"links\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> Tutorial Links <span class=\"tag\">&lt;/<span class=\"name\">ab-home</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"info\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> More Info <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Ahora este componente acta como una micro aplicacin; con su men y su espacio de carga dinmica.</p><h1 id=\"4-Rutas-parametricas\"><a href=\"#4-Rutas-parametricas\" class=\"headerlink\" title=\"4 Rutas paramtricas\"></a>4 Rutas paramtricas</h1><p>Si hay algo que poco tardar en aparecer ser la necesidad de presentar <strong>informacin distinta pero con un formato similar</strong>. De nuevo ejemplos archiconocidos sern una pgina para un producto, un artculo en un blog, una ficha de empleado o el seguimiento de un pedido.</p><p>En estas situaciones queremos que parte de la ruta identifique al elemento concreto que vamos a mostrar, y a ese identificador le llamaremos <strong>parmetro</strong>. Ojo, es similar pero no exactamente un <code>queryParameter</code>.</p><h2 id=\"4-1-Variables-en-la-ruta\"><a href=\"#4-1-Variables-en-la-ruta\" class=\"headerlink\" title=\"4.1 Variables en la ruta\"></a>4.1 Variables en la ruta</h2><p>Por ejemplo, supongamos una academia que quiere mostrar una lista de cursos y una pgina para cada uno. Para empezar crear un mdulo enrutado como este:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m courses --route=courses -m app-routing.module.ts</span><br></pre></td></tr></table></figure><p>Entre otras cosas modificar el <code>AppRoutingModule</code> incrustando una nueva entrada como esta:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'courses'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./courses/courses.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.CoursesModule)</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><p>Pero nosotros despus vamos a realizar un cambio en la gestin local, incorporando un nuevo segmento al camino. Le asignamos el valor <code>:slug</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">':slug'</span>,</span><br><span class=\"line\">    component: CoursesComponent</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>En este caso el <code>:</code> indica que lo que viene no es un texto literal, si no <strong>una variable</strong>. Un parmetro en nuestro argot. El nombre es cosa del programador, el usuario nunca lo ver. En este caso me he decidido por usar el trmino <em>slug</em> muy empleado para introducir ttulos dentro de las url.</p><p>Ahora ya resuelve rutas como: <em>/courses/introduccion</em> o <em>/courses/avanzado</em></p><p>Otra cosa ser qu hacer cuando esas rutas se activen.</p><h2 id=\"4-2-ActivatedRoute\"><a href=\"#4-2-ActivatedRoute\" class=\"headerlink\" title=\"4.2 ActivatedRoute\"></a>4.2 ActivatedRoute</h2><p>Entramos quiz en la parte ms compleja, pero que como siempre es igual te la puedes tomar como una receta para todas tus aplicaciones.</p><p>Veamos antes el contenido del fichero <code>courses.component.ts</code> relacionado con la obtencin del parmetro de la ruta activa:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; ActivatedRoute &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; environment &#125; <span class=\"keyword\">from</span> <span class=\"string\">'../../environments/environment'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CoursesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  course: <span class=\"built_in\">any</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\">route: ActivatedRoute</span>) &#123;</span><br><span class=\"line\">    route.params.subscribe(<span class=\"function\"><span class=\"params\">params</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> courseSlug = params.slug;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.course = environment.courses.find(<span class=\"function\"><span class=\"params\">c</span> =&gt;</span> c.slug === courseSlug);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Por partes, que es la primera vez que vemos tanto cdigo en este tutorial. Para empezar y ya que <strong>los componentes son clases</strong>, entonces podrn tener propiedades, mtodos y constructores. As que aparecen la propiedad <code>course:any</code> sin tipo concreto. Y el constructor que recibe una argumento de tipo <code>ActivatedRoute</code></p><p><strong>Angular adopta y promueve el uso de varios patones de arquitectura de software</strong>. Uno de ellos es la inyeccin de dependencias, a la que dedicamos un tema en este tutorial. Por ahora nos basta con saber que el framework nos inyectar una instancia de la clase <code>ActivatedRoute</code> en la variable argumento <code>route</code>.</p><p>Despus viene un cdigo intimidante pero que tambin es siempre del mismo tipo. La dificultad radica en usar programacin asncrona, a la que tambin dedicamos ms de un tema. Simplificando, lo que nos dice es que si nos suscribimos a l, entonces nos notificar los cambios en los parmetros para que hagamos uso de ellos.</p><p>En este caso, buscamos el curso solicitado en un sencillo array. Y despus se lo mostramos al usuario con tcnicas de presentacin dinmica propias de Angular que tambin se ven ms adelante en este curso.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> &#123;&#123; course.title &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123;course.description&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"&#123;&#123;course.url&#125;&#125;\"</span></span></span><br><span class=\"line\"><span class=\"tag\">     <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span>&gt;</span>&#123;&#123;course.url&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ab-go-home</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-go-home</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Enlazamos todo cambiando los <code>href</code> del par de anclas del <code>HomeComponent</code>. Ahora usamos el enrutamiento local mediante <code>routerLink</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> Welcome  !<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">nav</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"courses/introduccion\"</span>&gt;</span> Introduccin<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"courses/avanzado\"</span>&gt;</span> Avanzado<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"5-Redirecciones\"><a href=\"#5-Redirecciones\" class=\"headerlink\" title=\"5 Redirecciones\"></a>5 Redirecciones</h1><p>Hay situaciones en las que dada una ruta, queremos <strong>enviar al usuario a otra pgina</strong>. A veces por una simple decisin de renombrado de rutas. Otras quiz respondiendo a problemas o acciones inesperadas del usuario.</p><p>Por ejemplo, vamos ver un tratamiento genrico del caso <em>not found</em>. Para empezar crearemos una ruta especfica para indicarle al usuario que la ruta que buscaba no existe.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m not-found --route&#x3D;not-found -m app-routing.module.ts</span><br></pre></td></tr></table></figure><p>Ya sabemos lo que ocurre. Un nuevo mdulo y una ruta diferida a nivel raz <code>not-found</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'not-found'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./not-found/not-found.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.NotFoundModule),</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><p>Que localmente se asigna al componente <code>NotFoundComponent</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">''</span>,</span><br><span class=\"line\">  component: NotFoundComponent,</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><blockquote><p>Pero, nadie va voluntariamente a esa ruta</p></blockquote><blockquote><blockquote><p>Slo los que se pierden</p></blockquote></blockquote><p>As que hay que obligarles. Para eso usamos un nuevo comando de la configuracin de rutas, el <code>redirectTo</code>. Y lo asignamos a todas aquellas rutas desconocidas usando un el comodn <code>**</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">  redirectTo: <span class=\"string\">'not-found'</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Esta entrada especial debe situarse <strong>al final del <em>array</em> de las rutas conocidas</strong>. Angular evala la ruta actual contra todas las disponibles de arriba a abajo. La primer que resuelva el <em>match</em> gana.</p><p>El conjunto de rutas de nuestra aplicacin a estas alturas queda como sigue:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; HomeComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home/home.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'about'</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./about-us/about-us.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.AboutUsModule),</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'courses'</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./courses/courses.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.CoursesModule)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'not-found'</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">import</span>(<span class=\"string\">'./not-found/not-found.module'</span>).then(<span class=\"function\"><span class=\"params\">m</span> =&gt;</span> m.NotFoundModule),</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'not-found'</span>,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>La parte vistosa es crear el contenido para el <code>NotFoundComponent</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>404<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>  not-found works!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ab-go-home</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ab-go-home</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Con esto tendrs una aplicacin SPA en <em>Angular</em>. Sigue esta serie para aadirle <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a> mientras aprendes a programar con Angular9.Todos esos detalles se tratan en el <a href=\"https://www.trainingit.es/curso-angular-basico/?promo=angular.builders\" target=\"_blank\" rel=\"noopener\">curso bsico online</a> que imparto con TrainingIT o a medida para tu empresa.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"npm: de instalador a publicador","id":"10","updated":"2016-04-19T05:01:25.000Z","date":"2016-04-18T14:07:46.000Z","_content":"\nSeguro que ests harto de repetir la mtica instruccin `npm install paquete-x` Pero, has pensado en **publicar tus propios mdulos**?. Es muy recomendable crear soluciones distribuidas y muy fcil publicarlas en [*npm*](https://www.npmjs.com/).\n\nSigue este proceso y te convertirs en un creador de paquetes para *npm* :\n\n## Programa\n\nTodo empieza por tener una necesidad y resolverla **encapsulando su cdigo en un mdulo.** Por supuesto que ese mdulo puede requerir paquetes externos. Y por supuesto que tu cdigo puede, y debe, escribirse en varios mdulos.\n\nAntes de continuar vamos a fijar un par de conceptos:\n\n**- mdulo:** Fichero *.js* que exporta un funcionalidad y oculta su implementacin.\n\n**- paquete:** Uno o ms mdulos, con sus dependientes de otros paquetes que proponen una solucin reutilizable.\n\nConocidos los ingredientes, la receta es sencilla:\n\n1. Debes crear un proyecto para el paquete que vas a publicar.\n2. Has de subir el cdigo a un repositorio pblico.\n3. Y debes rellenar convenientemente el `package.json` de tu proyecto.\n\nEste es un ejemplo que he creado y [publicado en github](https://github.com/AgoraBinaria/ab-ftp) que te puede servir de base.\n\nPresta especial atencin al **nombrado** de tu proyecto porque ha de ser nico en el repositorio de npm. Para reducir riesgos de colisiones de nombre te recomiendo que utilices un *prefijo* con tus iniciales o las de tu empresa.\n\nNo te olvides de incluir un juego de **pruebas y documentacin** necesaria para sus uso.\n\n## Publica\n\nPuedes descargar libreras y herramienta desde el repositorio de *npm* de forma annima. De hecho, eso es lo ms corriente. Pero, como era de esperar, tienes que **registrarte para poder publicar** contenido. El [proceso de registro](https://www.npmjs.com/signup) va web es sencillo y grtis.\n\nUna vez verificado puedes hacer login en la web. Pero tambin en la terminal de tu ordenador: `npm login` te pedir el nombre de usuario y contrasea. A partir de es momento ests identificado y puedes usar las herramientas de autor:\n\n```\nnpm publish\n```\n\nPuedes encontrar [ms informacin](https://docs.npmjs.com/cli/publish) acerca de este mega comando en la documentacin de *npmjs*. Pero siguiendo la mxima de cuanto menos, mejor, la herramienta har con sus valores por defecto un publicacin y actualizacin limpias.\n\nLa clave est en que tu fichero de configuracin `package.json` sea correcto y lo ms completo posible. Escribe un completo `readme.md` que se convertir en portada de tu paquete en el repositorio de npm. Mira en mi ejemplo cmo [el contenido subido a github](https://github.com/AgoraBinaria/ab-ftp) se transforma y se ve en la [pgina de informacin de npm.](https://www.npmjs.com/package/ab-ftp)\n\n\nComprueba en un directorio vaco que `npm install nombre-de-tu-paquete` descarga todo lo necesario... y tmate un caf mientras ves crecer la hierba y las estadsticas de descargas.\n\n\n## Actualiza\n\nCon el tiempo mejorars y corregirs tu solucin. Te recomiendo que sigas el patrn de [nombrado de versiones semntico](http://semver.org/):\n\n**x.y.z = 1.2.3 = ruptura.mejora.parche**\n\nEs bueno que etiquetes tu repositorio con estas mismas versiones para que, una vez desplegadas, se encuentre con facilidad en *github*.\n\n```\ngit tag 0.1.2\ngit push --tags\n```\n\n\n## Disfruta\n\nFinalmente podrs utilizar ese cdigo en todas tus aplicaciones. Sera fantstico que adems otros lo encontrasen til. Y mejor an si te ayudan o al menos te proponen mejoras. Pero en cualquier caso **siempre habrs ganado**. El esfuerzo analtico que requiere se cobra con creces: dividiendo el problema, creando micro soluciones eficientes y reutilizando cdigo siempre es rentable.","source":"_posts/npm-de-instalador-a-publicador.md","raw":"---\ntitle: 'npm: de instalador a publicador'\ntags:\n- NodeJS\n- Avanzado\npermalink: npm-de-instalador-a-publicador\nid: 10\nupdated: '2016-04-19 07:01:25'\ndate: 2016-04-18 16:07:46\n---\n\nSeguro que ests harto de repetir la mtica instruccin `npm install paquete-x` Pero, has pensado en **publicar tus propios mdulos**?. Es muy recomendable crear soluciones distribuidas y muy fcil publicarlas en [*npm*](https://www.npmjs.com/).\n\nSigue este proceso y te convertirs en un creador de paquetes para *npm* :\n\n## Programa\n\nTodo empieza por tener una necesidad y resolverla **encapsulando su cdigo en un mdulo.** Por supuesto que ese mdulo puede requerir paquetes externos. Y por supuesto que tu cdigo puede, y debe, escribirse en varios mdulos.\n\nAntes de continuar vamos a fijar un par de conceptos:\n\n**- mdulo:** Fichero *.js* que exporta un funcionalidad y oculta su implementacin.\n\n**- paquete:** Uno o ms mdulos, con sus dependientes de otros paquetes que proponen una solucin reutilizable.\n\nConocidos los ingredientes, la receta es sencilla:\n\n1. Debes crear un proyecto para el paquete que vas a publicar.\n2. Has de subir el cdigo a un repositorio pblico.\n3. Y debes rellenar convenientemente el `package.json` de tu proyecto.\n\nEste es un ejemplo que he creado y [publicado en github](https://github.com/AgoraBinaria/ab-ftp) que te puede servir de base.\n\nPresta especial atencin al **nombrado** de tu proyecto porque ha de ser nico en el repositorio de npm. Para reducir riesgos de colisiones de nombre te recomiendo que utilices un *prefijo* con tus iniciales o las de tu empresa.\n\nNo te olvides de incluir un juego de **pruebas y documentacin** necesaria para sus uso.\n\n## Publica\n\nPuedes descargar libreras y herramienta desde el repositorio de *npm* de forma annima. De hecho, eso es lo ms corriente. Pero, como era de esperar, tienes que **registrarte para poder publicar** contenido. El [proceso de registro](https://www.npmjs.com/signup) va web es sencillo y grtis.\n\nUna vez verificado puedes hacer login en la web. Pero tambin en la terminal de tu ordenador: `npm login` te pedir el nombre de usuario y contrasea. A partir de es momento ests identificado y puedes usar las herramientas de autor:\n\n```\nnpm publish\n```\n\nPuedes encontrar [ms informacin](https://docs.npmjs.com/cli/publish) acerca de este mega comando en la documentacin de *npmjs*. Pero siguiendo la mxima de cuanto menos, mejor, la herramienta har con sus valores por defecto un publicacin y actualizacin limpias.\n\nLa clave est en que tu fichero de configuracin `package.json` sea correcto y lo ms completo posible. Escribe un completo `readme.md` que se convertir en portada de tu paquete en el repositorio de npm. Mira en mi ejemplo cmo [el contenido subido a github](https://github.com/AgoraBinaria/ab-ftp) se transforma y se ve en la [pgina de informacin de npm.](https://www.npmjs.com/package/ab-ftp)\n\n\nComprueba en un directorio vaco que `npm install nombre-de-tu-paquete` descarga todo lo necesario... y tmate un caf mientras ves crecer la hierba y las estadsticas de descargas.\n\n\n## Actualiza\n\nCon el tiempo mejorars y corregirs tu solucin. Te recomiendo que sigas el patrn de [nombrado de versiones semntico](http://semver.org/):\n\n**x.y.z = 1.2.3 = ruptura.mejora.parche**\n\nEs bueno que etiquetes tu repositorio con estas mismas versiones para que, una vez desplegadas, se encuentre con facilidad en *github*.\n\n```\ngit tag 0.1.2\ngit push --tags\n```\n\n\n## Disfruta\n\nFinalmente podrs utilizar ese cdigo en todas tus aplicaciones. Sera fantstico que adems otros lo encontrasen til. Y mejor an si te ayudan o al menos te proponen mejoras. Pero en cualquier caso **siempre habrs ganado**. El esfuerzo analtico que requiere se cobra con creces: dividiendo el problema, creando micro soluciones eficientes y reutilizando cdigo siempre es rentable.","slug":"npm-de-instalador-a-publicador","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ck70mab210013bss37leiwws8","content":"<p>Seguro que ests harto de repetir la mtica instruccin <code>npm install paquete-x</code> Pero, has pensado en <strong>publicar tus propios mdulos</strong>?. Es muy recomendable crear soluciones distribuidas y muy fcil publicarlas en <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"noopener\"><em>npm</em></a>.</p><p>Sigue este proceso y te convertirs en un creador de paquetes para <em>npm</em> :</p><h2 id=\"Programa\"><a href=\"#Programa\" class=\"headerlink\" title=\"Programa\"></a>Programa</h2><p>Todo empieza por tener una necesidad y resolverla <strong>encapsulando su cdigo en un mdulo.</strong> Por supuesto que ese mdulo puede requerir paquetes externos. Y por supuesto que tu cdigo puede, y debe, escribirse en varios mdulos.</p><p>Antes de continuar vamos a fijar un par de conceptos:</p><p><strong>- mdulo:</strong> Fichero <em>.js</em> que exporta un funcionalidad y oculta su implementacin.</p><p><strong>- paquete:</strong> Uno o ms mdulos, con sus dependientes de otros paquetes que proponen una solucin reutilizable.</p><p>Conocidos los ingredientes, la receta es sencilla:</p><ol><li>Debes crear un proyecto para el paquete que vas a publicar.</li><li>Has de subir el cdigo a un repositorio pblico.</li><li>Y debes rellenar convenientemente el <code>package.json</code> de tu proyecto.</li></ol><p>Este es un ejemplo que he creado y <a href=\"https://github.com/AgoraBinaria/ab-ftp\" target=\"_blank\" rel=\"noopener\">publicado en github</a> que te puede servir de base.</p><p>Presta especial atencin al <strong>nombrado</strong> de tu proyecto porque ha de ser nico en el repositorio de npm. Para reducir riesgos de colisiones de nombre te recomiendo que utilices un <em>prefijo</em> con tus iniciales o las de tu empresa.</p><p>No te olvides de incluir un juego de <strong>pruebas y documentacin</strong> necesaria para sus uso.</p><h2 id=\"Publica\"><a href=\"#Publica\" class=\"headerlink\" title=\"Publica\"></a>Publica</h2><p>Puedes descargar libreras y herramienta desde el repositorio de <em>npm</em> de forma annima. De hecho, eso es lo ms corriente. Pero, como era de esperar, tienes que <strong>registrarte para poder publicar</strong> contenido. El <a href=\"https://www.npmjs.com/signup\" target=\"_blank\" rel=\"noopener\">proceso de registro</a> va web es sencillo y grtis.</p><p>Una vez verificado puedes hacer login en la web. Pero tambin en la terminal de tu ordenador: <code>npm login</code> te pedir el nombre de usuario y contrasea. A partir de es momento ests identificado y puedes usar las herramientas de autor:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm publish</span><br></pre></td></tr></table></figure><p>Puedes encontrar <a href=\"https://docs.npmjs.com/cli/publish\" target=\"_blank\" rel=\"noopener\">ms informacin</a> acerca de este mega comando en la documentacin de <em>npmjs</em>. Pero siguiendo la mxima de cuanto menos, mejor, la herramienta har con sus valores por defecto un publicacin y actualizacin limpias.</p><p>La clave est en que tu fichero de configuracin <code>package.json</code> sea correcto y lo ms completo posible. Escribe un completo <code>readme.md</code> que se convertir en portada de tu paquete en el repositorio de npm. Mira en mi ejemplo cmo <a href=\"https://github.com/AgoraBinaria/ab-ftp\" target=\"_blank\" rel=\"noopener\">el contenido subido a github</a> se transforma y se ve en la <a href=\"https://www.npmjs.com/package/ab-ftp\" target=\"_blank\" rel=\"noopener\">pgina de informacin de npm.</a></p><p>Comprueba en un directorio vaco que <code>npm install nombre-de-tu-paquete</code> descarga todo lo necesario y tmate un caf mientras ves crecer la hierba y las estadsticas de descargas.</p><h2 id=\"Actualiza\"><a href=\"#Actualiza\" class=\"headerlink\" title=\"Actualiza\"></a>Actualiza</h2><p>Con el tiempo mejorars y corregirs tu solucin. Te recomiendo que sigas el patrn de <a href=\"http://semver.org/\" target=\"_blank\" rel=\"noopener\">nombrado de versiones semntico</a>:</p><p><strong>x.y.z = 1.2.3 = ruptura.mejora.parche</strong></p><p>Es bueno que etiquetes tu repositorio con estas mismas versiones para que, una vez desplegadas, se encuentre con facilidad en <em>github</em>.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git tag 0.1.2</span><br><span class=\"line\">git push --tags</span><br></pre></td></tr></table></figure><h2 id=\"Disfruta\"><a href=\"#Disfruta\" class=\"headerlink\" title=\"Disfruta\"></a>Disfruta</h2><p>Finalmente podrs utilizar ese cdigo en todas tus aplicaciones. Sera fantstico que adems otros lo encontrasen til. Y mejor an si te ayudan o al menos te proponen mejoras. Pero en cualquier caso <strong>siempre habrs ganado</strong>. El esfuerzo analtico que requiere se cobra con creces: dividiendo el problema, creando micro soluciones eficientes y reutilizando cdigo siempre es rentable.</p>","site":{"data":{}},"excerpt":"","more":"<p>Seguro que ests harto de repetir la mtica instruccin <code>npm install paquete-x</code> Pero, has pensado en <strong>publicar tus propios mdulos</strong>?. Es muy recomendable crear soluciones distribuidas y muy fcil publicarlas en <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"noopener\"><em>npm</em></a>.</p><p>Sigue este proceso y te convertirs en un creador de paquetes para <em>npm</em> :</p><h2 id=\"Programa\"><a href=\"#Programa\" class=\"headerlink\" title=\"Programa\"></a>Programa</h2><p>Todo empieza por tener una necesidad y resolverla <strong>encapsulando su cdigo en un mdulo.</strong> Por supuesto que ese mdulo puede requerir paquetes externos. Y por supuesto que tu cdigo puede, y debe, escribirse en varios mdulos.</p><p>Antes de continuar vamos a fijar un par de conceptos:</p><p><strong>- mdulo:</strong> Fichero <em>.js</em> que exporta un funcionalidad y oculta su implementacin.</p><p><strong>- paquete:</strong> Uno o ms mdulos, con sus dependientes de otros paquetes que proponen una solucin reutilizable.</p><p>Conocidos los ingredientes, la receta es sencilla:</p><ol><li>Debes crear un proyecto para el paquete que vas a publicar.</li><li>Has de subir el cdigo a un repositorio pblico.</li><li>Y debes rellenar convenientemente el <code>package.json</code> de tu proyecto.</li></ol><p>Este es un ejemplo que he creado y <a href=\"https://github.com/AgoraBinaria/ab-ftp\" target=\"_blank\" rel=\"noopener\">publicado en github</a> que te puede servir de base.</p><p>Presta especial atencin al <strong>nombrado</strong> de tu proyecto porque ha de ser nico en el repositorio de npm. Para reducir riesgos de colisiones de nombre te recomiendo que utilices un <em>prefijo</em> con tus iniciales o las de tu empresa.</p><p>No te olvides de incluir un juego de <strong>pruebas y documentacin</strong> necesaria para sus uso.</p><h2 id=\"Publica\"><a href=\"#Publica\" class=\"headerlink\" title=\"Publica\"></a>Publica</h2><p>Puedes descargar libreras y herramienta desde el repositorio de <em>npm</em> de forma annima. De hecho, eso es lo ms corriente. Pero, como era de esperar, tienes que <strong>registrarte para poder publicar</strong> contenido. El <a href=\"https://www.npmjs.com/signup\" target=\"_blank\" rel=\"noopener\">proceso de registro</a> va web es sencillo y grtis.</p><p>Una vez verificado puedes hacer login en la web. Pero tambin en la terminal de tu ordenador: <code>npm login</code> te pedir el nombre de usuario y contrasea. A partir de es momento ests identificado y puedes usar las herramientas de autor:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm publish</span><br></pre></td></tr></table></figure><p>Puedes encontrar <a href=\"https://docs.npmjs.com/cli/publish\" target=\"_blank\" rel=\"noopener\">ms informacin</a> acerca de este mega comando en la documentacin de <em>npmjs</em>. Pero siguiendo la mxima de cuanto menos, mejor, la herramienta har con sus valores por defecto un publicacin y actualizacin limpias.</p><p>La clave est en que tu fichero de configuracin <code>package.json</code> sea correcto y lo ms completo posible. Escribe un completo <code>readme.md</code> que se convertir en portada de tu paquete en el repositorio de npm. Mira en mi ejemplo cmo <a href=\"https://github.com/AgoraBinaria/ab-ftp\" target=\"_blank\" rel=\"noopener\">el contenido subido a github</a> se transforma y se ve en la <a href=\"https://www.npmjs.com/package/ab-ftp\" target=\"_blank\" rel=\"noopener\">pgina de informacin de npm.</a></p><p>Comprueba en un directorio vaco que <code>npm install nombre-de-tu-paquete</code> descarga todo lo necesario y tmate un caf mientras ves crecer la hierba y las estadsticas de descargas.</p><h2 id=\"Actualiza\"><a href=\"#Actualiza\" class=\"headerlink\" title=\"Actualiza\"></a>Actualiza</h2><p>Con el tiempo mejorars y corregirs tu solucin. Te recomiendo que sigas el patrn de <a href=\"http://semver.org/\" target=\"_blank\" rel=\"noopener\">nombrado de versiones semntico</a>:</p><p><strong>x.y.z = 1.2.3 = ruptura.mejora.parche</strong></p><p>Es bueno que etiquetes tu repositorio con estas mismas versiones para que, una vez desplegadas, se encuentre con facilidad en <em>github</em>.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git tag 0.1.2</span><br><span class=\"line\">git push --tags</span><br></pre></td></tr></table></figure><h2 id=\"Disfruta\"><a href=\"#Disfruta\" class=\"headerlink\" title=\"Disfruta\"></a>Disfruta</h2><p>Finalmente podrs utilizar ese cdigo en todas tus aplicaciones. Sera fantstico que adems otros lo encontrasen til. Y mejor an si te ayudan o al menos te proponen mejoras. Pero en cualquier caso <strong>siempre habrs ganado</strong>. El esfuerzo analtico que requiere se cobra con creces: dividiendo el problema, creando micro soluciones eficientes y reutilizando cdigo siempre es rentable.</p>"}],"PostAsset":[],"PostCategory":[{"post_id":"ck70mab13000ebss30ziy72qu","category_id":"ck70mab2o0015bss3sd2qmzln","_id":"ck70mab61005ubss3gu7ua0oz"},{"post_id":"ck70mab16000gbss3cmtwqgdm","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7d00agbss3vsq9khqt"},{"post_id":"ck70mab16000gbss3cmtwqgdm","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7f00ahbss374agaien"},{"post_id":"ck70mab19000ibss3mandbfcy","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7g00aibss35vcct7m4"},{"post_id":"ck70mab19000ibss3mandbfcy","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7g00ajbss3ms2qviem"},{"post_id":"ck70mab1b000kbss3las8qgob","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7h00akbss3nbyxz6y6"},{"post_id":"ck70mab1b000kbss3las8qgob","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7h00albss3uvpylr6l"},{"post_id":"ck70mab1e000mbss3x0jskz3t","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7h00ambss3vx50s3ae"},{"post_id":"ck70mab1e000mbss3x0jskz3t","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7h00anbss30x45emc5"},{"post_id":"ck70mab1f000nbss3qfd58y4p","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7h00aobss3ufwwzmth"},{"post_id":"ck70mab1f000nbss3qfd58y4p","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7h00apbss3w0sqcj08"},{"post_id":"ck70mab1g000obss300bzw0u4","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7h00aqbss3iwke9rhv"},{"post_id":"ck70mab1g000obss300bzw0u4","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7i00arbss348j9ilsx"},{"post_id":"ck70mab1h000pbss3qisy3wfv","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7i00asbss3e226bw9q"},{"post_id":"ck70mab1h000pbss3qisy3wfv","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7i00atbss3d1nk82qv"},{"post_id":"ck70mab1j000qbss3vbuehb0z","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7i00aubss3b0ryr90u"},{"post_id":"ck70mab1j000qbss3vbuehb0z","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7i00avbss3ii60ygnv"},{"post_id":"ck70mab1l000rbss3145s0ptk","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7i00awbss3x6gmoeob"},{"post_id":"ck70mab1l000rbss3145s0ptk","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7i00axbss3vy7omn1l"},{"post_id":"ck70mab1n000sbss310corfp5","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7i00aybss3kntoy4xu"},{"post_id":"ck70mab1n000sbss310corfp5","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7j00azbss3u365g6yf"},{"post_id":"ck70mab1o000tbss3n6h3iecn","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7j00b0bss3613fgm8s"},{"post_id":"ck70mab1o000tbss3n6h3iecn","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7j00b1bss35szck4d8"},{"post_id":"ck70mab1p000ubss3xcqml524","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7j00b2bss39aiidxq8"},{"post_id":"ck70mab1p000ubss3xcqml524","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7k00b3bss353ddizkf"},{"post_id":"ck70mab1r000vbss32jkppmvg","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7k00b4bss3v5l87bs5"},{"post_id":"ck70mab1r000vbss32jkppmvg","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7k00b5bss38j8xrhy7"},{"post_id":"ck70mab1u000wbss3kjj51lg9","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7k00b6bss3h96olcq8"},{"post_id":"ck70mab1u000wbss3kjj51lg9","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7l00b7bss362e2kofx"},{"post_id":"ck70mab1v000xbss3rcjrlu1p","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7l00b8bss32iimbnkl"},{"post_id":"ck70mab1v000xbss3rcjrlu1p","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7l00b9bss3igbyi7fv"},{"post_id":"ck70mab1w000ybss3jayylryo","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7l00babss3863i7fmh"},{"post_id":"ck70mab1w000ybss3jayylryo","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7l00bbbss3qmc2e3go"},{"post_id":"ck70mab1y000zbss3erjwsjdv","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7l00bcbss324x9hcv7"},{"post_id":"ck70mab1y000zbss3erjwsjdv","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7l00bdbss3pr0p3o14"},{"post_id":"ck70mab1z0010bss313urhf08","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7m00bebss3koi5zemu"},{"post_id":"ck70mab1z0010bss313urhf08","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7m00bfbss3biud97x2"},{"post_id":"ck70mab200011bss3jtdcnbgy","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7m00bgbss3mogziy2t"},{"post_id":"ck70mab200011bss3jtdcnbgy","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7m00bhbss33wl9uqnx"},{"post_id":"ck70mab200012bss3ayjzqo7y","category_id":"ck70mab2r0017bss3er8mlt2u","_id":"ck70mab7m00bibss3yy6qed7y"},{"post_id":"ck70mab200012bss3ayjzqo7y","category_id":"ck70mab61005tbss3lc7oeupq","_id":"ck70mab7m00bjbss3n0bmzlds"}],"PostTag":[{"post_id":"ck70mab0l0004bss3uj0qleb4","tag_id":"ck70mab2i0014bss34fupfax2","_id":"ck70mab61005sbss3uu2dq95l"},{"post_id":"ck70mab0l0004bss3uj0qleb4","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab62005vbss346zalgss"},{"post_id":"ck70mab0r0006bss3pjil4tff","tag_id":"ck70mab2i0014bss34fupfax2","_id":"ck70mab62005wbss3n8syl2iv"},{"post_id":"ck70mab0r0006bss3pjil4tff","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab63005ybss3ed9zn5pp"},{"post_id":"ck70mab0s0008bss337ug1zzi","tag_id":"ck70mab2w001cbss3656ym8yw","_id":"ck70mab63005zbss3fx2p13aq"},{"post_id":"ck70mab0s0008bss337ug1zzi","tag_id":"ck70mab2i0014bss34fupfax2","_id":"ck70mab640061bss3mqb34a2a"},{"post_id":"ck70mab0s0008bss337ug1zzi","tag_id":"ck70mab2y001hbss3vwtwobqx","_id":"ck70mab640062bss3zfcbmu8g"},{"post_id":"ck70mab0s0008bss337ug1zzi","tag_id":"ck70mab2z001jbss3jw5orb7x","_id":"ck70mab650064bss3ldex42oh"},{"post_id":"ck70mab0w000abss3x3r6phky","tag_id":"ck70mab32001lbss36v675wf9","_id":"ck70mab650065bss3i1cw1s5v"},{"post_id":"ck70mab0w000abss3x3r6phky","tag_id":"ck70mab33001nbss3kzy8zz25","_id":"ck70mab660067bss3nx6i68xe"},{"post_id":"ck70mab0w000abss3x3r6phky","tag_id":"ck70mab2z001jbss3jw5orb7x","_id":"ck70mab670068bss3dpnutx9k"},{"post_id":"ck70mab0z000cbss31l84jg2e","tag_id":"ck70mab36001rbss3p59a709v","_id":"ck70mab68006abss3sjka6hrw"},{"post_id":"ck70mab0z000cbss31l84jg2e","tag_id":"ck70mab2z001jbss3jw5orb7x","_id":"ck70mab68006bbss3y0kjy288"},{"post_id":"ck70mab13000ebss30ziy72qu","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab69006dbss3lqx7fdqg"},{"post_id":"ck70mab13000ebss30ziy72qu","tag_id":"ck70mab3a001xbss3dckwci3s","_id":"ck70mab69006ebss3ex2ytq6m"},{"post_id":"ck70mab13000ebss30ziy72qu","tag_id":"ck70mab3c001zbss3ahw1ra58","_id":"ck70mab6a006gbss3azrxslk1"},{"post_id":"ck70mab16000gbss3cmtwqgdm","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6a006hbss3nkqp7reo"},{"post_id":"ck70mab16000gbss3cmtwqgdm","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab6b006jbss3r01vah5a"},{"post_id":"ck70mab16000gbss3cmtwqgdm","tag_id":"ck70mab3g0026bss3wewahhsz","_id":"ck70mab6b006kbss3i2gzyis1"},{"post_id":"ck70mab16000gbss3cmtwqgdm","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6c006mbss3hfa63loq"},{"post_id":"ck70mab16000gbss3cmtwqgdm","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab6c006nbss3ol83kde3"},{"post_id":"ck70mab19000ibss3mandbfcy","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6d006pbss3hl1zgy0r"},{"post_id":"ck70mab19000ibss3mandbfcy","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab6d006qbss31t9zylwe"},{"post_id":"ck70mab19000ibss3mandbfcy","tag_id":"ck70mab3g0026bss3wewahhsz","_id":"ck70mab6e006sbss3vudgnco4"},{"post_id":"ck70mab19000ibss3mandbfcy","tag_id":"ck70mab3m002dbss3r3jgc8ty","_id":"ck70mab6e006tbss3rn2cg70b"},{"post_id":"ck70mab19000ibss3mandbfcy","tag_id":"ck70mab3n002ebss31ord5sxy","_id":"ck70mab6f006vbss3gys29t69"},{"post_id":"ck70mab19000ibss3mandbfcy","tag_id":"ck70mab3o002fbss3rxruehyk","_id":"ck70mab6f006wbss3pkaitxwa"},{"post_id":"ck70mab19000ibss3mandbfcy","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6h006ybss3zgly5702"},{"post_id":"ck70mab19000ibss3mandbfcy","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab6h006zbss3j7pix9de"},{"post_id":"ck70mab1b000kbss3las8qgob","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6i0071bss3rck045ki"},{"post_id":"ck70mab1b000kbss3las8qgob","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab6i0072bss3ovoatibi"},{"post_id":"ck70mab1b000kbss3las8qgob","tag_id":"ck70mab3r002kbss38vjh2xl2","_id":"ck70mab6j0074bss3vjvse3ii"},{"post_id":"ck70mab1b000kbss3las8qgob","tag_id":"ck70mab3s002lbss3yr17b4jr","_id":"ck70mab6j0075bss3yfx7ux5v"},{"post_id":"ck70mab1b000kbss3las8qgob","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6k0077bss3bk3e74pj"},{"post_id":"ck70mab1b000kbss3las8qgob","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab6k0078bss338j89hzj"},{"post_id":"ck70mab1e000mbss3x0jskz3t","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6l007abss3ngdjah7r"},{"post_id":"ck70mab1e000mbss3x0jskz3t","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab6l007bbss3cjzvdflq"},{"post_id":"ck70mab1e000mbss3x0jskz3t","tag_id":"ck70mab3u002qbss3zvgabsw5","_id":"ck70mab6m007dbss3b265wn0q"},{"post_id":"ck70mab1e000mbss3x0jskz3t","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6m007ebss3qoq3e9uk"},{"post_id":"ck70mab1e000mbss3x0jskz3t","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab6n007gbss30k9kgrta"},{"post_id":"ck70mab1f000nbss3qfd58y4p","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6n007hbss3hn51b2q5"},{"post_id":"ck70mab1f000nbss3qfd58y4p","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab6n007ibss38bv4tzc7"},{"post_id":"ck70mab1f000nbss3qfd58y4p","tag_id":"ck70mab3y002vbss3llz93l1y","_id":"ck70mab6n007jbss3dkv4vzrg"},{"post_id":"ck70mab1f000nbss3qfd58y4p","tag_id":"ck70mab3y002wbss3wost8416","_id":"ck70mab6n007kbss3y7lmemxy"},{"post_id":"ck70mab1f000nbss3qfd58y4p","tag_id":"ck70mab3s002lbss3yr17b4jr","_id":"ck70mab6o007lbss3tae1tq3p"},{"post_id":"ck70mab1f000nbss3qfd58y4p","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6o007mbss31h35z8vf"},{"post_id":"ck70mab1f000nbss3qfd58y4p","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab6o007nbss3x9h59k6g"},{"post_id":"ck70mab1g000obss300bzw0u4","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6o007obss38drlss1y"},{"post_id":"ck70mab1g000obss300bzw0u4","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab6o007pbss3l9m1ixek"},{"post_id":"ck70mab1g000obss300bzw0u4","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab6o007qbss331ygwc6z"},{"post_id":"ck70mab1g000obss300bzw0u4","tag_id":"ck70mab3y002vbss3llz93l1y","_id":"ck70mab6p007rbss37jvpusmy"},{"post_id":"ck70mab1g000obss300bzw0u4","tag_id":"ck70mab420034bss3r2me08y1","_id":"ck70mab6p007sbss3olaeh5gm"},{"post_id":"ck70mab1g000obss300bzw0u4","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6p007tbss37hxc5fvl"},{"post_id":"ck70mab1g000obss300bzw0u4","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab6p007ubss36c1rwzhs"},{"post_id":"ck70mab1h000pbss3qisy3wfv","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6p007vbss3s3siani3"},{"post_id":"ck70mab1h000pbss3qisy3wfv","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab6p007wbss3irf54zmt"},{"post_id":"ck70mab1h000pbss3qisy3wfv","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab6q007xbss3rgj8egtw"},{"post_id":"ck70mab1h000pbss3qisy3wfv","tag_id":"ck70mab46003abss34fq4t30p","_id":"ck70mab6q007ybss32k5lwbqe"},{"post_id":"ck70mab1h000pbss3qisy3wfv","tag_id":"ck70mab46003bbss3nmo2kdtk","_id":"ck70mab6q007zbss3vshj6831"},{"post_id":"ck70mab1h000pbss3qisy3wfv","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6q0080bss3qhiv01fh"},{"post_id":"ck70mab1h000pbss3qisy3wfv","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab6q0081bss30jtam1rh"},{"post_id":"ck70mab1j000qbss3vbuehb0z","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6q0082bss303ywu0ha"},{"post_id":"ck70mab1j000qbss3vbuehb0z","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab6r0083bss35smjdvsu"},{"post_id":"ck70mab1j000qbss3vbuehb0z","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab6r0084bss3d43htlie"},{"post_id":"ck70mab1j000qbss3vbuehb0z","tag_id":"ck70mab4a003hbss3axfq47sf","_id":"ck70mab6r0085bss3ps49bzfb"},{"post_id":"ck70mab1j000qbss3vbuehb0z","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6r0086bss37oktyawn"},{"post_id":"ck70mab1j000qbss3vbuehb0z","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab6r0087bss3w9917tjv"},{"post_id":"ck70mab1l000rbss3145s0ptk","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6r0088bss3o5yp0p6p"},{"post_id":"ck70mab1l000rbss3145s0ptk","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab6r0089bss31bxj8b5r"},{"post_id":"ck70mab1l000rbss3145s0ptk","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab6s008abss3lbsph6nr"},{"post_id":"ck70mab1l000rbss3145s0ptk","tag_id":"ck70mab4d003nbss3mv6hfodc","_id":"ck70mab6s008bbss3n0y1ehqf"},{"post_id":"ck70mab1l000rbss3145s0ptk","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6s008cbss3989hfmfj"},{"post_id":"ck70mab1l000rbss3145s0ptk","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab6t008dbss3oi92bu43"},{"post_id":"ck70mab1n000sbss310corfp5","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6t008ebss3h5ylc3lj"},{"post_id":"ck70mab1n000sbss310corfp5","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab6u008fbss3nhamyjab"},{"post_id":"ck70mab1n000sbss310corfp5","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab6u008gbss3m61df8ye"},{"post_id":"ck70mab1n000sbss310corfp5","tag_id":"ck70mab4i003tbss3qkmnzq4b","_id":"ck70mab6u008hbss3udy958n4"},{"post_id":"ck70mab1n000sbss310corfp5","tag_id":"ck70mab4j003ubss3xq2ybqz0","_id":"ck70mab6u008ibss3nv863909"},{"post_id":"ck70mab1n000sbss310corfp5","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6v008jbss3wftg0nv4"},{"post_id":"ck70mab1n000sbss310corfp5","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab6v008kbss3vne79oyp"},{"post_id":"ck70mab1o000tbss3n6h3iecn","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6v008lbss3gmnc2ywk"},{"post_id":"ck70mab1o000tbss3n6h3iecn","tag_id":"ck70mab4l003ybss3d9cwmrki","_id":"ck70mab6v008mbss3r5y3jdia"},{"post_id":"ck70mab1o000tbss3n6h3iecn","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6v008nbss39ulox9w4"},{"post_id":"ck70mab1o000tbss3n6h3iecn","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab6v008obss3mbfn7dhx"},{"post_id":"ck70mab1o000tbss3n6h3iecn","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab6v008qbss3c2p9vg74"},{"post_id":"ck70mab1p000ubss3xcqml524","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6w008rbss37a9keta1"},{"post_id":"ck70mab1p000ubss3xcqml524","tag_id":"ck70mab4o0044bss3n07hvo2y","_id":"ck70mab6w008sbss3ba60s0cj"},{"post_id":"ck70mab1p000ubss3xcqml524","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6w008tbss3a7slybmn"},{"post_id":"ck70mab1p000ubss3xcqml524","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab6w008ubss3wyvmezz2"},{"post_id":"ck70mab1p000ubss3xcqml524","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab6x008wbss3d14s3txs"},{"post_id":"ck70mab1r000vbss32jkppmvg","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab6x008xbss3h4xhmpt2"},{"post_id":"ck70mab1r000vbss32jkppmvg","tag_id":"ck70mab4r004abss3jaw2wq9q","_id":"ck70mab6y008ybss333ltjwbq"},{"post_id":"ck70mab1r000vbss32jkppmvg","tag_id":"ck70mab4r004bbss30hszr3l9","_id":"ck70mab6z008zbss3ongl4q51"},{"post_id":"ck70mab1r000vbss32jkppmvg","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab6z0090bss336txf7ve"},{"post_id":"ck70mab1r000vbss32jkppmvg","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab700091bss3tuwn3atl"},{"post_id":"ck70mab1r000vbss32jkppmvg","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab700093bss3exza4dkp"},{"post_id":"ck70mab1u000wbss3kjj51lg9","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab700094bss3em7we8up"},{"post_id":"ck70mab1u000wbss3kjj51lg9","tag_id":"ck70mab4u004hbss3n3pafcts","_id":"ck70mab700095bss30lc46sxw"},{"post_id":"ck70mab1u000wbss3kjj51lg9","tag_id":"ck70mab4u004ibss3o3el6h9s","_id":"ck70mab700096bss3268gwuqg"},{"post_id":"ck70mab1u000wbss3kjj51lg9","tag_id":"ck70mab3s002lbss3yr17b4jr","_id":"ck70mab700097bss3gie09ai0"},{"post_id":"ck70mab1u000wbss3kjj51lg9","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab710098bss3ke5cmh68"},{"post_id":"ck70mab1u000wbss3kjj51lg9","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab710099bss3vz9jis6z"},{"post_id":"ck70mab1u000wbss3kjj51lg9","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab72009bbss367x5aaac"},{"post_id":"ck70mab1v000xbss3rcjrlu1p","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab72009cbss32eqspv7z"},{"post_id":"ck70mab1v000xbss3rcjrlu1p","tag_id":"ck70mab4u004hbss3n3pafcts","_id":"ck70mab72009dbss3pwskw02j"},{"post_id":"ck70mab1v000xbss3rcjrlu1p","tag_id":"ck70mab3s002lbss3yr17b4jr","_id":"ck70mab72009ebss3rqg8wms7"},{"post_id":"ck70mab1v000xbss3rcjrlu1p","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab72009fbss3xst1a4o7"},{"post_id":"ck70mab1v000xbss3rcjrlu1p","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab72009gbss3vkz7l1ip"},{"post_id":"ck70mab1v000xbss3rcjrlu1p","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab73009ibss3ha897z27"},{"post_id":"ck70mab1w000ybss3jayylryo","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab73009jbss3zj9puupw"},{"post_id":"ck70mab1w000ybss3jayylryo","tag_id":"ck70mab3e0024bss38ow1h162","_id":"ck70mab73009kbss3e96cvamj"},{"post_id":"ck70mab1w000ybss3jayylryo","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab73009lbss30j4qqmyx"},{"post_id":"ck70mab1w000ybss3jayylryo","tag_id":"ck70mab55004ybss3qu9vgiy5","_id":"ck70mab73009mbss3xee7ruee"},{"post_id":"ck70mab1w000ybss3jayylryo","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab73009nbss3stj72g73"},{"post_id":"ck70mab1w000ybss3jayylryo","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab73009obss39u7rgeld"},{"post_id":"ck70mab1y000zbss3erjwsjdv","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab73009pbss3ilwhx6dy"},{"post_id":"ck70mab1y000zbss3erjwsjdv","tag_id":"ck70mab5a0052bss3r7rep6a7","_id":"ck70mab74009qbss31i3q5lc5"},{"post_id":"ck70mab1y000zbss3erjwsjdv","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab74009rbss3ulibh21h"},{"post_id":"ck70mab1y000zbss3erjwsjdv","tag_id":"ck70mab5b0054bss35tfzx4db","_id":"ck70mab74009sbss30cw7927k"},{"post_id":"ck70mab1y000zbss3erjwsjdv","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab74009tbss3nq88rdeo"},{"post_id":"ck70mab1y000zbss3erjwsjdv","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab74009ubss3m0avudtu"},{"post_id":"ck70mab1z0010bss313urhf08","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab74009vbss3vpxjrihz"},{"post_id":"ck70mab1z0010bss313urhf08","tag_id":"ck70mab5d0058bss3eu1nz739","_id":"ck70mab74009wbss3o3tdi73q"},{"post_id":"ck70mab1z0010bss313urhf08","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab74009xbss3ea7z8tzk"},{"post_id":"ck70mab1z0010bss313urhf08","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab74009ybss3104f5lkh"},{"post_id":"ck70mab1z0010bss313urhf08","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab7500a0bss3sxh2pl7y"},{"post_id":"ck70mab200011bss3jtdcnbgy","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab7500a1bss3yfw7v627"},{"post_id":"ck70mab200011bss3jtdcnbgy","tag_id":"ck70mab5d0058bss3eu1nz739","_id":"ck70mab7500a2bss3lls7h89u"},{"post_id":"ck70mab200011bss3jtdcnbgy","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab7500a3bss3vdgvwrp8"},{"post_id":"ck70mab200011bss3jtdcnbgy","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab7500a4bss321pso7e9"},{"post_id":"ck70mab200011bss3jtdcnbgy","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab7500a6bss3uxq1ayia"},{"post_id":"ck70mab200012bss3ayjzqo7y","tag_id":"ck70mab39001vbss3wfae9fd0","_id":"ck70mab7500a7bss38eg6ty78"},{"post_id":"ck70mab200012bss3ayjzqo7y","tag_id":"ck70mab5j005kbss3a7x1xauv","_id":"ck70mab7500a8bss3t5fufcc1"},{"post_id":"ck70mab200012bss3ayjzqo7y","tag_id":"ck70mab5k005lbss3d9pz4vme","_id":"ck70mab7600a9bss3uu7rooc5"},{"post_id":"ck70mab200012bss3ayjzqo7y","tag_id":"ck70mab3i0028bss3xz9s4q45","_id":"ck70mab7600aabss3yfab5580"},{"post_id":"ck70mab200012bss3ayjzqo7y","tag_id":"ck70mab2q0016bss3kc5f45kk","_id":"ck70mab7600abbss3fk9h1grd"},{"post_id":"ck70mab200012bss3ayjzqo7y","tag_id":"ck70mab410032bss30lax3ho0","_id":"ck70mab7600adbss3s25yte9g"},{"post_id":"ck70mab210013bss37leiwws8","tag_id":"ck70mab2i0014bss34fupfax2","_id":"ck70mab7600aebss3zsrh5hgx"},{"post_id":"ck70mab210013bss37leiwws8","tag_id":"ck70mab3j0029bss3yutuyr8f","_id":"ck70mab7600afbss3t6c1mb38"},{"post_id":"ck70mab1z0010bss313urhf08","tag_id":"ck70mab3a001xbss3dckwci3s","_id":"ck7dme23l00007gs3dnpaddh0"},{"post_id":"ck70mab200011bss3jtdcnbgy","tag_id":"ck70mab3a001xbss3dckwci3s","_id":"ck7gdqbn40000fgs32hls1x1d"},{"post_id":"ck70mab200012bss3ayjzqo7y","tag_id":"ck70mab3a001xbss3dckwci3s","_id":"ck7hund270000tss3rtmd3ncf"},{"post_id":"ck70mab1o000tbss3n6h3iecn","tag_id":"ck70mab3a001xbss3dckwci3s","_id":"ck7m5lbia0000r8s3m4xa3hna"},{"post_id":"ck70mab1p000ubss3xcqml524","tag_id":"ck70mab3a001xbss3dckwci3s","_id":"ck92rjixo00003ss39nzt0vx7"},{"post_id":"ck70mab1r000vbss32jkppmvg","tag_id":"ck70mab3a001xbss3dckwci3s","_id":"ck93xuuyy000050s3glfh0fkx"},{"post_id":"ck70mab1u000wbss3kjj51lg9","tag_id":"ck70mab3a001xbss3dckwci3s","_id":"ck95ehx550000w0s3e9qu2c7j"},{"post_id":"ck70mab1v000xbss3rcjrlu1p","tag_id":"ck70mab3a001xbss3dckwci3s","_id":"ck96usiw10000tcs38r71hpql"}],"Tag":[{"name":"NodeJS","_id":"ck70mab2i0014bss34fupfax2"},{"name":"Introduccin","_id":"ck70mab2q0016bss3kc5f45kk"},{"name":"BackEnd","_id":"ck70mab2w001cbss3656ym8yw"},{"name":"MongoDB","_id":"ck70mab2y001hbss3vwtwobqx"},{"name":"Opinin","_id":"ck70mab2z001jbss3jw5orb7x"},{"name":"FrontEnd","_id":"ck70mab32001lbss36v675wf9"},{"name":"AngularJS","_id":"ck70mab33001nbss3kzy8zz25"},{"name":"TypeScript","_id":"ck70mab36001rbss3p59a709v"},{"name":"Angular","_id":"ck70mab39001vbss3wfae9fd0"},{"name":"Angular9","_id":"ck70mab3a001xbss3dckwci3s"},{"name":"Ivy","_id":"ck70mab3c001zbss3ahw1ra58"},{"name":"Angular8","_id":"ck70mab3e0024bss38ow1h162"},{"name":"Nx","_id":"ck70mab3g0026bss3wewahhsz"},{"name":"Tutorial","_id":"ck70mab3i0028bss3xz9s4q45"},{"name":"Avanzado","_id":"ck70mab3j0029bss3yutuyr8f"},{"name":"Test","_id":"ck70mab3m002dbss3r3jgc8ty"},{"name":"Jest","_id":"ck70mab3n002ebss31ord5sxy"},{"name":"Cypress","_id":"ck70mab3o002fbss3rxruehyk"},{"name":"ChangeDetection","_id":"ck70mab3r002kbss38vjh2xl2"},{"name":"Observables","_id":"ck70mab3s002lbss3yr17b4jr"},{"name":"Template","_id":"ck70mab3u002qbss3zvgabsw5"},{"name":"Redux","_id":"ck70mab3y002vbss3llz93l1y"},{"name":"RxJs","_id":"ck70mab3y002wbss3wost8416"},{"name":"Angular2","_id":"ck70mab410032bss30lax3ho0"},{"name":"NgRx","_id":"ck70mab420034bss3r2me08y1"},{"name":"Universal","_id":"ck70mab46003abss34fq4t30p"},{"name":"SSR","_id":"ck70mab46003bbss3nmo2kdtk"},{"name":"PWA","_id":"ck70mab4a003hbss3axfq47sf"},{"name":"i18n","_id":"ck70mab4d003nbss3mv6hfodc"},{"name":"Elements","_id":"ck70mab4i003tbss3qkmnzq4b"},{"name":"WebComponents","_id":"ck70mab4j003ubss3xq2ybqz0"},{"name":"Forms","_id":"ck70mab4l003ybss3d9cwmrki"},{"name":"Components","_id":"ck70mab4o0044bss3n07hvo2y"},{"name":"Servicios","_id":"ck70mab4r004abss3jaw2wq9q"},{"name":"DI","_id":"ck70mab4r004bbss30hszr3l9"},{"name":"http","_id":"ck70mab4u004hbss3n3pafcts"},{"name":"RxJS","_id":"ck70mab4u004ibss3o3el6h9s"},{"name":"reactiveForms","_id":"ck70mab55004ybss3qu9vgiy5"},{"name":"Angular7","_id":"ck70mab5a0052bss3r7rep6a7"},{"name":"material","_id":"ck70mab5b0054bss35tfzx4db"},{"name":"CLI","_id":"ck70mab5d0058bss3eu1nz739"},{"name":"SPA","_id":"ck70mab5j005kbss3a7x1xauv"},{"name":"Routing","_id":"ck70mab5k005lbss3d9pz4vme"}]}}