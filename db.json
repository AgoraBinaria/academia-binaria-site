{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/images/ng2-Arbol-de-componentes.jpg","path":"images/ng2-Arbol-de-componentes.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2-Arbol-de-dependencias.jpg","path":"images/ng2-Arbol-de-dependencias.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2-Component-DataFlow.jpg","path":"images/ng2-Component-DataFlow.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2-DI-component-directive.jpg","path":"images/ng2-DI-component-directive.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2-DI-component-service.jpg","path":"images/ng2-DI-component-service.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2-Flujo-de-datos.jpg","path":"images/ng2-Flujo-de-datos.jpg","modified":0,"renderable":0},{"_id":"source/images/ng2Component--1-.jpg","path":"images/ng2Component--1-.jpg","modified":0,"renderable":0},{"_id":"themes/icarus/source/js/insight.js","path":"js/insight.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/avatar.jpg","path":"css/images/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular.jpg","path":"css/images/angular.jpg","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/thumb-default-small.png","path":"css/images/thumb-default-small.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/justified-gallery/jquery.justifiedGallery.min.js","path":"libs/justified-gallery/jquery.justifiedGallery.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/favicon.ico","path":"css/images/favicon.ico","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/justified-gallery/justifiedGallery.min.css","path":"libs/justified-gallery/justifiedGallery.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/styles.css","path":"libs/open-sans/styles.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/source-code-pro/styles.css","path":"libs/source-code-pro/styles.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/logo.png","path":"css/images/logo.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/typescript.jpg","path":"css/images/typescript.jpg","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.css","path":"libs/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.min.css","path":"libs/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css.map","path":"libs/lightgallery/css/lg-fb-comment-box.css.map","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css","path":"libs/lightgallery/css/lg-fb-comment-box.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.min.css","path":"libs/lightgallery/css/lg-fb-comment-box.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.min.css","path":"libs/lightgallery/css/lg-transitions.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css","path":"libs/lightgallery/css/lg-transitions.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css.map","path":"libs/lightgallery/css/lg-transitions.css.map","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/loading.gif","path":"libs/lightgallery/img/loading.gif","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css","path":"libs/lightgallery/css/lightgallery.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.min.css","path":"libs/lightgallery/css/lightgallery.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css.map","path":"libs/lightgallery/css/lightgallery.css.map","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/video-play.png","path":"libs/lightgallery/img/video-play.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.ttf","path":"libs/lightgallery/fonts/lg.ttf","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/youtube-play.png","path":"libs/lightgallery/img/youtube-play.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/vimeo-play.png","path":"libs/lightgallery/img/vimeo-play.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.eot","path":"libs/lightgallery/fonts/lg.eot","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.svg","path":"libs/lightgallery/fonts/lg.svg","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.min.js","path":"libs/lightgallery/js/lg-autoplay.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.js","path":"libs/lightgallery/js/lg-fullscreen.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.js","path":"libs/lightgallery/js/lg-autoplay.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.min.js","path":"libs/lightgallery/js/lg-fullscreen.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.min.js","path":"libs/lightgallery/js/lg-hash.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.js","path":"libs/lightgallery/js/lg-pager.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.min.js","path":"libs/lightgallery/js/lg-pager.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.js","path":"libs/lightgallery/js/lg-hash.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.min.js","path":"libs/lightgallery/js/lg-share.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.js","path":"libs/lightgallery/js/lg-share.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.min.js","path":"libs/lightgallery/js/lg-thumbnail.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.js","path":"libs/lightgallery/js/lg-video.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.min.js","path":"libs/lightgallery/js/lg-video.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.min.js","path":"libs/lightgallery/js/lg-zoom.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.js","path":"libs/lightgallery/js/lightgallery.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.js","path":"libs/lightgallery/js/lg-thumbnail.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.min.js","path":"libs/lightgallery/js/lightgallery.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.js","path":"libs/lightgallery/js/lg-zoom.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.woff","path":"libs/lightgallery/fonts/lg.woff","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","path":"libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","path":"libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","path":"libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/FontAwesome.otf","path":"libs/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff","path":"libs/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff2","path":"libs/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/jquery/2.1.3/jquery.min.js","path":"libs/jquery/2.1.3/jquery.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.eot","path":"libs/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.ttf","path":"libs/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.svg","path":"libs/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-0_cli.png","path":"images/tutorial-angular-0_cli.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-0_cli.png","path":"css/images/angular-0_cli.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-1_base.png","path":"css/images/angular-1_base.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-1_base.png","path":"images/tutorial-angular-1_base.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-2_spa.png","path":"images/tutorial-angular-2_spa.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-3_data.png","path":"css/images/angular-3_data.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-3_data.png","path":"images/tutorial-angular-3_data.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-4_flow.png","path":"css/images/angular-4_flow.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-4_flow.png","path":"images/tutorial-angular-4_flow.png","modified":0,"renderable":0},{"_id":"source/images/tutorial-angular-5_inject.png","path":"images/tutorial-angular-5_inject.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-5_inject.png","path":"css/images/angular-5_inject.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/angular-2_spa.png","path":"css/images/angular-2_spa.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-6_http.png","path":"images/tutorial-angular-6_http.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-6_http.png","path":"css/images/angular-6_http.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-7_watch.png","path":"images/tutorial-angular-7_watch.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-7_watch.png","path":"css/images/angular-7_watch.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-8_reactive.png","path":"images/tutorial-angular-8_reactive.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-8_reactive.png","path":"css/images/angular-8_reactive.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-9_change.png","path":"images/tutorial-angular-9_change.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-9_change.png","path":"css/images/angular-9_change.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-a_redux.png","path":"images/tutorial-angular-a_redux.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-a_redux.png","path":"css/images/angular-a_redux.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-b_pwa.png","path":"images/tutorial-angular-b_pwa.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-b_pwa.png","path":"css/images/angular-b_pwa.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-c_universal.png","path":"images/tutorial-angular-c_universal.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-c_universal.png","path":"css/images/angular-c_universal.png","modified":0,"renderable":1},{"_id":"source/images/pedidos_ms.PNG","path":"images/pedidos_ms.PNG","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/angular-9_material.png","path":"css/images/angular-9_material.png","modified":0,"renderable":1},{"_id":"source/images/tutorial-angular-9_material.png","path":"images/tutorial-angular-9_material.png","modified":0,"renderable":0}],"Cache":[{"_id":"themes/icarus/icarus.txt","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1509447582883},{"_id":"source/404.md","hash":"ed869e21a6ac3f026e7f38aab1e2bbf374e19444","modified":1513761439801},{"_id":"themes/icarus/LICENSE","hash":"73ed09aa00f7bda6319fc7d5b722fb40e0c2017e","modified":1509446939324},{"_id":"themes/icarus/_config.yml","hash":"7b314a88578cfabd3fefd484f5fef746556bca28","modified":1545380772920},{"_id":"themes/icarus/README.md","hash":"c2407cbda23f087be719d6dc3f7207a8e01ffd73","modified":1509446939326},{"_id":"themes/icarus/_config.yml.example","hash":"73af4425442660d8cd491115a13d2a14c52f59cc","modified":1509446939328},{"_id":"themes/icarus/package.json","hash":"c156985c2689895a228188a29ceaae8f7d0bb34f","modified":1509446939521},{"_id":"source/.DS_Store","hash":"39d94912a63ec708e3af99df0204f2b60fb1105d","modified":1509446804339},{"_id":"source/Contacto/index.md","hash":"8d3f82ba692c2e9e02bbb6c7184ebe3772cd210d","modified":1509446804343},{"_id":"source/Cookies/index.md","hash":"910a9c77e0b6b83065878febc522fba888491234","modified":1509446804347},{"_id":"source/Cursos/index.md","hash":"6e08f944b7ed227418d8b2c85d96a364e2bc2667","modified":1509446804351},{"_id":"source/_posts/7-formas-de-incluir-Bootstrap-en-nuestro-proyecto.md","hash":"475a1769d081e180faf687fb57052027078df3dc","modified":1509446804360},{"_id":"source/Noticias-Junio-2016/index.md","hash":"1189d0847c6c149b8e4fb81516f4865ca2bf6fed","modified":1509446804354},{"_id":"source/Promociones/index.md","hash":"f632b70d1a3924a0335fdc734366a31c1d8bc1cd","modified":1509446804357},{"_id":"source/_posts/Angular2-DI-Inyeccion-de-dependencias.md","hash":"d803231fc537bbd6aeea2f105cf4e6111de9ef86","modified":1513761439810},{"_id":"source/_posts/Codigo-de-ejemplo-curso-de-Angular2.md","hash":"35f74474fd83585e9ff4f516258f45d42bcff047","modified":1509973309900},{"_id":"source/_posts/Angular2-la-evolucion-de-la-plataforma.md","hash":"cc903f49fccecc11015db808d5363acc5a80b78b","modified":1509973309892},{"_id":"source/_posts/Comunicaciones-http-observables-con-Angular2.md","hash":"4741ac1236e91becb76eb3917a72add979eca662","modified":1513761439842},{"_id":"source/_posts/DataBinding-el-flujo-de-datos-de-Angular2.md","hash":"06c66013fa9d4f654a3797da07cb79ad44e27d77","modified":1513761439856},{"_id":"source/_posts/Componentes-los-bloques-de-construccion-de-Angular2.md","hash":"a7ad6f85fde2dc470d3f34ff57cfadd285c7bd2b","modified":1513761439821},{"_id":"source/_posts/Formularios-de-datos-en-Angular2.md","hash":"df51f12c14bd0551f36cca5d45cfc26c82357e1a","modified":1513761439895},{"_id":"source/_posts/Enrutador-de-componentes-con-Angular2-el-nuevo-SPA.md","hash":"e6e7c91cad6598d94a8ba52f70bf06a7a4caf6f8","modified":1513761439870},{"_id":"source/_posts/Introduccion-a-Bootstrap.md","hash":"885b644e1ea783af298453ee08e03605befe20fc","modified":1509446804390},{"_id":"source/_posts/Introduccion-a-MongoDB.md","hash":"c233fe8f362b23c25da7b2db0ac0e8aeba835c3f","modified":1509446804393},{"_id":"source/_posts/Node-6-0-0-actualizacion-con-nvm.md","hash":"214889236dcd9ea5418b95326a3541338806548d","modified":1509446804395},{"_id":"source/_posts/Hola-Mundo-Angular-2.md","hash":"2576c3be7f9a3314d7c05a08e2dd063306f8006b","modified":1513761439912},{"_id":"source/_posts/Por-que-AngularJS.md","hash":"7a4a396557f649c18eb233497caf12a88aad322f","modified":1509446804399},{"_id":"source/_posts/Para-que-puedo-usar-NodeJS.md","hash":"3b65ae5f23d7b4bb7441c96228f57af8ddbbda02","modified":1509446804397},{"_id":"source/_posts/Soluciones-FrontEnd-2016.md","hash":"d262e5f1e180813201f588568a8d99ecc2a18a4d","modified":1509446804408},{"_id":"source/_posts/Soluciones-BackEnd-2016.md","hash":"97cf294fd0ace93ad1f8a120b14ac1e5f3a8b8c8","modified":1509446804405},{"_id":"source/_posts/TypeScript-programa-en-el-front-igual-que-en-el-back.md","hash":"dde3cee7247d90f639cb99aba69ce93ab82293b4","modified":1509973309946},{"_id":"source/_posts/ng-3-Formularios-tablas-y-modelos-de-datos-en-Angular.md","hash":"08e65cbb524c55a5bce81241ab93a938be30afbe","modified":1549988570019},{"_id":"source/_posts/ng-5-Servicios-inyectables-en-Angular.md","hash":"46bc3819d830afc395c0c1a4b4c6025c752bc919","modified":1550668458226},{"_id":"source/_posts/ng-4-Flujo-de-datos-entre-componentes-Angular.md","hash":"b9294370db2a928ea546e0b0ba3b0d53c848af6d","modified":1550141207884},{"_id":"source/_posts/ng-7-Vigilancia-y-seguridad-en-Angular.md","hash":"4f896e51538b8275aca72e66d5e414d9bc48dbcc","modified":1551958880774},{"_id":"source/_posts/ng-6-comunicaciones-http-en-angular.md","hash":"4829fb1048774e9fa179a21345f1cbe709aa8a89","modified":1551686983972},{"_id":"source/_posts/ng-el-ecosistema-de-AngularJS.md","hash":"aaa6daef853f9bf6395824b6da726690a0d7eb0b","modified":1509446804414},{"_id":"source/_posts/ng_0-Hola-Angular-CLI.md","hash":"e4dd91f18e3aa56f8dd7644012c335184795dfb8","modified":1549988672016},{"_id":"source/_posts/ng_2-Paginas-y-rutas-Angular-SPA.md","hash":"50dcd76d26ada3c56cf90f8e4ca8da35b1d831de","modified":1549988480818},{"_id":"source/_posts/ng_1-Base-aplicacion-Angular.md","hash":"7563e433aa07cbdc368c8d1ecada6c0718422fba","modified":1549988696264},{"_id":"source/_posts/npm-de-instalador-a-publicador.md","hash":"a09fd152d81437ccf5529c0f86a543f7aca02c7a","modified":1509446804416},{"_id":"source/images/ng2-Arbol-de-componentes.jpg","hash":"ddf926766408af4ce8c65d3de3d5ff0270a0121b","modified":1509446804422},{"_id":"source/images/ng2-Arbol-de-dependencias.jpg","hash":"e474811bca4569fc209680fcb7f7fc432b60af99","modified":1509446804427},{"_id":"source/images/ng2-Component-DataFlow.jpg","hash":"0032c08ed4f67fc294781b6acb472f50f17ed0f2","modified":1509446804430},{"_id":"source/images/ng2-DI-component-directive.jpg","hash":"ed32320793c7b4c608bcb55d8bdc63ba40dde3fc","modified":1509446804434},{"_id":"source/images/ng2-DI-component-service.jpg","hash":"36febb9d7dbdc6fa87d03d7b5c0ad28adfbcf130","modified":1509446804437},{"_id":"source/images/ng2-Flujo-de-datos.jpg","hash":"e8a401ea27c0d850170a310ee8ce5db233cd3214","modified":1509446804441},{"_id":"source/images/ng2Component--1-.jpg","hash":"4f3a1732800a40410e7b34cb733633866d2dccaf","modified":1509446804445},{"_id":"source/images/tutorial-angular-5_0_cli_1-5.jpg","hash":"97fe16304b0d3405d4ed052ab33be43d27d5e981","modified":1510060448910},{"_id":"source/images/tutorial-angular-5_1_base.jpg","hash":"c0703d5e6a70c45c36e9c364cdd8337eae836c6e","modified":1510304484283},{"_id":"source/images/tutorial-angular-5_2_SPA.jpg","hash":"59e36a08cc7180cccee8b049f4c81df85ed21577","modified":1510651511819},{"_id":"source/scaffolds/draft.md","hash":"b14e9fa1e21c75482dd3f05d27705719a2cb47f1","modified":1509446804448},{"_id":"source/scaffolds/page.md","hash":"892cedeb7b62a73e72a3b369daf2bc63dfee47dc","modified":1509446804450},{"_id":"source/scaffolds/post.md","hash":"c569840f0ea232daf0865c3bc8f7ef63b235be62","modified":1509446804452},{"_id":"themes/icarus/languages/es.yml","hash":"aff832ad099fdeac148c643360df44d0a7f59874","modified":1510308289513},{"_id":"themes/icarus/languages/fr.yml","hash":"7b386bf21226433cb7da7989aba07ce33da5b359","modified":1509446939350},{"_id":"themes/icarus/languages/id.yml","hash":"83021037b6dad8dd48f48e3b4a822d07d56fc272","modified":1509446939352},{"_id":"themes/icarus/languages/en.yml","hash":"2b888a89957e07f440452a12ef338af979abb4c6","modified":1509446939345},{"_id":"themes/icarus/languages/pt-BR.yml","hash":"3cf767f94766ac3a93d6efb9ef954e20d16b2b44","modified":1509446939360},{"_id":"themes/icarus/languages/ko.yml","hash":"5e6e5b5d20c940cf0be26957f3a3f6a141f338e0","modified":1509446939357},{"_id":"themes/icarus/languages/ja.yml","hash":"e13df67ba3666c0d95d60c081e41fb86f6f48663","modified":1509446939355},{"_id":"themes/icarus/languages/zh-CN.yml","hash":"fdce6e6716768cfac9355c4e88a05260efeeae1c","modified":1509446939367},{"_id":"themes/icarus/languages/ru.yml","hash":"7423608a9608766ab5998d6b8d3e8d76b792e30e","modified":1509446939362},{"_id":"themes/icarus/languages/zh-TW.yml","hash":"646a7ef3e85481b013ffb2f4d9f9a8900f092d73","modified":1509446939369},{"_id":"themes/icarus/languages/tr.yml","hash":"50d94b21e1838db1214f6874f4f81b47c8c521db","modified":1509446939364},{"_id":"themes/icarus/layout/category.ejs","hash":"1d407f9176db84e83062c52ad4755aaea9e74401","modified":1509446939378},{"_id":"themes/icarus/layout/categories.ejs","hash":"7be3918bcfb9f04b5213aeda4ad19c952128bee3","modified":1509446939375},{"_id":"themes/icarus/layout/page.ejs","hash":"50170783bac99946ae8af483920568de9b2d9801","modified":1509446939460},{"_id":"themes/icarus/layout/post.ejs","hash":"50170783bac99946ae8af483920568de9b2d9801","modified":1509446939472},{"_id":"themes/icarus/layout/tag.ejs","hash":"f6c220d4e5c231028bc71ddc11aec97d7b5a9943","modified":1509446939502},{"_id":"themes/icarus/layout/layout.ejs","hash":"b37ed400e1416964b45ff7d0fa64417d2172962a","modified":1509973309963},{"_id":"themes/icarus/layout/index.ejs","hash":"c329f4598a0af4d8678ba789fdc84fcdf10122de","modified":1509446939455},{"_id":"themes/icarus/scripts/meta.js","hash":"2e5ac0cb9c90c072ca4b33e88f1892e954935ab7","modified":1509446939528},{"_id":"themes/icarus/scripts/thumbnail.js","hash":"4a7385e533f3567758bc995a8be5eb3e7839ac9c","modified":1509446939530},{"_id":"themes/icarus/layout/archive.ejs","hash":"6a4adb703df447a754225fa665e679816e432ea2","modified":1509446939373},{"_id":"themes/icarus/layout/tags.ejs","hash":"2a5b11bdf0dbf7300e11eae34bba00490ed77a0f","modified":1509446939505},{"_id":"source/images/tutorial-angular-5_5_inject.png","hash":"458734e566681aacd4a3d7f1fa43e2b1609db0d4","modified":1513589952031},{"_id":"themes/icarus/_source/categories/index.md","hash":"62fe9cd3a09f7971c8bfb84f18ed7863f84cb30a","modified":1509446939338},{"_id":"themes/icarus/_source/about/index.md","hash":"3c9b7a6853bfcdd019317c95f2aa33829b269cbc","modified":1509446939335},{"_id":"themes/icarus/layout/comment/disqus.ejs","hash":"b83fd91a30ca2bd62e2d43ae48e0523e0e1994c0","modified":1509446939386},{"_id":"themes/icarus/_source/tags/index.md","hash":"f913370f50299b9b8b4cfd73fbdd5c07f4950549","modified":1509446939342},{"_id":"themes/icarus/layout/comment/duoshuo.ejs","hash":"adc024b7205e934e64c98a5b912c41117a4425bd","modified":1509446939388},{"_id":"themes/icarus/layout/comment/changyan.ejs","hash":"67b9c24a2973bb208e183ce46201d3c209a1bd4a","modified":1509446939381},{"_id":"themes/icarus/layout/comment/counter.ejs","hash":"f744b41f3cc258e2a5a6df6abf6cf9ba9f05c19c","modified":1509446939384},{"_id":"themes/icarus/layout/comment/facebook.ejs","hash":"6a53104fc01fd4a7a34b46c2828e76d02cacb0dd","modified":1509446939391},{"_id":"themes/icarus/layout/comment/isso.ejs","hash":"b3dd067a6099f0e088f3374d37b8a726bafe15e5","modified":1509446939399},{"_id":"themes/icarus/layout/comment/gitment.ejs","hash":"c7998209b9a766eeba6976dd4bdffb1f87469358","modified":1509446939394},{"_id":"themes/icarus/layout/comment/valine.ejs","hash":"0ea90a606f0d386a5ae0da83c0501cbb25319fde","modified":1509446939408},{"_id":"themes/icarus/layout/comment/livere.ejs","hash":"d2d0d8113a5a7d2cddf1d8ce067e07d40874e56c","modified":1509446939401},{"_id":"themes/icarus/layout/comment/index.ejs","hash":"7269156a9d99b238f6394b4e7e52d0439e774eb3","modified":1509446939396},{"_id":"themes/icarus/layout/comment/youyan.ejs","hash":"b4c49b97b757d01ba0c4e16f9862a2ec05f37b1f","modified":1509446939410},{"_id":"themes/icarus/layout/common/article.ejs","hash":"ade5193772028603e627636fb1082b00dab7d6e2","modified":1541751294128},{"_id":"themes/icarus/layout/common/footer.ejs","hash":"39970201c684e19eba4d3db6db192e78bb695d66","modified":1510563484415},{"_id":"themes/icarus/layout/common/header.ejs","hash":"c75d5c3e956f70b0b82552f1e3f5749f0229ddd7","modified":1509446939421},{"_id":"themes/icarus/layout/comment/scripts.ejs","hash":"063f997bad70768fa3a7f954830b51893b2d48da","modified":1509446939405},{"_id":"themes/icarus/layout/common/scripts.ejs","hash":"7be8d835b664085758f0ea550e3180c05de6f2b7","modified":1513770864633},{"_id":"themes/icarus/layout/common/head.ejs","hash":"6b6063ff2f8f65cb4ce3fc6d197a81d30f813017","modified":1509446939419},{"_id":"themes/icarus/layout/common/sidebar.ejs","hash":"ba03c02607a3330b03727a12ecbbafe9cc3ee450","modified":1509446939448},{"_id":"themes/icarus/layout/common/profile.ejs","hash":"85b954b54deb9e5de46441a61a0d6ff1cf0522c6","modified":1545380575706},{"_id":"themes/icarus/layout/common/thumbnail.ejs","hash":"b80d8733a620be64a6f7d73f0b012a986755fd91","modified":1509446939451},{"_id":"themes/icarus/layout/plugin/google-analytics.ejs","hash":"760a8f9ee9b81f6eb27a5f2c8c5159b220a88a74","modified":1509446939467},{"_id":"themes/icarus/layout/plugin/baidu-analytics.ejs","hash":"3218b9f6345aaa537f742ab4781bd27a3f40c378","modified":1509446939465},{"_id":"themes/icarus/layout/common/timeline.ejs","hash":"a2ba07bd70a82a80df71133dc0cea1248a1e3b3e","modified":1509446939453},{"_id":"themes/icarus/layout/search/index.ejs","hash":"fb1ac5d6b44dbc96cbef7ecdbb6397c3d4fe3e0f","modified":1509446939480},{"_id":"themes/icarus/layout/search/index-mobile.ejs","hash":"8e2e28b37a908f60e4953bf9175a7af329d15d40","modified":1509446939478},{"_id":"themes/icarus/layout/search/swiftype.ejs","hash":"cce9c44180d9490f45b30b8f052ac82675a9d66a","modified":1509446939486},{"_id":"themes/icarus/layout/search/insight.ejs","hash":"21ec59e4534ac2417d6b215b6cfe3825245ad340","modified":1509446939483},{"_id":"themes/icarus/layout/share/addtoany.ejs","hash":"b79f714da69c121729a136df0c94c09a85966d44","modified":1509446939490},{"_id":"themes/icarus/layout/share/bdshare.ejs","hash":"d2a0826700c51d9edaf21fa6cbb047b5127cec8a","modified":1509446939492},{"_id":"themes/icarus/layout/share/default.ejs","hash":"8532f15f400dbc7c1e89ab26972fc4e404001849","modified":1509446939495},{"_id":"themes/icarus/layout/search/baidu.ejs","hash":"8cc6f6e601b14d310f20eaf29dc55d6c60ab4ee4","modified":1509446939476},{"_id":"themes/icarus/layout/share/index.ejs","hash":"52c094140d19e7e2fce57fe43968b2bd86aa4ef0","modified":1509446939497},{"_id":"themes/icarus/layout/share/jiathis.ejs","hash":"442abbc0fe5cab4171179257d172150f2a789638","modified":1509446939500},{"_id":"themes/icarus/layout/widget/archive.ejs","hash":"d6412cd574744f994f16e3a70ce29a71b449133a","modified":1509446939508},{"_id":"themes/icarus/layout/widget/category.ejs","hash":"81c6c0a3450e1ab56a725bb953a5021a07c0e212","modified":1509446939511},{"_id":"themes/icarus/layout/widget/links.ejs","hash":"23d637daed63e86ec7c4a12f5a48908905ed7819","modified":1509446939513},{"_id":"themes/icarus/layout/widget/tag.ejs","hash":"cf8a87b0573c9ff11d82ca5edb86267f77e11589","modified":1509446939517},{"_id":"themes/icarus/layout/plugin/scripts.ejs","hash":"2a41940ab86d3f7b095436b56ea304689c2b5121","modified":1509446939470},{"_id":"themes/icarus/layout/widget/tagcloud.ejs","hash":"a4b28996e0e7df2e582387455c02f5c33f691bbd","modified":1509446939519},{"_id":"themes/icarus/source/css/_extend.styl","hash":"c18c58c67f49b8afe92fa8852ff7e203ce5958de","modified":1509446939535},{"_id":"themes/icarus/source/js/insight.js","hash":"691bc7ce086b55b360bb6ec517b2ad6e53ebadc7","modified":1509446939766},{"_id":"themes/icarus/source/js/main.js","hash":"aaea695ac93046f3024db7634baf6f4400f4920c","modified":1535976312066},{"_id":"themes/icarus/source/css/style.styl","hash":"4dc397810fe188ac58166754b667f1891c1518c0","modified":1510304484297},{"_id":"themes/icarus/source/css/_variables.styl","hash":"da60cf824c9e905aca1f002e417a3c61864b6883","modified":1510747314737},{"_id":"themes/icarus/layout/common/post/banner.ejs","hash":"431b445dfa5dec4b710069c7f1b5fae3f0a907a5","modified":1509446939426},{"_id":"themes/icarus/layout/common/post/date.ejs","hash":"fc90dbfc227563029ece7cff13585083b62935bc","modified":1509446939431},{"_id":"themes/icarus/layout/widget/recent_posts.ejs","hash":"7767972b9d0cba456f0e0cff1b96b516936414ea","modified":1509446939515},{"_id":"themes/icarus/layout/common/post/nav.ejs","hash":"79d15e00ead668bf44a48f4e870ac0cde9dbdee3","modified":1509446939437},{"_id":"themes/icarus/layout/common/post/gallery.ejs","hash":"6ca8a8c45794a4e10aaac0da85db71b43e5a72ce","modified":1535976257417},{"_id":"themes/icarus/layout/common/post/title.ejs","hash":"3620e4dad9c7f9c31efd4ad6cf5872cfb9d418c2","modified":1509446939442},{"_id":"themes/icarus/layout/common/post/category.ejs","hash":"96f999573eb908f7129a1c09e486d46d630c0a7d","modified":1509446939429},{"_id":"themes/icarus/source/css/_highlight/androidstudio.styl","hash":"b0923fe15d0b5eb24d3c6236cb2fc30ee14a4c56","modified":1509446939542},{"_id":"themes/icarus/source/css/_highlight/agate.styl","hash":"c01db6c4e7648b217048a8deefeee189688a9290","modified":1509446939539},{"_id":"themes/icarus/source/css/_highlight/arduino-light.styl","hash":"591962bfc758a521b4cb907750c19a1a2423b4d5","modified":1509446939544},{"_id":"themes/icarus/layout/common/post/tag.ejs","hash":"7df16851b35da0ea09f7323bdbfb977198823f4c","modified":1509446939439},{"_id":"themes/icarus/source/css/_highlight/ascetic.styl","hash":"ca087a3c70998c7ac6b0b42d5cf7a653b8707591","modified":1509446939549},{"_id":"themes/icarus/source/css/_highlight/atelier-dune-dark.styl","hash":"68021a92fd7d6895426d0cc7f0929aa95633d742","modified":1509446939556},{"_id":"themes/icarus/source/css/_highlight/arta.styl","hash":"3bc322455f657aa29f455f91009034af08cdc65c","modified":1509446939546},{"_id":"themes/icarus/source/css/_highlight/atelier-cave-light.styl","hash":"f47de0b9d66617728f68096ed48371dd6bb9e67a","modified":1509446939554},{"_id":"themes/icarus/source/css/_highlight/atelier-cave-dark.styl","hash":"a6b1960d8a3b39d035e06ce92af4f00a259b5c56","modified":1509446939551},{"_id":"themes/icarus/source/css/_highlight/atelier-estuary-dark.styl","hash":"6c051f034c229c49ffc9a2ec96c032441b0c6586","modified":1509446939561},{"_id":"themes/icarus/source/css/_highlight/atelier-forest-dark.styl","hash":"15559324ee3a5f9bf6724ec9606f6f2e16cdc24d","modified":1509446939566},{"_id":"themes/icarus/source/css/_highlight/atelier-estuary-light.styl","hash":"2b416a0567a53aa0fa8898b196ddd44315c1a5f3","modified":1509446939563},{"_id":"themes/icarus/source/css/_highlight/atelier-dune-light.styl","hash":"657fe215931fd06e21b56374df699a94890f7ab4","modified":1509446939558},{"_id":"themes/icarus/source/css/_highlight/atelier-heath-light.styl","hash":"c1db353e8613607580d40b12ddc162d029560576","modified":1509446939574},{"_id":"themes/icarus/source/css/_highlight/atelier-heath-dark.styl","hash":"bf62cafe316eb874f1f43679957dc3add4fbea34","modified":1509446939571},{"_id":"themes/icarus/source/css/_highlight/atelier-forest-light.styl","hash":"8d7c7242974aa2454fa792c5d7a47c5f9632355a","modified":1509446939569},{"_id":"themes/icarus/source/css/_highlight/atelier-lakeside-dark.styl","hash":"64ab6ab93a092a890d3d0fdeb23e4b6a2d0f2887","modified":1509446939576},{"_id":"themes/icarus/source/css/_highlight/atelier-lakeside-light.styl","hash":"8659eaae6a0c2e00b4b9199803e50adf4ff0128d","modified":1509446939579},{"_id":"themes/icarus/source/css/_highlight/atelier-plateau-dark.styl","hash":"8a6c187afcd60152306c003e1a5903e57d9428dd","modified":1509446939583},{"_id":"themes/icarus/source/css/_highlight/atelier-plateau-light.styl","hash":"96181544eeadc5b0749229f11607e7c01f81e078","modified":1509446939586},{"_id":"themes/icarus/source/css/_highlight/atelier-savanna-dark.styl","hash":"5261a100e84cf34f4752c24dfaddfa05c7be96f7","modified":1509446939589},{"_id":"themes/icarus/source/css/_highlight/atelier-seaside-dark.styl","hash":"434b7f0bdd5f91bf79d5b4ca46820db4a8e10166","modified":1509446939595},{"_id":"themes/icarus/source/css/_highlight/atelier-savanna-light.styl","hash":"8a5207a0c30262a0bf5e1a41411a306f7a89a7e7","modified":1509446939592},{"_id":"themes/icarus/source/css/_highlight/atelier-seaside-light.styl","hash":"08e2df313c272d5c70c93e713639663c168180d0","modified":1509446939597},{"_id":"themes/icarus/source/css/_highlight/atelier-sulphurpool-dark.styl","hash":"fa0cccd0f0dc015218cf8c1bba0b53c8c9383135","modified":1509446939600},{"_id":"themes/icarus/source/css/_highlight/atelier-sulphurpool-light.styl","hash":"add3d88c9d12567dcfae7a8e49984d119fc72227","modified":1509446939602},{"_id":"themes/icarus/source/css/_highlight/brown-paper.styl","hash":"d14846542a26b75fd26df5b5df6c5493733f73f6","modified":1509446939604},{"_id":"themes/icarus/source/css/_highlight/dark.styl","hash":"df4c1dc05567ad0812d0cd3133cb2a2a5fd23c04","modified":1509446939616},{"_id":"themes/icarus/source/css/_highlight/codepen-embed.styl","hash":"7432ce9edb047b6382d28c82054a7e2a77e476c3","modified":1509446939611},{"_id":"themes/icarus/source/css/_highlight/docco.styl","hash":"7bd3389ce16d20488ab336d557056cc703c921c7","modified":1509446939620},{"_id":"themes/icarus/source/css/_highlight/far.styl","hash":"5989aea14ccd0153d17ee19b3e125dae06c75f3c","modified":1509446939623},{"_id":"themes/icarus/source/css/_highlight/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1509446939607},{"_id":"themes/icarus/source/css/_highlight/foundation.styl","hash":"28c59a31467c33bd51cbf3b6085782c2a724ff6c","modified":1509446939625},{"_id":"themes/icarus/source/css/_highlight/color-brewer.styl","hash":"9c4905eab730d0b389e6972e907057577f7e25f1","modified":1509446939612},{"_id":"themes/icarus/source/css/_highlight/darkula.styl","hash":"3c943561a885092286ec8db14e9177036bf8d21f","modified":1509446939618},{"_id":"themes/icarus/source/css/_highlight/github-gist.styl","hash":"71f4b0fca91a587e6eba15a5306dca963bb8f441","modified":1509446939629},{"_id":"themes/icarus/source/css/_highlight/github.styl","hash":"a84eb710b302006120c3e7f8ca18f9e6fbc231c3","modified":1509446939630},{"_id":"themes/icarus/source/css/_highlight/googlecode.styl","hash":"7f5082ae008925a23eb713f160773fe647eb3ff7","modified":1509446939632},{"_id":"themes/icarus/source/css/_highlight/highlightjs.styl","hash":"fd796a58c5d4590cda67c998187933788d45f30a","modified":1509446939639},{"_id":"themes/icarus/source/css/_highlight/hybrid.styl","hash":"d3ee1bcefc94f5f87a2b76a689f4c31594501d07","modified":1509446939643},{"_id":"themes/icarus/source/css/_highlight/hopscotch.styl","hash":"7ec8d75a9c9d58f65868ea64289873302d3fad5e","modified":1509446939641},{"_id":"themes/icarus/source/css/_highlight/idea.styl","hash":"e284c1760e8da0848f56cd5601d867ceeb0192d7","modified":1509446939646},{"_id":"themes/icarus/source/css/_highlight/index.styl","hash":"36c44375229613a5bb9ee84a8e90214978070439","modified":1509446939648},{"_id":"themes/icarus/source/css/_highlight/ir-black.styl","hash":"c59db73998af32ce8419a5d2d335bcc9cfbaae45","modified":1509446939650},{"_id":"themes/icarus/source/css/_highlight/kimbie.dark.styl","hash":"3b998c640eeb2c6192fee24bc78b4137de475dd7","modified":1509446939653},{"_id":"themes/icarus/source/css/_highlight/kimbie.light.styl","hash":"e901738455ec9a1bddde7b62bbd8595de6033e1e","modified":1509446939655},{"_id":"themes/icarus/source/css/_highlight/grayscale.styl","hash":"c83804abe39faebd80f8f4ff64fbd7137674cb1c","modified":1509446939635},{"_id":"themes/icarus/source/css/_highlight/magula.styl","hash":"ab179306c12a1cf2949482beaca328e379ef034a","modified":1509446939658},{"_id":"themes/icarus/source/css/_highlight/mono-blue.styl","hash":"14fb8678739b77f35771b6d63101ddbf1e7a9fbc","modified":1509446939660},{"_id":"themes/icarus/source/css/_highlight/monokai.styl","hash":"8489fc71bedefa8f271808126296fce6381f9e04","modified":1509446939666},{"_id":"themes/icarus/source/css/_highlight/monokai-sublime.styl","hash":"32955f699687b5fc2e4072804cb90925912d3c7c","modified":1509446939663},{"_id":"themes/icarus/source/css/_highlight/paraiso-dark.styl","hash":"50f1cee8a5b3b165b4184ead0a99dc564b62ef4f","modified":1509446939670},{"_id":"themes/icarus/source/css/_highlight/pojoaque.styl","hash":"d9f4b35c9f6115029600a8a023b559013e2b4e75","modified":1509446939677},{"_id":"themes/icarus/source/css/_highlight/paraiso-light.styl","hash":"e428e8202b01e83b0f018a96058d806e7f4c76bf","modified":1509446939673},{"_id":"themes/icarus/source/css/_highlight/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1509446939686},{"_id":"themes/icarus/source/css/_highlight/pojoaque.jpg","hash":"c5fe6533b88b21f8d90d3d03954c6b29baa67791","modified":1509446939675},{"_id":"themes/icarus/source/css/_highlight/railscasts.styl","hash":"1ff800d9b6de464fafe591682cc48bf983202758","modified":1509446939680},{"_id":"themes/icarus/source/css/_highlight/rainbow.styl","hash":"516c7080d64b12730357358dee2adc42c43c4516","modified":1509446939683},{"_id":"themes/icarus/source/css/_highlight/school-book.styl","hash":"186c37e9c39e65aa291cce3317e35904693598d1","modified":1509446939689},{"_id":"themes/icarus/source/css/_highlight/solarized-dark.styl","hash":"577458d1f6c02bc42e312066bf7dd7e427cab057","modified":1509446939691},{"_id":"themes/icarus/source/css/_highlight/solarized-light.styl","hash":"bb04944fc06c12ecd7b56ad933dbedde60c2259a","modified":1509446939693},{"_id":"themes/icarus/source/css/_highlight/sunburst.styl","hash":"482bbb2bc461b22e9d6ce55f0f84767e1cfae99a","modified":1509446939696},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night-blue.styl","hash":"eeafa86697c857c4e9a84ad48c0d56a7154997a3","modified":1509446939698},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night-bright.styl","hash":"f3cd5ed391d40265e36fcd9f7daced52773fb886","modified":1509446939701},{"_id":"themes/icarus/source/css/_highlight/tomorrow.styl","hash":"502335f0fac07ed74ca78207bcf3ef8dd2252cf6","modified":1509446939708},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night-eighties.styl","hash":"1cd947f3d414fa5c1435caea509f27c99f6dc5b3","modified":1509446939703},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night.styl","hash":"b2a175caa23631f764b2f6fe2bac9739f5f5e078","modified":1509446939705},{"_id":"themes/icarus/source/css/_highlight/obsidian.styl","hash":"8145db8ec349548f09d91d7a05c00c83ff84d146","modified":1509446939668},{"_id":"themes/icarus/source/css/_highlight/vs.styl","hash":"14fbb0c43af440a290280b26968c8a5c0786b27f","modified":1509446939710},{"_id":"themes/icarus/source/css/_highlight/zenburn.styl","hash":"6908313d2666d31fc9d8658fd7e8dda3de2bb596","modified":1509446939715},{"_id":"themes/icarus/source/css/_partial/archive.styl","hash":"4dd216a147dd65ddc37521fe8a1a01aa929aeea5","modified":1509446939719},{"_id":"themes/icarus/source/css/_partial/article.styl","hash":"acd8966e8f986baca6659ad7418dce13860898a8","modified":1509446939722},{"_id":"themes/icarus/source/css/_highlight/xcode.styl","hash":"5fa8999c7f807c1aae29c7a1cdf681678576fb69","modified":1509446939713},{"_id":"themes/icarus/source/css/_partial/footer.styl","hash":"06c2c9029ebfb16880a203c218657048a83a3e4b","modified":1509446939726},{"_id":"themes/icarus/source/css/_partial/comment.styl","hash":"7fc8a32cf235d0a977d9ff0c49263c0541025222","modified":1509446939723},{"_id":"themes/icarus/source/css/_partial/header.styl","hash":"d0109f33d279a3456317c342d84633ffe08a8b10","modified":1509969634631},{"_id":"themes/icarus/source/css/_partial/profile.styl","hash":"7eed2cec34bd182c390bf042b56d41f7f2793a2c","modified":1509450250242},{"_id":"themes/icarus/source/css/_partial/insight.styl","hash":"8a84868a13c7edb733347655b33dc169c682e8b8","modified":1509446939732},{"_id":"themes/icarus/source/css/_partial/sidebar.styl","hash":"fb211c3c747565e6fa2304f436b42d14ef84d71a","modified":1509446939737},{"_id":"themes/icarus/source/css/_partial/timeline.styl","hash":"ba1ea8a87ca7c667f0d3cc40033b52bdf168fbdd","modified":1509446939740},{"_id":"themes/icarus/source/css/images/angular-5_1_Base.jpg","hash":"ea08145cbdba702d36cb7224ce69e07c67535c8a","modified":1510304484293},{"_id":"themes/icarus/source/css/images/angular-5_2_SPA.jpg","hash":"0f66402199156fd57f392651d4f6abd5e58427ac","modified":1510651511821},{"_id":"themes/icarus/source/css/images/angular-5_0_cli_1-5.jpg","hash":"7335e8443686636affbc0e181d56336cc6f3c412","modified":1510058134264},{"_id":"themes/icarus/source/css/images/angular-5_3_data.jpg","hash":"83af62c8c867a1cda51e4b7043974ddb23066549","modified":1510737703388},{"_id":"themes/icarus/source/css/images/avatar.jpg","hash":"6d461314157540948b0b35d63fe9dda8c2fa4665","modified":1509450250249},{"_id":"themes/icarus/source/css/images/angular.jpg","hash":"6bf224d00bb2f792e52fbe936ac5abf2aa1332c0","modified":1509451334605},{"_id":"themes/icarus/source/css/images/thumb-default-small.png","hash":"e8403b97ed9251f9f5207765b0ce796c5000b4ba","modified":1509446939760},{"_id":"themes/icarus/source/libs/justified-gallery/jquery.justifiedGallery.min.js","hash":"1c7fd3bd976f671ba396ad4dbbb7157006243bf5","modified":1509446939837},{"_id":"themes/icarus/source/css/_util/mixin.styl","hash":"3f8730ec2b1b582ba93b14f0e50a41fbbce52755","modified":1509446939746},{"_id":"themes/icarus/source/css/images/favicon.ico","hash":"eaf485c235ca3d83faf3d38064a6e0f1df3d14fa","modified":1534174777336},{"_id":"themes/icarus/source/css/_util/grid.styl","hash":"866fc18d6368c4131b03601a15af7703a9a42b61","modified":1509446939744},{"_id":"themes/icarus/source/libs/justified-gallery/justifiedGallery.min.css","hash":"45fa2fad51cecfc41107dbd4637450b746a7cbc3","modified":1509446939840},{"_id":"source/images/tutorial-angular-5_7_watch.png","hash":"9a57c25a70a9b7df34158cf36981b576beb7aba4","modified":1514545729287},{"_id":"themes/icarus/source/libs/open-sans/styles.css","hash":"08c8c7eeaf34cb2f8c3312a3ce2e96b58ce2b4c0","modified":1509446940007},{"_id":"themes/icarus/source/libs/source-code-pro/styles.css","hash":"6335d719343cca455152ad71a1aaed9868339236","modified":1509446940019},{"_id":"themes/icarus/source/css/images/angular-5_4_flow.png","hash":"ff98aa46c87f87ffc36dba1429a049a5affbb5f3","modified":1511261923220},{"_id":"themes/icarus/source/css/images/angular-5_6_http.png","hash":"df079e13b1675d8358835a29284222d174d934c1","modified":1513591888828},{"_id":"themes/icarus/source/css/images/angular-5_5_inject.png","hash":"1346c74f82cbd279e9ed29925cc0ee0cccf172f0","modified":1513589952036},{"_id":"themes/icarus/source/css/images/angular-5_7_watch.png","hash":"a514e6aa09e7b97f761e1c7aec2e63d5e0052c8f","modified":1514545282976},{"_id":"themes/icarus/source/css/images/logo.png","hash":"3ea04c5059266f2614f2fe37ebd81b6e8acb8a3c","modified":1509450250254},{"_id":"themes/icarus/source/css/images/typescript.jpg","hash":"f49a461df54b6d5eb9c14d921d7ee8689b10ec22","modified":1509451334613},{"_id":"source/images/tutorial-angular-5_6_http.png","hash":"9bf52095875d3ae1cd5901f2d4d7aee88d90029d","modified":1513591867464},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.css","hash":"bf188c224998b995d0119cfd18fade22e53f573c","modified":1509446939776},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.min.css","hash":"bd7c2763e15e568bdccc85e38432d79f65f8d9a1","modified":1509446939779},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css.map","hash":"5281d2cfb0ef278940c4860ea9aa7ef86d3dbc8d","modified":1509446939848},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css","hash":"10c9630e41bb8d6bb7f75a3bfe8cdb33451ed7ba","modified":1509446939846},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.min.css","hash":"05830fadb8454f39dcc98c8686eb4d5c24b71fc0","modified":1509446939851},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.min.css","hash":"5c22e2073a4c96d6212c72135391b599e8d1359f","modified":1509446939860},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css","hash":"2866c3f1eda31ed34485ff3511bcfb706d78ac56","modified":1509446939854},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css.map","hash":"6ee19f99bca3ecf2fa0d6f07fb5c200db07ddd11","modified":1509446939857},{"_id":"themes/icarus/source/libs/lightgallery/img/loading.gif","hash":"607810444094b8619fa4efa6273bc2a7e38dd4b4","modified":1509446939884},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css","hash":"d26b528a13ee1ef245bdb0aa3db149be3fe9cba6","modified":1509446939863},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.min.css","hash":"c9a2e19c932b56f4a2ce30c98910d10b74edb38a","modified":1509446939869},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css.map","hash":"91788030e3c7107b6b4bf50a82d4309368850488","modified":1509446939866},{"_id":"themes/icarus/source/libs/lightgallery/img/video-play.png","hash":"3ea484cdc04d2e4547f80cbf80001dcf248c94ef","modified":1509446939886},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.ttf","hash":"f6421c0c397311ae09f9257aa58bcd5e9720f493","modified":1509446939878},{"_id":"themes/icarus/source/libs/lightgallery/img/youtube-play.png","hash":"fea6df9d9d43151f9c9d15f000adb30eb3e26fc4","modified":1509446939891},{"_id":"themes/icarus/source/libs/lightgallery/img/vimeo-play.png","hash":"6190254f2804904a4a1fa1eb390dfd334e416992","modified":1509446939888},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.eot","hash":"54caf05a81e33d7bf04f2e420736ce6f1de5f936","modified":1509446939873},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.svg","hash":"3480f00d284c812d623ed16a9e0ead3fb964c72e","modified":1509446939875},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.min.js","hash":"44203a1490749aff6aba9784868b6c888d3fb86e","modified":1509446939898},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.js","hash":"6369e9704550f4207fa798dc6018da1d259fd318","modified":1509446939900},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.js","hash":"ba52bd55c0ab647e277c42b0e48a0ac25cbd3099","modified":1509446939895},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.min.js","hash":"a5c468d260e3a8e68c9026aa2b5f31ce1860b8bf","modified":1509446939903},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.min.js","hash":"fbdbcb46ae9fd668ba5e4dce5635c040359e3359","modified":1509446939909},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.js","hash":"562f883ba3a5e8ea570fd5d0c40afe527938c026","modified":1509446939911},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.min.js","hash":"ec662f97ed5a15c2bd8cf87d5c93cd9a6b4df07a","modified":1509446939914},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.js","hash":"8a026dc31f912cbd3b8a110bb87984b372661f65","modified":1509446939906},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.min.js","hash":"afe725882964c87a148ac6ab54955cb0da0974c4","modified":1509446939920},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.js","hash":"b000585441e9bff2f5b7c538d623b698d48049a6","modified":1509446939917},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.min.js","hash":"e570807e2786a0acb393c1195c820a660312fffe","modified":1509446939925},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.js","hash":"11c8509a3e398cb8c2a32ff559ccdda6d9d71740","modified":1509446939928},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.min.js","hash":"050e7684bfbb133bed5375938fe0021f1fa88f7f","modified":1509446939931},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.min.js","hash":"8daabc26ceadc43741904b99db7e01bfababbd04","modified":1509446939936},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.js","hash":"6d424527be45ff4deedd198e195fdeb74f1c6567","modified":1509446939940},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.js","hash":"99fe3cc63161f0d678360a939fbd54c5d1c11eeb","modified":1509446939922},{"_id":"themes/icarus/source/libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","hash":"c4248ea800bd5608344ce163f5658b57e7ef9410","modified":1509446939948},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.min.js","hash":"dc9c6447d3574fcba3868c35bb48e0bed9be6b7e","modified":1509446939943},{"_id":"themes/icarus/source/libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","hash":"2c5b039b57f62625e88226a938679ec937431ad1","modified":1509446939953},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.js","hash":"69a127964e508699f5f13467dd1b58fbf04bcca9","modified":1509446939934},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.woff","hash":"3048de344dd5cad4624e0127e58eaae4b576f574","modified":1509446939881},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","hash":"22413bb8bfb78608c1e25aa1ed5c1f38557df79f","modified":1509446939956},{"_id":"themes/icarus/source/libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","hash":"e0350190d720a8fec0557ab47b318ec4e4486448","modified":1509446939950},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","hash":"63eb74ef040aade256f2274a7f31a914edddb0ea","modified":1509446939959},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","hash":"328a22fe3eec71ad9e5ece4d67dd62e79dab6b7f","modified":1509446939962},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","hash":"4dc6d7174ea6d89f4c45e43e1bfc3e03d8ffebaf","modified":1509446939965},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","hash":"a0b0c389cf46d63c850e61fed572485ff0b68183","modified":1509446939970},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","hash":"415eee05976ab8b2471602a5ddb78a6c58fc21aa","modified":1509446939967},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","hash":"c5f29fed6632efe0aa83318369f0d8c4061b775b","modified":1509446939972},{"_id":"themes/icarus/source/libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","hash":"be201d32a9aa5d186723ebb3c538be691aa8c53a","modified":1509446939975},{"_id":"themes/icarus/source/libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","hash":"113978181dcac77baecef6115a9121d8f6e4fc3a","modified":1509446939980},{"_id":"themes/icarus/source/libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","hash":"afc44700053c9a28f9ab26f6aec4862ac1d0795d","modified":1509446939978},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","hash":"5067c81462c15422853c94d21a1726865a61634f","modified":1509446939984},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","hash":"d22904914469be735490e3c8cb093c7862896dd5","modified":1509446939989},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","hash":"b366f2fda2e524eb5ef50058eefff249a3b96e6c","modified":1509446939987},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","hash":"ae80fb3cd16339aa7b5da280ab53975523dcaac2","modified":1509446939992},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","hash":"d0b40a7848703556c6631f24e961a98ca5829255","modified":1509446940000},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","hash":"e75607ba1417181397c700775b84303d5a2957b9","modified":1509446939997},{"_id":"themes/icarus/source/libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","hash":"be365eca44760ce3fc9b377c43d4634958479c69","modified":1509446940003},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","hash":"942addaec4d3a60af33947a84a3d85f926015947","modified":1509446940013},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","hash":"b0e0bb5ef78db8b15d430d0b9be9d4329289a310","modified":1509446940017},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","hash":"b85efde42fa3a03c32b1d31c6cd74c622fc7916c","modified":1509446939995},{"_id":"themes/icarus/source/libs/font-awesome/fonts/FontAwesome.otf","hash":"1b22f17fdc38070de50e6d1ab3a32da71aa2d819","modified":1509446939788},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff","hash":"6d7e6a5fc802b13694d8820fc0138037c0977d2e","modified":1509446939822},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff2","hash":"97e438cc545714309882fbceadbf344fcaddcec5","modified":1509446939826},{"_id":"themes/icarus/source/libs/jquery/2.1.3/jquery.min.js","hash":"17a740d68a1c330876c198b6a4d9319f379f3af2","modified":1509446939833},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.eot","hash":"965ce8f688fedbeed504efd498bc9c1622d12362","modified":1509446939792},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.ttf","hash":"61d8d967807ef12598d81582fa95b9f600c3ee01","modified":1509446939819},{"_id":"source/images/tutorial-angular-5_0_cli.png","hash":"04e1e7389ac0ca3df252f57ec6d71b65c2ebdde7","modified":1511261923163},{"_id":"source/images/tutorial-angular-5_2_SPA.png","hash":"e286e70682ca3c755cdb3384cb4ac1a0af8ec04a","modified":1511261923194},{"_id":"source/images/tutorial-angular-5_4_flow.png","hash":"110b6e20c4fce1ebd8780ae3bf941b578ffa5c07","modified":1511261923214},{"_id":"source/images/tutorial-angular-5_3_data.png","hash":"ff060c2ec61c8aef97706c1363626300b22a3309","modified":1510748733406},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.svg","hash":"964e8dac2cee79c4b49b5bc300675773f6518812","modified":1509446939808},{"_id":"source/images/tutorial-angular-5_1_base.png","hash":"cc4cc962622e78046f354d3886fe98e784d4527a","modified":1511261923178},{"_id":"public/images/ng2-Arbol-de-componentes.jpg","hash":"981461824a8b8c4be309e0f45b2f6e77b0ce3975","modified":1514551310594},{"_id":"public/images/ng2-Arbol-de-dependencias.jpg","hash":"4aa93110fbb2a84d15436432b103b369368411b9","modified":1514551310595},{"_id":"public/images/ng2-DI-component-directive.jpg","hash":"55f9382deef44c734bf892571df3127f88871939","modified":1514551323923},{"_id":"public/images/ng2-Component-DataFlow.jpg","hash":"b9a22cc89d665491b54e2d0e7a94bd6b19a11aa2","modified":1514551323923},{"_id":"public/images/ng2-DI-component-service.jpg","hash":"3e387e0e2b3b2bd40004b569f83cd2b74f3363e4","modified":1514551323962},{"_id":"public/images/ng2-Flujo-de-datos.jpg","hash":"b791adc0f1322b16145d23e2479fc0a1b95f5846","modified":1514551323963},{"_id":"public/images/ng2Component--1-.jpg","hash":"8e13a6985d532c4413ab8253d8e37edc3b2fcc7f","modified":1514551323963},{"_id":"public/images/tutorial-angular-5_0_cli_1-5.jpg","hash":"25a6c283ccc6760fe0020ff39d875f1e09fa3c7b","modified":1514551323963},{"_id":"public/images/tutorial-angular-5_1_base.jpg","hash":"1cc4e81d47676be5993af04b0e07ce156bdb6dce","modified":1514551323963},{"_id":"public/images/tutorial-angular-5_2_SPA.jpg","hash":"46cc0dd225af3dbb65d57d31cafda80fdc5d9287","modified":1514551323964},{"_id":"public/images/tutorial-angular-5_5_inject.png","hash":"2576dd9a16e3b16b8c42149a95a0e3b82a3075c2","modified":1514551323965},{"_id":"public/css/images/angular-5_1_Base.jpg","hash":"b57ecb7a368149dda83fa24a6c55e857c3d28ab1","modified":1514551323965},{"_id":"public/css/images/angular-5_2_SPA.jpg","hash":"2e5e5179cdcf6b7957cef149405406c89f28d747","modified":1514551323965},{"_id":"public/css/images/angular-5_0_cli_1-5.jpg","hash":"50a7152416bec64e5e26640f2e08b4ce1be39b48","modified":1514551323966},{"_id":"public/css/images/angular-5_3_data.jpg","hash":"40b280d77bf37149c32cffb615d8471c7291e254","modified":1514551323967},{"_id":"public/css/images/avatar.jpg","hash":"f5cce34d891789ed4982cd8ebc64ad8d4f402e38","modified":1514551323967},{"_id":"public/css/images/angular.jpg","hash":"6e341e706f0b6f27dc9ba93efe56621409e4304f","modified":1514551323968},{"_id":"public/css/images/angular-5_4_flow.png","hash":"a74e3213fabd7a1e655ae4dc0760adb7c1ed3328","modified":1514551323968},{"_id":"public/css/images/thumb-default-small.png","hash":"e63874a08229a3031c407915ca448ca9d3ab234f","modified":1514551323969},{"_id":"public/css/images/angular-5_6_http.png","hash":"be5f15dd3b70d5a0b4bff04b9c83bf61f63a6987","modified":1514551323970},{"_id":"public/css/images/angular-5_5_inject.png","hash":"b3b7244229b313b40b8a5dc8f95a979e038ced29","modified":1514551323970},{"_id":"public/images/tutorial-angular-5_6_http.png","hash":"7099b67a58c45c689dbe2508fb5df884d6738811","modified":1514551323970},{"_id":"public/css/images/typescript.jpg","hash":"eb636fe8bea5b21d8f92b430c6492166ff21e30f","modified":1514551323971},{"_id":"public/css/images/logo.png","hash":"ac0fa5cf38f9211089dce5486a3ae7d666dc5db1","modified":1514551323971},{"_id":"public/libs/lightgallery/img/loading.gif","hash":"66532a70bf3f0b148846ea98ae20f0577a7cf99a","modified":1514551323972},{"_id":"public/libs/lightgallery/fonts/lg.svg","hash":"0d20ced713d03f14fb4966e984c6ab4b12694591","modified":1534175950498},{"_id":"public/images/tutorial-angular-5_0_cli.png","hash":"8b775513832fea85fd79efe5bcbcad32a1c307f5","modified":1514551323973},{"_id":"public/images/tutorial-angular-5_2_SPA.png","hash":"6f5d583e5a01da22fb437250074731be80dd0468","modified":1514551323973},{"_id":"public/images/tutorial-angular-5_4_flow.png","hash":"37a2759729208622277c7dfeedeea827a0198007","modified":1514551323974},{"_id":"public/images/tutorial-angular-5_3_data.png","hash":"91b2130f628c7ace6e9f3c1c8d0b05c2a30d0b8f","modified":1514551323975},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.svg","hash":"6aea5705bf22ea3815773da476d3f6e8fadb9c26","modified":1534175950499},{"_id":"public/images/tutorial-angular-5_1_base.png","hash":"9bbf735bccbc475dbe04b16f286c2d8584661e39","modified":1514551323977},{"_id":"public/post-sitemap.xml","hash":"b7949dfb6ef29400a296da06c42ea0bf224738fa","modified":1552498021068},{"_id":"public/page-sitemap.xml","hash":"6e101fabd6cc525b892deabbddc3771f482c0ed9","modified":1552498021545},{"_id":"public/category-sitemap.xml","hash":"78f551f4ee588dff5ccfc5c9f47720f4b7f8a585","modified":1552498021093},{"_id":"public/sitemap.xsl","hash":"4321fa69dc1b8811d32b7a1478e5603e038cea1a","modified":1552498021782},{"_id":"public/tag-sitemap.xml","hash":"fe4e109bbed26cf963c6d7e4964c1e95253d57ed","modified":1552498021782},{"_id":"public/sitemap.xml","hash":"3300c8dc71ac268be13aca256f66eb58fb705aa5","modified":1552499497481},{"_id":"public/images/tutorial-angular-5_7_watch.png","hash":"a09cc6326510fc42441ecc9dc2fcc15c2690b1da","modified":1514551336446},{"_id":"public/css/images/angular-5_7_watch.png","hash":"9cdd9356082368f17b7097b1dc449e9e659952ba","modified":1514551336447},{"_id":"public/404.html","hash":"8b66ca09cb2240bbcea56334652523367b29b8ae","modified":1552483097450},{"_id":"public/cursos.html","hash":"a94808963e02f197d02b5253b804f996e8634b7f","modified":1552483100284},{"_id":"public/noticias-junio-16.html","hash":"977c271c6518df00ddb5f54e9b9ce4a9112f14fd","modified":1552483100284},{"_id":"public/promociones.html","hash":"ced12b24da9107f205a32239a40a2bf6a0dad0ee","modified":1552483100284},{"_id":"public/scaffolds/draft.html","hash":"9e53753fb630d0bc5eb84a8eab1104bff34a78ff","modified":1552483100696},{"_id":"public/scaffolds/page.html","hash":"f9049297f94bc0e5b0e931a31049f89f62e553a9","modified":1552483100696},{"_id":"public/comunicaciones-http-en-Angular/index.html","hash":"abb4a993e44abb6e00bdc062b493ca9fbafffdc9","modified":1552483100697},{"_id":"public/servicios-inyectables-en-Angular/index.html","hash":"ee64d54b1b42b912fc9b12b6ada40995fdc5c4ff","modified":1552483100697},{"_id":"public/flujo-de-datos-entre-componentes-angular/index.html","hash":"d74998377b9e6f82c3f7c794394814e8899c45d6","modified":1552483100697},{"_id":"public/formularios-tablas-y-modelos-de-datos-en-angular/index.html","hash":"f01c217fd51c13c1f13f77f3e01aa0cb8fc30884","modified":1552483100697},{"_id":"public/paginas-y-rutas-angular-spa/index.html","hash":"5de24dc6cb3a56b59493f24a62b209ec352603ad","modified":1552483100697},{"_id":"public/base-aplicacion-angular/index.html","hash":"f60f7dd4f27c174c8d905d68e4804fe9c1f1064b","modified":1552483100697},{"_id":"public/hola-angular-cli/index.html","hash":"2f769944c35d6c6fa9693e16a4193336b2580c6e","modified":1552483100697},{"_id":"public/typescript-programa-en-el-front-igual-que-en-el-back/index.html","hash":"8a32c0dfd06491e62d63b132d09d14eba1d26f57","modified":1552483100698},{"_id":"public/codigo-de-ejemplo-curso-de-angular2/index.html","hash":"f0545f9c8529770aaa9fb745f10315ed65597a8a","modified":1552483100698},{"_id":"public/formularios-de-datos-en-angular2/index.html","hash":"0a51695a87e25e0af6845c7f8aec1d25781974e6","modified":1552483100698},{"_id":"public/comunicaciones-http-observables-con-angular2/index.html","hash":"f439fee9126ec8bf4e3ca03a7ed44914b534d66e","modified":1552483100698},{"_id":"public/scaffolds/post.html","hash":"1e55d5417736f05e8321308409c4569bebb2516a","modified":1552483100696},{"_id":"public/enrutado-con-angular2-el-nuevo-spa/index.html","hash":"980151211309df1561c1453586b6c181b4d18b6a","modified":1552483100699},{"_id":"public/databinding-el-flujo-de-datos-de-angular2/index.html","hash":"309aa2ecfc79f119e2b2dda2837a5ea1d50fcb10","modified":1552483100699},{"_id":"public/angular2-di-inyeccion-de-dependencias/index.html","hash":"7bf5137ac24a6b4d0d2cb134613d8d2f09e0a06a","modified":1552483100699},{"_id":"public/cookies.html","hash":"8bbe2965ec3ed41940db03e8e78d9c8b21ff5a21","modified":1552483100263},{"_id":"public/contacto.html","hash":"a82df180ad05b7fbfac455b307c95197f7758186","modified":1552483100261},{"_id":"public/componentes-los-bloques-de-construccion-de-angular-2/index.html","hash":"61aa9f977f39097e44479c4c83e1a7d32f02445d","modified":1552483100699},{"_id":"public/hola-mundo-en-angular-2/index.html","hash":"6e27f97eaa616726589b3f9b3c6b23e77c434df5","modified":1552483100699},{"_id":"public/angular2-primeras-impresiones/index.html","hash":"9ef660972a9169083c0c27de7712fe27fdc0afbd","modified":1552483100699},{"_id":"public/node-6-0-0-actualizacion-con-nvm/index.html","hash":"0d0231ff2b092e1c35330d71f81a7946adfe7e47","modified":1552483100699},{"_id":"public/soluciones-backend-2016/index.html","hash":"4c04d24f223ce9665a48a9952e4e59b571b12e87","modified":1552483100699},{"_id":"public/soluciones-frontend-2016/index.html","hash":"e54f8db9c01c9a6a251d189c51cf0100b3ad585a","modified":1552483100699},{"_id":"public/npm-de-instalador-a-publicador/index.html","hash":"d15c2db1a474ae9bb10adce9e6a750c900829f0a","modified":1552483100699},{"_id":"public/formas/index.html","hash":"a116c47368a30a89cf55c2d14cddc53c5d7973c8","modified":1552483100699},{"_id":"public/introduccion-a-bootstrap/index.html","hash":"8120b6eee3092af1e4d5d7a7478976407f3eef4d","modified":1552483100699},{"_id":"public/para-que-puedo-usar-nodejs/index.html","hash":"c62b4c3decf8bc3db63c11f480d6acb5cfb756c2","modified":1552483100699},{"_id":"public/introduccion-a-mongodb/index.html","hash":"1ef5a6ec3397eb236a0e8f0b0ba8b784a1a9db39","modified":1552483100700},{"_id":"public/por-que-angularjs/index.html","hash":"187608e326d90c7f29652e7988158f6e58826aff","modified":1552483100699},{"_id":"public/ng-el-ecosistema-de-angularjs/index.html","hash":"0209cb557ced791345354f565ef410d163ef3dd1","modified":1552483100700},{"_id":"public/categories/Avanzado/index.html","hash":"b5d70be2ba641e2d7ff05b81fbbca21e0286a332","modified":1552483100702},{"_id":"public/archives/2015/11/index.html","hash":"f6a191bec4e04048f2bb706c67995583f85c36ce","modified":1552483100700},{"_id":"public/archives/2016/01/index.html","hash":"bb4a1ff0193ad8742df9a3bb99787c557f6f393e","modified":1552483100428},{"_id":"public/archives/2016/03/index.html","hash":"56a086957cebf6a3047adfbab428151dd3cbd40c","modified":1552483100603},{"_id":"public/archives/2016/04/index.html","hash":"40ba63c710892c887439d759c2adfe5e459aa1a5","modified":1552483100445},{"_id":"public/archives/2016/09/index.html","hash":"9e7307b62b4874ad6aaaed9ca8757ff3eb363476","modified":1552483100696},{"_id":"public/archives/2017/03/index.html","hash":"97d10f9c32c4c8819d6dab5ba47a6e0ac590daf6","modified":1552483100695},{"_id":"public/tag/Bootstrap/index.html","hash":"df29d1fb8c169b06d01db9477b79e1e810194ced","modified":1552483100703},{"_id":"public/tag/DI/index.html","hash":"c7ac335f34cc0c068503c2c83acaec303679acd8","modified":1552483100703},{"_id":"public/tag/MongoDB/index.html","hash":"f74a001a6b8aa31e53826ff7cd045c01fcf26ed9","modified":1552483100704},{"_id":"public/tag/FrontEnd/index.html","hash":"9617d89d33df081e99e3d3b0a0338d7fc8219325","modified":1552483100696},{"_id":"public/tag/TypeScript/index.html","hash":"840e2ee87f9cb8158c19ebdd2da5df9b68d724ee","modified":1552483100696},{"_id":"public/tag/BackEnd/index.html","hash":"3eec3751251a8b5d6ab7c36bd14fbfbbc54016fe","modified":1552483100696},{"_id":"public/tag/SPA/index.html","hash":"fc4a2b816586e554c3e7f7b09ab83af974fc8e28","modified":1552483100704},{"_id":"public/vigilancia-y-seguridad-en-Angular/index.html","hash":"5247b6664b988a2647fefa102996c6a6478ff8aa","modified":1552483100696},{"_id":"public/categories/Introduccion/index.html","hash":"22843ae2aab71f2d1259293093ca6e876aeb3754","modified":1552483100701},{"_id":"public/categories/Opinion/index.html","hash":"cd51c1c60fb83977a6e260e9690c762ff08c2125","modified":1552483100701},{"_id":"public/categories/Introduccion/page/2/index.html","hash":"3c6a129cc7edeaf4e3a3d1225de1d57d4b31cd4f","modified":1552483100701},{"_id":"public/archives/index.html","hash":"62ba629c23e5e6f365e7945a8df49800263a722b","modified":1552483100699},{"_id":"public/archives/page/2/index.html","hash":"9da1faf9920e084a05764bc97493f839db7fa843","modified":1552483100700},{"_id":"public/archives/2015/index.html","hash":"ba0c16bca90d0fb3446a6a128867a13a421a045d","modified":1552483100700},{"_id":"public/categories/Tutorial/index.html","hash":"5404424610c80f2e88ef6a340c88395fc83e06b7","modified":1552483100701},{"_id":"public/archives/page/3/index.html","hash":"b2570c5686a7965a2e0b3cb2d5d59c6aa3001727","modified":1552483100700},{"_id":"public/archives/2016/index.html","hash":"5bb8371731b481ffd0e32b417070b173e886179f","modified":1552483100700},{"_id":"public/archives/2015/08/index.html","hash":"92c36a88b497e35e3fabfae7464ef93514c9b868","modified":1552483100700},{"_id":"public/archives/2016/page/2/index.html","hash":"2ce66da6febb125f028342435dedaf2e1f90313b","modified":1552483100700},{"_id":"public/archives/2016/06/index.html","hash":"8e3c3ffa602d91b85db2598b1fe13db76cae416f","modified":1552483100700},{"_id":"public/archives/2016/05/index.html","hash":"d447bf7c436aad4ae3ffece08cd8fd416f1485ad","modified":1552483100700},{"_id":"public/archives/2017/index.html","hash":"99907d01101e97a935e65bc41d41950901e833a6","modified":1552483100695},{"_id":"public/archives/2017/11/index.html","hash":"57b198ec046aeb78471ce5be99b707fd2662c514","modified":1536577993695},{"_id":"public/archives/2017/12/index.html","hash":"fe21a2f7379c8ecd03a6461743198cf73f977c5d","modified":1536918596831},{"_id":"public/index.html","hash":"c5439b23ae7fa6e75797a463a8b000477a465aa2","modified":1552497596303},{"_id":"public/page/2/index.html","hash":"f75dc723458627d621a7a3485213747954e4316b","modified":1552483100702},{"_id":"public/tag/Angular2/index.html","hash":"bbe1287bc77ba0a0a23742ba4bd99d551e7c9015","modified":1552483100703},{"_id":"public/page/3/index.html","hash":"373253f190177e96194b99ecec80510c8e68c827","modified":1552483100702},{"_id":"public/tag/Angular2/page/2/index.html","hash":"6428796ce682a2eac29c8fedb87aab72f30a3f39","modified":1552483100703},{"_id":"public/tag/Tutorial/index.html","hash":"a429ebcd1298c0e66468f13655c5f509d696a228","modified":1552483100703},{"_id":"public/tag/Tutorial/page/2/index.html","hash":"58a31ff17e40a47c4c2f77a3cba09bea715b497b","modified":1552483100703},{"_id":"public/tag/http/index.html","hash":"811e59a936b126485ec45f5fc9d238af2da9c6d6","modified":1552483100703},{"_id":"public/tag/Forms/index.html","hash":"259bba4ad1748fadcecbd5db3ee1811c60560d8b","modified":1552483100704},{"_id":"public/tag/CLI/index.html","hash":"b8512eb1e62c412d8ec02f334c1905daa8f1e9d9","modified":1552483100703},{"_id":"public/tag/AngularJS/index.html","hash":"827298c053512c762cc57102f6c823ea3129cc52","modified":1552483100704},{"_id":"public/tag/NodeJS/index.html","hash":"b99afa93a339516c70d9c4a7d3418ed4fbef0758","modified":1552483100704},{"_id":"public/tag/Angular/index.html","hash":"b9ff0aa97144fe8cb3f11f7dc10f7a797beca31d","modified":1552483100704},{"_id":"public/tag/Angular5/index.html","hash":"ab267a7d684c479be93464b143d77417b205f5d5","modified":1541751636648},{"_id":"public/tag/Introduccion/index.html","hash":"e83c5abe720c8d88981dee5cde5772832d9a6c12","modified":1552483100704},{"_id":"public/categories/Tutorial/Angular/index.html","hash":"58052ad6b261ab4a7f93ab8549dc4013d3ec7daf","modified":1552483100701},{"_id":"public/tag/observables/index.html","hash":"d58ded2cd7f739fa841da725cd516e92462af618","modified":1536918596831},{"_id":"public/css/images/favicon.ico","hash":"eaf485c235ca3d83faf3d38064a6e0f1df3d14fa","modified":1534175958537},{"_id":"public/libs/lightgallery/css/lg-fb-comment-box.css.map","hash":"5281d2cfb0ef278940c4860ea9aa7ef86d3dbc8d","modified":1514551350246},{"_id":"public/libs/lightgallery/css/lg-transitions.css.map","hash":"6ee19f99bca3ecf2fa0d6f07fb5c200db07ddd11","modified":1514551350256},{"_id":"public/libs/lightgallery/img/video-play.png","hash":"3ea484cdc04d2e4547f80cbf80001dcf248c94ef","modified":1514551350256},{"_id":"public/libs/lightgallery/fonts/lg.ttf","hash":"f6421c0c397311ae09f9257aa58bcd5e9720f493","modified":1514551350257},{"_id":"public/libs/lightgallery/img/youtube-play.png","hash":"fea6df9d9d43151f9c9d15f000adb30eb3e26fc4","modified":1514551350257},{"_id":"public/libs/lightgallery/img/vimeo-play.png","hash":"6190254f2804904a4a1fa1eb390dfd334e416992","modified":1514551350259},{"_id":"public/libs/lightgallery/fonts/lg.eot","hash":"54caf05a81e33d7bf04f2e420736ce6f1de5f936","modified":1514551350262},{"_id":"public/libs/lightgallery/css/lightgallery.css.map","hash":"91788030e3c7107b6b4bf50a82d4309368850488","modified":1514551350269},{"_id":"public/libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","hash":"c4248ea800bd5608344ce163f5658b57e7ef9410","modified":1514551350273},{"_id":"public/libs/lightgallery/fonts/lg.woff","hash":"3048de344dd5cad4624e0127e58eaae4b576f574","modified":1514551350273},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","hash":"22413bb8bfb78608c1e25aa1ed5c1f38557df79f","modified":1514551350273},{"_id":"public/libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","hash":"e0350190d720a8fec0557ab47b318ec4e4486448","modified":1514551350273},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","hash":"63eb74ef040aade256f2274a7f31a914edddb0ea","modified":1514551350275},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","hash":"328a22fe3eec71ad9e5ece4d67dd62e79dab6b7f","modified":1514551350275},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","hash":"a0b0c389cf46d63c850e61fed572485ff0b68183","modified":1514551350276},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","hash":"415eee05976ab8b2471602a5ddb78a6c58fc21aa","modified":1514551350276},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","hash":"c5f29fed6632efe0aa83318369f0d8c4061b775b","modified":1514551350277},{"_id":"public/libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","hash":"be201d32a9aa5d186723ebb3c538be691aa8c53a","modified":1514551350277},{"_id":"public/libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","hash":"113978181dcac77baecef6115a9121d8f6e4fc3a","modified":1514551350277},{"_id":"public/libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","hash":"afc44700053c9a28f9ab26f6aec4862ac1d0795d","modified":1514551350277},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","hash":"4dc6d7174ea6d89f4c45e43e1bfc3e03d8ffebaf","modified":1514551350277},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","hash":"5067c81462c15422853c94d21a1726865a61634f","modified":1514551350278},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","hash":"d22904914469be735490e3c8cb093c7862896dd5","modified":1514551350278},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","hash":"ae80fb3cd16339aa7b5da280ab53975523dcaac2","modified":1514551350278},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","hash":"e75607ba1417181397c700775b84303d5a2957b9","modified":1514551350280},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","hash":"b366f2fda2e524eb5ef50058eefff249a3b96e6c","modified":1514551350281},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","hash":"d0b40a7848703556c6631f24e961a98ca5829255","modified":1514551350281},{"_id":"public/libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","hash":"be365eca44760ce3fc9b377c43d4634958479c69","modified":1514551350281},{"_id":"public/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","hash":"942addaec4d3a60af33947a84a3d85f926015947","modified":1514551350282},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","hash":"b85efde42fa3a03c32b1d31c6cd74c622fc7916c","modified":1514551350282},{"_id":"public/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","hash":"b0e0bb5ef78db8b15d430d0b9be9d4329289a310","modified":1514551350282},{"_id":"public/libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","hash":"2c5b039b57f62625e88226a938679ec937431ad1","modified":1514551350283},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.woff","hash":"6d7e6a5fc802b13694d8820fc0138037c0977d2e","modified":1514551353962},{"_id":"public/libs/font-awesome/fonts/FontAwesome.otf","hash":"1b22f17fdc38070de50e6d1ab3a32da71aa2d819","modified":1514551358420},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.woff2","hash":"97e438cc545714309882fbceadbf344fcaddcec5","modified":1514551358436},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.eot","hash":"965ce8f688fedbeed504efd498bc9c1622d12362","modified":1514551358436},{"_id":"public/js/main.js","hash":"1637a63b30d1ca9bcf2be3e7584ad491d9cd9914","modified":1535976434112},{"_id":"public/js/insight.js","hash":"48fde70e8f5e99f3bcec13ed693a3c2db9f83db9","modified":1514551358560},{"_id":"public/libs/justified-gallery/justifiedGallery.min.css","hash":"13fbcba5e97aa88b748d94d3efc4718475279907","modified":1514551358561},{"_id":"public/libs/open-sans/styles.css","hash":"84cd5aaa2f93a70da5304b8cfef6c9892ecd40ec","modified":1514551358562},{"_id":"public/libs/source-code-pro/styles.css","hash":"0cddee03d83de49c9ec47c799b1136d08d3187ed","modified":1514551358563},{"_id":"public/libs/lightgallery/css/lg-fb-comment-box.css","hash":"81846a8175c096454286c6659b5acd530e610ec8","modified":1514551358564},{"_id":"public/libs/lightgallery/css/lg-fb-comment-box.min.css","hash":"05830fadb8454f39dcc98c8686eb4d5c24b71fc0","modified":1514551358564},{"_id":"public/libs/lightgallery/js/lg-autoplay.min.js","hash":"d845741bcaf961579622880eb2a445257efad1ac","modified":1514551358566},{"_id":"public/libs/lightgallery/js/lg-fullscreen.js","hash":"a0ddfd0c8f7c54f2d7f904172c9505894b250a47","modified":1514551358567},{"_id":"public/libs/lightgallery/js/lg-autoplay.js","hash":"27273ac9a343ff3f77916caaf93b0cd242b7e88d","modified":1514551358567},{"_id":"public/libs/lightgallery/js/lg-fullscreen.min.js","hash":"b6b9e4022700b7faf2a5a175ba44a3bd938fdd20","modified":1514551358568},{"_id":"public/libs/lightgallery/js/lg-pager.js","hash":"4c45717974b8e9cc6ad62a0461e510d6ff94c29a","modified":1514551358568},{"_id":"public/libs/lightgallery/js/lg-hash.js","hash":"09c80887da1c809bb00a1fd0ba17d646817b9a87","modified":1514551358568},{"_id":"public/libs/lightgallery/js/lg-hash.min.js","hash":"43f1e1e720ab0e241c19b83aa26bd6848eab8edc","modified":1514551358569},{"_id":"public/libs/lightgallery/js/lg-pager.min.js","hash":"25caa6ff65b1c6dee09941e795ae2633bdbab211","modified":1514551358570},{"_id":"public/libs/lightgallery/js/lg-thumbnail.min.js","hash":"18dd7d2909d1bfd6852f031d03e774b4428c512b","modified":1514551358571},{"_id":"public/libs/lightgallery/js/lg-share.min.js","hash":"39c615f07c5d3aaa65a2c3068a30fdd6dd5c372d","modified":1514551358571},{"_id":"public/libs/lightgallery/js/lg-share.js","hash":"f5737bbc2cba87e85783ca24513b900bb4e19294","modified":1514551358572},{"_id":"public/libs/lightgallery/js/lg-video.js","hash":"d3503b5c77ccb2d689706ed0fd97d8cb6e7b77f6","modified":1514551358574},{"_id":"public/libs/lightgallery/js/lg-video.min.js","hash":"032c001ab045a69856f9c3ed4a2a3bf12a8e310f","modified":1514551358575},{"_id":"public/libs/lightgallery/js/lg-zoom.min.js","hash":"15b49f9728439819ece15e4295cce254c87a4f45","modified":1514551358575},{"_id":"public/libs/lightgallery/js/lg-thumbnail.js","hash":"101e49df42d6d6933f44c5561488a2778921da0a","modified":1514551358575},{"_id":"public/libs/lightgallery/js/lg-zoom.js","hash":"d4204dabf63148e779b0c4466b856b2dfe3a1a3d","modified":1514551358576},{"_id":"public/css/style.css","hash":"f79de7642d4cd04654fcc3cc11600f86cb51626f","modified":1514551358578},{"_id":"public/libs/justified-gallery/jquery.justifiedGallery.min.js","hash":"b2683e7a872bc109b1756a65188a37cef7d0bd5c","modified":1514551358578},{"_id":"public/libs/font-awesome/css/font-awesome.css","hash":"f9ae1cab2f0ceeea9e8dd0df2e9792e4f08fb107","modified":1514551358579},{"_id":"public/libs/font-awesome/css/font-awesome.min.css","hash":"7cd5a3384333f95c3d37d9488ad82cd6c4b03761","modified":1514551358579},{"_id":"public/libs/lightgallery/css/lg-transitions.min.css","hash":"5c22e2073a4c96d6212c72135391b599e8d1359f","modified":1514551358580},{"_id":"public/libs/lightgallery/css/lg-transitions.css","hash":"7e856f16b01b19a8bdb3bfbd7d2304d330ee0066","modified":1514551358581},{"_id":"public/libs/lightgallery/css/lightgallery.css","hash":"18795fa809cc5371461f85ca3830fa4b9cfb7acd","modified":1514551358581},{"_id":"public/libs/lightgallery/css/lightgallery.min.css","hash":"c9a2e19c932b56f4a2ce30c98910d10b74edb38a","modified":1514551358581},{"_id":"public/libs/lightgallery/js/lightgallery.js","hash":"4d53b6b7018a874c6caef8bac4a24e5e2b3da508","modified":1514551358582},{"_id":"public/libs/lightgallery/js/lightgallery.min.js","hash":"956ef9b706755318da69ad0b5d7786339d831251","modified":1514551358582},{"_id":"public/libs/jquery/2.1.3/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1514551358582},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.ttf","hash":"61d8d967807ef12598d81582fa95b9f600c3ee01","modified":1514551358582},{"_id":"source/_posts/ng-8-Formularios-reactivos-con-Angular.md","hash":"b62892f8c3352252be76e4126df9db377c582c21","modified":1552478914365},{"_id":"themes/icarus/source/css/images/angular_8_reactive.png","hash":"d962ef91adcd47c26d551d5cd9921555ede359ab","modified":1525339215081},{"_id":"source/images/tutorial-angular_8_reactive.png","hash":"7e875e6860d4af88dccf12f3a78ae9bfafca3a73","modified":1525339058270},{"_id":"public/content.json","hash":"82cdc1e87c55b67c8a2fe58a19006793c3446d8c","modified":1552499496628},{"_id":"public/css/images/angular_8_reactive.png","hash":"26c82a97886e6046414f3052e4a21a7072ee268c","modified":1525339575186},{"_id":"public/images/tutorial-angular_8_reactive.png","hash":"a60b218d57fd6f4649384c652baae78961a98089","modified":1525339575186},{"_id":"public/archives/2018/index.html","hash":"74cbb5209ea5aa2a088f97a3414cc4e745a30243","modified":1552483100700},{"_id":"public/archives/2018/05/index.html","hash":"6cfd8ad4e6c95ab1b232c1ce8df7ffe9e16b931c","modified":1537445688579},{"_id":"public/tag/Angular6/index.html","hash":"f8f0ec4234337704945106a55acf4b73629f31ae","modified":1552483100704},{"_id":"public/tag/reactiveForms/index.html","hash":"1c88843bff6f95b309223b16b5604e6a214019cd","modified":1552483100704},{"_id":"public/formularios-reactivos-con-Angular/index.html","hash":"7afc18cbf50291dab9b35c61522b596b4575bd7c","modified":1552483100696},{"_id":"themes/icarus/source/css/images/angular_0_cli.png","hash":"199d998dea02a8981a2ceaca3ccb0fa1abc3f230","modified":1534175735021},{"_id":"source/images/tutorial-angular-0_cli.png","hash":"0f7ab5648cb3b0ee99d0c52bdf8186dfe7b9986a","modified":1535970798589},{"_id":"public/css/images/angular_0_cli.png","hash":"d4d7205d37d4ce286d60f7f2d1e14995513d7882","modified":1534175958506},{"_id":"public/images/tutorial-angular-0_cli.png","hash":"0b15754c7bd374a893b2ae1f04e629419b77fcd2","modified":1535971179016},{"_id":"themes/icarus/source/css/images/angular-0_cli.png","hash":"3426c1558f871f64b531a13dc85416f38446967d","modified":1536577764554},{"_id":"public/css/images/angular-0_cli.png","hash":"f76c60732d5c1949d28499c7790aff8c5c0a4838","modified":1536577986724},{"_id":"public/archives/2018/08/index.html","hash":"2451fe7bc8ad50febdc33806c4de218ef584b127","modified":1548074487682},{"_id":"themes/icarus/source/css/images/angular-1_base.png","hash":"ccf5bc5a6c3c6cc995d240bd11334d2a773612fd","modified":1536577741031},{"_id":"source/images/tutorial-angular-1_base.png","hash":"fd0fb70cc95d61f24978b0d4a13da675639aaa4b","modified":1535970910201},{"_id":"public/css/images/angular-1_base.png","hash":"fb71a1fca4f50b1e7fe7af0deac4bd09bc3a87d3","modified":1536577986724},{"_id":"public/images/tutorial-angular-1_base.png","hash":"733a3755501bd93af49e963b65002e2f05790ea6","modified":1535971179018},{"_id":"source/images/1-base_tree.PNG","hash":"8c4b7bffd61856563a4de13846909c08c44cb028","modified":1534495226249},{"_id":"public/images/1-base_tree.PNG","hash":"3127057fc9fb0077b297a177733a737a496073ef","modified":1534495354540},{"_id":"source/images/1-base_module_tree.png","hash":"8c4b7bffd61856563a4de13846909c08c44cb028","modified":1534496273093},{"_id":"public/images/1-base_module_tree.png","hash":"3127057fc9fb0077b297a177733a737a496073ef","modified":1534496340975},{"_id":"themes/icarus/source/css/images/angular-2_spa.png","hash":"2373e59391c1fff21dbe71f5086cbab63c563efe","modified":1536577682762},{"_id":"source/images/tutorial-angular-2_spa.png","hash":"01f90e62f3ad81b990b47b96fc5fdfb3354e1433","modified":1535970976294},{"_id":"public/css/images/angular-2_spa.png","hash":"339ff8549c88a8c26a79d7b0b6d92947792d3ccf","modified":1536577993608},{"_id":"public/images/tutorial-angular-2_spa.png","hash":"c9ea2498d6334762fca7f491935fa45ae1e12675","modified":1535971181372},{"_id":"public/tag/Routing/index.html","hash":"0d8bd1299838638a652f54f8b30c279b931755ef","modified":1552483100705},{"_id":"themes/icarus/source/css/images/angular-3_data.png","hash":"14e44451e3bbbd4f75a211616787a9e2a2c0c87c","modified":1536577631237},{"_id":"source/images/tutorial-angular-3_data.png","hash":"7e963d68e8c6015ebd95d560203ae63165232ccf","modified":1535971203834},{"_id":"public/css/images/angular-3_data.png","hash":"66d3af6a40a7a0d1b57aec8275223fa84dcf5c79","modified":1536577993591},{"_id":"public/images/tutorial-angular-3_data.png","hash":"865bafd69f3fad2cb86c5ef2da66007a18360606","modified":1535975671380},{"_id":"source/images/tutorial-angular-0_cli_origen.png","hash":"152d44c9756cb40d4fa7f2f9bdc299107374efe6","modified":1534176231207},{"_id":"source/images/tutorial-angular-2_spa_origen.png","hash":"7c9920f2d7a828c7e409a6b36ad8075a445cda7c","modified":1535106261273},{"_id":"source/images/tutorial-angular-1_base_origen.png","hash":"c2f02e7e32c454b53650d53947aae6a9f734cd53","modified":1534410648737},{"_id":"public/images/tutorial-angular-2_spa_origen.png","hash":"c152fe1d92e63db95eb9dfa16860d0bae70daad9","modified":1535971186526},{"_id":"public/images/tutorial-angular-0_cli_origen.png","hash":"12ccac4182039809891355134c54c25414a7c5e8","modified":1535971186526},{"_id":"public/images/tutorial-angular-1_base_origen.png","hash":"681efda3bfda76599be1dcefb249371bcca5c797","modified":1535971190921},{"_id":"source/images/tutorial-angular-3_data_origen.png","hash":"b6782c6c918df8afd7bb68c20f40ad183e1e514e","modified":1535544467339},{"_id":"public/images/tutorial-angular-3_data_origen.png","hash":"6dbb09ea69ddeb5208e4db81057f3e3910dcaba3","modified":1535975679317},{"_id":"public/page/4/index.html","hash":"345573a74858cdc91b8db440fe909778a3050dbe","modified":1552483100702},{"_id":"public/page/5/index.html","hash":"1ca3b68403961e1785ed10bfcc420e05509ca55a","modified":1552483100702},{"_id":"public/page/6/index.html","hash":"bab24377dc42e17f479fc9ed3e795894eb1e3bb2","modified":1552483100702},{"_id":"themes/icarus/source/css/images/angular-4_flow.png","hash":"44814f98c95e46a866b51cce8589388f72d5a2ee","modified":1536577582120},{"_id":"source/images/tutorial-angular-4_flow.png","hash":"4484fdf085e6361a070d09ef059f2b0570ab83f6","modified":1536140866612},{"_id":"public/css/images/angular-4_flow.png","hash":"61c81d8980240105c15a085d6b9bded74fdd4ad3","modified":1536577993591},{"_id":"public/images/tutorial-angular-4_flow.png","hash":"4a1a58487affa6e836dfecde1e0d21553aeed035","modified":1536140997419},{"_id":"public/archives/2018/09/index.html","hash":"edbb56bba9c8c508691a730bd34419a1b4da3d97","modified":1552483100700},{"_id":"source/images/tutorial-angular-4_flow_origen.png","hash":"34a259ecd7e934496d8b4487d6fa74bdf95c46cd","modified":1536140137891},{"_id":"public/images/tutorial-angular-4_flow_origen.png","hash":"433dfb263297219575e1c0caa243c86e179b9d89","modified":1536141004036},{"_id":"public/tag/Components/index.html","hash":"ed47ef2533eb270e8cfe9289934e648e072c9a51","modified":1552483100705},{"_id":"source/images/tutorial-angular-5_inject.svg","hash":"759f964169d8743ddfbf264c6d2c4b68f86a0bb9","modified":1536576700268},{"_id":"public/images/tutorial-angular-5_inject.svg","hash":"4956621c585476f86d4b31b0726327efce667eed","modified":1536576763280},{"_id":"source/images/tutorial-angular-5_inject.png","hash":"6c973db275b9201fa39c30a7e45a5a16e419808d","modified":1536577315653},{"_id":"themes/icarus/source/css/images/angular-5_inject.png","hash":"aa4a32e4439fba549391fc3eb9fdd067fbea0111","modified":1536577521540},{"_id":"public/images/tutorial-angular-5_inject.png","hash":"3dad3f82be4c3b7a47ff1bc40ae02590fb72bb56","modified":1536577993695},{"_id":"public/css/images/angular-5_inject.png","hash":"e5214d29c3123b4b993a7f0b5012aa09979645ef","modified":1536577993698},{"_id":"public/tag/Servicios/index.html","hash":"6c44ebae92956b3115a85aec110ae1d0c44681d9","modified":1552483100705},{"_id":"source/images/tutorial-angular-6_http.png","hash":"ad9a952719b98cd7aa14820172e70a9697b497fd","modified":1536915878153},{"_id":"themes/icarus/source/css/images/angular-6_http.png","hash":"02dd0b7f55fb6c41eb6f9f9f64d873db2261a6be","modified":1536915887721},{"_id":"public/images/tutorial-angular-6_http.png","hash":"f9c72bf0deff3712524b6a0eff49fd60019f07e6","modified":1536916454791},{"_id":"public/css/images/angular-6_http.png","hash":"5e41adeae5cb206e5a13ee7e1578528fe65e3ffb","modified":1536916454792},{"_id":"public/tag/Observables/index.html","hash":"32f8a77e2506251e3af4a37d11ec4cba66c4767e","modified":1552498021847},{"_id":"public/archives/2019/index.html","hash":"6e821f843cecaa0e15e0c4a027b0508ac28b502b","modified":1552483100701},{"_id":"public/archives/2019/02/index.html","hash":"6cccbed641daa3adf7289eefd3e6dd6ecb8c16e0","modified":1552483100701},{"_id":"source/_posts/temp.txt","hash":"d82d37c2d5422e2521693d7ee4d75b7e8c4959c7","modified":1536925828653},{"_id":"source/images/tutorial-angular-7_watch.png","hash":"ba0564cd624db724dab51a4b9f4c920e527fa37a","modified":1537177186055},{"_id":"themes/icarus/source/css/images/angular-7_watch.png","hash":"bdd11b0a68a362b35a2c935895d776a579e0f288","modified":1537177222337},{"_id":"public/css/images/angular-7_watch.png","hash":"a554b06b830a246aa710878258e970111473257e","modified":1537345958584},{"_id":"public/images/tutorial-angular-7_watch.png","hash":"91d34a0dd059c403189fa3632a243e97d1ca06c6","modified":1537345958585},{"_id":"public/tag/RxJS/index.html","hash":"92f06d5939ac3bc245bbc2eb6a0b6394c5ffc219","modified":1552483100705},{"_id":"public/tag/Avanzado/index.html","hash":"d74705a61a16d16140bf76947744c56e4da5274e","modified":1552483100706},{"_id":"source/images/tutorial-angular-8_reactive.png","hash":"efd001decaa557eb69d70bc7be7931c78362ff00","modified":1537778302204},{"_id":"themes/icarus/source/css/images/angular-8_reactive.png","hash":"6de03afae8a8354e4bc0b0427621dbaccb26f403","modified":1537778311425},{"_id":"public/images/tutorial-angular-8_reactive.png","hash":"621a29537d48cda980f8ede1270d0d2e902b341c","modified":1537949837832},{"_id":"public/css/images/angular-8_reactive.png","hash":"905818fc5d768340e64f2cc45e72c64233736569","modified":1537949837832},{"_id":"public/tag/Angular7/index.html","hash":"f0e39922bc394869b62daade743c39950ef5a709","modified":1552483100706},{"_id":"source/_posts/ng-9-Deteccion-del-cambio-con-RxJS-y-Angular.md","hash":"e0c2ab4c5e4868964447673d269f322957290c19","modified":1543855176951},{"_id":"source/images/tutorial-angular-9_change.png","hash":"58e3283cf4a2192301ff1274ade581e7fbfb6549","modified":1538040495994},{"_id":"themes/icarus/source/css/images/angular-9_change.png","hash":"9e43153fe5b4331d5c2b3ad258e9cbf974f9db6c","modified":1538040521973},{"_id":"public/images/tutorial-angular-9_change.png","hash":"f2959666ba728629067359c6707747e6ea2f871e","modified":1538129455252},{"_id":"public/css/images/angular-9_change.png","hash":"d0fe0d6091b1a3e7ae5916c87d7ea72f5c67f21d","modified":1538129455252},{"_id":"public/deteccion-del-cambio-con-RxJS-y-Angular/index.html","hash":"e7c1c2c0d09b1531d101c58783924b7d096d4e85","modified":1538129645986},{"_id":"public/tag/ChangeDetection/index.html","hash":"05da6d062c299397d420798d4721856e38af6714","modified":1552483100706},{"_id":"public/deteccion-del-cambio-en-Angular/index.html","hash":"b4d52cf94557407080cb6ecd7dab29046bfea130","modified":1552483100698},{"_id":"source/_posts/ng-a-El-patron-Redux-con-NgRx-en-Angular.md","hash":"5ac347b213fc0ff00b3133d70ee6154e44a49f6e","modified":1543855217371},{"_id":"source/images/tutorial-angular-a_redux.png","hash":"32fe748e5c2f5ed47ecdc15240dc6fcf93805a2e","modified":1538664479152},{"_id":"themes/icarus/source/css/images/angular-a_redux.png","hash":"7297d66020b7dc7ef36c56a513822e28d1b77b78","modified":1538664541539},{"_id":"public/images/tutorial-angular-a_redux.png","hash":"38dd7f5377ffe9c256063cd9fb7a9776396c0fba","modified":1538995876149},{"_id":"public/css/images/angular-a_redux.png","hash":"dceaaf08d45407c55d9cb60e3caa543135e6cc4d","modified":1538995876150},{"_id":"public/categories/Tutorial/page/2/index.html","hash":"e9f83900650f11cbe612135c89b01c08d14842bd","modified":1552483100701},{"_id":"public/categories/Tutorial/Angular/page/2/index.html","hash":"124aa9e94045bd2e6aaf1734e117d01e0cc49711","modified":1552483100701},{"_id":"public/el-patron-redux-con-ngrx-en-angular/index.html","hash":"99f7af9be174e895e47edda33538853f8aeddd64","modified":1552483100698},{"_id":"public/archives/page/4/index.html","hash":"a4fe2b8991c5809d0191eae68250d25e289f892b","modified":1552483100700},{"_id":"public/archives/2018/page/2/index.html","hash":"4c8d5177af479e4f0307e31ca137c9a0626ab741","modified":1547636316323},{"_id":"public/archives/2018/10/index.html","hash":"0f5a51a856b3c8a2626e18bae2482862595a3b92","modified":1552483100701},{"_id":"public/tag/Angular/page/2/index.html","hash":"4532eb870529a6bfe48350c25d2a6167dece2ab3","modified":1552483100704},{"_id":"public/tag/Angular5/page/2/index.html","hash":"8c44b9ff0785ff1fbe3cf80ad317e877bd4abfc4","modified":1541751636649},{"_id":"public/tag/Angular6/page/2/index.html","hash":"e2e09592462c6675c8e4bf4b70d6e7f62c0a4dfd","modified":1547636316325},{"_id":"public/tag/Redux/index.html","hash":"5b19e5d3c787f472b494fa1fa0d00125ead54e17","modified":1552483100706},{"_id":"public/tag/NgRx/index.html","hash":"98e90b089fa792af323a0ce47963fbbac3c2cead","modified":1552483100707},{"_id":"public/page/7/index.html","hash":"2525760b8a8a2540bd249a16ddb897b534716694","modified":1552483100702},{"_id":"source/_posts/ng-b-PWA-Entre-la-web-y-las-apps-con-Angular.md","hash":"664460c62f2b8a3f57deb305ebaaf2fa6bb9b8b4","modified":1543855119288},{"_id":"source/images/tutorial-angular-b_pwa.png","hash":"4fcca7fe1f8e483d1712e04ffd856a8f5bb4eac2","modified":1539168137921},{"_id":"themes/icarus/source/css/images/angular-b-pwa.png","hash":"b60677505a5f7274ba780ebc777c615ab908ef08","modified":1539168194790},{"_id":"themes/icarus/source/css/images/angular-b_pwa.png","hash":"b60677505a5f7274ba780ebc777c615ab908ef08","modified":1539168299460},{"_id":"public/images/tutorial-angular-b_pwa.png","hash":"146490314f83d77ec8953b9ce7fc70ab99545554","modified":1539601849602},{"_id":"public/css/images/angular-b_pwa.png","hash":"808f0733c8723096a434ad46df77d1048aa68c08","modified":1539601849602},{"_id":"public/pwa-entre-la-web-y-las-apps-con-angular/index.html","hash":"4da9b53b732cd8b2abb1eb926c5134a7bc2f35b1","modified":1552483100698},{"_id":"public/tag/Angular2/page/3/index.html","hash":"7802491e3600b109f334cab6b3e66fcf2a947209","modified":1552483100703},{"_id":"public/tag/PWA/index.html","hash":"40aa8fb4a825d1997f8d2885d7da20902d004de5","modified":1552483100707},{"_id":"source/_posts/ng-c-velocidad-y-seo-con-el-ssr-de-angular-universal.md","hash":"a1738208df2e6f69d18e717eaa7096962b641c57","modified":1543855075771},{"_id":"source/images/tutorial-angular-c_universal.png","hash":"7032b7bcf7b37a4a9f1faf62d72e93eb8573cb0b","modified":1540549862328},{"_id":"themes/icarus/source/css/images/angular-c-universal.png","hash":"6bed177f608d431184b204afd5853905c8a9efa1","modified":1540548455186},{"_id":"themes/icarus/source/css/images/angular-c_universal.png","hash":"6bed177f608d431184b204afd5853905c8a9efa1","modified":1540549887891},{"_id":"public/images/tutorial-angular-c_universal.png","hash":"339c09b3aaa00df8aad48c4298187d18f62d1bec","modified":1540900028185},{"_id":"public/css/images/angular-c_universal.png","hash":"7fc544086695f4b7e80c5821323e06f2b10082bc","modified":1540900028186},{"_id":"public/velocidad-y-seo-con-el-ssr-de-angular-universal/index.html","hash":"caa0518f7aeaf02ce2c463c679389e8da91de362","modified":1552483100697},{"_id":"public/tag/Universal/index.html","hash":"eeaa1d204d22047a17663c5bc8ce44f798cb1096","modified":1552483100707},{"_id":"public/tag/SSR/index.html","hash":"4fd103035f0dc2f5a0f1806b71c07ad9b489f220","modified":1552483100707},{"_id":"public/tag/Angular7/page/2/index.html","hash":"e33a3691ae32d0ccb51f28f7724364e34714c2eb","modified":1552483100706},{"_id":"source/images/celeritas.PNG","hash":"f78b7b42ea44865791f35d66686d9aba59a2d194","modified":1546943285345},{"_id":"public/images/celeritas.PNG","hash":"c12f47202f9d42da301f1c33a9e98069cbd0195e","modified":1547035264285},{"_id":"public/archives/2019/01/index.html","hash":"f2dda5cc4595a8af854f3cfc4c31f450ec0a7ae4","modified":1552483100701},{"_id":"source/images/pedidos_ms.PNG","hash":"87bfe70ad301e5eb261f9289eceb66ba0ad263a9","modified":1547047499788},{"_id":"public/images/pedidos_ms.PNG","hash":"0f029e34d708727a07c5cf29b76f739bcba45c76","modified":1547119895527},{"_id":"source/__ng-7-Vigilancia-y-seguridad-en-Angular.md","hash":"bb513411c866fb95d598aee7fc351cf7b20b690f","modified":1551872609863},{"_id":"public/archives/2019/03/index.html","hash":"557d54a00a8369b5e455e3038f368bc15d035021","modified":1552483100701},{"_id":"source/__ng-8-Formularios-reactivos-con-Angular.md","hash":"0ee70d0941d80860c4a168a5a9ffd3a06ca221e6","modified":1552317507962},{"_id":"source/_posts/ng-9-Material-Design-y-CLI-de-Angular.md","hash":"f66c7ec0ee1fc9ee5b11b86abeaa136b5b534037","modified":1552499456926},{"_id":"themes/icarus/source/css/images/angular-9_material.png","hash":"f45b79fbb5c3cc310c0df994efed934a387a3874","modified":1552479863387},{"_id":"source/images/tutorial-angular-9_material.png","hash":"04134304478eab6bf7335950deec1d76ca404f81","modified":1552479930658},{"_id":"public/css/images/angular-9_material.png","hash":"d0ae8fe3865ee3d6edc924ecd9c17284596f7852","modified":1552483091630},{"_id":"public/images/tutorial-angular-9_material.png","hash":"cbb67315f980af2771cde4deaa17341f9d327ddf","modified":1552483092720},{"_id":"public/Material-Design-y-CLI-de-Angular/index.html","hash":"a6894389b73fe02384a3d53ee3078dc99c0f5ae7","modified":1552499504646},{"_id":"public/tag/Tutorial/page/3/index.html","hash":"237536a3cb13ac758016e25bc9abea3480b75506","modified":1552483100712},{"_id":"public/tag/material/index.html","hash":"992d01dc933c8d5720de2f9d8a5dd2b44533fd61","modified":1552483100712}],"Category":[{"name":"Introduccin","_id":"cjbrwpvel0005iwd3drbh7j0w"},{"name":"Opinin","_id":"cjbrwpvhc0018iwd35xk9dihj"},{"name":"Tutorial","_id":"cjbrwpvin001tiwd3d4s3d3xu"},{"name":"Angular","parent":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjbrwpvjy002diwd3equpwx2y"},{"name":"Avanzado","_id":"cjbrwpvke002riwd3gys3x6vg"}],"Data":[],"Page":[{"layout":"page","title":"404 No encontrado","comments":0,"_content":"\n> Lo sentimos, la ruta no se ha encontrado.\n> Por favor, dirgete al [inicio del blog](../)\n> -- <cite>El equipo de Academia Binaria</cite>\n\n---\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","source":"404.md","raw":"---\npermalink: /404.html\nlayout: page\ntitle: 404 No encontrado\ncomments: false\n---\n\n> Lo sentimos, la ruta no se ha encontrado.\n> Por favor, dirgete al [inicio del blog](../)\n> -- <cite>El equipo de Academia Binaria</cite>\n\n---\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","date":"2017-12-20T09:17:19.801Z","updated":"2017-12-20T09:17:19.801Z","path":"/404.html","_id":"cjbrwpun40000iwd3t7pafpnt","content":"<blockquote><p>Lo sentimos, la ruta no se ha encontrado.<br>Por favor, dirgete al <a href=\"../\">inicio del blog</a><br> <cite>El equipo de Academia Binaria</cite></p></blockquote><hr><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"","more":"<blockquote><p>Lo sentimos, la ruta no se ha encontrado.<br>Por favor, dirgete al <a href=\"../\">inicio del blog</a><br> <cite>El equipo de Academia Binaria</cite></p></blockquote><hr><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Contacto","id":4,"updated":"2017-02-14T08:21:50.000Z","date":"2015-09-16T11:52:52.000Z","_content":"\n<div>\nVivimos en la nube y nos relacionamos contigo en cualquier sitio desde <b>A Corua, Espaa.</b>\n</div>\n<p/>\n<div>\nSi quieres <b>visitarnos</b> ven a:\n</div>\n\n<hr/>\n\n<div itemscope itemtype=\"http://schema.org/LocalBusiness\">  \n  <h4><span itemprop=\"name\">gora Binaria S.L</span></h4>\n  <span itemprop=\"description\"> Factora de software y academia de programadores.</span>\n  <p/>\n  <div itemprop=\"address\" itemscope itemtype=\"http://schema.org/PostalAddress\">\n    <span itemprop=\"streetAddress\">Av. Primera C10. Edif Abanca Innova</span>\n    CP:<span itemprop=\"postalCode\">15190</span>\n    <p/>\n    <span itemprop=\"addressLocality\">A Corua</span>,\n    <span itemprop=\"addressCountry\">Espaa</span>\n  </div>\n  Telefno: <span itemprop=\"telephone\"><a href=\"tel:+34 609884782\">+34 609884782</a></span>\n  <p/>\n  Email: <span itemprop=\"email\">info(at)agorabinaria.com</span>\n</div>\n\n<hr />\n\n<p>Para temas comerciales de cursos presenciales con <strong>Vita Digital S.L.</strong>:  </p>\n\n<blockquote>\n  <p> Email: <span itemprop=\"email\">vitae(at)vitaedigital.com</span> </p>\n  <p> Web: <span itemprop=\"web\"><a href=\"http://www.vitaedigital.com/\">http://www.vitaedigital.com/</a></span> </p>\n  \n</blockquote>","source":"Contacto/index.md","raw":"---\ntitle: Contacto\npermalink: contacto\nid: 4\nupdated: '2017-02-14 09:21:50'\ndate: 2015-09-16 13:52:52\n---\n\n<div>\nVivimos en la nube y nos relacionamos contigo en cualquier sitio desde <b>A Corua, Espaa.</b>\n</div>\n<p/>\n<div>\nSi quieres <b>visitarnos</b> ven a:\n</div>\n\n<hr/>\n\n<div itemscope itemtype=\"http://schema.org/LocalBusiness\">  \n  <h4><span itemprop=\"name\">gora Binaria S.L</span></h4>\n  <span itemprop=\"description\"> Factora de software y academia de programadores.</span>\n  <p/>\n  <div itemprop=\"address\" itemscope itemtype=\"http://schema.org/PostalAddress\">\n    <span itemprop=\"streetAddress\">Av. Primera C10. Edif Abanca Innova</span>\n    CP:<span itemprop=\"postalCode\">15190</span>\n    <p/>\n    <span itemprop=\"addressLocality\">A Corua</span>,\n    <span itemprop=\"addressCountry\">Espaa</span>\n  </div>\n  Telefno: <span itemprop=\"telephone\"><a href=\"tel:+34 609884782\">+34 609884782</a></span>\n  <p/>\n  Email: <span itemprop=\"email\">info(at)agorabinaria.com</span>\n</div>\n\n<hr />\n\n<p>Para temas comerciales de cursos presenciales con <strong>Vita Digital S.L.</strong>:  </p>\n\n<blockquote>\n  <p> Email: <span itemprop=\"email\">vitae(at)vitaedigital.com</span> </p>\n  <p> Web: <span itemprop=\"web\"><a href=\"http://www.vitaedigital.com/\">http://www.vitaedigital.com/</a></span> </p>\n  \n</blockquote>","path":"contacto.html","comments":1,"layout":"page","_id":"cjbrwpvd70001iwd38fjcrtou","content":"<div><br>Vivimos en la nube y nos relacionamos contigo en cualquier sitio desde <b>A Corua, Espaa.</b><br></div><br><p><br><div><br>Si quieres <b>visitarnos</b> ven a:<br></div><hr><div itemscope=\"\" itemtype=\"http://schema.org/LocalBusiness\"><br><h4><span itemprop=\"name\">gora Binaria S.L</span></h4><br><span itemprop=\"description\">Factora de software y academia de programadores.</span><br><p><br><div itemprop=\"address\" itemscope=\"\" itemtype=\"http://schema.org/PostalAddress\"><br><span itemprop=\"streetAddress\">Av. Primera C10. Edif Abanca Innova</span><br>CP:<span itemprop=\"postalCode\">15190</span><br><p><br><span itemprop=\"addressLocality\">A Corua</span>,<br><span itemprop=\"addressCountry\">Espaa</span><br></p></div><br>Telefno: <span itemprop=\"telephone\"><a href=\"tel:+34 609884782\" target=\"_blank\" rel=\"external\">+34 609884782</a></span><br></p><p><br>Email: <span itemprop=\"email\">info(at)agorabinaria.com</span><br></p></div><hr></p><p>Para temas comerciales de cursos presenciales con <strong>Vita Digital S.L.</strong>:</p><blockquote><br><p>Email: <span itemprop=\"email\">vitae(at)vitaedigital.com</span></p><br><p>Web: <span itemprop=\"web\"><a href=\"http://www.vitaedigital.com/\" target=\"_blank\" rel=\"external\">http://www.vitaedigital.com/</a></span></p><br><br></blockquote>","site":{"data":{}},"excerpt":"","more":"<div><br>Vivimos en la nube y nos relacionamos contigo en cualquier sitio desde <b>A Corua, Espaa.</b><br></div><br><p><br><div><br>Si quieres <b>visitarnos</b> ven a:<br></div><hr><div itemscope=\"\" itemtype=\"http://schema.org/LocalBusiness\"><br><h4><span itemprop=\"name\">gora Binaria S.L</span></h4><br><span itemprop=\"description\">Factora de software y academia de programadores.</span><br><p><br><div itemprop=\"address\" itemscope=\"\" itemtype=\"http://schema.org/PostalAddress\"><br><span itemprop=\"streetAddress\">Av. Primera C10. Edif Abanca Innova</span><br>CP:<span itemprop=\"postalCode\">15190</span><br><p><br><span itemprop=\"addressLocality\">A Corua</span>,<br><span itemprop=\"addressCountry\">Espaa</span><br></p></div><br>Telefno: <span itemprop=\"telephone\"><a href=\"tel:+34 609884782\" target=\"_blank\" rel=\"external\">+34 609884782</a></span><br></p><p><br>Email: <span itemprop=\"email\">info(at)agorabinaria.com</span><br></p></div><hr></p><p>Para temas comerciales de cursos presenciales con <strong>Vita Digital S.L.</strong>:</p><blockquote><br><p>Email: <span itemprop=\"email\">vitae(at)vitaedigital.com</span></p><br><p>Web: <span itemprop=\"web\"><a href=\"http://www.vitaedigital.com/\" target=\"_blank\" rel=\"external\">http://www.vitaedigital.com/</a></span></p><br><br></blockquote>"},{"title":"Cookies","id":9,"updated":"2016-04-18T13:48:28.000Z","date":"2016-04-14T12:29:58.000Z","_content":"\nUtilizamos cookies para facilitar el uso de nuestra pgina web. \n\nLas cookies son pequeos ficheros de texto que su navegador almacena en el disco duro de su ordenador y que son necesarias para navegar por nuestra pgina web. \n\nLas utilizamos para entender mejor la manera en la que se usa nuestra pgina web y de esta manera poder mejorar consecuentemente el proceso de navegacin. Las cookies son el referente que nos indica, por ejemplo, si una pgina de nuestra web ha sido vista con\nanterioridad, o si su visita es nueva o recurrente. \n\nLas cookies que utilizamos no almacenan dato personal alguno, ni ningn tipo de informacin que pueda identificarle. \n\nEn caso de no querer recibir cookies, por favor configure su navegador de Internet para que las borre del disco duro de su ordenador, las bloquee o le avise en caso de instalacin de las mismas. ","source":"Cookies/index.md","raw":"---\ntitle: Cookies\npermalink: cookies\nid: 9\nupdated: '2016-04-18 15:48:28'\ndate: 2016-04-14 14:29:58\n---\n\nUtilizamos cookies para facilitar el uso de nuestra pgina web. \n\nLas cookies son pequeos ficheros de texto que su navegador almacena en el disco duro de su ordenador y que son necesarias para navegar por nuestra pgina web. \n\nLas utilizamos para entender mejor la manera en la que se usa nuestra pgina web y de esta manera poder mejorar consecuentemente el proceso de navegacin. Las cookies son el referente que nos indica, por ejemplo, si una pgina de nuestra web ha sido vista con\nanterioridad, o si su visita es nueva o recurrente. \n\nLas cookies que utilizamos no almacenan dato personal alguno, ni ningn tipo de informacin que pueda identificarle. \n\nEn caso de no querer recibir cookies, por favor configure su navegador de Internet para que las borre del disco duro de su ordenador, las bloquee o le avise en caso de instalacin de las mismas. ","path":"cookies.html","comments":1,"layout":"page","_id":"cjbrwpvec0003iwd3x2t9a0sb","content":"<p>Utilizamos cookies para facilitar el uso de nuestra pgina web.</p><p>Las cookies son pequeos ficheros de texto que su navegador almacena en el disco duro de su ordenador y que son necesarias para navegar por nuestra pgina web.</p><p>Las utilizamos para entender mejor la manera en la que se usa nuestra pgina web y de esta manera poder mejorar consecuentemente el proceso de navegacin. Las cookies son el referente que nos indica, por ejemplo, si una pgina de nuestra web ha sido vista con<br>anterioridad, o si su visita es nueva o recurrente.</p><p>Las cookies que utilizamos no almacenan dato personal alguno, ni ningn tipo de informacin que pueda identificarle.</p><p>En caso de no querer recibir cookies, por favor configure su navegador de Internet para que las borre del disco duro de su ordenador, las bloquee o le avise en caso de instalacin de las mismas.</p>","site":{"data":{}},"excerpt":"","more":"<p>Utilizamos cookies para facilitar el uso de nuestra pgina web.</p><p>Las cookies son pequeos ficheros de texto que su navegador almacena en el disco duro de su ordenador y que son necesarias para navegar por nuestra pgina web.</p><p>Las utilizamos para entender mejor la manera en la que se usa nuestra pgina web y de esta manera poder mejorar consecuentemente el proceso de navegacin. Las cookies son el referente que nos indica, por ejemplo, si una pgina de nuestra web ha sido vista con<br>anterioridad, o si su visita es nueva o recurrente.</p><p>Las cookies que utilizamos no almacenan dato personal alguno, ni ningn tipo de informacin que pueda identificarle.</p><p>En caso de no querer recibir cookies, por favor configure su navegador de Internet para que las borre del disco duro de su ordenador, las bloquee o le avise en caso de instalacin de las mismas.</p>"},{"title":"Cursos","id":18,"updated":"2017-02-23T16:07:39.000Z","date":"2015-09-16T11:17:03.000Z","_content":"\nCalendario de **cursos** de formacin impartidos y programados:\n\n^^^^\n\n# 2017\n\nvvv\n\n---\n\n> ##Angular 2\n\n>*del 8 al 12 de mayo* \n\n> para universidad de **A Corua**\n\n---\n\n> ##Angular 2\n\n>*del 24 al 28 de abril* \n\n> para consultora informtica en **A Corua**\n\n---\n\n> ##Angular 1.5 Avanzado\n\n>*del 30 al 31 de marzo* \n\n> para consultora informtica en **Madrid**\n\n---\n\n> ##Angular 2\n\n>*del 22 de febrero al 6 de abril* \n\n> para consultora informtica en **A Corua**\n\n---\n\n> ###[Angular 2](http://www.vitaedigital.com/proyectos-de-formacion/curso-en-abierto-de-angular2-con-typescript-y-observables-3-edicion)\n\n>*del 3 al 11 de febrero* \n\n> abierto al pblico en **A Corua** \n\n---\n\n> ###AngularJS\n\n>*del 16 al 24 de enero* \n\n> para consultora informtica en **A Corua**\n\n---\n\n> ###Tecnologa Web\n\n>*el 13 de enero* \n\n> para consultora informtica en **A Corua**\n\n---\n\n^^^\n\n# 2017\n\n---\n\n# 2016\n\nvvv\n\n---\n\n> ###[Angular2](http://www.vitaedigital.com/proyectos-de-formacion/vigo-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x-2-edicion)\n\n>*del 12 al 20 de diciembre* \n\n> abierto al pblico en **Vigo** \n\n---\n\n> ###Angular 2\n\n>*del 28 de noviembre al 15 de diciembre* \n\n> para consultora informtica en **Burgos On Line**\n\n---\n\n> ###AngularJS\n\n>*del 21 al 24 de noviembre* \n\n> para consultora informtica en **A Corua**\n\n---\n\n> ###AngularJS\n\n>*del 11 al 19 de noviembre* \n\n> para consultora informtica en **Santiago**\n\n---\n\n> ###[Angular2](http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/)\n\n>*del 2 al 17 de noviembre* \n\n> abierto al pblico **on line** \n\n---\n\n> ###AngularJS\n\n>*del 24 de octubre al 27 de octubre* \n\n> para consultora informtica en **A Corua**\n\n---\n\n> ###AngularJS\n\n>*del 13 de octubre al 21 de octubre* \n\n> para consultora informtica en **Madrid**\n\n---\n\n> ###AngularJS\n\n>*del 26 de septiembre al 29 de septiembre* \n\n> para entidad bancaria en **A Corua**\n\n---\n\n> ###AngularJS\n\n>*del 26 de septiembre al 29 de septiembre* \n\n> para entidad bancaria en **A Corua**\n\n---\n\n> ###Angular 2\n\n>*del 15 de septiembre al 23 de septiembre* \n\n> para empresa sector automvil en **Vigo**\n\n---\n\n> ###Angular 2\n\n>*del 12 de septiembre al 14 de septiembre* \n\n> para empresa peritaje en **Pontedeume**\n\n---\n\n> ###AngularJS\n\n>*del 18 de agosto al 26 de agosto* \n\n> para consultora informtica en **Madrid**\n\n---\n\n> ###[Angular2](http://vitaedigital.com/#vigo-curso-en-abierto-de-programacion-web-profesional-con-angularjs)\n\n>*del 10 al 18 de junio* \n\n> abierto al pblico en **A Corua** \n\n---\n\n> ###[Angular2](http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/)\n\n>*del 9 al 22 de junio* \n\n> abierto al pblico **on line** \n\n---\n\n> ###MEANjs\n\n>*del 18 de mayo al 6 de julio* \n\n> para consultora informtica en **A Corua** \n\n\n---\n\n> ###[AngularJS](http://vitaedigital.com/#vigo-curso-en-abierto-de-programacion-web-profesional-con-angularjs)\n\n>*del 15 al 23 de abril* \n\n> abierto al pblico en **Vigo** \n\n---\n\n\n> ###[BackEdge](http://escuela.it/cursos/back-edge-desarrollo-web-al-limite-nodejs-es6-npm-mongodb/)\n\n>*del 31 de marzo al 11 de abril* \n\n> abierto al pblico **on line** \n\n---\n\n> ###AngularJS, Material Design\n\n>*del 3 de marzo al 8 de marzo* \n\n> para consultora, multinacional del automvil y entidad bancaria en **Vigo**  \n\n---\n\n> ###AngularJS, Material Design y WebAPI\n\n>*del 22 de febrero al 29 de febrero* \n\n> para entidad bancaria en **A Corua**  \n\n---\n\n> ###[MEANjs](http://vitaedigital.com/download/NTk5/Curso_de_Programacion_MEAN_FullStack_con_MongoDB_Express_AngularJS_y_NodeJS%20(3).pdf)\n\n>*del 29 de enero al 27 de febrero* \n\n> abierto al pblico en **A Corua** \n\n---\n\n> ###[FrontEdge](http://escuela.it/cursos/front-edge-desarrollo-web-al-limite/)\n\n>*del 14 de enero al 25 de enero* \n\n> abierto al pblico **on line** \n\n---\n\n^^^\n\n# 2016\n\n---\n\n# 2015\n\nvvv\n\n---\n---\n\n> ###FrontEdge \n\n>*del 14 de diciembre al 15 de diciembre* \n\n> en abierto en **A Corua** \n\n\n---\n\n> ###AngularJS \n\n>*del 13 de noviembre al 27 de noviembre* \n\n> para consultora informtica en **A Corua** \n\n\n---\n\n> ###AngularJS\n\n>*el 10 de noviembre* \n\n> para consultora informtica en **Santiago de Compostela** \n\n\n---\n\n\n> ###Web Workers\n\n>*el 5 de noviembre* \n\n> abierto al pblico **on line** \n\n---\n\n> ###Angular\n\n>*el 20 de octubre* \n\n> para consultora informtica en **Santiago de Compostela** \n\n---\n\n> ###MEANjs\n\n>*del 14 de octubre al 2 de diciembre* \n\n> para consultora informtica en **A Corua** \n\n---\n\n> ###AngularJS\n\n>*del 5 de octubre al 7 de octubre* \n\n> para multinacional del turismo en **Palma de Mallorca** \n\n\n---\n\n> ###AngularJS y WebAPI\n\n>*del 28 de septiembre al 1 de octubre* \n\n> para entidad bancaria en **A Corua** \n\n\n---\n\n> ###MEANjs\n\n>*del 25 de septiembre al 17 de octubre* \n\n> abierto al pblico en **A Corua** \n\n---\n\n> ###AngularJS\n\n>*del 21 de septiembre al 22 de septiembre* \n\n> para multinacional del turismo en **Palma de Mallorca** \n\n\n---\n\n\n> ###AngularJS \n\n>*del 7 de septiembre al 8 de septiembre* \n\n> para multinacional del turismo en **Palma de Mallorca** \n\n---\n\n> ###AngularJS\n\n>*del 26 de junio al 4 de julio* \n\n> abierto al pblico en **A Corua** \n\n\n---\n\n> ###AngularJS\n\n>*del 5 de junio al 13 de junio* \n\n> multinacional del automvil en **Vigo** \n\n---\n\n> ###AngularJS\n\n>*del 8 de junio al 9 de junio* \n\n> para multinacional del turismo en **Palma de Mallorca** \n\n\n---\n\n> ###NodeJS\n\n>*del 22 de mayo al 30 de mayo* \n\n> abierto al pblico en **Vigo** \n\n\n---\n\n> ###MEANjs\n\n>*del 18 de mayo al 28 de mayo* \n\n> para consultora informtica en **Santiago de Compostela** \n\n---\n\n> ###MongoDB\n\n>*del 13 de abril al 23 de abril* \n\n> para consultora informtica en **A Corua** \n\n---\n\n> ###MEANjs\n\n>*del 16 de marzo al 8 de abril* \n\n> abierto al pblico **on line** \n\n\n---\n\n> ###NodeJS\n\n>*del 6 de marzo al 14 de marzo* \n\n> abierto al pblico en **A Corua** \n\n---\n\n> ###AngularJS\n\n>*del 10 de febrero al 13 de febrero* \n\n> abierto al pblico **on line** \n\n\n---\n\n^^^^\n\n# 2015\n\n---\n\n# 2014\n\nvvvv\n\n---\n\n> ###AngularJS\n\n>*del 21 de noviembre al 29 de noviembre* \n\n> abierto al pblico en **Vigo**\n\n---\n\n> ###AngularJS\n\n>*el 18 de noviembre* \n\n> universidad de **Ourense** \n\n---\n\n> ###AngularJS\n\n>*del 25 de septiembre al 10 de octubre* \n\n> abierto al pblico **on line** \n\n---\n\n> ###AngularJS\n\n>*del 19 de septiembre al 26 de octubre* \n\n> para consultora informtica en **A Corua** \n\n---\n\n> ###AngularJS\n\n>*del 5 de julio al 6 de julio* \n\n> abierto al pblico **on line** \n\n---\n\n> ###AngularJS\n\n>*del 27 de junio al 5 de julio* \n\n> abierto al pblico en **A Corua**\n\n\n---\n^^^\n## 2014\n\n---\n","source":"Cursos/index.md","raw":"---\ntitle: Cursos\npermalink: cursos\nid: 18\nupdated: '2017-02-23 17:07:39'\ndate: 2015-09-16 13:17:03\n---\n\nCalendario de **cursos** de formacin impartidos y programados:\n\n^^^^\n\n# 2017\n\nvvv\n\n---\n\n> ##Angular 2\n\n>*del 8 al 12 de mayo* \n\n> para universidad de **A Corua**\n\n---\n\n> ##Angular 2\n\n>*del 24 al 28 de abril* \n\n> para consultora informtica en **A Corua**\n\n---\n\n> ##Angular 1.5 Avanzado\n\n>*del 30 al 31 de marzo* \n\n> para consultora informtica en **Madrid**\n\n---\n\n> ##Angular 2\n\n>*del 22 de febrero al 6 de abril* \n\n> para consultora informtica en **A Corua**\n\n---\n\n> ###[Angular 2](http://www.vitaedigital.com/proyectos-de-formacion/curso-en-abierto-de-angular2-con-typescript-y-observables-3-edicion)\n\n>*del 3 al 11 de febrero* \n\n> abierto al pblico en **A Corua** \n\n---\n\n> ###AngularJS\n\n>*del 16 al 24 de enero* \n\n> para consultora informtica en **A Corua**\n\n---\n\n> ###Tecnologa Web\n\n>*el 13 de enero* \n\n> para consultora informtica en **A Corua**\n\n---\n\n^^^\n\n# 2017\n\n---\n\n# 2016\n\nvvv\n\n---\n\n> ###[Angular2](http://www.vitaedigital.com/proyectos-de-formacion/vigo-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x-2-edicion)\n\n>*del 12 al 20 de diciembre* \n\n> abierto al pblico en **Vigo** \n\n---\n\n> ###Angular 2\n\n>*del 28 de noviembre al 15 de diciembre* \n\n> para consultora informtica en **Burgos On Line**\n\n---\n\n> ###AngularJS\n\n>*del 21 al 24 de noviembre* \n\n> para consultora informtica en **A Corua**\n\n---\n\n> ###AngularJS\n\n>*del 11 al 19 de noviembre* \n\n> para consultora informtica en **Santiago**\n\n---\n\n> ###[Angular2](http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/)\n\n>*del 2 al 17 de noviembre* \n\n> abierto al pblico **on line** \n\n---\n\n> ###AngularJS\n\n>*del 24 de octubre al 27 de octubre* \n\n> para consultora informtica en **A Corua**\n\n---\n\n> ###AngularJS\n\n>*del 13 de octubre al 21 de octubre* \n\n> para consultora informtica en **Madrid**\n\n---\n\n> ###AngularJS\n\n>*del 26 de septiembre al 29 de septiembre* \n\n> para entidad bancaria en **A Corua**\n\n---\n\n> ###AngularJS\n\n>*del 26 de septiembre al 29 de septiembre* \n\n> para entidad bancaria en **A Corua**\n\n---\n\n> ###Angular 2\n\n>*del 15 de septiembre al 23 de septiembre* \n\n> para empresa sector automvil en **Vigo**\n\n---\n\n> ###Angular 2\n\n>*del 12 de septiembre al 14 de septiembre* \n\n> para empresa peritaje en **Pontedeume**\n\n---\n\n> ###AngularJS\n\n>*del 18 de agosto al 26 de agosto* \n\n> para consultora informtica en **Madrid**\n\n---\n\n> ###[Angular2](http://vitaedigital.com/#vigo-curso-en-abierto-de-programacion-web-profesional-con-angularjs)\n\n>*del 10 al 18 de junio* \n\n> abierto al pblico en **A Corua** \n\n---\n\n> ###[Angular2](http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/)\n\n>*del 9 al 22 de junio* \n\n> abierto al pblico **on line** \n\n---\n\n> ###MEANjs\n\n>*del 18 de mayo al 6 de julio* \n\n> para consultora informtica en **A Corua** \n\n\n---\n\n> ###[AngularJS](http://vitaedigital.com/#vigo-curso-en-abierto-de-programacion-web-profesional-con-angularjs)\n\n>*del 15 al 23 de abril* \n\n> abierto al pblico en **Vigo** \n\n---\n\n\n> ###[BackEdge](http://escuela.it/cursos/back-edge-desarrollo-web-al-limite-nodejs-es6-npm-mongodb/)\n\n>*del 31 de marzo al 11 de abril* \n\n> abierto al pblico **on line** \n\n---\n\n> ###AngularJS, Material Design\n\n>*del 3 de marzo al 8 de marzo* \n\n> para consultora, multinacional del automvil y entidad bancaria en **Vigo**  \n\n---\n\n> ###AngularJS, Material Design y WebAPI\n\n>*del 22 de febrero al 29 de febrero* \n\n> para entidad bancaria en **A Corua**  \n\n---\n\n> ###[MEANjs](http://vitaedigital.com/download/NTk5/Curso_de_Programacion_MEAN_FullStack_con_MongoDB_Express_AngularJS_y_NodeJS%20(3).pdf)\n\n>*del 29 de enero al 27 de febrero* \n\n> abierto al pblico en **A Corua** \n\n---\n\n> ###[FrontEdge](http://escuela.it/cursos/front-edge-desarrollo-web-al-limite/)\n\n>*del 14 de enero al 25 de enero* \n\n> abierto al pblico **on line** \n\n---\n\n^^^\n\n# 2016\n\n---\n\n# 2015\n\nvvv\n\n---\n---\n\n> ###FrontEdge \n\n>*del 14 de diciembre al 15 de diciembre* \n\n> en abierto en **A Corua** \n\n\n---\n\n> ###AngularJS \n\n>*del 13 de noviembre al 27 de noviembre* \n\n> para consultora informtica en **A Corua** \n\n\n---\n\n> ###AngularJS\n\n>*el 10 de noviembre* \n\n> para consultora informtica en **Santiago de Compostela** \n\n\n---\n\n\n> ###Web Workers\n\n>*el 5 de noviembre* \n\n> abierto al pblico **on line** \n\n---\n\n> ###Angular\n\n>*el 20 de octubre* \n\n> para consultora informtica en **Santiago de Compostela** \n\n---\n\n> ###MEANjs\n\n>*del 14 de octubre al 2 de diciembre* \n\n> para consultora informtica en **A Corua** \n\n---\n\n> ###AngularJS\n\n>*del 5 de octubre al 7 de octubre* \n\n> para multinacional del turismo en **Palma de Mallorca** \n\n\n---\n\n> ###AngularJS y WebAPI\n\n>*del 28 de septiembre al 1 de octubre* \n\n> para entidad bancaria en **A Corua** \n\n\n---\n\n> ###MEANjs\n\n>*del 25 de septiembre al 17 de octubre* \n\n> abierto al pblico en **A Corua** \n\n---\n\n> ###AngularJS\n\n>*del 21 de septiembre al 22 de septiembre* \n\n> para multinacional del turismo en **Palma de Mallorca** \n\n\n---\n\n\n> ###AngularJS \n\n>*del 7 de septiembre al 8 de septiembre* \n\n> para multinacional del turismo en **Palma de Mallorca** \n\n---\n\n> ###AngularJS\n\n>*del 26 de junio al 4 de julio* \n\n> abierto al pblico en **A Corua** \n\n\n---\n\n> ###AngularJS\n\n>*del 5 de junio al 13 de junio* \n\n> multinacional del automvil en **Vigo** \n\n---\n\n> ###AngularJS\n\n>*del 8 de junio al 9 de junio* \n\n> para multinacional del turismo en **Palma de Mallorca** \n\n\n---\n\n> ###NodeJS\n\n>*del 22 de mayo al 30 de mayo* \n\n> abierto al pblico en **Vigo** \n\n\n---\n\n> ###MEANjs\n\n>*del 18 de mayo al 28 de mayo* \n\n> para consultora informtica en **Santiago de Compostela** \n\n---\n\n> ###MongoDB\n\n>*del 13 de abril al 23 de abril* \n\n> para consultora informtica en **A Corua** \n\n---\n\n> ###MEANjs\n\n>*del 16 de marzo al 8 de abril* \n\n> abierto al pblico **on line** \n\n\n---\n\n> ###NodeJS\n\n>*del 6 de marzo al 14 de marzo* \n\n> abierto al pblico en **A Corua** \n\n---\n\n> ###AngularJS\n\n>*del 10 de febrero al 13 de febrero* \n\n> abierto al pblico **on line** \n\n\n---\n\n^^^^\n\n# 2015\n\n---\n\n# 2014\n\nvvvv\n\n---\n\n> ###AngularJS\n\n>*del 21 de noviembre al 29 de noviembre* \n\n> abierto al pblico en **Vigo**\n\n---\n\n> ###AngularJS\n\n>*el 18 de noviembre* \n\n> universidad de **Ourense** \n\n---\n\n> ###AngularJS\n\n>*del 25 de septiembre al 10 de octubre* \n\n> abierto al pblico **on line** \n\n---\n\n> ###AngularJS\n\n>*del 19 de septiembre al 26 de octubre* \n\n> para consultora informtica en **A Corua** \n\n---\n\n> ###AngularJS\n\n>*del 5 de julio al 6 de julio* \n\n> abierto al pblico **on line** \n\n---\n\n> ###AngularJS\n\n>*del 27 de junio al 5 de julio* \n\n> abierto al pblico en **A Corua**\n\n\n---\n^^^\n## 2014\n\n---\n","path":"cursos.html","comments":1,"layout":"page","_id":"cjbrwpveq0007iwd3a13fc6bf","content":"<p>Calendario de <strong>cursos</strong> de formacin impartidos y programados:</p><p>^^^^</p><h1 id=\"2017\"><a href=\"#2017\" class=\"headerlink\" title=\"2017\"></a>2017</h1><p>vvv</p><hr><blockquote><p>##Angular 2</p><p><em>del 8 al 12 de mayo</em></p><p>para universidad de <strong>A Corua</strong></p></blockquote><hr><blockquote><p>##Angular 2</p><p><em>del 24 al 28 de abril</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>##Angular 1.5 Avanzado</p><p><em>del 30 al 31 de marzo</em></p><p>para consultora informtica en <strong>Madrid</strong></p></blockquote><hr><blockquote><p>##Angular 2</p><p><em>del 22 de febrero al 6 de abril</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://www.vitaedigital.com/proyectos-de-formacion/curso-en-abierto-de-angular2-con-typescript-y-observables-3-edicion\" target=\"_blank\" rel=\"external\">Angular 2</a></p><p><em>del 3 al 11 de febrero</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 16 al 24 de enero</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###Tecnologa Web</p><p><em>el 13 de enero</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><p>^^^</p><h1 id=\"2017-1\"><a href=\"#2017-1\" class=\"headerlink\" title=\"2017\"></a>2017</h1><hr><h1 id=\"2016\"><a href=\"#2016\" class=\"headerlink\" title=\"2016\"></a>2016</h1><p>vvv</p><hr><blockquote><p>###<a href=\"http://www.vitaedigital.com/proyectos-de-formacion/vigo-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x-2-edicion\" target=\"_blank\" rel=\"external\">Angular2</a></p><p><em>del 12 al 20 de diciembre</em></p><p>abierto al pblico en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###Angular 2</p><p><em>del 28 de noviembre al 15 de diciembre</em></p><p>para consultora informtica en <strong>Burgos On Line</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 21 al 24 de noviembre</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 11 al 19 de noviembre</em></p><p>para consultora informtica en <strong>Santiago</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/\" target=\"_blank\" rel=\"external\">Angular2</a></p><p><em>del 2 al 17 de noviembre</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 24 de octubre al 27 de octubre</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 13 de octubre al 21 de octubre</em></p><p>para consultora informtica en <strong>Madrid</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 26 de septiembre al 29 de septiembre</em></p><p>para entidad bancaria en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 26 de septiembre al 29 de septiembre</em></p><p>para entidad bancaria en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###Angular 2</p><p><em>del 15 de septiembre al 23 de septiembre</em></p><p>para empresa sector automvil en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###Angular 2</p><p><em>del 12 de septiembre al 14 de septiembre</em></p><p>para empresa peritaje en <strong>Pontedeume</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 18 de agosto al 26 de agosto</em></p><p>para consultora informtica en <strong>Madrid</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://vitaedigital.com/#vigo-curso-en-abierto-de-programacion-web-profesional-con-angularjs\" target=\"_blank\" rel=\"external\">Angular2</a></p><p><em>del 10 al 18 de junio</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/\" target=\"_blank\" rel=\"external\">Angular2</a></p><p><em>del 9 al 22 de junio</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###MEANjs</p><p><em>del 18 de mayo al 6 de julio</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://vitaedigital.com/#vigo-curso-en-abierto-de-programacion-web-profesional-con-angularjs\" target=\"_blank\" rel=\"external\">AngularJS</a></p><p><em>del 15 al 23 de abril</em></p><p>abierto al pblico en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://escuela.it/cursos/back-edge-desarrollo-web-al-limite-nodejs-es6-npm-mongodb/\" target=\"_blank\" rel=\"external\">BackEdge</a></p><p><em>del 31 de marzo al 11 de abril</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###AngularJS, Material Design</p><p><em>del 3 de marzo al 8 de marzo</em></p><p>para consultora, multinacional del automvil y entidad bancaria en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###AngularJS, Material Design y WebAPI</p><p><em>del 22 de febrero al 29 de febrero</em></p><p>para entidad bancaria en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://vitaedigital.com/download/NTk5/Curso_de_Programacion_MEAN_FullStack_con_MongoDB_Express_AngularJS_y_NodeJS%20(3\" target=\"_blank\" rel=\"external\">MEANjs</a>.pdf)</p><p><em>del 29 de enero al 27 de febrero</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://escuela.it/cursos/front-edge-desarrollo-web-al-limite/\" target=\"_blank\" rel=\"external\">FrontEdge</a></p><p><em>del 14 de enero al 25 de enero</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><p>^^^</p><h1 id=\"2016-1\"><a href=\"#2016-1\" class=\"headerlink\" title=\"2016\"></a>2016</h1><hr><h1 id=\"2015\"><a href=\"#2015\" class=\"headerlink\" title=\"2015\"></a>2015</h1><p>vvv</p><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote><p>###FrontEdge</p><p><em>del 14 de diciembre al 15 de diciembre</em></p><p>en abierto en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 13 de noviembre al 27 de noviembre</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>el 10 de noviembre</em></p><p>para consultora informtica en <strong>Santiago de Compostela</strong></p></blockquote><hr><blockquote><p>###Web Workers</p><p><em>el 5 de noviembre</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###Angular</p><p><em>el 20 de octubre</em></p><p>para consultora informtica en <strong>Santiago de Compostela</strong></p></blockquote><hr><blockquote><p>###MEANjs</p><p><em>del 14 de octubre al 2 de diciembre</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 5 de octubre al 7 de octubre</em></p><p>para multinacional del turismo en <strong>Palma de Mallorca</strong></p></blockquote><hr><blockquote><p>###AngularJS y WebAPI</p><p><em>del 28 de septiembre al 1 de octubre</em></p><p>para entidad bancaria en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###MEANjs</p><p><em>del 25 de septiembre al 17 de octubre</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 21 de septiembre al 22 de septiembre</em></p><p>para multinacional del turismo en <strong>Palma de Mallorca</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 7 de septiembre al 8 de septiembre</em></p><p>para multinacional del turismo en <strong>Palma de Mallorca</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 26 de junio al 4 de julio</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 5 de junio al 13 de junio</em></p><p>multinacional del automvil en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 8 de junio al 9 de junio</em></p><p>para multinacional del turismo en <strong>Palma de Mallorca</strong></p></blockquote><hr><blockquote><p>###NodeJS</p><p><em>del 22 de mayo al 30 de mayo</em></p><p>abierto al pblico en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###MEANjs</p><p><em>del 18 de mayo al 28 de mayo</em></p><p>para consultora informtica en <strong>Santiago de Compostela</strong></p></blockquote><hr><blockquote><p>###MongoDB</p><p><em>del 13 de abril al 23 de abril</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###MEANjs</p><p><em>del 16 de marzo al 8 de abril</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###NodeJS</p><p><em>del 6 de marzo al 14 de marzo</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 10 de febrero al 13 de febrero</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><p>^^^^</p><h1 id=\"2015-1\"><a href=\"#2015-1\" class=\"headerlink\" title=\"2015\"></a>2015</h1><hr><h1 id=\"2014\"><a href=\"#2014\" class=\"headerlink\" title=\"2014\"></a>2014</h1><p>vvvv</p><hr><blockquote><p>###AngularJS</p><p><em>del 21 de noviembre al 29 de noviembre</em></p><p>abierto al pblico en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>el 18 de noviembre</em></p><p>universidad de <strong>Ourense</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 25 de septiembre al 10 de octubre</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 19 de septiembre al 26 de octubre</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 5 de julio al 6 de julio</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 27 de junio al 5 de julio</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><p>^^^</p><h2 id=\"2014-1\"><a href=\"#2014-1\" class=\"headerlink\" title=\"2014\"></a>2014</h2><hr>","site":{"data":{}},"excerpt":"","more":"<p>Calendario de <strong>cursos</strong> de formacin impartidos y programados:</p><p>^^^^</p><h1 id=\"2017\"><a href=\"#2017\" class=\"headerlink\" title=\"2017\"></a>2017</h1><p>vvv</p><hr><blockquote><p>##Angular 2</p><p><em>del 8 al 12 de mayo</em></p><p>para universidad de <strong>A Corua</strong></p></blockquote><hr><blockquote><p>##Angular 2</p><p><em>del 24 al 28 de abril</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>##Angular 1.5 Avanzado</p><p><em>del 30 al 31 de marzo</em></p><p>para consultora informtica en <strong>Madrid</strong></p></blockquote><hr><blockquote><p>##Angular 2</p><p><em>del 22 de febrero al 6 de abril</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://www.vitaedigital.com/proyectos-de-formacion/curso-en-abierto-de-angular2-con-typescript-y-observables-3-edicion\" target=\"_blank\" rel=\"external\">Angular 2</a></p><p><em>del 3 al 11 de febrero</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 16 al 24 de enero</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###Tecnologa Web</p><p><em>el 13 de enero</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><p>^^^</p><h1 id=\"2017-1\"><a href=\"#2017-1\" class=\"headerlink\" title=\"2017\"></a>2017</h1><hr><h1 id=\"2016\"><a href=\"#2016\" class=\"headerlink\" title=\"2016\"></a>2016</h1><p>vvv</p><hr><blockquote><p>###<a href=\"http://www.vitaedigital.com/proyectos-de-formacion/vigo-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x-2-edicion\" target=\"_blank\" rel=\"external\">Angular2</a></p><p><em>del 12 al 20 de diciembre</em></p><p>abierto al pblico en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###Angular 2</p><p><em>del 28 de noviembre al 15 de diciembre</em></p><p>para consultora informtica en <strong>Burgos On Line</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 21 al 24 de noviembre</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 11 al 19 de noviembre</em></p><p>para consultora informtica en <strong>Santiago</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/\" target=\"_blank\" rel=\"external\">Angular2</a></p><p><em>del 2 al 17 de noviembre</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 24 de octubre al 27 de octubre</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 13 de octubre al 21 de octubre</em></p><p>para consultora informtica en <strong>Madrid</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 26 de septiembre al 29 de septiembre</em></p><p>para entidad bancaria en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 26 de septiembre al 29 de septiembre</em></p><p>para entidad bancaria en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###Angular 2</p><p><em>del 15 de septiembre al 23 de septiembre</em></p><p>para empresa sector automvil en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###Angular 2</p><p><em>del 12 de septiembre al 14 de septiembre</em></p><p>para empresa peritaje en <strong>Pontedeume</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 18 de agosto al 26 de agosto</em></p><p>para consultora informtica en <strong>Madrid</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://vitaedigital.com/#vigo-curso-en-abierto-de-programacion-web-profesional-con-angularjs\" target=\"_blank\" rel=\"external\">Angular2</a></p><p><em>del 10 al 18 de junio</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/\" target=\"_blank\" rel=\"external\">Angular2</a></p><p><em>del 9 al 22 de junio</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###MEANjs</p><p><em>del 18 de mayo al 6 de julio</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://vitaedigital.com/#vigo-curso-en-abierto-de-programacion-web-profesional-con-angularjs\" target=\"_blank\" rel=\"external\">AngularJS</a></p><p><em>del 15 al 23 de abril</em></p><p>abierto al pblico en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://escuela.it/cursos/back-edge-desarrollo-web-al-limite-nodejs-es6-npm-mongodb/\" target=\"_blank\" rel=\"external\">BackEdge</a></p><p><em>del 31 de marzo al 11 de abril</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###AngularJS, Material Design</p><p><em>del 3 de marzo al 8 de marzo</em></p><p>para consultora, multinacional del automvil y entidad bancaria en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###AngularJS, Material Design y WebAPI</p><p><em>del 22 de febrero al 29 de febrero</em></p><p>para entidad bancaria en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://vitaedigital.com/download/NTk5/Curso_de_Programacion_MEAN_FullStack_con_MongoDB_Express_AngularJS_y_NodeJS%20(3\" target=\"_blank\" rel=\"external\">MEANjs</a>.pdf)</p><p><em>del 29 de enero al 27 de febrero</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###<a href=\"http://escuela.it/cursos/front-edge-desarrollo-web-al-limite/\" target=\"_blank\" rel=\"external\">FrontEdge</a></p><p><em>del 14 de enero al 25 de enero</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><p>^^^</p><h1 id=\"2016-1\"><a href=\"#2016-1\" class=\"headerlink\" title=\"2016\"></a>2016</h1><hr><h1 id=\"2015\"><a href=\"#2015\" class=\"headerlink\" title=\"2015\"></a>2015</h1><p>vvv</p><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><blockquote><p>###FrontEdge</p><p><em>del 14 de diciembre al 15 de diciembre</em></p><p>en abierto en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 13 de noviembre al 27 de noviembre</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>el 10 de noviembre</em></p><p>para consultora informtica en <strong>Santiago de Compostela</strong></p></blockquote><hr><blockquote><p>###Web Workers</p><p><em>el 5 de noviembre</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###Angular</p><p><em>el 20 de octubre</em></p><p>para consultora informtica en <strong>Santiago de Compostela</strong></p></blockquote><hr><blockquote><p>###MEANjs</p><p><em>del 14 de octubre al 2 de diciembre</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 5 de octubre al 7 de octubre</em></p><p>para multinacional del turismo en <strong>Palma de Mallorca</strong></p></blockquote><hr><blockquote><p>###AngularJS y WebAPI</p><p><em>del 28 de septiembre al 1 de octubre</em></p><p>para entidad bancaria en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###MEANjs</p><p><em>del 25 de septiembre al 17 de octubre</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 21 de septiembre al 22 de septiembre</em></p><p>para multinacional del turismo en <strong>Palma de Mallorca</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 7 de septiembre al 8 de septiembre</em></p><p>para multinacional del turismo en <strong>Palma de Mallorca</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 26 de junio al 4 de julio</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 5 de junio al 13 de junio</em></p><p>multinacional del automvil en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 8 de junio al 9 de junio</em></p><p>para multinacional del turismo en <strong>Palma de Mallorca</strong></p></blockquote><hr><blockquote><p>###NodeJS</p><p><em>del 22 de mayo al 30 de mayo</em></p><p>abierto al pblico en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###MEANjs</p><p><em>del 18 de mayo al 28 de mayo</em></p><p>para consultora informtica en <strong>Santiago de Compostela</strong></p></blockquote><hr><blockquote><p>###MongoDB</p><p><em>del 13 de abril al 23 de abril</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###MEANjs</p><p><em>del 16 de marzo al 8 de abril</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###NodeJS</p><p><em>del 6 de marzo al 14 de marzo</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 10 de febrero al 13 de febrero</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><p>^^^^</p><h1 id=\"2015-1\"><a href=\"#2015-1\" class=\"headerlink\" title=\"2015\"></a>2015</h1><hr><h1 id=\"2014\"><a href=\"#2014\" class=\"headerlink\" title=\"2014\"></a>2014</h1><p>vvvv</p><hr><blockquote><p>###AngularJS</p><p><em>del 21 de noviembre al 29 de noviembre</em></p><p>abierto al pblico en <strong>Vigo</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>el 18 de noviembre</em></p><p>universidad de <strong>Ourense</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 25 de septiembre al 10 de octubre</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 19 de septiembre al 26 de octubre</em></p><p>para consultora informtica en <strong>A Corua</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 5 de julio al 6 de julio</em></p><p>abierto al pblico <strong>on line</strong></p></blockquote><hr><blockquote><p>###AngularJS</p><p><em>del 27 de junio al 5 de julio</em></p><p>abierto al pblico en <strong>A Corua</strong></p></blockquote><hr><p>^^^</p><h2 id=\"2014-1\"><a href=\"#2014-1\" class=\"headerlink\" title=\"2014\"></a>2014</h2><hr>"},{"title":"Noticias Junio 2016","id":16,"updated":"2016-06-06T12:28:19.000Z","date":"2016-06-03T08:44:51.000Z","_content":"\n##06-06-16\n\n\n###Angular 2 R.C.: La evolucin de la plataforma.\nAngularJS ha sufrido una metamorfosis. Mantiene el nombre a duras penas. Ahora ya ni le pone el sufijo ...JS. Pero la esperada versin [Angular2](http://angular.io) lo cambia todo. Cambia el lenguaje, cambia la filosofa y cambia la sintaxis.\n\nTodo este cambio es necesario para competir en el ecosistema JavaScript. Continuamente aparecen y desaparecen libreras. Para sobrevivir fue necesario renacer. Ahora [es una plataforma](/angular2-primeras-impresiones/) mucho ms cercana al mundo empresarial. \n\nUsa esta [serie de artculos sobre Angular2](/tag/angular2/) como tutorial para adaptarte a esta evolucin.\n \n###Enlaces para aprender\n####[AngularJS] : [Mejorar el Rendimiento en una lnea.]()\nParece un eslogan de gancho fcil, pero funciona. La clave es la informacin de depuracin que se genera de manera automtica. Al eliminarla se reduce el peso y se mejora la velocidad.\n \n####[JavaScript] : [La fatiga de frameworks comparada.]()\nEmpiezo por la consabida broma de pedir una moratoria en el desarrollo de armas... digo de frameworks JavaScript . Mientras tanto mira esta tabla que compara la sintaxis de libreras muy populares.\n \n####[NodeJS] : [Monitorizar aplicaciones bien y fcil.]()\nSi no sabes lo que hace tu aplicacin ests perdido. Lo primero que necesitas es una estrategia para generar logs. En Node tienes muchas opciones. Adems del console.log(' ;-) ').\n \n####[MongoDB] : [Rendimiento y Monitorizacin de MongoDB.]()\nAhora le toca a la base de datos. No es fcil entender ni usar correctamente la enorme cantidad de mtricas que ofrece MongoDB. Pero es fundamental conocer y aplicar algunas para controlar y escalar  las instalciones.\n \n####[CleanCode] : [Escribe cdigo pensando en mantenerlo.]()\nEscribimos una vez pero revisamos 20. Nosotros, nuestros compaeros y nuestros herederos. Unos cuantos consejos y buenas prcticas te ayudarn a tratar con lo heredado y a dejar mejores herencias.\n \n###Prximas actividades\nEste es el mes de Angular2. Su estreno como Release Candidate permite ofrecer [formacin con garantas](/promociones). Nos vemos.\n\n \n>*Keep coding, keep learning.*","source":"Noticias-Junio-2016/index.md","raw":"---\ntitle: Noticias Junio 2016\npermalink: noticias-junio-16\nid: 16\nupdated: '2016-06-06 14:28:19'\ndate: 2016-06-03 10:44:51\n---\n\n##06-06-16\n\n\n###Angular 2 R.C.: La evolucin de la plataforma.\nAngularJS ha sufrido una metamorfosis. Mantiene el nombre a duras penas. Ahora ya ni le pone el sufijo ...JS. Pero la esperada versin [Angular2](http://angular.io) lo cambia todo. Cambia el lenguaje, cambia la filosofa y cambia la sintaxis.\n\nTodo este cambio es necesario para competir en el ecosistema JavaScript. Continuamente aparecen y desaparecen libreras. Para sobrevivir fue necesario renacer. Ahora [es una plataforma](/angular2-primeras-impresiones/) mucho ms cercana al mundo empresarial. \n\nUsa esta [serie de artculos sobre Angular2](/tag/angular2/) como tutorial para adaptarte a esta evolucin.\n \n###Enlaces para aprender\n####[AngularJS] : [Mejorar el Rendimiento en una lnea.]()\nParece un eslogan de gancho fcil, pero funciona. La clave es la informacin de depuracin que se genera de manera automtica. Al eliminarla se reduce el peso y se mejora la velocidad.\n \n####[JavaScript] : [La fatiga de frameworks comparada.]()\nEmpiezo por la consabida broma de pedir una moratoria en el desarrollo de armas... digo de frameworks JavaScript . Mientras tanto mira esta tabla que compara la sintaxis de libreras muy populares.\n \n####[NodeJS] : [Monitorizar aplicaciones bien y fcil.]()\nSi no sabes lo que hace tu aplicacin ests perdido. Lo primero que necesitas es una estrategia para generar logs. En Node tienes muchas opciones. Adems del console.log(' ;-) ').\n \n####[MongoDB] : [Rendimiento y Monitorizacin de MongoDB.]()\nAhora le toca a la base de datos. No es fcil entender ni usar correctamente la enorme cantidad de mtricas que ofrece MongoDB. Pero es fundamental conocer y aplicar algunas para controlar y escalar  las instalciones.\n \n####[CleanCode] : [Escribe cdigo pensando en mantenerlo.]()\nEscribimos una vez pero revisamos 20. Nosotros, nuestros compaeros y nuestros herederos. Unos cuantos consejos y buenas prcticas te ayudarn a tratar con lo heredado y a dejar mejores herencias.\n \n###Prximas actividades\nEste es el mes de Angular2. Su estreno como Release Candidate permite ofrecer [formacin con garantas](/promociones). Nos vemos.\n\n \n>*Keep coding, keep learning.*","path":"noticias-junio-16.html","comments":1,"layout":"page","_id":"cjbrwpvf60009iwd34h234mq0","content":"<p>##06-06-16</p><p>###Angular 2 R.C.: La evolucin de la plataforma.<br>AngularJS ha sufrido una metamorfosis. Mantiene el nombre a duras penas. Ahora ya ni le pone el sufijo JS. Pero la esperada versin <a href=\"http://angular.io\" target=\"_blank\" rel=\"external\">Angular2</a> lo cambia todo. Cambia el lenguaje, cambia la filosofa y cambia la sintaxis.</p><p>Todo este cambio es necesario para competir en el ecosistema JavaScript. Continuamente aparecen y desaparecen libreras. Para sobrevivir fue necesario renacer. Ahora <a href=\"/angular2-primeras-impresiones/\">es una plataforma</a> mucho ms cercana al mundo empresarial.</p><p>Usa esta <a href=\"/tag/angular2/\">serie de artculos sobre Angular2</a> como tutorial para adaptarte a esta evolucin.</p><p>###Enlaces para aprender</p><p>####[AngularJS] : <a href=\"\">Mejorar el Rendimiento en una lnea.</a><br>Parece un eslogan de gancho fcil, pero funciona. La clave es la informacin de depuracin que se genera de manera automtica. Al eliminarla se reduce el peso y se mejora la velocidad.</p><p>####[JavaScript] : <a href=\"\">La fatiga de frameworks comparada.</a><br>Empiezo por la consabida broma de pedir una moratoria en el desarrollo de armas digo de frameworks JavaScript . Mientras tanto mira esta tabla que compara la sintaxis de libreras muy populares.</p><p>####[NodeJS] : <a href=\"\">Monitorizar aplicaciones bien y fcil.</a><br>Si no sabes lo que hace tu aplicacin ests perdido. Lo primero que necesitas es una estrategia para generar logs. En Node tienes muchas opciones. Adems del console.log( ;-) ).</p><p>####[MongoDB] : <a href=\"\">Rendimiento y Monitorizacin de MongoDB.</a><br>Ahora le toca a la base de datos. No es fcil entender ni usar correctamente la enorme cantidad de mtricas que ofrece MongoDB. Pero es fundamental conocer y aplicar algunas para controlar y escalar las instalciones.</p><p>####[CleanCode] : <a href=\"\">Escribe cdigo pensando en mantenerlo.</a><br>Escribimos una vez pero revisamos 20. Nosotros, nuestros compaeros y nuestros herederos. Unos cuantos consejos y buenas prcticas te ayudarn a tratar con lo heredado y a dejar mejores herencias.</p><p>###Prximas actividades<br>Este es el mes de Angular2. Su estreno como Release Candidate permite ofrecer <a href=\"/promociones\">formacin con garantas</a>. Nos vemos.</p><blockquote><p><em>Keep coding, keep learning.</em></p></blockquote>","site":{"data":{}},"excerpt":"","more":"<p>##06-06-16</p><p>###Angular 2 R.C.: La evolucin de la plataforma.<br>AngularJS ha sufrido una metamorfosis. Mantiene el nombre a duras penas. Ahora ya ni le pone el sufijo JS. Pero la esperada versin <a href=\"http://angular.io\" target=\"_blank\" rel=\"external\">Angular2</a> lo cambia todo. Cambia el lenguaje, cambia la filosofa y cambia la sintaxis.</p><p>Todo este cambio es necesario para competir en el ecosistema JavaScript. Continuamente aparecen y desaparecen libreras. Para sobrevivir fue necesario renacer. Ahora <a href=\"/angular2-primeras-impresiones/\">es una plataforma</a> mucho ms cercana al mundo empresarial.</p><p>Usa esta <a href=\"/tag/angular2/\">serie de artculos sobre Angular2</a> como tutorial para adaptarte a esta evolucin.</p><p>###Enlaces para aprender</p><p>####[AngularJS] : <a href=\"\">Mejorar el Rendimiento en una lnea.</a><br>Parece un eslogan de gancho fcil, pero funciona. La clave es la informacin de depuracin que se genera de manera automtica. Al eliminarla se reduce el peso y se mejora la velocidad.</p><p>####[JavaScript] : <a href=\"\">La fatiga de frameworks comparada.</a><br>Empiezo por la consabida broma de pedir una moratoria en el desarrollo de armas digo de frameworks JavaScript . Mientras tanto mira esta tabla que compara la sintaxis de libreras muy populares.</p><p>####[NodeJS] : <a href=\"\">Monitorizar aplicaciones bien y fcil.</a><br>Si no sabes lo que hace tu aplicacin ests perdido. Lo primero que necesitas es una estrategia para generar logs. En Node tienes muchas opciones. Adems del console.log( ;-) ).</p><p>####[MongoDB] : <a href=\"\">Rendimiento y Monitorizacin de MongoDB.</a><br>Ahora le toca a la base de datos. No es fcil entender ni usar correctamente la enorme cantidad de mtricas que ofrece MongoDB. Pero es fundamental conocer y aplicar algunas para controlar y escalar las instalciones.</p><p>####[CleanCode] : <a href=\"\">Escribe cdigo pensando en mantenerlo.</a><br>Escribimos una vez pero revisamos 20. Nosotros, nuestros compaeros y nuestros herederos. Unos cuantos consejos y buenas prcticas te ayudarn a tratar con lo heredado y a dejar mejores herencias.</p><p>###Prximas actividades<br>Este es el mes de Angular2. Su estreno como Release Candidate permite ofrecer <a href=\"/promociones\">formacin con garantas</a>. Nos vemos.</p><blockquote><p><em>Keep coding, keep learning.</em></p></blockquote>"},{"title":"Promociones","id":25,"updated":"2016-05-27T06:46:03.000Z","date":"2016-05-10T11:53:10.000Z","_content":"\n#Cursos de Angular2\n\n---\n\n####Online\n\nInicio 9 de junio de 2016\n\n###[Angular 2, desarrollo de aplicaciones empresariales con HTML](http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/)\n\nCon EscuelaIT\n\n\n---\n\n####Presencial en Corua\n\nInicio 10 de junio de 2016\n\n###[A Corua : Curso en Abierto de Angular2, TypeScript y Estrategias de Migracin de versiones 1.x](http://vitaedigital.com/ofertas-formacion/#a-coruna-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x)\n\nCon Vitae Digital","source":"Promociones/index.md","raw":"---\ntitle: Promociones\npermalink: promociones\nid: 25\nupdated: '2016-05-27 08:46:03'\ndate: 2016-05-10 13:53:10\n---\n\n#Cursos de Angular2\n\n---\n\n####Online\n\nInicio 9 de junio de 2016\n\n###[Angular 2, desarrollo de aplicaciones empresariales con HTML](http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/)\n\nCon EscuelaIT\n\n\n---\n\n####Presencial en Corua\n\nInicio 10 de junio de 2016\n\n###[A Corua : Curso en Abierto de Angular2, TypeScript y Estrategias de Migracin de versiones 1.x](http://vitaedigital.com/ofertas-formacion/#a-coruna-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x)\n\nCon Vitae Digital","path":"promociones.html","comments":1,"layout":"page","_id":"cjbrwpvf6000biwd347gmrtbz","content":"<p>#Cursos de Angular2</p><hr><p>####Online</p><p>Inicio 9 de junio de 2016</p><p>###<a href=\"http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/\" target=\"_blank\" rel=\"external\">Angular 2, desarrollo de aplicaciones empresariales con HTML</a></p><p>Con EscuelaIT</p><hr><p>####Presencial en Corua</p><p>Inicio 10 de junio de 2016</p><p>###<a href=\"http://vitaedigital.com/ofertas-formacion/#a-coruna-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x\" target=\"_blank\" rel=\"external\">A Corua : Curso en Abierto de Angular2, TypeScript y Estrategias de Migracin de versiones 1.x</a></p><p>Con Vitae Digital</p>","site":{"data":{}},"excerpt":"","more":"<p>#Cursos de Angular2</p><hr><p>####Online</p><p>Inicio 9 de junio de 2016</p><p>###<a href=\"http://escuela.it/cursos/angular-2-desarrollo-aplicaciones-empresariales-html/\" target=\"_blank\" rel=\"external\">Angular 2, desarrollo de aplicaciones empresariales con HTML</a></p><p>Con EscuelaIT</p><hr><p>####Presencial en Corua</p><p>Inicio 10 de junio de 2016</p><p>###<a href=\"http://vitaedigital.com/ofertas-formacion/#a-coruna-curso-en-abierto-de-angular2-typescript-y-estrategias-de-migracion-de-versiones-1-x\" target=\"_blank\" rel=\"external\">A Corua : Curso en Abierto de Angular2, TypeScript y Estrategias de Migracin de versiones 1.x</a></p><p>Con Vitae Digital</p>"},{"title":"[object Object]","tags":null,"_content":"","source":"scaffolds/draft.md","raw":"---\ntitle: {{ title }}\ntags:\n---\n","date":"2017-10-31T10:46:44.448Z","updated":"2017-10-31T10:46:44.448Z","path":"scaffolds/draft.html","comments":1,"layout":"page","_id":"cjbrwpvfm000giwd3958tc4f1","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"[object Object]","date":"2017-10-31T10:46:44.450Z","_content":"","source":"scaffolds/page.md","raw":"---\ntitle: {{ title }}\ndate: {{ date }}\n---\n","updated":"2017-10-31T10:46:44.450Z","path":"scaffolds/page.html","comments":1,"layout":"page","_id":"cjbrwpvfm000iiwd32lu7qa1q","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"[object Object]","date":"2017-10-31T10:46:44.452Z","tags":null,"_content":"","source":"scaffolds/post.md","raw":"---\ntitle: {{ title }}\ndate: {{ date }}\ntags:\n---\n","updated":"2017-10-31T10:46:44.452Z","path":"scaffolds/post.html","comments":1,"layout":"page","_id":"cjbrwpvg1000niwd3jdr69x21","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"7 formas de incluir Bootstrap en nuestro proyecto","id":"6","updated":"2015-11-12T15:55:15.000Z","date":"2015-11-12T14:40:12.000Z","_content":"\n### 1- Descargando los archivos\n\nHaz clic en el botn **\"Download Bootstrap\"** y se descargar una carpeta comprimida, al descomprimirla te encontrars las versiones compiladas y minificadas de Bootstrap as como los iconos que utiliza:\n\n```\nbootstrap/\n css/\n    bootstrap.css\n    bootstrap.css.map\n    bootstrap.min.css\n    bootstrap.min.css.map\n    bootstrap-theme.css\n    bootstrap-theme.css.map\n    bootstrap-theme.min.css\n    bootstrap-theme.min.css.map\n js/\n    bootstrap.js\n    bootstrap.min.js\n fonts/\n     glyphicons-halflings-regular.eot\n     glyphicons-halflings-regular.svg\n     glyphicons-halflings-regular.ttf\n     glyphicons-halflings-regular.woff\n     glyphicons-halflings-regular.woff2\n\n```\n\n\n\n### 2- Para usuarios de GitHub\n\nBootstrap es un proyecto en cdigo abierto as que puedes **clonar** o hacer **fork** desde [GitHub](https://github.com/twbs/bootstrap)\n\n### 3- Cdigo fuente original\n\nLo obtienes al hacer clic en el botn **\"Download source\"**. Lo que obtienes son los archivos **LESS** y **Javascript** originales. Esta opcin requiere **Grunt** y **Node.js** y se estructura dentro de la siguiente manera:\n\n```\nbootstrap/\n less/\n js/\n fonts/\n dist/\n    css/\n    js/\n    fonts/\n docs/\n     examples/\n```\n### 4- Fans de Bower\n\nSi tenemos **Git** y **Bower** instalado simplemente debes teclear en tu terminal:\n\n```\n$ bower install bootstrap\n```\n\nY el pajarito har todo el trabajo.\n\n### 5- NPM Install\n\nTan fcil como con Bower solo que esta vez debes teclear en tu terminal:\n\n```\n$ npm install bootstrap\n```\n\n### 6- Versin en SASS\n\nA pesar de que **Bootstrap 3 fue escrito en LESS** (aspecto que cambiar en la versin 4, que ser en SASS), existe una versin para SASS que puedes descargar en el botn **\"Download SASS\"** para facilitar su inclusin en proyectos en **Rails**, **Compass** o solo **SASS**.\n\n### 7- CDN\n\nPor ltimo, si no quieres descargarte nada puedes utilizar los links del proveedor de **CDN** y referenciarlos en tu HTML:\n\n```html\n<!-- CSS -->\n<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\" integrity=\"sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==\" crossorigin=\"anonymous\">\n\n<!-- Tema opcional -->\n<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css\" integrity=\"sha384-aUGj/X2zp5rLCbBxumKTCw2Z50WgIr1vs/PFN4praOTvYXWlVyh2UtNUU0KAUhAX\" crossorigin=\"anonymous\">\n\n<!-- JavaScript -->\n<script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\" integrity=\"sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==\" crossorigin=\"anonymous\"></script>\n```\n\nEsta es la manera ms fcil pero no podrs trabajar sin conexin a internet.\n\n\n\n\n","source":"_posts/7-formas-de-incluir-Bootstrap-en-nuestro-proyecto.md","raw":"---\ntitle: 7 formas de incluir Bootstrap en nuestro proyecto\ntags:  \n- Bootstrap\ncategories:\n- Introduccin \npermalink: formas\nid: 6\nupdated: 2015/11/12 16:55:15\ndate: 2015/11/12 15:40:12\n---\n\n### 1- Descargando los archivos\n\nHaz clic en el botn **\"Download Bootstrap\"** y se descargar una carpeta comprimida, al descomprimirla te encontrars las versiones compiladas y minificadas de Bootstrap as como los iconos que utiliza:\n\n```\nbootstrap/\n css/\n    bootstrap.css\n    bootstrap.css.map\n    bootstrap.min.css\n    bootstrap.min.css.map\n    bootstrap-theme.css\n    bootstrap-theme.css.map\n    bootstrap-theme.min.css\n    bootstrap-theme.min.css.map\n js/\n    bootstrap.js\n    bootstrap.min.js\n fonts/\n     glyphicons-halflings-regular.eot\n     glyphicons-halflings-regular.svg\n     glyphicons-halflings-regular.ttf\n     glyphicons-halflings-regular.woff\n     glyphicons-halflings-regular.woff2\n\n```\n\n\n\n### 2- Para usuarios de GitHub\n\nBootstrap es un proyecto en cdigo abierto as que puedes **clonar** o hacer **fork** desde [GitHub](https://github.com/twbs/bootstrap)\n\n### 3- Cdigo fuente original\n\nLo obtienes al hacer clic en el botn **\"Download source\"**. Lo que obtienes son los archivos **LESS** y **Javascript** originales. Esta opcin requiere **Grunt** y **Node.js** y se estructura dentro de la siguiente manera:\n\n```\nbootstrap/\n less/\n js/\n fonts/\n dist/\n    css/\n    js/\n    fonts/\n docs/\n     examples/\n```\n### 4- Fans de Bower\n\nSi tenemos **Git** y **Bower** instalado simplemente debes teclear en tu terminal:\n\n```\n$ bower install bootstrap\n```\n\nY el pajarito har todo el trabajo.\n\n### 5- NPM Install\n\nTan fcil como con Bower solo que esta vez debes teclear en tu terminal:\n\n```\n$ npm install bootstrap\n```\n\n### 6- Versin en SASS\n\nA pesar de que **Bootstrap 3 fue escrito en LESS** (aspecto que cambiar en la versin 4, que ser en SASS), existe una versin para SASS que puedes descargar en el botn **\"Download SASS\"** para facilitar su inclusin en proyectos en **Rails**, **Compass** o solo **SASS**.\n\n### 7- CDN\n\nPor ltimo, si no quieres descargarte nada puedes utilizar los links del proveedor de **CDN** y referenciarlos en tu HTML:\n\n```html\n<!-- CSS -->\n<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\" integrity=\"sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==\" crossorigin=\"anonymous\">\n\n<!-- Tema opcional -->\n<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css\" integrity=\"sha384-aUGj/X2zp5rLCbBxumKTCw2Z50WgIr1vs/PFN4praOTvYXWlVyh2UtNUU0KAUhAX\" crossorigin=\"anonymous\">\n\n<!-- JavaScript -->\n<script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\" integrity=\"sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==\" crossorigin=\"anonymous\"></script>\n```\n\nEsta es la manera ms fcil pero no podrs trabajar sin conexin a internet.\n\n\n\n\n","slug":"formas","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvdb0002iwd3s3hm2ey2","content":"<h3 id=\"1-Descargando-los-archivos\"><a href=\"#1-Descargando-los-archivos\" class=\"headerlink\" title=\"1- Descargando los archivos\"></a>1- Descargando los archivos</h3><p>Haz clic en el botn <strong>Download Bootstrap</strong> y se descargar una carpeta comprimida, al descomprimirla te encontrars las versiones compiladas y minificadas de Bootstrap as como los iconos que utiliza:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">bootstrap/</div><div class=\"line\"> css/</div><div class=\"line\">    bootstrap.css</div><div class=\"line\">    bootstrap.css.map</div><div class=\"line\">    bootstrap.min.css</div><div class=\"line\">    bootstrap.min.css.map</div><div class=\"line\">    bootstrap-theme.css</div><div class=\"line\">    bootstrap-theme.css.map</div><div class=\"line\">    bootstrap-theme.min.css</div><div class=\"line\">    bootstrap-theme.min.css.map</div><div class=\"line\"> js/</div><div class=\"line\">    bootstrap.js</div><div class=\"line\">    bootstrap.min.js</div><div class=\"line\"> fonts/</div><div class=\"line\">     glyphicons-halflings-regular.eot</div><div class=\"line\">     glyphicons-halflings-regular.svg</div><div class=\"line\">     glyphicons-halflings-regular.ttf</div><div class=\"line\">     glyphicons-halflings-regular.woff</div><div class=\"line\">     glyphicons-halflings-regular.woff2</div></pre></td></tr></table></figure><h3 id=\"2-Para-usuarios-de-GitHub\"><a href=\"#2-Para-usuarios-de-GitHub\" class=\"headerlink\" title=\"2- Para usuarios de GitHub\"></a>2- Para usuarios de GitHub</h3><p>Bootstrap es un proyecto en cdigo abierto as que puedes <strong>clonar</strong> o hacer <strong>fork</strong> desde <a href=\"https://github.com/twbs/bootstrap\" target=\"_blank\" rel=\"external\">GitHub</a></p><h3 id=\"3-Codigo-fuente-original\"><a href=\"#3-Codigo-fuente-original\" class=\"headerlink\" title=\"3- Cdigo fuente original\"></a>3- Cdigo fuente original</h3><p>Lo obtienes al hacer clic en el botn <strong>Download source</strong>. Lo que obtienes son los archivos <strong>LESS</strong> y <strong>Javascript</strong> originales. Esta opcin requiere <strong>Grunt</strong> y <strong>Node.js</strong> y se estructura dentro de la siguiente manera:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">bootstrap/</div><div class=\"line\"> less/</div><div class=\"line\"> js/</div><div class=\"line\"> fonts/</div><div class=\"line\"> dist/</div><div class=\"line\">    css/</div><div class=\"line\">    js/</div><div class=\"line\">    fonts/</div><div class=\"line\"> docs/</div><div class=\"line\">     examples/</div></pre></td></tr></table></figure><h3 id=\"4-Fans-de-Bower\"><a href=\"#4-Fans-de-Bower\" class=\"headerlink\" title=\"4- Fans de Bower\"></a>4- Fans de Bower</h3><p>Si tenemos <strong>Git</strong> y <strong>Bower</strong> instalado simplemente debes teclear en tu terminal:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ bower install bootstrap</div></pre></td></tr></table></figure><p>Y el pajarito har todo el trabajo.</p><h3 id=\"5-NPM-Install\"><a href=\"#5-NPM-Install\" class=\"headerlink\" title=\"5- NPM Install\"></a>5- NPM Install</h3><p>Tan fcil como con Bower solo que esta vez debes teclear en tu terminal:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ npm install bootstrap</div></pre></td></tr></table></figure><h3 id=\"6-Version-en-SASS\"><a href=\"#6-Version-en-SASS\" class=\"headerlink\" title=\"6- Versin en SASS\"></a>6- Versin en SASS</h3><p>A pesar de que <strong>Bootstrap 3 fue escrito en LESS</strong> (aspecto que cambiar en la versin 4, que ser en SASS), existe una versin para SASS que puedes descargar en el botn <strong>Download SASS</strong> para facilitar su inclusin en proyectos en <strong>Rails</strong>, <strong>Compass</strong> o solo <strong>SASS</strong>.</p><h3 id=\"7-CDN\"><a href=\"#7-CDN\" class=\"headerlink\" title=\"7- CDN\"></a>7- CDN</h3><p>Por ltimo, si no quieres descargarte nada puedes utilizar los links del proveedor de <strong>CDN</strong> y referenciarlos en tu HTML:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- CSS --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\"</span> <span class=\"attr\">integrity</span>=<span class=\"string\">\"sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==\"</span> <span class=\"attr\">crossorigin</span>=<span class=\"string\">\"anonymous\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- Tema opcional --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css\"</span> <span class=\"attr\">integrity</span>=<span class=\"string\">\"sha384-aUGj/X2zp5rLCbBxumKTCw2Z50WgIr1vs/PFN4praOTvYXWlVyh2UtNUU0KAUhAX\"</span> <span class=\"attr\">crossorigin</span>=<span class=\"string\">\"anonymous\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- JavaScript --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\"</span> <span class=\"attr\">integrity</span>=<span class=\"string\">\"sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==\"</span> <span class=\"attr\">crossorigin</span>=<span class=\"string\">\"anonymous\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div></pre></td></tr></table></figure><p>Esta es la manera ms fcil pero no podrs trabajar sin conexin a internet.</p>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"1-Descargando-los-archivos\"><a href=\"#1-Descargando-los-archivos\" class=\"headerlink\" title=\"1- Descargando los archivos\"></a>1- Descargando los archivos</h3><p>Haz clic en el botn <strong>Download Bootstrap</strong> y se descargar una carpeta comprimida, al descomprimirla te encontrars las versiones compiladas y minificadas de Bootstrap as como los iconos que utiliza:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">bootstrap/</div><div class=\"line\"> css/</div><div class=\"line\">    bootstrap.css</div><div class=\"line\">    bootstrap.css.map</div><div class=\"line\">    bootstrap.min.css</div><div class=\"line\">    bootstrap.min.css.map</div><div class=\"line\">    bootstrap-theme.css</div><div class=\"line\">    bootstrap-theme.css.map</div><div class=\"line\">    bootstrap-theme.min.css</div><div class=\"line\">    bootstrap-theme.min.css.map</div><div class=\"line\"> js/</div><div class=\"line\">    bootstrap.js</div><div class=\"line\">    bootstrap.min.js</div><div class=\"line\"> fonts/</div><div class=\"line\">     glyphicons-halflings-regular.eot</div><div class=\"line\">     glyphicons-halflings-regular.svg</div><div class=\"line\">     glyphicons-halflings-regular.ttf</div><div class=\"line\">     glyphicons-halflings-regular.woff</div><div class=\"line\">     glyphicons-halflings-regular.woff2</div></pre></td></tr></table></figure><h3 id=\"2-Para-usuarios-de-GitHub\"><a href=\"#2-Para-usuarios-de-GitHub\" class=\"headerlink\" title=\"2- Para usuarios de GitHub\"></a>2- Para usuarios de GitHub</h3><p>Bootstrap es un proyecto en cdigo abierto as que puedes <strong>clonar</strong> o hacer <strong>fork</strong> desde <a href=\"https://github.com/twbs/bootstrap\" target=\"_blank\" rel=\"external\">GitHub</a></p><h3 id=\"3-Codigo-fuente-original\"><a href=\"#3-Codigo-fuente-original\" class=\"headerlink\" title=\"3- Cdigo fuente original\"></a>3- Cdigo fuente original</h3><p>Lo obtienes al hacer clic en el botn <strong>Download source</strong>. Lo que obtienes son los archivos <strong>LESS</strong> y <strong>Javascript</strong> originales. Esta opcin requiere <strong>Grunt</strong> y <strong>Node.js</strong> y se estructura dentro de la siguiente manera:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">bootstrap/</div><div class=\"line\"> less/</div><div class=\"line\"> js/</div><div class=\"line\"> fonts/</div><div class=\"line\"> dist/</div><div class=\"line\">    css/</div><div class=\"line\">    js/</div><div class=\"line\">    fonts/</div><div class=\"line\"> docs/</div><div class=\"line\">     examples/</div></pre></td></tr></table></figure><h3 id=\"4-Fans-de-Bower\"><a href=\"#4-Fans-de-Bower\" class=\"headerlink\" title=\"4- Fans de Bower\"></a>4- Fans de Bower</h3><p>Si tenemos <strong>Git</strong> y <strong>Bower</strong> instalado simplemente debes teclear en tu terminal:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ bower install bootstrap</div></pre></td></tr></table></figure><p>Y el pajarito har todo el trabajo.</p><h3 id=\"5-NPM-Install\"><a href=\"#5-NPM-Install\" class=\"headerlink\" title=\"5- NPM Install\"></a>5- NPM Install</h3><p>Tan fcil como con Bower solo que esta vez debes teclear en tu terminal:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ npm install bootstrap</div></pre></td></tr></table></figure><h3 id=\"6-Version-en-SASS\"><a href=\"#6-Version-en-SASS\" class=\"headerlink\" title=\"6- Versin en SASS\"></a>6- Versin en SASS</h3><p>A pesar de que <strong>Bootstrap 3 fue escrito en LESS</strong> (aspecto que cambiar en la versin 4, que ser en SASS), existe una versin para SASS que puedes descargar en el botn <strong>Download SASS</strong> para facilitar su inclusin en proyectos en <strong>Rails</strong>, <strong>Compass</strong> o solo <strong>SASS</strong>.</p><h3 id=\"7-CDN\"><a href=\"#7-CDN\" class=\"headerlink\" title=\"7- CDN\"></a>7- CDN</h3><p>Por ltimo, si no quieres descargarte nada puedes utilizar los links del proveedor de <strong>CDN</strong> y referenciarlos en tu HTML:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- CSS --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\"</span> <span class=\"attr\">integrity</span>=<span class=\"string\">\"sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==\"</span> <span class=\"attr\">crossorigin</span>=<span class=\"string\">\"anonymous\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- Tema opcional --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css\"</span> <span class=\"attr\">integrity</span>=<span class=\"string\">\"sha384-aUGj/X2zp5rLCbBxumKTCw2Z50WgIr1vs/PFN4praOTvYXWlVyh2UtNUU0KAUhAX\"</span> <span class=\"attr\">crossorigin</span>=<span class=\"string\">\"anonymous\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- JavaScript --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\"</span> <span class=\"attr\">integrity</span>=<span class=\"string\">\"sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==\"</span> <span class=\"attr\">crossorigin</span>=<span class=\"string\">\"anonymous\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div></pre></td></tr></table></figure><p>Esta es la manera ms fcil pero no podrs trabajar sin conexin a internet.</p>"},{"title":"Cdigo de ejemplo curso de Angular2","id":"22","updated":"2016-10-10T06:10:33.000Z","date":"2016-09-21T06:37:13.000Z","thumbnail":"/css/images/angular.jpg","_content":"\nEnlace a los repositorios con el cdigo de ejemplo para los cursos de **Angular2** :\n\n<!-- more -->\n\n### 2.0 cli\n[AcademiaBinaria/angular2](https://github.com/AcademiaBinaria/angular2)\n\nEste proyecto es un *work in progress*.\n\nEst basado en el generador [Angular-CLI](https://github.com/angular/angular-cli), el ms adecuado para aplicaciones reales \n\n### RC6 Seed\n[AcademiaBinaria/angular2-RC6](https://github.com/AcademiaBinaria/angular2-RC6)\n\nAunque es para la `RC6` el cdigo es perfectamente *compatible con la versin estable*.\n\nEst basado en el proyecto [Angular2-Seed](https://github.com/angular/angular2-seed), que es ms sencillo que el CLI para empezar. ","source":"_posts/Codigo-de-ejemplo-curso-de-Angular2.md","raw":"---\ntitle: Cdigo de ejemplo curso de Angular2\ntags:  \n- Angular2\ncategories:\n- Introduccin \npermalink: codigo-de-ejemplo-curso-de-angular2\nid: 22\nupdated: '2016-10-10 08:10:33'\ndate: 2016-09-21 08:37:13\nthumbnail: /css/images/angular.jpg\n---\n\nEnlace a los repositorios con el cdigo de ejemplo para los cursos de **Angular2** :\n\n<!-- more -->\n\n### 2.0 cli\n[AcademiaBinaria/angular2](https://github.com/AcademiaBinaria/angular2)\n\nEste proyecto es un *work in progress*.\n\nEst basado en el generador [Angular-CLI](https://github.com/angular/angular-cli), el ms adecuado para aplicaciones reales \n\n### RC6 Seed\n[AcademiaBinaria/angular2-RC6](https://github.com/AcademiaBinaria/angular2-RC6)\n\nAunque es para la `RC6` el cdigo es perfectamente *compatible con la versin estable*.\n\nEst basado en el proyecto [Angular2-Seed](https://github.com/angular/angular2-seed), que es ms sencillo que el CLI para empezar. ","slug":"codigo-de-ejemplo-curso-de-angular2","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvee0004iwd33m6qo4qf","content":"<p>Enlace a los repositorios con el cdigo de ejemplo para los cursos de <strong>Angular2</strong> :</p><a id=\"more\"></a><h3 id=\"2-0-cli\"><a href=\"#2-0-cli\" class=\"headerlink\" title=\"2.0 cli\"></a>2.0 cli</h3><p><a href=\"https://github.com/AcademiaBinaria/angular2\" target=\"_blank\" rel=\"external\">AcademiaBinaria/angular2</a></p><p>Este proyecto es un <em>work in progress</em>.</p><p>Est basado en el generador <a href=\"https://github.com/angular/angular-cli\" target=\"_blank\" rel=\"external\">Angular-CLI</a>, el ms adecuado para aplicaciones reales</p><h3 id=\"RC6-Seed\"><a href=\"#RC6-Seed\" class=\"headerlink\" title=\"RC6 Seed\"></a>RC6 Seed</h3><p><a href=\"https://github.com/AcademiaBinaria/angular2-RC6\" target=\"_blank\" rel=\"external\">AcademiaBinaria/angular2-RC6</a></p><p>Aunque es para la <code>RC6</code> el cdigo es perfectamente <em>compatible con la versin estable</em>.</p><p>Est basado en el proyecto <a href=\"https://github.com/angular/angular2-seed\" target=\"_blank\" rel=\"external\">Angular2-Seed</a>, que es ms sencillo que el CLI para empezar.</p>","site":{"data":{}},"excerpt":"<p>Enlace a los repositorios con el cdigo de ejemplo para los cursos de <strong>Angular2</strong> :</p>","more":"<h3 id=\"2-0-cli\"><a href=\"#2-0-cli\" class=\"headerlink\" title=\"2.0 cli\"></a>2.0 cli</h3><p><a href=\"https://github.com/AcademiaBinaria/angular2\" target=\"_blank\" rel=\"external\">AcademiaBinaria/angular2</a></p><p>Este proyecto es un <em>work in progress</em>.</p><p>Est basado en el generador <a href=\"https://github.com/angular/angular-cli\" target=\"_blank\" rel=\"external\">Angular-CLI</a>, el ms adecuado para aplicaciones reales</p><h3 id=\"RC6-Seed\"><a href=\"#RC6-Seed\" class=\"headerlink\" title=\"RC6 Seed\"></a>RC6 Seed</h3><p><a href=\"https://github.com/AcademiaBinaria/angular2-RC6\" target=\"_blank\" rel=\"external\">AcademiaBinaria/angular2-RC6</a></p><p>Aunque es para la <code>RC6</code> el cdigo es perfectamente <em>compatible con la versin estable</em>.</p><p>Est basado en el proyecto <a href=\"https://github.com/angular/angular2-seed\" target=\"_blank\" rel=\"external\">Angular2-Seed</a>, que es ms sencillo que el CLI para empezar.</p>"},{"title":"Angular2 DI: Inyeccin de dependencias","id":"14","updated":"2016-11-10T13:52:13.000Z","date":"2016-05-30T09:09:09.000Z","_content":"\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/)\n\n---\n\n>Cdigo asociado en [angular2/4-injection/](https://github.com/AcademiaBinaria/angular2/tree/master/4-injection)\n\nAngularJS2 tiene vocacin de *framework* para grandes aplicaciones de negocio. Los grandes desarrollos requieren **modularidad en el cdigo**. En AngularJS se resuelve mediante la Inyeccin de Dependencias, siguiendo el conocido patrn *[Dependency Injection](https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias)*. \n\nLos cambios en la versin 2 son sobre todo sintcticos, pero tambin conceptuales. Se mantiene el mismo objetivo, permitir hacer **aplicaciones de negocio con HTML y JavaScript** de manera controlable.\n\n<!-- more -->\n\n## Mdulos, componentes y servicios\nEn AngularJS 1 tenamos muy presente el concepto de **mdulo**. Rara era la aplicacin que no comenzase con el mtico `angular.module('miAplicacion')`. Dada la carencia de un sistema modular nativo en *JavaScript*, AngularJS nos provea de uno propio. \n\nHoy en da se nos sugiere que usemos las versiones avanzadas de *JS*, o mejor an *TypeScript*. Estos lenguajes nos ofrecen las instrucciones `export` e `import` que permiten definir **mdulos estancos en ficheros** independientes. Nunca ms el engorroso envolvimiento *IIFE* `(function () {  }())`.\n\nA partir de ah es el programador el que selectivamente **exporta funcionalidad que importar para ser consumida** mas tarde. De este modo, Angular se desentiende de la creacin de mdulos de cdigo y se centra en la comunicacin entre los objetos que componen la aplicacin.\n\n\n### Componentes\nSon los bloques de construccin agrupables en compuestos que forman la interfaz visual de una aplicacin. Encapsulan **la vista, los datos y la lgica** para interactuar con el usuario. \n\nNi la vista ni la lgica deben crecer y realizar tareas que no sean de su exclusiva capa de responsabilidad. Esas tareas debe ser delegadas en otros objetos. \n\n> Modelo de composicin de componentes visuales para crear vistas complejas. La comunicacin o [Data Flow](../databinding-el-flujo-de-datos-de-angular2/) se realiza de manera declarativa. Enviando datos a las propiedades de los hijos y esperando eventos con respuestas.\n\n![Composicin mediante componentes](/images/ng2-Component-DataFlow.jpg)\n\n### Servicios\nLos servicios sern **objetos especializados y reutilizables** por otros servicios y componentes. En su definicin debes aplicar los mismos principios de arquitectura de software que ya conoces y aplicas en *lenguajes clsicos tipo Java o C#.net*.\n\nLa sintaxis de la comunicacin involucra varios bloques en ambos lados del canal: \n\n- la definicin del servicio decorado como `@Injectable()` en el proveedor, \n- la exportacin en el proveedor y la importacin en el consumidor, \n- el registro en el array `providers:[]` del componente consumidor (o mejor del mdulo) conumidor y \n- el consumo en el constructor del componente o servicio consumidor.\n\n```javascript\nimport { Component, OnInit } from '@angular/core';\nimport { MovimientosService, Movimiento } from '../shared/';\n@Component({\n  selector: 'movimiento',\n  templateUrl: 'movimiento.component.html',\n  providers: [MovimientosService] \n})\nexport class MovimientoComponent {\n  movimiento: Movimiento\n  constructor(public movimientosService: MovimientosService) { }\n  guardarMovimiento() {\n    this.movimientosService.guardarMovimiento(this.movimiento)\n  }\n}\n```\n\n![Inyeccin de servicios en componentes ](/images/ng2-DI-component-service.jpg)\n\n### Directivas\nLas directivas eran el ADN de AngularJS1. Ahora han mutado en **componentes reutilizables** como elementos en las vistas de otros componentes de rango superior. Pero la idea es la misma, desglosar las plantillas de HTML en bloques con un propsito nico. \n\nLa sintaxis de las directivas es similar: \n\n- la definicin del servicio decorado como `@Injectable()` en el componente hijo, \n- la exportacin del hijo y la importacin en el padre, \n- el registro en el array `directives:[]` del componente padre (o del mdulo padre) y \n- el consumo declarativo en la plantilla de la vista padre.\n\n```javascript\nimport { Component } from '@angular/core';\nimport { MovimientoComponent } from './movimiento';\n@Component({\n  selector: 'injection-app',\n  template: '<h1>\n              {{titulo}}\n            </h1>\n            <movimiento></movimiento>',\n  directives:[MovimientoComponent]\n})\nexport class InjectionAppComponent {\n  titulo = 'Inyectores listos!';\n}\n```\n![Inyeccin de directivas en componentes](/images/ng2-DI-component-directive.jpg)\n\n## Registro\n\nLa inyeccin de las dependencias **funciona de manera jerrquica** en AngularJS 2. Cuando un mdulo registra una dependencia la pone a disposicin de todos sus componentes hijos. Es ms, si algn hijo la volviese a registrar se le proveera de otra instancia. \n\nEsta copia puede provocar efectos colaterales indeseados. Para **compartir datos** o ahorrar memoria se recomienda registrar las dependencias lo ms arriba posible. Esto siempre sin sacrificar la modularidad o la escalabilidad de aplicaciones que requieran *lazy loading*.\n\n> Atencin a la copia de *routeService* que se registra por segunda vez. No importa que ya la haya registrado su padre. Otro registro implica otra instancia.\n\n![Jerarqua de dependencias en AngularJS](/images/ng2-Arbol-de-dependencias.jpg)\n\nPara ciertos casos, AngularJS 2 permite modelos de inyeccin ms avanzados. Mediante el uso de **factoras y el registro de cadenas** con los nombres de los servicios facilita la inyeccin a voluntad o la carga diferida.\n\n>Algunas de estas posibilidades estn siendo retocadas durante la actual *Release Candidate*, y se esperan cambios de cara a las prxima versin estable.\n\nEl viejo principio de *divide y vencers* se aplica rotundamente en las aplicaciones Angular 2. Si creas **mdulos reutilizables** estars sentando las bases para crear grandes aplicaciones de negocio con AngularJS.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/)","source":"_posts/Angular2-DI-Inyeccion-de-dependencias.md","raw":"---\ntitle: 'Angular2 DI: Inyeccin de dependencias'\ntags:  \n- Angular2\n- DI\n- Tutorial\ncategories:\n- Introduccin \npermalink: angular2-di-inyeccion-de-dependencias\nid: 14\nupdated: 2016/11/10 14:52:13\ndate: 2016/05/30 11:09:09\n---\n\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/)\n\n---\n\n>Cdigo asociado en [angular2/4-injection/](https://github.com/AcademiaBinaria/angular2/tree/master/4-injection)\n\nAngularJS2 tiene vocacin de *framework* para grandes aplicaciones de negocio. Los grandes desarrollos requieren **modularidad en el cdigo**. En AngularJS se resuelve mediante la Inyeccin de Dependencias, siguiendo el conocido patrn *[Dependency Injection](https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias)*. \n\nLos cambios en la versin 2 son sobre todo sintcticos, pero tambin conceptuales. Se mantiene el mismo objetivo, permitir hacer **aplicaciones de negocio con HTML y JavaScript** de manera controlable.\n\n<!-- more -->\n\n## Mdulos, componentes y servicios\nEn AngularJS 1 tenamos muy presente el concepto de **mdulo**. Rara era la aplicacin que no comenzase con el mtico `angular.module('miAplicacion')`. Dada la carencia de un sistema modular nativo en *JavaScript*, AngularJS nos provea de uno propio. \n\nHoy en da se nos sugiere que usemos las versiones avanzadas de *JS*, o mejor an *TypeScript*. Estos lenguajes nos ofrecen las instrucciones `export` e `import` que permiten definir **mdulos estancos en ficheros** independientes. Nunca ms el engorroso envolvimiento *IIFE* `(function () {  }())`.\n\nA partir de ah es el programador el que selectivamente **exporta funcionalidad que importar para ser consumida** mas tarde. De este modo, Angular se desentiende de la creacin de mdulos de cdigo y se centra en la comunicacin entre los objetos que componen la aplicacin.\n\n\n### Componentes\nSon los bloques de construccin agrupables en compuestos que forman la interfaz visual de una aplicacin. Encapsulan **la vista, los datos y la lgica** para interactuar con el usuario. \n\nNi la vista ni la lgica deben crecer y realizar tareas que no sean de su exclusiva capa de responsabilidad. Esas tareas debe ser delegadas en otros objetos. \n\n> Modelo de composicin de componentes visuales para crear vistas complejas. La comunicacin o [Data Flow](../databinding-el-flujo-de-datos-de-angular2/) se realiza de manera declarativa. Enviando datos a las propiedades de los hijos y esperando eventos con respuestas.\n\n![Composicin mediante componentes](/images/ng2-Component-DataFlow.jpg)\n\n### Servicios\nLos servicios sern **objetos especializados y reutilizables** por otros servicios y componentes. En su definicin debes aplicar los mismos principios de arquitectura de software que ya conoces y aplicas en *lenguajes clsicos tipo Java o C#.net*.\n\nLa sintaxis de la comunicacin involucra varios bloques en ambos lados del canal: \n\n- la definicin del servicio decorado como `@Injectable()` en el proveedor, \n- la exportacin en el proveedor y la importacin en el consumidor, \n- el registro en el array `providers:[]` del componente consumidor (o mejor del mdulo) conumidor y \n- el consumo en el constructor del componente o servicio consumidor.\n\n```javascript\nimport { Component, OnInit } from '@angular/core';\nimport { MovimientosService, Movimiento } from '../shared/';\n@Component({\n  selector: 'movimiento',\n  templateUrl: 'movimiento.component.html',\n  providers: [MovimientosService] \n})\nexport class MovimientoComponent {\n  movimiento: Movimiento\n  constructor(public movimientosService: MovimientosService) { }\n  guardarMovimiento() {\n    this.movimientosService.guardarMovimiento(this.movimiento)\n  }\n}\n```\n\n![Inyeccin de servicios en componentes ](/images/ng2-DI-component-service.jpg)\n\n### Directivas\nLas directivas eran el ADN de AngularJS1. Ahora han mutado en **componentes reutilizables** como elementos en las vistas de otros componentes de rango superior. Pero la idea es la misma, desglosar las plantillas de HTML en bloques con un propsito nico. \n\nLa sintaxis de las directivas es similar: \n\n- la definicin del servicio decorado como `@Injectable()` en el componente hijo, \n- la exportacin del hijo y la importacin en el padre, \n- el registro en el array `directives:[]` del componente padre (o del mdulo padre) y \n- el consumo declarativo en la plantilla de la vista padre.\n\n```javascript\nimport { Component } from '@angular/core';\nimport { MovimientoComponent } from './movimiento';\n@Component({\n  selector: 'injection-app',\n  template: '<h1>\n              {{titulo}}\n            </h1>\n            <movimiento></movimiento>',\n  directives:[MovimientoComponent]\n})\nexport class InjectionAppComponent {\n  titulo = 'Inyectores listos!';\n}\n```\n![Inyeccin de directivas en componentes](/images/ng2-DI-component-directive.jpg)\n\n## Registro\n\nLa inyeccin de las dependencias **funciona de manera jerrquica** en AngularJS 2. Cuando un mdulo registra una dependencia la pone a disposicin de todos sus componentes hijos. Es ms, si algn hijo la volviese a registrar se le proveera de otra instancia. \n\nEsta copia puede provocar efectos colaterales indeseados. Para **compartir datos** o ahorrar memoria se recomienda registrar las dependencias lo ms arriba posible. Esto siempre sin sacrificar la modularidad o la escalabilidad de aplicaciones que requieran *lazy loading*.\n\n> Atencin a la copia de *routeService* que se registra por segunda vez. No importa que ya la haya registrado su padre. Otro registro implica otra instancia.\n\n![Jerarqua de dependencias en AngularJS](/images/ng2-Arbol-de-dependencias.jpg)\n\nPara ciertos casos, AngularJS 2 permite modelos de inyeccin ms avanzados. Mediante el uso de **factoras y el registro de cadenas** con los nombres de los servicios facilita la inyeccin a voluntad o la carga diferida.\n\n>Algunas de estas posibilidades estn siendo retocadas durante la actual *Release Candidate*, y se esperan cambios de cara a las prxima versin estable.\n\nEl viejo principio de *divide y vencers* se aplica rotundamente en las aplicaciones Angular 2. Si creas **mdulos reutilizables** estars sentando las bases para crear grandes aplicaciones de negocio con AngularJS.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/)","slug":"angular2-di-inyeccion-de-dependencias","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpveq0008iwd321bv9dux","content":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a></p></blockquote><hr><blockquote><p>Cdigo asociado en <a href=\"https://github.com/AcademiaBinaria/angular2/tree/master/4-injection\" target=\"_blank\" rel=\"external\">angular2/4-injection/</a></p></blockquote><p>AngularJS2 tiene vocacin de <em>framework</em> para grandes aplicaciones de negocio. Los grandes desarrollos requieren <strong>modularidad en el cdigo</strong>. En AngularJS se resuelve mediante la Inyeccin de Dependencias, siguiendo el conocido patrn <em><a href=\"https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias\" target=\"_blank\" rel=\"external\">Dependency Injection</a></em>.</p><p>Los cambios en la versin 2 son sobre todo sintcticos, pero tambin conceptuales. Se mantiene el mismo objetivo, permitir hacer <strong>aplicaciones de negocio con HTML y JavaScript</strong> de manera controlable.</p><a id=\"more\"></a><h2 id=\"Modulos-componentes-y-servicios\"><a href=\"#Modulos-componentes-y-servicios\" class=\"headerlink\" title=\"Mdulos, componentes y servicios\"></a>Mdulos, componentes y servicios</h2><p>En AngularJS 1 tenamos muy presente el concepto de <strong>mdulo</strong>. Rara era la aplicacin que no comenzase con el mtico <code>angular.module(&#39;miAplicacion&#39;)</code>. Dada la carencia de un sistema modular nativo en <em>JavaScript</em>, AngularJS nos provea de uno propio.</p><p>Hoy en da se nos sugiere que usemos las versiones avanzadas de <em>JS</em>, o mejor an <em>TypeScript</em>. Estos lenguajes nos ofrecen las instrucciones <code>export</code> e <code>import</code> que permiten definir <strong>mdulos estancos en ficheros</strong> independientes. Nunca ms el engorroso envolvimiento <em>IIFE</em> <code>(function () {  }())</code>.</p><p>A partir de ah es el programador el que selectivamente <strong>exporta funcionalidad que importar para ser consumida</strong> mas tarde. De este modo, Angular se desentiende de la creacin de mdulos de cdigo y se centra en la comunicacin entre los objetos que componen la aplicacin.</p><h3 id=\"Componentes\"><a href=\"#Componentes\" class=\"headerlink\" title=\"Componentes\"></a>Componentes</h3><p>Son los bloques de construccin agrupables en compuestos que forman la interfaz visual de una aplicacin. Encapsulan <strong>la vista, los datos y la lgica</strong> para interactuar con el usuario.</p><p>Ni la vista ni la lgica deben crecer y realizar tareas que no sean de su exclusiva capa de responsabilidad. Esas tareas debe ser delegadas en otros objetos.</p><blockquote><p>Modelo de composicin de componentes visuales para crear vistas complejas. La comunicacin o <a href=\"../databinding-el-flujo-de-datos-de-angular2/\">Data Flow</a> se realiza de manera declarativa. Enviando datos a las propiedades de los hijos y esperando eventos con respuestas.</p></blockquote><p><img src=\"/images/ng2-Component-DataFlow.jpg\" alt=\"Composicin mediante componentes\"></p><h3 id=\"Servicios\"><a href=\"#Servicios\" class=\"headerlink\" title=\"Servicios\"></a>Servicios</h3><p>Los servicios sern <strong>objetos especializados y reutilizables</strong> por otros servicios y componentes. En su definicin debes aplicar los mismos principios de arquitectura de software que ya conoces y aplicas en <em>lenguajes clsicos tipo Java o C#.net</em>.</p><p>La sintaxis de la comunicacin involucra varios bloques en ambos lados del canal:</p><ul><li>la definicin del servicio decorado como <code>@Injectable()</code> en el proveedor,</li><li>la exportacin en el proveedor y la importacin en el consumidor,</li><li>el registro en el array <code>providers:[]</code> del componente consumidor (o mejor del mdulo) conumidor y</li><li>el consumo en el constructor del componente o servicio consumidor.</li></ul><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientosService, Movimiento &#125; <span class=\"keyword\">from</span> <span class=\"string\">'../shared/'</span>;</div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  selector: <span class=\"string\">'movimiento'</span>,</div><div class=\"line\">  templateUrl: <span class=\"string\">'movimiento.component.html'</span>,</div><div class=\"line\">  providers: [MovimientosService] </div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MovimientoComponent</span> </span>&#123;</div><div class=\"line\">  movimiento: Movimiento</div><div class=\"line\">  <span class=\"keyword\">constructor</span>(public movimientosService: MovimientosService) &#123; &#125;</div><div class=\"line\">  guardarMovimiento() &#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.movimientosService.guardarMovimiento(<span class=\"keyword\">this</span>.movimiento)</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p><img src=\"/images/ng2-DI-component-service.jpg\" alt=\"Inyeccin de servicios en componentes \"></p><h3 id=\"Directivas\"><a href=\"#Directivas\" class=\"headerlink\" title=\"Directivas\"></a>Directivas</h3><p>Las directivas eran el ADN de AngularJS1. Ahora han mutado en <strong>componentes reutilizables</strong> como elementos en las vistas de otros componentes de rango superior. Pero la idea es la misma, desglosar las plantillas de HTML en bloques con un propsito nico.</p><p>La sintaxis de las directivas es similar:</p><ul><li>la definicin del servicio decorado como <code>@Injectable()</code> en el componente hijo,</li><li>la exportacin del hijo y la importacin en el padre,</li><li>el registro en el array <code>directives:[]</code> del componente padre (o del mdulo padre) y</li><li>el consumo declarativo en la plantilla de la vista padre.</li></ul><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientoComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./movimiento'</span>;</div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  selector: <span class=\"string\">'injection-app'</span>,</div><div class=\"line\">  template: <span class=\"string\">'&lt;h1&gt;</span></div><div class=\"line\"><span class=\"string\">              &#123;&#123;titulo&#125;&#125;</span></div><div class=\"line\"><span class=\"string\">            &lt;/h1&gt;</span></div><div class=\"line\"><span class=\"string\">            &lt;movimiento&gt;&lt;/movimiento&gt;'</span>,</div><div class=\"line\">  directives:[MovimientoComponent]</div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InjectionAppComponent</span> </span>&#123;</div><div class=\"line\">  titulo = <span class=\"string\">'Inyectores listos!'</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p><img src=\"/images/ng2-DI-component-directive.jpg\" alt=\"Inyeccin de directivas en componentes\"></p><h2 id=\"Registro\"><a href=\"#Registro\" class=\"headerlink\" title=\"Registro\"></a>Registro</h2><p>La inyeccin de las dependencias <strong>funciona de manera jerrquica</strong> en AngularJS 2. Cuando un mdulo registra una dependencia la pone a disposicin de todos sus componentes hijos. Es ms, si algn hijo la volviese a registrar se le proveera de otra instancia.</p><p>Esta copia puede provocar efectos colaterales indeseados. Para <strong>compartir datos</strong> o ahorrar memoria se recomienda registrar las dependencias lo ms arriba posible. Esto siempre sin sacrificar la modularidad o la escalabilidad de aplicaciones que requieran <em>lazy loading</em>.</p><blockquote><p>Atencin a la copia de <em>routeService</em> que se registra por segunda vez. No importa que ya la haya registrado su padre. Otro registro implica otra instancia.</p></blockquote><p><img src=\"/images/ng2-Arbol-de-dependencias.jpg\" alt=\"Jerarqua de dependencias en AngularJS\"></p><p>Para ciertos casos, AngularJS 2 permite modelos de inyeccin ms avanzados. Mediante el uso de <strong>factoras y el registro de cadenas</strong> con los nombres de los servicios facilita la inyeccin a voluntad o la carga diferida.</p><blockquote><p>Algunas de estas posibilidades estn siendo retocadas durante la actual <em>Release Candidate</em>, y se esperan cambios de cara a las prxima versin estable.</p></blockquote><p>El viejo principio de <em>divide y vencers</em> se aplica rotundamente en las aplicaciones Angular 2. Si creas <strong>mdulos reutilizables</strong> estars sentando las bases para crear grandes aplicaciones de negocio con AngularJS.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a></p>","site":{"data":{}},"excerpt":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a></p></blockquote><hr><blockquote><p>Cdigo asociado en <a href=\"https://github.com/AcademiaBinaria/angular2/tree/master/4-injection\" target=\"_blank\" rel=\"external\">angular2/4-injection/</a></p></blockquote><p>AngularJS2 tiene vocacin de <em>framework</em> para grandes aplicaciones de negocio. Los grandes desarrollos requieren <strong>modularidad en el cdigo</strong>. En AngularJS se resuelve mediante la Inyeccin de Dependencias, siguiendo el conocido patrn <em><a href=\"https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias\" target=\"_blank\" rel=\"external\">Dependency Injection</a></em>.</p><p>Los cambios en la versin 2 son sobre todo sintcticos, pero tambin conceptuales. Se mantiene el mismo objetivo, permitir hacer <strong>aplicaciones de negocio con HTML y JavaScript</strong> de manera controlable.</p>","more":"<h2 id=\"Modulos-componentes-y-servicios\"><a href=\"#Modulos-componentes-y-servicios\" class=\"headerlink\" title=\"Mdulos, componentes y servicios\"></a>Mdulos, componentes y servicios</h2><p>En AngularJS 1 tenamos muy presente el concepto de <strong>mdulo</strong>. Rara era la aplicacin que no comenzase con el mtico <code>angular.module(&#39;miAplicacion&#39;)</code>. Dada la carencia de un sistema modular nativo en <em>JavaScript</em>, AngularJS nos provea de uno propio.</p><p>Hoy en da se nos sugiere que usemos las versiones avanzadas de <em>JS</em>, o mejor an <em>TypeScript</em>. Estos lenguajes nos ofrecen las instrucciones <code>export</code> e <code>import</code> que permiten definir <strong>mdulos estancos en ficheros</strong> independientes. Nunca ms el engorroso envolvimiento <em>IIFE</em> <code>(function () {  }())</code>.</p><p>A partir de ah es el programador el que selectivamente <strong>exporta funcionalidad que importar para ser consumida</strong> mas tarde. De este modo, Angular se desentiende de la creacin de mdulos de cdigo y se centra en la comunicacin entre los objetos que componen la aplicacin.</p><h3 id=\"Componentes\"><a href=\"#Componentes\" class=\"headerlink\" title=\"Componentes\"></a>Componentes</h3><p>Son los bloques de construccin agrupables en compuestos que forman la interfaz visual de una aplicacin. Encapsulan <strong>la vista, los datos y la lgica</strong> para interactuar con el usuario.</p><p>Ni la vista ni la lgica deben crecer y realizar tareas que no sean de su exclusiva capa de responsabilidad. Esas tareas debe ser delegadas en otros objetos.</p><blockquote><p>Modelo de composicin de componentes visuales para crear vistas complejas. La comunicacin o <a href=\"../databinding-el-flujo-de-datos-de-angular2/\">Data Flow</a> se realiza de manera declarativa. Enviando datos a las propiedades de los hijos y esperando eventos con respuestas.</p></blockquote><p><img src=\"/images/ng2-Component-DataFlow.jpg\" alt=\"Composicin mediante componentes\"></p><h3 id=\"Servicios\"><a href=\"#Servicios\" class=\"headerlink\" title=\"Servicios\"></a>Servicios</h3><p>Los servicios sern <strong>objetos especializados y reutilizables</strong> por otros servicios y componentes. En su definicin debes aplicar los mismos principios de arquitectura de software que ya conoces y aplicas en <em>lenguajes clsicos tipo Java o C#.net</em>.</p><p>La sintaxis de la comunicacin involucra varios bloques en ambos lados del canal:</p><ul><li>la definicin del servicio decorado como <code>@Injectable()</code> en el proveedor,</li><li>la exportacin en el proveedor y la importacin en el consumidor,</li><li>el registro en el array <code>providers:[]</code> del componente consumidor (o mejor del mdulo) conumidor y</li><li>el consumo en el constructor del componente o servicio consumidor.</li></ul><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientosService, Movimiento &#125; <span class=\"keyword\">from</span> <span class=\"string\">'../shared/'</span>;</div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  selector: <span class=\"string\">'movimiento'</span>,</div><div class=\"line\">  templateUrl: <span class=\"string\">'movimiento.component.html'</span>,</div><div class=\"line\">  providers: [MovimientosService] </div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MovimientoComponent</span> </span>&#123;</div><div class=\"line\">  movimiento: Movimiento</div><div class=\"line\">  <span class=\"keyword\">constructor</span>(public movimientosService: MovimientosService) &#123; &#125;</div><div class=\"line\">  guardarMovimiento() &#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.movimientosService.guardarMovimiento(<span class=\"keyword\">this</span>.movimiento)</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p><img src=\"/images/ng2-DI-component-service.jpg\" alt=\"Inyeccin de servicios en componentes \"></p><h3 id=\"Directivas\"><a href=\"#Directivas\" class=\"headerlink\" title=\"Directivas\"></a>Directivas</h3><p>Las directivas eran el ADN de AngularJS1. Ahora han mutado en <strong>componentes reutilizables</strong> como elementos en las vistas de otros componentes de rango superior. Pero la idea es la misma, desglosar las plantillas de HTML en bloques con un propsito nico.</p><p>La sintaxis de las directivas es similar:</p><ul><li>la definicin del servicio decorado como <code>@Injectable()</code> en el componente hijo,</li><li>la exportacin del hijo y la importacin en el padre,</li><li>el registro en el array <code>directives:[]</code> del componente padre (o del mdulo padre) y</li><li>el consumo declarativo en la plantilla de la vista padre.</li></ul><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientoComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./movimiento'</span>;</div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  selector: <span class=\"string\">'injection-app'</span>,</div><div class=\"line\">  template: <span class=\"string\">'&lt;h1&gt;</span></div><div class=\"line\"><span class=\"string\">              &#123;&#123;titulo&#125;&#125;</span></div><div class=\"line\"><span class=\"string\">            &lt;/h1&gt;</span></div><div class=\"line\"><span class=\"string\">            &lt;movimiento&gt;&lt;/movimiento&gt;'</span>,</div><div class=\"line\">  directives:[MovimientoComponent]</div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InjectionAppComponent</span> </span>&#123;</div><div class=\"line\">  titulo = <span class=\"string\">'Inyectores listos!'</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p><img src=\"/images/ng2-DI-component-directive.jpg\" alt=\"Inyeccin de directivas en componentes\"></p><h2 id=\"Registro\"><a href=\"#Registro\" class=\"headerlink\" title=\"Registro\"></a>Registro</h2><p>La inyeccin de las dependencias <strong>funciona de manera jerrquica</strong> en AngularJS 2. Cuando un mdulo registra una dependencia la pone a disposicin de todos sus componentes hijos. Es ms, si algn hijo la volviese a registrar se le proveera de otra instancia.</p><p>Esta copia puede provocar efectos colaterales indeseados. Para <strong>compartir datos</strong> o ahorrar memoria se recomienda registrar las dependencias lo ms arriba posible. Esto siempre sin sacrificar la modularidad o la escalabilidad de aplicaciones que requieran <em>lazy loading</em>.</p><blockquote><p>Atencin a la copia de <em>routeService</em> que se registra por segunda vez. No importa que ya la haya registrado su padre. Otro registro implica otra instancia.</p></blockquote><p><img src=\"/images/ng2-Arbol-de-dependencias.jpg\" alt=\"Jerarqua de dependencias en AngularJS\"></p><p>Para ciertos casos, AngularJS 2 permite modelos de inyeccin ms avanzados. Mediante el uso de <strong>factoras y el registro de cadenas</strong> con los nombres de los servicios facilita la inyeccin a voluntad o la carga diferida.</p><blockquote><p>Algunas de estas posibilidades estn siendo retocadas durante la actual <em>Release Candidate</em>, y se esperan cambios de cara a las prxima versin estable.</p></blockquote><p>El viejo principio de <em>divide y vencers</em> se aplica rotundamente en las aplicaciones Angular 2. Si creas <strong>mdulos reutilizables</strong> estars sentando las bases para crear grandes aplicaciones de negocio con AngularJS.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a></p>"},{"title":"Angular2, la evolucin de la plataforma","id":"24","updated":"2016-06-08T06:10:11.000Z","date":"2016-05-06T13:57:50.000Z","_content":"\nCoincidiendo con la **ngConf 2016** acaba de presentarse la esperada *Release Candidate* de **[Angular 2](https://angular.io/)**. Nunca antes una versin de una herramienta para desarrolladores haba causado tal expectacin. Hace ya 18 meses que se haba anunciado como una evolucin rupturista con respecto a **AngularJS 1**. Y ahora esa ruptura se ha materializado. \n\nLos programadores somos muy conscientes de que **lo nico estable es el cambio**. Asumimos, por experiencia, que los cambios en una tecnologa son evoluciones graduales constantes. Pero esto no es as en **Angular2**, y lo sabemos desde su anuncio hace ao y medio. Desde ese momento todos fuimos advertidos de que estbamos ante otra cosa. Algo nuevo que slo comparte paternidad y nombre con la anterior versin.\n\n<!-- more -->\n\n## Un poco de historia\n\nEn septiembre de 2011 me tropec con AngularJS buscando una alternativa a *Backbone* y *KnockOut*. Yo vena del mundo encorsetado del desarrollo para multinacionales basado en tecnologas *serias* como .Net y Java. Necesitaba un cambio, una apertura... pero con ciertas garantas. \n\nEn esos tiempos el desarrollo web viva su eclosin de la mano del HTML5. Era un mundo de *startups* (ah estaba yo), de *earlyadopters* y de picaflores tecnolgicos. Buscbamos **tecnologas simples, universales y de bajo coste**. Muy en la lnea con el mtodo empresarial *lean*. Pero el riesgo de escoger el framework perdedor era enorme, y cada pocos meses aparecan o desaparecan candidatos. \n\nAngular super a sus contendientes por dos razones: una fue (rellena aqu con el argumentario tcnico que ms te satisfaga) y la otra fue **Google**. Un padrino as abre muchas puertas y da el punto de valor suficiente para alejarte de Oracle o Microsoft sin temor.\n\nEn enero de 2013 abandon mi sueo de convertirme en el nuevo Zuckerberg. Volv al viejo sector servicios fundando una empresa de consultora. Aprovechando los conocimientos y mtodos giles aprendidos por el camino *startup*, ofrecimos desarrollos *low cost* para pequeas empresas. Para complementar los servicios empec a impartir cursos sobre estas tecnologas a otros desarrolladores. Al principio slo acudan *freelances* y pequeas consultoras.\n\nEn marzo de 2015 tuve los primeros contactos con **grandes empresas** tanto a nivel docente como consultor. Volv a un mundo familiar pero con una tecnologa distinta. AngularJS haba crecido de manera exponencial en nmero de desarrolladores. Pero ahora estaba jugando en las grandes ligas.\n \nY de repente aparecieron los problemas.\n\n### Dos problemas\n\n#### El lenguaje\nJavaScript es dinmico, asncrono y nada modular. Ideal para espritus libres, pero una amenaza para equipos estrictos. Y necesitas control si vas a migrar grandes aplicaciones de negocio, ERPs , banca, servicios de administracin pblica. \n\nTampoco se emocionaban los arquitectos de software con las **herramientas**. Como siempre todo empez de manera sencilla: ficheros y editores de texto. Luego lleg la minificacin, la combinacin, el pre y pos procesado, las anotaciones, la documentacin, las pruebas... Cada mes era mayor el arsenal de micro herramientas que haba que orquestar.\n\n#### La escalabilidad\nLas aplicaciones empresariales son pesadas en lgica y datos. La falta de un cargador dinmico decente haca muy difcil reducir el tiempo antes del primer impacto. Una vez lanzadas las aplicaciones iban razonablemente bien. \nHasta que alguien creaba informes editables. Con miles de datos de los que preocuparse la tcnica del **doble binding** saturaba los *watchers*. \n\nAngularJS mora de xito. \n\n### Dos soluciones\n#### El lenguaje: TypeScript\nLa lenta evolucin de JavaScript parece haber salido de su hibernacin. En el ltimo ao disfrutamos ya de las mejoras de **ES6 (ES2015)** y empezamos a probar **ES7 (2016)**. Pero no es suficiente.\n\nPara grandes desarrollos, con miles de lneas de cdigo, toda ayuda es poca. **TypeScript** asume todas las mejoras y propuestas del ms avanzado JS estndar y adems aporta **tipos**. Esa es la principal razn de su eleccin como lenguaje de cabecera en AngularJS2.\n\nAl rededor de esa piedra angular crece el ecosistema de **herramientas**. Principalmente [VSCode](https://code.visualstudio.com/) que lo aprovecha ofreciendo *intellisense* y *refactoring* a la altura de los grandes.\n\nLa oferta se completa con *Interfaces*, *Generics* y otras novedades que harn las delicias de los programadores orientados a objetos. \n\nCabe sealar que TypeScript no es ni mucho menos obligatorio. **Se puede desarrollar en ES5 y ES6** sin problemas. Pero la idea, los ejemplos, la documentacin y los blogueros haremos que tu vida sea ms fcil si escoges TypeScript.\n\n#### La plataforma: renderizacin, observables, componentes, carga dinmica, SEO, apps, herramientas...\nEl **doble binding** era el plato estrella de AngularJS, pero sala caro. As que se replante una solucin que no requiriese un *pull* constante preguntando el estado de un montn de variables. Las respuesta vino de la mano de otra colaboracin con los de Redmond: [ReactiveX](http://reactivex.io/). Este cambio ser el primero al que te enfrentes si vienes de las conocidas versiones 1.\n\nEl mismo **patrn observable** se aplic tambin a las comunicaciones HTTP. Nuestra aplicacin es ahora un conjunto de *streams* que emiten eventos. Solo tenemos que suscribirnos y observar el estado cambiante de nuestro modelo. Resultado, aplicaciones hasta **cinco veces ms rpidas**.\n\nLos principios de encapsulacin, modularidad y reutilizacin ya estaban en el ADN de AngularJS. Pero no era fcil implementarlos con las viejas directivas. Desde la versin 1.5 disponemos de **componentes**. Esta versin puente trae una simplificacin y una gua sobre como estructurar aplicaciones. En AngularJS 2 van ms all, y tal como haban amenazado, matan al controlador y coronan al componente como nuevo rey del *front end*.\n\nLa **inyeccin de dependencias** fue uno de los grandes aciertos iniciales de AngularJS 1. Pero con el tiempo se convirti en una rmora para crear grandes SPAs, pues requera disponer de toda la lgica, todo tu cdigo, desde el primer segundo. Este problema se ha resuelto, aunque de forma demasiado tediosa. Hay margen de mejora en la actual implementacin y espero que se vaya simplificando.\n\nUno de los pocos puntos dbiles de AngularJS, y otros frameworks *client side*, era la dificultad para la indexacin **SEO on site**. La solucin normalmente pasaba por algn tipo de *prerenderizado* ms o menos engorroso. Con la aparicin de [Angular Universal](https://universal.angular.io/), podemos ejecutar **Angular en el servidor**. Esto abre las puertas al SEO y a la reduccin de la espera en la primera visita.\n\nLas aplicaciones hbridas han sido la solucin *low cost* para que cualquier empresa accediese a los elitistas mercados de aplicaciones para mviles. Pero la solucin no era perfecta. Con el [Angular Mobile Tookit](https://mobile.angular.io/) se ofrecen **aplicaciones progresivas** que compiten en rendimiento y funcionalidad con las nativas.\n\nPoner en marcha y depurar una aplicacin moderna de gran tamao requiere herramientas a la altura. La oferta en este caso es total: \n\n- [Angular CLI](https://cli.angular.io/) una herramienta en lnea de comandos para generar aplicaciones preconfiguradas\n- [Augury](https://augury.angular.io/) para depurar y visualizar en el navegador el estado del programa\n- [Protractor]() para los tests e2e\n- [Guas de estilo](https://angular.io/styleguide) y analizadores de cdigo... \n\n#### Una alternativa\n[React](https://facebook.github.io/react/), la propuesta de Facebook para el desarrollo web, es una herramienta formidable. Rpido en ejecucin, ms cercano al estndar JS y mucho menos exigente en cuanto a herramientas. \n\nParte con la enorme desventaja numrica que supone el ms de un milln de programadores que ya conocen AngularJS y el ecosistema de libreras, componentes y material docente que ha surgido a su alrededor.\n\nSer por esto ltimo que an no ha enganchado en la gran empresa. Por tanto an no tira de ofertas de trabajo ni genera el ruido de la apuesta de Google. Eso s, merece mucho la pena conocerlo, e incluso incorporarlo en algn caso junto a Angular 2.   \n\n## Angular 2 no es plataforma para aficionados\nEl resumen es que AngularJS 1.x ha mutado **de framework a plataforma** en Angular 2. En este sentido estar cada vez ms orientada a grandes desarrollos empresariales, y a salir definitivamente del navegador y ocupar servidores, escritorios y telfonos. \n\nSeguro que requiere un gran esfuerzo de aprendizaje por su novedades radicales. Seguro que por el camino habr giros por su bisoez y amplitud. Pero seguro que estamos ante la **plataforma de desarrollo empresarial** con mejor futuro. De momento.\n\n> En [esta presentacin](https://docs.google.com/presentation/d/1VyMGTwiM7HmNMdSCXrrYpHIej-Y8ZwZKCan7KMqvdCA/edit?usp=sharing) tienes un resumen rpido de mis impresiones acerca de Angular2, y de cmo empezar a programar aplicaciones universales.","source":"_posts/Angular2-la-evolucion-de-la-plataforma.md","raw":"---\ntitle: 'Angular2, la evolucin de la plataforma'\ntags:  \n- Angular2\ncategories:\n- Introduccin \npermalink: angular2-primeras-impresiones\nid: 24\nupdated: '2016-06-08 08:10:11'\ndate: 2016-05-06 15:57:50\n---\n\nCoincidiendo con la **ngConf 2016** acaba de presentarse la esperada *Release Candidate* de **[Angular 2](https://angular.io/)**. Nunca antes una versin de una herramienta para desarrolladores haba causado tal expectacin. Hace ya 18 meses que se haba anunciado como una evolucin rupturista con respecto a **AngularJS 1**. Y ahora esa ruptura se ha materializado. \n\nLos programadores somos muy conscientes de que **lo nico estable es el cambio**. Asumimos, por experiencia, que los cambios en una tecnologa son evoluciones graduales constantes. Pero esto no es as en **Angular2**, y lo sabemos desde su anuncio hace ao y medio. Desde ese momento todos fuimos advertidos de que estbamos ante otra cosa. Algo nuevo que slo comparte paternidad y nombre con la anterior versin.\n\n<!-- more -->\n\n## Un poco de historia\n\nEn septiembre de 2011 me tropec con AngularJS buscando una alternativa a *Backbone* y *KnockOut*. Yo vena del mundo encorsetado del desarrollo para multinacionales basado en tecnologas *serias* como .Net y Java. Necesitaba un cambio, una apertura... pero con ciertas garantas. \n\nEn esos tiempos el desarrollo web viva su eclosin de la mano del HTML5. Era un mundo de *startups* (ah estaba yo), de *earlyadopters* y de picaflores tecnolgicos. Buscbamos **tecnologas simples, universales y de bajo coste**. Muy en la lnea con el mtodo empresarial *lean*. Pero el riesgo de escoger el framework perdedor era enorme, y cada pocos meses aparecan o desaparecan candidatos. \n\nAngular super a sus contendientes por dos razones: una fue (rellena aqu con el argumentario tcnico que ms te satisfaga) y la otra fue **Google**. Un padrino as abre muchas puertas y da el punto de valor suficiente para alejarte de Oracle o Microsoft sin temor.\n\nEn enero de 2013 abandon mi sueo de convertirme en el nuevo Zuckerberg. Volv al viejo sector servicios fundando una empresa de consultora. Aprovechando los conocimientos y mtodos giles aprendidos por el camino *startup*, ofrecimos desarrollos *low cost* para pequeas empresas. Para complementar los servicios empec a impartir cursos sobre estas tecnologas a otros desarrolladores. Al principio slo acudan *freelances* y pequeas consultoras.\n\nEn marzo de 2015 tuve los primeros contactos con **grandes empresas** tanto a nivel docente como consultor. Volv a un mundo familiar pero con una tecnologa distinta. AngularJS haba crecido de manera exponencial en nmero de desarrolladores. Pero ahora estaba jugando en las grandes ligas.\n \nY de repente aparecieron los problemas.\n\n### Dos problemas\n\n#### El lenguaje\nJavaScript es dinmico, asncrono y nada modular. Ideal para espritus libres, pero una amenaza para equipos estrictos. Y necesitas control si vas a migrar grandes aplicaciones de negocio, ERPs , banca, servicios de administracin pblica. \n\nTampoco se emocionaban los arquitectos de software con las **herramientas**. Como siempre todo empez de manera sencilla: ficheros y editores de texto. Luego lleg la minificacin, la combinacin, el pre y pos procesado, las anotaciones, la documentacin, las pruebas... Cada mes era mayor el arsenal de micro herramientas que haba que orquestar.\n\n#### La escalabilidad\nLas aplicaciones empresariales son pesadas en lgica y datos. La falta de un cargador dinmico decente haca muy difcil reducir el tiempo antes del primer impacto. Una vez lanzadas las aplicaciones iban razonablemente bien. \nHasta que alguien creaba informes editables. Con miles de datos de los que preocuparse la tcnica del **doble binding** saturaba los *watchers*. \n\nAngularJS mora de xito. \n\n### Dos soluciones\n#### El lenguaje: TypeScript\nLa lenta evolucin de JavaScript parece haber salido de su hibernacin. En el ltimo ao disfrutamos ya de las mejoras de **ES6 (ES2015)** y empezamos a probar **ES7 (2016)**. Pero no es suficiente.\n\nPara grandes desarrollos, con miles de lneas de cdigo, toda ayuda es poca. **TypeScript** asume todas las mejoras y propuestas del ms avanzado JS estndar y adems aporta **tipos**. Esa es la principal razn de su eleccin como lenguaje de cabecera en AngularJS2.\n\nAl rededor de esa piedra angular crece el ecosistema de **herramientas**. Principalmente [VSCode](https://code.visualstudio.com/) que lo aprovecha ofreciendo *intellisense* y *refactoring* a la altura de los grandes.\n\nLa oferta se completa con *Interfaces*, *Generics* y otras novedades que harn las delicias de los programadores orientados a objetos. \n\nCabe sealar que TypeScript no es ni mucho menos obligatorio. **Se puede desarrollar en ES5 y ES6** sin problemas. Pero la idea, los ejemplos, la documentacin y los blogueros haremos que tu vida sea ms fcil si escoges TypeScript.\n\n#### La plataforma: renderizacin, observables, componentes, carga dinmica, SEO, apps, herramientas...\nEl **doble binding** era el plato estrella de AngularJS, pero sala caro. As que se replante una solucin que no requiriese un *pull* constante preguntando el estado de un montn de variables. Las respuesta vino de la mano de otra colaboracin con los de Redmond: [ReactiveX](http://reactivex.io/). Este cambio ser el primero al que te enfrentes si vienes de las conocidas versiones 1.\n\nEl mismo **patrn observable** se aplic tambin a las comunicaciones HTTP. Nuestra aplicacin es ahora un conjunto de *streams* que emiten eventos. Solo tenemos que suscribirnos y observar el estado cambiante de nuestro modelo. Resultado, aplicaciones hasta **cinco veces ms rpidas**.\n\nLos principios de encapsulacin, modularidad y reutilizacin ya estaban en el ADN de AngularJS. Pero no era fcil implementarlos con las viejas directivas. Desde la versin 1.5 disponemos de **componentes**. Esta versin puente trae una simplificacin y una gua sobre como estructurar aplicaciones. En AngularJS 2 van ms all, y tal como haban amenazado, matan al controlador y coronan al componente como nuevo rey del *front end*.\n\nLa **inyeccin de dependencias** fue uno de los grandes aciertos iniciales de AngularJS 1. Pero con el tiempo se convirti en una rmora para crear grandes SPAs, pues requera disponer de toda la lgica, todo tu cdigo, desde el primer segundo. Este problema se ha resuelto, aunque de forma demasiado tediosa. Hay margen de mejora en la actual implementacin y espero que se vaya simplificando.\n\nUno de los pocos puntos dbiles de AngularJS, y otros frameworks *client side*, era la dificultad para la indexacin **SEO on site**. La solucin normalmente pasaba por algn tipo de *prerenderizado* ms o menos engorroso. Con la aparicin de [Angular Universal](https://universal.angular.io/), podemos ejecutar **Angular en el servidor**. Esto abre las puertas al SEO y a la reduccin de la espera en la primera visita.\n\nLas aplicaciones hbridas han sido la solucin *low cost* para que cualquier empresa accediese a los elitistas mercados de aplicaciones para mviles. Pero la solucin no era perfecta. Con el [Angular Mobile Tookit](https://mobile.angular.io/) se ofrecen **aplicaciones progresivas** que compiten en rendimiento y funcionalidad con las nativas.\n\nPoner en marcha y depurar una aplicacin moderna de gran tamao requiere herramientas a la altura. La oferta en este caso es total: \n\n- [Angular CLI](https://cli.angular.io/) una herramienta en lnea de comandos para generar aplicaciones preconfiguradas\n- [Augury](https://augury.angular.io/) para depurar y visualizar en el navegador el estado del programa\n- [Protractor]() para los tests e2e\n- [Guas de estilo](https://angular.io/styleguide) y analizadores de cdigo... \n\n#### Una alternativa\n[React](https://facebook.github.io/react/), la propuesta de Facebook para el desarrollo web, es una herramienta formidable. Rpido en ejecucin, ms cercano al estndar JS y mucho menos exigente en cuanto a herramientas. \n\nParte con la enorme desventaja numrica que supone el ms de un milln de programadores que ya conocen AngularJS y el ecosistema de libreras, componentes y material docente que ha surgido a su alrededor.\n\nSer por esto ltimo que an no ha enganchado en la gran empresa. Por tanto an no tira de ofertas de trabajo ni genera el ruido de la apuesta de Google. Eso s, merece mucho la pena conocerlo, e incluso incorporarlo en algn caso junto a Angular 2.   \n\n## Angular 2 no es plataforma para aficionados\nEl resumen es que AngularJS 1.x ha mutado **de framework a plataforma** en Angular 2. En este sentido estar cada vez ms orientada a grandes desarrollos empresariales, y a salir definitivamente del navegador y ocupar servidores, escritorios y telfonos. \n\nSeguro que requiere un gran esfuerzo de aprendizaje por su novedades radicales. Seguro que por el camino habr giros por su bisoez y amplitud. Pero seguro que estamos ante la **plataforma de desarrollo empresarial** con mejor futuro. De momento.\n\n> En [esta presentacin](https://docs.google.com/presentation/d/1VyMGTwiM7HmNMdSCXrrYpHIej-Y8ZwZKCan7KMqvdCA/edit?usp=sharing) tienes un resumen rpido de mis impresiones acerca de Angular2, y de cmo empezar a programar aplicaciones universales.","slug":"angular2-primeras-impresiones","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvf6000aiwd3funll6pp","content":"<p>Coincidiendo con la <strong>ngConf 2016</strong> acaba de presentarse la esperada <em>Release Candidate</em> de <strong><a href=\"https://angular.io/\" target=\"_blank\" rel=\"external\">Angular 2</a></strong>. Nunca antes una versin de una herramienta para desarrolladores haba causado tal expectacin. Hace ya 18 meses que se haba anunciado como una evolucin rupturista con respecto a <strong>AngularJS 1</strong>. Y ahora esa ruptura se ha materializado.</p><p>Los programadores somos muy conscientes de que <strong>lo nico estable es el cambio</strong>. Asumimos, por experiencia, que los cambios en una tecnologa son evoluciones graduales constantes. Pero esto no es as en <strong>Angular2</strong>, y lo sabemos desde su anuncio hace ao y medio. Desde ese momento todos fuimos advertidos de que estbamos ante otra cosa. Algo nuevo que slo comparte paternidad y nombre con la anterior versin.</p><a id=\"more\"></a><h2 id=\"Un-poco-de-historia\"><a href=\"#Un-poco-de-historia\" class=\"headerlink\" title=\"Un poco de historia\"></a>Un poco de historia</h2><p>En septiembre de 2011 me tropec con AngularJS buscando una alternativa a <em>Backbone</em> y <em>KnockOut</em>. Yo vena del mundo encorsetado del desarrollo para multinacionales basado en tecnologas <em>serias</em> como .Net y Java. Necesitaba un cambio, una apertura pero con ciertas garantas.</p><p>En esos tiempos el desarrollo web viva su eclosin de la mano del HTML5. Era un mundo de <em>startups</em> (ah estaba yo), de <em>earlyadopters</em> y de picaflores tecnolgicos. Buscbamos <strong>tecnologas simples, universales y de bajo coste</strong>. Muy en la lnea con el mtodo empresarial <em>lean</em>. Pero el riesgo de escoger el framework perdedor era enorme, y cada pocos meses aparecan o desaparecan candidatos.</p><p>Angular super a sus contendientes por dos razones: una fue (rellena aqu con el argumentario tcnico que ms te satisfaga) y la otra fue <strong>Google</strong>. Un padrino as abre muchas puertas y da el punto de valor suficiente para alejarte de Oracle o Microsoft sin temor.</p><p>En enero de 2013 abandon mi sueo de convertirme en el nuevo Zuckerberg. Volv al viejo sector servicios fundando una empresa de consultora. Aprovechando los conocimientos y mtodos giles aprendidos por el camino <em>startup</em>, ofrecimos desarrollos <em>low cost</em> para pequeas empresas. Para complementar los servicios empec a impartir cursos sobre estas tecnologas a otros desarrolladores. Al principio slo acudan <em>freelances</em> y pequeas consultoras.</p><p>En marzo de 2015 tuve los primeros contactos con <strong>grandes empresas</strong> tanto a nivel docente como consultor. Volv a un mundo familiar pero con una tecnologa distinta. AngularJS haba crecido de manera exponencial en nmero de desarrolladores. Pero ahora estaba jugando en las grandes ligas.</p><p>Y de repente aparecieron los problemas.</p><h3 id=\"Dos-problemas\"><a href=\"#Dos-problemas\" class=\"headerlink\" title=\"Dos problemas\"></a>Dos problemas</h3><h4 id=\"El-lenguaje\"><a href=\"#El-lenguaje\" class=\"headerlink\" title=\"El lenguaje\"></a>El lenguaje</h4><p>JavaScript es dinmico, asncrono y nada modular. Ideal para espritus libres, pero una amenaza para equipos estrictos. Y necesitas control si vas a migrar grandes aplicaciones de negocio, ERPs , banca, servicios de administracin pblica.</p><p>Tampoco se emocionaban los arquitectos de software con las <strong>herramientas</strong>. Como siempre todo empez de manera sencilla: ficheros y editores de texto. Luego lleg la minificacin, la combinacin, el pre y pos procesado, las anotaciones, la documentacin, las pruebas Cada mes era mayor el arsenal de micro herramientas que haba que orquestar.</p><h4 id=\"La-escalabilidad\"><a href=\"#La-escalabilidad\" class=\"headerlink\" title=\"La escalabilidad\"></a>La escalabilidad</h4><p>Las aplicaciones empresariales son pesadas en lgica y datos. La falta de un cargador dinmico decente haca muy difcil reducir el tiempo antes del primer impacto. Una vez lanzadas las aplicaciones iban razonablemente bien.<br>Hasta que alguien creaba informes editables. Con miles de datos de los que preocuparse la tcnica del <strong>doble binding</strong> saturaba los <em>watchers</em>.</p><p>AngularJS mora de xito.</p><h3 id=\"Dos-soluciones\"><a href=\"#Dos-soluciones\" class=\"headerlink\" title=\"Dos soluciones\"></a>Dos soluciones</h3><h4 id=\"El-lenguaje-TypeScript\"><a href=\"#El-lenguaje-TypeScript\" class=\"headerlink\" title=\"El lenguaje: TypeScript\"></a>El lenguaje: TypeScript</h4><p>La lenta evolucin de JavaScript parece haber salido de su hibernacin. En el ltimo ao disfrutamos ya de las mejoras de <strong>ES6 (ES2015)</strong> y empezamos a probar <strong>ES7 (2016)</strong>. Pero no es suficiente.</p><p>Para grandes desarrollos, con miles de lneas de cdigo, toda ayuda es poca. <strong>TypeScript</strong> asume todas las mejoras y propuestas del ms avanzado JS estndar y adems aporta <strong>tipos</strong>. Esa es la principal razn de su eleccin como lenguaje de cabecera en AngularJS2.</p><p>Al rededor de esa piedra angular crece el ecosistema de <strong>herramientas</strong>. Principalmente <a href=\"https://code.visualstudio.com/\" target=\"_blank\" rel=\"external\">VSCode</a> que lo aprovecha ofreciendo <em>intellisense</em> y <em>refactoring</em> a la altura de los grandes.</p><p>La oferta se completa con <em>Interfaces</em>, <em>Generics</em> y otras novedades que harn las delicias de los programadores orientados a objetos.</p><p>Cabe sealar que TypeScript no es ni mucho menos obligatorio. <strong>Se puede desarrollar en ES5 y ES6</strong> sin problemas. Pero la idea, los ejemplos, la documentacin y los blogueros haremos que tu vida sea ms fcil si escoges TypeScript.</p><h4 id=\"La-plataforma-renderizacion-observables-componentes-carga-dinamica-SEO-apps-herramientas\"><a href=\"#La-plataforma-renderizacion-observables-componentes-carga-dinamica-SEO-apps-herramientas\" class=\"headerlink\" title=\"La plataforma: renderizacin, observables, componentes, carga dinmica, SEO, apps, herramientas\"></a>La plataforma: renderizacin, observables, componentes, carga dinmica, SEO, apps, herramientas</h4><p>El <strong>doble binding</strong> era el plato estrella de AngularJS, pero sala caro. As que se replante una solucin que no requiriese un <em>pull</em> constante preguntando el estado de un montn de variables. Las respuesta vino de la mano de otra colaboracin con los de Redmond: <a href=\"http://reactivex.io/\" target=\"_blank\" rel=\"external\">ReactiveX</a>. Este cambio ser el primero al que te enfrentes si vienes de las conocidas versiones 1.</p><p>El mismo <strong>patrn observable</strong> se aplic tambin a las comunicaciones HTTP. Nuestra aplicacin es ahora un conjunto de <em>streams</em> que emiten eventos. Solo tenemos que suscribirnos y observar el estado cambiante de nuestro modelo. Resultado, aplicaciones hasta <strong>cinco veces ms rpidas</strong>.</p><p>Los principios de encapsulacin, modularidad y reutilizacin ya estaban en el ADN de AngularJS. Pero no era fcil implementarlos con las viejas directivas. Desde la versin 1.5 disponemos de <strong>componentes</strong>. Esta versin puente trae una simplificacin y una gua sobre como estructurar aplicaciones. En AngularJS 2 van ms all, y tal como haban amenazado, matan al controlador y coronan al componente como nuevo rey del <em>front end</em>.</p><p>La <strong>inyeccin de dependencias</strong> fue uno de los grandes aciertos iniciales de AngularJS 1. Pero con el tiempo se convirti en una rmora para crear grandes SPAs, pues requera disponer de toda la lgica, todo tu cdigo, desde el primer segundo. Este problema se ha resuelto, aunque de forma demasiado tediosa. Hay margen de mejora en la actual implementacin y espero que se vaya simplificando.</p><p>Uno de los pocos puntos dbiles de AngularJS, y otros frameworks <em>client side</em>, era la dificultad para la indexacin <strong>SEO on site</strong>. La solucin normalmente pasaba por algn tipo de <em>prerenderizado</em> ms o menos engorroso. Con la aparicin de <a href=\"https://universal.angular.io/\" target=\"_blank\" rel=\"external\">Angular Universal</a>, podemos ejecutar <strong>Angular en el servidor</strong>. Esto abre las puertas al SEO y a la reduccin de la espera en la primera visita.</p><p>Las aplicaciones hbridas han sido la solucin <em>low cost</em> para que cualquier empresa accediese a los elitistas mercados de aplicaciones para mviles. Pero la solucin no era perfecta. Con el <a href=\"https://mobile.angular.io/\" target=\"_blank\" rel=\"external\">Angular Mobile Tookit</a> se ofrecen <strong>aplicaciones progresivas</strong> que compiten en rendimiento y funcionalidad con las nativas.</p><p>Poner en marcha y depurar una aplicacin moderna de gran tamao requiere herramientas a la altura. La oferta en este caso es total:</p><ul><li><a href=\"https://cli.angular.io/\" target=\"_blank\" rel=\"external\">Angular CLI</a> una herramienta en lnea de comandos para generar aplicaciones preconfiguradas</li><li><a href=\"https://augury.angular.io/\" target=\"_blank\" rel=\"external\">Augury</a> para depurar y visualizar en el navegador el estado del programa</li><li><a href=\"\">Protractor</a> para los tests e2e</li><li><a href=\"https://angular.io/styleguide\" target=\"_blank\" rel=\"external\">Guas de estilo</a> y analizadores de cdigo</li></ul><h4 id=\"Una-alternativa\"><a href=\"#Una-alternativa\" class=\"headerlink\" title=\"Una alternativa\"></a>Una alternativa</h4><p><a href=\"https://facebook.github.io/react/\" target=\"_blank\" rel=\"external\">React</a>, la propuesta de Facebook para el desarrollo web, es una herramienta formidable. Rpido en ejecucin, ms cercano al estndar JS y mucho menos exigente en cuanto a herramientas.</p><p>Parte con la enorme desventaja numrica que supone el ms de un milln de programadores que ya conocen AngularJS y el ecosistema de libreras, componentes y material docente que ha surgido a su alrededor.</p><p>Ser por esto ltimo que an no ha enganchado en la gran empresa. Por tanto an no tira de ofertas de trabajo ni genera el ruido de la apuesta de Google. Eso s, merece mucho la pena conocerlo, e incluso incorporarlo en algn caso junto a Angular 2.</p><h2 id=\"Angular-2-no-es-plataforma-para-aficionados\"><a href=\"#Angular-2-no-es-plataforma-para-aficionados\" class=\"headerlink\" title=\"Angular 2 no es plataforma para aficionados\"></a>Angular 2 no es plataforma para aficionados</h2><p>El resumen es que AngularJS 1.x ha mutado <strong>de framework a plataforma</strong> en Angular 2. En este sentido estar cada vez ms orientada a grandes desarrollos empresariales, y a salir definitivamente del navegador y ocupar servidores, escritorios y telfonos.</p><p>Seguro que requiere un gran esfuerzo de aprendizaje por su novedades radicales. Seguro que por el camino habr giros por su bisoez y amplitud. Pero seguro que estamos ante la <strong>plataforma de desarrollo empresarial</strong> con mejor futuro. De momento.</p><blockquote><p>En <a href=\"https://docs.google.com/presentation/d/1VyMGTwiM7HmNMdSCXrrYpHIej-Y8ZwZKCan7KMqvdCA/edit?usp=sharing\" target=\"_blank\" rel=\"external\">esta presentacin</a> tienes un resumen rpido de mis impresiones acerca de Angular2, y de cmo empezar a programar aplicaciones universales.</p></blockquote>","site":{"data":{}},"excerpt":"<p>Coincidiendo con la <strong>ngConf 2016</strong> acaba de presentarse la esperada <em>Release Candidate</em> de <strong><a href=\"https://angular.io/\" target=\"_blank\" rel=\"external\">Angular 2</a></strong>. Nunca antes una versin de una herramienta para desarrolladores haba causado tal expectacin. Hace ya 18 meses que se haba anunciado como una evolucin rupturista con respecto a <strong>AngularJS 1</strong>. Y ahora esa ruptura se ha materializado.</p><p>Los programadores somos muy conscientes de que <strong>lo nico estable es el cambio</strong>. Asumimos, por experiencia, que los cambios en una tecnologa son evoluciones graduales constantes. Pero esto no es as en <strong>Angular2</strong>, y lo sabemos desde su anuncio hace ao y medio. Desde ese momento todos fuimos advertidos de que estbamos ante otra cosa. Algo nuevo que slo comparte paternidad y nombre con la anterior versin.</p>","more":"<h2 id=\"Un-poco-de-historia\"><a href=\"#Un-poco-de-historia\" class=\"headerlink\" title=\"Un poco de historia\"></a>Un poco de historia</h2><p>En septiembre de 2011 me tropec con AngularJS buscando una alternativa a <em>Backbone</em> y <em>KnockOut</em>. Yo vena del mundo encorsetado del desarrollo para multinacionales basado en tecnologas <em>serias</em> como .Net y Java. Necesitaba un cambio, una apertura pero con ciertas garantas.</p><p>En esos tiempos el desarrollo web viva su eclosin de la mano del HTML5. Era un mundo de <em>startups</em> (ah estaba yo), de <em>earlyadopters</em> y de picaflores tecnolgicos. Buscbamos <strong>tecnologas simples, universales y de bajo coste</strong>. Muy en la lnea con el mtodo empresarial <em>lean</em>. Pero el riesgo de escoger el framework perdedor era enorme, y cada pocos meses aparecan o desaparecan candidatos.</p><p>Angular super a sus contendientes por dos razones: una fue (rellena aqu con el argumentario tcnico que ms te satisfaga) y la otra fue <strong>Google</strong>. Un padrino as abre muchas puertas y da el punto de valor suficiente para alejarte de Oracle o Microsoft sin temor.</p><p>En enero de 2013 abandon mi sueo de convertirme en el nuevo Zuckerberg. Volv al viejo sector servicios fundando una empresa de consultora. Aprovechando los conocimientos y mtodos giles aprendidos por el camino <em>startup</em>, ofrecimos desarrollos <em>low cost</em> para pequeas empresas. Para complementar los servicios empec a impartir cursos sobre estas tecnologas a otros desarrolladores. Al principio slo acudan <em>freelances</em> y pequeas consultoras.</p><p>En marzo de 2015 tuve los primeros contactos con <strong>grandes empresas</strong> tanto a nivel docente como consultor. Volv a un mundo familiar pero con una tecnologa distinta. AngularJS haba crecido de manera exponencial en nmero de desarrolladores. Pero ahora estaba jugando en las grandes ligas.</p><p>Y de repente aparecieron los problemas.</p><h3 id=\"Dos-problemas\"><a href=\"#Dos-problemas\" class=\"headerlink\" title=\"Dos problemas\"></a>Dos problemas</h3><h4 id=\"El-lenguaje\"><a href=\"#El-lenguaje\" class=\"headerlink\" title=\"El lenguaje\"></a>El lenguaje</h4><p>JavaScript es dinmico, asncrono y nada modular. Ideal para espritus libres, pero una amenaza para equipos estrictos. Y necesitas control si vas a migrar grandes aplicaciones de negocio, ERPs , banca, servicios de administracin pblica.</p><p>Tampoco se emocionaban los arquitectos de software con las <strong>herramientas</strong>. Como siempre todo empez de manera sencilla: ficheros y editores de texto. Luego lleg la minificacin, la combinacin, el pre y pos procesado, las anotaciones, la documentacin, las pruebas Cada mes era mayor el arsenal de micro herramientas que haba que orquestar.</p><h4 id=\"La-escalabilidad\"><a href=\"#La-escalabilidad\" class=\"headerlink\" title=\"La escalabilidad\"></a>La escalabilidad</h4><p>Las aplicaciones empresariales son pesadas en lgica y datos. La falta de un cargador dinmico decente haca muy difcil reducir el tiempo antes del primer impacto. Una vez lanzadas las aplicaciones iban razonablemente bien.<br>Hasta que alguien creaba informes editables. Con miles de datos de los que preocuparse la tcnica del <strong>doble binding</strong> saturaba los <em>watchers</em>.</p><p>AngularJS mora de xito.</p><h3 id=\"Dos-soluciones\"><a href=\"#Dos-soluciones\" class=\"headerlink\" title=\"Dos soluciones\"></a>Dos soluciones</h3><h4 id=\"El-lenguaje-TypeScript\"><a href=\"#El-lenguaje-TypeScript\" class=\"headerlink\" title=\"El lenguaje: TypeScript\"></a>El lenguaje: TypeScript</h4><p>La lenta evolucin de JavaScript parece haber salido de su hibernacin. En el ltimo ao disfrutamos ya de las mejoras de <strong>ES6 (ES2015)</strong> y empezamos a probar <strong>ES7 (2016)</strong>. Pero no es suficiente.</p><p>Para grandes desarrollos, con miles de lneas de cdigo, toda ayuda es poca. <strong>TypeScript</strong> asume todas las mejoras y propuestas del ms avanzado JS estndar y adems aporta <strong>tipos</strong>. Esa es la principal razn de su eleccin como lenguaje de cabecera en AngularJS2.</p><p>Al rededor de esa piedra angular crece el ecosistema de <strong>herramientas</strong>. Principalmente <a href=\"https://code.visualstudio.com/\" target=\"_blank\" rel=\"external\">VSCode</a> que lo aprovecha ofreciendo <em>intellisense</em> y <em>refactoring</em> a la altura de los grandes.</p><p>La oferta se completa con <em>Interfaces</em>, <em>Generics</em> y otras novedades que harn las delicias de los programadores orientados a objetos.</p><p>Cabe sealar que TypeScript no es ni mucho menos obligatorio. <strong>Se puede desarrollar en ES5 y ES6</strong> sin problemas. Pero la idea, los ejemplos, la documentacin y los blogueros haremos que tu vida sea ms fcil si escoges TypeScript.</p><h4 id=\"La-plataforma-renderizacion-observables-componentes-carga-dinamica-SEO-apps-herramientas\"><a href=\"#La-plataforma-renderizacion-observables-componentes-carga-dinamica-SEO-apps-herramientas\" class=\"headerlink\" title=\"La plataforma: renderizacin, observables, componentes, carga dinmica, SEO, apps, herramientas\"></a>La plataforma: renderizacin, observables, componentes, carga dinmica, SEO, apps, herramientas</h4><p>El <strong>doble binding</strong> era el plato estrella de AngularJS, pero sala caro. As que se replante una solucin que no requiriese un <em>pull</em> constante preguntando el estado de un montn de variables. Las respuesta vino de la mano de otra colaboracin con los de Redmond: <a href=\"http://reactivex.io/\" target=\"_blank\" rel=\"external\">ReactiveX</a>. Este cambio ser el primero al que te enfrentes si vienes de las conocidas versiones 1.</p><p>El mismo <strong>patrn observable</strong> se aplic tambin a las comunicaciones HTTP. Nuestra aplicacin es ahora un conjunto de <em>streams</em> que emiten eventos. Solo tenemos que suscribirnos y observar el estado cambiante de nuestro modelo. Resultado, aplicaciones hasta <strong>cinco veces ms rpidas</strong>.</p><p>Los principios de encapsulacin, modularidad y reutilizacin ya estaban en el ADN de AngularJS. Pero no era fcil implementarlos con las viejas directivas. Desde la versin 1.5 disponemos de <strong>componentes</strong>. Esta versin puente trae una simplificacin y una gua sobre como estructurar aplicaciones. En AngularJS 2 van ms all, y tal como haban amenazado, matan al controlador y coronan al componente como nuevo rey del <em>front end</em>.</p><p>La <strong>inyeccin de dependencias</strong> fue uno de los grandes aciertos iniciales de AngularJS 1. Pero con el tiempo se convirti en una rmora para crear grandes SPAs, pues requera disponer de toda la lgica, todo tu cdigo, desde el primer segundo. Este problema se ha resuelto, aunque de forma demasiado tediosa. Hay margen de mejora en la actual implementacin y espero que se vaya simplificando.</p><p>Uno de los pocos puntos dbiles de AngularJS, y otros frameworks <em>client side</em>, era la dificultad para la indexacin <strong>SEO on site</strong>. La solucin normalmente pasaba por algn tipo de <em>prerenderizado</em> ms o menos engorroso. Con la aparicin de <a href=\"https://universal.angular.io/\" target=\"_blank\" rel=\"external\">Angular Universal</a>, podemos ejecutar <strong>Angular en el servidor</strong>. Esto abre las puertas al SEO y a la reduccin de la espera en la primera visita.</p><p>Las aplicaciones hbridas han sido la solucin <em>low cost</em> para que cualquier empresa accediese a los elitistas mercados de aplicaciones para mviles. Pero la solucin no era perfecta. Con el <a href=\"https://mobile.angular.io/\" target=\"_blank\" rel=\"external\">Angular Mobile Tookit</a> se ofrecen <strong>aplicaciones progresivas</strong> que compiten en rendimiento y funcionalidad con las nativas.</p><p>Poner en marcha y depurar una aplicacin moderna de gran tamao requiere herramientas a la altura. La oferta en este caso es total:</p><ul><li><a href=\"https://cli.angular.io/\" target=\"_blank\" rel=\"external\">Angular CLI</a> una herramienta en lnea de comandos para generar aplicaciones preconfiguradas</li><li><a href=\"https://augury.angular.io/\" target=\"_blank\" rel=\"external\">Augury</a> para depurar y visualizar en el navegador el estado del programa</li><li><a href=\"\">Protractor</a> para los tests e2e</li><li><a href=\"https://angular.io/styleguide\" target=\"_blank\" rel=\"external\">Guas de estilo</a> y analizadores de cdigo</li></ul><h4 id=\"Una-alternativa\"><a href=\"#Una-alternativa\" class=\"headerlink\" title=\"Una alternativa\"></a>Una alternativa</h4><p><a href=\"https://facebook.github.io/react/\" target=\"_blank\" rel=\"external\">React</a>, la propuesta de Facebook para el desarrollo web, es una herramienta formidable. Rpido en ejecucin, ms cercano al estndar JS y mucho menos exigente en cuanto a herramientas.</p><p>Parte con la enorme desventaja numrica que supone el ms de un milln de programadores que ya conocen AngularJS y el ecosistema de libreras, componentes y material docente que ha surgido a su alrededor.</p><p>Ser por esto ltimo que an no ha enganchado en la gran empresa. Por tanto an no tira de ofertas de trabajo ni genera el ruido de la apuesta de Google. Eso s, merece mucho la pena conocerlo, e incluso incorporarlo en algn caso junto a Angular 2.</p><h2 id=\"Angular-2-no-es-plataforma-para-aficionados\"><a href=\"#Angular-2-no-es-plataforma-para-aficionados\" class=\"headerlink\" title=\"Angular 2 no es plataforma para aficionados\"></a>Angular 2 no es plataforma para aficionados</h2><p>El resumen es que AngularJS 1.x ha mutado <strong>de framework a plataforma</strong> en Angular 2. En este sentido estar cada vez ms orientada a grandes desarrollos empresariales, y a salir definitivamente del navegador y ocupar servidores, escritorios y telfonos.</p><p>Seguro que requiere un gran esfuerzo de aprendizaje por su novedades radicales. Seguro que por el camino habr giros por su bisoez y amplitud. Pero seguro que estamos ante la <strong>plataforma de desarrollo empresarial</strong> con mejor futuro. De momento.</p><blockquote><p>En <a href=\"https://docs.google.com/presentation/d/1VyMGTwiM7HmNMdSCXrrYpHIej-Y8ZwZKCan7KMqvdCA/edit?usp=sharing\" target=\"_blank\" rel=\"external\">esta presentacin</a> tienes un resumen rpido de mis impresiones acerca de Angular2, y de cmo empezar a programar aplicaciones universales.</p></blockquote>"},{"title":"Comunicaciones http observables con Angular2","id":"17","updated":"2017-02-16T16:44:21.000Z","date":"2016-06-16T09:47:28.000Z","thumbnail":"/css/images/angular.jpg","_content":"\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/)\n\n---\nEn AngularJS, y en otros frameworks del lado cliente, la idea de fue simple desde el principio: dame **plantillas estticas y datos dinmicos**. Las comunicaciones *http* son las arterias vitales de transporte de esos datos dinmicos. Y en Angular 2 se han revisado por completo, llevando las comunicaciones asncronas al siguiente nivel.\n\n<!-- more -->\n\n### La librera http y otras...\nComo cabe esperar Angular 2 dispone de su propio mdulo de comunicaciones. En la librera `@angular/http` encontramos el nuevo servicio `http` que es el cliente usado para enviar y recibir datos.\n\nLo realmente novedoso viene de parte del proyecto [Reactive Extensions o RxJS](http://reactivex.io/rxjs/). En su librera `rxjs/Observable` exporta la clase `Observable`. Esta clase implementa el **patrn observador aplicado a streams** de datos. El equipo de Angular ha decidido adoptarlo para procesar los *streams* de entrada y salida de datos *http*.\n\nUn servicio tpico que necesite comunicaciones con el servidor importar al menos estos objetos.\n\n```typescript\n// Importar objetos de la librera http\nimport { Http, Response, RequestOptions, Headers } from '@angular/http';\n// Importar la clase Observable desde la librera rxjs\nimport { Observable }     from 'rxjs/Observable';\n```\n\nLos servicios importados han de ser **registrados como *providers* para poder ser inyectados como dependencias** antes de ser consumidos. Ya que se trata de servicios de amplio uso en cualquier aplicacin, se recomienda registrarlos en mdulos de alto nivel. De esa forma pueden ser reutilizados como *singletons*.\n\n```typescript\n// importar la constante con los proveedores de http\nimport { HttpModule, Http } from '@angular/http';\n\n@NgModule({\n  declarations: [ ],\n  imports: [\n    HttpModule, // El mdulo con todo lo necesario\n  ],\n  providers:[\n    Http, // El servicio proveedor\n  ]\n});\n```\n\nA partir de ese momento cualquier componente o servicio puede reclamar su inyeccin en el constructor, y lo podr usar en sus propios mtodos.\n```typescript\n  /**\n  * Constructor que reclama dependencias inyectables\n  * Http se encuentra por haberse registrado en este mdulo o en uno superior\n  **/\n  constructor(private http: Http) {\n     // en el constructor no debe contener lgica extra\n     // su funcin es nicamente recibir las dependencias\n  }\n```\n\n### Observables en lugar de promesas\nLa naturaleza asncrona de las comunicaciones entre maquinas se implement mediante *callbacks* en JavaScript. Esta forma de programar degenera en cdigo difcil de mantener. Con el tiempo el **patrn promesa** se impuso, y en AngularJS 1.x es la manera recomendada de programar.\n\nPero las promesas tambin tiene sus limitaciones, y ah aparecen los **observables**. Este patrn requerir un artculo para el slo, pero como adelanto se resume en lo siguiente:\n> Tratar todo tipo de informacin como un stream observable de entrada y de salida, al cual se le pueden agregar operaciones que procesan los flujos de datos.\n\nEsto encaja muy bien con las comunicaciones *http* asncronas y es la razn de su adopcin en Angular 2. Un mtodo de servicio par **leer datos REST** se parecer a este *snippet*:\n\n```typescript\n// las llamadas devuelven observables\nleerDatos(): Observable<Response> {\n  // Se declara cmo va a ser la llamada \n  // ocultando los pormenores a los consumidores   \n  return this.http\n    .get(`${this.urlBase}/recurso`);\n  // En este momento an no se efectu la llamada\n}\n```\n\nPara enviar informacin via *post* o *put* usaremos una estrategia similar, pero con unos requisitos especficos. En Angular 2 se requiere una configuracin previa de las llamadas de escritura. Es engorroso pero fcilmente automatizable. Una tpica operacin de **escritura REST** sera algo as:\n\n```typescript\n  escribirDatos(unDato): Observable<Response> {\n    // Los envos de informacin deben configurarse a mano\n    // esto es fcilmente generalizable y reutilizable\n    let body = JSON.stringify(unDato);\n    let headers = new Headers({ 'Content-Type': 'application/json' });\n    let options = new RequestOptions({ headers: headers });\n    // declarar la llamada y retornar el observable\n    // las variables de configuracin y los datos, van como parmetros\n    if (unDato._id) {\n      return this.http\n        .put(`${this.urlBase}/recurso/${unDato._id}`, body, options);\n    } else {\n      return this.http\n        .post(`${this.urlBase}/recurso`, body, options);\n    }\n  }\n```\n\n\nPor supuesto esto es lo que se programa a bajo nivel, en los **servicios de comunicaciones**. En Angular2 se mantiene la recomendacin de bajar a servicios la responsabilidad de las comunicaciones al tiempo que dejamos los componentes lo ms ligeros posible. \n\nPor encima de los servicios de comunicaciones habr otros servicios de lgica o directamente componentes. En cualquier caso, los consumidores llamarn a mtodos que siempre les devolvern objetos observables. Las clases de alto nivel se **suscribirn a esos observables** y procesarn la respuesta recibida... cuando esta est disponible.\n\n```typescript\n  // La carga de datos se hace al iniciarse el componente\n  // este es el lugar donde programar lgica de inicio\n  // nunca en el constructor\n  ngOnInit() {\n    // en el momento de la suscripcin es cuando se dispara la llamada\n    this.datosService\n      .leerDatos()\n      .subscribe(res => {\n        this.datos = res.json();\n      });\n    // Sera similar en procesos de escritura\n  }\n```\n> La clase `http` no realiza la llamada hasta que algn consumidor se suscriba a la respuesta. Mientras tanto queda como una definicin congelada.\n\nEl mtodo `.subscribe()` recibe como argumento un puntero a la respuesta *http*. Los datos se encuentran en formato *JSON* y hay que reclamarlos mediante el mtodo `.json()`\n\n### Extensiones en lugar de interceptores\nUna de las caractersticas destacables de los servicios `$http` de AngularJS 1.x era la posibilidad de usar *interceptores*. Estos eran **funciones que se incrustaban durante el envo o recepcin** de las comunicaciones.\n\nUn uso habitual era emplearlos para agregar **cabeceras de seguridad o controlar errores** de comunicacin de manera centralizada. Ahora la forma recomendable de hacer eso mismo en Angular2 es mejorar el servicio http extendindolo. El servicio derivado resultante implementar los interceptores en funciones llamadas durante la comunicacin.\n\nEsta es una posible implementacin con funcionalidad suficiente para facilitar los envos, detectar errores y enviar cabeceras de seguridad.\n```typescript\n@Injectable()\n/**\n * Extensin personalizada de la clase HTTP\n * Permite la configuracin de todas las peticiones\n * Captura los envos y respuestas\n * */\nexport class HttpService extends Http {\n  /** Las direcciones base deberan venir de la configuracin del environment*/\n  public apiProxyUrl = 'http://localhost:4030/api/';\n  private authorization = '';\n\n  constructor(\n    backend: XHRBackend,\n    defaultOptions: RequestOptions,\n    private router: Router,\n    private userStore: SessionStoreService\n  ) {\n    super(backend, defaultOptions);\n    this.subscribeToToken();\n  }\n\n  /**\n   * Reescribe el mtodo de la clase base, ejecutando acciones para cada peticin\n   * La peticin en curso puede llegar como una ruta o una clase request\n   * Si viene slo la cadena, debera traer las opciones aparte\n   * */\n  request(request: string | Request, options: RequestOptionsArgs = { headers: new Headers() }): Observable<Response> {\n    this.configureRequest(request, options);\n    return this.interceptResponse(request, options);\n  }\n\n  private subscribeToToken() {\n    // suponemos un servicio que nos avisa de la recepcin de tokens\n    this.userStore\n      .getDataObservable()\n      .subscribe((data: Session) => this.authorization = 'Bearer ' + data.token);\n  }\n\n  private configureRequest(request: string | Request, options: RequestOptionsArgs) {\n    // Adapta la ruta y asigna cabeceras\n    if (typeof request === 'string') {\n      request = this.getProxyUrl(request);\n      this.setHeaders(options);\n    } else {\n      request['url'] = this.getProxyUrl(request['url']);\n      this.setHeaders(request);\n    }\n  }\n\n  private interceptResponse(request: string | Request, options: RequestOptionsArgs) : Observable<Response> {\n    const observableRequest = super\n      .request(request, options)\n      .catch(this.onCatch())\n      .finally(this.onFinally());\n    return observableRequest;\n  }\n\n  /**\n   * Transforma la url para llamar a traves de un proxy \n   * til en caso de problemas con el CORS\n   */\n  private getProxyUrl(currentUrl) {\n    if (!currentUrl.includes('/assets/')) {\n      return this.apiProxyUrl + currentUrl;\n    } else {\n      return currentUrl;\n    }\n  }\n\n  /**\n   * Interceptor para componer las cabeceras en cada peticin\n   * */\n  private setHeaders(objectToSetHeadersTo: Request | RequestOptionsArgs) {\n    const headers = objectToSetHeadersTo.headers;\n    headers.set('Content-Type', 'application/json');\n    headers.set('Authorization', this.authorization);\n  }\n\n  /**\n   * Interceptor para captura genrica de errores http\n   * */\n  private onCatch() {\n    return (res: Response) => {\n      // Security errors\n      if (res.status === 401 || res.status === 403) {\n        // redirigir al usuario para pedir credenciales\n        this.router.navigate(['user/login']);\n      }\n      // To Do: Gestin comn de otros errores...\n      return Observable.throw(res);\n    };\n  }\n\n  private onFinally() {\n    return () => console.log('Fin');\n  }\n\n}\n```\n\n\nPodemos usarlo de manera transparente en el resto de la aplicacin. Slo se necesita ajustar el registro de proveedores para dirigir al inyector de dependencias hacia esta nueva clase.\n```typescript\n   providers: [\n    {\n      provide: Http, // reemplaza el servicio del framework\n      useClass: HttpService // con la clase personalizada que lo extiende\n    }\n  ]\n```\n\n>Este es uno de los usos ms potentes de la inversin de control en Angular. Es el programador integrador el que decide el servicio a usar. El programador funcional declara la dependencia en los constructores de sus componentes y servicios, pero no decide la instancia concreta que recibir.\n\n\nAngular 2 ha trastocado todo lo que hacamos en las versiones 1.x, pero slo en la forma. El fondo sigue siendo el mismo: **el navegador enva y recibe datos en formato JSON que mezcla con plantillas estticas** para  crear HTML en la mquina local y relajar al servidor. \n\n\nPor cierto, por ahora ni rastro del viejo `$resource`. No tardar en aparecer una versin basada en *streams observables*. Sgueme en [mi cuenta de twitter](https://twitter.com/albertobasalo) o suscrbete a la [revista mensual de Academia Binaria](http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339) y en cuanto me entere sers el primero en ser informado.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/)","source":"_posts/Comunicaciones-http-observables-con-Angular2.md","raw":"---\ntitle: Comunicaciones http observables con Angular2\ntags:  \n- Angular2\n- http\n- Tutorial\ncategories:\n- Introduccin \npermalink: comunicaciones-http-observables-con-angular2\nid: 17\nupdated: '2017-02-16 17:44:21'\ndate: 2016-06-16 11:47:28\nthumbnail: /css/images/angular.jpg\n---\n\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/)\n\n---\nEn AngularJS, y en otros frameworks del lado cliente, la idea de fue simple desde el principio: dame **plantillas estticas y datos dinmicos**. Las comunicaciones *http* son las arterias vitales de transporte de esos datos dinmicos. Y en Angular 2 se han revisado por completo, llevando las comunicaciones asncronas al siguiente nivel.\n\n<!-- more -->\n\n### La librera http y otras...\nComo cabe esperar Angular 2 dispone de su propio mdulo de comunicaciones. En la librera `@angular/http` encontramos el nuevo servicio `http` que es el cliente usado para enviar y recibir datos.\n\nLo realmente novedoso viene de parte del proyecto [Reactive Extensions o RxJS](http://reactivex.io/rxjs/). En su librera `rxjs/Observable` exporta la clase `Observable`. Esta clase implementa el **patrn observador aplicado a streams** de datos. El equipo de Angular ha decidido adoptarlo para procesar los *streams* de entrada y salida de datos *http*.\n\nUn servicio tpico que necesite comunicaciones con el servidor importar al menos estos objetos.\n\n```typescript\n// Importar objetos de la librera http\nimport { Http, Response, RequestOptions, Headers } from '@angular/http';\n// Importar la clase Observable desde la librera rxjs\nimport { Observable }     from 'rxjs/Observable';\n```\n\nLos servicios importados han de ser **registrados como *providers* para poder ser inyectados como dependencias** antes de ser consumidos. Ya que se trata de servicios de amplio uso en cualquier aplicacin, se recomienda registrarlos en mdulos de alto nivel. De esa forma pueden ser reutilizados como *singletons*.\n\n```typescript\n// importar la constante con los proveedores de http\nimport { HttpModule, Http } from '@angular/http';\n\n@NgModule({\n  declarations: [ ],\n  imports: [\n    HttpModule, // El mdulo con todo lo necesario\n  ],\n  providers:[\n    Http, // El servicio proveedor\n  ]\n});\n```\n\nA partir de ese momento cualquier componente o servicio puede reclamar su inyeccin en el constructor, y lo podr usar en sus propios mtodos.\n```typescript\n  /**\n  * Constructor que reclama dependencias inyectables\n  * Http se encuentra por haberse registrado en este mdulo o en uno superior\n  **/\n  constructor(private http: Http) {\n     // en el constructor no debe contener lgica extra\n     // su funcin es nicamente recibir las dependencias\n  }\n```\n\n### Observables en lugar de promesas\nLa naturaleza asncrona de las comunicaciones entre maquinas se implement mediante *callbacks* en JavaScript. Esta forma de programar degenera en cdigo difcil de mantener. Con el tiempo el **patrn promesa** se impuso, y en AngularJS 1.x es la manera recomendada de programar.\n\nPero las promesas tambin tiene sus limitaciones, y ah aparecen los **observables**. Este patrn requerir un artculo para el slo, pero como adelanto se resume en lo siguiente:\n> Tratar todo tipo de informacin como un stream observable de entrada y de salida, al cual se le pueden agregar operaciones que procesan los flujos de datos.\n\nEsto encaja muy bien con las comunicaciones *http* asncronas y es la razn de su adopcin en Angular 2. Un mtodo de servicio par **leer datos REST** se parecer a este *snippet*:\n\n```typescript\n// las llamadas devuelven observables\nleerDatos(): Observable<Response> {\n  // Se declara cmo va a ser la llamada \n  // ocultando los pormenores a los consumidores   \n  return this.http\n    .get(`${this.urlBase}/recurso`);\n  // En este momento an no se efectu la llamada\n}\n```\n\nPara enviar informacin via *post* o *put* usaremos una estrategia similar, pero con unos requisitos especficos. En Angular 2 se requiere una configuracin previa de las llamadas de escritura. Es engorroso pero fcilmente automatizable. Una tpica operacin de **escritura REST** sera algo as:\n\n```typescript\n  escribirDatos(unDato): Observable<Response> {\n    // Los envos de informacin deben configurarse a mano\n    // esto es fcilmente generalizable y reutilizable\n    let body = JSON.stringify(unDato);\n    let headers = new Headers({ 'Content-Type': 'application/json' });\n    let options = new RequestOptions({ headers: headers });\n    // declarar la llamada y retornar el observable\n    // las variables de configuracin y los datos, van como parmetros\n    if (unDato._id) {\n      return this.http\n        .put(`${this.urlBase}/recurso/${unDato._id}`, body, options);\n    } else {\n      return this.http\n        .post(`${this.urlBase}/recurso`, body, options);\n    }\n  }\n```\n\n\nPor supuesto esto es lo que se programa a bajo nivel, en los **servicios de comunicaciones**. En Angular2 se mantiene la recomendacin de bajar a servicios la responsabilidad de las comunicaciones al tiempo que dejamos los componentes lo ms ligeros posible. \n\nPor encima de los servicios de comunicaciones habr otros servicios de lgica o directamente componentes. En cualquier caso, los consumidores llamarn a mtodos que siempre les devolvern objetos observables. Las clases de alto nivel se **suscribirn a esos observables** y procesarn la respuesta recibida... cuando esta est disponible.\n\n```typescript\n  // La carga de datos se hace al iniciarse el componente\n  // este es el lugar donde programar lgica de inicio\n  // nunca en el constructor\n  ngOnInit() {\n    // en el momento de la suscripcin es cuando se dispara la llamada\n    this.datosService\n      .leerDatos()\n      .subscribe(res => {\n        this.datos = res.json();\n      });\n    // Sera similar en procesos de escritura\n  }\n```\n> La clase `http` no realiza la llamada hasta que algn consumidor se suscriba a la respuesta. Mientras tanto queda como una definicin congelada.\n\nEl mtodo `.subscribe()` recibe como argumento un puntero a la respuesta *http*. Los datos se encuentran en formato *JSON* y hay que reclamarlos mediante el mtodo `.json()`\n\n### Extensiones en lugar de interceptores\nUna de las caractersticas destacables de los servicios `$http` de AngularJS 1.x era la posibilidad de usar *interceptores*. Estos eran **funciones que se incrustaban durante el envo o recepcin** de las comunicaciones.\n\nUn uso habitual era emplearlos para agregar **cabeceras de seguridad o controlar errores** de comunicacin de manera centralizada. Ahora la forma recomendable de hacer eso mismo en Angular2 es mejorar el servicio http extendindolo. El servicio derivado resultante implementar los interceptores en funciones llamadas durante la comunicacin.\n\nEsta es una posible implementacin con funcionalidad suficiente para facilitar los envos, detectar errores y enviar cabeceras de seguridad.\n```typescript\n@Injectable()\n/**\n * Extensin personalizada de la clase HTTP\n * Permite la configuracin de todas las peticiones\n * Captura los envos y respuestas\n * */\nexport class HttpService extends Http {\n  /** Las direcciones base deberan venir de la configuracin del environment*/\n  public apiProxyUrl = 'http://localhost:4030/api/';\n  private authorization = '';\n\n  constructor(\n    backend: XHRBackend,\n    defaultOptions: RequestOptions,\n    private router: Router,\n    private userStore: SessionStoreService\n  ) {\n    super(backend, defaultOptions);\n    this.subscribeToToken();\n  }\n\n  /**\n   * Reescribe el mtodo de la clase base, ejecutando acciones para cada peticin\n   * La peticin en curso puede llegar como una ruta o una clase request\n   * Si viene slo la cadena, debera traer las opciones aparte\n   * */\n  request(request: string | Request, options: RequestOptionsArgs = { headers: new Headers() }): Observable<Response> {\n    this.configureRequest(request, options);\n    return this.interceptResponse(request, options);\n  }\n\n  private subscribeToToken() {\n    // suponemos un servicio que nos avisa de la recepcin de tokens\n    this.userStore\n      .getDataObservable()\n      .subscribe((data: Session) => this.authorization = 'Bearer ' + data.token);\n  }\n\n  private configureRequest(request: string | Request, options: RequestOptionsArgs) {\n    // Adapta la ruta y asigna cabeceras\n    if (typeof request === 'string') {\n      request = this.getProxyUrl(request);\n      this.setHeaders(options);\n    } else {\n      request['url'] = this.getProxyUrl(request['url']);\n      this.setHeaders(request);\n    }\n  }\n\n  private interceptResponse(request: string | Request, options: RequestOptionsArgs) : Observable<Response> {\n    const observableRequest = super\n      .request(request, options)\n      .catch(this.onCatch())\n      .finally(this.onFinally());\n    return observableRequest;\n  }\n\n  /**\n   * Transforma la url para llamar a traves de un proxy \n   * til en caso de problemas con el CORS\n   */\n  private getProxyUrl(currentUrl) {\n    if (!currentUrl.includes('/assets/')) {\n      return this.apiProxyUrl + currentUrl;\n    } else {\n      return currentUrl;\n    }\n  }\n\n  /**\n   * Interceptor para componer las cabeceras en cada peticin\n   * */\n  private setHeaders(objectToSetHeadersTo: Request | RequestOptionsArgs) {\n    const headers = objectToSetHeadersTo.headers;\n    headers.set('Content-Type', 'application/json');\n    headers.set('Authorization', this.authorization);\n  }\n\n  /**\n   * Interceptor para captura genrica de errores http\n   * */\n  private onCatch() {\n    return (res: Response) => {\n      // Security errors\n      if (res.status === 401 || res.status === 403) {\n        // redirigir al usuario para pedir credenciales\n        this.router.navigate(['user/login']);\n      }\n      // To Do: Gestin comn de otros errores...\n      return Observable.throw(res);\n    };\n  }\n\n  private onFinally() {\n    return () => console.log('Fin');\n  }\n\n}\n```\n\n\nPodemos usarlo de manera transparente en el resto de la aplicacin. Slo se necesita ajustar el registro de proveedores para dirigir al inyector de dependencias hacia esta nueva clase.\n```typescript\n   providers: [\n    {\n      provide: Http, // reemplaza el servicio del framework\n      useClass: HttpService // con la clase personalizada que lo extiende\n    }\n  ]\n```\n\n>Este es uno de los usos ms potentes de la inversin de control en Angular. Es el programador integrador el que decide el servicio a usar. El programador funcional declara la dependencia en los constructores de sus componentes y servicios, pero no decide la instancia concreta que recibir.\n\n\nAngular 2 ha trastocado todo lo que hacamos en las versiones 1.x, pero slo en la forma. El fondo sigue siendo el mismo: **el navegador enva y recibe datos en formato JSON que mezcla con plantillas estticas** para  crear HTML en la mquina local y relajar al servidor. \n\n\nPor cierto, por ahora ni rastro del viejo `$resource`. No tardar en aparecer una versin basada en *streams observables*. Sgueme en [mi cuenta de twitter](https://twitter.com/albertobasalo) o suscrbete a la [revista mensual de Academia Binaria](http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339) y en cuanto me entere sers el primero en ser informado.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/)","slug":"comunicaciones-http-observables-con-angular2","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvf6000ciwd3yh7x0xku","content":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a></p></blockquote><hr><p>En AngularJS, y en otros frameworks del lado cliente, la idea de fue simple desde el principio: dame <strong>plantillas estticas y datos dinmicos</strong>. Las comunicaciones <em>http</em> son las arterias vitales de transporte de esos datos dinmicos. Y en Angular 2 se han revisado por completo, llevando las comunicaciones asncronas al siguiente nivel.</p><a id=\"more\"></a><h3 id=\"La-libreria-http-y-otras\"><a href=\"#La-libreria-http-y-otras\" class=\"headerlink\" title=\"La librera http y otras\"></a>La librera http y otras</h3><p>Como cabe esperar Angular 2 dispone de su propio mdulo de comunicaciones. En la librera <code>@angular/http</code> encontramos el nuevo servicio <code>http</code> que es el cliente usado para enviar y recibir datos.</p><p>Lo realmente novedoso viene de parte del proyecto <a href=\"http://reactivex.io/rxjs/\" target=\"_blank\" rel=\"external\">Reactive Extensions o RxJS</a>. En su librera <code>rxjs/Observable</code> exporta la clase <code>Observable</code>. Esta clase implementa el <strong>patrn observador aplicado a streams</strong> de datos. El equipo de Angular ha decidido adoptarlo para procesar los <em>streams</em> de entrada y salida de datos <em>http</em>.</p><p>Un servicio tpico que necesite comunicaciones con el servidor importar al menos estos objetos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// Importar objetos de la librera http</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; Http, Response, RequestOptions, Headers &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/http'</span>;</div><div class=\"line\"><span class=\"comment\">// Importar la clase Observable desde la librera rxjs</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; Observable &#125;     <span class=\"keyword\">from</span> <span class=\"string\">'rxjs/Observable'</span>;</div></pre></td></tr></table></figure><p>Los servicios importados han de ser <strong>registrados como <em>providers</em> para poder ser inyectados como dependencias</strong> antes de ser consumidos. Ya que se trata de servicios de amplio uso en cualquier aplicacin, se recomienda registrarlos en mdulos de alto nivel. De esa forma pueden ser reutilizados como <em>singletons</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// importar la constante con los proveedores de http</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; HttpModule, Http &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/http'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</div><div class=\"line\">  declarations: [ ],</div><div class=\"line\">  imports: [</div><div class=\"line\">    HttpModule, <span class=\"comment\">// El mdulo con todo lo necesario</span></div><div class=\"line\">  ],</div><div class=\"line\">  providers:[</div><div class=\"line\">    Http, <span class=\"comment\">// El servicio proveedor</span></div><div class=\"line\">  ]</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure><p>A partir de ese momento cualquier componente o servicio puede reclamar su inyeccin en el constructor, y lo podr usar en sus propios mtodos.<br></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">* Constructor que reclama dependencias inyectables</span></div><div class=\"line\"><span class=\"comment\">* Http se encuentra por haberse registrado en este mdulo o en uno superior</span></div><div class=\"line\"><span class=\"comment\">**/</span></div><div class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> http: Http</span>) &#123;</div><div class=\"line\">   <span class=\"comment\">// en el constructor no debe contener lgica extra</span></div><div class=\"line\">   <span class=\"comment\">// su funcin es nicamente recibir las dependencias</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p></p><h3 id=\"Observables-en-lugar-de-promesas\"><a href=\"#Observables-en-lugar-de-promesas\" class=\"headerlink\" title=\"Observables en lugar de promesas\"></a>Observables en lugar de promesas</h3><p>La naturaleza asncrona de las comunicaciones entre maquinas se implement mediante <em>callbacks</em> en JavaScript. Esta forma de programar degenera en cdigo difcil de mantener. Con el tiempo el <strong>patrn promesa</strong> se impuso, y en AngularJS 1.x es la manera recomendada de programar.</p><p>Pero las promesas tambin tiene sus limitaciones, y ah aparecen los <strong>observables</strong>. Este patrn requerir un artculo para el slo, pero como adelanto se resume en lo siguiente:</p><blockquote><p>Tratar todo tipo de informacin como un stream observable de entrada y de salida, al cual se le pueden agregar operaciones que procesan los flujos de datos.</p></blockquote><p>Esto encaja muy bien con las comunicaciones <em>http</em> asncronas y es la razn de su adopcin en Angular 2. Un mtodo de servicio par <strong>leer datos REST</strong> se parecer a este <em>snippet</em>:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// las llamadas devuelven observables</span></div><div class=\"line\">leerDatos(): Observable&lt;Response&gt; &#123;</div><div class=\"line\">  <span class=\"comment\">// Se declara cmo va a ser la llamada </span></div><div class=\"line\">  <span class=\"comment\">// ocultando los pormenores a los consumidores   </span></div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.http</div><div class=\"line\">    .get(<span class=\"string\">`<span class=\"subst\">$&#123;this.urlBase&#125;</span>/recurso`</span>);</div><div class=\"line\">  <span class=\"comment\">// En este momento an no se efectu la llamada</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p>Para enviar informacin via <em>post</em> o <em>put</em> usaremos una estrategia similar, pero con unos requisitos especficos. En Angular 2 se requiere una configuracin previa de las llamadas de escritura. Es engorroso pero fcilmente automatizable. Una tpica operacin de <strong>escritura REST</strong> sera algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">escribirDatos(unDato): Observable&lt;Response&gt; &#123;</div><div class=\"line\">  <span class=\"comment\">// Los envos de informacin deben configurarse a mano</span></div><div class=\"line\">  <span class=\"comment\">// esto es fcilmente generalizable y reutilizable</span></div><div class=\"line\">  <span class=\"keyword\">let</span> body = <span class=\"built_in\">JSON</span>.stringify(unDato);</div><div class=\"line\">  <span class=\"keyword\">let</span> headers = <span class=\"keyword\">new</span> Headers(&#123; <span class=\"string\">'Content-Type'</span>: <span class=\"string\">'application/json'</span> &#125;);</div><div class=\"line\">  <span class=\"keyword\">let</span> options = <span class=\"keyword\">new</span> RequestOptions(&#123; headers: headers &#125;);</div><div class=\"line\">  <span class=\"comment\">// declarar la llamada y retornar el observable</span></div><div class=\"line\">  <span class=\"comment\">// las variables de configuracin y los datos, van como parmetros</span></div><div class=\"line\">  <span class=\"keyword\">if</span> (unDato._id) &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.http</div><div class=\"line\">      .put(<span class=\"string\">`<span class=\"subst\">$&#123;this.urlBase&#125;</span>/recurso/<span class=\"subst\">$&#123;unDato._id&#125;</span>`</span>, body, options);</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.http</div><div class=\"line\">      .post(<span class=\"string\">`<span class=\"subst\">$&#123;this.urlBase&#125;</span>/recurso`</span>, body, options);</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p>Por supuesto esto es lo que se programa a bajo nivel, en los <strong>servicios de comunicaciones</strong>. En Angular2 se mantiene la recomendacin de bajar a servicios la responsabilidad de las comunicaciones al tiempo que dejamos los componentes lo ms ligeros posible.</p><p>Por encima de los servicios de comunicaciones habr otros servicios de lgica o directamente componentes. En cualquier caso, los consumidores llamarn a mtodos que siempre les devolvern objetos observables. Las clases de alto nivel se <strong>suscribirn a esos observables</strong> y procesarn la respuesta recibida cuando esta est disponible.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// La carga de datos se hace al iniciarse el componente</span></div><div class=\"line\"><span class=\"comment\">// este es el lugar donde programar lgica de inicio</span></div><div class=\"line\"><span class=\"comment\">// nunca en el constructor</span></div><div class=\"line\">ngOnInit() &#123;</div><div class=\"line\">  <span class=\"comment\">// en el momento de la suscripcin es cuando se dispara la llamada</span></div><div class=\"line\">  <span class=\"keyword\">this</span>.datosService</div><div class=\"line\">    .leerDatos()</div><div class=\"line\">    .subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</div><div class=\"line\">      <span class=\"keyword\">this</span>.datos = res.json();</div><div class=\"line\">    &#125;);</div><div class=\"line\">  <span class=\"comment\">// Sera similar en procesos de escritura</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><blockquote><p>La clase <code>http</code> no realiza la llamada hasta que algn consumidor se suscriba a la respuesta. Mientras tanto queda como una definicin congelada.</p></blockquote><p>El mtodo <code>.subscribe()</code> recibe como argumento un puntero a la respuesta <em>http</em>. Los datos se encuentran en formato <em>JSON</em> y hay que reclamarlos mediante el mtodo <code>.json()</code></p><h3 id=\"Extensiones-en-lugar-de-interceptores\"><a href=\"#Extensiones-en-lugar-de-interceptores\" class=\"headerlink\" title=\"Extensiones en lugar de interceptores\"></a>Extensiones en lugar de interceptores</h3><p>Una de las caractersticas destacables de los servicios <code>$http</code> de AngularJS 1.x era la posibilidad de usar <em>interceptores</em>. Estos eran <strong>funciones que se incrustaban durante el envo o recepcin</strong> de las comunicaciones.</p><p>Un uso habitual era emplearlos para agregar <strong>cabeceras de seguridad o controlar errores</strong> de comunicacin de manera centralizada. Ahora la forma recomendable de hacer eso mismo en Angular2 es mejorar el servicio http extendindolo. El servicio derivado resultante implementar los interceptores en funciones llamadas durante la comunicacin.</p><p>Esta es una posible implementacin con funcionalidad suficiente para facilitar los envos, detectar errores y enviar cabeceras de seguridad.<br></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Injectable</span>()</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\"> * Extensin personalizada de la clase HTTP</span></div><div class=\"line\"><span class=\"comment\"> * Permite la configuracin de todas las peticiones</span></div><div class=\"line\"><span class=\"comment\"> * Captura los envos y respuestas</span></div><div class=\"line\"><span class=\"comment\"> * */</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> HttpService <span class=\"keyword\">extends</span> Http &#123;</div><div class=\"line\">  <span class=\"comment\">/** Las direcciones base deberan venir de la configuracin del environment*/</span></div><div class=\"line\">  <span class=\"keyword\">public</span> apiProxyUrl = <span class=\"string\">'http://localhost:4030/api/'</span>;</div><div class=\"line\">  <span class=\"keyword\">private</span> authorization = <span class=\"string\">''</span>;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span></div><div class=\"line\"><span class=\"params\">    backend: XHRBackend,</span></div><div class=\"line\"><span class=\"params\">    defaultOptions: RequestOptions,</span></div><div class=\"line\"><span class=\"params\">    <span class=\"keyword\">private</span> router: Router,</span></div><div class=\"line\"><span class=\"params\">    <span class=\"keyword\">private</span> userStore: SessionStoreService</span></div><div class=\"line\"><span class=\"params\">  </span>) &#123;</div><div class=\"line\">    <span class=\"keyword\">super</span>(backend, defaultOptions);</div><div class=\"line\">    <span class=\"keyword\">this</span>.subscribeToToken();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">   * Reescribe el mtodo de la clase base, ejecutando acciones para cada peticin</span></div><div class=\"line\"><span class=\"comment\">   * La peticin en curso puede llegar como una ruta o una clase request</span></div><div class=\"line\"><span class=\"comment\">   * Si viene slo la cadena, debera traer las opciones aparte</span></div><div class=\"line\"><span class=\"comment\">   * */</span></div><div class=\"line\">  request(request: <span class=\"built_in\">string</span> | Request, options: RequestOptionsArgs = &#123; headers: <span class=\"keyword\">new</span> Headers() &#125;): Observable&lt;Response&gt; &#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.configureRequest(request, options);</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.interceptResponse(request, options);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">private</span> subscribeToToken() &#123;</div><div class=\"line\">    <span class=\"comment\">// suponemos un servicio que nos avisa de la recepcin de tokens</span></div><div class=\"line\">    <span class=\"keyword\">this</span>.userStore</div><div class=\"line\">      .getDataObservable()</div><div class=\"line\">      .subscribe(<span class=\"function\">(<span class=\"params\">data: Session</span>) =&gt;</span> <span class=\"keyword\">this</span>.authorization = <span class=\"string\">'Bearer '</span> + data.token);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">private</span> configureRequest(request: <span class=\"built_in\">string</span> | Request, options: RequestOptionsArgs) &#123;</div><div class=\"line\">    <span class=\"comment\">// Adapta la ruta y asigna cabeceras</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> request === <span class=\"string\">'string'</span>) &#123;</div><div class=\"line\">      request = <span class=\"keyword\">this</span>.getProxyUrl(request);</div><div class=\"line\">      <span class=\"keyword\">this</span>.setHeaders(options);</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">      request[<span class=\"string\">'url'</span>] = <span class=\"keyword\">this</span>.getProxyUrl(request[<span class=\"string\">'url'</span>]);</div><div class=\"line\">      <span class=\"keyword\">this</span>.setHeaders(request);</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">private</span> interceptResponse(request: <span class=\"built_in\">string</span> | Request, options: RequestOptionsArgs) : Observable&lt;Response&gt; &#123;</div><div class=\"line\">    <span class=\"keyword\">const</span> observableRequest = <span class=\"keyword\">super</span></div><div class=\"line\">      .request(request, options)</div><div class=\"line\">      .catch(<span class=\"keyword\">this</span>.onCatch())</div><div class=\"line\">      .finally(<span class=\"keyword\">this</span>.onFinally());</div><div class=\"line\">    <span class=\"keyword\">return</span> observableRequest;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">   * Transforma la url para llamar a traves de un proxy </span></div><div class=\"line\"><span class=\"comment\">   * til en caso de problemas con el CORS</span></div><div class=\"line\"><span class=\"comment\">   */</span></div><div class=\"line\">  <span class=\"keyword\">private</span> getProxyUrl(currentUrl) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (!currentUrl.includes(<span class=\"string\">'/assets/'</span>)) &#123;</div><div class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.apiProxyUrl + currentUrl;</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">      <span class=\"keyword\">return</span> currentUrl;</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">   * Interceptor para componer las cabeceras en cada peticin</span></div><div class=\"line\"><span class=\"comment\">   * */</span></div><div class=\"line\">  <span class=\"keyword\">private</span> setHeaders(objectToSetHeadersTo: Request | RequestOptionsArgs) &#123;</div><div class=\"line\">    <span class=\"keyword\">const</span> headers = objectToSetHeadersTo.headers;</div><div class=\"line\">    headers.set(<span class=\"string\">'Content-Type'</span>, <span class=\"string\">'application/json'</span>);</div><div class=\"line\">    headers.set(<span class=\"string\">'Authorization'</span>, <span class=\"keyword\">this</span>.authorization);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">   * Interceptor para captura genrica de errores http</span></div><div class=\"line\"><span class=\"comment\">   * */</span></div><div class=\"line\">  <span class=\"keyword\">private</span> onCatch() &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">res: Response</span>) =&gt;</span> &#123;</div><div class=\"line\">      <span class=\"comment\">// Security errors</span></div><div class=\"line\">      <span class=\"keyword\">if</span> (res.status === <span class=\"number\">401</span> || res.status === <span class=\"number\">403</span>) &#123;</div><div class=\"line\">        <span class=\"comment\">// redirigir al usuario para pedir credenciales</span></div><div class=\"line\">        <span class=\"keyword\">this</span>.router.navigate([<span class=\"string\">'user/login'</span>]);</div><div class=\"line\">      &#125;</div><div class=\"line\">      <span class=\"comment\">// To Do: Gestin comn de otros errores...</span></div><div class=\"line\">      <span class=\"keyword\">return</span> Observable.throw(res);</div><div class=\"line\">    &#125;;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">private</span> onFinally() &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">'Fin'</span>);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p></p><p>Podemos usarlo de manera transparente en el resto de la aplicacin. Slo se necesita ajustar el registro de proveedores para dirigir al inyector de dependencias hacia esta nueva clase.<br></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"> providers: [</div><div class=\"line\">  &#123;</div><div class=\"line\">    provide: Http, <span class=\"comment\">// reemplaza el servicio del framework</span></div><div class=\"line\">    useClass: HttpService <span class=\"comment\">// con la clase personalizada que lo extiende</span></div><div class=\"line\">  &#125;</div><div class=\"line\">]</div></pre></td></tr></table></figure><p></p><blockquote><p>Este es uno de los usos ms potentes de la inversin de control en Angular. Es el programador integrador el que decide el servicio a usar. El programador funcional declara la dependencia en los constructores de sus componentes y servicios, pero no decide la instancia concreta que recibir.</p></blockquote><p>Angular 2 ha trastocado todo lo que hacamos en las versiones 1.x, pero slo en la forma. El fondo sigue siendo el mismo: <strong>el navegador enva y recibe datos en formato JSON que mezcla con plantillas estticas</strong> para crear HTML en la mquina local y relajar al servidor.</p><p>Por cierto, por ahora ni rastro del viejo <code>$resource</code>. No tardar en aparecer una versin basada en <em>streams observables</em>. Sgueme en <a href=\"https://twitter.com/albertobasalo\" target=\"_blank\" rel=\"external\">mi cuenta de twitter</a> o suscrbete a la <a href=\"http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339\" target=\"_blank\" rel=\"external\">revista mensual de Academia Binaria</a> y en cuanto me entere sers el primero en ser informado.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a></p>","site":{"data":{}},"excerpt":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a></p></blockquote><hr><p>En AngularJS, y en otros frameworks del lado cliente, la idea de fue simple desde el principio: dame <strong>plantillas estticas y datos dinmicos</strong>. Las comunicaciones <em>http</em> son las arterias vitales de transporte de esos datos dinmicos. Y en Angular 2 se han revisado por completo, llevando las comunicaciones asncronas al siguiente nivel.</p>","more":"<h3 id=\"La-libreria-http-y-otras\"><a href=\"#La-libreria-http-y-otras\" class=\"headerlink\" title=\"La librera http y otras\"></a>La librera http y otras</h3><p>Como cabe esperar Angular 2 dispone de su propio mdulo de comunicaciones. En la librera <code>@angular/http</code> encontramos el nuevo servicio <code>http</code> que es el cliente usado para enviar y recibir datos.</p><p>Lo realmente novedoso viene de parte del proyecto <a href=\"http://reactivex.io/rxjs/\" target=\"_blank\" rel=\"external\">Reactive Extensions o RxJS</a>. En su librera <code>rxjs/Observable</code> exporta la clase <code>Observable</code>. Esta clase implementa el <strong>patrn observador aplicado a streams</strong> de datos. El equipo de Angular ha decidido adoptarlo para procesar los <em>streams</em> de entrada y salida de datos <em>http</em>.</p><p>Un servicio tpico que necesite comunicaciones con el servidor importar al menos estos objetos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// Importar objetos de la librera http</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; Http, Response, RequestOptions, Headers &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/http'</span>;</div><div class=\"line\"><span class=\"comment\">// Importar la clase Observable desde la librera rxjs</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; Observable &#125;     <span class=\"keyword\">from</span> <span class=\"string\">'rxjs/Observable'</span>;</div></pre></td></tr></table></figure><p>Los servicios importados han de ser <strong>registrados como <em>providers</em> para poder ser inyectados como dependencias</strong> antes de ser consumidos. Ya que se trata de servicios de amplio uso en cualquier aplicacin, se recomienda registrarlos en mdulos de alto nivel. De esa forma pueden ser reutilizados como <em>singletons</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// importar la constante con los proveedores de http</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; HttpModule, Http &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/http'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</div><div class=\"line\">  declarations: [ ],</div><div class=\"line\">  imports: [</div><div class=\"line\">    HttpModule, <span class=\"comment\">// El mdulo con todo lo necesario</span></div><div class=\"line\">  ],</div><div class=\"line\">  providers:[</div><div class=\"line\">    Http, <span class=\"comment\">// El servicio proveedor</span></div><div class=\"line\">  ]</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure><p>A partir de ese momento cualquier componente o servicio puede reclamar su inyeccin en el constructor, y lo podr usar en sus propios mtodos.<br></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">* Constructor que reclama dependencias inyectables</span></div><div class=\"line\"><span class=\"comment\">* Http se encuentra por haberse registrado en este mdulo o en uno superior</span></div><div class=\"line\"><span class=\"comment\">**/</span></div><div class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> http: Http</span>) &#123;</div><div class=\"line\">   <span class=\"comment\">// en el constructor no debe contener lgica extra</span></div><div class=\"line\">   <span class=\"comment\">// su funcin es nicamente recibir las dependencias</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p></p><h3 id=\"Observables-en-lugar-de-promesas\"><a href=\"#Observables-en-lugar-de-promesas\" class=\"headerlink\" title=\"Observables en lugar de promesas\"></a>Observables en lugar de promesas</h3><p>La naturaleza asncrona de las comunicaciones entre maquinas se implement mediante <em>callbacks</em> en JavaScript. Esta forma de programar degenera en cdigo difcil de mantener. Con el tiempo el <strong>patrn promesa</strong> se impuso, y en AngularJS 1.x es la manera recomendada de programar.</p><p>Pero las promesas tambin tiene sus limitaciones, y ah aparecen los <strong>observables</strong>. Este patrn requerir un artculo para el slo, pero como adelanto se resume en lo siguiente:</p><blockquote><p>Tratar todo tipo de informacin como un stream observable de entrada y de salida, al cual se le pueden agregar operaciones que procesan los flujos de datos.</p></blockquote><p>Esto encaja muy bien con las comunicaciones <em>http</em> asncronas y es la razn de su adopcin en Angular 2. Un mtodo de servicio par <strong>leer datos REST</strong> se parecer a este <em>snippet</em>:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// las llamadas devuelven observables</span></div><div class=\"line\">leerDatos(): Observable&lt;Response&gt; &#123;</div><div class=\"line\">  <span class=\"comment\">// Se declara cmo va a ser la llamada </span></div><div class=\"line\">  <span class=\"comment\">// ocultando los pormenores a los consumidores   </span></div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.http</div><div class=\"line\">    .get(<span class=\"string\">`<span class=\"subst\">$&#123;this.urlBase&#125;</span>/recurso`</span>);</div><div class=\"line\">  <span class=\"comment\">// En este momento an no se efectu la llamada</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p>Para enviar informacin via <em>post</em> o <em>put</em> usaremos una estrategia similar, pero con unos requisitos especficos. En Angular 2 se requiere una configuracin previa de las llamadas de escritura. Es engorroso pero fcilmente automatizable. Una tpica operacin de <strong>escritura REST</strong> sera algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">escribirDatos(unDato): Observable&lt;Response&gt; &#123;</div><div class=\"line\">  <span class=\"comment\">// Los envos de informacin deben configurarse a mano</span></div><div class=\"line\">  <span class=\"comment\">// esto es fcilmente generalizable y reutilizable</span></div><div class=\"line\">  <span class=\"keyword\">let</span> body = <span class=\"built_in\">JSON</span>.stringify(unDato);</div><div class=\"line\">  <span class=\"keyword\">let</span> headers = <span class=\"keyword\">new</span> Headers(&#123; <span class=\"string\">'Content-Type'</span>: <span class=\"string\">'application/json'</span> &#125;);</div><div class=\"line\">  <span class=\"keyword\">let</span> options = <span class=\"keyword\">new</span> RequestOptions(&#123; headers: headers &#125;);</div><div class=\"line\">  <span class=\"comment\">// declarar la llamada y retornar el observable</span></div><div class=\"line\">  <span class=\"comment\">// las variables de configuracin y los datos, van como parmetros</span></div><div class=\"line\">  <span class=\"keyword\">if</span> (unDato._id) &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.http</div><div class=\"line\">      .put(<span class=\"string\">`<span class=\"subst\">$&#123;this.urlBase&#125;</span>/recurso/<span class=\"subst\">$&#123;unDato._id&#125;</span>`</span>, body, options);</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.http</div><div class=\"line\">      .post(<span class=\"string\">`<span class=\"subst\">$&#123;this.urlBase&#125;</span>/recurso`</span>, body, options);</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p>Por supuesto esto es lo que se programa a bajo nivel, en los <strong>servicios de comunicaciones</strong>. En Angular2 se mantiene la recomendacin de bajar a servicios la responsabilidad de las comunicaciones al tiempo que dejamos los componentes lo ms ligeros posible.</p><p>Por encima de los servicios de comunicaciones habr otros servicios de lgica o directamente componentes. En cualquier caso, los consumidores llamarn a mtodos que siempre les devolvern objetos observables. Las clases de alto nivel se <strong>suscribirn a esos observables</strong> y procesarn la respuesta recibida cuando esta est disponible.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// La carga de datos se hace al iniciarse el componente</span></div><div class=\"line\"><span class=\"comment\">// este es el lugar donde programar lgica de inicio</span></div><div class=\"line\"><span class=\"comment\">// nunca en el constructor</span></div><div class=\"line\">ngOnInit() &#123;</div><div class=\"line\">  <span class=\"comment\">// en el momento de la suscripcin es cuando se dispara la llamada</span></div><div class=\"line\">  <span class=\"keyword\">this</span>.datosService</div><div class=\"line\">    .leerDatos()</div><div class=\"line\">    .subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</div><div class=\"line\">      <span class=\"keyword\">this</span>.datos = res.json();</div><div class=\"line\">    &#125;);</div><div class=\"line\">  <span class=\"comment\">// Sera similar en procesos de escritura</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><blockquote><p>La clase <code>http</code> no realiza la llamada hasta que algn consumidor se suscriba a la respuesta. Mientras tanto queda como una definicin congelada.</p></blockquote><p>El mtodo <code>.subscribe()</code> recibe como argumento un puntero a la respuesta <em>http</em>. Los datos se encuentran en formato <em>JSON</em> y hay que reclamarlos mediante el mtodo <code>.json()</code></p><h3 id=\"Extensiones-en-lugar-de-interceptores\"><a href=\"#Extensiones-en-lugar-de-interceptores\" class=\"headerlink\" title=\"Extensiones en lugar de interceptores\"></a>Extensiones en lugar de interceptores</h3><p>Una de las caractersticas destacables de los servicios <code>$http</code> de AngularJS 1.x era la posibilidad de usar <em>interceptores</em>. Estos eran <strong>funciones que se incrustaban durante el envo o recepcin</strong> de las comunicaciones.</p><p>Un uso habitual era emplearlos para agregar <strong>cabeceras de seguridad o controlar errores</strong> de comunicacin de manera centralizada. Ahora la forma recomendable de hacer eso mismo en Angular2 es mejorar el servicio http extendindolo. El servicio derivado resultante implementar los interceptores en funciones llamadas durante la comunicacin.</p><p>Esta es una posible implementacin con funcionalidad suficiente para facilitar los envos, detectar errores y enviar cabeceras de seguridad.<br></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Injectable</span>()</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\"> * Extensin personalizada de la clase HTTP</span></div><div class=\"line\"><span class=\"comment\"> * Permite la configuracin de todas las peticiones</span></div><div class=\"line\"><span class=\"comment\"> * Captura los envos y respuestas</span></div><div class=\"line\"><span class=\"comment\"> * */</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> HttpService <span class=\"keyword\">extends</span> Http &#123;</div><div class=\"line\">  <span class=\"comment\">/** Las direcciones base deberan venir de la configuracin del environment*/</span></div><div class=\"line\">  <span class=\"keyword\">public</span> apiProxyUrl = <span class=\"string\">'http://localhost:4030/api/'</span>;</div><div class=\"line\">  <span class=\"keyword\">private</span> authorization = <span class=\"string\">''</span>;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span></div><div class=\"line\"><span class=\"params\">    backend: XHRBackend,</span></div><div class=\"line\"><span class=\"params\">    defaultOptions: RequestOptions,</span></div><div class=\"line\"><span class=\"params\">    <span class=\"keyword\">private</span> router: Router,</span></div><div class=\"line\"><span class=\"params\">    <span class=\"keyword\">private</span> userStore: SessionStoreService</span></div><div class=\"line\"><span class=\"params\">  </span>) &#123;</div><div class=\"line\">    <span class=\"keyword\">super</span>(backend, defaultOptions);</div><div class=\"line\">    <span class=\"keyword\">this</span>.subscribeToToken();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">   * Reescribe el mtodo de la clase base, ejecutando acciones para cada peticin</span></div><div class=\"line\"><span class=\"comment\">   * La peticin en curso puede llegar como una ruta o una clase request</span></div><div class=\"line\"><span class=\"comment\">   * Si viene slo la cadena, debera traer las opciones aparte</span></div><div class=\"line\"><span class=\"comment\">   * */</span></div><div class=\"line\">  request(request: <span class=\"built_in\">string</span> | Request, options: RequestOptionsArgs = &#123; headers: <span class=\"keyword\">new</span> Headers() &#125;): Observable&lt;Response&gt; &#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.configureRequest(request, options);</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.interceptResponse(request, options);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">private</span> subscribeToToken() &#123;</div><div class=\"line\">    <span class=\"comment\">// suponemos un servicio que nos avisa de la recepcin de tokens</span></div><div class=\"line\">    <span class=\"keyword\">this</span>.userStore</div><div class=\"line\">      .getDataObservable()</div><div class=\"line\">      .subscribe(<span class=\"function\">(<span class=\"params\">data: Session</span>) =&gt;</span> <span class=\"keyword\">this</span>.authorization = <span class=\"string\">'Bearer '</span> + data.token);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">private</span> configureRequest(request: <span class=\"built_in\">string</span> | Request, options: RequestOptionsArgs) &#123;</div><div class=\"line\">    <span class=\"comment\">// Adapta la ruta y asigna cabeceras</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> request === <span class=\"string\">'string'</span>) &#123;</div><div class=\"line\">      request = <span class=\"keyword\">this</span>.getProxyUrl(request);</div><div class=\"line\">      <span class=\"keyword\">this</span>.setHeaders(options);</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">      request[<span class=\"string\">'url'</span>] = <span class=\"keyword\">this</span>.getProxyUrl(request[<span class=\"string\">'url'</span>]);</div><div class=\"line\">      <span class=\"keyword\">this</span>.setHeaders(request);</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">private</span> interceptResponse(request: <span class=\"built_in\">string</span> | Request, options: RequestOptionsArgs) : Observable&lt;Response&gt; &#123;</div><div class=\"line\">    <span class=\"keyword\">const</span> observableRequest = <span class=\"keyword\">super</span></div><div class=\"line\">      .request(request, options)</div><div class=\"line\">      .catch(<span class=\"keyword\">this</span>.onCatch())</div><div class=\"line\">      .finally(<span class=\"keyword\">this</span>.onFinally());</div><div class=\"line\">    <span class=\"keyword\">return</span> observableRequest;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">   * Transforma la url para llamar a traves de un proxy </span></div><div class=\"line\"><span class=\"comment\">   * til en caso de problemas con el CORS</span></div><div class=\"line\"><span class=\"comment\">   */</span></div><div class=\"line\">  <span class=\"keyword\">private</span> getProxyUrl(currentUrl) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (!currentUrl.includes(<span class=\"string\">'/assets/'</span>)) &#123;</div><div class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.apiProxyUrl + currentUrl;</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">      <span class=\"keyword\">return</span> currentUrl;</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">   * Interceptor para componer las cabeceras en cada peticin</span></div><div class=\"line\"><span class=\"comment\">   * */</span></div><div class=\"line\">  <span class=\"keyword\">private</span> setHeaders(objectToSetHeadersTo: Request | RequestOptionsArgs) &#123;</div><div class=\"line\">    <span class=\"keyword\">const</span> headers = objectToSetHeadersTo.headers;</div><div class=\"line\">    headers.set(<span class=\"string\">'Content-Type'</span>, <span class=\"string\">'application/json'</span>);</div><div class=\"line\">    headers.set(<span class=\"string\">'Authorization'</span>, <span class=\"keyword\">this</span>.authorization);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">   * Interceptor para captura genrica de errores http</span></div><div class=\"line\"><span class=\"comment\">   * */</span></div><div class=\"line\">  <span class=\"keyword\">private</span> onCatch() &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">res: Response</span>) =&gt;</span> &#123;</div><div class=\"line\">      <span class=\"comment\">// Security errors</span></div><div class=\"line\">      <span class=\"keyword\">if</span> (res.status === <span class=\"number\">401</span> || res.status === <span class=\"number\">403</span>) &#123;</div><div class=\"line\">        <span class=\"comment\">// redirigir al usuario para pedir credenciales</span></div><div class=\"line\">        <span class=\"keyword\">this</span>.router.navigate([<span class=\"string\">'user/login'</span>]);</div><div class=\"line\">      &#125;</div><div class=\"line\">      <span class=\"comment\">// To Do: Gestin comn de otros errores...</span></div><div class=\"line\">      <span class=\"keyword\">return</span> Observable.throw(res);</div><div class=\"line\">    &#125;;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">private</span> onFinally() &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"built_in\">console</span>.log(<span class=\"string\">'Fin'</span>);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p></p><p>Podemos usarlo de manera transparente en el resto de la aplicacin. Slo se necesita ajustar el registro de proveedores para dirigir al inyector de dependencias hacia esta nueva clase.<br></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"> providers: [</div><div class=\"line\">  &#123;</div><div class=\"line\">    provide: Http, <span class=\"comment\">// reemplaza el servicio del framework</span></div><div class=\"line\">    useClass: HttpService <span class=\"comment\">// con la clase personalizada que lo extiende</span></div><div class=\"line\">  &#125;</div><div class=\"line\">]</div></pre></td></tr></table></figure><p></p><blockquote><p>Este es uno de los usos ms potentes de la inversin de control en Angular. Es el programador integrador el que decide el servicio a usar. El programador funcional declara la dependencia en los constructores de sus componentes y servicios, pero no decide la instancia concreta que recibir.</p></blockquote><p>Angular 2 ha trastocado todo lo que hacamos en las versiones 1.x, pero slo en la forma. El fondo sigue siendo el mismo: <strong>el navegador enva y recibe datos en formato JSON que mezcla con plantillas estticas</strong> para crear HTML en la mquina local y relajar al servidor.</p><p>Por cierto, por ahora ni rastro del viejo <code>$resource</code>. No tardar en aparecer una versin basada en <em>streams observables</em>. Sgueme en <a href=\"https://twitter.com/albertobasalo\" target=\"_blank\" rel=\"external\">mi cuenta de twitter</a> o suscrbete a la <a href=\"http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339\" target=\"_blank\" rel=\"external\">revista mensual de Academia Binaria</a> y en cuanto me entere sers el primero en ser informado.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a></p>"},{"title":"DataBinding el flujo de datos de Angular2","id":"13","updated":"2016-11-10T13:56:46.000Z","date":"2016-05-25T15:26:32.000Z","_content":"\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/)\n\n---\n\n> Cdigo asociado en [angular2/3-databinding/](https://github.com/AcademiaBinaria/angular2/tree/master/3-databinding) \n\nEl *doble binding* o enlace vista controlador en ambos sentidos es una de las claves del xito de AngularJS. Usando la clebre directiva `ng-model` enganchamos **una propiedad del modelo con un control de la vista**. De manera *automgica* Angular se suscribe a cambios en el DOM y observa el estado del modelo mantenindolos en sincrona. \n\nPero esto tiene un coste en rendimiento que Angular2 supera con un patrn distinto para el control del **flujo de datos** entre la vista y el modelo. Este nuevo paradigma ofrece soluciones para distintos escenarios:\n\n![Flujo de datos](/images/ng2-Flujo-de-datos.jpg)\n\n<!-- more -->\n\n## Slo lectura: modelo hacia la vista\n### 1- Interpolacin\nEn este primer caso todo nos resultar muy familiar. En efecto la sintxis de interpolacin es la mismoa que en AngularJS 1.x. eso si, en este caso y por defecto, los datos son de slo lectura y Angular no se preocupa de actualizar la variable.\n```html\n     <p>Hola {{nombreDelProgramador}} bienvenido a Angular2</p>\n     <p>Fecha de nacimiento: {{fechaDeNacimiento | date}}</p>\n```\n### 2- Enlace a propiedades\nEs la comunicacin bsica hacia la vista, hacia el usuario. En este caso cualquier atributo de un elemento HTML puede enlazarse al valor de una propiedad encerrndola entre corchetes y asignndole una expresin. `[propiedad]=\"expresion\"`\n```html\n     <p>Hola <input [value]=\"nombreDelProgramador\" readonly ></input> bienvenido a Angular2</p>\n     <a [href]=\"url-academia-binaria\">Academia Binaria</a>\n     <div [hidden]=\"usuarioAutenticado\">Identifcate</div>     \n     <div [hidden]=\"!usuarioAutenticado\">Hola {{nombreUsuario}}</div>\n```\n\n## Slo escritura: de la vista hacia el modelo\n### 1- Eventos\nLa comunicacin desde la vista hacia el modelo se realiza mediante eventos. Es una buena prctica llamar a funciones del componente de forma declarativa en la vista. \nLa sintaxis requiere que se nombre el evento entre parntesis y se le asigne una expresin como valor. `(evento)=\"expresion\"`\n```html\n     <input (keyup)=\"onKey($event)\" />\n     <input #nombre\n      (keyup.enter)=\"propiedad=nombre.value\"\n      (blur)=\"propiedad=nombre.value\">\n     <button (click)=lanzarCohete()>Lanzar cohete</button>\n```\n## Lectura y escritura: bidireccional\n### 1- Enlace doble.\nEste es el caso ms comn en la edicin de formularios. Y es el equivalente al viejo y glorioso *doble binding*. Es la combinacin de los dos anteriores y eso se refleja en la sintaxis. Recordad `[]` para leer propiedades y `()` para enviar datos en respuesta a eventos: el resultado es la llamada *banana in a box* `[()]`. En este caso se completa con la directiva ngModel y la propiedad enlazada. `[(ngModel)]=\"propiedad\"`\n```html\n  <input type=\"text\"  [(ngModel)]=\"nombreDelProgramador\" >\n  Hola {{nombreDelProgramador}}\n```\n\n## Resumen\nEste es un ejemplo recopilatorio de las capacidades de Angular2 en cuanto a la sintaxis declarativa en las plantillas HTML de los componentes. Recordad este *mantra* que revisaremos durante la composicin de componentes en aplicaciones complejas:\n> Los datos fluyen hacia las propiedades de los componentes hijos. Los eventos brotan desde los hijos hacia los padres. Slo usamos enlace doble en los formularios que as lo requieran.\n\n```html\n<h1>\n  <!--Interpolacin de variables definidas en el modelo del componente-->\n  {{title}}\n</h1>\n<form>\n  <label>Cmo te llamas?</label>\n  <!--Enlace doble (lectura y escritura) entre la vista y el modelo-->\n  <input type=\"text\" [(ngModel)]=\"aprendiz\" />\n  <p>Bienvenido a Angular 2 {{ aprendiz }} </p>\n  \n  <!--Expresiones-->\n  <p>Soy capaz de multiplicar por {{1 * 2}} tus habilidades </p>\n  <!--Eventos-->\n  <button (click)=\"visible=true\">Saludar</button>\n  <!--Propiedades-->\n  <p [hidden]=\"!visible\">Hola Mundo!!!</p>\n</form>\n```\n\nEn estos ejemplos se han visto propiedades y eventos estndar. Pero todo lo dicho es aplicable a las **propiedades y eventos** especialmente creados para tus componentes.\n\nEl objetivo, conseguido, es aumentar el **rendimiento**. Y un efecto colateral es la **simplificacin del API** de AngularJS. Desaparecen casi todas las directivas estructurales. Especialmente las famosas `ng-click ng-blur` y dems directivas asociadas a eventos. Tampoco se necesitan ms las directivas de `ng-show` y `ng-hide`.\n\nLas nicas directivas estructurales que permanecen son `*ngIf` `*ngSwitch` y `*ngFor`. Pero esas merecen tratamiento aparte.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/)","source":"_posts/DataBinding-el-flujo-de-datos-de-Angular2.md","raw":"---\ntitle: DataBinding el flujo de datos de Angular2\ntags:  \n- Angular2\n- Forms\n- Tutorial\ncategories:\n- Introduccin \npermalink: databinding-el-flujo-de-datos-de-angular2\nid: 13\nupdated: 2016/11/10 14:56:46\ndate: 2016/05/25 17:26:32\n---\n\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/)\n\n---\n\n> Cdigo asociado en [angular2/3-databinding/](https://github.com/AcademiaBinaria/angular2/tree/master/3-databinding) \n\nEl *doble binding* o enlace vista controlador en ambos sentidos es una de las claves del xito de AngularJS. Usando la clebre directiva `ng-model` enganchamos **una propiedad del modelo con un control de la vista**. De manera *automgica* Angular se suscribe a cambios en el DOM y observa el estado del modelo mantenindolos en sincrona. \n\nPero esto tiene un coste en rendimiento que Angular2 supera con un patrn distinto para el control del **flujo de datos** entre la vista y el modelo. Este nuevo paradigma ofrece soluciones para distintos escenarios:\n\n![Flujo de datos](/images/ng2-Flujo-de-datos.jpg)\n\n<!-- more -->\n\n## Slo lectura: modelo hacia la vista\n### 1- Interpolacin\nEn este primer caso todo nos resultar muy familiar. En efecto la sintxis de interpolacin es la mismoa que en AngularJS 1.x. eso si, en este caso y por defecto, los datos son de slo lectura y Angular no se preocupa de actualizar la variable.\n```html\n     <p>Hola {{nombreDelProgramador}} bienvenido a Angular2</p>\n     <p>Fecha de nacimiento: {{fechaDeNacimiento | date}}</p>\n```\n### 2- Enlace a propiedades\nEs la comunicacin bsica hacia la vista, hacia el usuario. En este caso cualquier atributo de un elemento HTML puede enlazarse al valor de una propiedad encerrndola entre corchetes y asignndole una expresin. `[propiedad]=\"expresion\"`\n```html\n     <p>Hola <input [value]=\"nombreDelProgramador\" readonly ></input> bienvenido a Angular2</p>\n     <a [href]=\"url-academia-binaria\">Academia Binaria</a>\n     <div [hidden]=\"usuarioAutenticado\">Identifcate</div>     \n     <div [hidden]=\"!usuarioAutenticado\">Hola {{nombreUsuario}}</div>\n```\n\n## Slo escritura: de la vista hacia el modelo\n### 1- Eventos\nLa comunicacin desde la vista hacia el modelo se realiza mediante eventos. Es una buena prctica llamar a funciones del componente de forma declarativa en la vista. \nLa sintaxis requiere que se nombre el evento entre parntesis y se le asigne una expresin como valor. `(evento)=\"expresion\"`\n```html\n     <input (keyup)=\"onKey($event)\" />\n     <input #nombre\n      (keyup.enter)=\"propiedad=nombre.value\"\n      (blur)=\"propiedad=nombre.value\">\n     <button (click)=lanzarCohete()>Lanzar cohete</button>\n```\n## Lectura y escritura: bidireccional\n### 1- Enlace doble.\nEste es el caso ms comn en la edicin de formularios. Y es el equivalente al viejo y glorioso *doble binding*. Es la combinacin de los dos anteriores y eso se refleja en la sintaxis. Recordad `[]` para leer propiedades y `()` para enviar datos en respuesta a eventos: el resultado es la llamada *banana in a box* `[()]`. En este caso se completa con la directiva ngModel y la propiedad enlazada. `[(ngModel)]=\"propiedad\"`\n```html\n  <input type=\"text\"  [(ngModel)]=\"nombreDelProgramador\" >\n  Hola {{nombreDelProgramador}}\n```\n\n## Resumen\nEste es un ejemplo recopilatorio de las capacidades de Angular2 en cuanto a la sintaxis declarativa en las plantillas HTML de los componentes. Recordad este *mantra* que revisaremos durante la composicin de componentes en aplicaciones complejas:\n> Los datos fluyen hacia las propiedades de los componentes hijos. Los eventos brotan desde los hijos hacia los padres. Slo usamos enlace doble en los formularios que as lo requieran.\n\n```html\n<h1>\n  <!--Interpolacin de variables definidas en el modelo del componente-->\n  {{title}}\n</h1>\n<form>\n  <label>Cmo te llamas?</label>\n  <!--Enlace doble (lectura y escritura) entre la vista y el modelo-->\n  <input type=\"text\" [(ngModel)]=\"aprendiz\" />\n  <p>Bienvenido a Angular 2 {{ aprendiz }} </p>\n  \n  <!--Expresiones-->\n  <p>Soy capaz de multiplicar por {{1 * 2}} tus habilidades </p>\n  <!--Eventos-->\n  <button (click)=\"visible=true\">Saludar</button>\n  <!--Propiedades-->\n  <p [hidden]=\"!visible\">Hola Mundo!!!</p>\n</form>\n```\n\nEn estos ejemplos se han visto propiedades y eventos estndar. Pero todo lo dicho es aplicable a las **propiedades y eventos** especialmente creados para tus componentes.\n\nEl objetivo, conseguido, es aumentar el **rendimiento**. Y un efecto colateral es la **simplificacin del API** de AngularJS. Desaparecen casi todas las directivas estructurales. Especialmente las famosas `ng-click ng-blur` y dems directivas asociadas a eventos. Tampoco se necesitan ms las directivas de `ng-show` y `ng-hide`.\n\nLas nicas directivas estructurales que permanecen son `*ngIf` `*ngSwitch` y `*ngFor`. Pero esas merecen tratamiento aparte.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/)","slug":"databinding-el-flujo-de-datos-de-angular2","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvfm000hiwd3kjqdf4ac","content":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a></p></blockquote><hr><blockquote><p>Cdigo asociado en <a href=\"https://github.com/AcademiaBinaria/angular2/tree/master/3-databinding\" target=\"_blank\" rel=\"external\">angular2/3-databinding/</a></p></blockquote><p>El <em>doble binding</em> o enlace vista controlador en ambos sentidos es una de las claves del xito de AngularJS. Usando la clebre directiva <code>ng-model</code> enganchamos <strong>una propiedad del modelo con un control de la vista</strong>. De manera <em>automgica</em> Angular se suscribe a cambios en el DOM y observa el estado del modelo mantenindolos en sincrona.</p><p>Pero esto tiene un coste en rendimiento que Angular2 supera con un patrn distinto para el control del <strong>flujo de datos</strong> entre la vista y el modelo. Este nuevo paradigma ofrece soluciones para distintos escenarios:</p><p><img src=\"/images/ng2-Flujo-de-datos.jpg\" alt=\"Flujo de datos\"></p><a id=\"more\"></a><h2 id=\"Solo-lectura-modelo-hacia-la-vista\"><a href=\"#Solo-lectura-modelo-hacia-la-vista\" class=\"headerlink\" title=\"Slo lectura: modelo hacia la vista\"></a>Slo lectura: modelo hacia la vista</h2><h3 id=\"1-Interpolacion\"><a href=\"#1-Interpolacion\" class=\"headerlink\" title=\"1- Interpolacin\"></a>1- Interpolacin</h3><p>En este primer caso todo nos resultar muy familiar. En efecto la sintxis de interpolacin es la mismoa que en AngularJS 1.x. eso si, en este caso y por defecto, los datos son de slo lectura y Angular no se preocupa de actualizar la variable.<br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Hola &#123;&#123;nombreDelProgramador&#125;&#125; bienvenido a Angular2<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Fecha de nacimiento: &#123;&#123;fechaDeNacimiento | date&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div></pre></td></tr></table></figure><p></p><h3 id=\"2-Enlace-a-propiedades\"><a href=\"#2-Enlace-a-propiedades\" class=\"headerlink\" title=\"2- Enlace a propiedades\"></a>2- Enlace a propiedades</h3><p>Es la comunicacin bsica hacia la vista, hacia el usuario. En este caso cualquier atributo de un elemento HTML puede enlazarse al valor de una propiedad encerrndola entre corchetes y asignndole una expresin. <code>[propiedad]=&quot;expresion&quot;</code><br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Hola <span class=\"tag\">&lt;<span class=\"name\">input</span> [<span class=\"attr\">value</span>]=<span class=\"string\">\"nombreDelProgramador\"</span> <span class=\"attr\">readonly</span> &gt;</span><span class=\"tag\">&lt;/<span class=\"name\">input</span>&gt;</span> bienvenido a Angular2<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">href</span>]=<span class=\"string\">\"url-academia-binaria\"</span>&gt;</span>Academia Binaria<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">hidden</span>]=<span class=\"string\">\"usuarioAutenticado\"</span>&gt;</span>Identifcate<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span>     </div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">hidden</span>]=<span class=\"string\">\"!usuarioAutenticado\"</span>&gt;</span>Hola &#123;&#123;nombreUsuario&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure><p></p><h2 id=\"Solo-escritura-de-la-vista-hacia-el-modelo\"><a href=\"#Solo-escritura-de-la-vista-hacia-el-modelo\" class=\"headerlink\" title=\"Slo escritura: de la vista hacia el modelo\"></a>Slo escritura: de la vista hacia el modelo</h2><h3 id=\"1-Eventos\"><a href=\"#1-Eventos\" class=\"headerlink\" title=\"1- Eventos\"></a>1- Eventos</h3><p>La comunicacin desde la vista hacia el modelo se realiza mediante eventos. Es una buena prctica llamar a funciones del componente de forma declarativa en la vista.<br>La sintaxis requiere que se nombre el evento entre parntesis y se le asigne una expresin como valor. <code>(evento)=&quot;expresion&quot;</code><br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> (<span class=\"attr\">keyup</span>)=<span class=\"string\">\"onKey($event)\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> #<span class=\"attr\">nombre</span></span></div><div class=\"line\"><span class=\"tag\"> (<span class=\"attr\">keyup.enter</span>)=<span class=\"string\">\"propiedad=nombre.value\"</span></span></div><div class=\"line\"><span class=\"tag\"> (<span class=\"attr\">blur</span>)=<span class=\"string\">\"propiedad=nombre.value\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">lanzarCohete()</span>&gt;</span>Lanzar cohete<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div></pre></td></tr></table></figure><p></p><h2 id=\"Lectura-y-escritura-bidireccional\"><a href=\"#Lectura-y-escritura-bidireccional\" class=\"headerlink\" title=\"Lectura y escritura: bidireccional\"></a>Lectura y escritura: bidireccional</h2><h3 id=\"1-Enlace-doble\"><a href=\"#1-Enlace-doble\" class=\"headerlink\" title=\"1- Enlace doble.\"></a>1- Enlace doble.</h3><p>Este es el caso ms comn en la edicin de formularios. Y es el equivalente al viejo y glorioso <em>doble binding</em>. Es la combinacin de los dos anteriores y eso se refleja en la sintaxis. Recordad <code>[]</code> para leer propiedades y <code>()</code> para enviar datos en respuesta a eventos: el resultado es la llamada <em>banana in a box</em> <code>[()]</code>. En este caso se completa con la directiva ngModel y la propiedad enlazada. <code>[(ngModel)]=&quot;propiedad&quot;</code><br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span>  [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"nombreDelProgramador\"</span> &gt;</span></div><div class=\"line\">Hola &#123;&#123;nombreDelProgramador&#125;&#125;</div></pre></td></tr></table></figure><p></p><h2 id=\"Resumen\"><a href=\"#Resumen\" class=\"headerlink\" title=\"Resumen\"></a>Resumen</h2><p>Este es un ejemplo recopilatorio de las capacidades de Angular2 en cuanto a la sintaxis declarativa en las plantillas HTML de los componentes. Recordad este <em>mantra</em> que revisaremos durante la composicin de componentes en aplicaciones complejas:</p><blockquote><p>Los datos fluyen hacia las propiedades de los componentes hijos. Los eventos brotan desde los hijos hacia los padres. Slo usamos enlace doble en los formularios que as lo requieran.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Interpolacin de variables definidas en el modelo del componente--&gt;</span></div><div class=\"line\">  &#123;&#123;title&#125;&#125;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Cmo te llamas?<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Enlace doble (lectura y escritura) entre la vista y el modelo--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"aprendiz\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Bienvenido a Angular 2 &#123;&#123; aprendiz &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  </div><div class=\"line\">  <span class=\"comment\">&lt;!--Expresiones--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Soy capaz de multiplicar por &#123;&#123;1 * 2&#125;&#125; tus habilidades <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Eventos--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"visible=true\"</span>&gt;</span>Saludar<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Propiedades--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span> [<span class=\"attr\">hidden</span>]=<span class=\"string\">\"!visible\"</span>&gt;</span>Hola Mundo!!!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></div></pre></td></tr></table></figure><p>En estos ejemplos se han visto propiedades y eventos estndar. Pero todo lo dicho es aplicable a las <strong>propiedades y eventos</strong> especialmente creados para tus componentes.</p><p>El objetivo, conseguido, es aumentar el <strong>rendimiento</strong>. Y un efecto colateral es la <strong>simplificacin del API</strong> de AngularJS. Desaparecen casi todas las directivas estructurales. Especialmente las famosas <code>ng-click ng-blur</code> y dems directivas asociadas a eventos. Tampoco se necesitan ms las directivas de <code>ng-show</code> y <code>ng-hide</code>.</p><p>Las nicas directivas estructurales que permanecen son <code>*ngIf</code> <code>*ngSwitch</code> y <code>*ngFor</code>. Pero esas merecen tratamiento aparte.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a></p>","site":{"data":{}},"excerpt":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a></p></blockquote><hr><blockquote><p>Cdigo asociado en <a href=\"https://github.com/AcademiaBinaria/angular2/tree/master/3-databinding\" target=\"_blank\" rel=\"external\">angular2/3-databinding/</a></p></blockquote><p>El <em>doble binding</em> o enlace vista controlador en ambos sentidos es una de las claves del xito de AngularJS. Usando la clebre directiva <code>ng-model</code> enganchamos <strong>una propiedad del modelo con un control de la vista</strong>. De manera <em>automgica</em> Angular se suscribe a cambios en el DOM y observa el estado del modelo mantenindolos en sincrona.</p><p>Pero esto tiene un coste en rendimiento que Angular2 supera con un patrn distinto para el control del <strong>flujo de datos</strong> entre la vista y el modelo. Este nuevo paradigma ofrece soluciones para distintos escenarios:</p><p><img src=\"/images/ng2-Flujo-de-datos.jpg\" alt=\"Flujo de datos\"></p>","more":"<h2 id=\"Solo-lectura-modelo-hacia-la-vista\"><a href=\"#Solo-lectura-modelo-hacia-la-vista\" class=\"headerlink\" title=\"Slo lectura: modelo hacia la vista\"></a>Slo lectura: modelo hacia la vista</h2><h3 id=\"1-Interpolacion\"><a href=\"#1-Interpolacion\" class=\"headerlink\" title=\"1- Interpolacin\"></a>1- Interpolacin</h3><p>En este primer caso todo nos resultar muy familiar. En efecto la sintxis de interpolacin es la mismoa que en AngularJS 1.x. eso si, en este caso y por defecto, los datos son de slo lectura y Angular no se preocupa de actualizar la variable.<br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Hola &#123;&#123;nombreDelProgramador&#125;&#125; bienvenido a Angular2<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Fecha de nacimiento: &#123;&#123;fechaDeNacimiento | date&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div></pre></td></tr></table></figure><p></p><h3 id=\"2-Enlace-a-propiedades\"><a href=\"#2-Enlace-a-propiedades\" class=\"headerlink\" title=\"2- Enlace a propiedades\"></a>2- Enlace a propiedades</h3><p>Es la comunicacin bsica hacia la vista, hacia el usuario. En este caso cualquier atributo de un elemento HTML puede enlazarse al valor de una propiedad encerrndola entre corchetes y asignndole una expresin. <code>[propiedad]=&quot;expresion&quot;</code><br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Hola <span class=\"tag\">&lt;<span class=\"name\">input</span> [<span class=\"attr\">value</span>]=<span class=\"string\">\"nombreDelProgramador\"</span> <span class=\"attr\">readonly</span> &gt;</span><span class=\"tag\">&lt;/<span class=\"name\">input</span>&gt;</span> bienvenido a Angular2<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">href</span>]=<span class=\"string\">\"url-academia-binaria\"</span>&gt;</span>Academia Binaria<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">hidden</span>]=<span class=\"string\">\"usuarioAutenticado\"</span>&gt;</span>Identifcate<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span>     </div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> [<span class=\"attr\">hidden</span>]=<span class=\"string\">\"!usuarioAutenticado\"</span>&gt;</span>Hola &#123;&#123;nombreUsuario&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure><p></p><h2 id=\"Solo-escritura-de-la-vista-hacia-el-modelo\"><a href=\"#Solo-escritura-de-la-vista-hacia-el-modelo\" class=\"headerlink\" title=\"Slo escritura: de la vista hacia el modelo\"></a>Slo escritura: de la vista hacia el modelo</h2><h3 id=\"1-Eventos\"><a href=\"#1-Eventos\" class=\"headerlink\" title=\"1- Eventos\"></a>1- Eventos</h3><p>La comunicacin desde la vista hacia el modelo se realiza mediante eventos. Es una buena prctica llamar a funciones del componente de forma declarativa en la vista.<br>La sintaxis requiere que se nombre el evento entre parntesis y se le asigne una expresin como valor. <code>(evento)=&quot;expresion&quot;</code><br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> (<span class=\"attr\">keyup</span>)=<span class=\"string\">\"onKey($event)\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> #<span class=\"attr\">nombre</span></span></div><div class=\"line\"><span class=\"tag\"> (<span class=\"attr\">keyup.enter</span>)=<span class=\"string\">\"propiedad=nombre.value\"</span></span></div><div class=\"line\"><span class=\"tag\"> (<span class=\"attr\">blur</span>)=<span class=\"string\">\"propiedad=nombre.value\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">lanzarCohete()</span>&gt;</span>Lanzar cohete<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div></pre></td></tr></table></figure><p></p><h2 id=\"Lectura-y-escritura-bidireccional\"><a href=\"#Lectura-y-escritura-bidireccional\" class=\"headerlink\" title=\"Lectura y escritura: bidireccional\"></a>Lectura y escritura: bidireccional</h2><h3 id=\"1-Enlace-doble\"><a href=\"#1-Enlace-doble\" class=\"headerlink\" title=\"1- Enlace doble.\"></a>1- Enlace doble.</h3><p>Este es el caso ms comn en la edicin de formularios. Y es el equivalente al viejo y glorioso <em>doble binding</em>. Es la combinacin de los dos anteriores y eso se refleja en la sintaxis. Recordad <code>[]</code> para leer propiedades y <code>()</code> para enviar datos en respuesta a eventos: el resultado es la llamada <em>banana in a box</em> <code>[()]</code>. En este caso se completa con la directiva ngModel y la propiedad enlazada. <code>[(ngModel)]=&quot;propiedad&quot;</code><br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span>  [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"nombreDelProgramador\"</span> &gt;</span></div><div class=\"line\">Hola &#123;&#123;nombreDelProgramador&#125;&#125;</div></pre></td></tr></table></figure><p></p><h2 id=\"Resumen\"><a href=\"#Resumen\" class=\"headerlink\" title=\"Resumen\"></a>Resumen</h2><p>Este es un ejemplo recopilatorio de las capacidades de Angular2 en cuanto a la sintaxis declarativa en las plantillas HTML de los componentes. Recordad este <em>mantra</em> que revisaremos durante la composicin de componentes en aplicaciones complejas:</p><blockquote><p>Los datos fluyen hacia las propiedades de los componentes hijos. Los eventos brotan desde los hijos hacia los padres. Slo usamos enlace doble en los formularios que as lo requieran.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Interpolacin de variables definidas en el modelo del componente--&gt;</span></div><div class=\"line\">  &#123;&#123;title&#125;&#125;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Cmo te llamas?<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Enlace doble (lectura y escritura) entre la vista y el modelo--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"aprendiz\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Bienvenido a Angular 2 &#123;&#123; aprendiz &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  </div><div class=\"line\">  <span class=\"comment\">&lt;!--Expresiones--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Soy capaz de multiplicar por &#123;&#123;1 * 2&#125;&#125; tus habilidades <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Eventos--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"visible=true\"</span>&gt;</span>Saludar<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Propiedades--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span> [<span class=\"attr\">hidden</span>]=<span class=\"string\">\"!visible\"</span>&gt;</span>Hola Mundo!!!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></div></pre></td></tr></table></figure><p>En estos ejemplos se han visto propiedades y eventos estndar. Pero todo lo dicho es aplicable a las <strong>propiedades y eventos</strong> especialmente creados para tus componentes.</p><p>El objetivo, conseguido, es aumentar el <strong>rendimiento</strong>. Y un efecto colateral es la <strong>simplificacin del API</strong> de AngularJS. Desaparecen casi todas las directivas estructurales. Especialmente las famosas <code>ng-click ng-blur</code> y dems directivas asociadas a eventos. Tampoco se necesitan ms las directivas de <code>ng-show</code> y <code>ng-hide</code>.</p><p>Las nicas directivas estructurales que permanecen son <code>*ngIf</code> <code>*ngSwitch</code> y <code>*ngFor</code>. Pero esas merecen tratamiento aparte.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a></p>"},{"title":"Componentes, los bloques de construccin de Angular2","id":"26","updated":"2016-11-07T17:39:26.000Z","date":"2016-05-23T12:07:27.000Z","_content":"\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Base para una aplicacin Angular](../base-aplicacion-angular/)\n\n---\n\n>Cdigo asociado en GitHub: [angular2/2-modulos/](https://github.com/AcademiaBinaria/angular2/tree/master/2-modulos) \n\nLos componentes son los bloques de construccin de la web moderna. En Angular 2 sustituyen al viejo par Vista-Controlador, el cual ya era opcional en las ltimas versiones 1.x Ahora **el componente es el rey**.\n\nLas aplicaciones en Angular2 se desarrollan como **rboles de componentes**. Estos rboles pueden llegar a ser muy frondosos y conviene dirigir su crecimiento agrupndolos en **mdulos** para no perderse. Yo procuro estructurarlo en niveles para una mejor comprensin. En cada nivel se crea un mdulo y dentro de l se declaran los componentes.\n\n* 1- Nivel **Raz**:\nToda aplicacin parte de un componente raz. Suele recibir el nombre de la aplicacin desarrollada y el sufijo `App` o simplemente `App`. \n* 2- Nivel **Troncal**:\nGeneralmente dos o tres componentes troncales para la estructura de las pginas. Es comn el patrn *Navegador-Contenedor*, con algn elemento auxiliar para ayudas, mensajes, mens complejos... \n* 3- Nivel de **Ramas**:\nEn este smil, las ramas equivalen a rutas o vistas de la aplicacin. En un *SPA* cada ruta tiene una vista asociada que se carga dentro del componente troncal contenedor \n* 4- Nivel de **Hojas**:\nCada una de las vistas est a su vez formada por mltiples componentes de negocio a modo de hojas. \n\n![rbol de componentes en una aplicacin Angular 2](/images/ng2-Arbol-de-componentes.jpg)\n\n>Con la salvedad de que muchos de estos componentes los puedes reutilizar en distintas vistas.\n\n<!-- more -->\n\n## Mdulos\n\nLos rboles de componentes pueden ocultarnos fcilmente el bosque de nuestra aplicacin. **Los mdulos son agrupaciones de componentes.** Nos ayudan a mantener un orden y a encapsular funcionalidad para crear aplicaciones desacopladas con bloques re-utilizables.\n\n> No confundir con los mdulos de *JavaScript ES6* o de T*ypeScript*. En estos casos se les llama mdulos a los ficheros de cdigo que exportan funcionalidad. \n\nPodemos imaginar un mdulo como una fbrica de funcionalidad.\n1. **Importa** componentes que otros mdulos exportan.\n2. **Declara** los componentes que el mismo fabrica.  \n3. **Exporta** algunos de estos componentes, para que los consuman otros mdulos.\n\n\n### Anatoma de un Componente\nEn el artculo de [bienvenida a Angular 2](http://academia-binaria.com/hola-mundo-en-angular-2/) tenamos una aplicacin de un slo mdulo con un slo componente. Y nos sirvi para ver su **estructura**: plantilla, decorador y clase.\n\n![Estructura interna de un componente Angular 2](/images/ng2Component--1-.jpg)\n\nLa **plantilla** en HTML y la **clase** en JS equivalen a las antiguas vistas y controladores. La **metadata** une ambos mundos y registra el componente para que interacciones con el resto del mundo Angular. \n\n>La comunicacin de datos entre la plantilla y el componente se realiza siguiendo un remozado workflow de propiedades y eventos. El nuevo *data-binding* de Angular2 merece estudio en detalle pues su sintaxis ha cambiado para poder estar a la altura del rendimiento exigido. \n\n\n\n\n### Generacin de mdulos y componentes con angular-cli\n\nSobre la base de ese 'Hola Mundo' vamos construir una mini aplicacin muy sencilla para guardar movimientos econmicos. El *To Do List* de los ingresos y gastos. \n\nEmpezar creando **otro mdulo con su componente para ser integrado** en el componente raz del mdulo raz. Por ahora ser un componente de negocio vaco: el componente `movimientos`. Puedes escribir a mano cada nuevo mdulo o componente, pero si usas [Angular CLI](https://cli.angular.io/) lo tendrs generado con un slo comando:\n\n```bash \nng g m movimientos\n``` \n\nVers que se ha creado una carpeta llamada `movimientos` con una estructura que pronto te ser muy familiar. Para empezar un archivo para el nuevo mdulo, el `movimientos-module.ts`. Despus una serie de ficheros para crear su componente principal. Un fichero `movimientos-component.ts` para la clase controladora y el decorador con la *metadata*, y otro fichero `movimientos-component.html` para la plantilla.\n\nReproduzco ahora su contenido bsico. Primero la plantilla HTML\n\n```html\n<p>\n  movimientos works!\n</p>\n```\nY ahora la definicin del componente en *TypeScript*. El cual no sabe en qu mdulo acabar.\n\n```javascript\nimport { Component, OnInit } from '@angular/core';\n// decoracin con metadata para el componente\n@Component({\n  selector: 'app-movimientos', // ojo al prefijo, por defecto app\n  templateUrl: './movimientos.component.html', // podran ser inline\n  styleUrls: ['./movimientos.component.css'] // podran ser inline\n})\nexport class MovimientosComponent implements OnInit {\n  constructor() { }\n  ngOnInit() {\n  }\n}\n```\n\nPara que este componente sea conocido ha de estar al menos declarado y exportado en algn mdulo. En este caso aparece en el fichero `movimientos-module.ts`\n\n```javascript\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n/** Importa un componente que declara y que luego exporta */\nimport { MovimientosComponent } from './movimientos.component';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],// dependencias de otros mdulos\n  declarations: [\n    MovimientosComponent\n  ],// Componente que el mdulo mismo declara\n  exports: [\n    MovimientosComponent\n  ] // exporta los componentes importables desde otros mdulos\n})\nexport class MovimientosModule { }\n```\n\n### Consumo desde un componente padre\nEl componente `movimientos` est creado pero nadie lo usa. Para darle utilidad hay que consumirlo. Vamos tocar los ficheros 'app.module.ts' y 'app.component.html' Son siempre estos tres sencillos pasos:\n\n* 1- Importar el mdulo que lo exporta\n```javascript\n// 1 importacin del cdigo del mdulo funcional\nimport { MovimientosModule } from './movimientos/movimientos.module';\n```\n* 2- Registro en el array de importaciones del mdulo raz\n```javascript\n...\nimports:[..., MovimientosModule] // 2 registro del modulo importado con todo lo que exporta\n...\n```\n* 3- Uso del componente como un elemento html en la plantilla del padre\n```html\n<h1>\n  <!--enlace con propiedades del componente-->\n  {{title}}\n</h1>\n<!-- 3 los componentes personalizados se usan como elementos estndar en html-->\n<!--componente movimientos-->\n<app-movimientos></app-movimientos>\n```\n\n\nEsta manera de encapsular componentes unos dentro de otros permite crear **grandes aplicaciones de tamao empresarial** sin sacrificar la limpieza del cdigo. Cada componente debe disearse de forma que resuelva un problema de negocio concreto, por tanto manejable. Y si puede ser **reutilizable** mucho mejor.\n\nLa agrupacin de componentes en mdulos ayuda a mantener la aplicacin organizada.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Base para una aplicacin Angular](../base-aplicacion-angular/)","source":"_posts/Componentes-los-bloques-de-construccion-de-Angular2.md","raw":"---\ntitle: 'Componentes, los bloques de construccin de Angular2'\ntags:  \n- Angular2\n- CLI\n- Tutorial\ncategories:\n- Introduccin \npermalink: componentes-los-bloques-de-construccion-de-angular-2\nid: 26\nupdated: 2016/11/07 18:39:26\ndate: 2016/05/23 14:07:27\n---\n\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Base para una aplicacin Angular](../base-aplicacion-angular/)\n\n---\n\n>Cdigo asociado en GitHub: [angular2/2-modulos/](https://github.com/AcademiaBinaria/angular2/tree/master/2-modulos) \n\nLos componentes son los bloques de construccin de la web moderna. En Angular 2 sustituyen al viejo par Vista-Controlador, el cual ya era opcional en las ltimas versiones 1.x Ahora **el componente es el rey**.\n\nLas aplicaciones en Angular2 se desarrollan como **rboles de componentes**. Estos rboles pueden llegar a ser muy frondosos y conviene dirigir su crecimiento agrupndolos en **mdulos** para no perderse. Yo procuro estructurarlo en niveles para una mejor comprensin. En cada nivel se crea un mdulo y dentro de l se declaran los componentes.\n\n* 1- Nivel **Raz**:\nToda aplicacin parte de un componente raz. Suele recibir el nombre de la aplicacin desarrollada y el sufijo `App` o simplemente `App`. \n* 2- Nivel **Troncal**:\nGeneralmente dos o tres componentes troncales para la estructura de las pginas. Es comn el patrn *Navegador-Contenedor*, con algn elemento auxiliar para ayudas, mensajes, mens complejos... \n* 3- Nivel de **Ramas**:\nEn este smil, las ramas equivalen a rutas o vistas de la aplicacin. En un *SPA* cada ruta tiene una vista asociada que se carga dentro del componente troncal contenedor \n* 4- Nivel de **Hojas**:\nCada una de las vistas est a su vez formada por mltiples componentes de negocio a modo de hojas. \n\n![rbol de componentes en una aplicacin Angular 2](/images/ng2-Arbol-de-componentes.jpg)\n\n>Con la salvedad de que muchos de estos componentes los puedes reutilizar en distintas vistas.\n\n<!-- more -->\n\n## Mdulos\n\nLos rboles de componentes pueden ocultarnos fcilmente el bosque de nuestra aplicacin. **Los mdulos son agrupaciones de componentes.** Nos ayudan a mantener un orden y a encapsular funcionalidad para crear aplicaciones desacopladas con bloques re-utilizables.\n\n> No confundir con los mdulos de *JavaScript ES6* o de T*ypeScript*. En estos casos se les llama mdulos a los ficheros de cdigo que exportan funcionalidad. \n\nPodemos imaginar un mdulo como una fbrica de funcionalidad.\n1. **Importa** componentes que otros mdulos exportan.\n2. **Declara** los componentes que el mismo fabrica.  \n3. **Exporta** algunos de estos componentes, para que los consuman otros mdulos.\n\n\n### Anatoma de un Componente\nEn el artculo de [bienvenida a Angular 2](http://academia-binaria.com/hola-mundo-en-angular-2/) tenamos una aplicacin de un slo mdulo con un slo componente. Y nos sirvi para ver su **estructura**: plantilla, decorador y clase.\n\n![Estructura interna de un componente Angular 2](/images/ng2Component--1-.jpg)\n\nLa **plantilla** en HTML y la **clase** en JS equivalen a las antiguas vistas y controladores. La **metadata** une ambos mundos y registra el componente para que interacciones con el resto del mundo Angular. \n\n>La comunicacin de datos entre la plantilla y el componente se realiza siguiendo un remozado workflow de propiedades y eventos. El nuevo *data-binding* de Angular2 merece estudio en detalle pues su sintaxis ha cambiado para poder estar a la altura del rendimiento exigido. \n\n\n\n\n### Generacin de mdulos y componentes con angular-cli\n\nSobre la base de ese 'Hola Mundo' vamos construir una mini aplicacin muy sencilla para guardar movimientos econmicos. El *To Do List* de los ingresos y gastos. \n\nEmpezar creando **otro mdulo con su componente para ser integrado** en el componente raz del mdulo raz. Por ahora ser un componente de negocio vaco: el componente `movimientos`. Puedes escribir a mano cada nuevo mdulo o componente, pero si usas [Angular CLI](https://cli.angular.io/) lo tendrs generado con un slo comando:\n\n```bash \nng g m movimientos\n``` \n\nVers que se ha creado una carpeta llamada `movimientos` con una estructura que pronto te ser muy familiar. Para empezar un archivo para el nuevo mdulo, el `movimientos-module.ts`. Despus una serie de ficheros para crear su componente principal. Un fichero `movimientos-component.ts` para la clase controladora y el decorador con la *metadata*, y otro fichero `movimientos-component.html` para la plantilla.\n\nReproduzco ahora su contenido bsico. Primero la plantilla HTML\n\n```html\n<p>\n  movimientos works!\n</p>\n```\nY ahora la definicin del componente en *TypeScript*. El cual no sabe en qu mdulo acabar.\n\n```javascript\nimport { Component, OnInit } from '@angular/core';\n// decoracin con metadata para el componente\n@Component({\n  selector: 'app-movimientos', // ojo al prefijo, por defecto app\n  templateUrl: './movimientos.component.html', // podran ser inline\n  styleUrls: ['./movimientos.component.css'] // podran ser inline\n})\nexport class MovimientosComponent implements OnInit {\n  constructor() { }\n  ngOnInit() {\n  }\n}\n```\n\nPara que este componente sea conocido ha de estar al menos declarado y exportado en algn mdulo. En este caso aparece en el fichero `movimientos-module.ts`\n\n```javascript\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n/** Importa un componente que declara y que luego exporta */\nimport { MovimientosComponent } from './movimientos.component';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],// dependencias de otros mdulos\n  declarations: [\n    MovimientosComponent\n  ],// Componente que el mdulo mismo declara\n  exports: [\n    MovimientosComponent\n  ] // exporta los componentes importables desde otros mdulos\n})\nexport class MovimientosModule { }\n```\n\n### Consumo desde un componente padre\nEl componente `movimientos` est creado pero nadie lo usa. Para darle utilidad hay que consumirlo. Vamos tocar los ficheros 'app.module.ts' y 'app.component.html' Son siempre estos tres sencillos pasos:\n\n* 1- Importar el mdulo que lo exporta\n```javascript\n// 1 importacin del cdigo del mdulo funcional\nimport { MovimientosModule } from './movimientos/movimientos.module';\n```\n* 2- Registro en el array de importaciones del mdulo raz\n```javascript\n...\nimports:[..., MovimientosModule] // 2 registro del modulo importado con todo lo que exporta\n...\n```\n* 3- Uso del componente como un elemento html en la plantilla del padre\n```html\n<h1>\n  <!--enlace con propiedades del componente-->\n  {{title}}\n</h1>\n<!-- 3 los componentes personalizados se usan como elementos estndar en html-->\n<!--componente movimientos-->\n<app-movimientos></app-movimientos>\n```\n\n\nEsta manera de encapsular componentes unos dentro de otros permite crear **grandes aplicaciones de tamao empresarial** sin sacrificar la limpieza del cdigo. Cada componente debe disearse de forma que resuelva un problema de negocio concreto, por tanto manejable. Y si puede ser **reutilizable** mucho mejor.\n\nLa agrupacin de componentes en mdulos ayuda a mantener la aplicacin organizada.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Base para una aplicacin Angular](../base-aplicacion-angular/)","slug":"componentes-los-bloques-de-construccion-de-angular-2","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvg1000jiwd31vpe6o8t","content":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a></p></blockquote><hr><blockquote><p>Cdigo asociado en GitHub: <a href=\"https://github.com/AcademiaBinaria/angular2/tree/master/2-modulos\" target=\"_blank\" rel=\"external\">angular2/2-modulos/</a></p></blockquote><p>Los componentes son los bloques de construccin de la web moderna. En Angular 2 sustituyen al viejo par Vista-Controlador, el cual ya era opcional en las ltimas versiones 1.x Ahora <strong>el componente es el rey</strong>.</p><p>Las aplicaciones en Angular2 se desarrollan como <strong>rboles de componentes</strong>. Estos rboles pueden llegar a ser muy frondosos y conviene dirigir su crecimiento agrupndolos en <strong>mdulos</strong> para no perderse. Yo procuro estructurarlo en niveles para una mejor comprensin. En cada nivel se crea un mdulo y dentro de l se declaran los componentes.</p><ul><li>1- Nivel <strong>Raz</strong>:<br>Toda aplicacin parte de un componente raz. Suele recibir el nombre de la aplicacin desarrollada y el sufijo <code>App</code> o simplemente <code>App</code>.</li><li>2- Nivel <strong>Troncal</strong>:<br>Generalmente dos o tres componentes troncales para la estructura de las pginas. Es comn el patrn <em>Navegador-Contenedor</em>, con algn elemento auxiliar para ayudas, mensajes, mens complejos</li><li>3- Nivel de <strong>Ramas</strong>:<br>En este smil, las ramas equivalen a rutas o vistas de la aplicacin. En un <em>SPA</em> cada ruta tiene una vista asociada que se carga dentro del componente troncal contenedor</li><li>4- Nivel de <strong>Hojas</strong>:<br>Cada una de las vistas est a su vez formada por mltiples componentes de negocio a modo de hojas.</li></ul><p><img src=\"/images/ng2-Arbol-de-componentes.jpg\" alt=\"rbol de componentes en una aplicacin Angular 2\"></p><blockquote><p>Con la salvedad de que muchos de estos componentes los puedes reutilizar en distintas vistas.</p></blockquote><a id=\"more\"></a><h2 id=\"Modulos\"><a href=\"#Modulos\" class=\"headerlink\" title=\"Mdulos\"></a>Mdulos</h2><p>Los rboles de componentes pueden ocultarnos fcilmente el bosque de nuestra aplicacin. <strong>Los mdulos son agrupaciones de componentes.</strong> Nos ayudan a mantener un orden y a encapsular funcionalidad para crear aplicaciones desacopladas con bloques re-utilizables.</p><blockquote><p>No confundir con los mdulos de <em>JavaScript ES6</em> o de T<em>ypeScript</em>. En estos casos se les llama mdulos a los ficheros de cdigo que exportan funcionalidad.</p></blockquote><p>Podemos imaginar un mdulo como una fbrica de funcionalidad.</p><ol><li><strong>Importa</strong> componentes que otros mdulos exportan.</li><li><strong>Declara</strong> los componentes que el mismo fabrica.</li><li><strong>Exporta</strong> algunos de estos componentes, para que los consuman otros mdulos.</li></ol><h3 id=\"Anatomia-de-un-Componente\"><a href=\"#Anatomia-de-un-Componente\" class=\"headerlink\" title=\"Anatoma de un Componente\"></a>Anatoma de un Componente</h3><p>En el artculo de <a href=\"http://academia-binaria.com/hola-mundo-en-angular-2/\">bienvenida a Angular 2</a> tenamos una aplicacin de un slo mdulo con un slo componente. Y nos sirvi para ver su <strong>estructura</strong>: plantilla, decorador y clase.</p><p><img src=\"/images/ng2Component--1-.jpg\" alt=\"Estructura interna de un componente Angular 2\"></p><p>La <strong>plantilla</strong> en HTML y la <strong>clase</strong> en JS equivalen a las antiguas vistas y controladores. La <strong>metadata</strong> une ambos mundos y registra el componente para que interacciones con el resto del mundo Angular.</p><blockquote><p>La comunicacin de datos entre la plantilla y el componente se realiza siguiendo un remozado workflow de propiedades y eventos. El nuevo <em>data-binding</em> de Angular2 merece estudio en detalle pues su sintaxis ha cambiado para poder estar a la altura del rendimiento exigido.</p></blockquote><h3 id=\"Generacion-de-modulos-y-componentes-con-angular-cli\"><a href=\"#Generacion-de-modulos-y-componentes-con-angular-cli\" class=\"headerlink\" title=\"Generacin de mdulos y componentes con angular-cli\"></a>Generacin de mdulos y componentes con angular-cli</h3><p>Sobre la base de ese Hola Mundo vamos construir una mini aplicacin muy sencilla para guardar movimientos econmicos. El <em>To Do List</em> de los ingresos y gastos.</p><p>Empezar creando <strong>otro mdulo con su componente para ser integrado</strong> en el componente raz del mdulo raz. Por ahora ser un componente de negocio vaco: el componente <code>movimientos</code>. Puedes escribir a mano cada nuevo mdulo o componente, pero si usas <a href=\"https://cli.angular.io/\" target=\"_blank\" rel=\"external\">Angular CLI</a> lo tendrs generado con un slo comando:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">ng g m movimientos</div><div class=\"line\">``` </div><div class=\"line\"></div><div class=\"line\">Vers que se ha creado una carpeta llamada `movimientos` con una estructura que pronto te ser muy familiar. Para empezar un archivo para el nuevo mdulo, el `movimientos-module.ts`. Despus una serie de ficheros para crear su componente principal. Un fichero `movimientos-component.ts` para la clase controladora y el decorador con la *metadata*, y otro fichero `movimientos-component.html` para la plantilla.</div><div class=\"line\"></div><div class=\"line\">Reproduzco ahora su contenido bsico. Primero la plantilla HTML</div><div class=\"line\"></div><div class=\"line\">```html</div><div class=\"line\">&lt;p&gt;</div><div class=\"line\">  movimientos works!</div><div class=\"line\">&lt;/p&gt;</div></pre></td></tr></table></figure><p>Y ahora la definicin del componente en <em>TypeScript</em>. El cual no sabe en qu mdulo acabar.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"comment\">// decoracin con metadata para el componente</span></div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  selector: <span class=\"string\">'app-movimientos'</span>, <span class=\"comment\">// ojo al prefijo, por defecto app</span></div><div class=\"line\">  templateUrl: <span class=\"string\">'./movimientos.component.html'</span>, <span class=\"comment\">// podran ser inline</span></div><div class=\"line\">  styleUrls: [<span class=\"string\">'./movimientos.component.css'</span>] <span class=\"comment\">// podran ser inline</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MovimientosComponent</span> <span class=\"title\">implements</span> <span class=\"title\">OnInit</span> </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">constructor</span>() &#123; &#125;</div><div class=\"line\">  ngOnInit() &#123;</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p>Para que este componente sea conocido ha de estar al menos declarado y exportado en algn mdulo. En este caso aparece en el fichero <code>movimientos-module.ts</code></p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; CommonModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</div><div class=\"line\"><span class=\"comment\">/** Importa un componente que declara y que luego exporta */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientosComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./movimientos.component'</span>;</div><div class=\"line\"></div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  imports: [</div><div class=\"line\">    CommonModule</div><div class=\"line\">  ],<span class=\"comment\">// dependencias de otros mdulos</span></div><div class=\"line\">  declarations: [</div><div class=\"line\">    MovimientosComponent</div><div class=\"line\">  ],<span class=\"comment\">// Componente que el mdulo mismo declara</span></div><div class=\"line\">  exports: [</div><div class=\"line\">    MovimientosComponent</div><div class=\"line\">  ] <span class=\"comment\">// exporta los componentes importables desde otros mdulos</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MovimientosModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><h3 id=\"Consumo-desde-un-componente-padre\"><a href=\"#Consumo-desde-un-componente-padre\" class=\"headerlink\" title=\"Consumo desde un componente padre\"></a>Consumo desde un componente padre</h3><p>El componente <code>movimientos</code> est creado pero nadie lo usa. Para darle utilidad hay que consumirlo. Vamos tocar los ficheros app.module.ts y app.component.html Son siempre estos tres sencillos pasos:</p><ul><li><p>1- Importar el mdulo que lo exporta</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 1 importacin del cdigo del mdulo funcional</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientosModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./movimientos/movimientos.module'</span>;</div></pre></td></tr></table></figure></li><li><p>2- Registro en el array de importaciones del mdulo raz</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">...</div><div class=\"line\">imports:[..., MovimientosModule] <span class=\"comment\">// 2 registro del modulo importado con todo lo que exporta</span></div><div class=\"line\">...</div></pre></td></tr></table></figure></li><li><p>3- Uso del componente como un elemento html en la plantilla del padre</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--enlace con propiedades del componente--&gt;</span></div><div class=\"line\">  &#123;&#123;title&#125;&#125;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!-- 3 los componentes personalizados se usan como elementos estndar en html--&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--componente movimientos--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-movimientos</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-movimientos</span>&gt;</span></div></pre></td></tr></table></figure></li></ul><p>Esta manera de encapsular componentes unos dentro de otros permite crear <strong>grandes aplicaciones de tamao empresarial</strong> sin sacrificar la limpieza del cdigo. Cada componente debe disearse de forma que resuelva un problema de negocio concreto, por tanto manejable. Y si puede ser <strong>reutilizable</strong> mucho mejor.</p><p>La agrupacin de componentes en mdulos ayuda a mantener la aplicacin organizada.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a></p>","site":{"data":{}},"excerpt":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a></p></blockquote><hr><blockquote><p>Cdigo asociado en GitHub: <a href=\"https://github.com/AcademiaBinaria/angular2/tree/master/2-modulos\" target=\"_blank\" rel=\"external\">angular2/2-modulos/</a></p></blockquote><p>Los componentes son los bloques de construccin de la web moderna. En Angular 2 sustituyen al viejo par Vista-Controlador, el cual ya era opcional en las ltimas versiones 1.x Ahora <strong>el componente es el rey</strong>.</p><p>Las aplicaciones en Angular2 se desarrollan como <strong>rboles de componentes</strong>. Estos rboles pueden llegar a ser muy frondosos y conviene dirigir su crecimiento agrupndolos en <strong>mdulos</strong> para no perderse. Yo procuro estructurarlo en niveles para una mejor comprensin. En cada nivel se crea un mdulo y dentro de l se declaran los componentes.</p><ul><li>1- Nivel <strong>Raz</strong>:<br>Toda aplicacin parte de un componente raz. Suele recibir el nombre de la aplicacin desarrollada y el sufijo <code>App</code> o simplemente <code>App</code>.</li><li>2- Nivel <strong>Troncal</strong>:<br>Generalmente dos o tres componentes troncales para la estructura de las pginas. Es comn el patrn <em>Navegador-Contenedor</em>, con algn elemento auxiliar para ayudas, mensajes, mens complejos</li><li>3- Nivel de <strong>Ramas</strong>:<br>En este smil, las ramas equivalen a rutas o vistas de la aplicacin. En un <em>SPA</em> cada ruta tiene una vista asociada que se carga dentro del componente troncal contenedor</li><li>4- Nivel de <strong>Hojas</strong>:<br>Cada una de las vistas est a su vez formada por mltiples componentes de negocio a modo de hojas.</li></ul><p><img src=\"/images/ng2-Arbol-de-componentes.jpg\" alt=\"rbol de componentes en una aplicacin Angular 2\"></p><blockquote><p>Con la salvedad de que muchos de estos componentes los puedes reutilizar en distintas vistas.</p></blockquote>","more":"<h2 id=\"Modulos\"><a href=\"#Modulos\" class=\"headerlink\" title=\"Mdulos\"></a>Mdulos</h2><p>Los rboles de componentes pueden ocultarnos fcilmente el bosque de nuestra aplicacin. <strong>Los mdulos son agrupaciones de componentes.</strong> Nos ayudan a mantener un orden y a encapsular funcionalidad para crear aplicaciones desacopladas con bloques re-utilizables.</p><blockquote><p>No confundir con los mdulos de <em>JavaScript ES6</em> o de T<em>ypeScript</em>. En estos casos se les llama mdulos a los ficheros de cdigo que exportan funcionalidad.</p></blockquote><p>Podemos imaginar un mdulo como una fbrica de funcionalidad.</p><ol><li><strong>Importa</strong> componentes que otros mdulos exportan.</li><li><strong>Declara</strong> los componentes que el mismo fabrica.</li><li><strong>Exporta</strong> algunos de estos componentes, para que los consuman otros mdulos.</li></ol><h3 id=\"Anatomia-de-un-Componente\"><a href=\"#Anatomia-de-un-Componente\" class=\"headerlink\" title=\"Anatoma de un Componente\"></a>Anatoma de un Componente</h3><p>En el artculo de <a href=\"http://academia-binaria.com/hola-mundo-en-angular-2/\">bienvenida a Angular 2</a> tenamos una aplicacin de un slo mdulo con un slo componente. Y nos sirvi para ver su <strong>estructura</strong>: plantilla, decorador y clase.</p><p><img src=\"/images/ng2Component--1-.jpg\" alt=\"Estructura interna de un componente Angular 2\"></p><p>La <strong>plantilla</strong> en HTML y la <strong>clase</strong> en JS equivalen a las antiguas vistas y controladores. La <strong>metadata</strong> une ambos mundos y registra el componente para que interacciones con el resto del mundo Angular.</p><blockquote><p>La comunicacin de datos entre la plantilla y el componente se realiza siguiendo un remozado workflow de propiedades y eventos. El nuevo <em>data-binding</em> de Angular2 merece estudio en detalle pues su sintaxis ha cambiado para poder estar a la altura del rendimiento exigido.</p></blockquote><h3 id=\"Generacion-de-modulos-y-componentes-con-angular-cli\"><a href=\"#Generacion-de-modulos-y-componentes-con-angular-cli\" class=\"headerlink\" title=\"Generacin de mdulos y componentes con angular-cli\"></a>Generacin de mdulos y componentes con angular-cli</h3><p>Sobre la base de ese Hola Mundo vamos construir una mini aplicacin muy sencilla para guardar movimientos econmicos. El <em>To Do List</em> de los ingresos y gastos.</p><p>Empezar creando <strong>otro mdulo con su componente para ser integrado</strong> en el componente raz del mdulo raz. Por ahora ser un componente de negocio vaco: el componente <code>movimientos</code>. Puedes escribir a mano cada nuevo mdulo o componente, pero si usas <a href=\"https://cli.angular.io/\" target=\"_blank\" rel=\"external\">Angular CLI</a> lo tendrs generado con un slo comando:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">ng g m movimientos</div><div class=\"line\">``` </div><div class=\"line\"></div><div class=\"line\">Vers que se ha creado una carpeta llamada `movimientos` con una estructura que pronto te ser muy familiar. Para empezar un archivo para el nuevo mdulo, el `movimientos-module.ts`. Despus una serie de ficheros para crear su componente principal. Un fichero `movimientos-component.ts` para la clase controladora y el decorador con la *metadata*, y otro fichero `movimientos-component.html` para la plantilla.</div><div class=\"line\"></div><div class=\"line\">Reproduzco ahora su contenido bsico. Primero la plantilla HTML</div><div class=\"line\"></div><div class=\"line\">```html</div><div class=\"line\">&lt;p&gt;</div><div class=\"line\">  movimientos works!</div><div class=\"line\">&lt;/p&gt;</div></pre></td></tr></table></figure><p>Y ahora la definicin del componente en <em>TypeScript</em>. El cual no sabe en qu mdulo acabar.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"comment\">// decoracin con metadata para el componente</span></div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  selector: <span class=\"string\">'app-movimientos'</span>, <span class=\"comment\">// ojo al prefijo, por defecto app</span></div><div class=\"line\">  templateUrl: <span class=\"string\">'./movimientos.component.html'</span>, <span class=\"comment\">// podran ser inline</span></div><div class=\"line\">  styleUrls: [<span class=\"string\">'./movimientos.component.css'</span>] <span class=\"comment\">// podran ser inline</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MovimientosComponent</span> <span class=\"title\">implements</span> <span class=\"title\">OnInit</span> </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">constructor</span>() &#123; &#125;</div><div class=\"line\">  ngOnInit() &#123;</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p>Para que este componente sea conocido ha de estar al menos declarado y exportado en algn mdulo. En este caso aparece en el fichero <code>movimientos-module.ts</code></p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; CommonModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</div><div class=\"line\"><span class=\"comment\">/** Importa un componente que declara y que luego exporta */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientosComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./movimientos.component'</span>;</div><div class=\"line\"></div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  imports: [</div><div class=\"line\">    CommonModule</div><div class=\"line\">  ],<span class=\"comment\">// dependencias de otros mdulos</span></div><div class=\"line\">  declarations: [</div><div class=\"line\">    MovimientosComponent</div><div class=\"line\">  ],<span class=\"comment\">// Componente que el mdulo mismo declara</span></div><div class=\"line\">  exports: [</div><div class=\"line\">    MovimientosComponent</div><div class=\"line\">  ] <span class=\"comment\">// exporta los componentes importables desde otros mdulos</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MovimientosModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><h3 id=\"Consumo-desde-un-componente-padre\"><a href=\"#Consumo-desde-un-componente-padre\" class=\"headerlink\" title=\"Consumo desde un componente padre\"></a>Consumo desde un componente padre</h3><p>El componente <code>movimientos</code> est creado pero nadie lo usa. Para darle utilidad hay que consumirlo. Vamos tocar los ficheros app.module.ts y app.component.html Son siempre estos tres sencillos pasos:</p><ul><li><p>1- Importar el mdulo que lo exporta</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 1 importacin del cdigo del mdulo funcional</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientosModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./movimientos/movimientos.module'</span>;</div></pre></td></tr></table></figure></li><li><p>2- Registro en el array de importaciones del mdulo raz</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">...</div><div class=\"line\">imports:[..., MovimientosModule] <span class=\"comment\">// 2 registro del modulo importado con todo lo que exporta</span></div><div class=\"line\">...</div></pre></td></tr></table></figure></li><li><p>3- Uso del componente como un elemento html en la plantilla del padre</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--enlace con propiedades del componente--&gt;</span></div><div class=\"line\">  &#123;&#123;title&#125;&#125;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!-- 3 los componentes personalizados se usan como elementos estndar en html--&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--componente movimientos--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-movimientos</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-movimientos</span>&gt;</span></div></pre></td></tr></table></figure></li></ul><p>Esta manera de encapsular componentes unos dentro de otros permite crear <strong>grandes aplicaciones de tamao empresarial</strong> sin sacrificar la limpieza del cdigo. Cada componente debe disearse de forma que resuelva un problema de negocio concreto, por tanto manejable. Y si puede ser <strong>reutilizable</strong> mucho mejor.</p><p>La agrupacin de componentes en mdulos ayuda a mantener la aplicacin organizada.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a></p>"},{"title":"Formularios de datos en Angular2","id":"21","updated":"2016-06-22T16:05:58.000Z","date":"2016-06-22T14:32:34.000Z","thumbnail":"/css/images/angular.jpg","_content":"\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/)\n\n---\n\nLos formularios en AngularJS fueron un xito inicial debido entre otras coas al *double binding*. Otra cosa que no fue nunca simple es la **validacin de controles en los formularios**. En Angular 2 y con la ltima versin RC3 la cosa mejora, pero es an un *Work in progress.*\n  \n<!-- more -->\n\n### Dependencias\nCon el lo de versiones de los ltimos das, conviene que os muestre con qu he hecho mi prueba.\n```json\n\"dependencies\": {\n    \"@angular/common\": \"2.0.0-rc.3\",\n    \"@angular/compiler\": \"2.0.0-rc.3\",\n    \"@angular/core\": \"2.0.0-rc.3\",\n    \"@angular/forms\": \"^0.1.1\",\n    \"@angular/http\": \"2.0.0-rc.3\",\n    \"@angular/platform-browser\": \"2.0.0-rc.3\",\n    \"@angular/platform-browser-dynamic\": \"2.0.0-rc.3\",\n    \"@angular/router\": \"3.0.0-alpha.7\",\n    \"es6-shim\": \"^0.35.0\",\n    \"reflect-metadata\": \"0.1.3\",\n    \"rxjs\": \"5.0.0-beta.6\",\n    \"systemjs\": \"0.19.26\",\n    \"zone.js\": \"^0.6.12\"\n  }\n```\n\nComo veis estn actualizadas a la `RC.3` y `forms 0.1.1`.\n> Si usas **SystemJS**, acurdate de incluir `@angular/forms` en el fichero `system-config.json`\n\nEn el `main.ts` debemos registrar los *providers* que permiten la convivencia de la actual versin de *forms* y la anterior (de la semana pasada) ya obsoleta.\n\n```javascript\nimport { disableDeprecatedForms, provideForms } from '@angular/forms';\nbootstrap(CashFlowAppComponent,[\n  disableDeprecatedForms(),\n  provideForms()\n]);\n```\n\n### Plantillas html para hacer formularios\nVamos a tratar de mantener el **html limpio** hasta dnde sea posible. En un futuro espero que incluso sea prescindible y que se pueda generar de forma automtica a partir de datos de configuracin.\n```html\n<form [formGroup]=\"formularioMovimiento\">\n  <label>Tipo:</label>\n  <input type=\"text\" formControlName=\"tipo\">\n  <p>\n    <span *ngIf=\"formularioMovimiento.controls['tipo'].touched && !formularioMovimiento.controls['tipo'].valid\">\n      Necesitamos el tipo de movimiento\n    </span>\n  </p>\n  <label>Categora:</label>\n  <input type=\"text\" formControlName=\"categoria\"><p></p>\n  <label>Fecha:</label>\n  <input type=\"date\" formControlName=\"fecha\"><p></p>\n  <label>Importe:</label>\n  <input type=\"number\" formControlName=\"importe\"> <p>\n    <span *ngIf=\"formularioMovimiento.controls['importe'].touched && !formularioMovimiento.controls['importe'].valid\">\n      Necesitamos el tipo de movimiento\n    </span>\n  </p>\n  <button \n    type=\"submit\" \n    [disabled]=\"!formularioMovimiento.valid\"\n    (click)=\"guardarMovimiento()\" >Guardar\n  </button>\n</form>\n```\n\nSe incluyen la lgica para mostrar mensajes de validacin y activacin del botn de guardado. He optado por no usar la defincin de variables en la plantilla mediante `#`.\n\n### Lgica y datos en el componente\nTrataremos de llevar la **lgica de generacin y validacin de datos** al componente y programarlo en TypeScript. Puede ser por mi pasado *backender* pero me encuentro ms cmodo cuanto ms lejos de un lenguaje de marcas.\n \nPara empezar necesitamos registrar las herramientas. El proveedor `FormBuilder` nos ayuda a definir los controles asociados al formulario y sus validaciones.\n\n```javascript\nimport { REACTIVE_FORM_DIRECTIVES, FormBuilder, FormGroup, Validators  } from '@angular/forms';\n@Component({\n  directives: [REACTIVE_FORM_DIRECTIVES],\n  providers:[FormBuilder]\n})\n```\nEn el evento `OnInit` construimos la estructura de soporte al formulario. Se puede hacer mucho ms compleja, mediante la inclusin de grupos de controles anidados.\n\n```javascript\nngOnInit() {\n    this.formularioMovimiento = this.formBuilder.group({\n      tipo: ['',Validators.required],\n      categoria: [],\n      fecha: [],\n      importe:['',Validators.required]\n    });\n  }\n```\n\nAntes de enviar datos a un serviciop se pueden hacer validaciones y ttransformacipnes previas. El acceso a los valores del formulario se hace travs de su propiedad `.value`. Con esto ya realizaremos los envos a los servicios...\n\n```javascript\nguardarMovimiento() {       \n this.miServicio.Guardar(this.formularioMovimiento.value);\n}\n```\n### Validacin\nLa validacin temprana es el objetivo fundamental de un desarrollo de formularios. Es buena para el usuario y buena para el sistema. Angular2 facilita la implementacin de las validaciones estndar y permite la creacin de las tuyas propias.\n\nLo veremos en prximas entregas. Sgueme en [mi cuenta de twitter](https://twitter.com/albertobasalo) o suscrbete a la [revista mensual de Academia Binaria](http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339) y sers el primero en ser informado.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/)\n","source":"_posts/Formularios-de-datos-en-Angular2.md","raw":"---\ntitle: Formularios de datos en Angular2\ntags:  \n- Angular2\n- Forms\n- Tutorial\ncategories:\n- Introduccin \npermalink: formularios-de-datos-en-angular2\nid: 21\nupdated: 2016-06-22 18:05:58\ndate: 2016-06-22 16:32:34\nthumbnail: /css/images/angular.jpg\n---\n\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/)\n\n---\n\nLos formularios en AngularJS fueron un xito inicial debido entre otras coas al *double binding*. Otra cosa que no fue nunca simple es la **validacin de controles en los formularios**. En Angular 2 y con la ltima versin RC3 la cosa mejora, pero es an un *Work in progress.*\n  \n<!-- more -->\n\n### Dependencias\nCon el lo de versiones de los ltimos das, conviene que os muestre con qu he hecho mi prueba.\n```json\n\"dependencies\": {\n    \"@angular/common\": \"2.0.0-rc.3\",\n    \"@angular/compiler\": \"2.0.0-rc.3\",\n    \"@angular/core\": \"2.0.0-rc.3\",\n    \"@angular/forms\": \"^0.1.1\",\n    \"@angular/http\": \"2.0.0-rc.3\",\n    \"@angular/platform-browser\": \"2.0.0-rc.3\",\n    \"@angular/platform-browser-dynamic\": \"2.0.0-rc.3\",\n    \"@angular/router\": \"3.0.0-alpha.7\",\n    \"es6-shim\": \"^0.35.0\",\n    \"reflect-metadata\": \"0.1.3\",\n    \"rxjs\": \"5.0.0-beta.6\",\n    \"systemjs\": \"0.19.26\",\n    \"zone.js\": \"^0.6.12\"\n  }\n```\n\nComo veis estn actualizadas a la `RC.3` y `forms 0.1.1`.\n> Si usas **SystemJS**, acurdate de incluir `@angular/forms` en el fichero `system-config.json`\n\nEn el `main.ts` debemos registrar los *providers* que permiten la convivencia de la actual versin de *forms* y la anterior (de la semana pasada) ya obsoleta.\n\n```javascript\nimport { disableDeprecatedForms, provideForms } from '@angular/forms';\nbootstrap(CashFlowAppComponent,[\n  disableDeprecatedForms(),\n  provideForms()\n]);\n```\n\n### Plantillas html para hacer formularios\nVamos a tratar de mantener el **html limpio** hasta dnde sea posible. En un futuro espero que incluso sea prescindible y que se pueda generar de forma automtica a partir de datos de configuracin.\n```html\n<form [formGroup]=\"formularioMovimiento\">\n  <label>Tipo:</label>\n  <input type=\"text\" formControlName=\"tipo\">\n  <p>\n    <span *ngIf=\"formularioMovimiento.controls['tipo'].touched && !formularioMovimiento.controls['tipo'].valid\">\n      Necesitamos el tipo de movimiento\n    </span>\n  </p>\n  <label>Categora:</label>\n  <input type=\"text\" formControlName=\"categoria\"><p></p>\n  <label>Fecha:</label>\n  <input type=\"date\" formControlName=\"fecha\"><p></p>\n  <label>Importe:</label>\n  <input type=\"number\" formControlName=\"importe\"> <p>\n    <span *ngIf=\"formularioMovimiento.controls['importe'].touched && !formularioMovimiento.controls['importe'].valid\">\n      Necesitamos el tipo de movimiento\n    </span>\n  </p>\n  <button \n    type=\"submit\" \n    [disabled]=\"!formularioMovimiento.valid\"\n    (click)=\"guardarMovimiento()\" >Guardar\n  </button>\n</form>\n```\n\nSe incluyen la lgica para mostrar mensajes de validacin y activacin del botn de guardado. He optado por no usar la defincin de variables en la plantilla mediante `#`.\n\n### Lgica y datos en el componente\nTrataremos de llevar la **lgica de generacin y validacin de datos** al componente y programarlo en TypeScript. Puede ser por mi pasado *backender* pero me encuentro ms cmodo cuanto ms lejos de un lenguaje de marcas.\n \nPara empezar necesitamos registrar las herramientas. El proveedor `FormBuilder` nos ayuda a definir los controles asociados al formulario y sus validaciones.\n\n```javascript\nimport { REACTIVE_FORM_DIRECTIVES, FormBuilder, FormGroup, Validators  } from '@angular/forms';\n@Component({\n  directives: [REACTIVE_FORM_DIRECTIVES],\n  providers:[FormBuilder]\n})\n```\nEn el evento `OnInit` construimos la estructura de soporte al formulario. Se puede hacer mucho ms compleja, mediante la inclusin de grupos de controles anidados.\n\n```javascript\nngOnInit() {\n    this.formularioMovimiento = this.formBuilder.group({\n      tipo: ['',Validators.required],\n      categoria: [],\n      fecha: [],\n      importe:['',Validators.required]\n    });\n  }\n```\n\nAntes de enviar datos a un serviciop se pueden hacer validaciones y ttransformacipnes previas. El acceso a los valores del formulario se hace travs de su propiedad `.value`. Con esto ya realizaremos los envos a los servicios...\n\n```javascript\nguardarMovimiento() {       \n this.miServicio.Guardar(this.formularioMovimiento.value);\n}\n```\n### Validacin\nLa validacin temprana es el objetivo fundamental de un desarrollo de formularios. Es buena para el usuario y buena para el sistema. Angular2 facilita la implementacin de las validaciones estndar y permite la creacin de las tuyas propias.\n\nLo veremos en prximas entregas. Sgueme en [mi cuenta de twitter](https://twitter.com/albertobasalo) o suscrbete a la [revista mensual de Academia Binaria](http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339) y sers el primero en ser informado.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/)\n","slug":"formularios-de-datos-en-angular2","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvg1000oiwd3iw0obsh1","content":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a></p></blockquote><hr><p>Los formularios en AngularJS fueron un xito inicial debido entre otras coas al <em>double binding</em>. Otra cosa que no fue nunca simple es la <strong>validacin de controles en los formularios</strong>. En Angular 2 y con la ltima versin RC3 la cosa mejora, pero es an un <em>Work in progress.</em></p><a id=\"more\"></a><h3 id=\"Dependencias\"><a href=\"#Dependencias\" class=\"headerlink\" title=\"Dependencias\"></a>Dependencias</h3><p>Con el lo de versiones de los ltimos das, conviene que os muestre con qu he hecho mi prueba.<br></p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">\"dependencies\": &#123;</div><div class=\"line\">    \"@angular/common\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/compiler\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/core\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/forms\": \"^0.1.1\",</div><div class=\"line\">    \"@angular/http\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/platform-browser\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/platform-browser-dynamic\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/router\": \"3.0.0-alpha.7\",</div><div class=\"line\">    \"es6-shim\": \"^0.35.0\",</div><div class=\"line\">    \"reflect-metadata\": \"0.1.3\",</div><div class=\"line\">    \"rxjs\": \"5.0.0-beta.6\",</div><div class=\"line\">    \"systemjs\": \"0.19.26\",</div><div class=\"line\">    \"zone.js\": \"^0.6.12\"</div><div class=\"line\">  &#125;</div></pre></td></tr></table></figure><p></p><p>Como veis estn actualizadas a la <code>RC.3</code> y <code>forms 0.1.1</code>.</p><blockquote><p>Si usas <strong>SystemJS</strong>, acurdate de incluir <code>@angular/forms</code> en el fichero <code>system-config.json</code></p></blockquote><p>En el <code>main.ts</code> debemos registrar los <em>providers</em> que permiten la convivencia de la actual versin de <em>forms</em> y la anterior (de la semana pasada) ya obsoleta.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; disableDeprecatedForms, provideForms &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</div><div class=\"line\">bootstrap(CashFlowAppComponent,[</div><div class=\"line\">  disableDeprecatedForms(),</div><div class=\"line\">  provideForms()</div><div class=\"line\">]);</div></pre></td></tr></table></figure><h3 id=\"Plantillas-html-para-hacer-formularios\"><a href=\"#Plantillas-html-para-hacer-formularios\" class=\"headerlink\" title=\"Plantillas html para hacer formularios\"></a>Plantillas html para hacer formularios</h3><p>Vamos a tratar de mantener el <strong>html limpio</strong> hasta dnde sea posible. En un futuro espero que incluso sea prescindible y que se pueda generar de forma automtica a partir de datos de configuracin.<br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> [<span class=\"attr\">formGroup</span>]=<span class=\"string\">\"formularioMovimiento\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Tipo:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">formControlName</span>=<span class=\"string\">\"tipo\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"formularioMovimiento.controls['tipo'].touched &amp;&amp; !formularioMovimiento.controls['tipo'].valid\"</span>&gt;</span></div><div class=\"line\">      Necesitamos el tipo de movimiento</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Categora:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">formControlName</span>=<span class=\"string\">\"categoria\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Fecha:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"date\"</span> <span class=\"attr\">formControlName</span>=<span class=\"string\">\"fecha\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Importe:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">formControlName</span>=<span class=\"string\">\"importe\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"formularioMovimiento.controls['importe'].touched &amp;&amp; !formularioMovimiento.controls['importe'].valid\"</span>&gt;</span></div><div class=\"line\">      Necesitamos el tipo de movimiento</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">button</span> </span></div><div class=\"line\"><span class=\"tag\">    <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> </span></div><div class=\"line\"><span class=\"tag\">    [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"!formularioMovimiento.valid\"</span></span></div><div class=\"line\"><span class=\"tag\">    (<span class=\"attr\">click</span>)=<span class=\"string\">\"guardarMovimiento()\"</span> &gt;</span>Guardar</div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></div></pre></td></tr></table></figure><p></p><p>Se incluyen la lgica para mostrar mensajes de validacin y activacin del botn de guardado. He optado por no usar la defincin de variables en la plantilla mediante <code>#</code>.</p><h3 id=\"Logica-y-datos-en-el-componente\"><a href=\"#Logica-y-datos-en-el-componente\" class=\"headerlink\" title=\"Lgica y datos en el componente\"></a>Lgica y datos en el componente</h3><p>Trataremos de llevar la <strong>lgica de generacin y validacin de datos</strong> al componente y programarlo en TypeScript. Puede ser por mi pasado <em>backender</em> pero me encuentro ms cmodo cuanto ms lejos de un lenguaje de marcas.</p><p>Para empezar necesitamos registrar las herramientas. El proveedor <code>FormBuilder</code> nos ayuda a definir los controles asociados al formulario y sus validaciones.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; REACTIVE_FORM_DIRECTIVES, FormBuilder, FormGroup, Validators  &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  directives: [REACTIVE_FORM_DIRECTIVES],</div><div class=\"line\">  providers:[FormBuilder]</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure><p>En el evento <code>OnInit</code> construimos la estructura de soporte al formulario. Se puede hacer mucho ms compleja, mediante la inclusin de grupos de controles anidados.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">ngOnInit() &#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.formularioMovimiento = <span class=\"keyword\">this</span>.formBuilder.group(&#123;</div><div class=\"line\">      tipo: [<span class=\"string\">''</span>,Validators.required],</div><div class=\"line\">      categoria: [],</div><div class=\"line\">      fecha: [],</div><div class=\"line\">      importe:[<span class=\"string\">''</span>,Validators.required]</div><div class=\"line\">    &#125;);</div><div class=\"line\">  &#125;</div></pre></td></tr></table></figure><p>Antes de enviar datos a un serviciop se pueden hacer validaciones y ttransformacipnes previas. El acceso a los valores del formulario se hace travs de su propiedad <code>.value</code>. Con esto ya realizaremos los envos a los servicios</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">guardarMovimiento() &#123;       </div><div class=\"line\"> <span class=\"keyword\">this</span>.miServicio.Guardar(<span class=\"keyword\">this</span>.formularioMovimiento.value);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><h3 id=\"Validacion\"><a href=\"#Validacion\" class=\"headerlink\" title=\"Validacin\"></a>Validacin</h3><p>La validacin temprana es el objetivo fundamental de un desarrollo de formularios. Es buena para el usuario y buena para el sistema. Angular2 facilita la implementacin de las validaciones estndar y permite la creacin de las tuyas propias.</p><p>Lo veremos en prximas entregas. Sgueme en <a href=\"https://twitter.com/albertobasalo\" target=\"_blank\" rel=\"external\">mi cuenta de twitter</a> o suscrbete a la <a href=\"http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339\" target=\"_blank\" rel=\"external\">revista mensual de Academia Binaria</a> y sers el primero en ser informado.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a></p>","site":{"data":{}},"excerpt":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a></p></blockquote><hr><p>Los formularios en AngularJS fueron un xito inicial debido entre otras coas al <em>double binding</em>. Otra cosa que no fue nunca simple es la <strong>validacin de controles en los formularios</strong>. En Angular 2 y con la ltima versin RC3 la cosa mejora, pero es an un <em>Work in progress.</em></p>","more":"<h3 id=\"Dependencias\"><a href=\"#Dependencias\" class=\"headerlink\" title=\"Dependencias\"></a>Dependencias</h3><p>Con el lo de versiones de los ltimos das, conviene que os muestre con qu he hecho mi prueba.<br></p><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">\"dependencies\": &#123;</div><div class=\"line\">    \"@angular/common\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/compiler\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/core\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/forms\": \"^0.1.1\",</div><div class=\"line\">    \"@angular/http\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/platform-browser\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/platform-browser-dynamic\": \"2.0.0-rc.3\",</div><div class=\"line\">    \"@angular/router\": \"3.0.0-alpha.7\",</div><div class=\"line\">    \"es6-shim\": \"^0.35.0\",</div><div class=\"line\">    \"reflect-metadata\": \"0.1.3\",</div><div class=\"line\">    \"rxjs\": \"5.0.0-beta.6\",</div><div class=\"line\">    \"systemjs\": \"0.19.26\",</div><div class=\"line\">    \"zone.js\": \"^0.6.12\"</div><div class=\"line\">  &#125;</div></pre></td></tr></table></figure><p></p><p>Como veis estn actualizadas a la <code>RC.3</code> y <code>forms 0.1.1</code>.</p><blockquote><p>Si usas <strong>SystemJS</strong>, acurdate de incluir <code>@angular/forms</code> en el fichero <code>system-config.json</code></p></blockquote><p>En el <code>main.ts</code> debemos registrar los <em>providers</em> que permiten la convivencia de la actual versin de <em>forms</em> y la anterior (de la semana pasada) ya obsoleta.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; disableDeprecatedForms, provideForms &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</div><div class=\"line\">bootstrap(CashFlowAppComponent,[</div><div class=\"line\">  disableDeprecatedForms(),</div><div class=\"line\">  provideForms()</div><div class=\"line\">]);</div></pre></td></tr></table></figure><h3 id=\"Plantillas-html-para-hacer-formularios\"><a href=\"#Plantillas-html-para-hacer-formularios\" class=\"headerlink\" title=\"Plantillas html para hacer formularios\"></a>Plantillas html para hacer formularios</h3><p>Vamos a tratar de mantener el <strong>html limpio</strong> hasta dnde sea posible. En un futuro espero que incluso sea prescindible y que se pueda generar de forma automtica a partir de datos de configuracin.<br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> [<span class=\"attr\">formGroup</span>]=<span class=\"string\">\"formularioMovimiento\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Tipo:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">formControlName</span>=<span class=\"string\">\"tipo\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"formularioMovimiento.controls['tipo'].touched &amp;&amp; !formularioMovimiento.controls['tipo'].valid\"</span>&gt;</span></div><div class=\"line\">      Necesitamos el tipo de movimiento</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Categora:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">formControlName</span>=<span class=\"string\">\"categoria\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Fecha:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"date\"</span> <span class=\"attr\">formControlName</span>=<span class=\"string\">\"fecha\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span>&gt;</span>Importe:<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">formControlName</span>=<span class=\"string\">\"importe\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"formularioMovimiento.controls['importe'].touched &amp;&amp; !formularioMovimiento.controls['importe'].valid\"</span>&gt;</span></div><div class=\"line\">      Necesitamos el tipo de movimiento</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">button</span> </span></div><div class=\"line\"><span class=\"tag\">    <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> </span></div><div class=\"line\"><span class=\"tag\">    [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"!formularioMovimiento.valid\"</span></span></div><div class=\"line\"><span class=\"tag\">    (<span class=\"attr\">click</span>)=<span class=\"string\">\"guardarMovimiento()\"</span> &gt;</span>Guardar</div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></div></pre></td></tr></table></figure><p></p><p>Se incluyen la lgica para mostrar mensajes de validacin y activacin del botn de guardado. He optado por no usar la defincin de variables en la plantilla mediante <code>#</code>.</p><h3 id=\"Logica-y-datos-en-el-componente\"><a href=\"#Logica-y-datos-en-el-componente\" class=\"headerlink\" title=\"Lgica y datos en el componente\"></a>Lgica y datos en el componente</h3><p>Trataremos de llevar la <strong>lgica de generacin y validacin de datos</strong> al componente y programarlo en TypeScript. Puede ser por mi pasado <em>backender</em> pero me encuentro ms cmodo cuanto ms lejos de un lenguaje de marcas.</p><p>Para empezar necesitamos registrar las herramientas. El proveedor <code>FormBuilder</code> nos ayuda a definir los controles asociados al formulario y sus validaciones.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; REACTIVE_FORM_DIRECTIVES, FormBuilder, FormGroup, Validators  &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  directives: [REACTIVE_FORM_DIRECTIVES],</div><div class=\"line\">  providers:[FormBuilder]</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure><p>En el evento <code>OnInit</code> construimos la estructura de soporte al formulario. Se puede hacer mucho ms compleja, mediante la inclusin de grupos de controles anidados.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">ngOnInit() &#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.formularioMovimiento = <span class=\"keyword\">this</span>.formBuilder.group(&#123;</div><div class=\"line\">      tipo: [<span class=\"string\">''</span>,Validators.required],</div><div class=\"line\">      categoria: [],</div><div class=\"line\">      fecha: [],</div><div class=\"line\">      importe:[<span class=\"string\">''</span>,Validators.required]</div><div class=\"line\">    &#125;);</div><div class=\"line\">  &#125;</div></pre></td></tr></table></figure><p>Antes de enviar datos a un serviciop se pueden hacer validaciones y ttransformacipnes previas. El acceso a los valores del formulario se hace travs de su propiedad <code>.value</code>. Con esto ya realizaremos los envos a los servicios</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">guardarMovimiento() &#123;       </div><div class=\"line\"> <span class=\"keyword\">this</span>.miServicio.Guardar(<span class=\"keyword\">this</span>.formularioMovimiento.value);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><h3 id=\"Validacion\"><a href=\"#Validacion\" class=\"headerlink\" title=\"Validacin\"></a>Validacin</h3><p>La validacin temprana es el objetivo fundamental de un desarrollo de formularios. Es buena para el usuario y buena para el sistema. Angular2 facilita la implementacin de las validaciones estndar y permite la creacin de las tuyas propias.</p><p>Lo veremos en prximas entregas. Sgueme en <a href=\"https://twitter.com/albertobasalo\" target=\"_blank\" rel=\"external\">mi cuenta de twitter</a> o suscrbete a la <a href=\"http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339\" target=\"_blank\" rel=\"external\">revista mensual de Academia Binaria</a> y sers el primero en ser informado.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a></p>"},{"title":"Introduccin a Bootstrap","id":"5","updated":"2015-11-12T14:56:16.000Z","date":"2015-11-05T16:44:55.000Z","_content":"\nBootstrap es un conjunto de archivos **HTML**, **CSS** y **Javascript** bien definidos y exhaustivamente testados que componen una slida estructura sobre la cual construir tu proyecto web o aplicacin.\n\n### Por qu debo utilizar Bootstrap en mi proyecto?\n\nEmpezar un proyecto web desde cero puede ser laborioso y te puede llevar bastante tiempo mientras vas construyendo los diferentes componentes y testndolos en los diversos navegadores.\n\nBootstrap te provee de una **biblioteca de componentes reusables** que puedes usar en cada proyecto, desde un sistema de rejilla o grid, una barra de navegacin, botones o estilos tipogrficos, todos ellos preparados para funcionar en todos los navegadores y adaptarse a todos los tipos de pantalla, tanto de mvil, como tablet o escritorio.\n\nCon Bootstrap te ahorras todo el trabajo inicial y adems tienes un cdigo revisado y testado que adems es **mantenible y escalable**, una slida estructura sobre la cual construir tu proyecto.\n\n### Prctica comn\n\nHoy en da su uso se encuentra **muy extendido**, y no es extrao encontrarse ofertas de trabajo en las cuales adems de conocimientos de HTML y CSS y Javascript se exige el dominio de Bootstrap. La **suave curva de aprendizaje** hace que sea una herramienta sencilla de usar por todos los miembros de un equipo de desarrollo, lo que incrementa la productividad.\n\n### Por dnde empezar?\n\nPara descargar la ltima versin debes acudir a la pgina http://getbootstrap.com/  y pulsar el botn **Download Bootstrap** una vez hecho esto te dirigir a la seccin **Download** de la pgina. Hay diferentes maneras de integrar Bootstrap en tu proyecto, en este artculo hablaremos de la primera de ellas que es descargarnos la carpeta comprimida.\n\nEn el apartado **Bootstrap** de la seccin **Download**  te encontrars otra vez el botn de **Download Bootstrap**, esta vez al clicarlo se descargar una carpeta comprimida que se compone de:\n\n-\tUna carpeta **css**: Incluye todos los estilos predefinidos por Bootstrap.\n-\tUna carpeta **fonts**: Incluye una fuente de iconos svg listos para usar.\n-\tUna carpeta **js**: Con todo el javascript necesario para que los componentes y efectos de Bootstrap funcionen.\n\nUna prctica comn es empezar el proyecto con estas carpetas e incluir a travs de tu HTML los archivos que vas a utilizar. Normalmente **bootstrap.min.css** y **bootstrap.min.js**. Adems debers **incluir JQuery** en tu proyecto para el correcto funcionamiento de los plugins.\n\nUna vez hecho esto te debera quedar un HTML inicial parecido a esto:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <!-- Los 3 metatags de arriba deben ir al principio del head -->\n    <title>Mi primer tema con Bootstrap</title>\n\n    <!-- Incluye el css de Bootstrap -->\n    <link href=\"css/bootstrap.min.css\" rel=\"stylesheet\">\n    <!-- Incluye nuestro propio CSS -->\n    <link href=\"css/styles.css\" rel=\"stylesheet\">\n\n\n    <!-- Este cdigo es necesario si queremos dar soporte a IE8 -->\n    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->\n    <!--[if lt IE 9]>\n      <script src=\"https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js\"></script>\n      <script src=\"https://oss.maxcdn.com/respond/1.4.2/respond.min.js\"></script>\n    <![endif]-->\n  </head>\n  <body>\n    <h1>Hola!</h1>\n\n    <!-- Incluye jQuery -->\n    <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js\"></script>\n    <!-- Incluye el JS de Bootstrap -->\n    <script src=\"js/bootstrap.min.js\"></script>\n  </body>\n</html>\n\n```\n\nCon esto ya estaras listo para empezar tu proyecto con Bootstrap y, con la ayuda de la documentacin de Bootstrap, ir incluyendo los mdulos y clases que necesites.\n\nCmo norma general **nunca modifiques los archivos originales de Bootstrap**, para aadir tus estilos propios o modificar los de bootstrap.css lo mejor es que crees una hoja de estilos independiente de bootstrap.css, lo mismo para el archivo bootstrap.js, as para actualizar tu versin de Bootstrap simplemente tendrs que descargarte la ltima versin y sustituir los archivos bootstrap.min.css y bootstrap.min.js por los de la nueva versin.\n\nEn siguientes artculos profundizaremos un poco mas sobre las diferentes opciones que tienes para incluir Bootstrap en tu proyecto.\n","source":"_posts/Introduccion-a-Bootstrap.md","raw":"---\ntitle: Introduccin a Bootstrap\ntags: \n- Bootstrap\ncategories:\n- Introduccin \npermalink: introduccion-a-bootstrap\nid: 5\nupdated: 2015/11/12 15:56:16\ndate: 2015/11/05 17:44:55\n---\n\nBootstrap es un conjunto de archivos **HTML**, **CSS** y **Javascript** bien definidos y exhaustivamente testados que componen una slida estructura sobre la cual construir tu proyecto web o aplicacin.\n\n### Por qu debo utilizar Bootstrap en mi proyecto?\n\nEmpezar un proyecto web desde cero puede ser laborioso y te puede llevar bastante tiempo mientras vas construyendo los diferentes componentes y testndolos en los diversos navegadores.\n\nBootstrap te provee de una **biblioteca de componentes reusables** que puedes usar en cada proyecto, desde un sistema de rejilla o grid, una barra de navegacin, botones o estilos tipogrficos, todos ellos preparados para funcionar en todos los navegadores y adaptarse a todos los tipos de pantalla, tanto de mvil, como tablet o escritorio.\n\nCon Bootstrap te ahorras todo el trabajo inicial y adems tienes un cdigo revisado y testado que adems es **mantenible y escalable**, una slida estructura sobre la cual construir tu proyecto.\n\n### Prctica comn\n\nHoy en da su uso se encuentra **muy extendido**, y no es extrao encontrarse ofertas de trabajo en las cuales adems de conocimientos de HTML y CSS y Javascript se exige el dominio de Bootstrap. La **suave curva de aprendizaje** hace que sea una herramienta sencilla de usar por todos los miembros de un equipo de desarrollo, lo que incrementa la productividad.\n\n### Por dnde empezar?\n\nPara descargar la ltima versin debes acudir a la pgina http://getbootstrap.com/  y pulsar el botn **Download Bootstrap** una vez hecho esto te dirigir a la seccin **Download** de la pgina. Hay diferentes maneras de integrar Bootstrap en tu proyecto, en este artculo hablaremos de la primera de ellas que es descargarnos la carpeta comprimida.\n\nEn el apartado **Bootstrap** de la seccin **Download**  te encontrars otra vez el botn de **Download Bootstrap**, esta vez al clicarlo se descargar una carpeta comprimida que se compone de:\n\n-\tUna carpeta **css**: Incluye todos los estilos predefinidos por Bootstrap.\n-\tUna carpeta **fonts**: Incluye una fuente de iconos svg listos para usar.\n-\tUna carpeta **js**: Con todo el javascript necesario para que los componentes y efectos de Bootstrap funcionen.\n\nUna prctica comn es empezar el proyecto con estas carpetas e incluir a travs de tu HTML los archivos que vas a utilizar. Normalmente **bootstrap.min.css** y **bootstrap.min.js**. Adems debers **incluir JQuery** en tu proyecto para el correcto funcionamiento de los plugins.\n\nUna vez hecho esto te debera quedar un HTML inicial parecido a esto:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <!-- Los 3 metatags de arriba deben ir al principio del head -->\n    <title>Mi primer tema con Bootstrap</title>\n\n    <!-- Incluye el css de Bootstrap -->\n    <link href=\"css/bootstrap.min.css\" rel=\"stylesheet\">\n    <!-- Incluye nuestro propio CSS -->\n    <link href=\"css/styles.css\" rel=\"stylesheet\">\n\n\n    <!-- Este cdigo es necesario si queremos dar soporte a IE8 -->\n    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->\n    <!--[if lt IE 9]>\n      <script src=\"https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js\"></script>\n      <script src=\"https://oss.maxcdn.com/respond/1.4.2/respond.min.js\"></script>\n    <![endif]-->\n  </head>\n  <body>\n    <h1>Hola!</h1>\n\n    <!-- Incluye jQuery -->\n    <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js\"></script>\n    <!-- Incluye el JS de Bootstrap -->\n    <script src=\"js/bootstrap.min.js\"></script>\n  </body>\n</html>\n\n```\n\nCon esto ya estaras listo para empezar tu proyecto con Bootstrap y, con la ayuda de la documentacin de Bootstrap, ir incluyendo los mdulos y clases que necesites.\n\nCmo norma general **nunca modifiques los archivos originales de Bootstrap**, para aadir tus estilos propios o modificar los de bootstrap.css lo mejor es que crees una hoja de estilos independiente de bootstrap.css, lo mismo para el archivo bootstrap.js, as para actualizar tu versin de Bootstrap simplemente tendrs que descargarte la ltima versin y sustituir los archivos bootstrap.min.css y bootstrap.min.js por los de la nueva versin.\n\nEn siguientes artculos profundizaremos un poco mas sobre las diferentes opciones que tienes para incluir Bootstrap en tu proyecto.\n","slug":"introduccion-a-bootstrap","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvg1000riwd3xv00rnbm","content":"<p>Bootstrap es un conjunto de archivos <strong>HTML</strong>, <strong>CSS</strong> y <strong>Javascript</strong> bien definidos y exhaustivamente testados que componen una slida estructura sobre la cual construir tu proyecto web o aplicacin.</p><h3 id=\"Por-que-debo-utilizar-Bootstrap-en-mi-proyecto\"><a href=\"#Por-que-debo-utilizar-Bootstrap-en-mi-proyecto\" class=\"headerlink\" title=\"Por qu debo utilizar Bootstrap en mi proyecto?\"></a>Por qu debo utilizar Bootstrap en mi proyecto?</h3><p>Empezar un proyecto web desde cero puede ser laborioso y te puede llevar bastante tiempo mientras vas construyendo los diferentes componentes y testndolos en los diversos navegadores.</p><p>Bootstrap te provee de una <strong>biblioteca de componentes reusables</strong> que puedes usar en cada proyecto, desde un sistema de rejilla o grid, una barra de navegacin, botones o estilos tipogrficos, todos ellos preparados para funcionar en todos los navegadores y adaptarse a todos los tipos de pantalla, tanto de mvil, como tablet o escritorio.</p><p>Con Bootstrap te ahorras todo el trabajo inicial y adems tienes un cdigo revisado y testado que adems es <strong>mantenible y escalable</strong>, una slida estructura sobre la cual construir tu proyecto.</p><h3 id=\"Practica-comun\"><a href=\"#Practica-comun\" class=\"headerlink\" title=\"Prctica comn\"></a>Prctica comn</h3><p>Hoy en da su uso se encuentra <strong>muy extendido</strong>, y no es extrao encontrarse ofertas de trabajo en las cuales adems de conocimientos de HTML y CSS y Javascript se exige el dominio de Bootstrap. La <strong>suave curva de aprendizaje</strong> hace que sea una herramienta sencilla de usar por todos los miembros de un equipo de desarrollo, lo que incrementa la productividad.</p><h3 id=\"Por-donde-empezar\"><a href=\"#Por-donde-empezar\" class=\"headerlink\" title=\"Por dnde empezar?\"></a>Por dnde empezar?</h3><p>Para descargar la ltima versin debes acudir a la pgina <a href=\"http://getbootstrap.com/\" target=\"_blank\" rel=\"external\">http://getbootstrap.com/</a> y pulsar el botn <strong>Download Bootstrap</strong> una vez hecho esto te dirigir a la seccin <strong>Download</strong> de la pgina. Hay diferentes maneras de integrar Bootstrap en tu proyecto, en este artculo hablaremos de la primera de ellas que es descargarnos la carpeta comprimida.</p><p>En el apartado <strong>Bootstrap</strong> de la seccin <strong>Download</strong> te encontrars otra vez el botn de <strong>Download Bootstrap</strong>, esta vez al clicarlo se descargar una carpeta comprimida que se compone de:</p><ul><li>Una carpeta <strong>css</strong>: Incluye todos los estilos predefinidos por Bootstrap.</li><li>Una carpeta <strong>fonts</strong>: Incluye una fuente de iconos svg listos para usar.</li><li>Una carpeta <strong>js</strong>: Con todo el javascript necesario para que los componentes y efectos de Bootstrap funcionen.</li></ul><p>Una prctica comn es empezar el proyecto con estas carpetas e incluir a travs de tu HTML los archivos que vas a utilizar. Normalmente <strong>bootstrap.min.css</strong> y <strong>bootstrap.min.js</strong>. Adems debers <strong>incluir JQuery</strong> en tu proyecto para el correcto funcionamiento de los plugins.</p><p>Una vez hecho esto te debera quedar un HTML inicial parecido a esto:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"IE=edge\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1\"</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Los 3 metatags de arriba deben ir al principio del head --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Mi primer tema con Bootstrap<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Incluye el css de Bootstrap --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">href</span>=<span class=\"string\">\"css/bootstrap.min.css\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Incluye nuestro propio CSS --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">href</span>=<span class=\"string\">\"css/styles.css\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Este cdigo es necesario si queremos dar soporte a IE8 --&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- WARNING: Respond.js doesn't work if you view the page via file:// --&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!--[if lt IE 9]&gt;</span></div><div class=\"line\"><span class=\"comment\">      &lt;script src=\"https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js\"&gt;&lt;/script&gt;</span></div><div class=\"line\"><span class=\"comment\">      &lt;script src=\"https://oss.maxcdn.com/respond/1.4.2/respond.min.js\"&gt;&lt;/script&gt;</span></div><div class=\"line\"><span class=\"comment\">    &lt;![endif]--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Hola!<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Incluye jQuery --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Incluye el JS de Bootstrap --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"js/bootstrap.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></div></pre></td></tr></table></figure><p>Con esto ya estaras listo para empezar tu proyecto con Bootstrap y, con la ayuda de la documentacin de Bootstrap, ir incluyendo los mdulos y clases que necesites.</p><p>Cmo norma general <strong>nunca modifiques los archivos originales de Bootstrap</strong>, para aadir tus estilos propios o modificar los de bootstrap.css lo mejor es que crees una hoja de estilos independiente de bootstrap.css, lo mismo para el archivo bootstrap.js, as para actualizar tu versin de Bootstrap simplemente tendrs que descargarte la ltima versin y sustituir los archivos bootstrap.min.css y bootstrap.min.js por los de la nueva versin.</p><p>En siguientes artculos profundizaremos un poco mas sobre las diferentes opciones que tienes para incluir Bootstrap en tu proyecto.</p>","site":{"data":{}},"excerpt":"","more":"<p>Bootstrap es un conjunto de archivos <strong>HTML</strong>, <strong>CSS</strong> y <strong>Javascript</strong> bien definidos y exhaustivamente testados que componen una slida estructura sobre la cual construir tu proyecto web o aplicacin.</p><h3 id=\"Por-que-debo-utilizar-Bootstrap-en-mi-proyecto\"><a href=\"#Por-que-debo-utilizar-Bootstrap-en-mi-proyecto\" class=\"headerlink\" title=\"Por qu debo utilizar Bootstrap en mi proyecto?\"></a>Por qu debo utilizar Bootstrap en mi proyecto?</h3><p>Empezar un proyecto web desde cero puede ser laborioso y te puede llevar bastante tiempo mientras vas construyendo los diferentes componentes y testndolos en los diversos navegadores.</p><p>Bootstrap te provee de una <strong>biblioteca de componentes reusables</strong> que puedes usar en cada proyecto, desde un sistema de rejilla o grid, una barra de navegacin, botones o estilos tipogrficos, todos ellos preparados para funcionar en todos los navegadores y adaptarse a todos los tipos de pantalla, tanto de mvil, como tablet o escritorio.</p><p>Con Bootstrap te ahorras todo el trabajo inicial y adems tienes un cdigo revisado y testado que adems es <strong>mantenible y escalable</strong>, una slida estructura sobre la cual construir tu proyecto.</p><h3 id=\"Practica-comun\"><a href=\"#Practica-comun\" class=\"headerlink\" title=\"Prctica comn\"></a>Prctica comn</h3><p>Hoy en da su uso se encuentra <strong>muy extendido</strong>, y no es extrao encontrarse ofertas de trabajo en las cuales adems de conocimientos de HTML y CSS y Javascript se exige el dominio de Bootstrap. La <strong>suave curva de aprendizaje</strong> hace que sea una herramienta sencilla de usar por todos los miembros de un equipo de desarrollo, lo que incrementa la productividad.</p><h3 id=\"Por-donde-empezar\"><a href=\"#Por-donde-empezar\" class=\"headerlink\" title=\"Por dnde empezar?\"></a>Por dnde empezar?</h3><p>Para descargar la ltima versin debes acudir a la pgina <a href=\"http://getbootstrap.com/\" target=\"_blank\" rel=\"external\">http://getbootstrap.com/</a> y pulsar el botn <strong>Download Bootstrap</strong> una vez hecho esto te dirigir a la seccin <strong>Download</strong> de la pgina. Hay diferentes maneras de integrar Bootstrap en tu proyecto, en este artculo hablaremos de la primera de ellas que es descargarnos la carpeta comprimida.</p><p>En el apartado <strong>Bootstrap</strong> de la seccin <strong>Download</strong> te encontrars otra vez el botn de <strong>Download Bootstrap</strong>, esta vez al clicarlo se descargar una carpeta comprimida que se compone de:</p><ul><li>Una carpeta <strong>css</strong>: Incluye todos los estilos predefinidos por Bootstrap.</li><li>Una carpeta <strong>fonts</strong>: Incluye una fuente de iconos svg listos para usar.</li><li>Una carpeta <strong>js</strong>: Con todo el javascript necesario para que los componentes y efectos de Bootstrap funcionen.</li></ul><p>Una prctica comn es empezar el proyecto con estas carpetas e incluir a travs de tu HTML los archivos que vas a utilizar. Normalmente <strong>bootstrap.min.css</strong> y <strong>bootstrap.min.js</strong>. Adems debers <strong>incluir JQuery</strong> en tu proyecto para el correcto funcionamiento de los plugins.</p><p>Una vez hecho esto te debera quedar un HTML inicial parecido a esto:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"IE=edge\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1\"</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Los 3 metatags de arriba deben ir al principio del head --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Mi primer tema con Bootstrap<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Incluye el css de Bootstrap --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">href</span>=<span class=\"string\">\"css/bootstrap.min.css\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Incluye nuestro propio CSS --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">href</span>=<span class=\"string\">\"css/styles.css\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Este cdigo es necesario si queremos dar soporte a IE8 --&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- WARNING: Respond.js doesn't work if you view the page via file:// --&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!--[if lt IE 9]&gt;</span></div><div class=\"line\"><span class=\"comment\">      &lt;script src=\"https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js\"&gt;&lt;/script&gt;</span></div><div class=\"line\"><span class=\"comment\">      &lt;script src=\"https://oss.maxcdn.com/respond/1.4.2/respond.min.js\"&gt;&lt;/script&gt;</span></div><div class=\"line\"><span class=\"comment\">    &lt;![endif]--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Hola!<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Incluye jQuery --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Incluye el JS de Bootstrap --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"js/bootstrap.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></div></pre></td></tr></table></figure><p>Con esto ya estaras listo para empezar tu proyecto con Bootstrap y, con la ayuda de la documentacin de Bootstrap, ir incluyendo los mdulos y clases que necesites.</p><p>Cmo norma general <strong>nunca modifiques los archivos originales de Bootstrap</strong>, para aadir tus estilos propios o modificar los de bootstrap.css lo mejor es que crees una hoja de estilos independiente de bootstrap.css, lo mismo para el archivo bootstrap.js, as para actualizar tu versin de Bootstrap simplemente tendrs que descargarte la ltima versin y sustituir los archivos bootstrap.min.css y bootstrap.min.js por los de la nueva versin.</p><p>En siguientes artculos profundizaremos un poco mas sobre las diferentes opciones que tienes para incluir Bootstrap en tu proyecto.</p>"},{"title":"Introduccin a MongoDB","id":"3","updated":"2015-08-25T04:26:25.000Z","date":"2015-08-15T09:00:54.000Z","_content":"\n## Qu es MongoDB?\n\n[MongoDB ](http://mongodb.org) es una base de datos orientada a **documentos** con esquema dinmico. Esto le permite ofrecer un alto **rendimiento** y facilita el desarrollo de aplicaciones. A cambio nos impide tener **Joins y Transacciones** algo muy habitual en bases de datos relacionales, pero sin lo que se puede vivir.\n\n### De qu se compone?\n\nDespus de su instalacin disponemos en un directorio de varios ejecutables que componen **la aplicacin servidora y sus herramientas**. El ejecutable fundamental ser `mongod` que es el servidor, es el motor de manejo de datos. Para acceder al servidor se nos ofrece una aplicacin de consola llamada `mongo`. Este es un intrprete de JavaScript y con l, podemos comunicarnos con la base de datos.\n\n### Cmo funciona?\n\nMongoDB almacena **documentos en formato JSON**. Bueno realmente lo hace en *BSON* que es un superconjunto de JSON. BSON es un formato binario que optimiza espacio, rendimiento y aporta funciones extra sobre JSON. Pero esencialmente para nosotros como usuarios toda la entrada salida es en JSON.\n\nComo los documentos se almacenan en JSON y la consola es un interprete JavaScript, la verdad es que **la consola ofrece una potencia enorme** para realizar operaciones de insercin, seleccin y manipulacin de datos. Cabe destacar que la consola es un programa e intrprete *sncrono*. Con algunos drivers como el de NodeJS el trabajo es puramente *asncrono*.\n\n### Se parece a SQL?\n\nSi vienes del mundo relacional, cuando llegues a Mongo tendrs que ajustar tu punto de mira al definir tus estructuras de datos. Como una primera gua te dir que hay una ligera **equivalencia entre Mongo y los SQL**\n\n*SQL* -> **MongoDB**\n\n*DataBase* -> **DataBase**\n\n*Table* -> **Collection**\n\n*Row* -> **Document**\n\n*Field* -> **Property**\n\n*Join* -> **Embedded**\n\n*Index* -> **Index**\n\n\nLa enorme diferencia est en que **en una coleccin se pueden guardar documentos con esquemas distintos**, y que esos esquemas pueden incluir documentos complejos, como arrays y subdocumentos. A esta falta de rigor al definir el esquema se la conoce\nen ingls como *schemaless*. Estamos ante una base de datos que almacena documentos de **esquema dinmico**.\n\nLo anterior es sin duda un valor diferencial a favor de Mongo pues facilita mucho el desarrollo y evolucin de las aplicaciones. Otra cosa es la ausencia de Joins y Transacciones entre colecciones que obliga a disear y codificar de manera metdica para garantizar **eficiencia e integridad** en las consultas. La sugerencia es aprovechar sus fortalezas para minimizar las debilidades.\n\n### Y entonces?\n\n**MongoDB** tienes campos de aplicacin en los que supera a los sistemas relacionales en potencia y facilidad de desarrollo. Pero, hay que saber **escoger la herramienta mas adecuada** para cada caso. Ahora que ya sabes un poco de que va esto de MongoDB puedes empezar a buscar aplicaciones dnde seguro que le sentar como un guante.","source":"_posts/Introduccion-a-MongoDB.md","raw":"---\ntitle: Introduccin a MongoDB\ntags: \n- MongoDB\ncategories:\n- Introduccin \npermalink: introduccion-a-mongodb\nid: 3\nupdated: 2015/08/25 06:26:25\ndate: 2015/08/15 11:00:54\n---\n\n## Qu es MongoDB?\n\n[MongoDB ](http://mongodb.org) es una base de datos orientada a **documentos** con esquema dinmico. Esto le permite ofrecer un alto **rendimiento** y facilita el desarrollo de aplicaciones. A cambio nos impide tener **Joins y Transacciones** algo muy habitual en bases de datos relacionales, pero sin lo que se puede vivir.\n\n### De qu se compone?\n\nDespus de su instalacin disponemos en un directorio de varios ejecutables que componen **la aplicacin servidora y sus herramientas**. El ejecutable fundamental ser `mongod` que es el servidor, es el motor de manejo de datos. Para acceder al servidor se nos ofrece una aplicacin de consola llamada `mongo`. Este es un intrprete de JavaScript y con l, podemos comunicarnos con la base de datos.\n\n### Cmo funciona?\n\nMongoDB almacena **documentos en formato JSON**. Bueno realmente lo hace en *BSON* que es un superconjunto de JSON. BSON es un formato binario que optimiza espacio, rendimiento y aporta funciones extra sobre JSON. Pero esencialmente para nosotros como usuarios toda la entrada salida es en JSON.\n\nComo los documentos se almacenan en JSON y la consola es un interprete JavaScript, la verdad es que **la consola ofrece una potencia enorme** para realizar operaciones de insercin, seleccin y manipulacin de datos. Cabe destacar que la consola es un programa e intrprete *sncrono*. Con algunos drivers como el de NodeJS el trabajo es puramente *asncrono*.\n\n### Se parece a SQL?\n\nSi vienes del mundo relacional, cuando llegues a Mongo tendrs que ajustar tu punto de mira al definir tus estructuras de datos. Como una primera gua te dir que hay una ligera **equivalencia entre Mongo y los SQL**\n\n*SQL* -> **MongoDB**\n\n*DataBase* -> **DataBase**\n\n*Table* -> **Collection**\n\n*Row* -> **Document**\n\n*Field* -> **Property**\n\n*Join* -> **Embedded**\n\n*Index* -> **Index**\n\n\nLa enorme diferencia est en que **en una coleccin se pueden guardar documentos con esquemas distintos**, y que esos esquemas pueden incluir documentos complejos, como arrays y subdocumentos. A esta falta de rigor al definir el esquema se la conoce\nen ingls como *schemaless*. Estamos ante una base de datos que almacena documentos de **esquema dinmico**.\n\nLo anterior es sin duda un valor diferencial a favor de Mongo pues facilita mucho el desarrollo y evolucin de las aplicaciones. Otra cosa es la ausencia de Joins y Transacciones entre colecciones que obliga a disear y codificar de manera metdica para garantizar **eficiencia e integridad** en las consultas. La sugerencia es aprovechar sus fortalezas para minimizar las debilidades.\n\n### Y entonces?\n\n**MongoDB** tienes campos de aplicacin en los que supera a los sistemas relacionales en potencia y facilidad de desarrollo. Pero, hay que saber **escoger la herramienta mas adecuada** para cada caso. Ahora que ya sabes un poco de que va esto de MongoDB puedes empezar a buscar aplicaciones dnde seguro que le sentar como un guante.","slug":"introduccion-a-mongodb","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvgh000uiwd3oi8jqncw","content":"<h2 id=\"Que-es-MongoDB\"><a href=\"#Que-es-MongoDB\" class=\"headerlink\" title=\"Qu es MongoDB?\"></a>Qu es MongoDB?</h2><p><a href=\"http://mongodb.org\" target=\"_blank\" rel=\"external\">MongoDB </a>es una base de datos orientada a <strong>documentos</strong> con esquema dinmico. Esto le permite ofrecer un alto <strong>rendimiento</strong> y facilita el desarrollo de aplicaciones. A cambio nos impide tener <strong>Joins y Transacciones</strong> algo muy habitual en bases de datos relacionales, pero sin lo que se puede vivir.</p><h3 id=\"De-que-se-compone\"><a href=\"#De-que-se-compone\" class=\"headerlink\" title=\"De qu se compone?\"></a>De qu se compone?</h3><p>Despus de su instalacin disponemos en un directorio de varios ejecutables que componen <strong>la aplicacin servidora y sus herramientas</strong>. El ejecutable fundamental ser <code>mongod</code> que es el servidor, es el motor de manejo de datos. Para acceder al servidor se nos ofrece una aplicacin de consola llamada <code>mongo</code>. Este es un intrprete de JavaScript y con l, podemos comunicarnos con la base de datos.</p><h3 id=\"Como-funciona\"><a href=\"#Como-funciona\" class=\"headerlink\" title=\"Cmo funciona?\"></a>Cmo funciona?</h3><p>MongoDB almacena <strong>documentos en formato JSON</strong>. Bueno realmente lo hace en <em>BSON</em> que es un superconjunto de JSON. BSON es un formato binario que optimiza espacio, rendimiento y aporta funciones extra sobre JSON. Pero esencialmente para nosotros como usuarios toda la entrada salida es en JSON.</p><p>Como los documentos se almacenan en JSON y la consola es un interprete JavaScript, la verdad es que <strong>la consola ofrece una potencia enorme</strong> para realizar operaciones de insercin, seleccin y manipulacin de datos. Cabe destacar que la consola es un programa e intrprete <em>sncrono</em>. Con algunos drivers como el de NodeJS el trabajo es puramente <em>asncrono</em>.</p><h3 id=\"Se-parece-a-SQL\"><a href=\"#Se-parece-a-SQL\" class=\"headerlink\" title=\"Se parece a SQL?\"></a>Se parece a SQL?</h3><p>Si vienes del mundo relacional, cuando llegues a Mongo tendrs que ajustar tu punto de mira al definir tus estructuras de datos. Como una primera gua te dir que hay una ligera <strong>equivalencia entre Mongo y los SQL</strong></p><p><em>SQL</em> -&gt; <strong>MongoDB</strong></p><p><em>DataBase</em> -&gt; <strong>DataBase</strong></p><p><em>Table</em> -&gt; <strong>Collection</strong></p><p><em>Row</em> -&gt; <strong>Document</strong></p><p><em>Field</em> -&gt; <strong>Property</strong></p><p><em>Join</em> -&gt; <strong>Embedded</strong></p><p><em>Index</em> -&gt; <strong>Index</strong></p><p>La enorme diferencia est en que <strong>en una coleccin se pueden guardar documentos con esquemas distintos</strong>, y que esos esquemas pueden incluir documentos complejos, como arrays y subdocumentos. A esta falta de rigor al definir el esquema se la conoce<br>en ingls como <em>schemaless</em>. Estamos ante una base de datos que almacena documentos de <strong>esquema dinmico</strong>.</p><p>Lo anterior es sin duda un valor diferencial a favor de Mongo pues facilita mucho el desarrollo y evolucin de las aplicaciones. Otra cosa es la ausencia de Joins y Transacciones entre colecciones que obliga a disear y codificar de manera metdica para garantizar <strong>eficiencia e integridad</strong> en las consultas. La sugerencia es aprovechar sus fortalezas para minimizar las debilidades.</p><h3 id=\"Y-entonces\"><a href=\"#Y-entonces\" class=\"headerlink\" title=\"Y entonces?\"></a>Y entonces?</h3><p><strong>MongoDB</strong> tienes campos de aplicacin en los que supera a los sistemas relacionales en potencia y facilidad de desarrollo. Pero, hay que saber <strong>escoger la herramienta mas adecuada</strong> para cada caso. Ahora que ya sabes un poco de que va esto de MongoDB puedes empezar a buscar aplicaciones dnde seguro que le sentar como un guante.</p>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Que-es-MongoDB\"><a href=\"#Que-es-MongoDB\" class=\"headerlink\" title=\"Qu es MongoDB?\"></a>Qu es MongoDB?</h2><p><a href=\"http://mongodb.org\" target=\"_blank\" rel=\"external\">MongoDB </a>es una base de datos orientada a <strong>documentos</strong> con esquema dinmico. Esto le permite ofrecer un alto <strong>rendimiento</strong> y facilita el desarrollo de aplicaciones. A cambio nos impide tener <strong>Joins y Transacciones</strong> algo muy habitual en bases de datos relacionales, pero sin lo que se puede vivir.</p><h3 id=\"De-que-se-compone\"><a href=\"#De-que-se-compone\" class=\"headerlink\" title=\"De qu se compone?\"></a>De qu se compone?</h3><p>Despus de su instalacin disponemos en un directorio de varios ejecutables que componen <strong>la aplicacin servidora y sus herramientas</strong>. El ejecutable fundamental ser <code>mongod</code> que es el servidor, es el motor de manejo de datos. Para acceder al servidor se nos ofrece una aplicacin de consola llamada <code>mongo</code>. Este es un intrprete de JavaScript y con l, podemos comunicarnos con la base de datos.</p><h3 id=\"Como-funciona\"><a href=\"#Como-funciona\" class=\"headerlink\" title=\"Cmo funciona?\"></a>Cmo funciona?</h3><p>MongoDB almacena <strong>documentos en formato JSON</strong>. Bueno realmente lo hace en <em>BSON</em> que es un superconjunto de JSON. BSON es un formato binario que optimiza espacio, rendimiento y aporta funciones extra sobre JSON. Pero esencialmente para nosotros como usuarios toda la entrada salida es en JSON.</p><p>Como los documentos se almacenan en JSON y la consola es un interprete JavaScript, la verdad es que <strong>la consola ofrece una potencia enorme</strong> para realizar operaciones de insercin, seleccin y manipulacin de datos. Cabe destacar que la consola es un programa e intrprete <em>sncrono</em>. Con algunos drivers como el de NodeJS el trabajo es puramente <em>asncrono</em>.</p><h3 id=\"Se-parece-a-SQL\"><a href=\"#Se-parece-a-SQL\" class=\"headerlink\" title=\"Se parece a SQL?\"></a>Se parece a SQL?</h3><p>Si vienes del mundo relacional, cuando llegues a Mongo tendrs que ajustar tu punto de mira al definir tus estructuras de datos. Como una primera gua te dir que hay una ligera <strong>equivalencia entre Mongo y los SQL</strong></p><p><em>SQL</em> -&gt; <strong>MongoDB</strong></p><p><em>DataBase</em> -&gt; <strong>DataBase</strong></p><p><em>Table</em> -&gt; <strong>Collection</strong></p><p><em>Row</em> -&gt; <strong>Document</strong></p><p><em>Field</em> -&gt; <strong>Property</strong></p><p><em>Join</em> -&gt; <strong>Embedded</strong></p><p><em>Index</em> -&gt; <strong>Index</strong></p><p>La enorme diferencia est en que <strong>en una coleccin se pueden guardar documentos con esquemas distintos</strong>, y que esos esquemas pueden incluir documentos complejos, como arrays y subdocumentos. A esta falta de rigor al definir el esquema se la conoce<br>en ingls como <em>schemaless</em>. Estamos ante una base de datos que almacena documentos de <strong>esquema dinmico</strong>.</p><p>Lo anterior es sin duda un valor diferencial a favor de Mongo pues facilita mucho el desarrollo y evolucin de las aplicaciones. Otra cosa es la ausencia de Joins y Transacciones entre colecciones que obliga a disear y codificar de manera metdica para garantizar <strong>eficiencia e integridad</strong> en las consultas. La sugerencia es aprovechar sus fortalezas para minimizar las debilidades.</p><h3 id=\"Y-entonces\"><a href=\"#Y-entonces\" class=\"headerlink\" title=\"Y entonces?\"></a>Y entonces?</h3><p><strong>MongoDB</strong> tienes campos de aplicacin en los que supera a los sistemas relacionales en potencia y facilidad de desarrollo. Pero, hay que saber <strong>escoger la herramienta mas adecuada</strong> para cada caso. Ahora que ya sabes un poco de que va esto de MongoDB puedes empezar a buscar aplicaciones dnde seguro que le sentar como un guante.</p>"},{"title":"Node 6.0.0 actualizacin con nvm","id":"11","updated":"2016-05-05T08:02:26.000Z","date":"2016-05-05T07:39:40.000Z","_content":"\nAcabamos de recibir la buena noticia de la versin 6 de **NodeJS**. En este caso con mejoras de rendimiento e incorporacin de sintaxis de **ES6**. Cmo obtener esta nueva versin?. Y sobretodo,  cmo manejar la convivencia de distintas versiones? La ayuda se llama [nvm](https://github.com/creationix/nvm) \n\nEstos son los pasos que has de seguir para instalar la herramienta.\n\nSe recomienda desinstalar las versiones de **node** y **npm** instaladas previamente. No es obligatorio.\n\n#### LINUX & OS X\n\n1- Comprobamos que tenemos instaladas las dependencias\n1.1 - Dependencias **Linux**\n```\nsudo apt-get update\nsudo apt-get install build-essential\n```\n\n1.2 -Dependencias **OSX** (herramientas de linea de comandos para XCode)\n```\nxcode-select --install\n```\n\n\n2- Descargamos y ejecutamos el script de instalacin\n\n```\t\ncurl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash\n```\n\n\n3- Comprobamos que est instalado **NVM**\n```\ncommand -v nvm \n```\n*debe devolver nvm*\n\n\n4- Instalamos la versin de Node que deseamos\n```\t\nnvm install 6.0.0\n```\n\n5- Elegimos la versin de Node instalada que deseamos usar\n\n```\t\nnvm use 6.0.0\n```\n\t\n#### WINDOWS\n\nPara **Windows** no existe una versin *nativa* de **nvm**, pero si hay dos opciones para gestionar las versiones de node instaladas.\n\n1- **nvm-windows**\n\thttps://github.com/coreybutler/nvm-windows\n\tEs un wrapper de npm para windows, el instalador se encuentra en la URL (https://github.com/coreybutler/nvm/releases).\n\t\nLos `comandos` para instalar y la versin de Node son los mismos que en Linux y OSX.\n\t\n2- **nodist**  \nEs un gestor de versiones parecido a NVM solo para Windows\n\tLa URL del instalador (https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe).\n\tLos comandos se encuentran en la documentacin. (https://github.com/marcelklehr/nodist)","source":"_posts/Node-6-0-0-actualizacion-con-nvm.md","raw":"---\ntitle: Node 6.0.0 actualizacin con nvm\ntags:  \n- NodeJS\ncategories:\n- Introduccin \npermalink: node-6-0-0-actualizacion-con-nvm\nid: 11\nupdated: '2016-05-05 10:02:26'\ndate: 2016-05-05 09:39:40\n---\n\nAcabamos de recibir la buena noticia de la versin 6 de **NodeJS**. En este caso con mejoras de rendimiento e incorporacin de sintaxis de **ES6**. Cmo obtener esta nueva versin?. Y sobretodo,  cmo manejar la convivencia de distintas versiones? La ayuda se llama [nvm](https://github.com/creationix/nvm) \n\nEstos son los pasos que has de seguir para instalar la herramienta.\n\nSe recomienda desinstalar las versiones de **node** y **npm** instaladas previamente. No es obligatorio.\n\n#### LINUX & OS X\n\n1- Comprobamos que tenemos instaladas las dependencias\n1.1 - Dependencias **Linux**\n```\nsudo apt-get update\nsudo apt-get install build-essential\n```\n\n1.2 -Dependencias **OSX** (herramientas de linea de comandos para XCode)\n```\nxcode-select --install\n```\n\n\n2- Descargamos y ejecutamos el script de instalacin\n\n```\t\ncurl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash\n```\n\n\n3- Comprobamos que est instalado **NVM**\n```\ncommand -v nvm \n```\n*debe devolver nvm*\n\n\n4- Instalamos la versin de Node que deseamos\n```\t\nnvm install 6.0.0\n```\n\n5- Elegimos la versin de Node instalada que deseamos usar\n\n```\t\nnvm use 6.0.0\n```\n\t\n#### WINDOWS\n\nPara **Windows** no existe una versin *nativa* de **nvm**, pero si hay dos opciones para gestionar las versiones de node instaladas.\n\n1- **nvm-windows**\n\thttps://github.com/coreybutler/nvm-windows\n\tEs un wrapper de npm para windows, el instalador se encuentra en la URL (https://github.com/coreybutler/nvm/releases).\n\t\nLos `comandos` para instalar y la versin de Node son los mismos que en Linux y OSX.\n\t\n2- **nodist**  \nEs un gestor de versiones parecido a NVM solo para Windows\n\tLa URL del instalador (https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe).\n\tLos comandos se encuentran en la documentacin. (https://github.com/marcelklehr/nodist)","slug":"node-6-0-0-actualizacion-con-nvm","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvgh000xiwd30fgjttck","content":"<p>Acabamos de recibir la buena noticia de la versin 6 de <strong>NodeJS</strong>. En este caso con mejoras de rendimiento e incorporacin de sintaxis de <strong>ES6</strong>. Cmo obtener esta nueva versin?. Y sobretodo, cmo manejar la convivencia de distintas versiones? La ayuda se llama <a href=\"https://github.com/creationix/nvm\" target=\"_blank\" rel=\"external\">nvm</a></p><p>Estos son los pasos que has de seguir para instalar la herramienta.</p><p>Se recomienda desinstalar las versiones de <strong>node</strong> y <strong>npm</strong> instaladas previamente. No es obligatorio.</p><h4 id=\"LINUX-amp-OS-X\"><a href=\"#LINUX-amp-OS-X\" class=\"headerlink\" title=\"LINUX &amp; OS X\"></a>LINUX &amp; OS X</h4><p>1- Comprobamos que tenemos instaladas las dependencias<br>1.1 - Dependencias <strong>Linux</strong><br></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-get update</div><div class=\"line\">sudo apt-get install build-essential</div></pre></td></tr></table></figure><p></p><p>1.2 -Dependencias <strong>OSX</strong> (herramientas de linea de comandos para XCode)<br></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">xcode-select --install</div></pre></td></tr></table></figure><p></p><p>2- Descargamos y ejecutamos el script de instalacin</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash</div></pre></td></tr></table></figure><p>3- Comprobamos que est instalado <strong>NVM</strong><br></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">command -v nvm</div></pre></td></tr></table></figure><p></p><p><em>debe devolver nvm</em></p><p>4- Instalamos la versin de Node que deseamos<br></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">nvm install 6.0.0</div></pre></td></tr></table></figure><p></p><p>5- Elegimos la versin de Node instalada que deseamos usar</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">nvm use 6.0.0</div></pre></td></tr></table></figure><h4 id=\"WINDOWS\"><a href=\"#WINDOWS\" class=\"headerlink\" title=\"WINDOWS\"></a>WINDOWS</h4><p>Para <strong>Windows</strong> no existe una versin <em>nativa</em> de <strong>nvm</strong>, pero si hay dos opciones para gestionar las versiones de node instaladas.</p><p>1- <strong>nvm-windows</strong><br><a href=\"https://github.com/coreybutler/nvm-windows\" target=\"_blank\" rel=\"external\">https://github.com/coreybutler/nvm-windows</a><br>Es un wrapper de npm para windows, el instalador se encuentra en la URL (<a href=\"https://github.com/coreybutler/nvm/releases\" target=\"_blank\" rel=\"external\">https://github.com/coreybutler/nvm/releases</a>).</p><p>Los <code>comandos</code> para instalar y la versin de Node son los mismos que en Linux y OSX.</p><p>2- <strong>nodist</strong><br>Es un gestor de versiones parecido a NVM solo para Windows<br>La URL del instalador (<a href=\"https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe\" target=\"_blank\" rel=\"external\">https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe</a>).<br>Los comandos se encuentran en la documentacin. (<a href=\"https://github.com/marcelklehr/nodist\" target=\"_blank\" rel=\"external\">https://github.com/marcelklehr/nodist</a>)</p>","site":{"data":{}},"excerpt":"","more":"<p>Acabamos de recibir la buena noticia de la versin 6 de <strong>NodeJS</strong>. En este caso con mejoras de rendimiento e incorporacin de sintaxis de <strong>ES6</strong>. Cmo obtener esta nueva versin?. Y sobretodo, cmo manejar la convivencia de distintas versiones? La ayuda se llama <a href=\"https://github.com/creationix/nvm\" target=\"_blank\" rel=\"external\">nvm</a></p><p>Estos son los pasos que has de seguir para instalar la herramienta.</p><p>Se recomienda desinstalar las versiones de <strong>node</strong> y <strong>npm</strong> instaladas previamente. No es obligatorio.</p><h4 id=\"LINUX-amp-OS-X\"><a href=\"#LINUX-amp-OS-X\" class=\"headerlink\" title=\"LINUX &amp; OS X\"></a>LINUX &amp; OS X</h4><p>1- Comprobamos que tenemos instaladas las dependencias<br>1.1 - Dependencias <strong>Linux</strong><br></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-get update</div><div class=\"line\">sudo apt-get install build-essential</div></pre></td></tr></table></figure><p></p><p>1.2 -Dependencias <strong>OSX</strong> (herramientas de linea de comandos para XCode)<br></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">xcode-select --install</div></pre></td></tr></table></figure><p></p><p>2- Descargamos y ejecutamos el script de instalacin</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash</div></pre></td></tr></table></figure><p>3- Comprobamos que est instalado <strong>NVM</strong><br></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">command -v nvm</div></pre></td></tr></table></figure><p></p><p><em>debe devolver nvm</em></p><p>4- Instalamos la versin de Node que deseamos<br></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">nvm install 6.0.0</div></pre></td></tr></table></figure><p></p><p>5- Elegimos la versin de Node instalada que deseamos usar</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">nvm use 6.0.0</div></pre></td></tr></table></figure><h4 id=\"WINDOWS\"><a href=\"#WINDOWS\" class=\"headerlink\" title=\"WINDOWS\"></a>WINDOWS</h4><p>Para <strong>Windows</strong> no existe una versin <em>nativa</em> de <strong>nvm</strong>, pero si hay dos opciones para gestionar las versiones de node instaladas.</p><p>1- <strong>nvm-windows</strong><br><a href=\"https://github.com/coreybutler/nvm-windows\" target=\"_blank\" rel=\"external\">https://github.com/coreybutler/nvm-windows</a><br>Es un wrapper de npm para windows, el instalador se encuentra en la URL (<a href=\"https://github.com/coreybutler/nvm/releases\" target=\"_blank\" rel=\"external\">https://github.com/coreybutler/nvm/releases</a>).</p><p>Los <code>comandos</code> para instalar y la versin de Node son los mismos que en Linux y OSX.</p><p>2- <strong>nodist</strong><br>Es un gestor de versiones parecido a NVM solo para Windows<br>La URL del instalador (<a href=\"https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe\" target=\"_blank\" rel=\"external\">https://github.com/marcelklehr/nodist/releases/download/v0.7.2/NodistSetup-v0.7.2.exe</a>).<br>Los comandos se encuentran en la documentacin. (<a href=\"https://github.com/marcelklehr/nodist\" target=\"_blank\" rel=\"external\">https://github.com/marcelklehr/nodist</a>)</p>"},{"title":"Hola Mundo Angular 2","id":"12","updated":"2016-10-31T11:36:28.000Z","date":"2016-05-18T14:10:18.000Z","_content":"\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Hola Angular CLI](../hola-angular-cli/)\n\n---\n\n>Cdigo asociado en GitHub: [angular2/1-HolaMundo/](https://github.com/AcademiaBinaria/angular2/tree/master/1-hola-mundo)\n\nQu lejanos aquellos tiempos dnde un [Hola Mundo en AngularJS](https://github.com/AcademiaBinaria/HolaAngularJS) se haca en 2 lneas de cdigo. Ahora necesitar miles de ficheros y media hora de explicacin. Pero el resultado valdr la pena. Estaremos en la pista de lanzamiento para crear **aplicaciones de nivel empresarial con Angular 2.**\n\nYa he explicado que Angular ha pasado [de framework a plataforma](http://academia-binaria.com/angular2-primeras-impresiones/), y que ya no es para aficionados. Grandes desarrollos en equipo requieren **herramientas y procedimientos** a la altura. La primera opcin que te recomiendo es [Angular CLI](https://cli.angular.io/), un generador de aplicaciones trufado de buenas prcticas y procedimientos. Por raro que te parezca, cualquier otra opcin es *an* ms compleja que la que te muestro.\n\n<!-- more -->\n\n## Preparando el entorno\nLas herramientas que voy a usar requieren [NodeJS](nodejs.org). Te recomiendo que instales una de sus ltimas versiones. Tras la instalacin tendrs acceso a [npm](npmjs.com) para poder instalar libreras y utilidades como Angular CLI.\n\n```\nnpm install -g angular-cli\n```\n\nA partir de ahora en tu linea de comandos podrs usar el programa `ng` seguido de algn comando como `new generate serve lint test e2e build`. Usaremos algunos en esta demo.\n\n## Creando aplicaciones y componentes\nEscoge un directorio en un disco con espacio libre. No es broma, hasta 300 mb o ms para empezar. Tranquilo, en distribucin la cosa pinta mucho mejor y Angular es muy ligero. Ahora teclea:\n\n\n```\nng new hola-angular-2\n```\n\nUnos segundos o minutos ms tarde... podrs abrir la recin creada carpeta, yo lo hago con [VSCode](https://code.visualstudio.com/), y explorar el contenido de sus 3 directorios y miles de ficheros!!!\n\nDespus del susto, tranquilidad de nuevo. La mayora son dependencias de terceros productos, herramientas necesarias para ejecutar aplicacin o para alguno de sus procesos de *test, lint o distribucin*. Centrmonos en el directorio `src` dnde estn los fuentes, el cdigo que tendramos que haber creado nosotros.\n\nDe un primer vistazo puede que slo reconozcas al viejo `index.html`. No te agobies, por ahora es suficiente. Contendr algo como esto:\n\n```html\n<!doctype html>\n<html>\n<head>\n  <meta charset=\"utf-8\">\n  <title>HolaAngular2</title>\n  <base href=\"/\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <link rel=\"icon\" type=\"image/x-icon\" href=\"favicon.ico\">\n</head>\n<body>\n  <!--Componente raz de la aplicacin-->\n  <app-root>Loading...</app-root>\n</body>\n</html>\n```\n\nDe lo que es Angular 2 lo nico interesante es el componente `<app-root>Loading...</app-root>`. Todo, incluida la aplicacin principal, debe ser definido y declarado como un componente. De hecho definiremos las aplicaciones Angular2 como rboles de componentes. Y tdodo rbol debe tener una raz. Mientras Angular no entre en fucionamiento, el susario ver el mensaje de *Loading...* despus la magia de Angular2 lo sustituir por el contenido del componente `app-root` predefinido por el generador. \n\n## TypeScript\nSin entrar en debates de [qu lenguaje usar para programar en Angular2](https://www.youtube.com/watch?v=OpS2R7rbpRg) te resumo mi posicin: \n\n1.- TypeScript te permite anotar tu **JavaScript con tipos**. Esto tiene dos ventajas: *intellisense* mientras codificas y chequeo de tipos cuando compilas.\n2.- TypeScript es la **nica opcin automatizada a da de hoy** con Angular CLI.\n\nPor lo dems no hay porqu alarmarse. [TypeScript](https://www.typescriptlang.org/) es un *superset de JavaScript ES6* con unas mejoras evidentes que no tardars en dominar. Eso si, tienes que aprender [JavaScript ES2015 o ES6](http://es6-features.org/).\n\nSabiendo esto, entra sin miedo en cualquier fichero de extensin `.ts` y vers que es muy parecido a cualquier `.js` de la nueva versin. Por ejemplo en el citado `main.ts` aparecer algo as:\n\n```javascript\n// importaciones de dependencias TypeScript al estilo ES6\n// primero los bsicos para compatibilidad con navegadores\nimport './polyfills.ts';\n// luego cosas de Angular\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\nimport { enableProdMode } from '@angular/core';\n// despus nuestro cdigo, empezando por la configuracin\nimport { environment } from './environments/environment';\n// y por ltimo la aplicacin a leda desde el mdulo raz, llamado app por convenio.\nimport { AppModule } from './app/';\n\n// condiciones para ejecutar en modo desarrollo o produccin\nif (environment.production) {\n  enableProdMode();\n}\n// arranque de la aplicacin invocando al mdulo raz\nplatformBrowserDynamic().bootstrapModule(AppModule);\n```\n\nCentrndonos en el cdigo que habremos de mantener fjate en la lnea `import { AppModule } from './app/';`. Le indica a *WebPack* que importe el contenido de la carpeta `./app/`. Para ello buscar en dicho directorio un archivo `index.ts`. Ese fichero sirve de ndice y contiene las instrucciones para exportar el cdigo interesante del resto de la carpeta. En nuestro caso son el mdulo y el componente raz. \n\n## El mdulo raz\nLas aplicaciones Angular2 estn pensadas para crecer. Para ello es fundamental cierto grado de modularidad. EL viejo `angular.module` ha vuelto en la versin 2. Mira dentro del fichero `app.module.ts` y vers cdigo similar a este:\n\n```javascript\n// objetos con utilidades comunes del framework\nimport { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { HttpModule } from '@angular/http';\n// importacin del componente raz, definido en esta misma carpeta\nimport { AppComponent } from './app.component';\n// decorador con metadata que define un mdulo\n@NgModule({\n  declarations: [\n    AppComponent\n  ], // cosas declaradas en este mdulo\n  imports: [\n    BrowserModule,\n    FormsModule,\n    HttpModule\n  ], // otros mdulos que necesitamos para que este funcione\n  providers: [] , // inyeccin de servicios comunes para la aplicacin\n  bootstrap: [AppComponent] // componente raz para el arranque\n})\n// los mdulos son clases contendoras \n// habitualmente con poco o ningn cdigo\nexport class AppModule { }\n```\n\nUn mdulo no es ms que una clase contenedora. Cada mdulo puede incluir mltiples componentes y servicios. Normalmente un mdulo depender de otros. El mdulo raz declara un componente especial para el arranque de la aplicacin: *El componente raz*\n\n## El componente raz\nBuceando a mayor profundidad nos encontramos con el resto del contenido de la carpeta `./app/`. Son archivos con nombres tipo `app.component.*` y se usan para definir un componente.\n\nLos **componentes son los bloques de construccin de Angular 2** que representan regiones de la pantalla. Las aplicaciones se definen como rboles de componentes. Nuestra aplicacin es un rbol que tiene una raz, habitualmente llamado `app` y que es comn a cualquier desarrollo.\n\nCada componente a su vez est formado por tres partes:\n1. **La vista**: es el cdigo que se renderizar para los usuarios. Esta plantilla estar en un fichero de extensin `.html`.\n2. **La clase controladora**: En ES6 usaremos clases para declarar los controladores que exponen datos y funcionalidad a la vista.\n3. **Metadata**: Se declara como un decorador, una funcin especial de TypeScript, que recibe un objeto de configuracin. Esto acompaa al controlador en un fichero de extensin `.ts`\n\nEmpecemos por este ltimo fichero, el `app.component.ts`.\n```javascript\nimport { Component } from '@angular/core';\n// Funcin decoradora que registra un componente\n@Component({\n  selector: 'app-root', // elemento html consumidor\n  templateUrl: './app.component.html', // ruta relativa a la vista\n  styleUrls: ['./app.component.css'] // potencialmente mltiples hojas de estilo\n})\n// clase que representa un controlador \n// con su modelo de datos (title ) y mtodos de accin (an no tiene)\n// Esta clase es todo lo que se exporta en este fichero\n// y esto se importar en app.module.ts para ser incorporado el mdulo raz\nexport class AppComponent {\n  // las propiedades de la clase representan el modelo de datos\n  // son accesibles desde la vista\n  title = 'app works!';\n}\n```\n\nSeguro que la parte ms novedosa es `@Component({...})`. Es el equivalente a los antiguos Objetos de Definicin de Directivas. Lo que hace es asociar al controlador una plantilla HTML `app.component.html` y un selector para ser invocado desde otra vista `<app-root></app-root>`. El resto por ahora puedes obviarlo.\n\nY hablando de la plantilla, echemos un vistazo a `app.component.html`. Contendr algo as:\n\n```html\n<h1>\n  <!--Interpolacin de variables definidas en el modelo del componente-->\n  {{ title }}\n</h1>\n```\n\nEstas son cosas que te resultarn muy familiares como la interpolacin `{{ title }}` que permite mostrar el famoso *app works!*, nueva versin del *hola mundo*. Ya est, el resto ya es slo usar este componente en el `index.html`, \nRecuerda:\n```html\n  <!--Componente raz de la aplicacin-->\n  <app-root>Loading...</app-root>\n```\n## Angular2 en accin\nPara lanzar y probar tu aplicacin necesitas otro comando de Angular-CLI. Este comando se ocupa entre otras cosas de todo el proceso necesario para **transformar el cdigo TypeScript en JavaScript** reconocible por el navegador. Tambin crea un mini servidor esttico y adems refresca el navegador a cada cambio los fuentes. Un salvavidas para un recin llegado a Angular 2. Teclea en tu terminal:\n\n```\nng serve\n```\n\nSi todo ha ido bien, no siempre ocurre con estas versiones tan verdes, podrs disfrutar de **tu primera aplicacin con Angular 2** en [http://localhost:4200](http://localhost:4200)  \n\n\n>[Este vdeo](https://youtu.be/Y7izsxhPpQY) emitido con la colaboracin de DesarrolloWeb.com contiene una explicacin mas extensa del proceso de trabajo con Angular 2 CLI.\n\n\n\n<div class=\"flex-video\">  \n    <iframe src=\"https://www.youtube.com/embed/Y7izsxhPpQY\"></iframe>\n</div>\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/)","source":"_posts/Hola-Mundo-Angular-2.md","raw":"---\ntitle: Hola Mundo Angular 2\ntags:  \n- Angular2\n- CLI\n- Tutorial\ncategories:\n- Introduccin \npermalink: hola-mundo-en-angular-2\nid: 12\nupdated: 2016/10/31 12:36:28\ndate: 2016/05/18 16:10:18\n---\n\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Hola Angular CLI](../hola-angular-cli/)\n\n---\n\n>Cdigo asociado en GitHub: [angular2/1-HolaMundo/](https://github.com/AcademiaBinaria/angular2/tree/master/1-hola-mundo)\n\nQu lejanos aquellos tiempos dnde un [Hola Mundo en AngularJS](https://github.com/AcademiaBinaria/HolaAngularJS) se haca en 2 lneas de cdigo. Ahora necesitar miles de ficheros y media hora de explicacin. Pero el resultado valdr la pena. Estaremos en la pista de lanzamiento para crear **aplicaciones de nivel empresarial con Angular 2.**\n\nYa he explicado que Angular ha pasado [de framework a plataforma](http://academia-binaria.com/angular2-primeras-impresiones/), y que ya no es para aficionados. Grandes desarrollos en equipo requieren **herramientas y procedimientos** a la altura. La primera opcin que te recomiendo es [Angular CLI](https://cli.angular.io/), un generador de aplicaciones trufado de buenas prcticas y procedimientos. Por raro que te parezca, cualquier otra opcin es *an* ms compleja que la que te muestro.\n\n<!-- more -->\n\n## Preparando el entorno\nLas herramientas que voy a usar requieren [NodeJS](nodejs.org). Te recomiendo que instales una de sus ltimas versiones. Tras la instalacin tendrs acceso a [npm](npmjs.com) para poder instalar libreras y utilidades como Angular CLI.\n\n```\nnpm install -g angular-cli\n```\n\nA partir de ahora en tu linea de comandos podrs usar el programa `ng` seguido de algn comando como `new generate serve lint test e2e build`. Usaremos algunos en esta demo.\n\n## Creando aplicaciones y componentes\nEscoge un directorio en un disco con espacio libre. No es broma, hasta 300 mb o ms para empezar. Tranquilo, en distribucin la cosa pinta mucho mejor y Angular es muy ligero. Ahora teclea:\n\n\n```\nng new hola-angular-2\n```\n\nUnos segundos o minutos ms tarde... podrs abrir la recin creada carpeta, yo lo hago con [VSCode](https://code.visualstudio.com/), y explorar el contenido de sus 3 directorios y miles de ficheros!!!\n\nDespus del susto, tranquilidad de nuevo. La mayora son dependencias de terceros productos, herramientas necesarias para ejecutar aplicacin o para alguno de sus procesos de *test, lint o distribucin*. Centrmonos en el directorio `src` dnde estn los fuentes, el cdigo que tendramos que haber creado nosotros.\n\nDe un primer vistazo puede que slo reconozcas al viejo `index.html`. No te agobies, por ahora es suficiente. Contendr algo como esto:\n\n```html\n<!doctype html>\n<html>\n<head>\n  <meta charset=\"utf-8\">\n  <title>HolaAngular2</title>\n  <base href=\"/\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <link rel=\"icon\" type=\"image/x-icon\" href=\"favicon.ico\">\n</head>\n<body>\n  <!--Componente raz de la aplicacin-->\n  <app-root>Loading...</app-root>\n</body>\n</html>\n```\n\nDe lo que es Angular 2 lo nico interesante es el componente `<app-root>Loading...</app-root>`. Todo, incluida la aplicacin principal, debe ser definido y declarado como un componente. De hecho definiremos las aplicaciones Angular2 como rboles de componentes. Y tdodo rbol debe tener una raz. Mientras Angular no entre en fucionamiento, el susario ver el mensaje de *Loading...* despus la magia de Angular2 lo sustituir por el contenido del componente `app-root` predefinido por el generador. \n\n## TypeScript\nSin entrar en debates de [qu lenguaje usar para programar en Angular2](https://www.youtube.com/watch?v=OpS2R7rbpRg) te resumo mi posicin: \n\n1.- TypeScript te permite anotar tu **JavaScript con tipos**. Esto tiene dos ventajas: *intellisense* mientras codificas y chequeo de tipos cuando compilas.\n2.- TypeScript es la **nica opcin automatizada a da de hoy** con Angular CLI.\n\nPor lo dems no hay porqu alarmarse. [TypeScript](https://www.typescriptlang.org/) es un *superset de JavaScript ES6* con unas mejoras evidentes que no tardars en dominar. Eso si, tienes que aprender [JavaScript ES2015 o ES6](http://es6-features.org/).\n\nSabiendo esto, entra sin miedo en cualquier fichero de extensin `.ts` y vers que es muy parecido a cualquier `.js` de la nueva versin. Por ejemplo en el citado `main.ts` aparecer algo as:\n\n```javascript\n// importaciones de dependencias TypeScript al estilo ES6\n// primero los bsicos para compatibilidad con navegadores\nimport './polyfills.ts';\n// luego cosas de Angular\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\nimport { enableProdMode } from '@angular/core';\n// despus nuestro cdigo, empezando por la configuracin\nimport { environment } from './environments/environment';\n// y por ltimo la aplicacin a leda desde el mdulo raz, llamado app por convenio.\nimport { AppModule } from './app/';\n\n// condiciones para ejecutar en modo desarrollo o produccin\nif (environment.production) {\n  enableProdMode();\n}\n// arranque de la aplicacin invocando al mdulo raz\nplatformBrowserDynamic().bootstrapModule(AppModule);\n```\n\nCentrndonos en el cdigo que habremos de mantener fjate en la lnea `import { AppModule } from './app/';`. Le indica a *WebPack* que importe el contenido de la carpeta `./app/`. Para ello buscar en dicho directorio un archivo `index.ts`. Ese fichero sirve de ndice y contiene las instrucciones para exportar el cdigo interesante del resto de la carpeta. En nuestro caso son el mdulo y el componente raz. \n\n## El mdulo raz\nLas aplicaciones Angular2 estn pensadas para crecer. Para ello es fundamental cierto grado de modularidad. EL viejo `angular.module` ha vuelto en la versin 2. Mira dentro del fichero `app.module.ts` y vers cdigo similar a este:\n\n```javascript\n// objetos con utilidades comunes del framework\nimport { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { HttpModule } from '@angular/http';\n// importacin del componente raz, definido en esta misma carpeta\nimport { AppComponent } from './app.component';\n// decorador con metadata que define un mdulo\n@NgModule({\n  declarations: [\n    AppComponent\n  ], // cosas declaradas en este mdulo\n  imports: [\n    BrowserModule,\n    FormsModule,\n    HttpModule\n  ], // otros mdulos que necesitamos para que este funcione\n  providers: [] , // inyeccin de servicios comunes para la aplicacin\n  bootstrap: [AppComponent] // componente raz para el arranque\n})\n// los mdulos son clases contendoras \n// habitualmente con poco o ningn cdigo\nexport class AppModule { }\n```\n\nUn mdulo no es ms que una clase contenedora. Cada mdulo puede incluir mltiples componentes y servicios. Normalmente un mdulo depender de otros. El mdulo raz declara un componente especial para el arranque de la aplicacin: *El componente raz*\n\n## El componente raz\nBuceando a mayor profundidad nos encontramos con el resto del contenido de la carpeta `./app/`. Son archivos con nombres tipo `app.component.*` y se usan para definir un componente.\n\nLos **componentes son los bloques de construccin de Angular 2** que representan regiones de la pantalla. Las aplicaciones se definen como rboles de componentes. Nuestra aplicacin es un rbol que tiene una raz, habitualmente llamado `app` y que es comn a cualquier desarrollo.\n\nCada componente a su vez est formado por tres partes:\n1. **La vista**: es el cdigo que se renderizar para los usuarios. Esta plantilla estar en un fichero de extensin `.html`.\n2. **La clase controladora**: En ES6 usaremos clases para declarar los controladores que exponen datos y funcionalidad a la vista.\n3. **Metadata**: Se declara como un decorador, una funcin especial de TypeScript, que recibe un objeto de configuracin. Esto acompaa al controlador en un fichero de extensin `.ts`\n\nEmpecemos por este ltimo fichero, el `app.component.ts`.\n```javascript\nimport { Component } from '@angular/core';\n// Funcin decoradora que registra un componente\n@Component({\n  selector: 'app-root', // elemento html consumidor\n  templateUrl: './app.component.html', // ruta relativa a la vista\n  styleUrls: ['./app.component.css'] // potencialmente mltiples hojas de estilo\n})\n// clase que representa un controlador \n// con su modelo de datos (title ) y mtodos de accin (an no tiene)\n// Esta clase es todo lo que se exporta en este fichero\n// y esto se importar en app.module.ts para ser incorporado el mdulo raz\nexport class AppComponent {\n  // las propiedades de la clase representan el modelo de datos\n  // son accesibles desde la vista\n  title = 'app works!';\n}\n```\n\nSeguro que la parte ms novedosa es `@Component({...})`. Es el equivalente a los antiguos Objetos de Definicin de Directivas. Lo que hace es asociar al controlador una plantilla HTML `app.component.html` y un selector para ser invocado desde otra vista `<app-root></app-root>`. El resto por ahora puedes obviarlo.\n\nY hablando de la plantilla, echemos un vistazo a `app.component.html`. Contendr algo as:\n\n```html\n<h1>\n  <!--Interpolacin de variables definidas en el modelo del componente-->\n  {{ title }}\n</h1>\n```\n\nEstas son cosas que te resultarn muy familiares como la interpolacin `{{ title }}` que permite mostrar el famoso *app works!*, nueva versin del *hola mundo*. Ya est, el resto ya es slo usar este componente en el `index.html`, \nRecuerda:\n```html\n  <!--Componente raz de la aplicacin-->\n  <app-root>Loading...</app-root>\n```\n## Angular2 en accin\nPara lanzar y probar tu aplicacin necesitas otro comando de Angular-CLI. Este comando se ocupa entre otras cosas de todo el proceso necesario para **transformar el cdigo TypeScript en JavaScript** reconocible por el navegador. Tambin crea un mini servidor esttico y adems refresca el navegador a cada cambio los fuentes. Un salvavidas para un recin llegado a Angular 2. Teclea en tu terminal:\n\n```\nng serve\n```\n\nSi todo ha ido bien, no siempre ocurre con estas versiones tan verdes, podrs disfrutar de **tu primera aplicacin con Angular 2** en [http://localhost:4200](http://localhost:4200)  \n\n\n>[Este vdeo](https://youtu.be/Y7izsxhPpQY) emitido con la colaboracin de DesarrolloWeb.com contiene una explicacin mas extensa del proceso de trabajo con Angular 2 CLI.\n\n\n\n<div class=\"flex-video\">  \n    <iframe src=\"https://www.youtube.com/embed/Y7izsxhPpQY\"></iframe>\n</div>\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/)","slug":"hola-mundo-en-angular-2","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvgx0010iwd3wg1uhspm","content":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../hola-angular-cli/\">Hola Angular CLI</a></p></blockquote><hr><blockquote><p>Cdigo asociado en GitHub: <a href=\"https://github.com/AcademiaBinaria/angular2/tree/master/1-hola-mundo\" target=\"_blank\" rel=\"external\">angular2/1-HolaMundo/</a></p></blockquote><p>Qu lejanos aquellos tiempos dnde un <a href=\"https://github.com/AcademiaBinaria/HolaAngularJS\" target=\"_blank\" rel=\"external\">Hola Mundo en AngularJS</a> se haca en 2 lneas de cdigo. Ahora necesitar miles de ficheros y media hora de explicacin. Pero el resultado valdr la pena. Estaremos en la pista de lanzamiento para crear <strong>aplicaciones de nivel empresarial con Angular 2.</strong></p><p>Ya he explicado que Angular ha pasado <a href=\"http://academia-binaria.com/angular2-primeras-impresiones/\">de framework a plataforma</a>, y que ya no es para aficionados. Grandes desarrollos en equipo requieren <strong>herramientas y procedimientos</strong> a la altura. La primera opcin que te recomiendo es <a href=\"https://cli.angular.io/\" target=\"_blank\" rel=\"external\">Angular CLI</a>, un generador de aplicaciones trufado de buenas prcticas y procedimientos. Por raro que te parezca, cualquier otra opcin es <em>an</em> ms compleja que la que te muestro.</p><a id=\"more\"></a><h2 id=\"Preparando-el-entorno\"><a href=\"#Preparando-el-entorno\" class=\"headerlink\" title=\"Preparando el entorno\"></a>Preparando el entorno</h2><p>Las herramientas que voy a usar requieren <a href=\"nodejs.org\">NodeJS</a>. Te recomiendo que instales una de sus ltimas versiones. Tras la instalacin tendrs acceso a <a href=\"npmjs.com\">npm</a> para poder instalar libreras y utilidades como Angular CLI.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install -g angular-cli</div></pre></td></tr></table></figure><p>A partir de ahora en tu linea de comandos podrs usar el programa <code>ng</code> seguido de algn comando como <code>new generate serve lint test e2e build</code>. Usaremos algunos en esta demo.</p><h2 id=\"Creando-aplicaciones-y-componentes\"><a href=\"#Creando-aplicaciones-y-componentes\" class=\"headerlink\" title=\"Creando aplicaciones y componentes\"></a>Creando aplicaciones y componentes</h2><p>Escoge un directorio en un disco con espacio libre. No es broma, hasta 300 mb o ms para empezar. Tranquilo, en distribucin la cosa pinta mucho mejor y Angular es muy ligero. Ahora teclea:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ng new hola-angular-2</div></pre></td></tr></table></figure><p>Unos segundos o minutos ms tarde podrs abrir la recin creada carpeta, yo lo hago con <a href=\"https://code.visualstudio.com/\" target=\"_blank\" rel=\"external\">VSCode</a>, y explorar el contenido de sus 3 directorios y miles de ficheros!!!</p><p>Despus del susto, tranquilidad de nuevo. La mayora son dependencias de terceros productos, herramientas necesarias para ejecutar aplicacin o para alguno de sus procesos de <em>test, lint o distribucin</em>. Centrmonos en el directorio <code>src</code> dnde estn los fuentes, el cdigo que tendramos que haber creado nosotros.</p><p>De un primer vistazo puede que slo reconozcas al viejo <code>index.html</code>. No te agobies, por ahora es suficiente. Contendr algo como esto:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&lt;!doctype html&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>HolaAngular2<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">base</span> <span class=\"attr\">href</span>=<span class=\"string\">\"/\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"icon\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"image/x-icon\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"favicon.ico\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Componente raz de la aplicacin--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">app-root</span>&gt;</span>Loading...<span class=\"tag\">&lt;/<span class=\"name\">app-root</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></div></pre></td></tr></table></figure><p>De lo que es Angular 2 lo nico interesante es el componente <code>&lt;app-root&gt;Loading...&lt;/app-root&gt;</code>. Todo, incluida la aplicacin principal, debe ser definido y declarado como un componente. De hecho definiremos las aplicaciones Angular2 como rboles de componentes. Y tdodo rbol debe tener una raz. Mientras Angular no entre en fucionamiento, el susario ver el mensaje de <em>Loading</em> despus la magia de Angular2 lo sustituir por el contenido del componente <code>app-root</code> predefinido por el generador.</p><h2 id=\"TypeScript\"><a href=\"#TypeScript\" class=\"headerlink\" title=\"TypeScript\"></a>TypeScript</h2><p>Sin entrar en debates de <a href=\"https://www.youtube.com/watch?v=OpS2R7rbpRg\" target=\"_blank\" rel=\"external\">qu lenguaje usar para programar en Angular2</a> te resumo mi posicin:</p><p>1.- TypeScript te permite anotar tu <strong>JavaScript con tipos</strong>. Esto tiene dos ventajas: <em>intellisense</em> mientras codificas y chequeo de tipos cuando compilas.<br>2.- TypeScript es la <strong>nica opcin automatizada a da de hoy</strong> con Angular CLI.</p><p>Por lo dems no hay porqu alarmarse. <a href=\"https://www.typescriptlang.org/\" target=\"_blank\" rel=\"external\">TypeScript</a> es un <em>superset de JavaScript ES6</em> con unas mejoras evidentes que no tardars en dominar. Eso si, tienes que aprender <a href=\"http://es6-features.org/\" target=\"_blank\" rel=\"external\">JavaScript ES2015 o ES6</a>.</p><p>Sabiendo esto, entra sin miedo en cualquier fichero de extensin <code>.ts</code> y vers que es muy parecido a cualquier <code>.js</code> de la nueva versin. Por ejemplo en el citado <code>main.ts</code> aparecer algo as:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// importaciones de dependencias TypeScript al estilo ES6</span></div><div class=\"line\"><span class=\"comment\">// primero los bsicos para compatibilidad con navegadores</span></div><div class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'./polyfills.ts'</span>;</div><div class=\"line\"><span class=\"comment\">// luego cosas de Angular</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; platformBrowserDynamic &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser-dynamic'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; enableProdMode &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"comment\">// despus nuestro cdigo, empezando por la configuracin</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; environment &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./environments/environment'</span>;</div><div class=\"line\"><span class=\"comment\">// y por ltimo la aplicacin a leda desde el mdulo raz, llamado app por convenio.</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; AppModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app/'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// condiciones para ejecutar en modo desarrollo o produccin</span></div><div class=\"line\"><span class=\"keyword\">if</span> (environment.production) &#123;</div><div class=\"line\">  enableProdMode();</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"comment\">// arranque de la aplicacin invocando al mdulo raz</span></div><div class=\"line\">platformBrowserDynamic().bootstrapModule(AppModule);</div></pre></td></tr></table></figure><p>Centrndonos en el cdigo que habremos de mantener fjate en la lnea <code>import { AppModule } from &#39;./app/&#39;;</code>. Le indica a <em>WebPack</em> que importe el contenido de la carpeta <code>./app/</code>. Para ello buscar en dicho directorio un archivo <code>index.ts</code>. Ese fichero sirve de ndice y contiene las instrucciones para exportar el cdigo interesante del resto de la carpeta. En nuestro caso son el mdulo y el componente raz.</p><h2 id=\"El-modulo-raiz\"><a href=\"#El-modulo-raiz\" class=\"headerlink\" title=\"El mdulo raz\"></a>El mdulo raz</h2><p>Las aplicaciones Angular2 estn pensadas para crecer. Para ello es fundamental cierto grado de modularidad. EL viejo <code>angular.module</code> ha vuelto en la versin 2. Mira dentro del fichero <code>app.module.ts</code> y vers cdigo similar a este:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// objetos con utilidades comunes del framework</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; BrowserModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; FormsModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; HttpModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/http'</span>;</div><div class=\"line\"><span class=\"comment\">// importacin del componente raz, definido en esta misma carpeta</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; AppComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.component'</span>;</div><div class=\"line\"><span class=\"comment\">// decorador con metadata que define un mdulo</span></div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  declarations: [</div><div class=\"line\">    AppComponent</div><div class=\"line\">  ], <span class=\"comment\">// cosas declaradas en este mdulo</span></div><div class=\"line\">  imports: [</div><div class=\"line\">    BrowserModule,</div><div class=\"line\">    FormsModule,</div><div class=\"line\">    HttpModule</div><div class=\"line\">  ], <span class=\"comment\">// otros mdulos que necesitamos para que este funcione</span></div><div class=\"line\">  providers: [] , <span class=\"comment\">// inyeccin de servicios comunes para la aplicacin</span></div><div class=\"line\">  bootstrap: [AppComponent] <span class=\"comment\">// componente raz para el arranque</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"comment\">// los mdulos son clases contendoras </span></div><div class=\"line\"><span class=\"comment\">// habitualmente con poco o ningn cdigo</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><p>Un mdulo no es ms que una clase contenedora. Cada mdulo puede incluir mltiples componentes y servicios. Normalmente un mdulo depender de otros. El mdulo raz declara un componente especial para el arranque de la aplicacin: <em>El componente raz</em></p><h2 id=\"El-componente-raiz\"><a href=\"#El-componente-raiz\" class=\"headerlink\" title=\"El componente raz\"></a>El componente raz</h2><p>Buceando a mayor profundidad nos encontramos con el resto del contenido de la carpeta <code>./app/</code>. Son archivos con nombres tipo <code>app.component.*</code> y se usan para definir un componente.</p><p>Los <strong>componentes son los bloques de construccin de Angular 2</strong> que representan regiones de la pantalla. Las aplicaciones se definen como rboles de componentes. Nuestra aplicacin es un rbol que tiene una raz, habitualmente llamado <code>app</code> y que es comn a cualquier desarrollo.</p><p>Cada componente a su vez est formado por tres partes:</p><ol><li><strong>La vista</strong>: es el cdigo que se renderizar para los usuarios. Esta plantilla estar en un fichero de extensin <code>.html</code>.</li><li><strong>La clase controladora</strong>: En ES6 usaremos clases para declarar los controladores que exponen datos y funcionalidad a la vista.</li><li><strong>Metadata</strong>: Se declara como un decorador, una funcin especial de TypeScript, que recibe un objeto de configuracin. Esto acompaa al controlador en un fichero de extensin <code>.ts</code></li></ol><p>Empecemos por este ltimo fichero, el <code>app.component.ts</code>.<br></p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"comment\">// Funcin decoradora que registra un componente</span></div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  selector: <span class=\"string\">'app-root'</span>, <span class=\"comment\">// elemento html consumidor</span></div><div class=\"line\">  templateUrl: <span class=\"string\">'./app.component.html'</span>, <span class=\"comment\">// ruta relativa a la vista</span></div><div class=\"line\">  styleUrls: [<span class=\"string\">'./app.component.css'</span>] <span class=\"comment\">// potencialmente mltiples hojas de estilo</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"comment\">// clase que representa un controlador </span></div><div class=\"line\"><span class=\"comment\">// con su modelo de datos (title ) y mtodos de accin (an no tiene)</span></div><div class=\"line\"><span class=\"comment\">// Esta clase es todo lo que se exporta en este fichero</span></div><div class=\"line\"><span class=\"comment\">// y esto se importar en app.module.ts para ser incorporado el mdulo raz</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppComponent</span> </span>&#123;</div><div class=\"line\">  <span class=\"comment\">// las propiedades de la clase representan el modelo de datos</span></div><div class=\"line\">  <span class=\"comment\">// son accesibles desde la vista</span></div><div class=\"line\">  title = <span class=\"string\">'app works!'</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p></p><p>Seguro que la parte ms novedosa es <code>@Component({...})</code>. Es el equivalente a los antiguos Objetos de Definicin de Directivas. Lo que hace es asociar al controlador una plantilla HTML <code>app.component.html</code> y un selector para ser invocado desde otra vista <code>&lt;app-root&gt;&lt;/app-root&gt;</code>. El resto por ahora puedes obviarlo.</p><p>Y hablando de la plantilla, echemos un vistazo a <code>app.component.html</code>. Contendr algo as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Interpolacin de variables definidas en el modelo del componente--&gt;</span></div><div class=\"line\">  &#123;&#123; title &#125;&#125;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></div></pre></td></tr></table></figure><p>Estas son cosas que te resultarn muy familiares como la interpolacin <code>Hola Mundo Angular 2</code> que permite mostrar el famoso <em>app works!</em>, nueva versin del <em>hola mundo</em>. Ya est, el resto ya es slo usar este componente en el <code>index.html</code>,<br>Recuerda:<br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--Componente raz de la aplicacin--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-root</span>&gt;</span>Loading...<span class=\"tag\">&lt;/<span class=\"name\">app-root</span>&gt;</span></div></pre></td></tr></table></figure><p></p><h2 id=\"Angular2-en-accion\"><a href=\"#Angular2-en-accion\" class=\"headerlink\" title=\"Angular2 en accin\"></a>Angular2 en accin</h2><p>Para lanzar y probar tu aplicacin necesitas otro comando de Angular-CLI. Este comando se ocupa entre otras cosas de todo el proceso necesario para <strong>transformar el cdigo TypeScript en JavaScript</strong> reconocible por el navegador. Tambin crea un mini servidor esttico y adems refresca el navegador a cada cambio los fuentes. Un salvavidas para un recin llegado a Angular 2. Teclea en tu terminal:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ng serve</div></pre></td></tr></table></figure><p>Si todo ha ido bien, no siempre ocurre con estas versiones tan verdes, podrs disfrutar de <strong>tu primera aplicacin con Angular 2</strong> en <a href=\"http://localhost:4200\" target=\"_blank\" rel=\"external\">http://localhost:4200</a></p><blockquote><p><a href=\"https://youtu.be/Y7izsxhPpQY\" target=\"_blank\" rel=\"external\">Este vdeo</a> emitido con la colaboracin de DesarrolloWeb.com contiene una explicacin mas extensa del proceso de trabajo con Angular 2 CLI.</p></blockquote><div class=\"flex-video\"><br><iframe src=\"https://www.youtube.com/embed/Y7izsxhPpQY\"></iframe><br></div><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a></p>","site":{"data":{}},"excerpt":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../hola-angular-cli/\">Hola Angular CLI</a></p></blockquote><hr><blockquote><p>Cdigo asociado en GitHub: <a href=\"https://github.com/AcademiaBinaria/angular2/tree/master/1-hola-mundo\" target=\"_blank\" rel=\"external\">angular2/1-HolaMundo/</a></p></blockquote><p>Qu lejanos aquellos tiempos dnde un <a href=\"https://github.com/AcademiaBinaria/HolaAngularJS\" target=\"_blank\" rel=\"external\">Hola Mundo en AngularJS</a> se haca en 2 lneas de cdigo. Ahora necesitar miles de ficheros y media hora de explicacin. Pero el resultado valdr la pena. Estaremos en la pista de lanzamiento para crear <strong>aplicaciones de nivel empresarial con Angular 2.</strong></p><p>Ya he explicado que Angular ha pasado <a href=\"http://academia-binaria.com/angular2-primeras-impresiones/\">de framework a plataforma</a>, y que ya no es para aficionados. Grandes desarrollos en equipo requieren <strong>herramientas y procedimientos</strong> a la altura. La primera opcin que te recomiendo es <a href=\"https://cli.angular.io/\" target=\"_blank\" rel=\"external\">Angular CLI</a>, un generador de aplicaciones trufado de buenas prcticas y procedimientos. Por raro que te parezca, cualquier otra opcin es <em>an</em> ms compleja que la que te muestro.</p>","more":"<h2 id=\"Preparando-el-entorno\"><a href=\"#Preparando-el-entorno\" class=\"headerlink\" title=\"Preparando el entorno\"></a>Preparando el entorno</h2><p>Las herramientas que voy a usar requieren <a href=\"nodejs.org\">NodeJS</a>. Te recomiendo que instales una de sus ltimas versiones. Tras la instalacin tendrs acceso a <a href=\"npmjs.com\">npm</a> para poder instalar libreras y utilidades como Angular CLI.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install -g angular-cli</div></pre></td></tr></table></figure><p>A partir de ahora en tu linea de comandos podrs usar el programa <code>ng</code> seguido de algn comando como <code>new generate serve lint test e2e build</code>. Usaremos algunos en esta demo.</p><h2 id=\"Creando-aplicaciones-y-componentes\"><a href=\"#Creando-aplicaciones-y-componentes\" class=\"headerlink\" title=\"Creando aplicaciones y componentes\"></a>Creando aplicaciones y componentes</h2><p>Escoge un directorio en un disco con espacio libre. No es broma, hasta 300 mb o ms para empezar. Tranquilo, en distribucin la cosa pinta mucho mejor y Angular es muy ligero. Ahora teclea:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ng new hola-angular-2</div></pre></td></tr></table></figure><p>Unos segundos o minutos ms tarde podrs abrir la recin creada carpeta, yo lo hago con <a href=\"https://code.visualstudio.com/\" target=\"_blank\" rel=\"external\">VSCode</a>, y explorar el contenido de sus 3 directorios y miles de ficheros!!!</p><p>Despus del susto, tranquilidad de nuevo. La mayora son dependencias de terceros productos, herramientas necesarias para ejecutar aplicacin o para alguno de sus procesos de <em>test, lint o distribucin</em>. Centrmonos en el directorio <code>src</code> dnde estn los fuentes, el cdigo que tendramos que haber creado nosotros.</p><p>De un primer vistazo puede que slo reconozcas al viejo <code>index.html</code>. No te agobies, por ahora es suficiente. Contendr algo como esto:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&lt;!doctype html&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>HolaAngular2<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">base</span> <span class=\"attr\">href</span>=<span class=\"string\">\"/\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"icon\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"image/x-icon\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"favicon.ico\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Componente raz de la aplicacin--&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">app-root</span>&gt;</span>Loading...<span class=\"tag\">&lt;/<span class=\"name\">app-root</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></div></pre></td></tr></table></figure><p>De lo que es Angular 2 lo nico interesante es el componente <code>&lt;app-root&gt;Loading...&lt;/app-root&gt;</code>. Todo, incluida la aplicacin principal, debe ser definido y declarado como un componente. De hecho definiremos las aplicaciones Angular2 como rboles de componentes. Y tdodo rbol debe tener una raz. Mientras Angular no entre en fucionamiento, el susario ver el mensaje de <em>Loading</em> despus la magia de Angular2 lo sustituir por el contenido del componente <code>app-root</code> predefinido por el generador.</p><h2 id=\"TypeScript\"><a href=\"#TypeScript\" class=\"headerlink\" title=\"TypeScript\"></a>TypeScript</h2><p>Sin entrar en debates de <a href=\"https://www.youtube.com/watch?v=OpS2R7rbpRg\" target=\"_blank\" rel=\"external\">qu lenguaje usar para programar en Angular2</a> te resumo mi posicin:</p><p>1.- TypeScript te permite anotar tu <strong>JavaScript con tipos</strong>. Esto tiene dos ventajas: <em>intellisense</em> mientras codificas y chequeo de tipos cuando compilas.<br>2.- TypeScript es la <strong>nica opcin automatizada a da de hoy</strong> con Angular CLI.</p><p>Por lo dems no hay porqu alarmarse. <a href=\"https://www.typescriptlang.org/\" target=\"_blank\" rel=\"external\">TypeScript</a> es un <em>superset de JavaScript ES6</em> con unas mejoras evidentes que no tardars en dominar. Eso si, tienes que aprender <a href=\"http://es6-features.org/\" target=\"_blank\" rel=\"external\">JavaScript ES2015 o ES6</a>.</p><p>Sabiendo esto, entra sin miedo en cualquier fichero de extensin <code>.ts</code> y vers que es muy parecido a cualquier <code>.js</code> de la nueva versin. Por ejemplo en el citado <code>main.ts</code> aparecer algo as:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// importaciones de dependencias TypeScript al estilo ES6</span></div><div class=\"line\"><span class=\"comment\">// primero los bsicos para compatibilidad con navegadores</span></div><div class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'./polyfills.ts'</span>;</div><div class=\"line\"><span class=\"comment\">// luego cosas de Angular</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; platformBrowserDynamic &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser-dynamic'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; enableProdMode &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"comment\">// despus nuestro cdigo, empezando por la configuracin</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; environment &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./environments/environment'</span>;</div><div class=\"line\"><span class=\"comment\">// y por ltimo la aplicacin a leda desde el mdulo raz, llamado app por convenio.</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; AppModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app/'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// condiciones para ejecutar en modo desarrollo o produccin</span></div><div class=\"line\"><span class=\"keyword\">if</span> (environment.production) &#123;</div><div class=\"line\">  enableProdMode();</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"comment\">// arranque de la aplicacin invocando al mdulo raz</span></div><div class=\"line\">platformBrowserDynamic().bootstrapModule(AppModule);</div></pre></td></tr></table></figure><p>Centrndonos en el cdigo que habremos de mantener fjate en la lnea <code>import { AppModule } from &#39;./app/&#39;;</code>. Le indica a <em>WebPack</em> que importe el contenido de la carpeta <code>./app/</code>. Para ello buscar en dicho directorio un archivo <code>index.ts</code>. Ese fichero sirve de ndice y contiene las instrucciones para exportar el cdigo interesante del resto de la carpeta. En nuestro caso son el mdulo y el componente raz.</p><h2 id=\"El-modulo-raiz\"><a href=\"#El-modulo-raiz\" class=\"headerlink\" title=\"El mdulo raz\"></a>El mdulo raz</h2><p>Las aplicaciones Angular2 estn pensadas para crecer. Para ello es fundamental cierto grado de modularidad. EL viejo <code>angular.module</code> ha vuelto en la versin 2. Mira dentro del fichero <code>app.module.ts</code> y vers cdigo similar a este:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// objetos con utilidades comunes del framework</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; BrowserModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; FormsModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; HttpModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/http'</span>;</div><div class=\"line\"><span class=\"comment\">// importacin del componente raz, definido en esta misma carpeta</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; AppComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.component'</span>;</div><div class=\"line\"><span class=\"comment\">// decorador con metadata que define un mdulo</span></div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  declarations: [</div><div class=\"line\">    AppComponent</div><div class=\"line\">  ], <span class=\"comment\">// cosas declaradas en este mdulo</span></div><div class=\"line\">  imports: [</div><div class=\"line\">    BrowserModule,</div><div class=\"line\">    FormsModule,</div><div class=\"line\">    HttpModule</div><div class=\"line\">  ], <span class=\"comment\">// otros mdulos que necesitamos para que este funcione</span></div><div class=\"line\">  providers: [] , <span class=\"comment\">// inyeccin de servicios comunes para la aplicacin</span></div><div class=\"line\">  bootstrap: [AppComponent] <span class=\"comment\">// componente raz para el arranque</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"comment\">// los mdulos son clases contendoras </span></div><div class=\"line\"><span class=\"comment\">// habitualmente con poco o ningn cdigo</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><p>Un mdulo no es ms que una clase contenedora. Cada mdulo puede incluir mltiples componentes y servicios. Normalmente un mdulo depender de otros. El mdulo raz declara un componente especial para el arranque de la aplicacin: <em>El componente raz</em></p><h2 id=\"El-componente-raiz\"><a href=\"#El-componente-raiz\" class=\"headerlink\" title=\"El componente raz\"></a>El componente raz</h2><p>Buceando a mayor profundidad nos encontramos con el resto del contenido de la carpeta <code>./app/</code>. Son archivos con nombres tipo <code>app.component.*</code> y se usan para definir un componente.</p><p>Los <strong>componentes son los bloques de construccin de Angular 2</strong> que representan regiones de la pantalla. Las aplicaciones se definen como rboles de componentes. Nuestra aplicacin es un rbol que tiene una raz, habitualmente llamado <code>app</code> y que es comn a cualquier desarrollo.</p><p>Cada componente a su vez est formado por tres partes:</p><ol><li><strong>La vista</strong>: es el cdigo que se renderizar para los usuarios. Esta plantilla estar en un fichero de extensin <code>.html</code>.</li><li><strong>La clase controladora</strong>: En ES6 usaremos clases para declarar los controladores que exponen datos y funcionalidad a la vista.</li><li><strong>Metadata</strong>: Se declara como un decorador, una funcin especial de TypeScript, que recibe un objeto de configuracin. Esto acompaa al controlador en un fichero de extensin <code>.ts</code></li></ol><p>Empecemos por este ltimo fichero, el <code>app.component.ts</code>.<br></p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"comment\">// Funcin decoradora que registra un componente</span></div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  selector: <span class=\"string\">'app-root'</span>, <span class=\"comment\">// elemento html consumidor</span></div><div class=\"line\">  templateUrl: <span class=\"string\">'./app.component.html'</span>, <span class=\"comment\">// ruta relativa a la vista</span></div><div class=\"line\">  styleUrls: [<span class=\"string\">'./app.component.css'</span>] <span class=\"comment\">// potencialmente mltiples hojas de estilo</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"comment\">// clase que representa un controlador </span></div><div class=\"line\"><span class=\"comment\">// con su modelo de datos (title ) y mtodos de accin (an no tiene)</span></div><div class=\"line\"><span class=\"comment\">// Esta clase es todo lo que se exporta en este fichero</span></div><div class=\"line\"><span class=\"comment\">// y esto se importar en app.module.ts para ser incorporado el mdulo raz</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppComponent</span> </span>&#123;</div><div class=\"line\">  <span class=\"comment\">// las propiedades de la clase representan el modelo de datos</span></div><div class=\"line\">  <span class=\"comment\">// son accesibles desde la vista</span></div><div class=\"line\">  title = <span class=\"string\">'app works!'</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p></p><p>Seguro que la parte ms novedosa es <code>@Component({...})</code>. Es el equivalente a los antiguos Objetos de Definicin de Directivas. Lo que hace es asociar al controlador una plantilla HTML <code>app.component.html</code> y un selector para ser invocado desde otra vista <code>&lt;app-root&gt;&lt;/app-root&gt;</code>. El resto por ahora puedes obviarlo.</p><p>Y hablando de la plantilla, echemos un vistazo a <code>app.component.html</code>. Contendr algo as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\">  <span class=\"comment\">&lt;!--Interpolacin de variables definidas en el modelo del componente--&gt;</span></div><div class=\"line\">  &#123;&#123; title &#125;&#125;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></div></pre></td></tr></table></figure><p>Estas son cosas que te resultarn muy familiares como la interpolacin <code>Hola Mundo Angular 2</code> que permite mostrar el famoso <em>app works!</em>, nueva versin del <em>hola mundo</em>. Ya est, el resto ya es slo usar este componente en el <code>index.html</code>,<br>Recuerda:<br></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--Componente raz de la aplicacin--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-root</span>&gt;</span>Loading...<span class=\"tag\">&lt;/<span class=\"name\">app-root</span>&gt;</span></div></pre></td></tr></table></figure><p></p><h2 id=\"Angular2-en-accion\"><a href=\"#Angular2-en-accion\" class=\"headerlink\" title=\"Angular2 en accin\"></a>Angular2 en accin</h2><p>Para lanzar y probar tu aplicacin necesitas otro comando de Angular-CLI. Este comando se ocupa entre otras cosas de todo el proceso necesario para <strong>transformar el cdigo TypeScript en JavaScript</strong> reconocible por el navegador. Tambin crea un mini servidor esttico y adems refresca el navegador a cada cambio los fuentes. Un salvavidas para un recin llegado a Angular 2. Teclea en tu terminal:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ng serve</div></pre></td></tr></table></figure><p>Si todo ha ido bien, no siempre ocurre con estas versiones tan verdes, podrs disfrutar de <strong>tu primera aplicacin con Angular 2</strong> en <a href=\"http://localhost:4200\" target=\"_blank\" rel=\"external\">http://localhost:4200</a></p><blockquote><p><a href=\"https://youtu.be/Y7izsxhPpQY\" target=\"_blank\" rel=\"external\">Este vdeo</a> emitido con la colaboracin de DesarrolloWeb.com contiene una explicacin mas extensa del proceso de trabajo con Angular 2 CLI.</p></blockquote><div class=\"flex-video\"><br><iframe src=\"https://www.youtube.com/embed/Y7izsxhPpQY\"></iframe><br></div><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a></p>"},{"title":"Por qu AngularJS","id":"19","updated":"2015-08-20T12:45:22.000Z","date":"2015-08-18T06:31:24.000Z","_content":"\nEn este vdeo charlamos sobre AngularJS y el momento actual de desarrollo, y el porqu de su xito.\n\n<div class=\"video-container\">\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/MR1XchvsI1Q?showinfo=0\" frameborder=\"0\" allowfullscreen></iframe>\n</div>\n\n[Video en YouTube](https://www.youtube.com/watch?list=PLIcuwIrm4rKdPA5DOzbjSKjJXECfzumZf&t=40&v=MR1XchvsI1Q)","source":"_posts/Por-que-AngularJS.md","raw":"---\ntitle: Por qu AngularJS\ntags: \n- AngularJS\ncategories:\n- Opinin\npermalink: por-que-angularjs\nid: 19\nupdated: '2015-08-20 14:45:22'\ndate: 2015-08-18 08:31:24\n---\n\nEn este vdeo charlamos sobre AngularJS y el momento actual de desarrollo, y el porqu de su xito.\n\n<div class=\"video-container\">\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/MR1XchvsI1Q?showinfo=0\" frameborder=\"0\" allowfullscreen></iframe>\n</div>\n\n[Video en YouTube](https://www.youtube.com/watch?list=PLIcuwIrm4rKdPA5DOzbjSKjJXECfzumZf&t=40&v=MR1XchvsI1Q)","slug":"por-que-angularjs","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvgx0012iwd36zjlkr34","content":"<p>En este vdeo charlamos sobre AngularJS y el momento actual de desarrollo, y el porqu de su xito.</p><div class=\"video-container\"><br><iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/MR1XchvsI1Q?showinfo=0\" frameborder=\"0\" allowfullscreen></iframe><br></div><p><a href=\"https://www.youtube.com/watch?list=PLIcuwIrm4rKdPA5DOzbjSKjJXECfzumZf&amp;t=40&amp;v=MR1XchvsI1Q\" target=\"_blank\" rel=\"external\">Video en YouTube</a></p>","site":{"data":{}},"excerpt":"","more":"<p>En este vdeo charlamos sobre AngularJS y el momento actual de desarrollo, y el porqu de su xito.</p><div class=\"video-container\"><br><iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/MR1XchvsI1Q?showinfo=0\" frameborder=\"0\" allowfullscreen></iframe><br></div><p><a href=\"https://www.youtube.com/watch?list=PLIcuwIrm4rKdPA5DOzbjSKjJXECfzumZf&amp;t=40&amp;v=MR1XchvsI1Q\" target=\"_blank\" rel=\"external\">Video en YouTube</a></p>"},{"title":"Para qu puedo usar NodeJS","id":"20","updated":"2015-08-20T12:53:50.000Z","date":"2015-08-20T12:28:01.000Z","_content":"\nNodeJS se ha hecho muy popular por dos razones relacionas: **potencia y escalabilidad.** Ambas derivadas de su modelo de *ejecucin asncrona no bloqueante*.\n\nSe basa en el lenguaje **JavaScript**: sencillo, verstil y ampliamente conocido. NodeJS complementa a JS con libreras de sistema que sacan un gran rendimiento a los ejecutables.\n\nEl uso ms inmediato de NodeJS est en la **programacin de servicios web**. Tanto en la creacin de APIs como sirviendo pginas tradicionales. Esto le ha valido que se le conozca como el *JavaScript del lado del servidor.* \n\nPero, ms all de la web destaca en entornos empresariales. Se puede utilizar para construir **aplicaciones de escritorio** con iniciativas como (NW)[] y (electron)[]. Tambin y sobre todo se usa para **scripts de administracin o monitorizacin** en departamentos IT. Pequeos proyectos aplicables a sistemas de ficheros, mquinas y servidores. Y una derivada de esto son los proyectos de ayuda al desarrollador que se integran en los *development workflows* de cada vez ms empresas de programacin en cualquier lenguaje. \n\nDada la capacidad de procesamiento asncrono es una herramienta ideal para generar sistemas que respondan en **tiempo real**. Y por su escasa demanda de *hardware* se usa tambin en proyectos de **Internet of Things**\n\nEn definitiva podemos decir que NodeJS y su ecosistema proponen un nuevo paradigma de desarrollo que eleva a JavaScript como lenguaje **de propsito general.**\n\n\n","source":"_posts/Para-que-puedo-usar-NodeJS.md","raw":"---\ntitle: Para qu puedo usar NodeJS\ntags: \n- NodeJS\ncategories:\n- Introduccin\npermalink: para-que-puedo-usar-nodejs\nid: 20\nupdated: '2015-08-20 14:53:50'\ndate: 2015-08-20 14:28:01\n---\n\nNodeJS se ha hecho muy popular por dos razones relacionas: **potencia y escalabilidad.** Ambas derivadas de su modelo de *ejecucin asncrona no bloqueante*.\n\nSe basa en el lenguaje **JavaScript**: sencillo, verstil y ampliamente conocido. NodeJS complementa a JS con libreras de sistema que sacan un gran rendimiento a los ejecutables.\n\nEl uso ms inmediato de NodeJS est en la **programacin de servicios web**. Tanto en la creacin de APIs como sirviendo pginas tradicionales. Esto le ha valido que se le conozca como el *JavaScript del lado del servidor.* \n\nPero, ms all de la web destaca en entornos empresariales. Se puede utilizar para construir **aplicaciones de escritorio** con iniciativas como (NW)[] y (electron)[]. Tambin y sobre todo se usa para **scripts de administracin o monitorizacin** en departamentos IT. Pequeos proyectos aplicables a sistemas de ficheros, mquinas y servidores. Y una derivada de esto son los proyectos de ayuda al desarrollador que se integran en los *development workflows* de cada vez ms empresas de programacin en cualquier lenguaje. \n\nDada la capacidad de procesamiento asncrono es una herramienta ideal para generar sistemas que respondan en **tiempo real**. Y por su escasa demanda de *hardware* se usa tambin en proyectos de **Internet of Things**\n\nEn definitiva podemos decir que NodeJS y su ecosistema proponen un nuevo paradigma de desarrollo que eleva a JavaScript como lenguaje **de propsito general.**\n\n\n","slug":"para-que-puedo-usar-nodejs","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvhc0015iwd3isv7fz8o","content":"<p>NodeJS se ha hecho muy popular por dos razones relacionas: <strong>potencia y escalabilidad.</strong> Ambas derivadas de su modelo de <em>ejecucin asncrona no bloqueante</em>.</p><p>Se basa en el lenguaje <strong>JavaScript</strong>: sencillo, verstil y ampliamente conocido. NodeJS complementa a JS con libreras de sistema que sacan un gran rendimiento a los ejecutables.</p><p>El uso ms inmediato de NodeJS est en la <strong>programacin de servicios web</strong>. Tanto en la creacin de APIs como sirviendo pginas tradicionales. Esto le ha valido que se le conozca como el <em>JavaScript del lado del servidor.</em></p><p>Pero, ms all de la web destaca en entornos empresariales. Se puede utilizar para construir <strong>aplicaciones de escritorio</strong> con iniciativas como (NW)[] y (electron)[]. Tambin y sobre todo se usa para <strong>scripts de administracin o monitorizacin</strong> en departamentos IT. Pequeos proyectos aplicables a sistemas de ficheros, mquinas y servidores. Y una derivada de esto son los proyectos de ayuda al desarrollador que se integran en los <em>development workflows</em> de cada vez ms empresas de programacin en cualquier lenguaje.</p><p>Dada la capacidad de procesamiento asncrono es una herramienta ideal para generar sistemas que respondan en <strong>tiempo real</strong>. Y por su escasa demanda de <em>hardware</em> se usa tambin en proyectos de <strong>Internet of Things</strong></p><p>En definitiva podemos decir que NodeJS y su ecosistema proponen un nuevo paradigma de desarrollo que eleva a JavaScript como lenguaje <strong>de propsito general.</strong></p>","site":{"data":{}},"excerpt":"","more":"<p>NodeJS se ha hecho muy popular por dos razones relacionas: <strong>potencia y escalabilidad.</strong> Ambas derivadas de su modelo de <em>ejecucin asncrona no bloqueante</em>.</p><p>Se basa en el lenguaje <strong>JavaScript</strong>: sencillo, verstil y ampliamente conocido. NodeJS complementa a JS con libreras de sistema que sacan un gran rendimiento a los ejecutables.</p><p>El uso ms inmediato de NodeJS est en la <strong>programacin de servicios web</strong>. Tanto en la creacin de APIs como sirviendo pginas tradicionales. Esto le ha valido que se le conozca como el <em>JavaScript del lado del servidor.</em></p><p>Pero, ms all de la web destaca en entornos empresariales. Se puede utilizar para construir <strong>aplicaciones de escritorio</strong> con iniciativas como (NW)[] y (electron)[]. Tambin y sobre todo se usa para <strong>scripts de administracin o monitorizacin</strong> en departamentos IT. Pequeos proyectos aplicables a sistemas de ficheros, mquinas y servidores. Y una derivada de esto son los proyectos de ayuda al desarrollador que se integran en los <em>development workflows</em> de cada vez ms empresas de programacin en cualquier lenguaje.</p><p>Dada la capacidad de procesamiento asncrono es una herramienta ideal para generar sistemas que respondan en <strong>tiempo real</strong>. Y por su escasa demanda de <em>hardware</em> se usa tambin en proyectos de <strong>Internet of Things</strong></p><p>En definitiva podemos decir que NodeJS y su ecosistema proponen un nuevo paradigma de desarrollo que eleva a JavaScript como lenguaje <strong>de propsito general.</strong></p>"},{"title":"Soluciones FrontEnd 2016","id":"7","updated":"2016-01-14T10:17:31.000Z","date":"2016-01-14T09:39:32.000Z","_content":"\nInicio el ao proponiendo una seleccin de tecnologas que sern **tendencia en el desarrollo front end** durante este 2016.\n\n* Mi apuesta de mercado empieza por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido **[ES6](http://es6-features.org/#Constants)**. Tras siete aos desde la anterior gran revisin, el xito y la popularidad de JS no poda esperar ms. Y tu tampoco debes esperar ms para conocerlo y usarlo.\n\n* Existe una creciente necesidad de dependencias externas en nuestra aplicaciones y sobre todo incorporar libreras provenientes de otros entornos y desarrolladas con variantes de JS. Para administrar todo ello propongo **[JSPM](http://jspm.io/)**, que se incorporar definitivamente a nuestro toolbox durante el 2016.\n\n* De entre las libreras y frameworks disponibles, AngularJS continuar siendo el rey. Este viejo conocido est creciendo en ya en grandes empresas, banca y administraciones pblicas. Mientras esperamos la gloriosa venida de la versin 2.0, tenemos la oportunidad de  adecuar nuestro estilo de programacin y desarrollar de manera mas limpia con la versin puente **[AngularJS1.5](https://www.angularjs.org/)**\n\n* En la parte visual, el look & feel propuesto por Google con Material Design es un xito de aceptacin para el desarrollo de aplicaciones empresariales. La librera **[AngularMaterial](https://material.angularjs.org/latest/)** es una implementacin para Angular de dicha especificacin grfica. Moderno y con enorme potencial.\n\nEn [esta presentacin](https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing) tienes ms informacin acerca de lo que llamo **frontEdge** : tecnologa utilizable, de ltima generacin y con enorme potencial. \n\n[Presentacin frontEdge](https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing)\n\nSi tienes tiempo, mira [este vdeo](https://www.youtube.com/watch?v=vJZb_rs2vvU) con una charla en la que comentamos estas y otras tecnologas para programadores.\n\n[video frontEdge](https://www.youtube.com/watch?v=vJZb_rs2vvU)","source":"_posts/Soluciones-FrontEnd-2016.md","raw":"---\ntitle: Soluciones FrontEnd 2016\ntags: \n- FrontEnd\n- AngularJS\ncategories:\n- Opinin\npermalink: soluciones-frontend-2016\nid: 7\nupdated: '2016-01-14 11:17:31'\ndate: 2016-01-14 10:39:32\n---\n\nInicio el ao proponiendo una seleccin de tecnologas que sern **tendencia en el desarrollo front end** durante este 2016.\n\n* Mi apuesta de mercado empieza por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido **[ES6](http://es6-features.org/#Constants)**. Tras siete aos desde la anterior gran revisin, el xito y la popularidad de JS no poda esperar ms. Y tu tampoco debes esperar ms para conocerlo y usarlo.\n\n* Existe una creciente necesidad de dependencias externas en nuestra aplicaciones y sobre todo incorporar libreras provenientes de otros entornos y desarrolladas con variantes de JS. Para administrar todo ello propongo **[JSPM](http://jspm.io/)**, que se incorporar definitivamente a nuestro toolbox durante el 2016.\n\n* De entre las libreras y frameworks disponibles, AngularJS continuar siendo el rey. Este viejo conocido est creciendo en ya en grandes empresas, banca y administraciones pblicas. Mientras esperamos la gloriosa venida de la versin 2.0, tenemos la oportunidad de  adecuar nuestro estilo de programacin y desarrollar de manera mas limpia con la versin puente **[AngularJS1.5](https://www.angularjs.org/)**\n\n* En la parte visual, el look & feel propuesto por Google con Material Design es un xito de aceptacin para el desarrollo de aplicaciones empresariales. La librera **[AngularMaterial](https://material.angularjs.org/latest/)** es una implementacin para Angular de dicha especificacin grfica. Moderno y con enorme potencial.\n\nEn [esta presentacin](https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing) tienes ms informacin acerca de lo que llamo **frontEdge** : tecnologa utilizable, de ltima generacin y con enorme potencial. \n\n[Presentacin frontEdge](https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing)\n\nSi tienes tiempo, mira [este vdeo](https://www.youtube.com/watch?v=vJZb_rs2vvU) con una charla en la que comentamos estas y otras tecnologas para programadores.\n\n[video frontEdge](https://www.youtube.com/watch?v=vJZb_rs2vvU)","slug":"soluciones-frontend-2016","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvhs0019iwd3xtobv2q2","content":"<p>Inicio el ao proponiendo una seleccin de tecnologas que sern <strong>tendencia en el desarrollo front end</strong> durante este 2016.</p><ul><li><p>Mi apuesta de mercado empieza por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido <strong><a href=\"http://es6-features.org/#Constants\" target=\"_blank\" rel=\"external\">ES6</a></strong>. Tras siete aos desde la anterior gran revisin, el xito y la popularidad de JS no poda esperar ms. Y tu tampoco debes esperar ms para conocerlo y usarlo.</p></li><li><p>Existe una creciente necesidad de dependencias externas en nuestra aplicaciones y sobre todo incorporar libreras provenientes de otros entornos y desarrolladas con variantes de JS. Para administrar todo ello propongo <strong><a href=\"http://jspm.io/\" target=\"_blank\" rel=\"external\">JSPM</a></strong>, que se incorporar definitivamente a nuestro toolbox durante el 2016.</p></li><li><p>De entre las libreras y frameworks disponibles, AngularJS continuar siendo el rey. Este viejo conocido est creciendo en ya en grandes empresas, banca y administraciones pblicas. Mientras esperamos la gloriosa venida de la versin 2.0, tenemos la oportunidad de adecuar nuestro estilo de programacin y desarrollar de manera mas limpia con la versin puente <strong><a href=\"https://www.angularjs.org/\" target=\"_blank\" rel=\"external\">AngularJS1.5</a></strong></p></li><li><p>En la parte visual, el look &amp; feel propuesto por Google con Material Design es un xito de aceptacin para el desarrollo de aplicaciones empresariales. La librera <strong><a href=\"https://material.angularjs.org/latest/\" target=\"_blank\" rel=\"external\">AngularMaterial</a></strong> es una implementacin para Angular de dicha especificacin grfica. Moderno y con enorme potencial.</p></li></ul><p>En <a href=\"https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing\" target=\"_blank\" rel=\"external\">esta presentacin</a> tienes ms informacin acerca de lo que llamo <strong>frontEdge</strong> : tecnologa utilizable, de ltima generacin y con enorme potencial.</p><p><a href=\"https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing\" target=\"_blank\" rel=\"external\">Presentacin frontEdge</a></p><p>Si tienes tiempo, mira <a href=\"https://www.youtube.com/watch?v=vJZb_rs2vvU\" target=\"_blank\" rel=\"external\">este vdeo</a> con una charla en la que comentamos estas y otras tecnologas para programadores.</p><p><a href=\"https://www.youtube.com/watch?v=vJZb_rs2vvU\" target=\"_blank\" rel=\"external\">video frontEdge</a></p>","site":{"data":{}},"excerpt":"","more":"<p>Inicio el ao proponiendo una seleccin de tecnologas que sern <strong>tendencia en el desarrollo front end</strong> durante este 2016.</p><ul><li><p>Mi apuesta de mercado empieza por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido <strong><a href=\"http://es6-features.org/#Constants\" target=\"_blank\" rel=\"external\">ES6</a></strong>. Tras siete aos desde la anterior gran revisin, el xito y la popularidad de JS no poda esperar ms. Y tu tampoco debes esperar ms para conocerlo y usarlo.</p></li><li><p>Existe una creciente necesidad de dependencias externas en nuestra aplicaciones y sobre todo incorporar libreras provenientes de otros entornos y desarrolladas con variantes de JS. Para administrar todo ello propongo <strong><a href=\"http://jspm.io/\" target=\"_blank\" rel=\"external\">JSPM</a></strong>, que se incorporar definitivamente a nuestro toolbox durante el 2016.</p></li><li><p>De entre las libreras y frameworks disponibles, AngularJS continuar siendo el rey. Este viejo conocido est creciendo en ya en grandes empresas, banca y administraciones pblicas. Mientras esperamos la gloriosa venida de la versin 2.0, tenemos la oportunidad de adecuar nuestro estilo de programacin y desarrollar de manera mas limpia con la versin puente <strong><a href=\"https://www.angularjs.org/\" target=\"_blank\" rel=\"external\">AngularJS1.5</a></strong></p></li><li><p>En la parte visual, el look &amp; feel propuesto por Google con Material Design es un xito de aceptacin para el desarrollo de aplicaciones empresariales. La librera <strong><a href=\"https://material.angularjs.org/latest/\" target=\"_blank\" rel=\"external\">AngularMaterial</a></strong> es una implementacin para Angular de dicha especificacin grfica. Moderno y con enorme potencial.</p></li></ul><p>En <a href=\"https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing\" target=\"_blank\" rel=\"external\">esta presentacin</a> tienes ms informacin acerca de lo que llamo <strong>frontEdge</strong> : tecnologa utilizable, de ltima generacin y con enorme potencial.</p><p><a href=\"https://docs.google.com/presentation/d/1ah0w0oW-urVn3rQbX5su2ZydFSyxyw4TIaeq2fCdR1Y/edit?usp=sharing\" target=\"_blank\" rel=\"external\">Presentacin frontEdge</a></p><p>Si tienes tiempo, mira <a href=\"https://www.youtube.com/watch?v=vJZb_rs2vvU\" target=\"_blank\" rel=\"external\">este vdeo</a> con una charla en la que comentamos estas y otras tecnologas para programadores.</p><p><a href=\"https://www.youtube.com/watch?v=vJZb_rs2vvU\" target=\"_blank\" rel=\"external\">video frontEdge</a></p>"},{"title":"Soluciones BackEnd 2016","id":"8","updated":"2016-04-01T06:02:55.000Z","date":"2016-03-21T10:50:58.000Z","_content":"\nLas soluciones JavaScript para el servidor que marcan **tendencia en el desarrollo back end** durante este 2016. Continuacin de la saga que iniciamos con **[FrontEdge](http://academia-binaria.com/soluciones-frontend-2016/)**.\n\n* Mi apuesta de mercado sigue empezando por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido **[ES6](http://es6-features.org/#Constants)**. En el lado del servidor destaco la disponibilidad de [Promesas](http://es6-features.org/#PromiseUsage) de forma nativa..\n\n* Las aplicaciones crecen y se controlan por su API.As que este es el punto al que ms atencin debes prestarle. Por supuesto que *hay que cumplir con el estndar REST y hay que documentar* todo nuestro cdigo. Pero para ser ms productivo y mantener actualizado el sistema, te propongo que uses **[RAML](http://raml.org/)**. Un lenguaje para documentar APIs que con las herramientas adecuadas permite la generacin de pruebas, esqueletos de aplicaciones e infraestructura. \n\n* El ya viejo conocido **[NodeJS](https://nodejs.org/)** se ha modernizado y a partir de la versin 4, especialmente en la 5, admite la mayor parte de la sintaxis ES6. Adems ha mejorado su velocidad en un 25% gracias a la actualizacin del motor V8 que procesa internamente el JavaScript.\n\n* En la base de datos irrumpe con fuerza la nueva versin de **[MongoDB 3.2](https://docs.mongodb.org/manual/release-notes/3.2/)**, que incorpora grandes novedades como: sistema de almacenamiento ms rpido, ndices parciales, validacin de esquema y el esperado *join* entre colecciones .\n\nEn [esta presentacin](https://docs.google.com/presentation/d/12gdsjxUgsN58uzxF4XO38cP2QSH6IR5WjEZBLGfCgUY/edit?usp=sharing) tienes ms informacin acerca de lo que llamo **backEdge** : tecnologa utilizable, de ltima generacin y con enorme potencial. \n\nEn [este video](https://youtu.be/cfmJQjBfM-s) tienes la charla que di con o que llamo **Desarrollo Web** presentando las tendencias tecnolgicas del 2016. ","source":"_posts/Soluciones-BackEnd-2016.md","raw":"---\ntitle: Soluciones BackEnd 2016\ntags: \n- BackEnd\n- NodeJS\n- MongoDB\ncategories:\n- Opinin\npermalink: soluciones-backend-2016\nid: 8\nupdated: '2016-04-01 08:02:55'\ndate: 2016-03-21 11:50:58\n---\n\nLas soluciones JavaScript para el servidor que marcan **tendencia en el desarrollo back end** durante este 2016. Continuacin de la saga que iniciamos con **[FrontEdge](http://academia-binaria.com/soluciones-frontend-2016/)**.\n\n* Mi apuesta de mercado sigue empezando por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido **[ES6](http://es6-features.org/#Constants)**. En el lado del servidor destaco la disponibilidad de [Promesas](http://es6-features.org/#PromiseUsage) de forma nativa..\n\n* Las aplicaciones crecen y se controlan por su API.As que este es el punto al que ms atencin debes prestarle. Por supuesto que *hay que cumplir con el estndar REST y hay que documentar* todo nuestro cdigo. Pero para ser ms productivo y mantener actualizado el sistema, te propongo que uses **[RAML](http://raml.org/)**. Un lenguaje para documentar APIs que con las herramientas adecuadas permite la generacin de pruebas, esqueletos de aplicaciones e infraestructura. \n\n* El ya viejo conocido **[NodeJS](https://nodejs.org/)** se ha modernizado y a partir de la versin 4, especialmente en la 5, admite la mayor parte de la sintaxis ES6. Adems ha mejorado su velocidad en un 25% gracias a la actualizacin del motor V8 que procesa internamente el JavaScript.\n\n* En la base de datos irrumpe con fuerza la nueva versin de **[MongoDB 3.2](https://docs.mongodb.org/manual/release-notes/3.2/)**, que incorpora grandes novedades como: sistema de almacenamiento ms rpido, ndices parciales, validacin de esquema y el esperado *join* entre colecciones .\n\nEn [esta presentacin](https://docs.google.com/presentation/d/12gdsjxUgsN58uzxF4XO38cP2QSH6IR5WjEZBLGfCgUY/edit?usp=sharing) tienes ms informacin acerca de lo que llamo **backEdge** : tecnologa utilizable, de ltima generacin y con enorme potencial. \n\nEn [este video](https://youtu.be/cfmJQjBfM-s) tienes la charla que di con o que llamo **Desarrollo Web** presentando las tendencias tecnolgicas del 2016. ","slug":"soluciones-backend-2016","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvhs001diwd3sjrli39w","content":"<p>Las soluciones JavaScript para el servidor que marcan <strong>tendencia en el desarrollo back end</strong> durante este 2016. Continuacin de la saga que iniciamos con <strong><a href=\"http://academia-binaria.com/soluciones-frontend-2016/\">FrontEdge</a></strong>.</p><ul><li><p>Mi apuesta de mercado sigue empezando por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido <strong><a href=\"http://es6-features.org/#Constants\" target=\"_blank\" rel=\"external\">ES6</a></strong>. En el lado del servidor destaco la disponibilidad de <a href=\"http://es6-features.org/#PromiseUsage\" target=\"_blank\" rel=\"external\">Promesas</a> de forma nativa..</p></li><li><p>Las aplicaciones crecen y se controlan por su API.As que este es el punto al que ms atencin debes prestarle. Por supuesto que <em>hay que cumplir con el estndar REST y hay que documentar</em> todo nuestro cdigo. Pero para ser ms productivo y mantener actualizado el sistema, te propongo que uses <strong><a href=\"http://raml.org/\" target=\"_blank\" rel=\"external\">RAML</a></strong>. Un lenguaje para documentar APIs que con las herramientas adecuadas permite la generacin de pruebas, esqueletos de aplicaciones e infraestructura.</p></li><li><p>El ya viejo conocido <strong><a href=\"https://nodejs.org/\" target=\"_blank\" rel=\"external\">NodeJS</a></strong> se ha modernizado y a partir de la versin 4, especialmente en la 5, admite la mayor parte de la sintaxis ES6. Adems ha mejorado su velocidad en un 25% gracias a la actualizacin del motor V8 que procesa internamente el JavaScript.</p></li><li><p>En la base de datos irrumpe con fuerza la nueva versin de <strong><a href=\"https://docs.mongodb.org/manual/release-notes/3.2/\" target=\"_blank\" rel=\"external\">MongoDB 3.2</a></strong>, que incorpora grandes novedades como: sistema de almacenamiento ms rpido, ndices parciales, validacin de esquema y el esperado <em>join</em> entre colecciones .</p></li></ul><p>En <a href=\"https://docs.google.com/presentation/d/12gdsjxUgsN58uzxF4XO38cP2QSH6IR5WjEZBLGfCgUY/edit?usp=sharing\" target=\"_blank\" rel=\"external\">esta presentacin</a> tienes ms informacin acerca de lo que llamo <strong>backEdge</strong> : tecnologa utilizable, de ltima generacin y con enorme potencial.</p><p>En <a href=\"https://youtu.be/cfmJQjBfM-s\" target=\"_blank\" rel=\"external\">este video</a> tienes la charla que di con o que llamo <strong>Desarrollo Web</strong> presentando las tendencias tecnolgicas del 2016.</p>","site":{"data":{}},"excerpt":"","more":"<p>Las soluciones JavaScript para el servidor que marcan <strong>tendencia en el desarrollo back end</strong> durante este 2016. Continuacin de la saga que iniciamos con <strong><a href=\"http://academia-binaria.com/soluciones-frontend-2016/\">FrontEdge</a></strong>.</p><ul><li><p>Mi apuesta de mercado sigue empezando por la base, el lenguaje JavaScript. En concreto su ltima y muy necesaria versin: el conocido <strong><a href=\"http://es6-features.org/#Constants\" target=\"_blank\" rel=\"external\">ES6</a></strong>. En el lado del servidor destaco la disponibilidad de <a href=\"http://es6-features.org/#PromiseUsage\" target=\"_blank\" rel=\"external\">Promesas</a> de forma nativa..</p></li><li><p>Las aplicaciones crecen y se controlan por su API.As que este es el punto al que ms atencin debes prestarle. Por supuesto que <em>hay que cumplir con el estndar REST y hay que documentar</em> todo nuestro cdigo. Pero para ser ms productivo y mantener actualizado el sistema, te propongo que uses <strong><a href=\"http://raml.org/\" target=\"_blank\" rel=\"external\">RAML</a></strong>. Un lenguaje para documentar APIs que con las herramientas adecuadas permite la generacin de pruebas, esqueletos de aplicaciones e infraestructura.</p></li><li><p>El ya viejo conocido <strong><a href=\"https://nodejs.org/\" target=\"_blank\" rel=\"external\">NodeJS</a></strong> se ha modernizado y a partir de la versin 4, especialmente en la 5, admite la mayor parte de la sintaxis ES6. Adems ha mejorado su velocidad en un 25% gracias a la actualizacin del motor V8 que procesa internamente el JavaScript.</p></li><li><p>En la base de datos irrumpe con fuerza la nueva versin de <strong><a href=\"https://docs.mongodb.org/manual/release-notes/3.2/\" target=\"_blank\" rel=\"external\">MongoDB 3.2</a></strong>, que incorpora grandes novedades como: sistema de almacenamiento ms rpido, ndices parciales, validacin de esquema y el esperado <em>join</em> entre colecciones .</p></li></ul><p>En <a href=\"https://docs.google.com/presentation/d/12gdsjxUgsN58uzxF4XO38cP2QSH6IR5WjEZBLGfCgUY/edit?usp=sharing\" target=\"_blank\" rel=\"external\">esta presentacin</a> tienes ms informacin acerca de lo que llamo <strong>backEdge</strong> : tecnologa utilizable, de ltima generacin y con enorme potencial.</p><p>En <a href=\"https://youtu.be/cfmJQjBfM-s\" target=\"_blank\" rel=\"external\">este video</a> tienes la charla que di con o que llamo <strong>Desarrollo Web</strong> presentando las tendencias tecnolgicas del 2016.</p>"},{"title":"TypeScript, programa en el front igual que en el back","id":"23","updated":"2017-03-14T18:10:13.000Z","date":"2017-03-14T18:02:11.000Z","thumbnail":"/css/images/typescript.jpg","_content":"\nHasta hace bien poco haba dos mundos en la programacin casi enfrentados: el desarrollo *back end y el front end*. El primero era el de los programadores de verdad, con **lenguajes serios y patrones de diseo**. El ltimo era el universo de los diseadores, con lenguajes de segundo nivel y **micro scripts o cdigo espagueti** descontrolado.\n\n<!-- more -->\n\nPero la llegada de los frameworks *MVC* en el cliente, llev **grandes cantidades de cdigo al navegador** y el desarrollo front end ya nunca sera lo mismo. Primero se portaron los patrones, despus las buenas prcticas, ms tarde las herramientas y as hasta haber eliminado las fronteras entre *back y front*.\n\nPero quedaba algo pendiente, el leguaje. En el lado del servidor haba multitud de opciones, siendo *Java* y *C#* las ms aceptadas por la empresa, administracin y banca. Pero al otro lado del cable segua, con algunos retoques, el viejo *JavaScript*.\n\nY entonces eclosion *TypeScript*. Un proyecto maduro creado por el equipo de desarrollo de Microsoft y que lleva a *JavaScript* al siguiente nivel. Con **tipos estticos** (de ah su nombre) propicia que las herramientas de desarrollo mejoren la productividad y experiencia de los programadores. Y como consecuencia **suaviza la rampa de entrada al *front* para los desarrolladores *back***.\n\nYa no queda excusas para programar en el cliente igual de bien que en el servidor. Prueba el *TypeScript* si dominas y te gusta la POO, sers un *full stack* cuestin de horas.","source":"_posts/TypeScript-programa-en-el-front-igual-que-en-el-back.md","raw":"---\ntitle: 'TypeScript, programa en el front igual que en el back'\ntags: \n- TypeScript\ncategories:\n- Opinin\npermalink: typescript-programa-en-el-front-igual-que-en-el-back\nid: 23\nupdated: '2017-03-14 19:10:13'\ndate: 2017-03-14 19:02:11\nthumbnail: /css/images/typescript.jpg\n---\n\nHasta hace bien poco haba dos mundos en la programacin casi enfrentados: el desarrollo *back end y el front end*. El primero era el de los programadores de verdad, con **lenguajes serios y patrones de diseo**. El ltimo era el universo de los diseadores, con lenguajes de segundo nivel y **micro scripts o cdigo espagueti** descontrolado.\n\n<!-- more -->\n\nPero la llegada de los frameworks *MVC* en el cliente, llev **grandes cantidades de cdigo al navegador** y el desarrollo front end ya nunca sera lo mismo. Primero se portaron los patrones, despus las buenas prcticas, ms tarde las herramientas y as hasta haber eliminado las fronteras entre *back y front*.\n\nPero quedaba algo pendiente, el leguaje. En el lado del servidor haba multitud de opciones, siendo *Java* y *C#* las ms aceptadas por la empresa, administracin y banca. Pero al otro lado del cable segua, con algunos retoques, el viejo *JavaScript*.\n\nY entonces eclosion *TypeScript*. Un proyecto maduro creado por el equipo de desarrollo de Microsoft y que lleva a *JavaScript* al siguiente nivel. Con **tipos estticos** (de ah su nombre) propicia que las herramientas de desarrollo mejoren la productividad y experiencia de los programadores. Y como consecuencia **suaviza la rampa de entrada al *front* para los desarrolladores *back***.\n\nYa no queda excusas para programar en el cliente igual de bien que en el servidor. Prueba el *TypeScript* si dominas y te gusta la POO, sers un *full stack* cuestin de horas.","slug":"typescript-programa-en-el-front-igual-que-en-el-back","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvhs001giwd3e9p6o803","content":"<p>Hasta hace bien poco haba dos mundos en la programacin casi enfrentados: el desarrollo <em>back end y el front end</em>. El primero era el de los programadores de verdad, con <strong>lenguajes serios y patrones de diseo</strong>. El ltimo era el universo de los diseadores, con lenguajes de segundo nivel y <strong>micro scripts o cdigo espagueti</strong> descontrolado.</p><a id=\"more\"></a><p>Pero la llegada de los frameworks <em>MVC</em> en el cliente, llev <strong>grandes cantidades de cdigo al navegador</strong> y el desarrollo front end ya nunca sera lo mismo. Primero se portaron los patrones, despus las buenas prcticas, ms tarde las herramientas y as hasta haber eliminado las fronteras entre <em>back y front</em>.</p><p>Pero quedaba algo pendiente, el leguaje. En el lado del servidor haba multitud de opciones, siendo <em>Java</em> y <em>C#</em> las ms aceptadas por la empresa, administracin y banca. Pero al otro lado del cable segua, con algunos retoques, el viejo <em>JavaScript</em>.</p><p>Y entonces eclosion <em>TypeScript</em>. Un proyecto maduro creado por el equipo de desarrollo de Microsoft y que lleva a <em>JavaScript</em> al siguiente nivel. Con <strong>tipos estticos</strong> (de ah su nombre) propicia que las herramientas de desarrollo mejoren la productividad y experiencia de los programadores. Y como consecuencia <strong>suaviza la rampa de entrada al <em>front</em> para los desarrolladores <em>back</em></strong>.</p><p>Ya no queda excusas para programar en el cliente igual de bien que en el servidor. Prueba el <em>TypeScript</em> si dominas y te gusta la POO, sers un <em>full stack</em> cuestin de horas.</p>","site":{"data":{}},"excerpt":"<p>Hasta hace bien poco haba dos mundos en la programacin casi enfrentados: el desarrollo <em>back end y el front end</em>. El primero era el de los programadores de verdad, con <strong>lenguajes serios y patrones de diseo</strong>. El ltimo era el universo de los diseadores, con lenguajes de segundo nivel y <strong>micro scripts o cdigo espagueti</strong> descontrolado.</p>","more":"<p>Pero la llegada de los frameworks <em>MVC</em> en el cliente, llev <strong>grandes cantidades de cdigo al navegador</strong> y el desarrollo front end ya nunca sera lo mismo. Primero se portaron los patrones, despus las buenas prcticas, ms tarde las herramientas y as hasta haber eliminado las fronteras entre <em>back y front</em>.</p><p>Pero quedaba algo pendiente, el leguaje. En el lado del servidor haba multitud de opciones, siendo <em>Java</em> y <em>C#</em> las ms aceptadas por la empresa, administracin y banca. Pero al otro lado del cable segua, con algunos retoques, el viejo <em>JavaScript</em>.</p><p>Y entonces eclosion <em>TypeScript</em>. Un proyecto maduro creado por el equipo de desarrollo de Microsoft y que lleva a <em>JavaScript</em> al siguiente nivel. Con <strong>tipos estticos</strong> (de ah su nombre) propicia que las herramientas de desarrollo mejoren la productividad y experiencia de los programadores. Y como consecuencia <strong>suaviza la rampa de entrada al <em>front</em> para los desarrolladores <em>back</em></strong>.</p><p>Ya no queda excusas para programar en el cliente igual de bien que en el servidor. Prueba el <em>TypeScript</em> si dominas y te gusta la POO, sers un <em>full stack</em> cuestin de horas.</p>"},{"title":"Enrutador de componentes con Angular2 el nuevo SPA","id":"15","updated":"2016-12-07T17:23:02.000Z","date":"2016-06-02T06:52:04.000Z","thumbnail":"/css/images/angular.jpg","_content":"\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/)\n\n---\n\n> Cdigo asociado en [angular2/6-routing/](https://github.com/AcademiaBinaria/angular2/tree/master/6-routing)\n\nLa capacidad de gestionar las **rutas en el cliente** es una de las grandes ventajas de *AngularJS*. En la versin 1 nos ofrecan una solucin demasiado simple que obligaba a usar libreras de terceros como la famosa [ui-router](https://github.com/angular-ui/ui-router). Hemos esperado aos la promesa de un nuevo *enrutador* compatible con las versiones 1 y 2. El resultado es **@angular/router**.\n\nDe todo *Angular2*, este es el componente que ms ha cambiado durante la fase *Release Candidate*. Actualmente confiamos en que las pequeas dudas se resuelvan definitivamente y podamos relajarnos creando modernos desarrollos **SPA**.\n\n<!-- more -->\n\n## Mdulo de enrutado en base a componentes\n\nLas aplicaciones Angular2 son [rboles de mdulos](http://academia-binaria.com/componentes-los-bloques-de-construccion-de-angular-2/). Al menos el mdulo raz `AppModule` y cuantos mdulos funcionales nos hagan falta. Utilizando `angular-cli` podemos crear mdulos con la capacidad de enrutado generada en... un mdulo especfico.  \n\nA ver si desbrozamos algo este bosque de mdulos.\n\n```javascript\nng new mi-aplicacion --routing true\n```\n\nTanto para la raz como para las ramas funcionales se crear un fichero. En la raz ser llamado `app-routing.module.ts` con un contenido como este: \n\n```javascript\n/** Mdulos de enrutado de Angular2 */\nimport { RouterModule, Routes } from '@angular/router';\n\nimport { NgModule } from '@angular/core';\n\n// Array con las rutas de este mdulo. Ninguna funcional.\nconst routes: Routes = [\n  { path: '', redirectTo: '' },\n  { path: 'inicio', redirectTo: '' },\n  { path: '**', redirectTo: '', pathMatch: 'full' }\n];\n\n@NgModule({\n  imports: [\n    RouterModule.forRoot(routes) // configuracin para el mdulo raz\n  ],\n  exports: [\n    RouterModule // se importar desde el mdulo padre\n  ]\n})\nexport class AppRoutingModule { }\n```\n\nEste **mdulo** de un nico fichero sirve **para definir las rutas de otro mdulo padre** asociado, `app.module.ts`, el cual quedar ms o menos as:\n\n```javascript\n// importacin de mdulo de enrutado asociado\nimport { AppRoutingModule } from './app-routing.module';\n// importacin de otros mdulos de funcionalidad\nimport { HomeModule } from './home/home.module';\n// decorador que define un mdulo\n@NgModule({\n  declarations: [ AppComponent ], \n  imports: [\n    BrowserModule,\n    FormsModule,\n    HttpModule,\n    HomeModule, // el mdulo funcional para la 'pgina home'\n    AppRoutingModule // el mdulo de rutas ya configurado\n  ], \n  providers: [] \n  bootstrap: [ AppComponent ] \n})\nexport class AppModule { }\n```\n\n## Mdulos funcionales\nEl mdulo raz es fundamental pero nada operativo. Toda el que sea de inters para los usuarios estar en mdulos funcionales. En las aplicaciones SPA es una buena prctica crear **un mdulo por cada ruta** principal. Incluida la pgina home. Por ejemplo usando el siguiente comando:\n\n```javascript\nng generate module home --routing true\n```\nAparece un fichero llamado `home-routing-module.ts`. Este mdulo se debe configurar para que gestione sus propias rutas.\n\n```javascript\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n/** Componente enrutable */\nimport { HomeComponent } from './home.component';\n/** Rutas asociadas a componentes */\nconst routes: Routes = [\n  { path: '', component: HomeComponent },\n];\n/** array de componentes enrutables */\nexport const routableComponents = [\n  HomeComponent\n];\n@NgModule({\n  imports: [\n    RouterModule.forChild(routes) // Para mdulo funcional\n  ],\n  exports: [\n    RouterModule // listo para importarlo en HomeModule\n  ]\n})\nexport class HomeRoutingModule { }\n```\n\nSe crean dos arrays relacionados. EL principal, `routes`, contendr las **rutas pareadas con sus componentes** respectivos. \nLos cuales tambin se exportan directamente en la variable `routableComponents`. Esto se hace por comodidad. Para no tener que volver a importarlos en la declaracin del mdulo padre, que quedar as:\n\n```javascript\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n/** Importacin de las rutas y sus componentes */\nimport { HomeRoutingModule, routableComponents } from './home-routing.module';\n@NgModule({\n  imports: [\n    CommonModule,\n    HomeRoutingModule // el mdulo que sabe enrutar\n  ],\n  declarations: [\n    routableComponents // los componentes de enrutado\n  ]\n})\nexport class HomeModule { }\n```\n\n### Carga de componentes segn la ruta\nTodo este trabajo de configuracin se materializa en las **vistas**. Necesitaremos un lugar dnde inyectar el **componente de turno asociado a la ruta** actual. Presentamos el `router-outlet`. Y para que la aplicacin pueda llevarnos de un lugar a otro usaremos  la directiva `routerLink`. \n\nDe forma que la plantilla raz `app.component.html` quedar normalmente as:\n\n```html\n<!--men de navegacin, sin href-->\n<nav>\n  <a [routerLink]=\"['/']\">Inicio</a>\n  <a [routerLink]=\"['/login']\">Log In</a>\n  <a [routerLink]=\"['/contacto']\">Contacto</a>\n</nav>\n<!--Este componente nativo hace que el enrutador cargue una pgina dinmicamente-->\n<router-outlet></router-outlet>\n```\n\n\n## Rutas hijas y con parmetros\nDe poco vale un enrutador que slo atienda a los casos sencillos. Las aplicaciones profesionales plantean mayores retos. \n### Rutas hijas\nUn ejemplo son las **rutas anidadas**, aqu llamadas rutas hijas. Son aquellas en las que una parte de la visualizacin es comn y otra depende de la ruta concreta.\n\nVeamos un ejemplo dnde se pretende dar de alta y mostrar una lista de elementos. La base de cualquier *CRUD*. As quedara el fichero `movimientos-routing.module.ts`.\n \n```javascript\n/** Importacin de los componentes enrutables */\nimport { MovimientosComponent } from './movimientos.component';\nimport { ListaComponent } from './lista/lista.component';\nimport { NuevoComponent } from './nuevo/nuevo.component';\n\nconst routes: Routes = [\n  {\n    path: 'movimientos',\n    component: MovimientosComponent,\n    children: [ // rutas hijas, se vern dentro del componente padre\n      {\n        path: 'nuevo', // la ruta real es movimientos/nuevo\n        component: NuevoComponent\n      },\n      {\n        path: 'lista',\n        component: ListaComponent\n      }\n    ]\n  }\n];\nexport const routableComponents = [\n  NuevoComponent,\n  ListaComponent,\n  MovimientosComponent\n]\n```\nEste mini-mdulo es muy denso. Contrasta con la simplicidad del `movimientos.module.ts` que reduce su responsabilidad. Slo tiene que importar los mdulos adecuados.\n\n```javascript\nimport { FormsModule } from '@angular/forms';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n/** Mdulo de enrutado y componentes */\nimport { MovimientosRoutingModule, routableComponents } from './movimientos-routing.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    MovimientosRoutingModule\n  ], // dependencias de otros mdulos, especialmente el de enrutado\n  declarations: [\n    routableComponents\n  ], // Los componentes vienen del fichero movimientos-routing.module.ts\n  exports: [\n\n  ], // no necesita exportar nada\n})\n```\n\nVemos que la idea es que los ficheros de definicin de mdulos funcionales **deleguen toda la lgica** posible a su propio mdulo de enrutado.\n\nMientras tanto en la vista... Habamos dejado la *template* del componente raz con un `router-outlet`. Ser ah dnde se cargue el `MovimientosComponent` cuando se active la ruta *'/movimientos'*. Pero, y las rutas hijas?, qu se carga y dnde se carga cuando se activa la ruta *'/movimientos/nuevo'* o la ruta *'/movimientos/lista'* ?.\n\nEchemos un vistazo a `movimientos.component.html` para comprobar que dispone de su propio `router-outlet`. \n\n```html\n<nav>\n   <a routerLink=\"/movimientos/nuevo\" >Nuevo Movimiento</a>\n   <a routerLink=\"/movimientos/lista\" >Lista de Movimientos</a>\n</nav>\n<router-outlet></router-outlet>\n```\n\nSer en este elemento donde se inyecten los componentes asociados a las rutas hijas. Este *anidamiento* permite hacer aplicaciones modulares y acceder a vistas especficas con rutas especficas. \n\n\n### Rutas con parmetros \n\nHasta ahora us rutas fijas para navegar. Lo ms normal es que estas **plantillas contengan segmentos variables** llamados parmetros. Para incorporar parmetros a tu esquema de rutas tienes que actuar en tres fases:\n\n#### 1- Definir la parte paramtrica de la plantilla generadora de rutas\n\nEl *path* del objeto ruta se convierte en una plantilla que admite distintos valores. As queda ahora el mdulo enrutador de movimientos:\n\n```javascript\nconst routes: Routes = [\n  {\n    path: 'movimientos',\n    component: MovimientosComponent,\n    children: [ // rutas hijas, se vern dentro del componente padre\n      {\n        path: 'nuevo', // la ruta real es movimientos/nuevo\n        component: NuevoComponent\n      },\n      {\n        path: 'lista',\n        component: ListaComponent\n      }\n    ]\n  },\n  {\n    path: 'movimientos/:id', // parmetro variable id    \n    component: EditorComponent\n  }\n];\n```\n\nLos parmetros se prefijan con `:` y en cada ruta se pueden usar tantos como sea necesario. \n\n>Obsrvese que en este caso la ruta 'movimientos/:id' es hermana, no hija, de la primera. Por tanto se mostrar en el `router-outlet` del componente raz. Se ha hecho as para mostrar distintas maneras de trabajar en el 'router'.\n\n \n\n#### 2- Montar los enlaces asignando valores a los parmetros\n\nEsto se puede hacer en las plantillas HTML o en por cdigo. Siempre usando el **array de `routerLink`** sin necesidad de concatenar cadenas para para montar rutas. Este array en su segunda posicin llevar un objeto que represente los valores de los parmetros. \n\nEn un caso de navegacin por cdigo sencillo tendr esta pinta:\n```javascript\n  // para ir a la ruta /movimientos/42\n  this.router.navigate(['movimientos', 42])\n```\n\nUsando desde la vista en igual de sencillo con la directiva `routerLink`, como en este ejemplo HTML:\n\n```html\n<a [routerLink]=\"['/movimientos', 42 ]\">42</a>\n```\n\n#### 3- Recuperar los valores de los parmetros a partir de las rutas\nLa novedad ms llamativa es la presencia de `OnInit`. Es un *hook*, o evento de la vida de un componente. Este evento se ejecuta al iniciarse el componente pero cuando ya la ruta se ha resuelto completamente. \nEn ese momento puedes usar `ActivatedRoute`, un servicio que entre otras cosas te dar acceso a un *observable* que emite los valores actuales de los parmetros.\nPor ejemplo, esto sera el cdigo del componente `editor.component.ts` que se activa con rutas como *'/movimientos/42'*\n\n```javascript\nimport { Component, OnInit } from '@angular/core';\n/** Servicio para acceder a la ruta activa */\nimport { ActivatedRoute } from '@angular/router';\nimport { DatosService } from './../datos.service';\n@Component({\n  selector: 'app-editor',\n  templateUrl: './editor.component.html',\n  styleUrls: ['./editor.component.css']\n})\nexport class EditorComponent implements OnInit {\n  public movimiento;\n  constructor(\n      private route: ActivatedRoute, \n      private datosService: DatosService) { \n      // constructor vaco. slo se usa para reclamar dependencias         \n  }\n  ngOnInit() {\n    // subscripcin al observable params\n    this.route.params\n      .subscribe(params => {\n        const _id = params['id'].toString();\n        this.movimiento = this.datosService.getMovimientoBy_Id(_id);\n      });\n  }\n}\n```\n> Hay una estrategia opcional que emplea `Observables` para mantener potenciales cambios de estado en los valores de los parmetros. Si te interesa busca informacin sobre `Router` .\n\n### Carga diferida\n\nEsta es la funcionalidad ms esperada y que sigue siendo un *work in progress*. Cuando las aplicaciones AngularJS crecen en funcionalidad producen un **impacto negativo en la primera vista** de un usuario. Eso es debido a que *Angular* necesita disponer de todo tu cdigo para montar el armazn de dependencias. Esto es as aunque el usuario no vaya a navegar mas que por un conjunto reducido de rutas.\n\nEn aplicaciones de *intranet* o de uso muy intensivo esto no suele ser un gran problema. Esa espera inicial de unos pocos segundos se recupera durante el uso continuado de la aplicacin. Pero ciertos desarrollos realmente grandes o, sobre todo, **aplicaciones web pblicas para usuarios ocasionales** necesitaban un tratamiento especial.\n\nLa solucin es implementar un modelo de *lazy loading* o carga diferida. En este caso el navegador descarga el HTML y el cdigo de la aplicacin segn el usuario navegue. \n\nEn *Angular2* se incluye esta funcionalidad, pero a da de hoy an no est disponible con `angular-cli`. Se puede *tunear WebPack* a mano para conseguirlo, pero, si no hay urgencia en salir a produccin, no te lo recomiendo. Es preferible esperar un poco y usar el la solucin definitiva que implemente la herramienta.\n\nEn cuanto sea *usable* actualizar este artculo y difundir la buena nueva a los cuatro vientos. Como sabes an estamos esperando la primera *Release Candidate* de `angular-cli` y habr mejoras importantes. \n\nMantente a la ltima recibiendo el [boletn de noticias de Academia Binaria](http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&id=b67e4d2339) o siguindome en las [redes sociales](https://twitter.com/albertobasalo). \n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/)","source":"_posts/Enrutador-de-componentes-con-Angular2-el-nuevo-SPA.md","raw":"---\ntitle: Enrutador de componentes con Angular2 el nuevo SPA\ntags:  \n- Angular2\n- SPA\n- Tutorial\ncategories:\n- Introduccin \npermalink: enrutado-con-angular2-el-nuevo-spa\nid: 15\nupdated: 2016/12/07 18:23:02\ndate: 2016/06/02 08:52:04\nthumbnail: /css/images/angular.jpg\n---\n\n> ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/)\n\n---\n\n> Cdigo asociado en [angular2/6-routing/](https://github.com/AcademiaBinaria/angular2/tree/master/6-routing)\n\nLa capacidad de gestionar las **rutas en el cliente** es una de las grandes ventajas de *AngularJS*. En la versin 1 nos ofrecan una solucin demasiado simple que obligaba a usar libreras de terceros como la famosa [ui-router](https://github.com/angular-ui/ui-router). Hemos esperado aos la promesa de un nuevo *enrutador* compatible con las versiones 1 y 2. El resultado es **@angular/router**.\n\nDe todo *Angular2*, este es el componente que ms ha cambiado durante la fase *Release Candidate*. Actualmente confiamos en que las pequeas dudas se resuelvan definitivamente y podamos relajarnos creando modernos desarrollos **SPA**.\n\n<!-- more -->\n\n## Mdulo de enrutado en base a componentes\n\nLas aplicaciones Angular2 son [rboles de mdulos](http://academia-binaria.com/componentes-los-bloques-de-construccion-de-angular-2/). Al menos el mdulo raz `AppModule` y cuantos mdulos funcionales nos hagan falta. Utilizando `angular-cli` podemos crear mdulos con la capacidad de enrutado generada en... un mdulo especfico.  \n\nA ver si desbrozamos algo este bosque de mdulos.\n\n```javascript\nng new mi-aplicacion --routing true\n```\n\nTanto para la raz como para las ramas funcionales se crear un fichero. En la raz ser llamado `app-routing.module.ts` con un contenido como este: \n\n```javascript\n/** Mdulos de enrutado de Angular2 */\nimport { RouterModule, Routes } from '@angular/router';\n\nimport { NgModule } from '@angular/core';\n\n// Array con las rutas de este mdulo. Ninguna funcional.\nconst routes: Routes = [\n  { path: '', redirectTo: '' },\n  { path: 'inicio', redirectTo: '' },\n  { path: '**', redirectTo: '', pathMatch: 'full' }\n];\n\n@NgModule({\n  imports: [\n    RouterModule.forRoot(routes) // configuracin para el mdulo raz\n  ],\n  exports: [\n    RouterModule // se importar desde el mdulo padre\n  ]\n})\nexport class AppRoutingModule { }\n```\n\nEste **mdulo** de un nico fichero sirve **para definir las rutas de otro mdulo padre** asociado, `app.module.ts`, el cual quedar ms o menos as:\n\n```javascript\n// importacin de mdulo de enrutado asociado\nimport { AppRoutingModule } from './app-routing.module';\n// importacin de otros mdulos de funcionalidad\nimport { HomeModule } from './home/home.module';\n// decorador que define un mdulo\n@NgModule({\n  declarations: [ AppComponent ], \n  imports: [\n    BrowserModule,\n    FormsModule,\n    HttpModule,\n    HomeModule, // el mdulo funcional para la 'pgina home'\n    AppRoutingModule // el mdulo de rutas ya configurado\n  ], \n  providers: [] \n  bootstrap: [ AppComponent ] \n})\nexport class AppModule { }\n```\n\n## Mdulos funcionales\nEl mdulo raz es fundamental pero nada operativo. Toda el que sea de inters para los usuarios estar en mdulos funcionales. En las aplicaciones SPA es una buena prctica crear **un mdulo por cada ruta** principal. Incluida la pgina home. Por ejemplo usando el siguiente comando:\n\n```javascript\nng generate module home --routing true\n```\nAparece un fichero llamado `home-routing-module.ts`. Este mdulo se debe configurar para que gestione sus propias rutas.\n\n```javascript\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n/** Componente enrutable */\nimport { HomeComponent } from './home.component';\n/** Rutas asociadas a componentes */\nconst routes: Routes = [\n  { path: '', component: HomeComponent },\n];\n/** array de componentes enrutables */\nexport const routableComponents = [\n  HomeComponent\n];\n@NgModule({\n  imports: [\n    RouterModule.forChild(routes) // Para mdulo funcional\n  ],\n  exports: [\n    RouterModule // listo para importarlo en HomeModule\n  ]\n})\nexport class HomeRoutingModule { }\n```\n\nSe crean dos arrays relacionados. EL principal, `routes`, contendr las **rutas pareadas con sus componentes** respectivos. \nLos cuales tambin se exportan directamente en la variable `routableComponents`. Esto se hace por comodidad. Para no tener que volver a importarlos en la declaracin del mdulo padre, que quedar as:\n\n```javascript\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n/** Importacin de las rutas y sus componentes */\nimport { HomeRoutingModule, routableComponents } from './home-routing.module';\n@NgModule({\n  imports: [\n    CommonModule,\n    HomeRoutingModule // el mdulo que sabe enrutar\n  ],\n  declarations: [\n    routableComponents // los componentes de enrutado\n  ]\n})\nexport class HomeModule { }\n```\n\n### Carga de componentes segn la ruta\nTodo este trabajo de configuracin se materializa en las **vistas**. Necesitaremos un lugar dnde inyectar el **componente de turno asociado a la ruta** actual. Presentamos el `router-outlet`. Y para que la aplicacin pueda llevarnos de un lugar a otro usaremos  la directiva `routerLink`. \n\nDe forma que la plantilla raz `app.component.html` quedar normalmente as:\n\n```html\n<!--men de navegacin, sin href-->\n<nav>\n  <a [routerLink]=\"['/']\">Inicio</a>\n  <a [routerLink]=\"['/login']\">Log In</a>\n  <a [routerLink]=\"['/contacto']\">Contacto</a>\n</nav>\n<!--Este componente nativo hace que el enrutador cargue una pgina dinmicamente-->\n<router-outlet></router-outlet>\n```\n\n\n## Rutas hijas y con parmetros\nDe poco vale un enrutador que slo atienda a los casos sencillos. Las aplicaciones profesionales plantean mayores retos. \n### Rutas hijas\nUn ejemplo son las **rutas anidadas**, aqu llamadas rutas hijas. Son aquellas en las que una parte de la visualizacin es comn y otra depende de la ruta concreta.\n\nVeamos un ejemplo dnde se pretende dar de alta y mostrar una lista de elementos. La base de cualquier *CRUD*. As quedara el fichero `movimientos-routing.module.ts`.\n \n```javascript\n/** Importacin de los componentes enrutables */\nimport { MovimientosComponent } from './movimientos.component';\nimport { ListaComponent } from './lista/lista.component';\nimport { NuevoComponent } from './nuevo/nuevo.component';\n\nconst routes: Routes = [\n  {\n    path: 'movimientos',\n    component: MovimientosComponent,\n    children: [ // rutas hijas, se vern dentro del componente padre\n      {\n        path: 'nuevo', // la ruta real es movimientos/nuevo\n        component: NuevoComponent\n      },\n      {\n        path: 'lista',\n        component: ListaComponent\n      }\n    ]\n  }\n];\nexport const routableComponents = [\n  NuevoComponent,\n  ListaComponent,\n  MovimientosComponent\n]\n```\nEste mini-mdulo es muy denso. Contrasta con la simplicidad del `movimientos.module.ts` que reduce su responsabilidad. Slo tiene que importar los mdulos adecuados.\n\n```javascript\nimport { FormsModule } from '@angular/forms';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n/** Mdulo de enrutado y componentes */\nimport { MovimientosRoutingModule, routableComponents } from './movimientos-routing.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    MovimientosRoutingModule\n  ], // dependencias de otros mdulos, especialmente el de enrutado\n  declarations: [\n    routableComponents\n  ], // Los componentes vienen del fichero movimientos-routing.module.ts\n  exports: [\n\n  ], // no necesita exportar nada\n})\n```\n\nVemos que la idea es que los ficheros de definicin de mdulos funcionales **deleguen toda la lgica** posible a su propio mdulo de enrutado.\n\nMientras tanto en la vista... Habamos dejado la *template* del componente raz con un `router-outlet`. Ser ah dnde se cargue el `MovimientosComponent` cuando se active la ruta *'/movimientos'*. Pero, y las rutas hijas?, qu se carga y dnde se carga cuando se activa la ruta *'/movimientos/nuevo'* o la ruta *'/movimientos/lista'* ?.\n\nEchemos un vistazo a `movimientos.component.html` para comprobar que dispone de su propio `router-outlet`. \n\n```html\n<nav>\n   <a routerLink=\"/movimientos/nuevo\" >Nuevo Movimiento</a>\n   <a routerLink=\"/movimientos/lista\" >Lista de Movimientos</a>\n</nav>\n<router-outlet></router-outlet>\n```\n\nSer en este elemento donde se inyecten los componentes asociados a las rutas hijas. Este *anidamiento* permite hacer aplicaciones modulares y acceder a vistas especficas con rutas especficas. \n\n\n### Rutas con parmetros \n\nHasta ahora us rutas fijas para navegar. Lo ms normal es que estas **plantillas contengan segmentos variables** llamados parmetros. Para incorporar parmetros a tu esquema de rutas tienes que actuar en tres fases:\n\n#### 1- Definir la parte paramtrica de la plantilla generadora de rutas\n\nEl *path* del objeto ruta se convierte en una plantilla que admite distintos valores. As queda ahora el mdulo enrutador de movimientos:\n\n```javascript\nconst routes: Routes = [\n  {\n    path: 'movimientos',\n    component: MovimientosComponent,\n    children: [ // rutas hijas, se vern dentro del componente padre\n      {\n        path: 'nuevo', // la ruta real es movimientos/nuevo\n        component: NuevoComponent\n      },\n      {\n        path: 'lista',\n        component: ListaComponent\n      }\n    ]\n  },\n  {\n    path: 'movimientos/:id', // parmetro variable id    \n    component: EditorComponent\n  }\n];\n```\n\nLos parmetros se prefijan con `:` y en cada ruta se pueden usar tantos como sea necesario. \n\n>Obsrvese que en este caso la ruta 'movimientos/:id' es hermana, no hija, de la primera. Por tanto se mostrar en el `router-outlet` del componente raz. Se ha hecho as para mostrar distintas maneras de trabajar en el 'router'.\n\n \n\n#### 2- Montar los enlaces asignando valores a los parmetros\n\nEsto se puede hacer en las plantillas HTML o en por cdigo. Siempre usando el **array de `routerLink`** sin necesidad de concatenar cadenas para para montar rutas. Este array en su segunda posicin llevar un objeto que represente los valores de los parmetros. \n\nEn un caso de navegacin por cdigo sencillo tendr esta pinta:\n```javascript\n  // para ir a la ruta /movimientos/42\n  this.router.navigate(['movimientos', 42])\n```\n\nUsando desde la vista en igual de sencillo con la directiva `routerLink`, como en este ejemplo HTML:\n\n```html\n<a [routerLink]=\"['/movimientos', 42 ]\">42</a>\n```\n\n#### 3- Recuperar los valores de los parmetros a partir de las rutas\nLa novedad ms llamativa es la presencia de `OnInit`. Es un *hook*, o evento de la vida de un componente. Este evento se ejecuta al iniciarse el componente pero cuando ya la ruta se ha resuelto completamente. \nEn ese momento puedes usar `ActivatedRoute`, un servicio que entre otras cosas te dar acceso a un *observable* que emite los valores actuales de los parmetros.\nPor ejemplo, esto sera el cdigo del componente `editor.component.ts` que se activa con rutas como *'/movimientos/42'*\n\n```javascript\nimport { Component, OnInit } from '@angular/core';\n/** Servicio para acceder a la ruta activa */\nimport { ActivatedRoute } from '@angular/router';\nimport { DatosService } from './../datos.service';\n@Component({\n  selector: 'app-editor',\n  templateUrl: './editor.component.html',\n  styleUrls: ['./editor.component.css']\n})\nexport class EditorComponent implements OnInit {\n  public movimiento;\n  constructor(\n      private route: ActivatedRoute, \n      private datosService: DatosService) { \n      // constructor vaco. slo se usa para reclamar dependencias         \n  }\n  ngOnInit() {\n    // subscripcin al observable params\n    this.route.params\n      .subscribe(params => {\n        const _id = params['id'].toString();\n        this.movimiento = this.datosService.getMovimientoBy_Id(_id);\n      });\n  }\n}\n```\n> Hay una estrategia opcional que emplea `Observables` para mantener potenciales cambios de estado en los valores de los parmetros. Si te interesa busca informacin sobre `Router` .\n\n### Carga diferida\n\nEsta es la funcionalidad ms esperada y que sigue siendo un *work in progress*. Cuando las aplicaciones AngularJS crecen en funcionalidad producen un **impacto negativo en la primera vista** de un usuario. Eso es debido a que *Angular* necesita disponer de todo tu cdigo para montar el armazn de dependencias. Esto es as aunque el usuario no vaya a navegar mas que por un conjunto reducido de rutas.\n\nEn aplicaciones de *intranet* o de uso muy intensivo esto no suele ser un gran problema. Esa espera inicial de unos pocos segundos se recupera durante el uso continuado de la aplicacin. Pero ciertos desarrollos realmente grandes o, sobre todo, **aplicaciones web pblicas para usuarios ocasionales** necesitaban un tratamiento especial.\n\nLa solucin es implementar un modelo de *lazy loading* o carga diferida. En este caso el navegador descarga el HTML y el cdigo de la aplicacin segn el usuario navegue. \n\nEn *Angular2* se incluye esta funcionalidad, pero a da de hoy an no est disponible con `angular-cli`. Se puede *tunear WebPack* a mano para conseguirlo, pero, si no hay urgencia en salir a produccin, no te lo recomiendo. Es preferible esperar un poco y usar el la solucin definitiva que implemente la herramienta.\n\nEn cuanto sea *usable* actualizar este artculo y difundir la buena nueva a los cuatro vientos. Como sabes an estamos esperando la primera *Release Candidate* de `angular-cli` y habr mejoras importantes. \n\nMantente a la ltima recibiendo el [boletn de noticias de Academia Binaria](http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&id=b67e4d2339) o siguindome en las [redes sociales](https://twitter.com/albertobasalo). \n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n\n---\n\n### ACTUALIZACIN\n\nPara una versin ms reciente del contenido visita la pgina [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/)","slug":"enrutado-con-angular2-el-nuevo-spa","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvi7001liwd3mxs167tt","content":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a></p></blockquote><hr><blockquote><p>Cdigo asociado en <a href=\"https://github.com/AcademiaBinaria/angular2/tree/master/6-routing\" target=\"_blank\" rel=\"external\">angular2/6-routing/</a></p></blockquote><p>La capacidad de gestionar las <strong>rutas en el cliente</strong> es una de las grandes ventajas de <em>AngularJS</em>. En la versin 1 nos ofrecan una solucin demasiado simple que obligaba a usar libreras de terceros como la famosa <a href=\"https://github.com/angular-ui/ui-router\" target=\"_blank\" rel=\"external\">ui-router</a>. Hemos esperado aos la promesa de un nuevo <em>enrutador</em> compatible con las versiones 1 y 2. El resultado es <strong>@angular/router</strong>.</p><p>De todo <em>Angular2</em>, este es el componente que ms ha cambiado durante la fase <em>Release Candidate</em>. Actualmente confiamos en que las pequeas dudas se resuelvan definitivamente y podamos relajarnos creando modernos desarrollos <strong>SPA</strong>.</p><a id=\"more\"></a><h2 id=\"Modulo-de-enrutado-en-base-a-componentes\"><a href=\"#Modulo-de-enrutado-en-base-a-componentes\" class=\"headerlink\" title=\"Mdulo de enrutado en base a componentes\"></a>Mdulo de enrutado en base a componentes</h2><p>Las aplicaciones Angular2 son <a href=\"http://academia-binaria.com/componentes-los-bloques-de-construccion-de-angular-2/\">rboles de mdulos</a>. Al menos el mdulo raz <code>AppModule</code> y cuantos mdulos funcionales nos hagan falta. Utilizando <code>angular-cli</code> podemos crear mdulos con la capacidad de enrutado generada en un mdulo especfico.</p><p>A ver si desbrozamos algo este bosque de mdulos.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ng <span class=\"keyword\">new</span> mi-aplicacion --routing <span class=\"literal\">true</span></div></pre></td></tr></table></figure><p>Tanto para la raz como para las ramas funcionales se crear un fichero. En la raz ser llamado <code>app-routing.module.ts</code> con un contenido como este:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/** Mdulos de enrutado de Angular2 */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; RouterModule, Routes &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Array con las rutas de este mdulo. Ninguna funcional.</span></div><div class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</div><div class=\"line\">  &#123; <span class=\"attr\">path</span>: <span class=\"string\">''</span>, <span class=\"attr\">redirectTo</span>: <span class=\"string\">''</span> &#125;,</div><div class=\"line\">  &#123; <span class=\"attr\">path</span>: <span class=\"string\">'inicio'</span>, <span class=\"attr\">redirectTo</span>: <span class=\"string\">''</span> &#125;,</div><div class=\"line\">  &#123; <span class=\"attr\">path</span>: <span class=\"string\">'**'</span>, <span class=\"attr\">redirectTo</span>: <span class=\"string\">''</span>, <span class=\"attr\">pathMatch</span>: <span class=\"string\">'full'</span> &#125;</div><div class=\"line\">];</div><div class=\"line\"></div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  imports: [</div><div class=\"line\">    RouterModule.forRoot(routes) <span class=\"comment\">// configuracin para el mdulo raz</span></div><div class=\"line\">  ],</div><div class=\"line\">  exports: [</div><div class=\"line\">    RouterModule <span class=\"comment\">// se importar desde el mdulo padre</span></div><div class=\"line\">  ]</div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppRoutingModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><p>Este <strong>mdulo</strong> de un nico fichero sirve <strong>para definir las rutas de otro mdulo padre</strong> asociado, <code>app.module.ts</code>, el cual quedar ms o menos as:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// importacin de mdulo de enrutado asociado</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; AppRoutingModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app-routing.module'</span>;</div><div class=\"line\"><span class=\"comment\">// importacin de otros mdulos de funcionalidad</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; HomeModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home/home.module'</span>;</div><div class=\"line\"><span class=\"comment\">// decorador que define un mdulo</span></div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  declarations: [ AppComponent ], </div><div class=\"line\">  imports: [</div><div class=\"line\">    BrowserModule,</div><div class=\"line\">    FormsModule,</div><div class=\"line\">    HttpModule,</div><div class=\"line\">    HomeModule, <span class=\"comment\">// el mdulo funcional para la 'pgina home'</span></div><div class=\"line\">    AppRoutingModule <span class=\"comment\">// el mdulo de rutas ya configurado</span></div><div class=\"line\">  ], </div><div class=\"line\">  providers: [] </div><div class=\"line\">  bootstrap: [ AppComponent ] </div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><h2 id=\"Modulos-funcionales\"><a href=\"#Modulos-funcionales\" class=\"headerlink\" title=\"Mdulos funcionales\"></a>Mdulos funcionales</h2><p>El mdulo raz es fundamental pero nada operativo. Toda el que sea de inters para los usuarios estar en mdulos funcionales. En las aplicaciones SPA es una buena prctica crear <strong>un mdulo por cada ruta</strong> principal. Incluida la pgina home. Por ejemplo usando el siguiente comando:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ng generate <span class=\"built_in\">module</span> home --routing <span class=\"literal\">true</span></div></pre></td></tr></table></figure><p>Aparece un fichero llamado <code>home-routing-module.ts</code>. Este mdulo se debe configurar para que gestione sus propias rutas.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</div><div class=\"line\"><span class=\"comment\">/** Componente enrutable */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; HomeComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home.component'</span>;</div><div class=\"line\"><span class=\"comment\">/** Rutas asociadas a componentes */</span></div><div class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</div><div class=\"line\">  &#123; <span class=\"attr\">path</span>: <span class=\"string\">''</span>, <span class=\"attr\">component</span>: HomeComponent &#125;,</div><div class=\"line\">];</div><div class=\"line\"><span class=\"comment\">/** array de componentes enrutables */</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> routableComponents = [</div><div class=\"line\">  HomeComponent</div><div class=\"line\">];</div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  imports: [</div><div class=\"line\">    RouterModule.forChild(routes) <span class=\"comment\">// Para mdulo funcional</span></div><div class=\"line\">  ],</div><div class=\"line\">  exports: [</div><div class=\"line\">    RouterModule <span class=\"comment\">// listo para importarlo en HomeModule</span></div><div class=\"line\">  ]</div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HomeRoutingModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><p>Se crean dos arrays relacionados. EL principal, <code>routes</code>, contendr las <strong>rutas pareadas con sus componentes</strong> respectivos.<br>Los cuales tambin se exportan directamente en la variable <code>routableComponents</code>. Esto se hace por comodidad. Para no tener que volver a importarlos en la declaracin del mdulo padre, que quedar as:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; CommonModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</div><div class=\"line\"><span class=\"comment\">/** Importacin de las rutas y sus componentes */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; HomeRoutingModule, routableComponents &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home-routing.module'</span>;</div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  imports: [</div><div class=\"line\">    CommonModule,</div><div class=\"line\">    HomeRoutingModule <span class=\"comment\">// el mdulo que sabe enrutar</span></div><div class=\"line\">  ],</div><div class=\"line\">  declarations: [</div><div class=\"line\">    routableComponents <span class=\"comment\">// los componentes de enrutado</span></div><div class=\"line\">  ]</div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HomeModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><h3 id=\"Carga-de-componentes-segun-la-ruta\"><a href=\"#Carga-de-componentes-segun-la-ruta\" class=\"headerlink\" title=\"Carga de componentes segn la ruta\"></a>Carga de componentes segn la ruta</h3><p>Todo este trabajo de configuracin se materializa en las <strong>vistas</strong>. Necesitaremos un lugar dnde inyectar el <strong>componente de turno asociado a la ruta</strong> actual. Presentamos el <code>router-outlet</code>. Y para que la aplicacin pueda llevarnos de un lugar a otro usaremos la directiva <code>routerLink</code>.</p><p>De forma que la plantilla raz <code>app.component.html</code> quedar normalmente as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--men de navegacin, sin href--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">nav</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/']\"</span>&gt;</span>Inicio<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/login']\"</span>&gt;</span>Log In<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/contacto']\"</span>&gt;</span>Contacto<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--Este componente nativo hace que el enrutador cargue una pgina dinmicamente--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></div></pre></td></tr></table></figure><h2 id=\"Rutas-hijas-y-con-parametros\"><a href=\"#Rutas-hijas-y-con-parametros\" class=\"headerlink\" title=\"Rutas hijas y con parmetros\"></a>Rutas hijas y con parmetros</h2><p>De poco vale un enrutador que slo atienda a los casos sencillos. Las aplicaciones profesionales plantean mayores retos.</p><h3 id=\"Rutas-hijas\"><a href=\"#Rutas-hijas\" class=\"headerlink\" title=\"Rutas hijas\"></a>Rutas hijas</h3><p>Un ejemplo son las <strong>rutas anidadas</strong>, aqu llamadas rutas hijas. Son aquellas en las que una parte de la visualizacin es comn y otra depende de la ruta concreta.</p><p>Veamos un ejemplo dnde se pretende dar de alta y mostrar una lista de elementos. La base de cualquier <em>CRUD</em>. As quedara el fichero <code>movimientos-routing.module.ts</code>.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/** Importacin de los componentes enrutables */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientosComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./movimientos.component'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; ListaComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./lista/lista.component'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; NuevoComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./nuevo/nuevo.component'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</div><div class=\"line\">  &#123;</div><div class=\"line\">    path: <span class=\"string\">'movimientos'</span>,</div><div class=\"line\">    component: MovimientosComponent,</div><div class=\"line\">    children: [ <span class=\"comment\">// rutas hijas, se vern dentro del componente padre</span></div><div class=\"line\">      &#123;</div><div class=\"line\">        path: <span class=\"string\">'nuevo'</span>, <span class=\"comment\">// la ruta real es movimientos/nuevo</span></div><div class=\"line\">        component: NuevoComponent</div><div class=\"line\">      &#125;,</div><div class=\"line\">      &#123;</div><div class=\"line\">        path: <span class=\"string\">'lista'</span>,</div><div class=\"line\">        component: ListaComponent</div><div class=\"line\">      &#125;</div><div class=\"line\">    ]</div><div class=\"line\">  &#125;</div><div class=\"line\">];</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> routableComponents = [</div><div class=\"line\">  NuevoComponent,</div><div class=\"line\">  ListaComponent,</div><div class=\"line\">  MovimientosComponent</div><div class=\"line\">]</div></pre></td></tr></table></figure><p>Este mini-mdulo es muy denso. Contrasta con la simplicidad del <code>movimientos.module.ts</code> que reduce su responsabilidad. Slo tiene que importar los mdulos adecuados.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; FormsModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; CommonModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</div><div class=\"line\"><span class=\"comment\">/** Mdulo de enrutado y componentes */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientosRoutingModule, routableComponents &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./movimientos-routing.module'</span>;</div><div class=\"line\"></div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  imports: [</div><div class=\"line\">    CommonModule,</div><div class=\"line\">    FormsModule,</div><div class=\"line\">    MovimientosRoutingModule</div><div class=\"line\">  ], <span class=\"comment\">// dependencias de otros mdulos, especialmente el de enrutado</span></div><div class=\"line\">  declarations: [</div><div class=\"line\">    routableComponents</div><div class=\"line\">  ], <span class=\"comment\">// Los componentes vienen del fichero movimientos-routing.module.ts</span></div><div class=\"line\">  exports: [</div><div class=\"line\"></div><div class=\"line\">  ], <span class=\"comment\">// no necesita exportar nada</span></div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure><p>Vemos que la idea es que los ficheros de definicin de mdulos funcionales <strong>deleguen toda la lgica</strong> posible a su propio mdulo de enrutado.</p><p>Mientras tanto en la vista Habamos dejado la <em>template</em> del componente raz con un <code>router-outlet</code>. Ser ah dnde se cargue el <code>MovimientosComponent</code> cuando se active la ruta <em>/movimientos</em>. Pero, y las rutas hijas?, qu se carga y dnde se carga cuando se activa la ruta <em>/movimientos/nuevo</em> o la ruta <em>/movimientos/lista</em> ?.</p><p>Echemos un vistazo a <code>movimientos.component.html</code> para comprobar que dispone de su propio <code>router-outlet</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">nav</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"/movimientos/nuevo\"</span> &gt;</span>Nuevo Movimiento<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"/movimientos/lista\"</span> &gt;</span>Lista de Movimientos<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></div></pre></td></tr></table></figure><p>Ser en este elemento donde se inyecten los componentes asociados a las rutas hijas. Este <em>anidamiento</em> permite hacer aplicaciones modulares y acceder a vistas especficas con rutas especficas.</p><h3 id=\"Rutas-con-parametros\"><a href=\"#Rutas-con-parametros\" class=\"headerlink\" title=\"Rutas con parmetros\"></a>Rutas con parmetros</h3><p>Hasta ahora us rutas fijas para navegar. Lo ms normal es que estas <strong>plantillas contengan segmentos variables</strong> llamados parmetros. Para incorporar parmetros a tu esquema de rutas tienes que actuar en tres fases:</p><h4 id=\"1-Definir-la-parte-parametrica-de-la-plantilla-generadora-de-rutas\"><a href=\"#1-Definir-la-parte-parametrica-de-la-plantilla-generadora-de-rutas\" class=\"headerlink\" title=\"1- Definir la parte paramtrica de la plantilla generadora de rutas\"></a>1- Definir la parte paramtrica de la plantilla generadora de rutas</h4><p>El <em>path</em> del objeto ruta se convierte en una plantilla que admite distintos valores. As queda ahora el mdulo enrutador de movimientos:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</div><div class=\"line\">  &#123;</div><div class=\"line\">    path: <span class=\"string\">'movimientos'</span>,</div><div class=\"line\">    component: MovimientosComponent,</div><div class=\"line\">    children: [ <span class=\"comment\">// rutas hijas, se vern dentro del componente padre</span></div><div class=\"line\">      &#123;</div><div class=\"line\">        path: <span class=\"string\">'nuevo'</span>, <span class=\"comment\">// la ruta real es movimientos/nuevo</span></div><div class=\"line\">        component: NuevoComponent</div><div class=\"line\">      &#125;,</div><div class=\"line\">      &#123;</div><div class=\"line\">        path: <span class=\"string\">'lista'</span>,</div><div class=\"line\">        component: ListaComponent</div><div class=\"line\">      &#125;</div><div class=\"line\">    ]</div><div class=\"line\">  &#125;,</div><div class=\"line\">  &#123;</div><div class=\"line\">    path: <span class=\"string\">'movimientos/:id'</span>, <span class=\"comment\">// parmetro variable id    </span></div><div class=\"line\">    component: EditorComponent</div><div class=\"line\">  &#125;</div><div class=\"line\">];</div></pre></td></tr></table></figure><p>Los parmetros se prefijan con <code>:</code> y en cada ruta se pueden usar tantos como sea necesario.</p><blockquote><p>Obsrvese que en este caso la ruta movimientos/:id es hermana, no hija, de la primera. Por tanto se mostrar en el <code>router-outlet</code> del componente raz. Se ha hecho as para mostrar distintas maneras de trabajar en el router.</p></blockquote><h4 id=\"2-Montar-los-enlaces-asignando-valores-a-los-parametros\"><a href=\"#2-Montar-los-enlaces-asignando-valores-a-los-parametros\" class=\"headerlink\" title=\"2- Montar los enlaces asignando valores a los parmetros\"></a>2- Montar los enlaces asignando valores a los parmetros</h4><p>Esto se puede hacer en las plantillas HTML o en por cdigo. Siempre usando el <strong>array de <code>routerLink</code></strong> sin necesidad de concatenar cadenas para para montar rutas. Este array en su segunda posicin llevar un objeto que represente los valores de los parmetros.</p><p>En un caso de navegacin por cdigo sencillo tendr esta pinta:<br></p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// para ir a la ruta /movimientos/42</span></div><div class=\"line\"><span class=\"keyword\">this</span>.router.navigate([<span class=\"string\">'movimientos'</span>, <span class=\"number\">42</span>])</div></pre></td></tr></table></figure><p></p><p>Usando desde la vista en igual de sencillo con la directiva <code>routerLink</code>, como en este ejemplo HTML:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/movimientos', 42 ]\"</span>&gt;</span>42<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div></pre></td></tr></table></figure><h4 id=\"3-Recuperar-los-valores-de-los-parametros-a-partir-de-las-rutas\"><a href=\"#3-Recuperar-los-valores-de-los-parametros-a-partir-de-las-rutas\" class=\"headerlink\" title=\"3- Recuperar los valores de los parmetros a partir de las rutas\"></a>3- Recuperar los valores de los parmetros a partir de las rutas</h4><p>La novedad ms llamativa es la presencia de <code>OnInit</code>. Es un <em>hook</em>, o evento de la vida de un componente. Este evento se ejecuta al iniciarse el componente pero cuando ya la ruta se ha resuelto completamente.<br>En ese momento puedes usar <code>ActivatedRoute</code>, un servicio que entre otras cosas te dar acceso a un <em>observable</em> que emite los valores actuales de los parmetros.<br>Por ejemplo, esto sera el cdigo del componente <code>editor.component.ts</code> que se activa con rutas como <em>/movimientos/42</em></p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"comment\">/** Servicio para acceder a la ruta activa */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; ActivatedRoute &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; DatosService &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./../datos.service'</span>;</div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  selector: <span class=\"string\">'app-editor'</span>,</div><div class=\"line\">  templateUrl: <span class=\"string\">'./editor.component.html'</span>,</div><div class=\"line\">  styleUrls: [<span class=\"string\">'./editor.component.css'</span>]</div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">EditorComponent</span> <span class=\"title\">implements</span> <span class=\"title\">OnInit</span> </span>&#123;</div><div class=\"line\">  public movimiento;</div><div class=\"line\">  <span class=\"keyword\">constructor</span>(</div><div class=\"line\">      private route: ActivatedRoute, </div><div class=\"line\">      private datosService: DatosService) &#123; </div><div class=\"line\">      <span class=\"comment\">// constructor vaco. slo se usa para reclamar dependencias         </span></div><div class=\"line\">  &#125;</div><div class=\"line\">  ngOnInit() &#123;</div><div class=\"line\">    <span class=\"comment\">// subscripcin al observable params</span></div><div class=\"line\">    <span class=\"keyword\">this</span>.route.params</div><div class=\"line\">      .subscribe(<span class=\"function\"><span class=\"params\">params</span> =&gt;</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">const</span> _id = params[<span class=\"string\">'id'</span>].toString();</div><div class=\"line\">        <span class=\"keyword\">this</span>.movimiento = <span class=\"keyword\">this</span>.datosService.getMovimientoBy_Id(_id);</div><div class=\"line\">      &#125;);</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><blockquote><p>Hay una estrategia opcional que emplea <code>Observables</code> para mantener potenciales cambios de estado en los valores de los parmetros. Si te interesa busca informacin sobre <code>Router</code> .</p></blockquote><h3 id=\"Carga-diferida\"><a href=\"#Carga-diferida\" class=\"headerlink\" title=\"Carga diferida\"></a>Carga diferida</h3><p>Esta es la funcionalidad ms esperada y que sigue siendo un <em>work in progress</em>. Cuando las aplicaciones AngularJS crecen en funcionalidad producen un <strong>impacto negativo en la primera vista</strong> de un usuario. Eso es debido a que <em>Angular</em> necesita disponer de todo tu cdigo para montar el armazn de dependencias. Esto es as aunque el usuario no vaya a navegar mas que por un conjunto reducido de rutas.</p><p>En aplicaciones de <em>intranet</em> o de uso muy intensivo esto no suele ser un gran problema. Esa espera inicial de unos pocos segundos se recupera durante el uso continuado de la aplicacin. Pero ciertos desarrollos realmente grandes o, sobre todo, <strong>aplicaciones web pblicas para usuarios ocasionales</strong> necesitaban un tratamiento especial.</p><p>La solucin es implementar un modelo de <em>lazy loading</em> o carga diferida. En este caso el navegador descarga el HTML y el cdigo de la aplicacin segn el usuario navegue.</p><p>En <em>Angular2</em> se incluye esta funcionalidad, pero a da de hoy an no est disponible con <code>angular-cli</code>. Se puede <em>tunear WebPack</em> a mano para conseguirlo, pero, si no hay urgencia en salir a produccin, no te lo recomiendo. Es preferible esperar un poco y usar el la solucin definitiva que implemente la herramienta.</p><p>En cuanto sea <em>usable</em> actualizar este artculo y difundir la buena nueva a los cuatro vientos. Como sabes an estamos esperando la primera <em>Release Candidate</em> de <code>angular-cli</code> y habr mejoras importantes.</p><p>Mantente a la ltima recibiendo el <a href=\"http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339\" target=\"_blank\" rel=\"external\">boletn de noticias de Academia Binaria</a> o siguindome en las <a href=\"https://twitter.com/albertobasalo\" target=\"_blank\" rel=\"external\">redes sociales</a>.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a></p>","site":{"data":{}},"excerpt":"<blockquote><p>ACTUALIZACIN: para una versin ms reciente del contenido visita la pgina <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a></p></blockquote><hr><blockquote><p>Cdigo asociado en <a href=\"https://github.com/AcademiaBinaria/angular2/tree/master/6-routing\" target=\"_blank\" rel=\"external\">angular2/6-routing/</a></p></blockquote><p>La capacidad de gestionar las <strong>rutas en el cliente</strong> es una de las grandes ventajas de <em>AngularJS</em>. En la versin 1 nos ofrecan una solucin demasiado simple que obligaba a usar libreras de terceros como la famosa <a href=\"https://github.com/angular-ui/ui-router\" target=\"_blank\" rel=\"external\">ui-router</a>. Hemos esperado aos la promesa de un nuevo <em>enrutador</em> compatible con las versiones 1 y 2. El resultado es <strong>@angular/router</strong>.</p><p>De todo <em>Angular2</em>, este es el componente que ms ha cambiado durante la fase <em>Release Candidate</em>. Actualmente confiamos en que las pequeas dudas se resuelvan definitivamente y podamos relajarnos creando modernos desarrollos <strong>SPA</strong>.</p>","more":"<h2 id=\"Modulo-de-enrutado-en-base-a-componentes\"><a href=\"#Modulo-de-enrutado-en-base-a-componentes\" class=\"headerlink\" title=\"Mdulo de enrutado en base a componentes\"></a>Mdulo de enrutado en base a componentes</h2><p>Las aplicaciones Angular2 son <a href=\"http://academia-binaria.com/componentes-los-bloques-de-construccion-de-angular-2/\">rboles de mdulos</a>. Al menos el mdulo raz <code>AppModule</code> y cuantos mdulos funcionales nos hagan falta. Utilizando <code>angular-cli</code> podemos crear mdulos con la capacidad de enrutado generada en un mdulo especfico.</p><p>A ver si desbrozamos algo este bosque de mdulos.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ng <span class=\"keyword\">new</span> mi-aplicacion --routing <span class=\"literal\">true</span></div></pre></td></tr></table></figure><p>Tanto para la raz como para las ramas funcionales se crear un fichero. En la raz ser llamado <code>app-routing.module.ts</code> con un contenido como este:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/** Mdulos de enrutado de Angular2 */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; RouterModule, Routes &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Array con las rutas de este mdulo. Ninguna funcional.</span></div><div class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</div><div class=\"line\">  &#123; <span class=\"attr\">path</span>: <span class=\"string\">''</span>, <span class=\"attr\">redirectTo</span>: <span class=\"string\">''</span> &#125;,</div><div class=\"line\">  &#123; <span class=\"attr\">path</span>: <span class=\"string\">'inicio'</span>, <span class=\"attr\">redirectTo</span>: <span class=\"string\">''</span> &#125;,</div><div class=\"line\">  &#123; <span class=\"attr\">path</span>: <span class=\"string\">'**'</span>, <span class=\"attr\">redirectTo</span>: <span class=\"string\">''</span>, <span class=\"attr\">pathMatch</span>: <span class=\"string\">'full'</span> &#125;</div><div class=\"line\">];</div><div class=\"line\"></div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  imports: [</div><div class=\"line\">    RouterModule.forRoot(routes) <span class=\"comment\">// configuracin para el mdulo raz</span></div><div class=\"line\">  ],</div><div class=\"line\">  exports: [</div><div class=\"line\">    RouterModule <span class=\"comment\">// se importar desde el mdulo padre</span></div><div class=\"line\">  ]</div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppRoutingModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><p>Este <strong>mdulo</strong> de un nico fichero sirve <strong>para definir las rutas de otro mdulo padre</strong> asociado, <code>app.module.ts</code>, el cual quedar ms o menos as:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// importacin de mdulo de enrutado asociado</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; AppRoutingModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app-routing.module'</span>;</div><div class=\"line\"><span class=\"comment\">// importacin de otros mdulos de funcionalidad</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; HomeModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home/home.module'</span>;</div><div class=\"line\"><span class=\"comment\">// decorador que define un mdulo</span></div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  declarations: [ AppComponent ], </div><div class=\"line\">  imports: [</div><div class=\"line\">    BrowserModule,</div><div class=\"line\">    FormsModule,</div><div class=\"line\">    HttpModule,</div><div class=\"line\">    HomeModule, <span class=\"comment\">// el mdulo funcional para la 'pgina home'</span></div><div class=\"line\">    AppRoutingModule <span class=\"comment\">// el mdulo de rutas ya configurado</span></div><div class=\"line\">  ], </div><div class=\"line\">  providers: [] </div><div class=\"line\">  bootstrap: [ AppComponent ] </div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><h2 id=\"Modulos-funcionales\"><a href=\"#Modulos-funcionales\" class=\"headerlink\" title=\"Mdulos funcionales\"></a>Mdulos funcionales</h2><p>El mdulo raz es fundamental pero nada operativo. Toda el que sea de inters para los usuarios estar en mdulos funcionales. En las aplicaciones SPA es una buena prctica crear <strong>un mdulo por cada ruta</strong> principal. Incluida la pgina home. Por ejemplo usando el siguiente comando:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ng generate <span class=\"built_in\">module</span> home --routing <span class=\"literal\">true</span></div></pre></td></tr></table></figure><p>Aparece un fichero llamado <code>home-routing-module.ts</code>. Este mdulo se debe configurar para que gestione sus propias rutas.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</div><div class=\"line\"><span class=\"comment\">/** Componente enrutable */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; HomeComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home.component'</span>;</div><div class=\"line\"><span class=\"comment\">/** Rutas asociadas a componentes */</span></div><div class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</div><div class=\"line\">  &#123; <span class=\"attr\">path</span>: <span class=\"string\">''</span>, <span class=\"attr\">component</span>: HomeComponent &#125;,</div><div class=\"line\">];</div><div class=\"line\"><span class=\"comment\">/** array de componentes enrutables */</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> routableComponents = [</div><div class=\"line\">  HomeComponent</div><div class=\"line\">];</div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  imports: [</div><div class=\"line\">    RouterModule.forChild(routes) <span class=\"comment\">// Para mdulo funcional</span></div><div class=\"line\">  ],</div><div class=\"line\">  exports: [</div><div class=\"line\">    RouterModule <span class=\"comment\">// listo para importarlo en HomeModule</span></div><div class=\"line\">  ]</div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HomeRoutingModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><p>Se crean dos arrays relacionados. EL principal, <code>routes</code>, contendr las <strong>rutas pareadas con sus componentes</strong> respectivos.<br>Los cuales tambin se exportan directamente en la variable <code>routableComponents</code>. Esto se hace por comodidad. Para no tener que volver a importarlos en la declaracin del mdulo padre, que quedar as:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; CommonModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</div><div class=\"line\"><span class=\"comment\">/** Importacin de las rutas y sus componentes */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; HomeRoutingModule, routableComponents &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home-routing.module'</span>;</div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  imports: [</div><div class=\"line\">    CommonModule,</div><div class=\"line\">    HomeRoutingModule <span class=\"comment\">// el mdulo que sabe enrutar</span></div><div class=\"line\">  ],</div><div class=\"line\">  declarations: [</div><div class=\"line\">    routableComponents <span class=\"comment\">// los componentes de enrutado</span></div><div class=\"line\">  ]</div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HomeModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure><h3 id=\"Carga-de-componentes-segun-la-ruta\"><a href=\"#Carga-de-componentes-segun-la-ruta\" class=\"headerlink\" title=\"Carga de componentes segn la ruta\"></a>Carga de componentes segn la ruta</h3><p>Todo este trabajo de configuracin se materializa en las <strong>vistas</strong>. Necesitaremos un lugar dnde inyectar el <strong>componente de turno asociado a la ruta</strong> actual. Presentamos el <code>router-outlet</code>. Y para que la aplicacin pueda llevarnos de un lugar a otro usaremos la directiva <code>routerLink</code>.</p><p>De forma que la plantilla raz <code>app.component.html</code> quedar normalmente as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--men de navegacin, sin href--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">nav</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/']\"</span>&gt;</span>Inicio<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/login']\"</span>&gt;</span>Log In<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/contacto']\"</span>&gt;</span>Contacto<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--Este componente nativo hace que el enrutador cargue una pgina dinmicamente--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></div></pre></td></tr></table></figure><h2 id=\"Rutas-hijas-y-con-parametros\"><a href=\"#Rutas-hijas-y-con-parametros\" class=\"headerlink\" title=\"Rutas hijas y con parmetros\"></a>Rutas hijas y con parmetros</h2><p>De poco vale un enrutador que slo atienda a los casos sencillos. Las aplicaciones profesionales plantean mayores retos.</p><h3 id=\"Rutas-hijas\"><a href=\"#Rutas-hijas\" class=\"headerlink\" title=\"Rutas hijas\"></a>Rutas hijas</h3><p>Un ejemplo son las <strong>rutas anidadas</strong>, aqu llamadas rutas hijas. Son aquellas en las que una parte de la visualizacin es comn y otra depende de la ruta concreta.</p><p>Veamos un ejemplo dnde se pretende dar de alta y mostrar una lista de elementos. La base de cualquier <em>CRUD</em>. As quedara el fichero <code>movimientos-routing.module.ts</code>.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/** Importacin de los componentes enrutables */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientosComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./movimientos.component'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; ListaComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./lista/lista.component'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; NuevoComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./nuevo/nuevo.component'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</div><div class=\"line\">  &#123;</div><div class=\"line\">    path: <span class=\"string\">'movimientos'</span>,</div><div class=\"line\">    component: MovimientosComponent,</div><div class=\"line\">    children: [ <span class=\"comment\">// rutas hijas, se vern dentro del componente padre</span></div><div class=\"line\">      &#123;</div><div class=\"line\">        path: <span class=\"string\">'nuevo'</span>, <span class=\"comment\">// la ruta real es movimientos/nuevo</span></div><div class=\"line\">        component: NuevoComponent</div><div class=\"line\">      &#125;,</div><div class=\"line\">      &#123;</div><div class=\"line\">        path: <span class=\"string\">'lista'</span>,</div><div class=\"line\">        component: ListaComponent</div><div class=\"line\">      &#125;</div><div class=\"line\">    ]</div><div class=\"line\">  &#125;</div><div class=\"line\">];</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> routableComponents = [</div><div class=\"line\">  NuevoComponent,</div><div class=\"line\">  ListaComponent,</div><div class=\"line\">  MovimientosComponent</div><div class=\"line\">]</div></pre></td></tr></table></figure><p>Este mini-mdulo es muy denso. Contrasta con la simplicidad del <code>movimientos.module.ts</code> que reduce su responsabilidad. Slo tiene que importar los mdulos adecuados.</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; FormsModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; CommonModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</div><div class=\"line\"><span class=\"comment\">/** Mdulo de enrutado y componentes */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; MovimientosRoutingModule, routableComponents &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./movimientos-routing.module'</span>;</div><div class=\"line\"></div><div class=\"line\">@NgModule(&#123;</div><div class=\"line\">  imports: [</div><div class=\"line\">    CommonModule,</div><div class=\"line\">    FormsModule,</div><div class=\"line\">    MovimientosRoutingModule</div><div class=\"line\">  ], <span class=\"comment\">// dependencias de otros mdulos, especialmente el de enrutado</span></div><div class=\"line\">  declarations: [</div><div class=\"line\">    routableComponents</div><div class=\"line\">  ], <span class=\"comment\">// Los componentes vienen del fichero movimientos-routing.module.ts</span></div><div class=\"line\">  exports: [</div><div class=\"line\"></div><div class=\"line\">  ], <span class=\"comment\">// no necesita exportar nada</span></div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure><p>Vemos que la idea es que los ficheros de definicin de mdulos funcionales <strong>deleguen toda la lgica</strong> posible a su propio mdulo de enrutado.</p><p>Mientras tanto en la vista Habamos dejado la <em>template</em> del componente raz con un <code>router-outlet</code>. Ser ah dnde se cargue el <code>MovimientosComponent</code> cuando se active la ruta <em>/movimientos</em>. Pero, y las rutas hijas?, qu se carga y dnde se carga cuando se activa la ruta <em>/movimientos/nuevo</em> o la ruta <em>/movimientos/lista</em> ?.</p><p>Echemos un vistazo a <code>movimientos.component.html</code> para comprobar que dispone de su propio <code>router-outlet</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">nav</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"/movimientos/nuevo\"</span> &gt;</span>Nuevo Movimiento<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"/movimientos/lista\"</span> &gt;</span>Lista de Movimientos<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">nav</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></div></pre></td></tr></table></figure><p>Ser en este elemento donde se inyecten los componentes asociados a las rutas hijas. Este <em>anidamiento</em> permite hacer aplicaciones modulares y acceder a vistas especficas con rutas especficas.</p><h3 id=\"Rutas-con-parametros\"><a href=\"#Rutas-con-parametros\" class=\"headerlink\" title=\"Rutas con parmetros\"></a>Rutas con parmetros</h3><p>Hasta ahora us rutas fijas para navegar. Lo ms normal es que estas <strong>plantillas contengan segmentos variables</strong> llamados parmetros. Para incorporar parmetros a tu esquema de rutas tienes que actuar en tres fases:</p><h4 id=\"1-Definir-la-parte-parametrica-de-la-plantilla-generadora-de-rutas\"><a href=\"#1-Definir-la-parte-parametrica-de-la-plantilla-generadora-de-rutas\" class=\"headerlink\" title=\"1- Definir la parte paramtrica de la plantilla generadora de rutas\"></a>1- Definir la parte paramtrica de la plantilla generadora de rutas</h4><p>El <em>path</em> del objeto ruta se convierte en una plantilla que admite distintos valores. As queda ahora el mdulo enrutador de movimientos:</p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</div><div class=\"line\">  &#123;</div><div class=\"line\">    path: <span class=\"string\">'movimientos'</span>,</div><div class=\"line\">    component: MovimientosComponent,</div><div class=\"line\">    children: [ <span class=\"comment\">// rutas hijas, se vern dentro del componente padre</span></div><div class=\"line\">      &#123;</div><div class=\"line\">        path: <span class=\"string\">'nuevo'</span>, <span class=\"comment\">// la ruta real es movimientos/nuevo</span></div><div class=\"line\">        component: NuevoComponent</div><div class=\"line\">      &#125;,</div><div class=\"line\">      &#123;</div><div class=\"line\">        path: <span class=\"string\">'lista'</span>,</div><div class=\"line\">        component: ListaComponent</div><div class=\"line\">      &#125;</div><div class=\"line\">    ]</div><div class=\"line\">  &#125;,</div><div class=\"line\">  &#123;</div><div class=\"line\">    path: <span class=\"string\">'movimientos/:id'</span>, <span class=\"comment\">// parmetro variable id    </span></div><div class=\"line\">    component: EditorComponent</div><div class=\"line\">  &#125;</div><div class=\"line\">];</div></pre></td></tr></table></figure><p>Los parmetros se prefijan con <code>:</code> y en cada ruta se pueden usar tantos como sea necesario.</p><blockquote><p>Obsrvese que en este caso la ruta movimientos/:id es hermana, no hija, de la primera. Por tanto se mostrar en el <code>router-outlet</code> del componente raz. Se ha hecho as para mostrar distintas maneras de trabajar en el router.</p></blockquote><h4 id=\"2-Montar-los-enlaces-asignando-valores-a-los-parametros\"><a href=\"#2-Montar-los-enlaces-asignando-valores-a-los-parametros\" class=\"headerlink\" title=\"2- Montar los enlaces asignando valores a los parmetros\"></a>2- Montar los enlaces asignando valores a los parmetros</h4><p>Esto se puede hacer en las plantillas HTML o en por cdigo. Siempre usando el <strong>array de <code>routerLink</code></strong> sin necesidad de concatenar cadenas para para montar rutas. Este array en su segunda posicin llevar un objeto que represente los valores de los parmetros.</p><p>En un caso de navegacin por cdigo sencillo tendr esta pinta:<br></p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// para ir a la ruta /movimientos/42</span></div><div class=\"line\"><span class=\"keyword\">this</span>.router.navigate([<span class=\"string\">'movimientos'</span>, <span class=\"number\">42</span>])</div></pre></td></tr></table></figure><p></p><p>Usando desde la vista en igual de sencillo con la directiva <code>routerLink</code>, como en este ejemplo HTML:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/movimientos', 42 ]\"</span>&gt;</span>42<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div></pre></td></tr></table></figure><h4 id=\"3-Recuperar-los-valores-de-los-parametros-a-partir-de-las-rutas\"><a href=\"#3-Recuperar-los-valores-de-los-parametros-a-partir-de-las-rutas\" class=\"headerlink\" title=\"3- Recuperar los valores de los parmetros a partir de las rutas\"></a>3- Recuperar los valores de los parmetros a partir de las rutas</h4><p>La novedad ms llamativa es la presencia de <code>OnInit</code>. Es un <em>hook</em>, o evento de la vida de un componente. Este evento se ejecuta al iniciarse el componente pero cuando ya la ruta se ha resuelto completamente.<br>En ese momento puedes usar <code>ActivatedRoute</code>, un servicio que entre otras cosas te dar acceso a un <em>observable</em> que emite los valores actuales de los parmetros.<br>Por ejemplo, esto sera el cdigo del componente <code>editor.component.ts</code> que se activa con rutas como <em>/movimientos/42</em></p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</div><div class=\"line\"><span class=\"comment\">/** Servicio para acceder a la ruta activa */</span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; ActivatedRoute &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</div><div class=\"line\"><span class=\"keyword\">import</span> &#123; DatosService &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./../datos.service'</span>;</div><div class=\"line\">@Component(&#123;</div><div class=\"line\">  selector: <span class=\"string\">'app-editor'</span>,</div><div class=\"line\">  templateUrl: <span class=\"string\">'./editor.component.html'</span>,</div><div class=\"line\">  styleUrls: [<span class=\"string\">'./editor.component.css'</span>]</div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">EditorComponent</span> <span class=\"title\">implements</span> <span class=\"title\">OnInit</span> </span>&#123;</div><div class=\"line\">  public movimiento;</div><div class=\"line\">  <span class=\"keyword\">constructor</span>(</div><div class=\"line\">      private route: ActivatedRoute, </div><div class=\"line\">      private datosService: DatosService) &#123; </div><div class=\"line\">      <span class=\"comment\">// constructor vaco. slo se usa para reclamar dependencias         </span></div><div class=\"line\">  &#125;</div><div class=\"line\">  ngOnInit() &#123;</div><div class=\"line\">    <span class=\"comment\">// subscripcin al observable params</span></div><div class=\"line\">    <span class=\"keyword\">this</span>.route.params</div><div class=\"line\">      .subscribe(<span class=\"function\"><span class=\"params\">params</span> =&gt;</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">const</span> _id = params[<span class=\"string\">'id'</span>].toString();</div><div class=\"line\">        <span class=\"keyword\">this</span>.movimiento = <span class=\"keyword\">this</span>.datosService.getMovimientoBy_Id(_id);</div><div class=\"line\">      &#125;);</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><blockquote><p>Hay una estrategia opcional que emplea <code>Observables</code> para mantener potenciales cambios de estado en los valores de los parmetros. Si te interesa busca informacin sobre <code>Router</code> .</p></blockquote><h3 id=\"Carga-diferida\"><a href=\"#Carga-diferida\" class=\"headerlink\" title=\"Carga diferida\"></a>Carga diferida</h3><p>Esta es la funcionalidad ms esperada y que sigue siendo un <em>work in progress</em>. Cuando las aplicaciones AngularJS crecen en funcionalidad producen un <strong>impacto negativo en la primera vista</strong> de un usuario. Eso es debido a que <em>Angular</em> necesita disponer de todo tu cdigo para montar el armazn de dependencias. Esto es as aunque el usuario no vaya a navegar mas que por un conjunto reducido de rutas.</p><p>En aplicaciones de <em>intranet</em> o de uso muy intensivo esto no suele ser un gran problema. Esa espera inicial de unos pocos segundos se recupera durante el uso continuado de la aplicacin. Pero ciertos desarrollos realmente grandes o, sobre todo, <strong>aplicaciones web pblicas para usuarios ocasionales</strong> necesitaban un tratamiento especial.</p><p>La solucin es implementar un modelo de <em>lazy loading</em> o carga diferida. En este caso el navegador descarga el HTML y el cdigo de la aplicacin segn el usuario navegue.</p><p>En <em>Angular2</em> se incluye esta funcionalidad, pero a da de hoy an no est disponible con <code>angular-cli</code>. Se puede <em>tunear WebPack</em> a mano para conseguirlo, pero, si no hay urgencia en salir a produccin, no te lo recomiendo. Es preferible esperar un poco y usar el la solucin definitiva que implemente la herramienta.</p><p>En cuanto sea <em>usable</em> actualizar este artculo y difundir la buena nueva a los cuatro vientos. Como sabes an estamos esperando la primera <em>Release Candidate</em> de <code>angular-cli</code> y habr mejoras importantes.</p><p>Mantente a la ltima recibiendo el <a href=\"http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339\" target=\"_blank\" rel=\"external\">boletn de noticias de Academia Binaria</a> o siguindome en las <a href=\"https://twitter.com/albertobasalo\" target=\"_blank\" rel=\"external\">redes sociales</a>.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote><hr><h3 id=\"ACTUALIZACION\"><a href=\"#ACTUALIZACION\" class=\"headerlink\" title=\"ACTUALIZACIN\"></a>ACTUALIZACIN</h3><p>Para una versin ms reciente del contenido visita la pgina <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a></p>"},{"title":"Formularios, tablas y modelos de datos en Angular","date":"2019-01-31T18:17:37.000Z","thumbnail":"/css/images/angular-3_data.png","_content":"\n![formularios-tablas-y-modelos-de-datos-en-angular](/images/tutorial-angular-3_data.png)\n\nLas **aplicaciones Angular 7 son excelentes para el tratamiento de datos** en el navegador. Su razn de ser fue la recogida de informacin mediante formularios y la presentacin de pginas dinmicas de forma sencilla.\n\nVamos a ver cmo la librera `@angular/forms` enlaza **las vistas, los controladores y los modelos**; y cmo se hace la presentacin de datos en **listas y tablas**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/), al finalizar tendrs una aplicacin que recoge y presenta datos.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/3-data]https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/3-data/contacts)\n\n# 1. Binding\n\n## 1.0 Base\n\n**Los formularios son el punto de entrada** de informacin a nuestros sistemas. Llevan con nosotros desde el inicio de la propia informtica y se han comido una buena parte del tiempo de programacin. En _Angular_ han prestado una especial atencin a ellos facilitando su desarrollo, **desde pantallas simples hasta complejos procesos**.\n\nPara empezar crearemos un proceso sencillo. algo que permita mantener una lista de contactos empresariales. Con lo aprendido en el tema de [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/) creamos un par de ficheros.\n\n```bash\nng g m contacts --routing true\nng g c contacts/contacts\n```\n\nY asignamos sus rutas delegadas en `app-routing` y en `contacts-routing`:\n\n```typescript\n  // app-routing\n  {\n    path: 'contacts',\n    loadChildren: './contacts/contacts.module#ContactsModule'\n  },\n  // contacts-routing\n  {\n    path: '',\n    component: ContactsComponent\n  }\n```\n\nY finalizamos con un enlace en el `HeaderComponent`\n\n```html\n<a routerLink=\"contacts\" class=\"button\">\n  <span> Contacts</span>\n</a>\n```\n\nLa clave para entender cmo funciona _Angular_ est en el concepto de **enlace entre elementos html de las vistas y propiedades de modelos** de datos, el llamado `binding`.\n\nPara realizar el _binding_ usaremos **directivas** en ambos sentidos.\n\n## 1.1 Enlace del modelo hacia la vista\n\nVamos a crear un pequeo modelo de datos. Para empezar agregamos algunas propiedades. En `contacts.component.ts`:\n\n```typescript\npublic header = 'Contacts';\npublic description = 'Manage your contact list';\npublic numContacts = 0;\npublic counterClass = 'tag secondary';\npublic formHidden = false;\n```\n\nEn `contacts.component.html` mostramos cabeceras con estilo\n\n```html\n<h2>{{ header }}</h2>\n<p>{{ description | uppercase }}</p>\n<p>\n  You have\n  <mark [class]=\"counterClass\">{{ numContacts }}</mark>\n  contacts right now.\n</p>\n```\n\n### La interpolacin entre \\{ \\{ \\} \\}\n\nEn el fichero `contacts.component.ts` tienes en su vista _html_ encontrars elementos ajenos al lenguaje. Son las directivas. La primera que encuentras es `{{ header }}`. Esas dobles llaves encierran expresiones que se evaluarn en tiempo de ejecucin. La llamamos **directiva de interpolacin** y es la manera ms cmoda y usual de mostrar contenido dinmico en Angular.\n\n> La expresin interna hace referencia a variables que se obtienen de las propiedades de la clase controladora del componente. En este caso `ContactsComponent` y `header`, con su valor _Contacts_ en ejecucin. Este enlace mantiene la vista permanentemente actualizada a travs de un potente sistema de deteccin del cambio.\n\n### Las tuberas |\n\nSi queremos que la presentacin del dato sea distinta a su valor real, podemos usar **funciones de transformacin** especiales. Se llaman tuberas o _pipes_ y se indican mediante el carcter `|`.\n\nEl _framework_ nos provee de casos bsicos como `uppercase, lowercase, date, number...`. Tambin dispones de un mecanismo para crear tus propios _pipes_.\n\n### Los atributos evaluados []\n\nEn _Html_ disponemos de atributos para asignar valores a propiedades de los elementos. Esos atributos reciben los valores como constantes. Pero, si se encierran entre corchetes se convierten en un **evaluador de expresiones** y puede recibir una variable o cualquier otra expresin.\n\nComo por ejemplo usando una _clase css_ cuyo valor cambia en tiempo de ejecucin. O para deshabilitar un elemento dinmicamente.\n\n## 1.2 Enlace de la vista hacia el modelo\n\nEn `contacts.component.html` tambin actuamos sobre la vista, para manipular el modelo... y de vuelta a la vista. Por ejemplo con mecanismo simple de ocultacin de un elemento.\n\n```html\n<input value=\"Show Form\" type=\"button\" (click)=\"formHidden = false\" />\n<input value=\"Hide Form\" type=\"button\" (click)=\"formHidden = true\" />\n<form [ngClass]=\"{ 'hidden' : formHidden }\">\n  <fieldset><legend>Contact Form</legend></fieldset>\n</form>\n```\n\n### Las clases CSS como atributos especiales\n\nPara el caso concreto de determinar las clases CSS aplicables a un elemento de manera dinmica, usaremos la directiva `ngClass`. La cual recibe un objeto cuyas propiedades son nombres de clases CSS y sus valores son expresiones booleanas. Si se cumplen se aplica la clase y si no, se quita la clase.\n\n```html\n[ngClass]=\"{ 'hidden' : formHidden }\"\n```\n\nEn este caso se oculta el elemento dependiendo del valor de la expresin `formHidden`. Pero Cmo se manipula esa variable?\n\n### Los eventos ()\n\nCualquier evento asociado a un elemento puede ejecutar una instruccin sin ms que incluirlo entre parntesis. Idealmente dicha instruccin debe llamar a un mtodo o funcin de la clase controladora. Aunque si es trivial puedes dejarla en el Html.\n\n```html\n(click)=\"formHidden = true\"\n```\n\n# 2. Doble Binding\n\nLa comunicacin del modelo hacia la vista es slo el principio. En _Angular_ tambin podrs **comunicar la vista hacia el modelo**, permitindole al usuario modificar los datos a travs de formularios. Es lo que se conoce como _double binding_.\n\n## 2.1 El doble enlace al modelo [(ngModel)]\n\nLa directiva `[(ngModel)]` se compone de un atributo _custom_ `ngModel` y lo rodea de los smbolos `[()]`. Esta tcnica es conocida como _banana in a box_ porque su sintaxis requiere un `()` dentro de un `[]` y une las capacidades de las expresiones y los eventos facilitando la comunicacin bidireccional.\n\n```html\n[(ngModel)]=\"model.property\"\n```\n\nUsa la comunicacin en ambos sentidos\n\n- **(banana)** : de la vista al modelo\n- **[box]** : del modelo a la vista\n\n> Atencin: La directiva `ngModel` viene dentro del mdulo `FormsModule` que hay que importar explcitamente.\n\nPor ejemplo `[(ngModel)]=\"contact.name\"` enlaza doblemente la propiedad del modelo `contact.name` con el elemento `<input>` de la vista. Cada tecleo del usuario se registra en la variable. Y el valor de la variable se muestra en el `<input>`.\n\nDada un modelo como este en `contacts.component.ts`:\n\n```typescript\npublic contact = { name: '' };\n```\n\nPodemos enlazarlos en la plantilla\n\n```html\n<section>\n  <label for=\"name\">Name</label>\n  <input name=\"name\" type=\"text\" [(ngModel)]=\"contact.name\" placeholder=\"Contact name\" />\n</section>\n```\n\n> Es muy til mantener en desarrollo un espa visual de lo que est pasando con los datos. Algunas extensiones como [Augury](https://augury.rangle.io/) aportan muchas ms prestaciones, pero al empezar el _pipe json_ te ayudar mucho.\n\n```html\n<pre>{{ contact | json }}</pre>\n```\n\nLa directiva `ngModel` es mucho ms potente de lo visto aqu. Entre otras cosas permite decidir el criterio de actualizacin (a cada cambio o al salir del control). Tambin se ver ms adelante el asunto de la validacin, que requiere un trato especial. Cuando empiezas con Angular Forms, **un input y su ngModel** asociado sern tus mejores amigos.\n\n## 2.2 Form\n\nHay ms usos de las directivas en los formularios. Por ejemplo, dado el siguiente modelo:\n\n```typescript\npublic contact = { name: '', isVIP: false, gender: '' };\n```\n\nLe vendra muy bien un _check box_.\n\n### CheckBox\n\n```html\n<section>\n  <label for=\"isVIP\">Is V.I.P.</label>\n  <input name=\"isVIP\" type=\"checkbox\" [(ngModel)]=\"contact.isVIP\" />\n</section>\n```\n\nY un para de _radio buttons_.\n\n### Radio Buttons\n\n```html\n<section>\n  <label for=\"gender\">Gender</label>\n  <input name=\"gender\" value=\"male\" type=\"radio\" [(ngModel)]=\"contact.gender\" />\n  <i>Male</i>\n  <input name=\"gender\" value=\"female\" type=\"radio\" [(ngModel)]=\"contact.gender\" />\n  <i>Female</i>\n</section>\n```\n\n# 3 Estructuras\n\nLos anteriores modificadores actan a nivel de contenido del HTML. Veremos ahora una para de directivas que afectan directamente a **la estructura del rbol DOM**. Son las llamadas directivas estructurales que comienzan por el signo `*`\n\n## 3.1 Repetitivas \\*ngFor\n\nUna situacin que nos encontramos una y otra vez es la de las repeticiones. Listas de datos, tablas o grupos de opciones son ejemplos claros. Hay una directiva en _Angular_ para esa situacin, la `*ngFor=\"let iterador of array\"`. **La directiva `*ngFor` forma parte del grupo de directivas estructurales**, porque modifica la estructura del DOM, en este caso insertando mltiples nodos hijos a un elemento dado.\n\n> Puedes ver un ejemplo del uso la directiva `*ngFor` en el componente `ContactsComponent`. Se emplea para recorrer un array de tipos de estado laboral. Es el caso de uso _ms repetido de las repeticiones_; mostrar listas de datos.\n\nDado el siguiente modelo:\n\n```typescript\npublic workStatuses = [\n  { id: 0, description: 'unknow' },\n  { id: 1, description: 'student' },\n  { id: 2, description: 'unemployed' },\n  { id: 3, description: 'employed' }\n];\npublic contact = { name: '', isVIP: false, gender: '', workStatus: 0 };\n```\n\nMontamos las opciones de un _select_ html recorriendo el array y usando el iterador `wkSt` para acceder a sus datos.\n\n```html\n<section>\n  <label for=\"workStatus\">Work Status</label>\n  <select name=\"workStatus\" [(ngModel)]=\"contact.workStatus\">\n    <option *ngFor=\"let wkSt of workStatuses\" [value]=\"wkSt.id\">\n      <span>{{ wkSt.description }}</span>\n    </option>\n  </select>\n</section>\n```\n\n## 3.2 Condicionales \\*ngIf\n\nLa directiva estructural ms utilizada es la `*ngIf`, la cual consigue que un elemento se incluya o se elimine en el _DOM_ en funcin de los datos del modelo.\n\n> En el ejemplo puedes ver que la uso para mostrar el campo empresa cuando el contacto est trabajando. En otro aparecer el campo de estudios.\n\nDado el siguiente modelo:\n\n```typescript\npublic contact = {\n  name: '',\n  isVIP: false,\n  gender: '',\n  workStatus: '0',\n  company: '',\n  education: ''\n};\n```\n\n```html\n<section *ngIf=\"contact.workStatus=='3'; else education\">\n  <label for=\"company\">Company Name</label>\n  <input name=\"company\" type=\"text\" [(ngModel)]=\"contact.company\" />\n</section>\n<ng-template #education>\n  <label for=\"education\">Education</label>\n  <input name=\"education\" type=\"text\" [(ngModel)]=\"contact.education\" />\n</ng-template>\n```\n\n> if **condition** else **template**\n\n### Identificadores con hashtag\n\nEn el cdigo anterior apreciars que aparece un elemento `<ng-template>` no estndar con el atributo llamado `#education` precedido por un `#`. La directiva `#` genera un identificador nico para el elemento al que se le aplica y permite referirse a l en otros lugares del cdigo.\n\nEse truco permite que `*ngIf` muestre otro elemento cuando la condicin principal falle. El otro elemento tiene que ser el componente especial `<ng-template>` que se usa para envolver una rama opcional del DOM. Para localizarlo se usa el identificador `#`.\n\n# 4 Modelo y controlador\n\nLos componentes los hemos definido como **bloques de construccin de pginas. Mediante una vista y un controlador** resuelven un problema de interaccin o presentacin de modelos. En los puntos anteriores te present la vista. Toca ahora estudiar el modelo y el controlador.\n\n## 4.1 El modelo y su interInterfaces y modelos\n\nSin ir muy lejos en las capacidades que tendra un modelo de datos clsico, vamos al menos a beneficiarnos del **_TypeScript_ para definir la estructura de datos**. Esto facilitar la programacin mediante el autocompletado del editor y reducir los errores de tecleo mediante la comprobacin esttica de tipos.\n\nPara ello necesito una interfaz sencilla. Esto es puro _TypeScript_, no es ningn artificio registrable en Angular. Esos s, en algn sitio tienen que estar. Yo suelo usar una ruta como `contacts/models`, pero es algo completamente arbitrario.\n\n```typescript\nexport interface Option {\n  id: number;\n  description: string;\n}\n\nexport interface Contact {\n  name: string;\n  isVIP: boolean;\n  gender: string;\n  workStatus: number | string;\n  company: string;\n  education: string;\n}\n```\n\n> Te recomiendo que **no uses clases para definir modelos** a menos que necesites agregarle funcionalidad imprescindible. Las interfaces, ayudan al control de tipos en tiempo de desarrollo, igual que las clases, pero sin generar nada de cdigo en tiempo de ejecucin, al contrario que las clases. Ojo al uso de tipos compuestos como `number | string`\n\nSe usan para tipificar las propiedades que conforman nuestro modelo para la vista.\n\n```typescript\npublic workStatuses: Option[] = [\n    { id: 0, description: 'unknow' },\n    { id: 1, description: 'student' },\n    { id: 2, description: 'unemployed' },\n    { id: 3, description: 'employed' }\n  ];\npublic contact: Contact = {\n    name: '',\n    isVIP: false,\n    gender: '',\n    workStatus: 0,\n    company: '',\n    education: ''\n  };\npublic contacts: Contact[] = [];\n```\n\n## 4.2 ViewModel en el controlador\n\nLa parte de **lgica del componente** va en la clase que se usa para su definicin. Como ya has visto podemos usar su constructor para reclamar dependencias y usar los interfaces para responder a eventos de su ciclo de vida. Repasemos el `ContactsComponent` vindolo como la clase que es: no solo propiedades, tambin **mtodos**\n\n```typescript\npublic saveContact() {\n  this.contacts.push({ ...this.contact });\n  this.numContacts = this.contacts.length;\n}\n```\n\nAhora se trata de invocar el mtodo desde la vista. Es muy buena prctica llevar la lgica al controlador y no escribirla en la vista.\n\n```html\n<input value=\"Save\" type=\"submit\" (click)=\"saveContact()\" />\n```\n\nPodemos decir que las propiedades pblicas de la clase actuarn como _binding_ de datos con la vista. Mientras que los mtodos pblicos sern invocados desde los eventos de la misma vista.\n\n### OnInit\n\nLos componentes son clases con un **ciclo de vida** al que puedes enganchar tu cdigo en algunos pasos. Por ejemplo al iniciarse el componente.\n\nEl CLI hace que las clase del componente implemente la interfaz `OnInit` y eso permite al framework invocar al mtodo `ngOnInit` en cuanto el componente est listo para su uso. Que no suele ser justo durante la construccin, si no un poco despus. Te recomiendo que lleves toda la lgica de inicializacin a dicho mtodo.\n\n```typescript\npublic workStatuses: Option[];\npublic contact: Contact;\npublic contacts: Contact[];\nconstructor() {}\npublic ngOnInit() {\n  this.workStatuses = [\n    { id: 0, description: 'unknow' },\n    { id: 1, description: 'student' },\n    { id: 2, description: 'unemployed' },\n    { id: 3, description: 'employed' }\n  ];\n  this.contact = {\n    name: '',\n    isVIP: false,\n    gender: '',\n    workStatus: 0,\n    company: '',\n    education: ''\n  };\n  this.contacts = [];\n}\n```\n\n### Un listado de repaso\n\nPara mostrar lo que ahora estamos guardando en una lista, nada ms sencillo que usar de nuevo a `*nFor` y a `*ngIf` para tratar listas vacas.\n\n```html\n<ul *ngIf=\"contacts.length>0; else empty\">\n  <li *ngFor=\"let contact of contacts\">\n    <span>{{ contact.name }}</span>\n    <input value=\"Delete\" type=\"button\" (click)=\"deleteContact(contact)\" />\n  </li>\n</ul>\n<ng-template #empty> <i>No data yet</i> </ng-template>\n```\n\nY ya puestos incluso puedes animarte a borrar contactos. Es fcil, los mtodos pueden recibir argumentos. Y la vista los puede enviar.\n\n```typescript\npublic deleteContact(contact: Contact) {\n  this.contacts = this.contacts.filter(c => c.name !== contact.name);\n  this.numContacts = this.contacts.length;\n}\n```\n\nMira el cdigo completo de **la clase** `ContactsComponent`en el fichero `contacts.component.ts` para tener una visin completa del componente. Como ves, **las propiedades** `header, numContacas, formHidden, contacts ...` se corresponden con las utilizadas en las directivas de enlace en la vista. **Los mtodos** `saveContact(), deleteContact()` son invocados desde eventos de elementos del _html_.\n\nJuntos, **la vista y su clase controladora**, resuelven un problema de interaccin con el usuario **creando un componente**. Todas las pginas que disees sern variaciones y composiciones de estos componentes.\n\n> Y esto es slo el comienzo. La idea de componente ser fundamental en la web del maana para la creacin de pginas mediante `web components`. Pero eso ya se ver ms adelante...\n\nAhora tienes una aplicacin en _Angular 7_ que recoge y muestra datos. Sigue esta serie para aadirle [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/) mientras aprendes a programar con Angular7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-3-Formularios-tablas-y-modelos-de-datos-en-Angular.md","raw":"---\ntitle: Formularios, tablas y modelos de datos en Angular\npermalink: formularios-tablas-y-modelos-de-datos-en-angular\ndate: 2019-01-31 19:17:37\ntags:\n  - Angular\n  - Forms\n  - Tutorial\n  - Introduccin\n  - Angular7\n  - Angular2\ncategories:\n  - [Tutorial, Angular]\nthumbnail: /css/images/angular-3_data.png\n---\n\n![formularios-tablas-y-modelos-de-datos-en-angular](/images/tutorial-angular-3_data.png)\n\nLas **aplicaciones Angular 7 son excelentes para el tratamiento de datos** en el navegador. Su razn de ser fue la recogida de informacin mediante formularios y la presentacin de pginas dinmicas de forma sencilla.\n\nVamos a ver cmo la librera `@angular/forms` enlaza **las vistas, los controladores y los modelos**; y cmo se hace la presentacin de datos en **listas y tablas**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/), al finalizar tendrs una aplicacin que recoge y presenta datos.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/3-data]https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/3-data/contacts)\n\n# 1. Binding\n\n## 1.0 Base\n\n**Los formularios son el punto de entrada** de informacin a nuestros sistemas. Llevan con nosotros desde el inicio de la propia informtica y se han comido una buena parte del tiempo de programacin. En _Angular_ han prestado una especial atencin a ellos facilitando su desarrollo, **desde pantallas simples hasta complejos procesos**.\n\nPara empezar crearemos un proceso sencillo. algo que permita mantener una lista de contactos empresariales. Con lo aprendido en el tema de [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/) creamos un par de ficheros.\n\n```bash\nng g m contacts --routing true\nng g c contacts/contacts\n```\n\nY asignamos sus rutas delegadas en `app-routing` y en `contacts-routing`:\n\n```typescript\n  // app-routing\n  {\n    path: 'contacts',\n    loadChildren: './contacts/contacts.module#ContactsModule'\n  },\n  // contacts-routing\n  {\n    path: '',\n    component: ContactsComponent\n  }\n```\n\nY finalizamos con un enlace en el `HeaderComponent`\n\n```html\n<a routerLink=\"contacts\" class=\"button\">\n  <span> Contacts</span>\n</a>\n```\n\nLa clave para entender cmo funciona _Angular_ est en el concepto de **enlace entre elementos html de las vistas y propiedades de modelos** de datos, el llamado `binding`.\n\nPara realizar el _binding_ usaremos **directivas** en ambos sentidos.\n\n## 1.1 Enlace del modelo hacia la vista\n\nVamos a crear un pequeo modelo de datos. Para empezar agregamos algunas propiedades. En `contacts.component.ts`:\n\n```typescript\npublic header = 'Contacts';\npublic description = 'Manage your contact list';\npublic numContacts = 0;\npublic counterClass = 'tag secondary';\npublic formHidden = false;\n```\n\nEn `contacts.component.html` mostramos cabeceras con estilo\n\n```html\n<h2>{{ header }}</h2>\n<p>{{ description | uppercase }}</p>\n<p>\n  You have\n  <mark [class]=\"counterClass\">{{ numContacts }}</mark>\n  contacts right now.\n</p>\n```\n\n### La interpolacin entre \\{ \\{ \\} \\}\n\nEn el fichero `contacts.component.ts` tienes en su vista _html_ encontrars elementos ajenos al lenguaje. Son las directivas. La primera que encuentras es `{{ header }}`. Esas dobles llaves encierran expresiones que se evaluarn en tiempo de ejecucin. La llamamos **directiva de interpolacin** y es la manera ms cmoda y usual de mostrar contenido dinmico en Angular.\n\n> La expresin interna hace referencia a variables que se obtienen de las propiedades de la clase controladora del componente. En este caso `ContactsComponent` y `header`, con su valor _Contacts_ en ejecucin. Este enlace mantiene la vista permanentemente actualizada a travs de un potente sistema de deteccin del cambio.\n\n### Las tuberas |\n\nSi queremos que la presentacin del dato sea distinta a su valor real, podemos usar **funciones de transformacin** especiales. Se llaman tuberas o _pipes_ y se indican mediante el carcter `|`.\n\nEl _framework_ nos provee de casos bsicos como `uppercase, lowercase, date, number...`. Tambin dispones de un mecanismo para crear tus propios _pipes_.\n\n### Los atributos evaluados []\n\nEn _Html_ disponemos de atributos para asignar valores a propiedades de los elementos. Esos atributos reciben los valores como constantes. Pero, si se encierran entre corchetes se convierten en un **evaluador de expresiones** y puede recibir una variable o cualquier otra expresin.\n\nComo por ejemplo usando una _clase css_ cuyo valor cambia en tiempo de ejecucin. O para deshabilitar un elemento dinmicamente.\n\n## 1.2 Enlace de la vista hacia el modelo\n\nEn `contacts.component.html` tambin actuamos sobre la vista, para manipular el modelo... y de vuelta a la vista. Por ejemplo con mecanismo simple de ocultacin de un elemento.\n\n```html\n<input value=\"Show Form\" type=\"button\" (click)=\"formHidden = false\" />\n<input value=\"Hide Form\" type=\"button\" (click)=\"formHidden = true\" />\n<form [ngClass]=\"{ 'hidden' : formHidden }\">\n  <fieldset><legend>Contact Form</legend></fieldset>\n</form>\n```\n\n### Las clases CSS como atributos especiales\n\nPara el caso concreto de determinar las clases CSS aplicables a un elemento de manera dinmica, usaremos la directiva `ngClass`. La cual recibe un objeto cuyas propiedades son nombres de clases CSS y sus valores son expresiones booleanas. Si se cumplen se aplica la clase y si no, se quita la clase.\n\n```html\n[ngClass]=\"{ 'hidden' : formHidden }\"\n```\n\nEn este caso se oculta el elemento dependiendo del valor de la expresin `formHidden`. Pero Cmo se manipula esa variable?\n\n### Los eventos ()\n\nCualquier evento asociado a un elemento puede ejecutar una instruccin sin ms que incluirlo entre parntesis. Idealmente dicha instruccin debe llamar a un mtodo o funcin de la clase controladora. Aunque si es trivial puedes dejarla en el Html.\n\n```html\n(click)=\"formHidden = true\"\n```\n\n# 2. Doble Binding\n\nLa comunicacin del modelo hacia la vista es slo el principio. En _Angular_ tambin podrs **comunicar la vista hacia el modelo**, permitindole al usuario modificar los datos a travs de formularios. Es lo que se conoce como _double binding_.\n\n## 2.1 El doble enlace al modelo [(ngModel)]\n\nLa directiva `[(ngModel)]` se compone de un atributo _custom_ `ngModel` y lo rodea de los smbolos `[()]`. Esta tcnica es conocida como _banana in a box_ porque su sintaxis requiere un `()` dentro de un `[]` y une las capacidades de las expresiones y los eventos facilitando la comunicacin bidireccional.\n\n```html\n[(ngModel)]=\"model.property\"\n```\n\nUsa la comunicacin en ambos sentidos\n\n- **(banana)** : de la vista al modelo\n- **[box]** : del modelo a la vista\n\n> Atencin: La directiva `ngModel` viene dentro del mdulo `FormsModule` que hay que importar explcitamente.\n\nPor ejemplo `[(ngModel)]=\"contact.name\"` enlaza doblemente la propiedad del modelo `contact.name` con el elemento `<input>` de la vista. Cada tecleo del usuario se registra en la variable. Y el valor de la variable se muestra en el `<input>`.\n\nDada un modelo como este en `contacts.component.ts`:\n\n```typescript\npublic contact = { name: '' };\n```\n\nPodemos enlazarlos en la plantilla\n\n```html\n<section>\n  <label for=\"name\">Name</label>\n  <input name=\"name\" type=\"text\" [(ngModel)]=\"contact.name\" placeholder=\"Contact name\" />\n</section>\n```\n\n> Es muy til mantener en desarrollo un espa visual de lo que est pasando con los datos. Algunas extensiones como [Augury](https://augury.rangle.io/) aportan muchas ms prestaciones, pero al empezar el _pipe json_ te ayudar mucho.\n\n```html\n<pre>{{ contact | json }}</pre>\n```\n\nLa directiva `ngModel` es mucho ms potente de lo visto aqu. Entre otras cosas permite decidir el criterio de actualizacin (a cada cambio o al salir del control). Tambin se ver ms adelante el asunto de la validacin, que requiere un trato especial. Cuando empiezas con Angular Forms, **un input y su ngModel** asociado sern tus mejores amigos.\n\n## 2.2 Form\n\nHay ms usos de las directivas en los formularios. Por ejemplo, dado el siguiente modelo:\n\n```typescript\npublic contact = { name: '', isVIP: false, gender: '' };\n```\n\nLe vendra muy bien un _check box_.\n\n### CheckBox\n\n```html\n<section>\n  <label for=\"isVIP\">Is V.I.P.</label>\n  <input name=\"isVIP\" type=\"checkbox\" [(ngModel)]=\"contact.isVIP\" />\n</section>\n```\n\nY un para de _radio buttons_.\n\n### Radio Buttons\n\n```html\n<section>\n  <label for=\"gender\">Gender</label>\n  <input name=\"gender\" value=\"male\" type=\"radio\" [(ngModel)]=\"contact.gender\" />\n  <i>Male</i>\n  <input name=\"gender\" value=\"female\" type=\"radio\" [(ngModel)]=\"contact.gender\" />\n  <i>Female</i>\n</section>\n```\n\n# 3 Estructuras\n\nLos anteriores modificadores actan a nivel de contenido del HTML. Veremos ahora una para de directivas que afectan directamente a **la estructura del rbol DOM**. Son las llamadas directivas estructurales que comienzan por el signo `*`\n\n## 3.1 Repetitivas \\*ngFor\n\nUna situacin que nos encontramos una y otra vez es la de las repeticiones. Listas de datos, tablas o grupos de opciones son ejemplos claros. Hay una directiva en _Angular_ para esa situacin, la `*ngFor=\"let iterador of array\"`. **La directiva `*ngFor` forma parte del grupo de directivas estructurales**, porque modifica la estructura del DOM, en este caso insertando mltiples nodos hijos a un elemento dado.\n\n> Puedes ver un ejemplo del uso la directiva `*ngFor` en el componente `ContactsComponent`. Se emplea para recorrer un array de tipos de estado laboral. Es el caso de uso _ms repetido de las repeticiones_; mostrar listas de datos.\n\nDado el siguiente modelo:\n\n```typescript\npublic workStatuses = [\n  { id: 0, description: 'unknow' },\n  { id: 1, description: 'student' },\n  { id: 2, description: 'unemployed' },\n  { id: 3, description: 'employed' }\n];\npublic contact = { name: '', isVIP: false, gender: '', workStatus: 0 };\n```\n\nMontamos las opciones de un _select_ html recorriendo el array y usando el iterador `wkSt` para acceder a sus datos.\n\n```html\n<section>\n  <label for=\"workStatus\">Work Status</label>\n  <select name=\"workStatus\" [(ngModel)]=\"contact.workStatus\">\n    <option *ngFor=\"let wkSt of workStatuses\" [value]=\"wkSt.id\">\n      <span>{{ wkSt.description }}</span>\n    </option>\n  </select>\n</section>\n```\n\n## 3.2 Condicionales \\*ngIf\n\nLa directiva estructural ms utilizada es la `*ngIf`, la cual consigue que un elemento se incluya o se elimine en el _DOM_ en funcin de los datos del modelo.\n\n> En el ejemplo puedes ver que la uso para mostrar el campo empresa cuando el contacto est trabajando. En otro aparecer el campo de estudios.\n\nDado el siguiente modelo:\n\n```typescript\npublic contact = {\n  name: '',\n  isVIP: false,\n  gender: '',\n  workStatus: '0',\n  company: '',\n  education: ''\n};\n```\n\n```html\n<section *ngIf=\"contact.workStatus=='3'; else education\">\n  <label for=\"company\">Company Name</label>\n  <input name=\"company\" type=\"text\" [(ngModel)]=\"contact.company\" />\n</section>\n<ng-template #education>\n  <label for=\"education\">Education</label>\n  <input name=\"education\" type=\"text\" [(ngModel)]=\"contact.education\" />\n</ng-template>\n```\n\n> if **condition** else **template**\n\n### Identificadores con hashtag\n\nEn el cdigo anterior apreciars que aparece un elemento `<ng-template>` no estndar con el atributo llamado `#education` precedido por un `#`. La directiva `#` genera un identificador nico para el elemento al que se le aplica y permite referirse a l en otros lugares del cdigo.\n\nEse truco permite que `*ngIf` muestre otro elemento cuando la condicin principal falle. El otro elemento tiene que ser el componente especial `<ng-template>` que se usa para envolver una rama opcional del DOM. Para localizarlo se usa el identificador `#`.\n\n# 4 Modelo y controlador\n\nLos componentes los hemos definido como **bloques de construccin de pginas. Mediante una vista y un controlador** resuelven un problema de interaccin o presentacin de modelos. En los puntos anteriores te present la vista. Toca ahora estudiar el modelo y el controlador.\n\n## 4.1 El modelo y su interInterfaces y modelos\n\nSin ir muy lejos en las capacidades que tendra un modelo de datos clsico, vamos al menos a beneficiarnos del **_TypeScript_ para definir la estructura de datos**. Esto facilitar la programacin mediante el autocompletado del editor y reducir los errores de tecleo mediante la comprobacin esttica de tipos.\n\nPara ello necesito una interfaz sencilla. Esto es puro _TypeScript_, no es ningn artificio registrable en Angular. Esos s, en algn sitio tienen que estar. Yo suelo usar una ruta como `contacts/models`, pero es algo completamente arbitrario.\n\n```typescript\nexport interface Option {\n  id: number;\n  description: string;\n}\n\nexport interface Contact {\n  name: string;\n  isVIP: boolean;\n  gender: string;\n  workStatus: number | string;\n  company: string;\n  education: string;\n}\n```\n\n> Te recomiendo que **no uses clases para definir modelos** a menos que necesites agregarle funcionalidad imprescindible. Las interfaces, ayudan al control de tipos en tiempo de desarrollo, igual que las clases, pero sin generar nada de cdigo en tiempo de ejecucin, al contrario que las clases. Ojo al uso de tipos compuestos como `number | string`\n\nSe usan para tipificar las propiedades que conforman nuestro modelo para la vista.\n\n```typescript\npublic workStatuses: Option[] = [\n    { id: 0, description: 'unknow' },\n    { id: 1, description: 'student' },\n    { id: 2, description: 'unemployed' },\n    { id: 3, description: 'employed' }\n  ];\npublic contact: Contact = {\n    name: '',\n    isVIP: false,\n    gender: '',\n    workStatus: 0,\n    company: '',\n    education: ''\n  };\npublic contacts: Contact[] = [];\n```\n\n## 4.2 ViewModel en el controlador\n\nLa parte de **lgica del componente** va en la clase que se usa para su definicin. Como ya has visto podemos usar su constructor para reclamar dependencias y usar los interfaces para responder a eventos de su ciclo de vida. Repasemos el `ContactsComponent` vindolo como la clase que es: no solo propiedades, tambin **mtodos**\n\n```typescript\npublic saveContact() {\n  this.contacts.push({ ...this.contact });\n  this.numContacts = this.contacts.length;\n}\n```\n\nAhora se trata de invocar el mtodo desde la vista. Es muy buena prctica llevar la lgica al controlador y no escribirla en la vista.\n\n```html\n<input value=\"Save\" type=\"submit\" (click)=\"saveContact()\" />\n```\n\nPodemos decir que las propiedades pblicas de la clase actuarn como _binding_ de datos con la vista. Mientras que los mtodos pblicos sern invocados desde los eventos de la misma vista.\n\n### OnInit\n\nLos componentes son clases con un **ciclo de vida** al que puedes enganchar tu cdigo en algunos pasos. Por ejemplo al iniciarse el componente.\n\nEl CLI hace que las clase del componente implemente la interfaz `OnInit` y eso permite al framework invocar al mtodo `ngOnInit` en cuanto el componente est listo para su uso. Que no suele ser justo durante la construccin, si no un poco despus. Te recomiendo que lleves toda la lgica de inicializacin a dicho mtodo.\n\n```typescript\npublic workStatuses: Option[];\npublic contact: Contact;\npublic contacts: Contact[];\nconstructor() {}\npublic ngOnInit() {\n  this.workStatuses = [\n    { id: 0, description: 'unknow' },\n    { id: 1, description: 'student' },\n    { id: 2, description: 'unemployed' },\n    { id: 3, description: 'employed' }\n  ];\n  this.contact = {\n    name: '',\n    isVIP: false,\n    gender: '',\n    workStatus: 0,\n    company: '',\n    education: ''\n  };\n  this.contacts = [];\n}\n```\n\n### Un listado de repaso\n\nPara mostrar lo que ahora estamos guardando en una lista, nada ms sencillo que usar de nuevo a `*nFor` y a `*ngIf` para tratar listas vacas.\n\n```html\n<ul *ngIf=\"contacts.length>0; else empty\">\n  <li *ngFor=\"let contact of contacts\">\n    <span>{{ contact.name }}</span>\n    <input value=\"Delete\" type=\"button\" (click)=\"deleteContact(contact)\" />\n  </li>\n</ul>\n<ng-template #empty> <i>No data yet</i> </ng-template>\n```\n\nY ya puestos incluso puedes animarte a borrar contactos. Es fcil, los mtodos pueden recibir argumentos. Y la vista los puede enviar.\n\n```typescript\npublic deleteContact(contact: Contact) {\n  this.contacts = this.contacts.filter(c => c.name !== contact.name);\n  this.numContacts = this.contacts.length;\n}\n```\n\nMira el cdigo completo de **la clase** `ContactsComponent`en el fichero `contacts.component.ts` para tener una visin completa del componente. Como ves, **las propiedades** `header, numContacas, formHidden, contacts ...` se corresponden con las utilizadas en las directivas de enlace en la vista. **Los mtodos** `saveContact(), deleteContact()` son invocados desde eventos de elementos del _html_.\n\nJuntos, **la vista y su clase controladora**, resuelven un problema de interaccin con el usuario **creando un componente**. Todas las pginas que disees sern variaciones y composiciones de estos componentes.\n\n> Y esto es slo el comienzo. La idea de componente ser fundamental en la web del maana para la creacin de pginas mediante `web components`. Pero eso ya se ver ms adelante...\n\nAhora tienes una aplicacin en _Angular 7_ que recoge y muestra datos. Sigue esta serie para aadirle [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/) mientras aprendes a programar con Angular7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"formularios-tablas-y-modelos-de-datos-en-angular","published":1,"updated":"2019-02-12T16:22:50.019Z","_id":"cjbrwpvi7001niwd3srhzdu8j","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-3_data.png\" alt=\"formularios-tablas-y-modelos-de-datos-en-angular\"></p><p>Las <strong>aplicaciones Angular 7 son excelentes para el tratamiento de datos</strong> en el navegador. Su razn de ser fue la recogida de informacin mediante formularios y la presentacin de pginas dinmicas de forma sencilla.</p><p>Vamos a ver cmo la librera <code>@angular/forms</code> enlaza <strong>las vistas, los controladores y los modelos</strong>; y cmo se hace la presentacin de datos en <strong>listas y tablas</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal cmo qued en <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a>, al finalizar tendrs una aplicacin que recoge y presenta datos.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: [AcademiaBinaria/angular-board/3-data]<a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/3-data/contacts\" target=\"_blank\" rel=\"noopener\">https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/3-data/contacts</a>)</p></blockquote><h1 id=\"1-Binding\"><a href=\"#1-Binding\" class=\"headerlink\" title=\"1. Binding\"></a>1. Binding</h1><h2 id=\"1-0-Base\"><a href=\"#1-0-Base\" class=\"headerlink\" title=\"1.0 Base\"></a>1.0 Base</h2><p><strong>Los formularios son el punto de entrada</strong> de informacin a nuestros sistemas. Llevan con nosotros desde el inicio de la propia informtica y se han comido una buena parte del tiempo de programacin. En <em>Angular</em> han prestado una especial atencin a ellos facilitando su desarrollo, <strong>desde pantallas simples hasta complejos procesos</strong>.</p><p>Para empezar crearemos un proceso sencillo. algo que permita mantener una lista de contactos empresariales. Con lo aprendido en el tema de <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a> creamos un par de ficheros.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m contacts --routing <span class=\"literal\">true</span></span><br><span class=\"line\">ng g c contacts/contacts</span><br></pre></td></tr></table></figure><p>Y asignamos sus rutas delegadas en <code>app-routing</code> y en <code>contacts-routing</code>:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app-routing</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'contacts'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"string\">'./contacts/contacts.module#ContactsModule'</span></span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"><span class=\"comment\">// contacts-routing</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">''</span>,</span><br><span class=\"line\">  component: ContactsComponent</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y finalizamos con un enlace en el <code>HeaderComponent</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"contacts\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> Contacts<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La clave para entender cmo funciona <em>Angular</em> est en el concepto de <strong>enlace entre elementos html de las vistas y propiedades de modelos</strong> de datos, el llamado <code>binding</code>.</p><p>Para realizar el <em>binding</em> usaremos <strong>directivas</strong> en ambos sentidos.</p><h2 id=\"1-1-Enlace-del-modelo-hacia-la-vista\"><a href=\"#1-1-Enlace-del-modelo-hacia-la-vista\" class=\"headerlink\" title=\"1.1 Enlace del modelo hacia la vista\"></a>1.1 Enlace del modelo hacia la vista</h2><p>Vamos a crear un pequeo modelo de datos. Para empezar agregamos algunas propiedades. En <code>contacts.component.ts</code>:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> header = <span class=\"string\">'Contacts'</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> description = <span class=\"string\">'Manage your contact list'</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> numContacts = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> counterClass = <span class=\"string\">'tag secondary'</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> formHidden = <span class=\"literal\">false</span>;</span><br></pre></td></tr></table></figure><p>En <code>contacts.component.html</code> mostramos cabeceras con estilo</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>&#123;&#123; header &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; description | uppercase &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  You have</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">mark</span> [<span class=\"attr\">class</span>]=<span class=\"string\">\"counterClass\"</span>&gt;</span>&#123;&#123; numContacts &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">mark</span>&gt;</span></span><br><span class=\"line\">  contacts right now.</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"La-interpolacion-entre\"><a href=\"#La-interpolacion-entre\" class=\"headerlink\" title=\"La interpolacin entre { { } }\"></a>La interpolacin entre { { } }</h3><p>En el fichero <code>contacts.component.ts</code> tienes en su vista <em>html</em> encontrars elementos ajenos al lenguaje. Son las directivas. La primera que encuentras es <code></code>. Esas dobles llaves encierran expresiones que se evaluarn en tiempo de ejecucin. La llamamos <strong>directiva de interpolacin</strong> y es la manera ms cmoda y usual de mostrar contenido dinmico en Angular.</p><blockquote><p>La expresin interna hace referencia a variables que se obtienen de las propiedades de la clase controladora del componente. En este caso <code>ContactsComponent</code> y <code>header</code>, con su valor <em>Contacts</em> en ejecucin. Este enlace mantiene la vista permanentemente actualizada a travs de un potente sistema de deteccin del cambio.</p></blockquote><h3 id=\"Las-tuberias\"><a href=\"#Las-tuberias\" class=\"headerlink\" title=\"Las tuberas |\"></a>Las tuberas |</h3><p>Si queremos que la presentacin del dato sea distinta a su valor real, podemos usar <strong>funciones de transformacin</strong> especiales. Se llaman tuberas o <em>pipes</em> y se indican mediante el carcter <code>|</code>.</p><p>El <em>framework</em> nos provee de casos bsicos como <code>uppercase, lowercase, date, number...</code>. Tambin dispones de un mecanismo para crear tus propios <em>pipes</em>.</p><h3 id=\"Los-atributos-evaluados\"><a href=\"#Los-atributos-evaluados\" class=\"headerlink\" title=\"Los atributos evaluados []\"></a>Los atributos evaluados []</h3><p>En <em>Html</em> disponemos de atributos para asignar valores a propiedades de los elementos. Esos atributos reciben los valores como constantes. Pero, si se encierran entre corchetes se convierten en un <strong>evaluador de expresiones</strong> y puede recibir una variable o cualquier otra expresin.</p><p>Como por ejemplo usando una <em>clase css</em> cuyo valor cambia en tiempo de ejecucin. O para deshabilitar un elemento dinmicamente.</p><h2 id=\"1-2-Enlace-de-la-vista-hacia-el-modelo\"><a href=\"#1-2-Enlace-de-la-vista-hacia-el-modelo\" class=\"headerlink\" title=\"1.2 Enlace de la vista hacia el modelo\"></a>1.2 Enlace de la vista hacia el modelo</h2><p>En <code>contacts.component.html</code> tambin actuamos sobre la vista, para manipular el modelo y de vuelta a la vista. Por ejemplo con mecanismo simple de ocultacin de un elemento.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Show Form\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"formHidden = false\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Hide Form\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"formHidden = true\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> [<span class=\"attr\">ngClass</span>]=<span class=\"string\">\"&#123; 'hidden' : formHidden &#125;\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">legend</span>&gt;</span>Contact Form<span class=\"tag\">&lt;/<span class=\"name\">legend</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"Las-clases-CSS-como-atributos-especiales\"><a href=\"#Las-clases-CSS-como-atributos-especiales\" class=\"headerlink\" title=\"Las clases CSS como atributos especiales\"></a>Las clases CSS como atributos especiales</h3><p>Para el caso concreto de determinar las clases CSS aplicables a un elemento de manera dinmica, usaremos la directiva <code>ngClass</code>. La cual recibe un objeto cuyas propiedades son nombres de clases CSS y sus valores son expresiones booleanas. Si se cumplen se aplica la clase y si no, se quita la clase.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[ngClass]=\"&#123; 'hidden' : formHidden &#125;\"</span><br></pre></td></tr></table></figure><p>En este caso se oculta el elemento dependiendo del valor de la expresin <code>formHidden</code>. Pero Cmo se manipula esa variable?</p><h3 id=\"Los-eventos\"><a href=\"#Los-eventos\" class=\"headerlink\" title=\"Los eventos ()\"></a>Los eventos ()</h3><p>Cualquier evento asociado a un elemento puede ejecutar una instruccin sin ms que incluirlo entre parntesis. Idealmente dicha instruccin debe llamar a un mtodo o funcin de la clase controladora. Aunque si es trivial puedes dejarla en el Html.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(click)=\"formHidden = true\"</span><br></pre></td></tr></table></figure><h1 id=\"2-Doble-Binding\"><a href=\"#2-Doble-Binding\" class=\"headerlink\" title=\"2. Doble Binding\"></a>2. Doble Binding</h1><p>La comunicacin del modelo hacia la vista es slo el principio. En <em>Angular</em> tambin podrs <strong>comunicar la vista hacia el modelo</strong>, permitindole al usuario modificar los datos a travs de formularios. Es lo que se conoce como <em>double binding</em>.</p><h2 id=\"2-1-El-doble-enlace-al-modelo-ngModel\"><a href=\"#2-1-El-doble-enlace-al-modelo-ngModel\" class=\"headerlink\" title=\"2.1 El doble enlace al modelo [(ngModel)]\"></a>2.1 El doble enlace al modelo [(ngModel)]</h2><p>La directiva <code>[(ngModel)]</code> se compone de un atributo <em>custom</em> <code>ngModel</code> y lo rodea de los smbolos <code>[()]</code>. Esta tcnica es conocida como <em>banana in a box</em> porque su sintaxis requiere un <code>()</code> dentro de un <code>[]</code> y une las capacidades de las expresiones y los eventos facilitando la comunicacin bidireccional.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[(ngModel)]=\"model.property\"</span><br></pre></td></tr></table></figure><p>Usa la comunicacin en ambos sentidos</p><ul><li><strong>(banana)</strong> : de la vista al modelo</li><li><strong>[box]</strong> : del modelo a la vista</li></ul><blockquote><p>Atencin: La directiva <code>ngModel</code> viene dentro del mdulo <code>FormsModule</code> que hay que importar explcitamente.</p></blockquote><p>Por ejemplo <code>[(ngModel)]=&quot;contact.name&quot;</code> enlaza doblemente la propiedad del modelo <code>contact.name</code> con el elemento <code>&lt;input&gt;</code> de la vista. Cada tecleo del usuario se registra en la variable. Y el valor de la variable se muestra en el <code>&lt;input&gt;</code>.</p><p>Dada un modelo como este en <code>contacts.component.ts</code>:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span> &#125;;</span><br></pre></td></tr></table></figure><p>Podemos enlazarlos en la plantilla</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"name\"</span>&gt;</span>Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.name\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"Contact name\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Es muy til mantener en desarrollo un espa visual de lo que est pasando con los datos. Algunas extensiones como <a href=\"https://augury.rangle.io/\" target=\"_blank\" rel=\"noopener\">Augury</a> aportan muchas ms prestaciones, pero al empezar el <em>pipe json</em> te ayudar mucho.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; contact | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La directiva <code>ngModel</code> es mucho ms potente de lo visto aqu. Entre otras cosas permite decidir el criterio de actualizacin (a cada cambio o al salir del control). Tambin se ver ms adelante el asunto de la validacin, que requiere un trato especial. Cuando empiezas con Angular Forms, <strong>un input y su ngModel</strong> asociado sern tus mejores amigos.</p><h2 id=\"2-2-Form\"><a href=\"#2-2-Form\" class=\"headerlink\" title=\"2.2 Form\"></a>2.2 Form</h2><p>Hay ms usos de las directivas en los formularios. Por ejemplo, dado el siguiente modelo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span>, isVIP: <span class=\"literal\">false</span>, gender: <span class=\"string\">''</span> &#125;;</span><br></pre></td></tr></table></figure><p>Le vendra muy bien un <em>check box</em>.</p><h3 id=\"CheckBox\"><a href=\"#CheckBox\" class=\"headerlink\" title=\"CheckBox\"></a>CheckBox</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"isVIP\"</span>&gt;</span>Is V.I.P.<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"isVIP\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"checkbox\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.isVIP\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y un para de <em>radio buttons</em>.</p><h3 id=\"Radio-Buttons\"><a href=\"#Radio-Buttons\" class=\"headerlink\" title=\"Radio Buttons\"></a>Radio Buttons</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"gender\"</span>&gt;</span>Gender<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"gender\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"male\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"radio\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.gender\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>Male<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"gender\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"female\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"radio\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.gender\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>Female<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"3-Estructuras\"><a href=\"#3-Estructuras\" class=\"headerlink\" title=\"3 Estructuras\"></a>3 Estructuras</h1><p>Los anteriores modificadores actan a nivel de contenido del HTML. Veremos ahora una para de directivas que afectan directamente a <strong>la estructura del rbol DOM</strong>. Son las llamadas directivas estructurales que comienzan por el signo <code>*</code></p><h2 id=\"3-1-Repetitivas-ngFor\"><a href=\"#3-1-Repetitivas-ngFor\" class=\"headerlink\" title=\"3.1 Repetitivas *ngFor\"></a>3.1 Repetitivas *ngFor</h2><p>Una situacin que nos encontramos una y otra vez es la de las repeticiones. Listas de datos, tablas o grupos de opciones son ejemplos claros. Hay una directiva en <em>Angular</em> para esa situacin, la <code>*ngFor=&quot;let iterador of array&quot;</code>. <strong>La directiva <code>*ngFor</code> forma parte del grupo de directivas estructurales</strong>, porque modifica la estructura del DOM, en este caso insertando mltiples nodos hijos a un elemento dado.</p><blockquote><p>Puedes ver un ejemplo del uso la directiva <code>*ngFor</code> en el componente <code>ContactsComponent</code>. Se emplea para recorrer un array de tipos de estado laboral. Es el caso de uso <em>ms repetido de las repeticiones</em>; mostrar listas de datos.</p></blockquote><p>Dado el siguiente modelo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses = [</span><br><span class=\"line\">  &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span>, isVIP: <span class=\"literal\">false</span>, gender: <span class=\"string\">''</span>, workStatus: <span class=\"number\">0</span> &#125;;</span><br></pre></td></tr></table></figure><p>Montamos las opciones de un <em>select</em> html recorriendo el array y usando el iterador <code>wkSt</code> para acceder a sus datos.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"workStatus\"</span>&gt;</span>Work Status<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">name</span>=<span class=\"string\">\"workStatus\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.workStatus\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">option</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let wkSt of workStatuses\"</span> [<span class=\"attr\">value</span>]=<span class=\"string\">\"wkSt.id\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; wkSt.description &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"3-2-Condicionales-ngIf\"><a href=\"#3-2-Condicionales-ngIf\" class=\"headerlink\" title=\"3.2 Condicionales *ngIf\"></a>3.2 Condicionales *ngIf</h2><p>La directiva estructural ms utilizada es la <code>*ngIf</code>, la cual consigue que un elemento se incluya o se elimine en el <em>DOM</em> en funcin de los datos del modelo.</p><blockquote><p>En el ejemplo puedes ver que la uso para mostrar el campo empresa cuando el contacto est trabajando. En otro aparecer el campo de estudios.</p></blockquote><p>Dado el siguiente modelo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123;</span><br><span class=\"line\">  name: <span class=\"string\">''</span>,</span><br><span class=\"line\">  isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">  gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">  workStatus: <span class=\"string\">'0'</span>,</span><br><span class=\"line\">  company: <span class=\"string\">''</span>,</span><br><span class=\"line\">  education: <span class=\"string\">''</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"contact.workStatus=='3'; else education\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"company\"</span>&gt;</span>Company Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"company\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.company\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ng-template</span> #<span class=\"attr\">education</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"education\"</span>&gt;</span>Education<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"education\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.education\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>if <strong>condition</strong> else <strong>template</strong></p></blockquote><h3 id=\"Identificadores-con-hashtag\"><a href=\"#Identificadores-con-hashtag\" class=\"headerlink\" title=\"Identificadores con hashtag\"></a>Identificadores con hashtag</h3><p>En el cdigo anterior apreciars que aparece un elemento <code>&lt;ng-template&gt;</code> no estndar con el atributo llamado <code>#education</code> precedido por un <code>#</code>. La directiva <code>#</code> genera un identificador nico para el elemento al que se le aplica y permite referirse a l en otros lugares del cdigo.</p><p>Ese truco permite que <code>*ngIf</code> muestre otro elemento cuando la condicin principal falle. El otro elemento tiene que ser el componente especial <code>&lt;ng-template&gt;</code> que se usa para envolver una rama opcional del DOM. Para localizarlo se usa el identificador <code>#</code>.</p><h1 id=\"4-Modelo-y-controlador\"><a href=\"#4-Modelo-y-controlador\" class=\"headerlink\" title=\"4 Modelo y controlador\"></a>4 Modelo y controlador</h1><p>Los componentes los hemos definido como <strong>bloques de construccin de pginas. Mediante una vista y un controlador</strong> resuelven un problema de interaccin o presentacin de modelos. En los puntos anteriores te present la vista. Toca ahora estudiar el modelo y el controlador.</p><h2 id=\"4-1-El-modelo-y-su-interInterfaces-y-modelos\"><a href=\"#4-1-El-modelo-y-su-interInterfaces-y-modelos\" class=\"headerlink\" title=\"4.1 El modelo y su interInterfaces y modelos\"></a>4.1 El modelo y su interInterfaces y modelos</h2><p>Sin ir muy lejos en las capacidades que tendra un modelo de datos clsico, vamos al menos a beneficiarnos del <strong><em>TypeScript</em> para definir la estructura de datos</strong>. Esto facilitar la programacin mediante el autocompletado del editor y reducir los errores de tecleo mediante la comprobacin esttica de tipos.</p><p>Para ello necesito una interfaz sencilla. Esto es puro <em>TypeScript</em>, no es ningn artificio registrable en Angular. Esos s, en algn sitio tienen que estar. Yo suelo usar una ruta como <code>contacts/models</code>, pero es algo completamente arbitrario.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Option &#123;</span><br><span class=\"line\">  id: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  description: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Contact &#123;</span><br><span class=\"line\">  name: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  isVIP: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  gender: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  workStatus: <span class=\"built_in\">number</span> | <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  company: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  education: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Te recomiendo que <strong>no uses clases para definir modelos</strong> a menos que necesites agregarle funcionalidad imprescindible. Las interfaces, ayudan al control de tipos en tiempo de desarrollo, igual que las clases, pero sin generar nada de cdigo en tiempo de ejecucin, al contrario que las clases. Ojo al uso de tipos compuestos como <code>number | string</code></p></blockquote><p>Se usan para tipificar las propiedades que conforman nuestro modelo para la vista.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses: Option[] = [</span><br><span class=\"line\">    &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">  ];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact: Contact = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">''</span>,</span><br><span class=\"line\">    isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">    workStatus: <span class=\"number\">0</span>,</span><br><span class=\"line\">    company: <span class=\"string\">''</span>,</span><br><span class=\"line\">    education: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"><span class=\"keyword\">public</span> contacts: Contact[] = [];</span><br></pre></td></tr></table></figure><h2 id=\"4-2-ViewModel-en-el-controlador\"><a href=\"#4-2-ViewModel-en-el-controlador\" class=\"headerlink\" title=\"4.2 ViewModel en el controlador\"></a>4.2 ViewModel en el controlador</h2><p>La parte de <strong>lgica del componente</strong> va en la clase que se usa para su definicin. Como ya has visto podemos usar su constructor para reclamar dependencias y usar los interfaces para responder a eventos de su ciclo de vida. Repasemos el <code>ContactsComponent</code> vindolo como la clase que es: no solo propiedades, tambin <strong>mtodos</strong></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> saveContact() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts.push(&#123; ...this.contact &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.numContacts = <span class=\"keyword\">this</span>.contacts.length;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora se trata de invocar el mtodo desde la vista. Es muy buena prctica llevar la lgica al controlador y no escribirla en la vista.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Save\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"saveContact()\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>Podemos decir que las propiedades pblicas de la clase actuarn como <em>binding</em> de datos con la vista. Mientras que los mtodos pblicos sern invocados desde los eventos de la misma vista.</p><h3 id=\"OnInit\"><a href=\"#OnInit\" class=\"headerlink\" title=\"OnInit\"></a>OnInit</h3><p>Los componentes son clases con un <strong>ciclo de vida</strong> al que puedes enganchar tu cdigo en algunos pasos. Por ejemplo al iniciarse el componente.</p><p>El CLI hace que las clase del componente implemente la interfaz <code>OnInit</code> y eso permite al framework invocar al mtodo <code>ngOnInit</code> en cuanto el componente est listo para su uso. Que no suele ser justo durante la construccin, si no un poco despus. Te recomiendo que lleves toda la lgica de inicializacin a dicho mtodo.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses: Option[];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact: Contact;</span><br><span class=\"line\"><span class=\"keyword\">public</span> contacts: Contact[];</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.workStatuses = [</span><br><span class=\"line\">    &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">  ];</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contact = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">''</span>,</span><br><span class=\"line\">    isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">    workStatus: <span class=\"number\">0</span>,</span><br><span class=\"line\">    company: <span class=\"string\">''</span>,</span><br><span class=\"line\">    education: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts = [];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h3 id=\"Un-listado-de-repaso\"><a href=\"#Un-listado-de-repaso\" class=\"headerlink\" title=\"Un listado de repaso\"></a>Un listado de repaso</h3><p>Para mostrar lo que ahora estamos guardando en una lista, nada ms sencillo que usar de nuevo a <code>*nFor</code> y a <code>*ngIf</code> para tratar listas vacas.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"contacts.length&gt;0; else empty\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let contact of contacts\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; contact.name &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Delete\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"deleteContact(contact)\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ng-template</span> #<span class=\"attr\">empty</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>No data yet<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y ya puestos incluso puedes animarte a borrar contactos. Es fcil, los mtodos pueden recibir argumentos. Y la vista los puede enviar.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> deleteContact(contact: Contact) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts = <span class=\"keyword\">this</span>.contacts.filter(<span class=\"function\"><span class=\"params\">c</span> =&gt;</span> c.name !== contact.name);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.numContacts = <span class=\"keyword\">this</span>.contacts.length;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Mira el cdigo completo de <strong>la clase</strong> <code>ContactsComponent</code>en el fichero <code>contacts.component.ts</code> para tener una visin completa del componente. Como ves, <strong>las propiedades</strong> <code>header, numContacas, formHidden, contacts ...</code> se corresponden con las utilizadas en las directivas de enlace en la vista. <strong>Los mtodos</strong> <code>saveContact(), deleteContact()</code> son invocados desde eventos de elementos del <em>html</em>.</p><p>Juntos, <strong>la vista y su clase controladora</strong>, resuelven un problema de interaccin con el usuario <strong>creando un componente</strong>. Todas las pginas que disees sern variaciones y composiciones de estos componentes.</p><blockquote><p>Y esto es slo el comienzo. La idea de componente ser fundamental en la web del maana para la creacin de pginas mediante <code>web components</code>. Pero eso ya se ver ms adelante</p></blockquote><p>Ahora tienes una aplicacin en <em>Angular 7</em> que recoge y muestra datos. Sigue esta serie para aadirle <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a> mientras aprendes a programar con Angular7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-3_data.png\" alt=\"formularios-tablas-y-modelos-de-datos-en-angular\"></p><p>Las <strong>aplicaciones Angular 7 son excelentes para el tratamiento de datos</strong> en el navegador. Su razn de ser fue la recogida de informacin mediante formularios y la presentacin de pginas dinmicas de forma sencilla.</p><p>Vamos a ver cmo la librera <code>@angular/forms</code> enlaza <strong>las vistas, los controladores y los modelos</strong>; y cmo se hace la presentacin de datos en <strong>listas y tablas</strong>.</p>","more":"<p>Partiendo de la aplicacin tal cmo qued en <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a>, al finalizar tendrs una aplicacin que recoge y presenta datos.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: [AcademiaBinaria/angular-board/3-data]<a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/3-data/contacts\" target=\"_blank\" rel=\"noopener\">https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/3-data/contacts</a>)</p></blockquote><h1 id=\"1-Binding\"><a href=\"#1-Binding\" class=\"headerlink\" title=\"1. Binding\"></a>1. Binding</h1><h2 id=\"1-0-Base\"><a href=\"#1-0-Base\" class=\"headerlink\" title=\"1.0 Base\"></a>1.0 Base</h2><p><strong>Los formularios son el punto de entrada</strong> de informacin a nuestros sistemas. Llevan con nosotros desde el inicio de la propia informtica y se han comido una buena parte del tiempo de programacin. En <em>Angular</em> han prestado una especial atencin a ellos facilitando su desarrollo, <strong>desde pantallas simples hasta complejos procesos</strong>.</p><p>Para empezar crearemos un proceso sencillo. algo que permita mantener una lista de contactos empresariales. Con lo aprendido en el tema de <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a> creamos un par de ficheros.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m contacts --routing <span class=\"literal\">true</span></span><br><span class=\"line\">ng g c contacts/contacts</span><br></pre></td></tr></table></figure><p>Y asignamos sus rutas delegadas en <code>app-routing</code> y en <code>contacts-routing</code>:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app-routing</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'contacts'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"string\">'./contacts/contacts.module#ContactsModule'</span></span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"><span class=\"comment\">// contacts-routing</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">''</span>,</span><br><span class=\"line\">  component: ContactsComponent</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y finalizamos con un enlace en el <code>HeaderComponent</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"contacts\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> Contacts<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La clave para entender cmo funciona <em>Angular</em> est en el concepto de <strong>enlace entre elementos html de las vistas y propiedades de modelos</strong> de datos, el llamado <code>binding</code>.</p><p>Para realizar el <em>binding</em> usaremos <strong>directivas</strong> en ambos sentidos.</p><h2 id=\"1-1-Enlace-del-modelo-hacia-la-vista\"><a href=\"#1-1-Enlace-del-modelo-hacia-la-vista\" class=\"headerlink\" title=\"1.1 Enlace del modelo hacia la vista\"></a>1.1 Enlace del modelo hacia la vista</h2><p>Vamos a crear un pequeo modelo de datos. Para empezar agregamos algunas propiedades. En <code>contacts.component.ts</code>:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> header = <span class=\"string\">'Contacts'</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> description = <span class=\"string\">'Manage your contact list'</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> numContacts = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> counterClass = <span class=\"string\">'tag secondary'</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> formHidden = <span class=\"literal\">false</span>;</span><br></pre></td></tr></table></figure><p>En <code>contacts.component.html</code> mostramos cabeceras con estilo</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>&#123;&#123; header &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; description | uppercase &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  You have</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">mark</span> [<span class=\"attr\">class</span>]=<span class=\"string\">\"counterClass\"</span>&gt;</span>&#123;&#123; numContacts &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">mark</span>&gt;</span></span><br><span class=\"line\">  contacts right now.</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"La-interpolacion-entre\"><a href=\"#La-interpolacion-entre\" class=\"headerlink\" title=\"La interpolacin entre { { } }\"></a>La interpolacin entre { { } }</h3><p>En el fichero <code>contacts.component.ts</code> tienes en su vista <em>html</em> encontrars elementos ajenos al lenguaje. Son las directivas. La primera que encuentras es <code></code>. Esas dobles llaves encierran expresiones que se evaluarn en tiempo de ejecucin. La llamamos <strong>directiva de interpolacin</strong> y es la manera ms cmoda y usual de mostrar contenido dinmico en Angular.</p><blockquote><p>La expresin interna hace referencia a variables que se obtienen de las propiedades de la clase controladora del componente. En este caso <code>ContactsComponent</code> y <code>header</code>, con su valor <em>Contacts</em> en ejecucin. Este enlace mantiene la vista permanentemente actualizada a travs de un potente sistema de deteccin del cambio.</p></blockquote><h3 id=\"Las-tuberias\"><a href=\"#Las-tuberias\" class=\"headerlink\" title=\"Las tuberas |\"></a>Las tuberas |</h3><p>Si queremos que la presentacin del dato sea distinta a su valor real, podemos usar <strong>funciones de transformacin</strong> especiales. Se llaman tuberas o <em>pipes</em> y se indican mediante el carcter <code>|</code>.</p><p>El <em>framework</em> nos provee de casos bsicos como <code>uppercase, lowercase, date, number...</code>. Tambin dispones de un mecanismo para crear tus propios <em>pipes</em>.</p><h3 id=\"Los-atributos-evaluados\"><a href=\"#Los-atributos-evaluados\" class=\"headerlink\" title=\"Los atributos evaluados []\"></a>Los atributos evaluados []</h3><p>En <em>Html</em> disponemos de atributos para asignar valores a propiedades de los elementos. Esos atributos reciben los valores como constantes. Pero, si se encierran entre corchetes se convierten en un <strong>evaluador de expresiones</strong> y puede recibir una variable o cualquier otra expresin.</p><p>Como por ejemplo usando una <em>clase css</em> cuyo valor cambia en tiempo de ejecucin. O para deshabilitar un elemento dinmicamente.</p><h2 id=\"1-2-Enlace-de-la-vista-hacia-el-modelo\"><a href=\"#1-2-Enlace-de-la-vista-hacia-el-modelo\" class=\"headerlink\" title=\"1.2 Enlace de la vista hacia el modelo\"></a>1.2 Enlace de la vista hacia el modelo</h2><p>En <code>contacts.component.html</code> tambin actuamos sobre la vista, para manipular el modelo y de vuelta a la vista. Por ejemplo con mecanismo simple de ocultacin de un elemento.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Show Form\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"formHidden = false\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Hide Form\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"formHidden = true\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> [<span class=\"attr\">ngClass</span>]=<span class=\"string\">\"&#123; 'hidden' : formHidden &#125;\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">legend</span>&gt;</span>Contact Form<span class=\"tag\">&lt;/<span class=\"name\">legend</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"Las-clases-CSS-como-atributos-especiales\"><a href=\"#Las-clases-CSS-como-atributos-especiales\" class=\"headerlink\" title=\"Las clases CSS como atributos especiales\"></a>Las clases CSS como atributos especiales</h3><p>Para el caso concreto de determinar las clases CSS aplicables a un elemento de manera dinmica, usaremos la directiva <code>ngClass</code>. La cual recibe un objeto cuyas propiedades son nombres de clases CSS y sus valores son expresiones booleanas. Si se cumplen se aplica la clase y si no, se quita la clase.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[ngClass]=\"&#123; 'hidden' : formHidden &#125;\"</span><br></pre></td></tr></table></figure><p>En este caso se oculta el elemento dependiendo del valor de la expresin <code>formHidden</code>. Pero Cmo se manipula esa variable?</p><h3 id=\"Los-eventos\"><a href=\"#Los-eventos\" class=\"headerlink\" title=\"Los eventos ()\"></a>Los eventos ()</h3><p>Cualquier evento asociado a un elemento puede ejecutar una instruccin sin ms que incluirlo entre parntesis. Idealmente dicha instruccin debe llamar a un mtodo o funcin de la clase controladora. Aunque si es trivial puedes dejarla en el Html.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(click)=\"formHidden = true\"</span><br></pre></td></tr></table></figure><h1 id=\"2-Doble-Binding\"><a href=\"#2-Doble-Binding\" class=\"headerlink\" title=\"2. Doble Binding\"></a>2. Doble Binding</h1><p>La comunicacin del modelo hacia la vista es slo el principio. En <em>Angular</em> tambin podrs <strong>comunicar la vista hacia el modelo</strong>, permitindole al usuario modificar los datos a travs de formularios. Es lo que se conoce como <em>double binding</em>.</p><h2 id=\"2-1-El-doble-enlace-al-modelo-ngModel\"><a href=\"#2-1-El-doble-enlace-al-modelo-ngModel\" class=\"headerlink\" title=\"2.1 El doble enlace al modelo [(ngModel)]\"></a>2.1 El doble enlace al modelo [(ngModel)]</h2><p>La directiva <code>[(ngModel)]</code> se compone de un atributo <em>custom</em> <code>ngModel</code> y lo rodea de los smbolos <code>[()]</code>. Esta tcnica es conocida como <em>banana in a box</em> porque su sintaxis requiere un <code>()</code> dentro de un <code>[]</code> y une las capacidades de las expresiones y los eventos facilitando la comunicacin bidireccional.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[(ngModel)]=\"model.property\"</span><br></pre></td></tr></table></figure><p>Usa la comunicacin en ambos sentidos</p><ul><li><strong>(banana)</strong> : de la vista al modelo</li><li><strong>[box]</strong> : del modelo a la vista</li></ul><blockquote><p>Atencin: La directiva <code>ngModel</code> viene dentro del mdulo <code>FormsModule</code> que hay que importar explcitamente.</p></blockquote><p>Por ejemplo <code>[(ngModel)]=&quot;contact.name&quot;</code> enlaza doblemente la propiedad del modelo <code>contact.name</code> con el elemento <code>&lt;input&gt;</code> de la vista. Cada tecleo del usuario se registra en la variable. Y el valor de la variable se muestra en el <code>&lt;input&gt;</code>.</p><p>Dada un modelo como este en <code>contacts.component.ts</code>:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span> &#125;;</span><br></pre></td></tr></table></figure><p>Podemos enlazarlos en la plantilla</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"name\"</span>&gt;</span>Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.name\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"Contact name\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Es muy til mantener en desarrollo un espa visual de lo que est pasando con los datos. Algunas extensiones como <a href=\"https://augury.rangle.io/\" target=\"_blank\" rel=\"noopener\">Augury</a> aportan muchas ms prestaciones, pero al empezar el <em>pipe json</em> te ayudar mucho.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; contact | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La directiva <code>ngModel</code> es mucho ms potente de lo visto aqu. Entre otras cosas permite decidir el criterio de actualizacin (a cada cambio o al salir del control). Tambin se ver ms adelante el asunto de la validacin, que requiere un trato especial. Cuando empiezas con Angular Forms, <strong>un input y su ngModel</strong> asociado sern tus mejores amigos.</p><h2 id=\"2-2-Form\"><a href=\"#2-2-Form\" class=\"headerlink\" title=\"2.2 Form\"></a>2.2 Form</h2><p>Hay ms usos de las directivas en los formularios. Por ejemplo, dado el siguiente modelo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span>, isVIP: <span class=\"literal\">false</span>, gender: <span class=\"string\">''</span> &#125;;</span><br></pre></td></tr></table></figure><p>Le vendra muy bien un <em>check box</em>.</p><h3 id=\"CheckBox\"><a href=\"#CheckBox\" class=\"headerlink\" title=\"CheckBox\"></a>CheckBox</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"isVIP\"</span>&gt;</span>Is V.I.P.<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"isVIP\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"checkbox\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.isVIP\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y un para de <em>radio buttons</em>.</p><h3 id=\"Radio-Buttons\"><a href=\"#Radio-Buttons\" class=\"headerlink\" title=\"Radio Buttons\"></a>Radio Buttons</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"gender\"</span>&gt;</span>Gender<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"gender\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"male\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"radio\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.gender\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>Male<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"gender\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"female\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"radio\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.gender\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>Female<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"3-Estructuras\"><a href=\"#3-Estructuras\" class=\"headerlink\" title=\"3 Estructuras\"></a>3 Estructuras</h1><p>Los anteriores modificadores actan a nivel de contenido del HTML. Veremos ahora una para de directivas que afectan directamente a <strong>la estructura del rbol DOM</strong>. Son las llamadas directivas estructurales que comienzan por el signo <code>*</code></p><h2 id=\"3-1-Repetitivas-ngFor\"><a href=\"#3-1-Repetitivas-ngFor\" class=\"headerlink\" title=\"3.1 Repetitivas *ngFor\"></a>3.1 Repetitivas *ngFor</h2><p>Una situacin que nos encontramos una y otra vez es la de las repeticiones. Listas de datos, tablas o grupos de opciones son ejemplos claros. Hay una directiva en <em>Angular</em> para esa situacin, la <code>*ngFor=&quot;let iterador of array&quot;</code>. <strong>La directiva <code>*ngFor</code> forma parte del grupo de directivas estructurales</strong>, porque modifica la estructura del DOM, en este caso insertando mltiples nodos hijos a un elemento dado.</p><blockquote><p>Puedes ver un ejemplo del uso la directiva <code>*ngFor</code> en el componente <code>ContactsComponent</code>. Se emplea para recorrer un array de tipos de estado laboral. Es el caso de uso <em>ms repetido de las repeticiones</em>; mostrar listas de datos.</p></blockquote><p>Dado el siguiente modelo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses = [</span><br><span class=\"line\">  &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">  &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123; name: <span class=\"string\">''</span>, isVIP: <span class=\"literal\">false</span>, gender: <span class=\"string\">''</span>, workStatus: <span class=\"number\">0</span> &#125;;</span><br></pre></td></tr></table></figure><p>Montamos las opciones de un <em>select</em> html recorriendo el array y usando el iterador <code>wkSt</code> para acceder a sus datos.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"workStatus\"</span>&gt;</span>Work Status<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">name</span>=<span class=\"string\">\"workStatus\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.workStatus\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">option</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let wkSt of workStatuses\"</span> [<span class=\"attr\">value</span>]=<span class=\"string\">\"wkSt.id\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; wkSt.description &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"3-2-Condicionales-ngIf\"><a href=\"#3-2-Condicionales-ngIf\" class=\"headerlink\" title=\"3.2 Condicionales *ngIf\"></a>3.2 Condicionales *ngIf</h2><p>La directiva estructural ms utilizada es la <code>*ngIf</code>, la cual consigue que un elemento se incluya o se elimine en el <em>DOM</em> en funcin de los datos del modelo.</p><blockquote><p>En el ejemplo puedes ver que la uso para mostrar el campo empresa cuando el contacto est trabajando. En otro aparecer el campo de estudios.</p></blockquote><p>Dado el siguiente modelo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> contact = &#123;</span><br><span class=\"line\">  name: <span class=\"string\">''</span>,</span><br><span class=\"line\">  isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">  gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">  workStatus: <span class=\"string\">'0'</span>,</span><br><span class=\"line\">  company: <span class=\"string\">''</span>,</span><br><span class=\"line\">  education: <span class=\"string\">''</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"contact.workStatus=='3'; else education\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"company\"</span>&gt;</span>Company Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"company\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.company\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ng-template</span> #<span class=\"attr\">education</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"education\"</span>&gt;</span>Education<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"education\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"contact.education\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>if <strong>condition</strong> else <strong>template</strong></p></blockquote><h3 id=\"Identificadores-con-hashtag\"><a href=\"#Identificadores-con-hashtag\" class=\"headerlink\" title=\"Identificadores con hashtag\"></a>Identificadores con hashtag</h3><p>En el cdigo anterior apreciars que aparece un elemento <code>&lt;ng-template&gt;</code> no estndar con el atributo llamado <code>#education</code> precedido por un <code>#</code>. La directiva <code>#</code> genera un identificador nico para el elemento al que se le aplica y permite referirse a l en otros lugares del cdigo.</p><p>Ese truco permite que <code>*ngIf</code> muestre otro elemento cuando la condicin principal falle. El otro elemento tiene que ser el componente especial <code>&lt;ng-template&gt;</code> que se usa para envolver una rama opcional del DOM. Para localizarlo se usa el identificador <code>#</code>.</p><h1 id=\"4-Modelo-y-controlador\"><a href=\"#4-Modelo-y-controlador\" class=\"headerlink\" title=\"4 Modelo y controlador\"></a>4 Modelo y controlador</h1><p>Los componentes los hemos definido como <strong>bloques de construccin de pginas. Mediante una vista y un controlador</strong> resuelven un problema de interaccin o presentacin de modelos. En los puntos anteriores te present la vista. Toca ahora estudiar el modelo y el controlador.</p><h2 id=\"4-1-El-modelo-y-su-interInterfaces-y-modelos\"><a href=\"#4-1-El-modelo-y-su-interInterfaces-y-modelos\" class=\"headerlink\" title=\"4.1 El modelo y su interInterfaces y modelos\"></a>4.1 El modelo y su interInterfaces y modelos</h2><p>Sin ir muy lejos en las capacidades que tendra un modelo de datos clsico, vamos al menos a beneficiarnos del <strong><em>TypeScript</em> para definir la estructura de datos</strong>. Esto facilitar la programacin mediante el autocompletado del editor y reducir los errores de tecleo mediante la comprobacin esttica de tipos.</p><p>Para ello necesito una interfaz sencilla. Esto es puro <em>TypeScript</em>, no es ningn artificio registrable en Angular. Esos s, en algn sitio tienen que estar. Yo suelo usar una ruta como <code>contacts/models</code>, pero es algo completamente arbitrario.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Option &#123;</span><br><span class=\"line\">  id: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  description: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Contact &#123;</span><br><span class=\"line\">  name: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  isVIP: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  gender: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  workStatus: <span class=\"built_in\">number</span> | <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  company: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  education: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Te recomiendo que <strong>no uses clases para definir modelos</strong> a menos que necesites agregarle funcionalidad imprescindible. Las interfaces, ayudan al control de tipos en tiempo de desarrollo, igual que las clases, pero sin generar nada de cdigo en tiempo de ejecucin, al contrario que las clases. Ojo al uso de tipos compuestos como <code>number | string</code></p></blockquote><p>Se usan para tipificar las propiedades que conforman nuestro modelo para la vista.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses: Option[] = [</span><br><span class=\"line\">    &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">  ];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact: Contact = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">''</span>,</span><br><span class=\"line\">    isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">    workStatus: <span class=\"number\">0</span>,</span><br><span class=\"line\">    company: <span class=\"string\">''</span>,</span><br><span class=\"line\">    education: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"><span class=\"keyword\">public</span> contacts: Contact[] = [];</span><br></pre></td></tr></table></figure><h2 id=\"4-2-ViewModel-en-el-controlador\"><a href=\"#4-2-ViewModel-en-el-controlador\" class=\"headerlink\" title=\"4.2 ViewModel en el controlador\"></a>4.2 ViewModel en el controlador</h2><p>La parte de <strong>lgica del componente</strong> va en la clase que se usa para su definicin. Como ya has visto podemos usar su constructor para reclamar dependencias y usar los interfaces para responder a eventos de su ciclo de vida. Repasemos el <code>ContactsComponent</code> vindolo como la clase que es: no solo propiedades, tambin <strong>mtodos</strong></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> saveContact() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts.push(&#123; ...this.contact &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.numContacts = <span class=\"keyword\">this</span>.contacts.length;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora se trata de invocar el mtodo desde la vista. Es muy buena prctica llevar la lgica al controlador y no escribirla en la vista.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Save\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"submit\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"saveContact()\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>Podemos decir que las propiedades pblicas de la clase actuarn como <em>binding</em> de datos con la vista. Mientras que los mtodos pblicos sern invocados desde los eventos de la misma vista.</p><h3 id=\"OnInit\"><a href=\"#OnInit\" class=\"headerlink\" title=\"OnInit\"></a>OnInit</h3><p>Los componentes son clases con un <strong>ciclo de vida</strong> al que puedes enganchar tu cdigo en algunos pasos. Por ejemplo al iniciarse el componente.</p><p>El CLI hace que las clase del componente implemente la interfaz <code>OnInit</code> y eso permite al framework invocar al mtodo <code>ngOnInit</code> en cuanto el componente est listo para su uso. Que no suele ser justo durante la construccin, si no un poco despus. Te recomiendo que lleves toda la lgica de inicializacin a dicho mtodo.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> workStatuses: Option[];</span><br><span class=\"line\"><span class=\"keyword\">public</span> contact: Contact;</span><br><span class=\"line\"><span class=\"keyword\">public</span> contacts: Contact[];</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.workStatuses = [</span><br><span class=\"line\">    &#123; id: <span class=\"number\">0</span>, description: <span class=\"string\">'unknow'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">1</span>, description: <span class=\"string\">'student'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">2</span>, description: <span class=\"string\">'unemployed'</span> &#125;,</span><br><span class=\"line\">    &#123; id: <span class=\"number\">3</span>, description: <span class=\"string\">'employed'</span> &#125;</span><br><span class=\"line\">  ];</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contact = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">''</span>,</span><br><span class=\"line\">    isVIP: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    gender: <span class=\"string\">''</span>,</span><br><span class=\"line\">    workStatus: <span class=\"number\">0</span>,</span><br><span class=\"line\">    company: <span class=\"string\">''</span>,</span><br><span class=\"line\">    education: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts = [];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h3 id=\"Un-listado-de-repaso\"><a href=\"#Un-listado-de-repaso\" class=\"headerlink\" title=\"Un listado de repaso\"></a>Un listado de repaso</h3><p>Para mostrar lo que ahora estamos guardando en una lista, nada ms sencillo que usar de nuevo a <code>*nFor</code> y a <code>*ngIf</code> para tratar listas vacas.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> *<span class=\"attr\">ngIf</span>=<span class=\"string\">\"contacts.length&gt;0; else empty\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let contact of contacts\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; contact.name &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Delete\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"deleteContact(contact)\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ng-template</span> #<span class=\"attr\">empty</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>No data yet<span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y ya puestos incluso puedes animarte a borrar contactos. Es fcil, los mtodos pueden recibir argumentos. Y la vista los puede enviar.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> deleteContact(contact: Contact) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.contacts = <span class=\"keyword\">this</span>.contacts.filter(<span class=\"function\"><span class=\"params\">c</span> =&gt;</span> c.name !== contact.name);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.numContacts = <span class=\"keyword\">this</span>.contacts.length;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Mira el cdigo completo de <strong>la clase</strong> <code>ContactsComponent</code>en el fichero <code>contacts.component.ts</code> para tener una visin completa del componente. Como ves, <strong>las propiedades</strong> <code>header, numContacas, formHidden, contacts ...</code> se corresponden con las utilizadas en las directivas de enlace en la vista. <strong>Los mtodos</strong> <code>saveContact(), deleteContact()</code> son invocados desde eventos de elementos del <em>html</em>.</p><p>Juntos, <strong>la vista y su clase controladora</strong>, resuelven un problema de interaccin con el usuario <strong>creando un componente</strong>. Todas las pginas que disees sern variaciones y composiciones de estos componentes.</p><blockquote><p>Y esto es slo el comienzo. La idea de componente ser fundamental en la web del maana para la creacin de pginas mediante <code>web components</code>. Pero eso ya se ver ms adelante</p></blockquote><p>Ahora tienes una aplicacin en <em>Angular 7</em> que recoge y muestra datos. Sigue esta serie para aadirle <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a> mientras aprendes a programar con Angular7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Servicios inyectables en Angular","date":"2019-02-15T08:54:58.000Z","thumbnail":"/css/images/angular-5_inject.png","_content":"\n![servicios-inyectables-en-Angular](/images/tutorial-angular-5_inject.png)\n\nLa presentacin, la lgica y el manejo de datos son tres capas de abstraccin que usamos los programadores para mantener organizado nuestro cdigo. En Angular, la presentacin es cosa de los componentes. **La lgica y los datos tienen su lugar en servicios compartidos**.\n\nPara que los componentes consuman los servicios de forma controlada tenemos proveedores _inyectables_ en la librera `@angular/core` con los que realizar **la inyeccin de dependencias**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/). Al finalizar tendrs una aplicacin que comunica componentes entre pginas, reparte responsabilidades y gestiona claramente sus dependencias.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/5-inject](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/5-inject/converter)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n# 1. Inyeccin de dependencias\n\nComo casi todo en Angular, **los servicios son clases TypeScript**. Su propsito es contener lgica de negocio, clases para acceso a datos o utilidades de infraestructura. Estas clases son perfectamente instanciables desde cualquier otro fichero que las importe. Pero Angular nos sugiere y facilita que usemos su sistema de inyeccin de dependencias.\n\nEste sistema se basa en convenios y configuraciones que controlan la instancia concreta que ser inyectada al objeto dependiente. Ahora vers cmo funciona la **[Dependency Injection](https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias) en Angular**.\n\nComo demostracin vamos a trabajar con un par de utilidades para conversin de unidades. Crear un mdulo y un componente en el que visualizarlo.\n\n```shell\nng g m 5-inject/converter --routing true\nng g c 5-inject/converter/converter\n```\n\n## 1.1 Generacin de servicios\n\nLa particularidad de las clases de servicios est en su decorador: `@Injectable()`. Esta funcin viene en el `@angular/core` e **indica que esta clase puede ser inyectada** dinmicamente a quien la demande. Aunque es muy sencillo crearlos a mano, el CLI nos ofrece su comando especializado para crear servicios. Estos son ejemplos de instrucciones para crear un _service_.\n\n```shell\nng g s 5-inject/converter/converter\n```\n\nEl resultado es el fichero `converter.service.ts` con su decorador que toma una _class_ normal y produce algo _injectable_. Veamos una implementacin mnima:\n\n```typescript\nimport { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConverterService {\n  constructor() {}\n\n  public fromKilometersToMiles = kilometers => kilometers * 0.62137;\n}\n```\n\nAhora tienes centralizado en este servicio la lgica de datos que tenemos hasta el momento. Los dems componentes la podrn utilizar.\n\n## 1.2 Consumo de dependencias\n\nDeclarar y decorar la clase no es suficiente para poder reclamarla. Necesitas **registrarla como un proveedor en algn mdulo**. Desde Angular 6 los servicios se auto-proveen en el mdulo raz mediante la configuracin `providedIn: 'root'` de su decorador.\n\n> Esto es til y cmodo en una gran cantidad de casos. El mdulo raz es visible para toda la aplicacin de forma que cualquier componente puede reclamar un servicio suyo sin problema. Excepto que el problema sea el tamao. El mdulo raz se carga al arrancar y todas sus referencias van el _bundle_ principal. Si queremos repartir el peso debemos llevar ciertos servicios al mdulo funcional que los necesite.\n\nVamos a consumir este servicio en el `converter.component.ts`. Al consumo de los servicios inyectables se le conoce como _dependencia_. Cada componente o servicio puede **declarar en su constructor sus dependencias** hacia servicios inyectables. El convenio exige que se especifique el tipo esperado\n\n```typescript\nexport class ConverterComponent implements OnInit {\n  public kilometers = 0;\n  public miles: number;\n\n  constructor(private converterService: ConverterService) {}\n\n  public ngOnInit() {\n    this.convert();\n  }\n\n  public convert() {\n    this.miles = this.converterService.fromKilometersToMiles(this.kilometers);\n  }\n}\n```\n\n> Agregar el modificador de alcance `private` o `public` en la declaracin de argumentos hace que _TypeScript_ genere una propiedad inicializada con el valor recibido. Es azcar sintctico para no tener que declarar la propiedad y asignarle el valor del argumento manualmente. En resumen, los [constructores en TypeScrip](https://kendaleiv.com/typescript-constructor-assignment-public-and-private-keywords/) admiten argumentos que transforman en propiedades. Mantenemos privado el `converterService` para evitar su uso desde la vista.\n\n```html\n<h2>Distance Converter.</h2>\n<h3>From Europe to USA</h3>\n<form>\n  <fieldset>\n    <section>\n      <label for=\"kilometers\">Kilometers</label>\n      <input name=\"kilometers\" type=\"number\" [(ngModel)]=\"kilometers\" placeholder=\"0\" />\n    </section>\n  </fieldset>\n  <input value=\"Convert\" type=\"button\" (click)=\"convert()\" />\n</form>\n<section>\n  <h4>{{ miles | number:'1.2-2' }} miles</h4>\n</section>\n```\n\n# 2. Inversin del control\n\nUn concepto ntimamente relacionado con la inyeccin de dependencias es el de [**Inversion of Control**](https://en.wikipedia.org/wiki/Inversion_of_control). El componente dependiente expresa sus necesidades, pero es el _framework_ el que en ltima instancia decide lo que recibir. Vemos entonces que **el invocado cede el control al invocador**.\n\nCuando proveemos un servicio en Angular, el comportamiento por defecto es el de proveer un _singleton_ pero hay ms opciones. Si se usa el objeto `provider` con `useClass` , `useValue` y `useFactory` podemos controlar el proceso de inyeccin.\n\nSe crea un [_singleton_](https://es.wikipedia.org/wiki/Singleton) por cada mdulo en el que se provea un servicio. Normalmente si el servicio es para un slo mdulo funcional se provee en este y nada ms. Si va a ser compartido gana la opcin de auto proveerlo en el raz, garantizando as su disponibilidad en cualquier otro mdulo de la aplicacin.\n\nEn un mdulo cualquiera, siempre podramos agregar un servicio a su array de _providers_.\n\n```typescript\n@NgModule({\n  declarations: [...],\n  imports: [...],\n  providers: [ ConverterService ]\n})\n```\n\nPero siempre ser **una instancia nica por mdulo**. Si un _singleton_ no es lo adecuado, entonces puedes proveer el mismo servicio en distintos mdulos. De esa forma se crear una instancia distinta para cada uno. Si se provee la misma clase en dos o ms mdulos se genera una instancia en cada uno de ellos. Los componentes recibirn la instancia del mdulo jerrquicamente ms cercano.\n\n> Incluso es posible usar el array `providers:[]` en la decoracin de un componente o de otro servicio. Haciendo as an ms granular la eleccin de instancia.\n\nVeamos un ejemplo extendiendo el problema del conversor de unidades de forma que se pueda escoger una **estrategia** de conversin en base a una cultura concreta. Para empezar necesitamos una interfaz, un servicio base que la implemente y un componente que lo consuma.\n\n```shell\nng g interface 5-inject/converter/culture-converter\nng g service 5-inject/converter/culture-converter\nng g component 5-inject/converter/culture-converter\n```\n\n```typeScript\nexport interface CultureConverter implements CultureConverter {\n  sourceCulture: string;\n  targetCulture: string;\n  convertDistance: (source: number) => number;\n  convertTemperature: (source: number) => number;\n}\n```\n\n```typescript\nexport class CultureConverterService implements CultureConverter {\n  sourceCulture: string;\n  targetCulture: string;\n  convertDistance: (source: number) => number;\n  convertTemperature: (source: number) => number;\n\n  constructor() {}\n}\n```\n\n```typeScript\nexport class CultureConverterComponent implements OnInit {\n  public source: string;\n  public target: string;\n  public sourceUnits = 0;\n  public targetUnits: number;\n\n  constructor(private cultureConverterService:CultureConverterService){ }\n\n  public ngOnInit() {\n    this.source = this.cultureConverterService.sourceCulture;\n    this.target = this.cultureConverterService.targetCulture;\n    this.convert();\n  }\n  public convert() {\n    this.targetUnits = this.cultureConverterService.convertDistance(this.sourceUnits);\n  }\n}\n```\n\n```html\n<h2>Culture Converter.</h2>\n<h3>From {{ source }} to {{ target }}</h3>\n<form>\n  <fieldset>\n    <section>\n      <label for=\"sourceUnits\">Distance</label>\n      <input name=\"sourceUnits\" type=\"number\" [(ngModel)]=\"sourceUnits\" placeholder=\"0\" />\n    </section>\n  </fieldset>\n  <input value=\"Convert\" type=\"button\" (click)=\"convert()\" />\n</form>\n<section>\n  <h4>Distance {{ targetUnits | number:'1.2-2' }}</h4>\n</section>\n```\n\n## 2.2 Implementaciones\n\nEl `CultureConverterComponent` depende de `CultureConverterService` el cual implementa de forma abstracta la interfaz `CultureConverter`. Pero eso no es para nada funcional. Vamos a crear dos implementaciones especficas para Europa y USA. Estas clases concretas se apoyarn en el anteriormente creado `ConverterService` que necesita algo ms de cdigo.\n\n```typescript\nexport class ConverterService {\n  constructor() {}\n\n  public fromKilometersToMiles = kilometers => kilometers * 0.62137;\n\n  public fromMilesToKilometers = miles => miles * 1.609;\n\n  public fromCelsiusToFarenheit = celsius => celsius * (9 / 5) + 32;\n\n  public fromFarenheitToCelsius = farenheit => (farenheit - 32) * (5 / 9);\n}\n```\n\nY aqu estn las dos servicios concretos.\n\n```typescript\n@Injectable()\nexport class EuropeConverterService {\n  sourceCulture = 'USA';\n  targetCulture = 'Europe';\n  constructor(private converterService: ConverterService) {}\n  convertDistance = this.converterService.fromMilesToKilometers;\n  convertTemperature = this.converterService.fromFarenheitToCelsius;\n}\n```\n\n```typescript\n@Injectable()\nexport class UsaConverterService implements CultureConverter {\n  sourceCulture = 'Europe';\n  targetCulture = 'USA';\n  constructor(private converterService: ConverterService) {}\n  convertDistance = this.converterService.fromKilometersToMiles;\n  convertTemperature = this.converterService.fromCelsiusToFarenheit;\n}\n```\n\n## 2.3 Provisin manual\n\nPor ejemplo si queremos utilizar la implementacin concreta de USA lo indicamos en el mdulo que lo consuma.\n\n```typescript\n{\n  providers: [\n    {\n      provide: CultureConverterService,\n      useClass: UsaConverterService,\n    },\n  ];\n}\n```\n\nEl componente reclama una instancia de `CultureConverterService` y le damos otra con la misma interfaz. De esta forma podramos tener mdulos distintos, cada uno con su propia estrategia de conversin.\n\n## 2.4 Factora\n\nUna situacin muy comn es poder elegir dinmicamente la implementacin concreta. Para ello necesitamos una funcin factora que con alguna lgica escoja la estrategia concreta.\n\n```typescript\nconst cultureFactory = (converterService: ConverterService) => {\n  if (environment.unitsCulture === 'metric') {\n    return new EuropeConverterService(converterService);\n  } else {\n    return new UsaConverterService(converterService);\n  }\n};\n{\n  providers: [\n    {\n      provide: CultureConverterService,\n      useFactory: cultureFactory,\n      deps: [ConverterService],\n    },\n  ];\n}\n```\n\nDe esta forma la aplicacin se comportar distinto en funcin de una variable de entorno.\n\nYa tenemos la aplicacin mucho mejor estructurada, pero el almacn de datos es mejorable. Se mantienen los datos _hard-coded_, muy incmodo para actualizar; y en memoria, poco fiable y voltil. Lo ms habitual es guardar y recuperar la informacin en un servidor _http_. Sigue esta serie para aadir [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/) mientras aprendes a programar con Angular.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-5-Servicios-inyectables-en-Angular.md","raw":"---\ntitle: Servicios inyectables en Angular\npermalink: servicios-inyectables-en-Angular\ndate: 2019-02-15 9:54:58\ntags:\n  - Angular\n  - Servicios\n  - DI\n  - Tutorial\n  - Introduccin\n  - Angular7\n  - Angular2\ncategories:\n  - [Tutorial, Angular]\nthumbnail: /css/images/angular-5_inject.png\n---\n\n![servicios-inyectables-en-Angular](/images/tutorial-angular-5_inject.png)\n\nLa presentacin, la lgica y el manejo de datos son tres capas de abstraccin que usamos los programadores para mantener organizado nuestro cdigo. En Angular, la presentacin es cosa de los componentes. **La lgica y los datos tienen su lugar en servicios compartidos**.\n\nPara que los componentes consuman los servicios de forma controlada tenemos proveedores _inyectables_ en la librera `@angular/core` con los que realizar **la inyeccin de dependencias**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Flujo de datos entre componentes Angular](../flujo-de-datos-entre-componentes-angular/). Al finalizar tendrs una aplicacin que comunica componentes entre pginas, reparte responsabilidades y gestiona claramente sus dependencias.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/5-inject](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/5-inject/converter)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n# 1. Inyeccin de dependencias\n\nComo casi todo en Angular, **los servicios son clases TypeScript**. Su propsito es contener lgica de negocio, clases para acceso a datos o utilidades de infraestructura. Estas clases son perfectamente instanciables desde cualquier otro fichero que las importe. Pero Angular nos sugiere y facilita que usemos su sistema de inyeccin de dependencias.\n\nEste sistema se basa en convenios y configuraciones que controlan la instancia concreta que ser inyectada al objeto dependiente. Ahora vers cmo funciona la **[Dependency Injection](https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias) en Angular**.\n\nComo demostracin vamos a trabajar con un par de utilidades para conversin de unidades. Crear un mdulo y un componente en el que visualizarlo.\n\n```shell\nng g m 5-inject/converter --routing true\nng g c 5-inject/converter/converter\n```\n\n## 1.1 Generacin de servicios\n\nLa particularidad de las clases de servicios est en su decorador: `@Injectable()`. Esta funcin viene en el `@angular/core` e **indica que esta clase puede ser inyectada** dinmicamente a quien la demande. Aunque es muy sencillo crearlos a mano, el CLI nos ofrece su comando especializado para crear servicios. Estos son ejemplos de instrucciones para crear un _service_.\n\n```shell\nng g s 5-inject/converter/converter\n```\n\nEl resultado es el fichero `converter.service.ts` con su decorador que toma una _class_ normal y produce algo _injectable_. Veamos una implementacin mnima:\n\n```typescript\nimport { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConverterService {\n  constructor() {}\n\n  public fromKilometersToMiles = kilometers => kilometers * 0.62137;\n}\n```\n\nAhora tienes centralizado en este servicio la lgica de datos que tenemos hasta el momento. Los dems componentes la podrn utilizar.\n\n## 1.2 Consumo de dependencias\n\nDeclarar y decorar la clase no es suficiente para poder reclamarla. Necesitas **registrarla como un proveedor en algn mdulo**. Desde Angular 6 los servicios se auto-proveen en el mdulo raz mediante la configuracin `providedIn: 'root'` de su decorador.\n\n> Esto es til y cmodo en una gran cantidad de casos. El mdulo raz es visible para toda la aplicacin de forma que cualquier componente puede reclamar un servicio suyo sin problema. Excepto que el problema sea el tamao. El mdulo raz se carga al arrancar y todas sus referencias van el _bundle_ principal. Si queremos repartir el peso debemos llevar ciertos servicios al mdulo funcional que los necesite.\n\nVamos a consumir este servicio en el `converter.component.ts`. Al consumo de los servicios inyectables se le conoce como _dependencia_. Cada componente o servicio puede **declarar en su constructor sus dependencias** hacia servicios inyectables. El convenio exige que se especifique el tipo esperado\n\n```typescript\nexport class ConverterComponent implements OnInit {\n  public kilometers = 0;\n  public miles: number;\n\n  constructor(private converterService: ConverterService) {}\n\n  public ngOnInit() {\n    this.convert();\n  }\n\n  public convert() {\n    this.miles = this.converterService.fromKilometersToMiles(this.kilometers);\n  }\n}\n```\n\n> Agregar el modificador de alcance `private` o `public` en la declaracin de argumentos hace que _TypeScript_ genere una propiedad inicializada con el valor recibido. Es azcar sintctico para no tener que declarar la propiedad y asignarle el valor del argumento manualmente. En resumen, los [constructores en TypeScrip](https://kendaleiv.com/typescript-constructor-assignment-public-and-private-keywords/) admiten argumentos que transforman en propiedades. Mantenemos privado el `converterService` para evitar su uso desde la vista.\n\n```html\n<h2>Distance Converter.</h2>\n<h3>From Europe to USA</h3>\n<form>\n  <fieldset>\n    <section>\n      <label for=\"kilometers\">Kilometers</label>\n      <input name=\"kilometers\" type=\"number\" [(ngModel)]=\"kilometers\" placeholder=\"0\" />\n    </section>\n  </fieldset>\n  <input value=\"Convert\" type=\"button\" (click)=\"convert()\" />\n</form>\n<section>\n  <h4>{{ miles | number:'1.2-2' }} miles</h4>\n</section>\n```\n\n# 2. Inversin del control\n\nUn concepto ntimamente relacionado con la inyeccin de dependencias es el de [**Inversion of Control**](https://en.wikipedia.org/wiki/Inversion_of_control). El componente dependiente expresa sus necesidades, pero es el _framework_ el que en ltima instancia decide lo que recibir. Vemos entonces que **el invocado cede el control al invocador**.\n\nCuando proveemos un servicio en Angular, el comportamiento por defecto es el de proveer un _singleton_ pero hay ms opciones. Si se usa el objeto `provider` con `useClass` , `useValue` y `useFactory` podemos controlar el proceso de inyeccin.\n\nSe crea un [_singleton_](https://es.wikipedia.org/wiki/Singleton) por cada mdulo en el que se provea un servicio. Normalmente si el servicio es para un slo mdulo funcional se provee en este y nada ms. Si va a ser compartido gana la opcin de auto proveerlo en el raz, garantizando as su disponibilidad en cualquier otro mdulo de la aplicacin.\n\nEn un mdulo cualquiera, siempre podramos agregar un servicio a su array de _providers_.\n\n```typescript\n@NgModule({\n  declarations: [...],\n  imports: [...],\n  providers: [ ConverterService ]\n})\n```\n\nPero siempre ser **una instancia nica por mdulo**. Si un _singleton_ no es lo adecuado, entonces puedes proveer el mismo servicio en distintos mdulos. De esa forma se crear una instancia distinta para cada uno. Si se provee la misma clase en dos o ms mdulos se genera una instancia en cada uno de ellos. Los componentes recibirn la instancia del mdulo jerrquicamente ms cercano.\n\n> Incluso es posible usar el array `providers:[]` en la decoracin de un componente o de otro servicio. Haciendo as an ms granular la eleccin de instancia.\n\nVeamos un ejemplo extendiendo el problema del conversor de unidades de forma que se pueda escoger una **estrategia** de conversin en base a una cultura concreta. Para empezar necesitamos una interfaz, un servicio base que la implemente y un componente que lo consuma.\n\n```shell\nng g interface 5-inject/converter/culture-converter\nng g service 5-inject/converter/culture-converter\nng g component 5-inject/converter/culture-converter\n```\n\n```typeScript\nexport interface CultureConverter implements CultureConverter {\n  sourceCulture: string;\n  targetCulture: string;\n  convertDistance: (source: number) => number;\n  convertTemperature: (source: number) => number;\n}\n```\n\n```typescript\nexport class CultureConverterService implements CultureConverter {\n  sourceCulture: string;\n  targetCulture: string;\n  convertDistance: (source: number) => number;\n  convertTemperature: (source: number) => number;\n\n  constructor() {}\n}\n```\n\n```typeScript\nexport class CultureConverterComponent implements OnInit {\n  public source: string;\n  public target: string;\n  public sourceUnits = 0;\n  public targetUnits: number;\n\n  constructor(private cultureConverterService:CultureConverterService){ }\n\n  public ngOnInit() {\n    this.source = this.cultureConverterService.sourceCulture;\n    this.target = this.cultureConverterService.targetCulture;\n    this.convert();\n  }\n  public convert() {\n    this.targetUnits = this.cultureConverterService.convertDistance(this.sourceUnits);\n  }\n}\n```\n\n```html\n<h2>Culture Converter.</h2>\n<h3>From {{ source }} to {{ target }}</h3>\n<form>\n  <fieldset>\n    <section>\n      <label for=\"sourceUnits\">Distance</label>\n      <input name=\"sourceUnits\" type=\"number\" [(ngModel)]=\"sourceUnits\" placeholder=\"0\" />\n    </section>\n  </fieldset>\n  <input value=\"Convert\" type=\"button\" (click)=\"convert()\" />\n</form>\n<section>\n  <h4>Distance {{ targetUnits | number:'1.2-2' }}</h4>\n</section>\n```\n\n## 2.2 Implementaciones\n\nEl `CultureConverterComponent` depende de `CultureConverterService` el cual implementa de forma abstracta la interfaz `CultureConverter`. Pero eso no es para nada funcional. Vamos a crear dos implementaciones especficas para Europa y USA. Estas clases concretas se apoyarn en el anteriormente creado `ConverterService` que necesita algo ms de cdigo.\n\n```typescript\nexport class ConverterService {\n  constructor() {}\n\n  public fromKilometersToMiles = kilometers => kilometers * 0.62137;\n\n  public fromMilesToKilometers = miles => miles * 1.609;\n\n  public fromCelsiusToFarenheit = celsius => celsius * (9 / 5) + 32;\n\n  public fromFarenheitToCelsius = farenheit => (farenheit - 32) * (5 / 9);\n}\n```\n\nY aqu estn las dos servicios concretos.\n\n```typescript\n@Injectable()\nexport class EuropeConverterService {\n  sourceCulture = 'USA';\n  targetCulture = 'Europe';\n  constructor(private converterService: ConverterService) {}\n  convertDistance = this.converterService.fromMilesToKilometers;\n  convertTemperature = this.converterService.fromFarenheitToCelsius;\n}\n```\n\n```typescript\n@Injectable()\nexport class UsaConverterService implements CultureConverter {\n  sourceCulture = 'Europe';\n  targetCulture = 'USA';\n  constructor(private converterService: ConverterService) {}\n  convertDistance = this.converterService.fromKilometersToMiles;\n  convertTemperature = this.converterService.fromCelsiusToFarenheit;\n}\n```\n\n## 2.3 Provisin manual\n\nPor ejemplo si queremos utilizar la implementacin concreta de USA lo indicamos en el mdulo que lo consuma.\n\n```typescript\n{\n  providers: [\n    {\n      provide: CultureConverterService,\n      useClass: UsaConverterService,\n    },\n  ];\n}\n```\n\nEl componente reclama una instancia de `CultureConverterService` y le damos otra con la misma interfaz. De esta forma podramos tener mdulos distintos, cada uno con su propia estrategia de conversin.\n\n## 2.4 Factora\n\nUna situacin muy comn es poder elegir dinmicamente la implementacin concreta. Para ello necesitamos una funcin factora que con alguna lgica escoja la estrategia concreta.\n\n```typescript\nconst cultureFactory = (converterService: ConverterService) => {\n  if (environment.unitsCulture === 'metric') {\n    return new EuropeConverterService(converterService);\n  } else {\n    return new UsaConverterService(converterService);\n  }\n};\n{\n  providers: [\n    {\n      provide: CultureConverterService,\n      useFactory: cultureFactory,\n      deps: [ConverterService],\n    },\n  ];\n}\n```\n\nDe esta forma la aplicacin se comportar distinto en funcin de una variable de entorno.\n\nYa tenemos la aplicacin mucho mejor estructurada, pero el almacn de datos es mejorable. Se mantienen los datos _hard-coded_, muy incmodo para actualizar; y en memoria, poco fiable y voltil. Lo ms habitual es guardar y recuperar la informacin en un servidor _http_. Sigue esta serie para aadir [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/) mientras aprendes a programar con Angular.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"servicios-inyectables-en-Angular","published":1,"updated":"2019-02-20T13:14:18.226Z","_id":"cjbrwpvi7001piwd3nglxcwnn","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-5_inject.png\" alt=\"servicios-inyectables-en-Angular\"></p><p>La presentacin, la lgica y el manejo de datos son tres capas de abstraccin que usamos los programadores para mantener organizado nuestro cdigo. En Angular, la presentacin es cosa de los componentes. <strong>La lgica y los datos tienen su lugar en servicios compartidos</strong>.</p><p>Para que los componentes consuman los servicios de forma controlada tenemos proveedores <em>inyectables</em> en la librera <code>@angular/core</code> con los que realizar <strong>la inyeccin de dependencias</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal cmo qued en <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a>. Al finalizar tendrs una aplicacin que comunica componentes entre pginas, reparte responsabilidades y gestiona claramente sus dependencias.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/5-inject/converter\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/5-inject</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-Inyeccion-de-dependencias\"><a href=\"#1-Inyeccion-de-dependencias\" class=\"headerlink\" title=\"1. Inyeccin de dependencias\"></a>1. Inyeccin de dependencias</h1><p>Como casi todo en Angular, <strong>los servicios son clases TypeScript</strong>. Su propsito es contener lgica de negocio, clases para acceso a datos o utilidades de infraestructura. Estas clases son perfectamente instanciables desde cualquier otro fichero que las importe. Pero Angular nos sugiere y facilita que usemos su sistema de inyeccin de dependencias.</p><p>Este sistema se basa en convenios y configuraciones que controlan la instancia concreta que ser inyectada al objeto dependiente. Ahora vers cmo funciona la <strong><a href=\"https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias\" target=\"_blank\" rel=\"noopener\">Dependency Injection</a> en Angular</strong>.</p><p>Como demostracin vamos a trabajar con un par de utilidades para conversin de unidades. Crear un mdulo y un componente en el que visualizarlo.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m 5-inject/converter --routing true</span><br><span class=\"line\">ng g c 5-inject/converter/converter</span><br></pre></td></tr></table></figure><h2 id=\"1-1-Generacion-de-servicios\"><a href=\"#1-1-Generacion-de-servicios\" class=\"headerlink\" title=\"1.1 Generacin de servicios\"></a>1.1 Generacin de servicios</h2><p>La particularidad de las clases de servicios est en su decorador: <code>@Injectable()</code>. Esta funcin viene en el <code>@angular/core</code> e <strong>indica que esta clase puede ser inyectada</strong> dinmicamente a quien la demande. Aunque es muy sencillo crearlos a mano, el CLI nos ofrece su comando especializado para crear servicios. Estos son ejemplos de instrucciones para crear un <em>service</em>.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s 5-inject/converter/converter</span><br></pre></td></tr></table></figure><p>El resultado es el fichero <code>converter.service.ts</code> con su decorador que toma una <em>class</em> normal y produce algo <em>injectable</em>. Veamos una implementacin mnima:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Injectable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span>,</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ConverterService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> fromKilometersToMiles = <span class=\"function\"><span class=\"params\">kilometers</span> =&gt;</span> kilometers * <span class=\"number\">0.62137</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora tienes centralizado en este servicio la lgica de datos que tenemos hasta el momento. Los dems componentes la podrn utilizar.</p><h2 id=\"1-2-Consumo-de-dependencias\"><a href=\"#1-2-Consumo-de-dependencias\" class=\"headerlink\" title=\"1.2 Consumo de dependencias\"></a>1.2 Consumo de dependencias</h2><p>Declarar y decorar la clase no es suficiente para poder reclamarla. Necesitas <strong>registrarla como un proveedor en algn mdulo</strong>. Desde Angular 6 los servicios se auto-proveen en el mdulo raz mediante la configuracin <code>providedIn: &#39;root&#39;</code> de su decorador.</p><blockquote><p>Esto es til y cmodo en una gran cantidad de casos. El mdulo raz es visible para toda la aplicacin de forma que cualquier componente puede reclamar un servicio suyo sin problema. Excepto que el problema sea el tamao. El mdulo raz se carga al arrancar y todas sus referencias van el <em>bundle</em> principal. Si queremos repartir el peso debemos llevar ciertos servicios al mdulo funcional que los necesite.</p></blockquote><p>Vamos a consumir este servicio en el <code>converter.component.ts</code>. Al consumo de los servicios inyectables se le conoce como <em>dependencia</em>. Cada componente o servicio puede <strong>declarar en su constructor sus dependencias</strong> hacia servicios inyectables. El convenio exige que se especifique el tipo esperado</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ConverterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> kilometers = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> miles: <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> converterService: ConverterService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convert();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> convert() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.miles = <span class=\"keyword\">this</span>.converterService.fromKilometersToMiles(<span class=\"keyword\">this</span>.kilometers);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Agregar el modificador de alcance <code>private</code> o <code>public</code> en la declaracin de argumentos hace que <em>TypeScript</em> genere una propiedad inicializada con el valor recibido. Es azcar sintctico para no tener que declarar la propiedad y asignarle el valor del argumento manualmente. En resumen, los <a href=\"https://kendaleiv.com/typescript-constructor-assignment-public-and-private-keywords/\" target=\"_blank\" rel=\"noopener\">constructores en TypeScrip</a> admiten argumentos que transforman en propiedades. Mantenemos privado el <code>converterService</code> para evitar su uso desde la vista.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Distance Converter.<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>From Europe to USA<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"kilometers\"</span>&gt;</span>Kilometers<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"kilometers\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"kilometers\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Convert\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"convert()\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>&#123;&#123; miles | number:'1.2-2' &#125;&#125; miles<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"2-Inversion-del-control\"><a href=\"#2-Inversion-del-control\" class=\"headerlink\" title=\"2. Inversin del control\"></a>2. Inversin del control</h1><p>Un concepto ntimamente relacionado con la inyeccin de dependencias es el de <a href=\"https://en.wikipedia.org/wiki/Inversion_of_control\" target=\"_blank\" rel=\"noopener\"><strong>Inversion of Control</strong></a>. El componente dependiente expresa sus necesidades, pero es el <em>framework</em> el que en ltima instancia decide lo que recibir. Vemos entonces que <strong>el invocado cede el control al invocador</strong>.</p><p>Cuando proveemos un servicio en Angular, el comportamiento por defecto es el de proveer un <em>singleton</em> pero hay ms opciones. Si se usa el objeto <code>provider</code> con <code>useClass</code> , <code>useValue</code> y <code>useFactory</code> podemos controlar el proceso de inyeccin.</p><p>Se crea un <a href=\"https://es.wikipedia.org/wiki/Singleton\" target=\"_blank\" rel=\"noopener\"><em>singleton</em></a> por cada mdulo en el que se provea un servicio. Normalmente si el servicio es para un slo mdulo funcional se provee en este y nada ms. Si va a ser compartido gana la opcin de auto proveerlo en el raz, garantizando as su disponibilidad en cualquier otro mdulo de la aplicacin.</p><p>En un mdulo cualquiera, siempre podramos agregar un servicio a su array de <em>providers</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [...],</span><br><span class=\"line\">  imports: [...],</span><br><span class=\"line\">  providers: [ ConverterService ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure><p>Pero siempre ser <strong>una instancia nica por mdulo</strong>. Si un <em>singleton</em> no es lo adecuado, entonces puedes proveer el mismo servicio en distintos mdulos. De esa forma se crear una instancia distinta para cada uno. Si se provee la misma clase en dos o ms mdulos se genera una instancia en cada uno de ellos. Los componentes recibirn la instancia del mdulo jerrquicamente ms cercano.</p><blockquote><p>Incluso es posible usar el array <code>providers:[]</code> en la decoracin de un componente o de otro servicio. Haciendo as an ms granular la eleccin de instancia.</p></blockquote><p>Veamos un ejemplo extendiendo el problema del conversor de unidades de forma que se pueda escoger una <strong>estrategia</strong> de conversin en base a una cultura concreta. Para empezar necesitamos una interfaz, un servicio base que la implemente y un componente que lo consuma.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g interface 5-inject/converter/culture-converter</span><br><span class=\"line\">ng g service 5-inject/converter/culture-converter</span><br><span class=\"line\">ng g component 5-inject/converter/culture-converter</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> CultureConverter implements CultureConverter &#123;</span><br><span class=\"line\">  sourceCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  targetCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  convertDistance: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  convertTemperature: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CultureConverterService <span class=\"keyword\">implements</span> CultureConverter &#123;</span><br><span class=\"line\">  sourceCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  targetCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  convertDistance: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  convertTemperature: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CultureConverterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> source: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> target: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> sourceUnits = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> targetUnits: <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> cultureConverterService:CultureConverterService</span>)&#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.source = <span class=\"keyword\">this</span>.cultureConverterService.sourceCulture;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.target = <span class=\"keyword\">this</span>.cultureConverterService.targetCulture;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convert();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> convert() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.targetUnits = <span class=\"keyword\">this</span>.cultureConverterService.convertDistance(<span class=\"keyword\">this</span>.sourceUnits);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Culture Converter.<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>From &#123;&#123; source &#125;&#125; to &#123;&#123; target &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"sourceUnits\"</span>&gt;</span>Distance<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"sourceUnits\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"sourceUnits\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Convert\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"convert()\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>Distance &#123;&#123; targetUnits | number:'1.2-2' &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"2-2-Implementaciones\"><a href=\"#2-2-Implementaciones\" class=\"headerlink\" title=\"2.2 Implementaciones\"></a>2.2 Implementaciones</h2><p>El <code>CultureConverterComponent</code> depende de <code>CultureConverterService</code> el cual implementa de forma abstracta la interfaz <code>CultureConverter</code>. Pero eso no es para nada funcional. Vamos a crear dos implementaciones especficas para Europa y USA. Estas clases concretas se apoyarn en el anteriormente creado <code>ConverterService</code> que necesita algo ms de cdigo.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ConverterService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> fromKilometersToMiles = <span class=\"function\"><span class=\"params\">kilometers</span> =&gt;</span> kilometers * <span class=\"number\">0.62137</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> fromMilesToKilometers = <span class=\"function\"><span class=\"params\">miles</span> =&gt;</span> miles * <span class=\"number\">1.609</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> fromCelsiusToFarenheit = <span class=\"function\"><span class=\"params\">celsius</span> =&gt;</span> celsius * (<span class=\"number\">9</span> / <span class=\"number\">5</span>) + <span class=\"number\">32</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> fromFarenheitToCelsius = <span class=\"function\"><span class=\"params\">farenheit</span> =&gt;</span> (farenheit - <span class=\"number\">32</span>) * (<span class=\"number\">5</span> / <span class=\"number\">9</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y aqu estn las dos servicios concretos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Injectable</span>()</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> EuropeConverterService &#123;</span><br><span class=\"line\">  sourceCulture = <span class=\"string\">'USA'</span>;</span><br><span class=\"line\">  targetCulture = <span class=\"string\">'Europe'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> converterService: ConverterService</span>) &#123;&#125;</span><br><span class=\"line\">  convertDistance = <span class=\"keyword\">this</span>.converterService.fromMilesToKilometers;</span><br><span class=\"line\">  convertTemperature = <span class=\"keyword\">this</span>.converterService.fromFarenheitToCelsius;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Injectable</span>()</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> UsaConverterService <span class=\"keyword\">implements</span> CultureConverter &#123;</span><br><span class=\"line\">  sourceCulture = <span class=\"string\">'Europe'</span>;</span><br><span class=\"line\">  targetCulture = <span class=\"string\">'USA'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> converterService: ConverterService</span>) &#123;&#125;</span><br><span class=\"line\">  convertDistance = <span class=\"keyword\">this</span>.converterService.fromKilometersToMiles;</span><br><span class=\"line\">  convertTemperature = <span class=\"keyword\">this</span>.converterService.fromCelsiusToFarenheit;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Provision-manual\"><a href=\"#2-3-Provision-manual\" class=\"headerlink\" title=\"2.3 Provisin manual\"></a>2.3 Provisin manual</h2><p>Por ejemplo si queremos utilizar la implementacin concreta de USA lo indicamos en el mdulo que lo consuma.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: CultureConverterService,</span><br><span class=\"line\">      useClass: UsaConverterService,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>El componente reclama una instancia de <code>CultureConverterService</code> y le damos otra con la misma interfaz. De esta forma podramos tener mdulos distintos, cada uno con su propia estrategia de conversin.</p><h2 id=\"2-4-Factoria\"><a href=\"#2-4-Factoria\" class=\"headerlink\" title=\"2.4 Factora\"></a>2.4 Factora</h2><p>Una situacin muy comn es poder elegir dinmicamente la implementacin concreta. Para ello necesitamos una funcin factora que con alguna lgica escoja la estrategia concreta.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> cultureFactory = <span class=\"function\">(<span class=\"params\">converterService: ConverterService</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (environment.unitsCulture === <span class=\"string\">'metric'</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> EuropeConverterService(converterService);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> UsaConverterService(converterService);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: CultureConverterService,</span><br><span class=\"line\">      useFactory: cultureFactory,</span><br><span class=\"line\">      deps: [ConverterService],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>De esta forma la aplicacin se comportar distinto en funcin de una variable de entorno.</p><p>Ya tenemos la aplicacin mucho mejor estructurada, pero el almacn de datos es mejorable. Se mantienen los datos <em>hard-coded</em>, muy incmodo para actualizar; y en memoria, poco fiable y voltil. Lo ms habitual es guardar y recuperar la informacin en un servidor <em>http</em>. Sigue esta serie para aadir <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a> mientras aprendes a programar con Angular.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-5_inject.png\" alt=\"servicios-inyectables-en-Angular\"></p><p>La presentacin, la lgica y el manejo de datos son tres capas de abstraccin que usamos los programadores para mantener organizado nuestro cdigo. En Angular, la presentacin es cosa de los componentes. <strong>La lgica y los datos tienen su lugar en servicios compartidos</strong>.</p><p>Para que los componentes consuman los servicios de forma controlada tenemos proveedores <em>inyectables</em> en la librera <code>@angular/core</code> con los que realizar <strong>la inyeccin de dependencias</strong>.</p>","more":"<p>Partiendo de la aplicacin tal cmo qued en <a href=\"../flujo-de-datos-entre-componentes-angular/\">Flujo de datos entre componentes Angular</a>. Al finalizar tendrs una aplicacin que comunica componentes entre pginas, reparte responsabilidades y gestiona claramente sus dependencias.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/5-inject/converter\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/5-inject</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-Inyeccion-de-dependencias\"><a href=\"#1-Inyeccion-de-dependencias\" class=\"headerlink\" title=\"1. Inyeccin de dependencias\"></a>1. Inyeccin de dependencias</h1><p>Como casi todo en Angular, <strong>los servicios son clases TypeScript</strong>. Su propsito es contener lgica de negocio, clases para acceso a datos o utilidades de infraestructura. Estas clases son perfectamente instanciables desde cualquier otro fichero que las importe. Pero Angular nos sugiere y facilita que usemos su sistema de inyeccin de dependencias.</p><p>Este sistema se basa en convenios y configuraciones que controlan la instancia concreta que ser inyectada al objeto dependiente. Ahora vers cmo funciona la <strong><a href=\"https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias\" target=\"_blank\" rel=\"noopener\">Dependency Injection</a> en Angular</strong>.</p><p>Como demostracin vamos a trabajar con un par de utilidades para conversin de unidades. Crear un mdulo y un componente en el que visualizarlo.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m 5-inject/converter --routing true</span><br><span class=\"line\">ng g c 5-inject/converter/converter</span><br></pre></td></tr></table></figure><h2 id=\"1-1-Generacion-de-servicios\"><a href=\"#1-1-Generacion-de-servicios\" class=\"headerlink\" title=\"1.1 Generacin de servicios\"></a>1.1 Generacin de servicios</h2><p>La particularidad de las clases de servicios est en su decorador: <code>@Injectable()</code>. Esta funcin viene en el <code>@angular/core</code> e <strong>indica que esta clase puede ser inyectada</strong> dinmicamente a quien la demande. Aunque es muy sencillo crearlos a mano, el CLI nos ofrece su comando especializado para crear servicios. Estos son ejemplos de instrucciones para crear un <em>service</em>.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s 5-inject/converter/converter</span><br></pre></td></tr></table></figure><p>El resultado es el fichero <code>converter.service.ts</code> con su decorador que toma una <em>class</em> normal y produce algo <em>injectable</em>. Veamos una implementacin mnima:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Injectable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span>,</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ConverterService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> fromKilometersToMiles = <span class=\"function\"><span class=\"params\">kilometers</span> =&gt;</span> kilometers * <span class=\"number\">0.62137</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora tienes centralizado en este servicio la lgica de datos que tenemos hasta el momento. Los dems componentes la podrn utilizar.</p><h2 id=\"1-2-Consumo-de-dependencias\"><a href=\"#1-2-Consumo-de-dependencias\" class=\"headerlink\" title=\"1.2 Consumo de dependencias\"></a>1.2 Consumo de dependencias</h2><p>Declarar y decorar la clase no es suficiente para poder reclamarla. Necesitas <strong>registrarla como un proveedor en algn mdulo</strong>. Desde Angular 6 los servicios se auto-proveen en el mdulo raz mediante la configuracin <code>providedIn: &#39;root&#39;</code> de su decorador.</p><blockquote><p>Esto es til y cmodo en una gran cantidad de casos. El mdulo raz es visible para toda la aplicacin de forma que cualquier componente puede reclamar un servicio suyo sin problema. Excepto que el problema sea el tamao. El mdulo raz se carga al arrancar y todas sus referencias van el <em>bundle</em> principal. Si queremos repartir el peso debemos llevar ciertos servicios al mdulo funcional que los necesite.</p></blockquote><p>Vamos a consumir este servicio en el <code>converter.component.ts</code>. Al consumo de los servicios inyectables se le conoce como <em>dependencia</em>. Cada componente o servicio puede <strong>declarar en su constructor sus dependencias</strong> hacia servicios inyectables. El convenio exige que se especifique el tipo esperado</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ConverterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> kilometers = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> miles: <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> converterService: ConverterService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convert();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> convert() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.miles = <span class=\"keyword\">this</span>.converterService.fromKilometersToMiles(<span class=\"keyword\">this</span>.kilometers);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Agregar el modificador de alcance <code>private</code> o <code>public</code> en la declaracin de argumentos hace que <em>TypeScript</em> genere una propiedad inicializada con el valor recibido. Es azcar sintctico para no tener que declarar la propiedad y asignarle el valor del argumento manualmente. En resumen, los <a href=\"https://kendaleiv.com/typescript-constructor-assignment-public-and-private-keywords/\" target=\"_blank\" rel=\"noopener\">constructores en TypeScrip</a> admiten argumentos que transforman en propiedades. Mantenemos privado el <code>converterService</code> para evitar su uso desde la vista.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Distance Converter.<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>From Europe to USA<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"kilometers\"</span>&gt;</span>Kilometers<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"kilometers\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"kilometers\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Convert\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"convert()\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>&#123;&#123; miles | number:'1.2-2' &#125;&#125; miles<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"2-Inversion-del-control\"><a href=\"#2-Inversion-del-control\" class=\"headerlink\" title=\"2. Inversin del control\"></a>2. Inversin del control</h1><p>Un concepto ntimamente relacionado con la inyeccin de dependencias es el de <a href=\"https://en.wikipedia.org/wiki/Inversion_of_control\" target=\"_blank\" rel=\"noopener\"><strong>Inversion of Control</strong></a>. El componente dependiente expresa sus necesidades, pero es el <em>framework</em> el que en ltima instancia decide lo que recibir. Vemos entonces que <strong>el invocado cede el control al invocador</strong>.</p><p>Cuando proveemos un servicio en Angular, el comportamiento por defecto es el de proveer un <em>singleton</em> pero hay ms opciones. Si se usa el objeto <code>provider</code> con <code>useClass</code> , <code>useValue</code> y <code>useFactory</code> podemos controlar el proceso de inyeccin.</p><p>Se crea un <a href=\"https://es.wikipedia.org/wiki/Singleton\" target=\"_blank\" rel=\"noopener\"><em>singleton</em></a> por cada mdulo en el que se provea un servicio. Normalmente si el servicio es para un slo mdulo funcional se provee en este y nada ms. Si va a ser compartido gana la opcin de auto proveerlo en el raz, garantizando as su disponibilidad en cualquier otro mdulo de la aplicacin.</p><p>En un mdulo cualquiera, siempre podramos agregar un servicio a su array de <em>providers</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [...],</span><br><span class=\"line\">  imports: [...],</span><br><span class=\"line\">  providers: [ ConverterService ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure><p>Pero siempre ser <strong>una instancia nica por mdulo</strong>. Si un <em>singleton</em> no es lo adecuado, entonces puedes proveer el mismo servicio en distintos mdulos. De esa forma se crear una instancia distinta para cada uno. Si se provee la misma clase en dos o ms mdulos se genera una instancia en cada uno de ellos. Los componentes recibirn la instancia del mdulo jerrquicamente ms cercano.</p><blockquote><p>Incluso es posible usar el array <code>providers:[]</code> en la decoracin de un componente o de otro servicio. Haciendo as an ms granular la eleccin de instancia.</p></blockquote><p>Veamos un ejemplo extendiendo el problema del conversor de unidades de forma que se pueda escoger una <strong>estrategia</strong> de conversin en base a una cultura concreta. Para empezar necesitamos una interfaz, un servicio base que la implemente y un componente que lo consuma.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g interface 5-inject/converter/culture-converter</span><br><span class=\"line\">ng g service 5-inject/converter/culture-converter</span><br><span class=\"line\">ng g component 5-inject/converter/culture-converter</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> CultureConverter implements CultureConverter &#123;</span><br><span class=\"line\">  sourceCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  targetCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  convertDistance: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  convertTemperature: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CultureConverterService <span class=\"keyword\">implements</span> CultureConverter &#123;</span><br><span class=\"line\">  sourceCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  targetCulture: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  convertDistance: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  convertTemperature: <span class=\"function\">(<span class=\"params\">source: <span class=\"built_in\">number</span></span>) =&gt;</span> <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CultureConverterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> source: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> target: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> sourceUnits = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> targetUnits: <span class=\"built_in\">number</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> cultureConverterService:CultureConverterService</span>)&#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.source = <span class=\"keyword\">this</span>.cultureConverterService.sourceCulture;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.target = <span class=\"keyword\">this</span>.cultureConverterService.targetCulture;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.convert();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> convert() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.targetUnits = <span class=\"keyword\">this</span>.cultureConverterService.convertDistance(<span class=\"keyword\">this</span>.sourceUnits);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Culture Converter.<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>From &#123;&#123; source &#125;&#125; to &#123;&#123; target &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"sourceUnits\"</span>&gt;</span>Distance<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"sourceUnits\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"sourceUnits\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Convert\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"convert()\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>Distance &#123;&#123; targetUnits | number:'1.2-2' &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"2-2-Implementaciones\"><a href=\"#2-2-Implementaciones\" class=\"headerlink\" title=\"2.2 Implementaciones\"></a>2.2 Implementaciones</h2><p>El <code>CultureConverterComponent</code> depende de <code>CultureConverterService</code> el cual implementa de forma abstracta la interfaz <code>CultureConverter</code>. Pero eso no es para nada funcional. Vamos a crear dos implementaciones especficas para Europa y USA. Estas clases concretas se apoyarn en el anteriormente creado <code>ConverterService</code> que necesita algo ms de cdigo.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ConverterService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> fromKilometersToMiles = <span class=\"function\"><span class=\"params\">kilometers</span> =&gt;</span> kilometers * <span class=\"number\">0.62137</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> fromMilesToKilometers = <span class=\"function\"><span class=\"params\">miles</span> =&gt;</span> miles * <span class=\"number\">1.609</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> fromCelsiusToFarenheit = <span class=\"function\"><span class=\"params\">celsius</span> =&gt;</span> celsius * (<span class=\"number\">9</span> / <span class=\"number\">5</span>) + <span class=\"number\">32</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> fromFarenheitToCelsius = <span class=\"function\"><span class=\"params\">farenheit</span> =&gt;</span> (farenheit - <span class=\"number\">32</span>) * (<span class=\"number\">5</span> / <span class=\"number\">9</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y aqu estn las dos servicios concretos.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Injectable</span>()</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> EuropeConverterService &#123;</span><br><span class=\"line\">  sourceCulture = <span class=\"string\">'USA'</span>;</span><br><span class=\"line\">  targetCulture = <span class=\"string\">'Europe'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> converterService: ConverterService</span>) &#123;&#125;</span><br><span class=\"line\">  convertDistance = <span class=\"keyword\">this</span>.converterService.fromMilesToKilometers;</span><br><span class=\"line\">  convertTemperature = <span class=\"keyword\">this</span>.converterService.fromFarenheitToCelsius;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Injectable</span>()</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> UsaConverterService <span class=\"keyword\">implements</span> CultureConverter &#123;</span><br><span class=\"line\">  sourceCulture = <span class=\"string\">'Europe'</span>;</span><br><span class=\"line\">  targetCulture = <span class=\"string\">'USA'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> converterService: ConverterService</span>) &#123;&#125;</span><br><span class=\"line\">  convertDistance = <span class=\"keyword\">this</span>.converterService.fromKilometersToMiles;</span><br><span class=\"line\">  convertTemperature = <span class=\"keyword\">this</span>.converterService.fromCelsiusToFarenheit;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Provision-manual\"><a href=\"#2-3-Provision-manual\" class=\"headerlink\" title=\"2.3 Provisin manual\"></a>2.3 Provisin manual</h2><p>Por ejemplo si queremos utilizar la implementacin concreta de USA lo indicamos en el mdulo que lo consuma.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: CultureConverterService,</span><br><span class=\"line\">      useClass: UsaConverterService,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>El componente reclama una instancia de <code>CultureConverterService</code> y le damos otra con la misma interfaz. De esta forma podramos tener mdulos distintos, cada uno con su propia estrategia de conversin.</p><h2 id=\"2-4-Factoria\"><a href=\"#2-4-Factoria\" class=\"headerlink\" title=\"2.4 Factora\"></a>2.4 Factora</h2><p>Una situacin muy comn es poder elegir dinmicamente la implementacin concreta. Para ello necesitamos una funcin factora que con alguna lgica escoja la estrategia concreta.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> cultureFactory = <span class=\"function\">(<span class=\"params\">converterService: ConverterService</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (environment.unitsCulture === <span class=\"string\">'metric'</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> EuropeConverterService(converterService);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> UsaConverterService(converterService);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: CultureConverterService,</span><br><span class=\"line\">      useFactory: cultureFactory,</span><br><span class=\"line\">      deps: [ConverterService],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>De esta forma la aplicacin se comportar distinto en funcin de una variable de entorno.</p><p>Ya tenemos la aplicacin mucho mejor estructurada, pero el almacn de datos es mejorable. Se mantienen los datos <em>hard-coded</em>, muy incmodo para actualizar; y en memoria, poco fiable y voltil. Lo ms habitual es guardar y recuperar la informacin en un servidor <em>http</em>. Sigue esta serie para aadir <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a> mientras aprendes a programar con Angular.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Vigilancia y seguridad en Angular","date":"2019-03-06T17:49:27.000Z","thumbnail":"/css/images/angular-7_watch.png","_content":"\n![vigilancia-y-seguridad-en-Angular](/images/tutorial-angular-7_watch.png)\n\nLa **vigilancia** de los datos y la informacin en tiempo real al usuario son dos pilares del desarrollo con Angular en el lado del navegador. La **seguridad** de los datos realmente es una responsabilidad compartida entre el servidor y el cliente.\n\nVeremos ambos aspectos del desarrollo, pues estn muy relacionados con la programacin asncrona y el dominio de los observables. Sentaremos las bases para unas **comunicaciones seguras y fluidas en Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Comunicaciones http en Angular](../comunicaciones-http-en-Angular/). Al finalizar tendrs una aplicacin que comunica a los usuarios cualquier informacin relevante y que gestiona de forma centralizada las respuestas de un servicio REST.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/7-watch](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/7-watch/notifications)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n# 1. Observables para monitorizar datos\n\nHemos visto varias tcnicas para comunicar informacin dentro de una aplicacin Angular. Empezamos por conocer el [flujo entre componentes](../flujo-de-datos-entre-componentes-angular/) de una misma rama del DOM. Tambin enviamos datos en los [parmetros de una ruta](../paginas-y-rutas-angular-spa/). Y obviamente podemos usar [un servicio comn](../servicios-inyectables-en-Angular/) para guardar informacin compartida. Pero en este caso, Cundo se actualiza? Cmo saber si ha cambiado?. Lo resolveremos con `Observables`.\n\nPara ilustrar este tema vamos a crear un sencillo sistema de notificaciones que informe al usuario. Empezaremos creando un mdulo para los propsitos de este laboratorio.\n\n```console\nng g m notifications --routing true\nng g c notifications/sender\nng g c notifications/receiver\n```\n\nLo apuntamos al enrutador global `app-routing.module.ts` y asignamos las rutas locales\n\n```typescript\n{\n  path: 'notifications',\n  loadChildren: './notifications/notifications.module#NotificationsModule'\n},\n```\n```typescript\nconst routes: Routes = [\n  {\n    path: 'sender',\n    component: SenderComponent\n  },\n  {\n    path: 'receiver',\n    component: ReceiverComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'sender'\n  }\n];\n```\n\nPor ltimo un enlace en el men principal `header.component.html` y ya estamos listos para enviar y recibir desde dos componente desacoplados.\n\n```html\n<a routerLink=\"notifications\" class=\"button\">Notifications</a>\n```\n\nPero antes un poco ms de observables.\n\n## 1.1 Productores de observables\n\nLa librera [RxJS](https://www.learnrxjs.io/) es enorme y Angular hace un uso extenso de ella. En este tutorial [se ha visto desde el punto de vista del consumidor](../comunicaciones-http-en-Angular). Es decir, nos hemos suscrito a fuentes observables. Para avanzar tendremos que poder emitir, o mejor dicho producir, informacin.\n\n### Of y from\n\nLos constructores ms sencillos de la librera son **funciones que emiten valores estticos** o secuencias a intervalos regulares. Para familiarizarte con ellos te propongo que juegues con cdigo como este:\n\n```typescript\nvalue$ = of(new Date().getMilliseconds());\nvalue$.subscribe(r=> console.log(r));\nstream$ = from([1, 'two', '***']);\nstream$.subscribe(r=> console.log(r));\nlist$ = of(['N', 'S', 'E', 'W']);\nlist$.subscribe(r=> console.log(r));\n```\n\n### Subject y BehaviorSubject\n\nLos anteriores constructores se basan en datos estticos. Resuelvan algunas situaciones, pero necesitamos algo que emita **cambios dinmicos**. Y eso se realiza con los _Subjects_, una especie de emisores temticos a los que suscribirse.\n\nHay varios tipos pero para empezar nos vamos a fijar en dos: el `Subject()` y el `BehaviorSubject(initialData)`. La diferencia es que el primero slo emite las cosas segn ocurren. Si alguien se suscribe tarde no conocer el pasado. Esto suele generar problemas de sincronizacin. El _Behavior_ en cambio notifica el ltimo valor conocido a cualquiera que se suscriba. De esa forma no importa si te suscribes antes o despus de la obtencin de un dato.\n\nJuega con el siguiente ejemplo:\n\n```typescript\nconst data = {name:'', value:0};\n\nconst need_sync$ = new Subject<any>();\n// on time\nneed_sync.subscribe(r=> console.log(r));\nneed_sync.next(data);\n// too late\nneed_sync.subscribe(r=> console.log(r));\n\nconst no_hurry$ = new BehaviorSubject<any>(this.data);\n// its ok\nno_hurry.subscribe(r=> console.log(r));\nno_hurry.next(data);\n// its also ok\nno_hurry.subscribe(r=> console.log(r));\n```\n\n## 1.2 Un Store de notificaciones\n\nUsaremos el `BehaviorSubject` como notificador principal entre componentes de Angular. Por ejemplo podemos montar un sistema de notificaciones sencillo. Empecemos por crear un servicio:\n\n```console\nng g s notifications/notificationsStore\n```\n\n> Para adaptarnos a la nomenclatura usada por patrones de gestin de estado ms avanzados como es **Redux**, usar el siguiente convenio: _Store_ como almacn, _select$()_ como publicador de cambios observable y _dispatch_ como encargado de procesar una accin de cambio de estado.\n\n```typescript\nexport class NotificationsStoreService {\n  private notifications = [];\n\n  private notifications$ = new BehaviorSubject<any[]>([]);\n\n  constructor() {}\n\n  public select$ = () => this.notifications$.asObservable();\n\n  public dispatch(notification) {\n    this.notifications.push(notification);\n    this.notifications$.next([...this.notifications]);\n  }\n}\n```\n\nEste servicio es la implementacin ms sencilla posible de un gestor de estados. Cabe destacar que :\n\n- Mantienen el estado privado para evitar manipulaciones\n- Recibe de forma controlada las acciones de cambio\n- Emite clones del estado\n- Expone observables para que se suscriban los interesados.\n\n\n## 1.3 Desacoplados pero conectados\n\nUna vez que hemos centralizado el control de cambios de una parte de la aplicacin, es hora de que lo usen los componentes o servicios involucrados. Solo necesitan recibir la instancia va dependencia. **No hay ms acoplamiento entre emisores y receptores.**\n\n### Emisin\n\nVeamos un ejemplo, un tanto forzado,  consistente en dos componentes que se comunican sin conocerse. Esta es la vista con un formulario para enviar mensajes\n\n```html\n<h2>\n  Notes sender\n</h2>\n<form>\n  <fieldset>\n    <section>\n      <label for=\"note\">Note</label>\n      <input name=\"note\"\n             [(ngModel)]=\"note\" />\n    </section>\n  </fieldset>\n  <button (click)=\"send()\">Send</button>\n</form>\n<a [routerLink]=\"['../receiver']\">Go to receiver</a>\n```\n\nLa parte interesante est en el controlador. Dependencia y uso del servicio del almacn de notificaciones\n\n```typescript\nexport class SenderComponent implements OnInit {\n  public note = '';\n\n  constructor(private notificationsStore: NotificationsStoreService) {}\n\n  ngOnInit() {}\n\n  public send() {\n    this.notificationsStore.dispatch(this.note);\n  }\n}\n```\n\n### Recepcin\n\nLa recepcin es igual de sencilla. En la vista pondremos un listado de notificaciones que se alimenta de un array emitido por un observable.\n\n```html\n<h2>\n  Notes receiver\n</h2>\n<ul>\n  <li *ngFor=\"let note of notes$ | async\">{{ note | json }}</li>\n</ul>\n<a [routerLink]=\"['../sender']\">Go to sender</a>\n```\n\nY en el controlador reclamamos la misma dependencia para el uso del servicio del almacn de notificaciones.\n\n```typescript\nexport class ReceiverComponent implements OnInit {\n  public notes$;\n\n  constructor(private notificationsStore: NotificationsStoreService) {}\n\n  ngOnInit() {\n    this.notes$ = this.notificationsStore.select$();\n  }\n}\n```\n\nEs importante recalcar que **no importa el orden de suscripcin**. Estos dos componentes podran _vivir_ en mdulos distintos, verse en la misma pgina o inicializarse en cualquier orden... El receptor se entera siempre de todos los cambios; y adems recibe el ltimo estado conocido nada ms suscribirse.\n\n# 2. Interceptores para gestionar errores\n\nHemos conocido a los interceptores y vemos su potencial para manipular las respuestas de una API. Quiz uno de los usos ms frecuentes se el de **centralizar la gestin de errores**. Veamos como hacerlo usando el conocimiento de los observables.\n\nPara empezar hay que generar un servicio...\n\n```\nng g s notifications/errorInterceptor\n\n```\nluego hay que hacerle cumplir la interfaz `HttpInterceptor`...\n\n```typescript\nexport class ErrorInterceptorService implements HttpInterceptor {\n  constructor() {}\n\n  public intercept(req: HttpRequest<any>, next: HttpHandler)\n    : Observable<HttpEvent<any>> {\n    return next.handle(req);\n  }\n}\n```\ny para finalizar lo proveemos hacia el `HttpClient` invirtiendo el control.\n\n```typescript\n@NgModule({\n  declarations: [SenderComponent, ReceiverComponent],\n  imports: [\n    CommonModule,\n    NotificationsRoutingModule,\n    HttpClientModule,\n    FormsModule\n  ],\n  providers: [\n    {\n      provide: HTTP_INTERCEPTORS,\n      useClass: ErrorInterceptorService,\n      multi: true\n    }\n  ]\n})\nexport class NotificationsModule {}\n```\n\n## 2.1 El operador catchError\n\nVolvemos a los observables y los operadores canalizables en `.pipe()`. Durante su ejecucin un _stream_ de observables puede emitir valores correctos, una seal de finalizacin... y cmo no, errores. El mtodo `.subscribe(ok, err, end)` y operadores como `.map(ok, err, end)` admiten hasta tres _callbacks_ que se llamarn segn los tipos de sucesos descritos. Pero para tratar el caso concreto de los errores vamos a ver el operador `catchError()`.\n\nPor ejemplo durante la intercepcin de respuestas podemos realizar una funcin especfica al recibir un cdigo de error. Dadas estas tres alternativas, escogeremos segn la intencin o la tecnologa que ms nos guste.\n\n```typescript\npublic intercept(req, next) {\n   // implementacin con .tap()\n   return next.handle(req).pipe(tap(null, err=>console.log(err)));\n   // implementacin con catchError retornando nulo\n   return next.handle(req).pipe(catchError(err => of(null)));\n   // implementacin con catchError re-lanzando el error\n   return next.handle(req).pipe(catchError(err => throwError(err)));\n}\n```\n\n## 2.2 Gestin centralizada de errores\n\nQuizs una de las ms usadas sea auditar el error y reenviarlo al llamante original por si quiere hacer algo ms con el mismo.\n\n```typescript\npublic intercept(req, next) {\n  return next.handle(req).pipe(catchError(this.handleError));\n}\n\nprivate handleError(err) {\n  const unauthorized_code = 401;\n  let userMessage = 'Fatal error';\n  if (err instanceof HttpErrorResponse) {\n    if (err.status === unauthorized_code) {\n      userMessage = 'Authorization needed';\n    } else {\n      userMessage = 'Comunications error';\n    }\n  }\n  console.log(userMessage);\n  return throwError(err);\n}\n```\n\nPero an mejor que solo escribir en el _log_, sera avisar al usuario; pero dnde y cmo?\n\n# 3. Un notificador de problemas\n\nLa idea es usar el `NotificationsStoreService` desde el interceptor para... en fin, notificar que ha habido un error.\n\n## 3.1 Emisin mediante el Store\n\n```typescript\n// dependencia en el constructor\nconstructor(private notificationsStore: NotificationsStoreService) {}\n\npublic intercept(req, next) {\n  // Ojo al bind(this), necesario para no perder el contexto\n  return next.handle(req).pipe(catchError(this.handleError.bind(this)));\n}\n\nprivate handleError(err) {\n  let userMessage = 'Fatal error';\n  // emisin de la notificacin\n  this.notificationsStore.dispatch(userMessage);\n}\n```\n\n\n## 3.2 Recepcin desacoplada del interceptor\n\nY ahora ya slo queda suscribirse a los eventos y mostrarlos al usuario. Por ejemplo, desde el `ReceiverComponent`, podemos lanzar llamadas que sabemos que darn problemas y esperar pacientemente el fallo para mostrarlo al usuario.\n\n```html\n<button (click)=\"forceError()\">Force http Error</button>\n```\n\n```TypeScript\npublic forceError() {\n  const privateUrl = 'https://api-base.herokuapp.com/api/priv/secrets';\n  this.httpClient.get(privateUrl).subscribe();\n  const notFoundUrl = 'https://api-base.herokuapp.com/api/pub/items/9';\n  this.httpClient.get(notFoundUrl).subscribe();\n}\n```\n\nTenemos ahora a nuestro usuario puntualmente informado de todo lo que sucede. Hemos utilizado **patrones de arquitectura de software** como el observable y la inversin del control. El resultado es una serie de componentes y servicios poco acoplados que intercambian informacin en tiempo real.\n\nPero hay temas ms avanzados con los que continuar. Sigue esta serie para introducir ms temas de seguridad y crear tus [formularios reactivos con Angular](../formularios-reactivos-con-Angular/) mientras aprendes a programar con Angular.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-7-Vigilancia-y-seguridad-en-Angular.md","raw":"---\ntitle: Vigilancia y seguridad en Angular\npermalink: vigilancia-y-seguridad-en-Angular\ndate: 2019-03-06 18:49:27\ntags:\n- Angular\n- http\n- Observables\n- Tutorial\n- Introduccin\n- Angular7\n- Angular2\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-7_watch.png\n---\n\n![vigilancia-y-seguridad-en-Angular](/images/tutorial-angular-7_watch.png)\n\nLa **vigilancia** de los datos y la informacin en tiempo real al usuario son dos pilares del desarrollo con Angular en el lado del navegador. La **seguridad** de los datos realmente es una responsabilidad compartida entre el servidor y el cliente.\n\nVeremos ambos aspectos del desarrollo, pues estn muy relacionados con la programacin asncrona y el dominio de los observables. Sentaremos las bases para unas **comunicaciones seguras y fluidas en Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Comunicaciones http en Angular](../comunicaciones-http-en-Angular/). Al finalizar tendrs una aplicacin que comunica a los usuarios cualquier informacin relevante y que gestiona de forma centralizada las respuestas de un servicio REST.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/7-watch](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/7-watch/notifications)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n# 1. Observables para monitorizar datos\n\nHemos visto varias tcnicas para comunicar informacin dentro de una aplicacin Angular. Empezamos por conocer el [flujo entre componentes](../flujo-de-datos-entre-componentes-angular/) de una misma rama del DOM. Tambin enviamos datos en los [parmetros de una ruta](../paginas-y-rutas-angular-spa/). Y obviamente podemos usar [un servicio comn](../servicios-inyectables-en-Angular/) para guardar informacin compartida. Pero en este caso, Cundo se actualiza? Cmo saber si ha cambiado?. Lo resolveremos con `Observables`.\n\nPara ilustrar este tema vamos a crear un sencillo sistema de notificaciones que informe al usuario. Empezaremos creando un mdulo para los propsitos de este laboratorio.\n\n```console\nng g m notifications --routing true\nng g c notifications/sender\nng g c notifications/receiver\n```\n\nLo apuntamos al enrutador global `app-routing.module.ts` y asignamos las rutas locales\n\n```typescript\n{\n  path: 'notifications',\n  loadChildren: './notifications/notifications.module#NotificationsModule'\n},\n```\n```typescript\nconst routes: Routes = [\n  {\n    path: 'sender',\n    component: SenderComponent\n  },\n  {\n    path: 'receiver',\n    component: ReceiverComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'sender'\n  }\n];\n```\n\nPor ltimo un enlace en el men principal `header.component.html` y ya estamos listos para enviar y recibir desde dos componente desacoplados.\n\n```html\n<a routerLink=\"notifications\" class=\"button\">Notifications</a>\n```\n\nPero antes un poco ms de observables.\n\n## 1.1 Productores de observables\n\nLa librera [RxJS](https://www.learnrxjs.io/) es enorme y Angular hace un uso extenso de ella. En este tutorial [se ha visto desde el punto de vista del consumidor](../comunicaciones-http-en-Angular). Es decir, nos hemos suscrito a fuentes observables. Para avanzar tendremos que poder emitir, o mejor dicho producir, informacin.\n\n### Of y from\n\nLos constructores ms sencillos de la librera son **funciones que emiten valores estticos** o secuencias a intervalos regulares. Para familiarizarte con ellos te propongo que juegues con cdigo como este:\n\n```typescript\nvalue$ = of(new Date().getMilliseconds());\nvalue$.subscribe(r=> console.log(r));\nstream$ = from([1, 'two', '***']);\nstream$.subscribe(r=> console.log(r));\nlist$ = of(['N', 'S', 'E', 'W']);\nlist$.subscribe(r=> console.log(r));\n```\n\n### Subject y BehaviorSubject\n\nLos anteriores constructores se basan en datos estticos. Resuelvan algunas situaciones, pero necesitamos algo que emita **cambios dinmicos**. Y eso se realiza con los _Subjects_, una especie de emisores temticos a los que suscribirse.\n\nHay varios tipos pero para empezar nos vamos a fijar en dos: el `Subject()` y el `BehaviorSubject(initialData)`. La diferencia es que el primero slo emite las cosas segn ocurren. Si alguien se suscribe tarde no conocer el pasado. Esto suele generar problemas de sincronizacin. El _Behavior_ en cambio notifica el ltimo valor conocido a cualquiera que se suscriba. De esa forma no importa si te suscribes antes o despus de la obtencin de un dato.\n\nJuega con el siguiente ejemplo:\n\n```typescript\nconst data = {name:'', value:0};\n\nconst need_sync$ = new Subject<any>();\n// on time\nneed_sync.subscribe(r=> console.log(r));\nneed_sync.next(data);\n// too late\nneed_sync.subscribe(r=> console.log(r));\n\nconst no_hurry$ = new BehaviorSubject<any>(this.data);\n// its ok\nno_hurry.subscribe(r=> console.log(r));\nno_hurry.next(data);\n// its also ok\nno_hurry.subscribe(r=> console.log(r));\n```\n\n## 1.2 Un Store de notificaciones\n\nUsaremos el `BehaviorSubject` como notificador principal entre componentes de Angular. Por ejemplo podemos montar un sistema de notificaciones sencillo. Empecemos por crear un servicio:\n\n```console\nng g s notifications/notificationsStore\n```\n\n> Para adaptarnos a la nomenclatura usada por patrones de gestin de estado ms avanzados como es **Redux**, usar el siguiente convenio: _Store_ como almacn, _select$()_ como publicador de cambios observable y _dispatch_ como encargado de procesar una accin de cambio de estado.\n\n```typescript\nexport class NotificationsStoreService {\n  private notifications = [];\n\n  private notifications$ = new BehaviorSubject<any[]>([]);\n\n  constructor() {}\n\n  public select$ = () => this.notifications$.asObservable();\n\n  public dispatch(notification) {\n    this.notifications.push(notification);\n    this.notifications$.next([...this.notifications]);\n  }\n}\n```\n\nEste servicio es la implementacin ms sencilla posible de un gestor de estados. Cabe destacar que :\n\n- Mantienen el estado privado para evitar manipulaciones\n- Recibe de forma controlada las acciones de cambio\n- Emite clones del estado\n- Expone observables para que se suscriban los interesados.\n\n\n## 1.3 Desacoplados pero conectados\n\nUna vez que hemos centralizado el control de cambios de una parte de la aplicacin, es hora de que lo usen los componentes o servicios involucrados. Solo necesitan recibir la instancia va dependencia. **No hay ms acoplamiento entre emisores y receptores.**\n\n### Emisin\n\nVeamos un ejemplo, un tanto forzado,  consistente en dos componentes que se comunican sin conocerse. Esta es la vista con un formulario para enviar mensajes\n\n```html\n<h2>\n  Notes sender\n</h2>\n<form>\n  <fieldset>\n    <section>\n      <label for=\"note\">Note</label>\n      <input name=\"note\"\n             [(ngModel)]=\"note\" />\n    </section>\n  </fieldset>\n  <button (click)=\"send()\">Send</button>\n</form>\n<a [routerLink]=\"['../receiver']\">Go to receiver</a>\n```\n\nLa parte interesante est en el controlador. Dependencia y uso del servicio del almacn de notificaciones\n\n```typescript\nexport class SenderComponent implements OnInit {\n  public note = '';\n\n  constructor(private notificationsStore: NotificationsStoreService) {}\n\n  ngOnInit() {}\n\n  public send() {\n    this.notificationsStore.dispatch(this.note);\n  }\n}\n```\n\n### Recepcin\n\nLa recepcin es igual de sencilla. En la vista pondremos un listado de notificaciones que se alimenta de un array emitido por un observable.\n\n```html\n<h2>\n  Notes receiver\n</h2>\n<ul>\n  <li *ngFor=\"let note of notes$ | async\">{{ note | json }}</li>\n</ul>\n<a [routerLink]=\"['../sender']\">Go to sender</a>\n```\n\nY en el controlador reclamamos la misma dependencia para el uso del servicio del almacn de notificaciones.\n\n```typescript\nexport class ReceiverComponent implements OnInit {\n  public notes$;\n\n  constructor(private notificationsStore: NotificationsStoreService) {}\n\n  ngOnInit() {\n    this.notes$ = this.notificationsStore.select$();\n  }\n}\n```\n\nEs importante recalcar que **no importa el orden de suscripcin**. Estos dos componentes podran _vivir_ en mdulos distintos, verse en la misma pgina o inicializarse en cualquier orden... El receptor se entera siempre de todos los cambios; y adems recibe el ltimo estado conocido nada ms suscribirse.\n\n# 2. Interceptores para gestionar errores\n\nHemos conocido a los interceptores y vemos su potencial para manipular las respuestas de una API. Quiz uno de los usos ms frecuentes se el de **centralizar la gestin de errores**. Veamos como hacerlo usando el conocimiento de los observables.\n\nPara empezar hay que generar un servicio...\n\n```\nng g s notifications/errorInterceptor\n\n```\nluego hay que hacerle cumplir la interfaz `HttpInterceptor`...\n\n```typescript\nexport class ErrorInterceptorService implements HttpInterceptor {\n  constructor() {}\n\n  public intercept(req: HttpRequest<any>, next: HttpHandler)\n    : Observable<HttpEvent<any>> {\n    return next.handle(req);\n  }\n}\n```\ny para finalizar lo proveemos hacia el `HttpClient` invirtiendo el control.\n\n```typescript\n@NgModule({\n  declarations: [SenderComponent, ReceiverComponent],\n  imports: [\n    CommonModule,\n    NotificationsRoutingModule,\n    HttpClientModule,\n    FormsModule\n  ],\n  providers: [\n    {\n      provide: HTTP_INTERCEPTORS,\n      useClass: ErrorInterceptorService,\n      multi: true\n    }\n  ]\n})\nexport class NotificationsModule {}\n```\n\n## 2.1 El operador catchError\n\nVolvemos a los observables y los operadores canalizables en `.pipe()`. Durante su ejecucin un _stream_ de observables puede emitir valores correctos, una seal de finalizacin... y cmo no, errores. El mtodo `.subscribe(ok, err, end)` y operadores como `.map(ok, err, end)` admiten hasta tres _callbacks_ que se llamarn segn los tipos de sucesos descritos. Pero para tratar el caso concreto de los errores vamos a ver el operador `catchError()`.\n\nPor ejemplo durante la intercepcin de respuestas podemos realizar una funcin especfica al recibir un cdigo de error. Dadas estas tres alternativas, escogeremos segn la intencin o la tecnologa que ms nos guste.\n\n```typescript\npublic intercept(req, next) {\n   // implementacin con .tap()\n   return next.handle(req).pipe(tap(null, err=>console.log(err)));\n   // implementacin con catchError retornando nulo\n   return next.handle(req).pipe(catchError(err => of(null)));\n   // implementacin con catchError re-lanzando el error\n   return next.handle(req).pipe(catchError(err => throwError(err)));\n}\n```\n\n## 2.2 Gestin centralizada de errores\n\nQuizs una de las ms usadas sea auditar el error y reenviarlo al llamante original por si quiere hacer algo ms con el mismo.\n\n```typescript\npublic intercept(req, next) {\n  return next.handle(req).pipe(catchError(this.handleError));\n}\n\nprivate handleError(err) {\n  const unauthorized_code = 401;\n  let userMessage = 'Fatal error';\n  if (err instanceof HttpErrorResponse) {\n    if (err.status === unauthorized_code) {\n      userMessage = 'Authorization needed';\n    } else {\n      userMessage = 'Comunications error';\n    }\n  }\n  console.log(userMessage);\n  return throwError(err);\n}\n```\n\nPero an mejor que solo escribir en el _log_, sera avisar al usuario; pero dnde y cmo?\n\n# 3. Un notificador de problemas\n\nLa idea es usar el `NotificationsStoreService` desde el interceptor para... en fin, notificar que ha habido un error.\n\n## 3.1 Emisin mediante el Store\n\n```typescript\n// dependencia en el constructor\nconstructor(private notificationsStore: NotificationsStoreService) {}\n\npublic intercept(req, next) {\n  // Ojo al bind(this), necesario para no perder el contexto\n  return next.handle(req).pipe(catchError(this.handleError.bind(this)));\n}\n\nprivate handleError(err) {\n  let userMessage = 'Fatal error';\n  // emisin de la notificacin\n  this.notificationsStore.dispatch(userMessage);\n}\n```\n\n\n## 3.2 Recepcin desacoplada del interceptor\n\nY ahora ya slo queda suscribirse a los eventos y mostrarlos al usuario. Por ejemplo, desde el `ReceiverComponent`, podemos lanzar llamadas que sabemos que darn problemas y esperar pacientemente el fallo para mostrarlo al usuario.\n\n```html\n<button (click)=\"forceError()\">Force http Error</button>\n```\n\n```TypeScript\npublic forceError() {\n  const privateUrl = 'https://api-base.herokuapp.com/api/priv/secrets';\n  this.httpClient.get(privateUrl).subscribe();\n  const notFoundUrl = 'https://api-base.herokuapp.com/api/pub/items/9';\n  this.httpClient.get(notFoundUrl).subscribe();\n}\n```\n\nTenemos ahora a nuestro usuario puntualmente informado de todo lo que sucede. Hemos utilizado **patrones de arquitectura de software** como el observable y la inversin del control. El resultado es una serie de componentes y servicios poco acoplados que intercambian informacin en tiempo real.\n\nPero hay temas ms avanzados con los que continuar. Sigue esta serie para introducir ms temas de seguridad y crear tus [formularios reactivos con Angular](../formularios-reactivos-con-Angular/) mientras aprendes a programar con Angular.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"vigilancia-y-seguridad-en-Angular","published":1,"updated":"2019-03-07T11:41:20.774Z","_id":"cjbrwpvi7001siwd3xpxrryku","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-7_watch.png\" alt=\"vigilancia-y-seguridad-en-Angular\"></p><p>La <strong>vigilancia</strong> de los datos y la informacin en tiempo real al usuario son dos pilares del desarrollo con Angular en el lado del navegador. La <strong>seguridad</strong> de los datos realmente es una responsabilidad compartida entre el servidor y el cliente.</p><p>Veremos ambos aspectos del desarrollo, pues estn muy relacionados con la programacin asncrona y el dominio de los observables. Sentaremos las bases para unas <strong>comunicaciones seguras y fluidas en Angular</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal cmo qued en <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones http en Angular</a>. Al finalizar tendrs una aplicacin que comunica a los usuarios cualquier informacin relevante y que gestiona de forma centralizada las respuestas de un servicio REST.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/7-watch/notifications\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/7-watch</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-Observables-para-monitorizar-datos\"><a href=\"#1-Observables-para-monitorizar-datos\" class=\"headerlink\" title=\"1. Observables para monitorizar datos\"></a>1. Observables para monitorizar datos</h1><p>Hemos visto varias tcnicas para comunicar informacin dentro de una aplicacin Angular. Empezamos por conocer el <a href=\"../flujo-de-datos-entre-componentes-angular/\">flujo entre componentes</a> de una misma rama del DOM. Tambin enviamos datos en los <a href=\"../paginas-y-rutas-angular-spa/\">parmetros de una ruta</a>. Y obviamente podemos usar <a href=\"../servicios-inyectables-en-Angular/\">un servicio comn</a> para guardar informacin compartida. Pero en este caso, Cundo se actualiza? Cmo saber si ha cambiado?. Lo resolveremos con <code>Observables</code>.</p><p>Para ilustrar este tema vamos a crear un sencillo sistema de notificaciones que informe al usuario. Empezaremos creando un mdulo para los propsitos de este laboratorio.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m notifications --routing true</span><br><span class=\"line\">ng g c notifications/sender</span><br><span class=\"line\">ng g c notifications/receiver</span><br></pre></td></tr></table></figure><p>Lo apuntamos al enrutador global <code>app-routing.module.ts</code> y asignamos las rutas locales</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'notifications'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"string\">'./notifications/notifications.module#NotificationsModule'</span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'sender'</span>,</span><br><span class=\"line\">    component: SenderComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'receiver'</span>,</span><br><span class=\"line\">    component: ReceiverComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'sender'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>Por ltimo un enlace en el men principal <code>header.component.html</code> y ya estamos listos para enviar y recibir desde dos componente desacoplados.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"notifications\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span>Notifications<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Pero antes un poco ms de observables.</p><h2 id=\"1-1-Productores-de-observables\"><a href=\"#1-1-Productores-de-observables\" class=\"headerlink\" title=\"1.1 Productores de observables\"></a>1.1 Productores de observables</h2><p>La librera <a href=\"https://www.learnrxjs.io/\" target=\"_blank\" rel=\"noopener\">RxJS</a> es enorme y Angular hace un uso extenso de ella. En este tutorial <a href=\"../comunicaciones-http-en-Angular\">se ha visto desde el punto de vista del consumidor</a>. Es decir, nos hemos suscrito a fuentes observables. Para avanzar tendremos que poder emitir, o mejor dicho producir, informacin.</p><h3 id=\"Of-y-from\"><a href=\"#Of-y-from\" class=\"headerlink\" title=\"Of y from\"></a>Of y from</h3><p>Los constructores ms sencillos de la librera son <strong>funciones que emiten valores estticos</strong> o secuencias a intervalos regulares. Para familiarizarte con ellos te propongo que juegues con cdigo como este:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">value$ = of(<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getMilliseconds());</span><br><span class=\"line\">value$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">stream$ = <span class=\"keyword\">from</span>([<span class=\"number\">1</span>, <span class=\"string\">'two'</span>, <span class=\"string\">'***'</span>]);</span><br><span class=\"line\">stream$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">list$ = of([<span class=\"string\">'N'</span>, <span class=\"string\">'S'</span>, <span class=\"string\">'E'</span>, <span class=\"string\">'W'</span>]);</span><br><span class=\"line\">list$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br></pre></td></tr></table></figure><h3 id=\"Subject-y-BehaviorSubject\"><a href=\"#Subject-y-BehaviorSubject\" class=\"headerlink\" title=\"Subject y BehaviorSubject\"></a>Subject y BehaviorSubject</h3><p>Los anteriores constructores se basan en datos estticos. Resuelvan algunas situaciones, pero necesitamos algo que emita <strong>cambios dinmicos</strong>. Y eso se realiza con los <em>Subjects</em>, una especie de emisores temticos a los que suscribirse.</p><p>Hay varios tipos pero para empezar nos vamos a fijar en dos: el <code>Subject()</code> y el <code>BehaviorSubject(initialData)</code>. La diferencia es que el primero slo emite las cosas segn ocurren. Si alguien se suscribe tarde no conocer el pasado. Esto suele generar problemas de sincronizacin. El <em>Behavior</em> en cambio notifica el ltimo valor conocido a cualquiera que se suscriba. De esa forma no importa si te suscribes antes o despus de la obtencin de un dato.</p><p>Juega con el siguiente ejemplo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> data = &#123;name:<span class=\"string\">''</span>, value:<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> need_sync$ = <span class=\"keyword\">new</span> Subject&lt;<span class=\"built_in\">any</span>&gt;();</span><br><span class=\"line\"><span class=\"comment\">// on time</span></span><br><span class=\"line\">need_sync.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">need_sync.next(data);</span><br><span class=\"line\"><span class=\"comment\">// too late</span></span><br><span class=\"line\">need_sync.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> no_hurry$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">any</span>&gt;(<span class=\"keyword\">this</span>.data);</span><br><span class=\"line\"><span class=\"comment\">// its ok</span></span><br><span class=\"line\">no_hurry.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">no_hurry.next(data);</span><br><span class=\"line\"><span class=\"comment\">// its also ok</span></span><br><span class=\"line\">no_hurry.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br></pre></td></tr></table></figure><h2 id=\"1-2-Un-Store-de-notificaciones\"><a href=\"#1-2-Un-Store-de-notificaciones\" class=\"headerlink\" title=\"1.2 Un Store de notificaciones\"></a>1.2 Un Store de notificaciones</h2><p>Usaremos el <code>BehaviorSubject</code> como notificador principal entre componentes de Angular. Por ejemplo podemos montar un sistema de notificaciones sencillo. Empecemos por crear un servicio:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s notifications/notificationsStore</span><br></pre></td></tr></table></figure><blockquote><p>Para adaptarnos a la nomenclatura usada por patrones de gestin de estado ms avanzados como es <strong>Redux</strong>, usar el siguiente convenio: <em>Store</em> como almacn, <em>select$()</em> como publicador de cambios observable y <em>dispatch</em> como encargado de procesar una accin de cambio de estado.</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> NotificationsStoreService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> notifications = [];</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> notifications$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">any</span>[]&gt;([]);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> select$ = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.notifications$.asObservable();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> dispatch(notification) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.notifications.push(notification);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.notifications$.next([...this.notifications]);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Este servicio es la implementacin ms sencilla posible de un gestor de estados. Cabe destacar que :</p><ul><li>Mantienen el estado privado para evitar manipulaciones</li><li>Recibe de forma controlada las acciones de cambio</li><li>Emite clones del estado</li><li>Expone observables para que se suscriban los interesados.</li></ul><h2 id=\"1-3-Desacoplados-pero-conectados\"><a href=\"#1-3-Desacoplados-pero-conectados\" class=\"headerlink\" title=\"1.3 Desacoplados pero conectados\"></a>1.3 Desacoplados pero conectados</h2><p>Una vez que hemos centralizado el control de cambios de una parte de la aplicacin, es hora de que lo usen los componentes o servicios involucrados. Solo necesitan recibir la instancia va dependencia. <strong>No hay ms acoplamiento entre emisores y receptores.</strong></p><h3 id=\"Emision\"><a href=\"#Emision\" class=\"headerlink\" title=\"Emisin\"></a>Emisin</h3><p>Veamos un ejemplo, un tanto forzado, consistente en dos componentes que se comunican sin conocerse. Esta es la vista con un formulario para enviar mensajes</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  Notes sender</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"note\"</span>&gt;</span>Note<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"note\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"note\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"send()\"</span>&gt;</span>Send<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['../receiver']\"</span>&gt;</span>Go to receiver<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La parte interesante est en el controlador. Dependencia y uso del servicio del almacn de notificaciones</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SenderComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> note = <span class=\"string\">''</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> notificationsStore: NotificationsStoreService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> send() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.notificationsStore.dispatch(<span class=\"keyword\">this</span>.note);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h3 id=\"Recepcion\"><a href=\"#Recepcion\" class=\"headerlink\" title=\"Recepcin\"></a>Recepcin</h3><p>La recepcin es igual de sencilla. En la vista pondremos un listado de notificaciones que se alimenta de un array emitido por un observable.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  Notes receiver</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let note of notes$ | async\"</span>&gt;</span>&#123;&#123; note | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['../sender']\"</span>&gt;</span>Go to sender<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y en el controlador reclamamos la misma dependencia para el uso del servicio del almacn de notificaciones.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ReceiverComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> notes$;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> notificationsStore: NotificationsStoreService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.notes$ = <span class=\"keyword\">this</span>.notificationsStore.select$();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Es importante recalcar que <strong>no importa el orden de suscripcin</strong>. Estos dos componentes podran <em>vivir</em> en mdulos distintos, verse en la misma pgina o inicializarse en cualquier orden El receptor se entera siempre de todos los cambios; y adems recibe el ltimo estado conocido nada ms suscribirse.</p><h1 id=\"2-Interceptores-para-gestionar-errores\"><a href=\"#2-Interceptores-para-gestionar-errores\" class=\"headerlink\" title=\"2. Interceptores para gestionar errores\"></a>2. Interceptores para gestionar errores</h1><p>Hemos conocido a los interceptores y vemos su potencial para manipular las respuestas de una API. Quiz uno de los usos ms frecuentes se el de <strong>centralizar la gestin de errores</strong>. Veamos como hacerlo usando el conocimiento de los observables.</p><p>Para empezar hay que generar un servicio</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s notifications/errorInterceptor</span><br></pre></td></tr></table></figure><p>luego hay que hacerle cumplir la interfaz <code>HttpInterceptor</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ErrorInterceptorService <span class=\"keyword\">implements</span> HttpInterceptor &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler)</span><br><span class=\"line\">    : Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next.handle(req);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>y para finalizar lo proveemos hacia el <code>HttpClient</code> invirtiendo el control.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [SenderComponent, ReceiverComponent],</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    NotificationsRoutingModule,</span><br><span class=\"line\">    HttpClientModule,</span><br><span class=\"line\">    FormsModule</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: HTTP_INTERCEPTORS,</span><br><span class=\"line\">      useClass: ErrorInterceptorService,</span><br><span class=\"line\">      multi: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> NotificationsModule &#123;&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-1-El-operador-catchError\"><a href=\"#2-1-El-operador-catchError\" class=\"headerlink\" title=\"2.1 El operador catchError\"></a>2.1 El operador catchError</h2><p>Volvemos a los observables y los operadores canalizables en <code>.pipe()</code>. Durante su ejecucin un <em>stream</em> de observables puede emitir valores correctos, una seal de finalizacin y cmo no, errores. El mtodo <code>.subscribe(ok, err, end)</code> y operadores como <code>.map(ok, err, end)</code> admiten hasta tres <em>callbacks</em> que se llamarn segn los tipos de sucesos descritos. Pero para tratar el caso concreto de los errores vamos a ver el operador <code>catchError()</code>.</p><p>Por ejemplo durante la intercepcin de respuestas podemos realizar una funcin especfica al recibir un cdigo de error. Dadas estas tres alternativas, escogeremos segn la intencin o la tecnologa que ms nos guste.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> intercept(req, next) &#123;</span><br><span class=\"line\">   <span class=\"comment\">// implementacin con .tap()</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> next.handle(req).pipe(tap(<span class=\"literal\">null</span>, <span class=\"function\"><span class=\"params\">err</span>=&gt;</span><span class=\"built_in\">console</span>.log(err)));</span><br><span class=\"line\">   <span class=\"comment\">// implementacin con catchError retornando nulo</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> of(<span class=\"literal\">null</span>)));</span><br><span class=\"line\">   <span class=\"comment\">// implementacin con catchError re-lanzando el error</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> throwError(err)));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Gestion-centralizada-de-errores\"><a href=\"#2-2-Gestion-centralizada-de-errores\" class=\"headerlink\" title=\"2.2 Gestin centralizada de errores\"></a>2.2 Gestin centralizada de errores</h2><p>Quizs una de las ms usadas sea auditar el error y reenviarlo al llamante original por si quiere hacer algo ms con el mismo.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> intercept(req, next) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"keyword\">this</span>.handleError));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> handleError(err) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> unauthorized_code = <span class=\"number\">401</span>;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> userMessage = <span class=\"string\">'Fatal error'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (err <span class=\"keyword\">instanceof</span> HttpErrorResponse) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err.status === unauthorized_code) &#123;</span><br><span class=\"line\">      userMessage = <span class=\"string\">'Authorization needed'</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      userMessage = <span class=\"string\">'Comunications error'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(userMessage);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> throwError(err);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Pero an mejor que solo escribir en el <em>log</em>, sera avisar al usuario; pero dnde y cmo?</p><h1 id=\"3-Un-notificador-de-problemas\"><a href=\"#3-Un-notificador-de-problemas\" class=\"headerlink\" title=\"3. Un notificador de problemas\"></a>3. Un notificador de problemas</h1><p>La idea es usar el <code>NotificationsStoreService</code> desde el interceptor para en fin, notificar que ha habido un error.</p><h2 id=\"3-1-Emision-mediante-el-Store\"><a href=\"#3-1-Emision-mediante-el-Store\" class=\"headerlink\" title=\"3.1 Emisin mediante el Store\"></a>3.1 Emisin mediante el Store</h2><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// dependencia en el constructor</span></span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> notificationsStore: NotificationsStoreService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> intercept(req, next) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// Ojo al bind(this), necesario para no perder el contexto</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"keyword\">this</span>.handleError.bind(<span class=\"keyword\">this</span>)));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> handleError(err) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> userMessage = <span class=\"string\">'Fatal error'</span>;</span><br><span class=\"line\">  <span class=\"comment\">// emisin de la notificacin</span></span><br><span class=\"line\">  <span class=\"keyword\">this</span>.notificationsStore.dispatch(userMessage);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Recepcion-desacoplada-del-interceptor\"><a href=\"#3-2-Recepcion-desacoplada-del-interceptor\" class=\"headerlink\" title=\"3.2 Recepcin desacoplada del interceptor\"></a>3.2 Recepcin desacoplada del interceptor</h2><p>Y ahora ya slo queda suscribirse a los eventos y mostrarlos al usuario. Por ejemplo, desde el <code>ReceiverComponent</code>, podemos lanzar llamadas que sabemos que darn problemas y esperar pacientemente el fallo para mostrarlo al usuario.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"forceError()\"</span>&gt;</span>Force http Error<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> forceError() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> privateUrl = <span class=\"string\">'https://api-base.herokuapp.com/api/priv/secrets'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.get(privateUrl).subscribe();</span><br><span class=\"line\">  <span class=\"keyword\">const</span> notFoundUrl = <span class=\"string\">'https://api-base.herokuapp.com/api/pub/items/9'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.get(notFoundUrl).subscribe();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Tenemos ahora a nuestro usuario puntualmente informado de todo lo que sucede. Hemos utilizado <strong>patrones de arquitectura de software</strong> como el observable y la inversin del control. El resultado es una serie de componentes y servicios poco acoplados que intercambian informacin en tiempo real.</p><p>Pero hay temas ms avanzados con los que continuar. Sigue esta serie para introducir ms temas de seguridad y crear tus <a href=\"../formularios-reactivos-con-Angular/\">formularios reactivos con Angular</a> mientras aprendes a programar con Angular.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-7_watch.png\" alt=\"vigilancia-y-seguridad-en-Angular\"></p><p>La <strong>vigilancia</strong> de los datos y la informacin en tiempo real al usuario son dos pilares del desarrollo con Angular en el lado del navegador. La <strong>seguridad</strong> de los datos realmente es una responsabilidad compartida entre el servidor y el cliente.</p><p>Veremos ambos aspectos del desarrollo, pues estn muy relacionados con la programacin asncrona y el dominio de los observables. Sentaremos las bases para unas <strong>comunicaciones seguras y fluidas en Angular</strong>.</p>","more":"<p>Partiendo de la aplicacin tal cmo qued en <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones http en Angular</a>. Al finalizar tendrs una aplicacin que comunica a los usuarios cualquier informacin relevante y que gestiona de forma centralizada las respuestas de un servicio REST.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/7-watch/notifications\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/7-watch</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-Observables-para-monitorizar-datos\"><a href=\"#1-Observables-para-monitorizar-datos\" class=\"headerlink\" title=\"1. Observables para monitorizar datos\"></a>1. Observables para monitorizar datos</h1><p>Hemos visto varias tcnicas para comunicar informacin dentro de una aplicacin Angular. Empezamos por conocer el <a href=\"../flujo-de-datos-entre-componentes-angular/\">flujo entre componentes</a> de una misma rama del DOM. Tambin enviamos datos en los <a href=\"../paginas-y-rutas-angular-spa/\">parmetros de una ruta</a>. Y obviamente podemos usar <a href=\"../servicios-inyectables-en-Angular/\">un servicio comn</a> para guardar informacin compartida. Pero en este caso, Cundo se actualiza? Cmo saber si ha cambiado?. Lo resolveremos con <code>Observables</code>.</p><p>Para ilustrar este tema vamos a crear un sencillo sistema de notificaciones que informe al usuario. Empezaremos creando un mdulo para los propsitos de este laboratorio.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m notifications --routing true</span><br><span class=\"line\">ng g c notifications/sender</span><br><span class=\"line\">ng g c notifications/receiver</span><br></pre></td></tr></table></figure><p>Lo apuntamos al enrutador global <code>app-routing.module.ts</code> y asignamos las rutas locales</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'notifications'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"string\">'./notifications/notifications.module#NotificationsModule'</span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'sender'</span>,</span><br><span class=\"line\">    component: SenderComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'receiver'</span>,</span><br><span class=\"line\">    component: ReceiverComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'sender'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>Por ltimo un enlace en el men principal <code>header.component.html</code> y ya estamos listos para enviar y recibir desde dos componente desacoplados.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"notifications\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span>Notifications<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Pero antes un poco ms de observables.</p><h2 id=\"1-1-Productores-de-observables\"><a href=\"#1-1-Productores-de-observables\" class=\"headerlink\" title=\"1.1 Productores de observables\"></a>1.1 Productores de observables</h2><p>La librera <a href=\"https://www.learnrxjs.io/\" target=\"_blank\" rel=\"noopener\">RxJS</a> es enorme y Angular hace un uso extenso de ella. En este tutorial <a href=\"../comunicaciones-http-en-Angular\">se ha visto desde el punto de vista del consumidor</a>. Es decir, nos hemos suscrito a fuentes observables. Para avanzar tendremos que poder emitir, o mejor dicho producir, informacin.</p><h3 id=\"Of-y-from\"><a href=\"#Of-y-from\" class=\"headerlink\" title=\"Of y from\"></a>Of y from</h3><p>Los constructores ms sencillos de la librera son <strong>funciones que emiten valores estticos</strong> o secuencias a intervalos regulares. Para familiarizarte con ellos te propongo que juegues con cdigo como este:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">value$ = of(<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getMilliseconds());</span><br><span class=\"line\">value$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">stream$ = <span class=\"keyword\">from</span>([<span class=\"number\">1</span>, <span class=\"string\">'two'</span>, <span class=\"string\">'***'</span>]);</span><br><span class=\"line\">stream$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">list$ = of([<span class=\"string\">'N'</span>, <span class=\"string\">'S'</span>, <span class=\"string\">'E'</span>, <span class=\"string\">'W'</span>]);</span><br><span class=\"line\">list$.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br></pre></td></tr></table></figure><h3 id=\"Subject-y-BehaviorSubject\"><a href=\"#Subject-y-BehaviorSubject\" class=\"headerlink\" title=\"Subject y BehaviorSubject\"></a>Subject y BehaviorSubject</h3><p>Los anteriores constructores se basan en datos estticos. Resuelvan algunas situaciones, pero necesitamos algo que emita <strong>cambios dinmicos</strong>. Y eso se realiza con los <em>Subjects</em>, una especie de emisores temticos a los que suscribirse.</p><p>Hay varios tipos pero para empezar nos vamos a fijar en dos: el <code>Subject()</code> y el <code>BehaviorSubject(initialData)</code>. La diferencia es que el primero slo emite las cosas segn ocurren. Si alguien se suscribe tarde no conocer el pasado. Esto suele generar problemas de sincronizacin. El <em>Behavior</em> en cambio notifica el ltimo valor conocido a cualquiera que se suscriba. De esa forma no importa si te suscribes antes o despus de la obtencin de un dato.</p><p>Juega con el siguiente ejemplo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> data = &#123;name:<span class=\"string\">''</span>, value:<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> need_sync$ = <span class=\"keyword\">new</span> Subject&lt;<span class=\"built_in\">any</span>&gt;();</span><br><span class=\"line\"><span class=\"comment\">// on time</span></span><br><span class=\"line\">need_sync.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">need_sync.next(data);</span><br><span class=\"line\"><span class=\"comment\">// too late</span></span><br><span class=\"line\">need_sync.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> no_hurry$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">any</span>&gt;(<span class=\"keyword\">this</span>.data);</span><br><span class=\"line\"><span class=\"comment\">// its ok</span></span><br><span class=\"line\">no_hurry.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br><span class=\"line\">no_hurry.next(data);</span><br><span class=\"line\"><span class=\"comment\">// its also ok</span></span><br><span class=\"line\">no_hurry.subscribe(<span class=\"function\"><span class=\"params\">r</span>=&gt;</span> <span class=\"built_in\">console</span>.log(r));</span><br></pre></td></tr></table></figure><h2 id=\"1-2-Un-Store-de-notificaciones\"><a href=\"#1-2-Un-Store-de-notificaciones\" class=\"headerlink\" title=\"1.2 Un Store de notificaciones\"></a>1.2 Un Store de notificaciones</h2><p>Usaremos el <code>BehaviorSubject</code> como notificador principal entre componentes de Angular. Por ejemplo podemos montar un sistema de notificaciones sencillo. Empecemos por crear un servicio:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s notifications/notificationsStore</span><br></pre></td></tr></table></figure><blockquote><p>Para adaptarnos a la nomenclatura usada por patrones de gestin de estado ms avanzados como es <strong>Redux</strong>, usar el siguiente convenio: <em>Store</em> como almacn, <em>select$()</em> como publicador de cambios observable y <em>dispatch</em> como encargado de procesar una accin de cambio de estado.</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> NotificationsStoreService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> notifications = [];</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> notifications$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">any</span>[]&gt;([]);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> select$ = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.notifications$.asObservable();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> dispatch(notification) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.notifications.push(notification);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.notifications$.next([...this.notifications]);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Este servicio es la implementacin ms sencilla posible de un gestor de estados. Cabe destacar que :</p><ul><li>Mantienen el estado privado para evitar manipulaciones</li><li>Recibe de forma controlada las acciones de cambio</li><li>Emite clones del estado</li><li>Expone observables para que se suscriban los interesados.</li></ul><h2 id=\"1-3-Desacoplados-pero-conectados\"><a href=\"#1-3-Desacoplados-pero-conectados\" class=\"headerlink\" title=\"1.3 Desacoplados pero conectados\"></a>1.3 Desacoplados pero conectados</h2><p>Una vez que hemos centralizado el control de cambios de una parte de la aplicacin, es hora de que lo usen los componentes o servicios involucrados. Solo necesitan recibir la instancia va dependencia. <strong>No hay ms acoplamiento entre emisores y receptores.</strong></p><h3 id=\"Emision\"><a href=\"#Emision\" class=\"headerlink\" title=\"Emisin\"></a>Emisin</h3><p>Veamos un ejemplo, un tanto forzado, consistente en dos componentes que se comunican sin conocerse. Esta es la vista con un formulario para enviar mensajes</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  Notes sender</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"note\"</span>&gt;</span>Note<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"note\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [(<span class=\"attr\">ngModel</span>)]=<span class=\"string\">\"note\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">fieldset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"send()\"</span>&gt;</span>Send<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['../receiver']\"</span>&gt;</span>Go to receiver<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>La parte interesante est en el controlador. Dependencia y uso del servicio del almacn de notificaciones</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SenderComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> note = <span class=\"string\">''</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> notificationsStore: NotificationsStoreService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> send() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.notificationsStore.dispatch(<span class=\"keyword\">this</span>.note);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h3 id=\"Recepcion\"><a href=\"#Recepcion\" class=\"headerlink\" title=\"Recepcin\"></a>Recepcin</h3><p>La recepcin es igual de sencilla. En la vista pondremos un listado de notificaciones que se alimenta de un array emitido por un observable.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  Notes receiver</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span> *<span class=\"attr\">ngFor</span>=<span class=\"string\">\"let note of notes$ | async\"</span>&gt;</span>&#123;&#123; note | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['../sender']\"</span>&gt;</span>Go to sender<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Y en el controlador reclamamos la misma dependencia para el uso del servicio del almacn de notificaciones.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ReceiverComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> notes$;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> notificationsStore: NotificationsStoreService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.notes$ = <span class=\"keyword\">this</span>.notificationsStore.select$();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Es importante recalcar que <strong>no importa el orden de suscripcin</strong>. Estos dos componentes podran <em>vivir</em> en mdulos distintos, verse en la misma pgina o inicializarse en cualquier orden El receptor se entera siempre de todos los cambios; y adems recibe el ltimo estado conocido nada ms suscribirse.</p><h1 id=\"2-Interceptores-para-gestionar-errores\"><a href=\"#2-Interceptores-para-gestionar-errores\" class=\"headerlink\" title=\"2. Interceptores para gestionar errores\"></a>2. Interceptores para gestionar errores</h1><p>Hemos conocido a los interceptores y vemos su potencial para manipular las respuestas de una API. Quiz uno de los usos ms frecuentes se el de <strong>centralizar la gestin de errores</strong>. Veamos como hacerlo usando el conocimiento de los observables.</p><p>Para empezar hay que generar un servicio</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s notifications/errorInterceptor</span><br></pre></td></tr></table></figure><p>luego hay que hacerle cumplir la interfaz <code>HttpInterceptor</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ErrorInterceptorService <span class=\"keyword\">implements</span> HttpInterceptor &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler)</span><br><span class=\"line\">    : Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next.handle(req);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>y para finalizar lo proveemos hacia el <code>HttpClient</code> invirtiendo el control.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [SenderComponent, ReceiverComponent],</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    NotificationsRoutingModule,</span><br><span class=\"line\">    HttpClientModule,</span><br><span class=\"line\">    FormsModule</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: HTTP_INTERCEPTORS,</span><br><span class=\"line\">      useClass: ErrorInterceptorService,</span><br><span class=\"line\">      multi: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> NotificationsModule &#123;&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-1-El-operador-catchError\"><a href=\"#2-1-El-operador-catchError\" class=\"headerlink\" title=\"2.1 El operador catchError\"></a>2.1 El operador catchError</h2><p>Volvemos a los observables y los operadores canalizables en <code>.pipe()</code>. Durante su ejecucin un <em>stream</em> de observables puede emitir valores correctos, una seal de finalizacin y cmo no, errores. El mtodo <code>.subscribe(ok, err, end)</code> y operadores como <code>.map(ok, err, end)</code> admiten hasta tres <em>callbacks</em> que se llamarn segn los tipos de sucesos descritos. Pero para tratar el caso concreto de los errores vamos a ver el operador <code>catchError()</code>.</p><p>Por ejemplo durante la intercepcin de respuestas podemos realizar una funcin especfica al recibir un cdigo de error. Dadas estas tres alternativas, escogeremos segn la intencin o la tecnologa que ms nos guste.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> intercept(req, next) &#123;</span><br><span class=\"line\">   <span class=\"comment\">// implementacin con .tap()</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> next.handle(req).pipe(tap(<span class=\"literal\">null</span>, <span class=\"function\"><span class=\"params\">err</span>=&gt;</span><span class=\"built_in\">console</span>.log(err)));</span><br><span class=\"line\">   <span class=\"comment\">// implementacin con catchError retornando nulo</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> of(<span class=\"literal\">null</span>)));</span><br><span class=\"line\">   <span class=\"comment\">// implementacin con catchError re-lanzando el error</span></span><br><span class=\"line\">   <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> throwError(err)));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Gestion-centralizada-de-errores\"><a href=\"#2-2-Gestion-centralizada-de-errores\" class=\"headerlink\" title=\"2.2 Gestin centralizada de errores\"></a>2.2 Gestin centralizada de errores</h2><p>Quizs una de las ms usadas sea auditar el error y reenviarlo al llamante original por si quiere hacer algo ms con el mismo.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> intercept(req, next) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"keyword\">this</span>.handleError));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> handleError(err) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> unauthorized_code = <span class=\"number\">401</span>;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> userMessage = <span class=\"string\">'Fatal error'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (err <span class=\"keyword\">instanceof</span> HttpErrorResponse) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err.status === unauthorized_code) &#123;</span><br><span class=\"line\">      userMessage = <span class=\"string\">'Authorization needed'</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      userMessage = <span class=\"string\">'Comunications error'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(userMessage);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> throwError(err);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Pero an mejor que solo escribir en el <em>log</em>, sera avisar al usuario; pero dnde y cmo?</p><h1 id=\"3-Un-notificador-de-problemas\"><a href=\"#3-Un-notificador-de-problemas\" class=\"headerlink\" title=\"3. Un notificador de problemas\"></a>3. Un notificador de problemas</h1><p>La idea es usar el <code>NotificationsStoreService</code> desde el interceptor para en fin, notificar que ha habido un error.</p><h2 id=\"3-1-Emision-mediante-el-Store\"><a href=\"#3-1-Emision-mediante-el-Store\" class=\"headerlink\" title=\"3.1 Emisin mediante el Store\"></a>3.1 Emisin mediante el Store</h2><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// dependencia en el constructor</span></span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> notificationsStore: NotificationsStoreService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> intercept(req, next) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// Ojo al bind(this), necesario para no perder el contexto</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"keyword\">this</span>.handleError.bind(<span class=\"keyword\">this</span>)));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> handleError(err) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> userMessage = <span class=\"string\">'Fatal error'</span>;</span><br><span class=\"line\">  <span class=\"comment\">// emisin de la notificacin</span></span><br><span class=\"line\">  <span class=\"keyword\">this</span>.notificationsStore.dispatch(userMessage);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Recepcion-desacoplada-del-interceptor\"><a href=\"#3-2-Recepcion-desacoplada-del-interceptor\" class=\"headerlink\" title=\"3.2 Recepcin desacoplada del interceptor\"></a>3.2 Recepcin desacoplada del interceptor</h2><p>Y ahora ya slo queda suscribirse a los eventos y mostrarlos al usuario. Por ejemplo, desde el <code>ReceiverComponent</code>, podemos lanzar llamadas que sabemos que darn problemas y esperar pacientemente el fallo para mostrarlo al usuario.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"forceError()\"</span>&gt;</span>Force http Error<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> forceError() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> privateUrl = <span class=\"string\">'https://api-base.herokuapp.com/api/priv/secrets'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.get(privateUrl).subscribe();</span><br><span class=\"line\">  <span class=\"keyword\">const</span> notFoundUrl = <span class=\"string\">'https://api-base.herokuapp.com/api/pub/items/9'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.get(notFoundUrl).subscribe();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Tenemos ahora a nuestro usuario puntualmente informado de todo lo que sucede. Hemos utilizado <strong>patrones de arquitectura de software</strong> como el observable y la inversin del control. El resultado es una serie de componentes y servicios poco acoplados que intercambian informacin en tiempo real.</p><p>Pero hay temas ms avanzados con los que continuar. Sigue esta serie para introducir ms temas de seguridad y crear tus <a href=\"../formularios-reactivos-con-Angular/\">formularios reactivos con Angular</a> mientras aprendes a programar con Angular.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Flujo de datos entre componentes Angular","date":"2019-02-12T15:10:44.000Z","thumbnail":"/css/images/angular-4_flow.png","_content":"![flujo-de-datos-entre-componentes-angular](/images/tutorial-angular-4_flow.png)\n\nLos desarrollos profesionales son complicados pero **con Angular tenemos soluciones de comunicacin simples para pantallas complejas**. Mediante el desarrollo de componentes atmicos y reutilizables Angular 7 favorece la implementacin de buenas prcticas.\n\nCrear y comunicar muchos componentes puede llevarnos a cdigo difcil de seguir. La librera `@angular/forms` ofrece *tuberas de comunicacin* para **mantener el flujo de datos bajo control**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/). Al finalizar tendrs una aplicacin que reparte la responsabilidad de recoger y presentar datos en componentes.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/4-flow](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/4-flow/car)\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n\n# 1. Comunicacin entre componentes\n\nLas aplicaciones web en las que destaca Angular suelen ser complejas y con mucha variedad funcional en diversas pginas. A menudo esas pginas estn repletas de formularios, informes y botones. La solucin viene de mano del viejo principio _divide y vencers_: **La componentizacin**\n\n## 1.1. Necesidad de comunicacin\n\nEl _framework_ permite y recomienda repartir el trabajo en mltiples componentes de responsabilidad nica. Tambin es prctica comn el crear pginas especficas para situaciones concretas aunque relacionadas. Por supuesto que estructuras como el men de navegacin o secciones de estado general necesitan conocer datos provenientes de las pginas. Nada est completamente asilado. Esto nos enfrenta la problema de **comunicar componentes**.\n\n## 1.2. Escenarios\n\nLas situaciones que te encontrars caern en alguna de estas tres categoras para las que hay soluciones especficas.\n\n### Comunicar componentes acoplados\nSolemos empezar creando un componente por pgina. Pero es normal que esa pgina se complique y la solucin a la complejidad es la **divisin en componentes y reparto de responsabilidades**. Dado que estn en una misma pgina existe cierto acoplamiento entre ellos y eso nos facilitar la comunicacin.\n\n### Comunicar componentes en pginas distintas\nCuando los componentes se carga en rutas distintas ya no hay forma de comunicarlos directamente. Pero lo resolveremos fcilmente **usando las capacidades del router.**\n\n### Comunicar componentes entre estructuras dinmicas\nLa situacin ms compleja se da cuando queremos comunicar componentes o servicios desacoplados pero sin cambio de pgina. En este caso har falta un **mediador observable**.\n\n\n# 2. El patrn Contendor / Presentadores\n\nEn **arquitectura de software** cuando encontramos una solucin a un problema recurrente le ponemos un nombre y tratamos de utilizarlo siempre que podemos. Obviamente es una eleccin del programador y siempre tiene un coste que debe valorar. En este caso la ventaja es clara: **reparto de responsabilidades**.\n\n## 2.1 El patrn\n\nEn este caso **el patrn contendor/presentadores** estipula que haya un nico componente responsable de obtener, mutar y guardar el estado. Ser el componente contenedor. Los presentadores sern responsables de.. ejem, presentar la informacin y los elementos de interaccin con el usuario. Las ventajas derivadas son: mayor facilidad para el _testeo_ y mayores posibilidades de reutilizacin de presentadores.\n\n> A este patrn a veces se le conoce como parent/children por la jerarqua html que genera.\n\nVeamos una implementacin sencilla. Haremos una interfaz mnima para simular el manejo de un coche. Habr pedales de aceleracin y freno, y un cuadro dnde se refleje la velocidad. Para todo ello vamos a usa el _Angular CLI_ y crear un mdulo y sus componentes base.\n\n```console\nng g m 4-flow/car\nng g c 4-flow/car/car\nng g c 4-flow/car/car/display\nng g c 4-flow/car/car/pedals\n```\n\nAgregamos una ruta en el enrutador con su enlace en el men.\n\n```typescript\n{\n  path: 'car',\n  loadChildren: './car/car.module#CarModule'\n}\n```\n\n```html\n<a routerLink=\"car\" class=\"button\">\n  <span> 4 - Car</span>\n</a>\n```\n\n## 2.2 El contendor\n\nEn el componente contenedor tendremos **una vista muy sencilla y un controlador ms complejo**. La vista ser la composicin de los componentes presentadores, pero el controlador tendr que obtener datos, aplicarles lgica de negocio y guardarlos cuando corresponda.\n\n> No es habitual asignarle un sufijo al nombre del componente para indicar que es el contendor. Suele ser suficiente el verlo en la raz de la jerarqua de carpetas.\n\n```html\n<app-display [model]=\"car.name\"\n             [currentSpeed]=\"car.currentSpeed\"\n             [topSpeed]=\"car.maxSpeed\"\n             [units]=\"'Km/h'\">\n</app-display>\n<app-pedals (brake)=\"onBrake($event)\"\n            [disableBrake]=\"disableBrake\"\n            (throttle)=\"onThrottle($event)\"\n            [disableThrottle]=\"disableThrottle\">\n</app-pedals>\n```\n\nVemos que usa los componentes presentadores `Display` y `Pedals` envindoles informacin y suscribindose a sus eventos. Concretaremos esta funcionalidad ms adelante.\n\n```typescript\npublic car: CarModel;\npublic disableBrake: boolean;\npublic disableThrottle: boolean;\n\nconstructor() {}\n\npublic ngOnInit() {\n  this.car = { name: 'Roadster', maxSpeed: 120, currentSpeed: 0 };\n  this.checkLimits();\n}\nprivate checkLimits() {\n  this.disableBrake = false;\n  this.disableThrottle = false;\n  if (this.car.currentSpeed <= 0) {\n    this.car.currentSpeed = 0;\n    this.disableBrake = true;\n  } else if (this.car.currentSpeed >= this.car.maxSpeed) {\n    this.car.currentSpeed = this.car.maxSpeed;\n    this.disableThrottle = true;\n  }\n}\npublic onBrake(drive: number) {\n  this.car.currentSpeed -= this.getDelta(drive);\n  this.checkLimits();\n}\npublic onThrottle(drive: number) {\n  this.car.currentSpeed += this.getDelta(drive);\n  this.checkLimits();\n}\nprivate getDelta = (drive: number) =>\n  drive + (this.car.maxSpeed - this.car.currentSpeed) / 10;\n```\n\nLo dicho, _la clase controladora del componente contendor retiene el grueso de la funcionalidad_. En este caso inicializar una instancia de un coche y mantener sus velocidad en los lmites lgicos respondiendo a las acciones del usuario conductor.\n\n\n## 2.3 Envo hacia el presentador con @Input()\n\nEsta comunicacin _hacia abajo_ enva la informacin **desde el contenedor hacia el presentador**. Es similar a como una plantilla recibe la informacin desde el controlador.\n\n\n### @Input()\n\nPara que una vista muestre datos tiene que usar directivas como `{{ model }}` asociada a una propiedad pblica de la clase componente. Se supone que dicha clase es la responsable de su valor. Pero tambin puede **recibirlo desde el exterior**. La novedad es hacer que lo reciba va *html*.\n\n```html\n<h2> {{ model }} </h2>\n<h3> Top speed: {{ topSpeed | number:'1.0-0' }}</h3>\n<div class=\"card\">\n  <div class=\"section\">\n    {{ currentSpeed | number:'1.2-2' }} {{ units }}\n  </div>\n  <progress [value]=\"currentSpeed\"\n            [ngClass]=\"getSpeedClass()\"\n            [max]=\"topSpeed\">\n  </progress>\n</div>\n```\n\n\nEmpieza por decorar con `@Input()` la propiedad que quieres usar desde fuera. Por ejemplo un cdigo como este del archivo `display.component.ts`.\n\n```typescript\nexport class DisplayComponent implements OnInit {\n  @Input() public model: string;\n  @Input() public currentSpeed: number;\n  @Input() public topSpeed: number;\n  @Input() public units: string;\n  constructor() {}\n  ngOnInit() {}\n  public getSpeedClass = () =>\n    this.currentSpeed < this.getThreshold() ? 'primary' : 'secondary';\n  private getThreshold = () => this.topSpeed * 0.8;\n}\n```\n\nAhora puedes enviarle datos a este componente desde el *html* de su consumidor. Por ejemplo desde `car.component.html` le puedo enviar una variable o cualquier expresin evaluable. Recordemos como usa `[propiedad]=\"expresion\"` en el elemento presentador.\n\n```html\n<app-display [model]=\"car.name\"\n             [currentSpeed]=\"car.currentSpeed\"\n             [topSpeed]=\"car.maxSpeed\"\n             [units]=\"'Km/h'\">\n</app-display>\n```\n\nEn la clase controladora del presentador quedan responsabilidades reducidas a temas especficos como determinar las clases _css_ apropiadas o transformar los datos para su presentacin.\n\nEstoy usando al componente de nivel inferior como un presentador; mientras que el contenedor superior acta como controlador. Este mismo patrn puede y debe repetirse hasta **descomponer las vistas en estructuras simples** que nos eviten repeticiones absurdas en cdigo.\n\nDe esta forma es fcil crear componentes reutilizables; y queda muy limpio el **envo de datos hacia abajo**. Pero, y hacia arriba?.\n\n\n## 2.4. Respuesta del presentador con @Output()\n\nLos componentes de nivel inferior no slo se dedican a presentar datos, tambin presentan controles. Con ellos el usuario podr crear, modificar o eliminar los datos que quiera. Aunque no directamente; para hacerlo **comunican el cambio requerido al contenedor de nivel superior**.\n\n### @Output()\n\nPor ejemplo, el componente `PedalsComponent` permite acelerar y frenar. Bueno, realmente permite que el usuario diga que lo quiere hacer; los cambios se harn ms arriba. Veamos lo bsico del `pedals.component.html` antes de nada:\n\n```html\n<h3> Pedals: </h3>\n<form>\n  <input value=\"brake\"\n    class=\"secondary\"\n    type=\"button\"\n    [disabled]=\"disableBrake\"\n    (click)=\"brake.emit(1)\"/>\n  <input value=\"throttle\"\n    class=\"tertiary\"\n    type=\"button\"\n    [disabled]=\"disableThrottle\"\n    (click)=\"throttle.emit(1)\"/>\n</form>\n```\n\nClaramente son un par de botones que con el evento `(click)` responden a acciones del usuario. En este caso se manifiesta una intencin de acelerar o frenar el coche. Pero el mtodo del controlador no acta directamente sobre los datos.\n\n> Si lo hiciera sera ms difcil gestionar los cambios e imposibilitara el uso de inmutables o tcnicas ms avanzadas de programacin que se vern ms adelante...\n\nEn su lugar, lo que hace es **emitir un evento** confiando que alguien lo reciba y acte en consecuencia. Por ejemplo la emisin de la instruccin de frenado se realiza mediante la propiedad `brake` decorada con `@Output() public brake new EventEmitter<number>();`. Dicha propiedad ser una instancia de un emisor de eventos que mediante el mtodo `.next()` que emite la seal hacia arriba.\n\n```typescript\nexport class PedalsComponent implements OnInit {\n  @Input() public disableBrake: boolean;\n  @Input() public disableThrottle: boolean;\n  @Output() public brake = new EventEmitter<number>();\n  @Output() public throttle = new EventEmitter<number>();\n  constructor() {}\n  ngOnInit() {}\n}\n```\n\nMientras tanto, **en el contenedor la vista se subscribe al evento** `(brake)` como si este fuese un evento nativo y llama a los mtodos que manipulan los datos de verdad.\n\n```html\n<app-pedals (brake)=\"onBrake($event)\"\n            [disableBrake]=\"disableBrake\"\n            (throttle)=\"onThrottle($event)\"\n            [disableThrottle]=\"disableThrottle\">\n</app-pedals>\n```\n\nLas propiedades *output* tambin pueden enviar argumentos que sern recibidos mediante el identificador `$event` propio del framework. Se declaran especificando el tipo del argumento en el genrico del constructor de `EventEmitter<any>`.\n\n\nEn el controlador ya podemos operar con los datos. El mtodo `onBrake(drive: number)` accede y modifica el valor de la velocidad y lo notifica automticamente hacia abajo.\n\nDe esta manera se cierra el crculo. Los componentes de bajo nivel pueden **recibir datos para ser presentados o emitir eventos para modificarlos**. El componente de nivel superior es el **nico responsable de obtener y actuar** sobre los datos.\n\n\n# 3. Comunicaciones entre pginas o estructuras\n\n## 3.1 Comunicacin entre distintas pginas\n\nEn las aplicaciones hay **comunicaciones de estado ms all de la pgina actual**. La comunicacin entre pginas es responsabilidad del `@angular/router`. Una vez activada una ruta, el sistema carga un componente en el `<router-outlet>` correspondiente. No hay forma de comunicarse hacia *(arriba) o [abajo]* con algo desconocido. De una pgina a otra tampoco es problema pues la comunicacin va mediante los parmetros de la *url*.\n\nYa hemos usado esta comunicacin anteriormente en el tema [2-spa](../paginas-y-rutas-angular-spa/) el componente `AuthorComponent` es capaz de recibir por parmetros una identificacin de un autor. Esa informacin es el resultado de una accin del usuario en la pantalla `/about/authors` programada en el componente `AuthorsComponent`. Por tanto es una comunicacin entre componentes, en la que ambos son *controladores hermanos*.\n\n> Desde luego habr que mejorar el acceso y control de los datos que por ahora es muy rudimentario. Lo haremos en prximos pasos. Primero mediante  [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/) y despus usando [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/)\n\n## 2.2 Comunicacin entre estructuras desacopladas\n\nEstando en la misma ruta, no siempre se podrn conocer los componentes, y por tanto no se podrn usar sus `[propiedades] y (eventos)`\n\n### 2.2.1 El layout principal y los componentes por ruta pginas.\n\nUna situacin habitual es **comunicar la vista de negocio activa con elementos generales** de la pgina. Por ejemplo podras querer mostrar la velocidad mxima alcanzada en la barra del men o un un mensaje emergente cada vez que se alcance la velocidad lmite. En este caso, el `<router-outlet>` es una barrera que impide usar el patrn contendor-presentador pues no se puede predecir el contenido dinmico que carga el `RouterOutlet`.\n\n### 2.2.2 Mltiples niveles de presentadores.\n\nCuando las pantallas se hacen realmente complejas empiezan a surgir **rboles de componentes** de muchos niveles de profundidad. En estas situaciones mantener un nico controlador a nivel raz es poco prctico. Enviar hacia abajo las `[propiedades]` es tedioso, pero peor an es hacer burbujear los `(eventos)` por varias capas de presentadores.\n\nLa solucin en ambos casos pasa por permitir que *algunos componentes presentadores tengan su propio control de datos*. Este tipo de comunicaciones tcnicamente se resuelve mediante *Observables* y merece un captulo especial que se ver ms adelante en esta serie. Incluso en situaciones complejas habr que optar por patrones avanzados de gestin de estado como pueda ser *Redux*.\n\nPor ahora tienes una aplicacin en *Angular* que comunica datos y cambios entre componentes de una misma pgina. Sigue el tutorial para aadirle [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/) mientras aprendes a programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","source":"_posts/ng-4-Flujo-de-datos-entre-componentes-Angular.md","raw":"---\ntitle: Flujo de datos entre componentes Angular\npermalink: flujo-de-datos-entre-componentes-angular\ndate: 2019-02-12 16:10:44\ntags:\n- Angular\n- Components\n- Tutorial\n- Introduccin\n- Angular7\n- Angular2\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-4_flow.png\n---\n![flujo-de-datos-entre-componentes-angular](/images/tutorial-angular-4_flow.png)\n\nLos desarrollos profesionales son complicados pero **con Angular tenemos soluciones de comunicacin simples para pantallas complejas**. Mediante el desarrollo de componentes atmicos y reutilizables Angular 7 favorece la implementacin de buenas prcticas.\n\nCrear y comunicar muchos componentes puede llevarnos a cdigo difcil de seguir. La librera `@angular/forms` ofrece *tuberas de comunicacin* para **mantener el flujo de datos bajo control**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/). Al finalizar tendrs una aplicacin que reparte la responsabilidad de recoger y presentar datos en componentes.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/4-flow](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/4-flow/car)\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n\n# 1. Comunicacin entre componentes\n\nLas aplicaciones web en las que destaca Angular suelen ser complejas y con mucha variedad funcional en diversas pginas. A menudo esas pginas estn repletas de formularios, informes y botones. La solucin viene de mano del viejo principio _divide y vencers_: **La componentizacin**\n\n## 1.1. Necesidad de comunicacin\n\nEl _framework_ permite y recomienda repartir el trabajo en mltiples componentes de responsabilidad nica. Tambin es prctica comn el crear pginas especficas para situaciones concretas aunque relacionadas. Por supuesto que estructuras como el men de navegacin o secciones de estado general necesitan conocer datos provenientes de las pginas. Nada est completamente asilado. Esto nos enfrenta la problema de **comunicar componentes**.\n\n## 1.2. Escenarios\n\nLas situaciones que te encontrars caern en alguna de estas tres categoras para las que hay soluciones especficas.\n\n### Comunicar componentes acoplados\nSolemos empezar creando un componente por pgina. Pero es normal que esa pgina se complique y la solucin a la complejidad es la **divisin en componentes y reparto de responsabilidades**. Dado que estn en una misma pgina existe cierto acoplamiento entre ellos y eso nos facilitar la comunicacin.\n\n### Comunicar componentes en pginas distintas\nCuando los componentes se carga en rutas distintas ya no hay forma de comunicarlos directamente. Pero lo resolveremos fcilmente **usando las capacidades del router.**\n\n### Comunicar componentes entre estructuras dinmicas\nLa situacin ms compleja se da cuando queremos comunicar componentes o servicios desacoplados pero sin cambio de pgina. En este caso har falta un **mediador observable**.\n\n\n# 2. El patrn Contendor / Presentadores\n\nEn **arquitectura de software** cuando encontramos una solucin a un problema recurrente le ponemos un nombre y tratamos de utilizarlo siempre que podemos. Obviamente es una eleccin del programador y siempre tiene un coste que debe valorar. En este caso la ventaja es clara: **reparto de responsabilidades**.\n\n## 2.1 El patrn\n\nEn este caso **el patrn contendor/presentadores** estipula que haya un nico componente responsable de obtener, mutar y guardar el estado. Ser el componente contenedor. Los presentadores sern responsables de.. ejem, presentar la informacin y los elementos de interaccin con el usuario. Las ventajas derivadas son: mayor facilidad para el _testeo_ y mayores posibilidades de reutilizacin de presentadores.\n\n> A este patrn a veces se le conoce como parent/children por la jerarqua html que genera.\n\nVeamos una implementacin sencilla. Haremos una interfaz mnima para simular el manejo de un coche. Habr pedales de aceleracin y freno, y un cuadro dnde se refleje la velocidad. Para todo ello vamos a usa el _Angular CLI_ y crear un mdulo y sus componentes base.\n\n```console\nng g m 4-flow/car\nng g c 4-flow/car/car\nng g c 4-flow/car/car/display\nng g c 4-flow/car/car/pedals\n```\n\nAgregamos una ruta en el enrutador con su enlace en el men.\n\n```typescript\n{\n  path: 'car',\n  loadChildren: './car/car.module#CarModule'\n}\n```\n\n```html\n<a routerLink=\"car\" class=\"button\">\n  <span> 4 - Car</span>\n</a>\n```\n\n## 2.2 El contendor\n\nEn el componente contenedor tendremos **una vista muy sencilla y un controlador ms complejo**. La vista ser la composicin de los componentes presentadores, pero el controlador tendr que obtener datos, aplicarles lgica de negocio y guardarlos cuando corresponda.\n\n> No es habitual asignarle un sufijo al nombre del componente para indicar que es el contendor. Suele ser suficiente el verlo en la raz de la jerarqua de carpetas.\n\n```html\n<app-display [model]=\"car.name\"\n             [currentSpeed]=\"car.currentSpeed\"\n             [topSpeed]=\"car.maxSpeed\"\n             [units]=\"'Km/h'\">\n</app-display>\n<app-pedals (brake)=\"onBrake($event)\"\n            [disableBrake]=\"disableBrake\"\n            (throttle)=\"onThrottle($event)\"\n            [disableThrottle]=\"disableThrottle\">\n</app-pedals>\n```\n\nVemos que usa los componentes presentadores `Display` y `Pedals` envindoles informacin y suscribindose a sus eventos. Concretaremos esta funcionalidad ms adelante.\n\n```typescript\npublic car: CarModel;\npublic disableBrake: boolean;\npublic disableThrottle: boolean;\n\nconstructor() {}\n\npublic ngOnInit() {\n  this.car = { name: 'Roadster', maxSpeed: 120, currentSpeed: 0 };\n  this.checkLimits();\n}\nprivate checkLimits() {\n  this.disableBrake = false;\n  this.disableThrottle = false;\n  if (this.car.currentSpeed <= 0) {\n    this.car.currentSpeed = 0;\n    this.disableBrake = true;\n  } else if (this.car.currentSpeed >= this.car.maxSpeed) {\n    this.car.currentSpeed = this.car.maxSpeed;\n    this.disableThrottle = true;\n  }\n}\npublic onBrake(drive: number) {\n  this.car.currentSpeed -= this.getDelta(drive);\n  this.checkLimits();\n}\npublic onThrottle(drive: number) {\n  this.car.currentSpeed += this.getDelta(drive);\n  this.checkLimits();\n}\nprivate getDelta = (drive: number) =>\n  drive + (this.car.maxSpeed - this.car.currentSpeed) / 10;\n```\n\nLo dicho, _la clase controladora del componente contendor retiene el grueso de la funcionalidad_. En este caso inicializar una instancia de un coche y mantener sus velocidad en los lmites lgicos respondiendo a las acciones del usuario conductor.\n\n\n## 2.3 Envo hacia el presentador con @Input()\n\nEsta comunicacin _hacia abajo_ enva la informacin **desde el contenedor hacia el presentador**. Es similar a como una plantilla recibe la informacin desde el controlador.\n\n\n### @Input()\n\nPara que una vista muestre datos tiene que usar directivas como `{{ model }}` asociada a una propiedad pblica de la clase componente. Se supone que dicha clase es la responsable de su valor. Pero tambin puede **recibirlo desde el exterior**. La novedad es hacer que lo reciba va *html*.\n\n```html\n<h2> {{ model }} </h2>\n<h3> Top speed: {{ topSpeed | number:'1.0-0' }}</h3>\n<div class=\"card\">\n  <div class=\"section\">\n    {{ currentSpeed | number:'1.2-2' }} {{ units }}\n  </div>\n  <progress [value]=\"currentSpeed\"\n            [ngClass]=\"getSpeedClass()\"\n            [max]=\"topSpeed\">\n  </progress>\n</div>\n```\n\n\nEmpieza por decorar con `@Input()` la propiedad que quieres usar desde fuera. Por ejemplo un cdigo como este del archivo `display.component.ts`.\n\n```typescript\nexport class DisplayComponent implements OnInit {\n  @Input() public model: string;\n  @Input() public currentSpeed: number;\n  @Input() public topSpeed: number;\n  @Input() public units: string;\n  constructor() {}\n  ngOnInit() {}\n  public getSpeedClass = () =>\n    this.currentSpeed < this.getThreshold() ? 'primary' : 'secondary';\n  private getThreshold = () => this.topSpeed * 0.8;\n}\n```\n\nAhora puedes enviarle datos a este componente desde el *html* de su consumidor. Por ejemplo desde `car.component.html` le puedo enviar una variable o cualquier expresin evaluable. Recordemos como usa `[propiedad]=\"expresion\"` en el elemento presentador.\n\n```html\n<app-display [model]=\"car.name\"\n             [currentSpeed]=\"car.currentSpeed\"\n             [topSpeed]=\"car.maxSpeed\"\n             [units]=\"'Km/h'\">\n</app-display>\n```\n\nEn la clase controladora del presentador quedan responsabilidades reducidas a temas especficos como determinar las clases _css_ apropiadas o transformar los datos para su presentacin.\n\nEstoy usando al componente de nivel inferior como un presentador; mientras que el contenedor superior acta como controlador. Este mismo patrn puede y debe repetirse hasta **descomponer las vistas en estructuras simples** que nos eviten repeticiones absurdas en cdigo.\n\nDe esta forma es fcil crear componentes reutilizables; y queda muy limpio el **envo de datos hacia abajo**. Pero, y hacia arriba?.\n\n\n## 2.4. Respuesta del presentador con @Output()\n\nLos componentes de nivel inferior no slo se dedican a presentar datos, tambin presentan controles. Con ellos el usuario podr crear, modificar o eliminar los datos que quiera. Aunque no directamente; para hacerlo **comunican el cambio requerido al contenedor de nivel superior**.\n\n### @Output()\n\nPor ejemplo, el componente `PedalsComponent` permite acelerar y frenar. Bueno, realmente permite que el usuario diga que lo quiere hacer; los cambios se harn ms arriba. Veamos lo bsico del `pedals.component.html` antes de nada:\n\n```html\n<h3> Pedals: </h3>\n<form>\n  <input value=\"brake\"\n    class=\"secondary\"\n    type=\"button\"\n    [disabled]=\"disableBrake\"\n    (click)=\"brake.emit(1)\"/>\n  <input value=\"throttle\"\n    class=\"tertiary\"\n    type=\"button\"\n    [disabled]=\"disableThrottle\"\n    (click)=\"throttle.emit(1)\"/>\n</form>\n```\n\nClaramente son un par de botones que con el evento `(click)` responden a acciones del usuario. En este caso se manifiesta una intencin de acelerar o frenar el coche. Pero el mtodo del controlador no acta directamente sobre los datos.\n\n> Si lo hiciera sera ms difcil gestionar los cambios e imposibilitara el uso de inmutables o tcnicas ms avanzadas de programacin que se vern ms adelante...\n\nEn su lugar, lo que hace es **emitir un evento** confiando que alguien lo reciba y acte en consecuencia. Por ejemplo la emisin de la instruccin de frenado se realiza mediante la propiedad `brake` decorada con `@Output() public brake new EventEmitter<number>();`. Dicha propiedad ser una instancia de un emisor de eventos que mediante el mtodo `.next()` que emite la seal hacia arriba.\n\n```typescript\nexport class PedalsComponent implements OnInit {\n  @Input() public disableBrake: boolean;\n  @Input() public disableThrottle: boolean;\n  @Output() public brake = new EventEmitter<number>();\n  @Output() public throttle = new EventEmitter<number>();\n  constructor() {}\n  ngOnInit() {}\n}\n```\n\nMientras tanto, **en el contenedor la vista se subscribe al evento** `(brake)` como si este fuese un evento nativo y llama a los mtodos que manipulan los datos de verdad.\n\n```html\n<app-pedals (brake)=\"onBrake($event)\"\n            [disableBrake]=\"disableBrake\"\n            (throttle)=\"onThrottle($event)\"\n            [disableThrottle]=\"disableThrottle\">\n</app-pedals>\n```\n\nLas propiedades *output* tambin pueden enviar argumentos que sern recibidos mediante el identificador `$event` propio del framework. Se declaran especificando el tipo del argumento en el genrico del constructor de `EventEmitter<any>`.\n\n\nEn el controlador ya podemos operar con los datos. El mtodo `onBrake(drive: number)` accede y modifica el valor de la velocidad y lo notifica automticamente hacia abajo.\n\nDe esta manera se cierra el crculo. Los componentes de bajo nivel pueden **recibir datos para ser presentados o emitir eventos para modificarlos**. El componente de nivel superior es el **nico responsable de obtener y actuar** sobre los datos.\n\n\n# 3. Comunicaciones entre pginas o estructuras\n\n## 3.1 Comunicacin entre distintas pginas\n\nEn las aplicaciones hay **comunicaciones de estado ms all de la pgina actual**. La comunicacin entre pginas es responsabilidad del `@angular/router`. Una vez activada una ruta, el sistema carga un componente en el `<router-outlet>` correspondiente. No hay forma de comunicarse hacia *(arriba) o [abajo]* con algo desconocido. De una pgina a otra tampoco es problema pues la comunicacin va mediante los parmetros de la *url*.\n\nYa hemos usado esta comunicacin anteriormente en el tema [2-spa](../paginas-y-rutas-angular-spa/) el componente `AuthorComponent` es capaz de recibir por parmetros una identificacin de un autor. Esa informacin es el resultado de una accin del usuario en la pantalla `/about/authors` programada en el componente `AuthorsComponent`. Por tanto es una comunicacin entre componentes, en la que ambos son *controladores hermanos*.\n\n> Desde luego habr que mejorar el acceso y control de los datos que por ahora es muy rudimentario. Lo haremos en prximos pasos. Primero mediante  [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/) y despus usando [Comunicaciones HTTP en Angular](../comunicaciones-http-en-Angular/)\n\n## 2.2 Comunicacin entre estructuras desacopladas\n\nEstando en la misma ruta, no siempre se podrn conocer los componentes, y por tanto no se podrn usar sus `[propiedades] y (eventos)`\n\n### 2.2.1 El layout principal y los componentes por ruta pginas.\n\nUna situacin habitual es **comunicar la vista de negocio activa con elementos generales** de la pgina. Por ejemplo podras querer mostrar la velocidad mxima alcanzada en la barra del men o un un mensaje emergente cada vez que se alcance la velocidad lmite. En este caso, el `<router-outlet>` es una barrera que impide usar el patrn contendor-presentador pues no se puede predecir el contenido dinmico que carga el `RouterOutlet`.\n\n### 2.2.2 Mltiples niveles de presentadores.\n\nCuando las pantallas se hacen realmente complejas empiezan a surgir **rboles de componentes** de muchos niveles de profundidad. En estas situaciones mantener un nico controlador a nivel raz es poco prctico. Enviar hacia abajo las `[propiedades]` es tedioso, pero peor an es hacer burbujear los `(eventos)` por varias capas de presentadores.\n\nLa solucin en ambos casos pasa por permitir que *algunos componentes presentadores tengan su propio control de datos*. Este tipo de comunicaciones tcnicamente se resuelve mediante *Observables* y merece un captulo especial que se ver ms adelante en esta serie. Incluso en situaciones complejas habr que optar por patrones avanzados de gestin de estado como pueda ser *Redux*.\n\nPor ahora tienes una aplicacin en *Angular* que comunica datos y cambios entre componentes de una misma pgina. Sigue el tutorial para aadirle [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/) mientras aprendes a programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","slug":"flujo-de-datos-entre-componentes-angular","published":1,"updated":"2019-02-14T10:46:47.884Z","_id":"cjbrwpvin001viwd3a5fd3f8a","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-4_flow.png\" alt=\"flujo-de-datos-entre-componentes-angular\"></p><p>Los desarrollos profesionales son complicados pero <strong>con Angular tenemos soluciones de comunicacin simples para pantallas complejas</strong>. Mediante el desarrollo de componentes atmicos y reutilizables Angular 7 favorece la implementacin de buenas prcticas.</p><p>Crear y comunicar muchos componentes puede llevarnos a cdigo difcil de seguir. La librera <code>@angular/forms</code> ofrece <em>tuberas de comunicacin</em> para <strong>mantener el flujo de datos bajo control</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal cmo qued en <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a>. Al finalizar tendrs una aplicacin que reparte la responsabilidad de recoger y presentar datos en componentes.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/4-flow/car\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/4-flow</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-Comunicacion-entre-componentes\"><a href=\"#1-Comunicacion-entre-componentes\" class=\"headerlink\" title=\"1. Comunicacin entre componentes\"></a>1. Comunicacin entre componentes</h1><p>Las aplicaciones web en las que destaca Angular suelen ser complejas y con mucha variedad funcional en diversas pginas. A menudo esas pginas estn repletas de formularios, informes y botones. La solucin viene de mano del viejo principio <em>divide y vencers</em>: <strong>La componentizacin</strong></p><h2 id=\"1-1-Necesidad-de-comunicacion\"><a href=\"#1-1-Necesidad-de-comunicacion\" class=\"headerlink\" title=\"1.1. Necesidad de comunicacin\"></a>1.1. Necesidad de comunicacin</h2><p>El <em>framework</em> permite y recomienda repartir el trabajo en mltiples componentes de responsabilidad nica. Tambin es prctica comn el crear pginas especficas para situaciones concretas aunque relacionadas. Por supuesto que estructuras como el men de navegacin o secciones de estado general necesitan conocer datos provenientes de las pginas. Nada est completamente asilado. Esto nos enfrenta la problema de <strong>comunicar componentes</strong>.</p><h2 id=\"1-2-Escenarios\"><a href=\"#1-2-Escenarios\" class=\"headerlink\" title=\"1.2. Escenarios\"></a>1.2. Escenarios</h2><p>Las situaciones que te encontrars caern en alguna de estas tres categoras para las que hay soluciones especficas.</p><h3 id=\"Comunicar-componentes-acoplados\"><a href=\"#Comunicar-componentes-acoplados\" class=\"headerlink\" title=\"Comunicar componentes acoplados\"></a>Comunicar componentes acoplados</h3><p>Solemos empezar creando un componente por pgina. Pero es normal que esa pgina se complique y la solucin a la complejidad es la <strong>divisin en componentes y reparto de responsabilidades</strong>. Dado que estn en una misma pgina existe cierto acoplamiento entre ellos y eso nos facilitar la comunicacin.</p><h3 id=\"Comunicar-componentes-en-paginas-distintas\"><a href=\"#Comunicar-componentes-en-paginas-distintas\" class=\"headerlink\" title=\"Comunicar componentes en pginas distintas\"></a>Comunicar componentes en pginas distintas</h3><p>Cuando los componentes se carga en rutas distintas ya no hay forma de comunicarlos directamente. Pero lo resolveremos fcilmente <strong>usando las capacidades del router.</strong></p><h3 id=\"Comunicar-componentes-entre-estructuras-dinamicas\"><a href=\"#Comunicar-componentes-entre-estructuras-dinamicas\" class=\"headerlink\" title=\"Comunicar componentes entre estructuras dinmicas\"></a>Comunicar componentes entre estructuras dinmicas</h3><p>La situacin ms compleja se da cuando queremos comunicar componentes o servicios desacoplados pero sin cambio de pgina. En este caso har falta un <strong>mediador observable</strong>.</p><h1 id=\"2-El-patron-Contendor-Presentadores\"><a href=\"#2-El-patron-Contendor-Presentadores\" class=\"headerlink\" title=\"2. El patrn Contendor / Presentadores\"></a>2. El patrn Contendor / Presentadores</h1><p>En <strong>arquitectura de software</strong> cuando encontramos una solucin a un problema recurrente le ponemos un nombre y tratamos de utilizarlo siempre que podemos. Obviamente es una eleccin del programador y siempre tiene un coste que debe valorar. En este caso la ventaja es clara: <strong>reparto de responsabilidades</strong>.</p><h2 id=\"2-1-El-patron\"><a href=\"#2-1-El-patron\" class=\"headerlink\" title=\"2.1 El patrn\"></a>2.1 El patrn</h2><p>En este caso <strong>el patrn contendor/presentadores</strong> estipula que haya un nico componente responsable de obtener, mutar y guardar el estado. Ser el componente contenedor. Los presentadores sern responsables de.. ejem, presentar la informacin y los elementos de interaccin con el usuario. Las ventajas derivadas son: mayor facilidad para el <em>testeo</em> y mayores posibilidades de reutilizacin de presentadores.</p><blockquote><p>A este patrn a veces se le conoce como parent/children por la jerarqua html que genera.</p></blockquote><p>Veamos una implementacin sencilla. Haremos una interfaz mnima para simular el manejo de un coche. Habr pedales de aceleracin y freno, y un cuadro dnde se refleje la velocidad. Para todo ello vamos a usa el <em>Angular CLI</em> y crear un mdulo y sus componentes base.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m 4-flow/car</span><br><span class=\"line\">ng g c 4-flow/car/car</span><br><span class=\"line\">ng g c 4-flow/car/car/display</span><br><span class=\"line\">ng g c 4-flow/car/car/pedals</span><br></pre></td></tr></table></figure><p>Agregamos una ruta en el enrutador con su enlace en el men.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'car'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"string\">'./car/car.module#CarModule'</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"car\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> 4 - Car<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"2-2-El-contendor\"><a href=\"#2-2-El-contendor\" class=\"headerlink\" title=\"2.2 El contendor\"></a>2.2 El contendor</h2><p>En el componente contenedor tendremos <strong>una vista muy sencilla y un controlador ms complejo</strong>. La vista ser la composicin de los componentes presentadores, pero el controlador tendr que obtener datos, aplicarles lgica de negocio y guardarlos cuando corresponda.</p><blockquote><p>No es habitual asignarle un sufijo al nombre del componente para indicar que es el contendor. Suele ser suficiente el verlo en la raz de la jerarqua de carpetas.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-display</span> [<span class=\"attr\">model</span>]=<span class=\"string\">\"car.name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">currentSpeed</span>]=<span class=\"string\">\"car.currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">topSpeed</span>]=<span class=\"string\">\"car.maxSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">units</span>]=<span class=\"string\">\"'Km/h'\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">app-display</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-pedals</span> (<span class=\"attr\">brake</span>)=<span class=\"string\">\"onBrake($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">disableBrake</span>]=<span class=\"string\">\"disableBrake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            (<span class=\"attr\">throttle</span>)=<span class=\"string\">\"onThrottle($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">disableThrottle</span>]=<span class=\"string\">\"disableThrottle\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">app-pedals</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Vemos que usa los componentes presentadores <code>Display</code> y <code>Pedals</code> envindoles informacin y suscribindose a sus eventos. Concretaremos esta funcionalidad ms adelante.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> car: CarModel;</span><br><span class=\"line\"><span class=\"keyword\">public</span> disableBrake: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> disableThrottle: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.car = &#123; name: <span class=\"string\">'Roadster'</span>, maxSpeed: <span class=\"number\">120</span>, currentSpeed: <span class=\"number\">0</span> &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span> checkLimits() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.disableBrake = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.disableThrottle = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.car.currentSpeed &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.car.currentSpeed = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.disableBrake = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.car.currentSpeed &gt;= <span class=\"keyword\">this</span>.car.maxSpeed) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.car.currentSpeed = <span class=\"keyword\">this</span>.car.maxSpeed;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.disableThrottle = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> onBrake(drive: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.car.currentSpeed -= <span class=\"keyword\">this</span>.getDelta(drive);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> onThrottle(drive: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.car.currentSpeed += <span class=\"keyword\">this</span>.getDelta(drive);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span> getDelta = <span class=\"function\">(<span class=\"params\">drive: <span class=\"built_in\">number</span></span>) =&gt;</span></span><br><span class=\"line\">  drive + (<span class=\"keyword\">this</span>.car.maxSpeed - <span class=\"keyword\">this</span>.car.currentSpeed) / <span class=\"number\">10</span>;</span><br></pre></td></tr></table></figure><p>Lo dicho, <em>la clase controladora del componente contendor retiene el grueso de la funcionalidad</em>. En este caso inicializar una instancia de un coche y mantener sus velocidad en los lmites lgicos respondiendo a las acciones del usuario conductor.</p><h2 id=\"2-3-Envio-hacia-el-presentador-con-Input\"><a href=\"#2-3-Envio-hacia-el-presentador-con-Input\" class=\"headerlink\" title=\"2.3 Envo hacia el presentador con @Input()\"></a>2.3 Envo hacia el presentador con @Input()</h2><p>Esta comunicacin <em>hacia abajo</em> enva la informacin <strong>desde el contenedor hacia el presentador</strong>. Es similar a como una plantilla recibe la informacin desde el controlador.</p><h3 id=\"Input\"><a href=\"#Input\" class=\"headerlink\" title=\"@Input()\"></a>@Input()</h3><p>Para que una vista muestre datos tiene que usar directivas como <code></code> asociada a una propiedad pblica de la clase componente. Se supone que dicha clase es la responsable de su valor. Pero tambin puede <strong>recibirlo desde el exterior</strong>. La novedad es hacer que lo reciba va <em>html</em>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> &#123;&#123; model &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> Top speed: &#123;&#123; topSpeed | number:'1.0-0' &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"card\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"section\"</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; currentSpeed | number:'1.2-2' &#125;&#125; &#123;&#123; units &#125;&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">progress</span> [<span class=\"attr\">value</span>]=<span class=\"string\">\"currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">ngClass</span>]=<span class=\"string\">\"getSpeedClass()\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">max</span>]=<span class=\"string\">\"topSpeed\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">progress</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Empieza por decorar con <code>@Input()</code> la propiedad que quieres usar desde fuera. Por ejemplo un cdigo como este del archivo <code>display.component.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> DisplayComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> model: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> currentSpeed: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> topSpeed: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> units: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> getSpeedClass = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.currentSpeed &lt; <span class=\"keyword\">this</span>.getThreshold() ? <span class=\"string\">'primary'</span> : <span class=\"string\">'secondary'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> getThreshold = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.topSpeed * <span class=\"number\">0.8</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora puedes enviarle datos a este componente desde el <em>html</em> de su consumidor. Por ejemplo desde <code>car.component.html</code> le puedo enviar una variable o cualquier expresin evaluable. Recordemos como usa <code>[propiedad]=&quot;expresion&quot;</code> en el elemento presentador.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-display</span> [<span class=\"attr\">model</span>]=<span class=\"string\">\"car.name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">currentSpeed</span>]=<span class=\"string\">\"car.currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">topSpeed</span>]=<span class=\"string\">\"car.maxSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">units</span>]=<span class=\"string\">\"'Km/h'\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">app-display</span>&gt;</span></span><br></pre></td></tr></table></figure><p>En la clase controladora del presentador quedan responsabilidades reducidas a temas especficos como determinar las clases <em>css</em> apropiadas o transformar los datos para su presentacin.</p><p>Estoy usando al componente de nivel inferior como un presentador; mientras que el contenedor superior acta como controlador. Este mismo patrn puede y debe repetirse hasta <strong>descomponer las vistas en estructuras simples</strong> que nos eviten repeticiones absurdas en cdigo.</p><p>De esta forma es fcil crear componentes reutilizables; y queda muy limpio el <strong>envo de datos hacia abajo</strong>. Pero, y hacia arriba?.</p><h2 id=\"2-4-Respuesta-del-presentador-con-Output\"><a href=\"#2-4-Respuesta-del-presentador-con-Output\" class=\"headerlink\" title=\"2.4. Respuesta del presentador con @Output()\"></a>2.4. Respuesta del presentador con @Output()</h2><p>Los componentes de nivel inferior no slo se dedican a presentar datos, tambin presentan controles. Con ellos el usuario podr crear, modificar o eliminar los datos que quiera. Aunque no directamente; para hacerlo <strong>comunican el cambio requerido al contenedor de nivel superior</strong>.</p><h3 id=\"Output\"><a href=\"#Output\" class=\"headerlink\" title=\"@Output()\"></a>@Output()</h3><p>Por ejemplo, el componente <code>PedalsComponent</code> permite acelerar y frenar. Bueno, realmente permite que el usuario diga que lo quiere hacer; los cambios se harn ms arriba. Veamos lo bsico del <code>pedals.component.html</code> antes de nada:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> Pedals: <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"brake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">\"secondary\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"disableBrake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    (<span class=\"attr\">click</span>)=<span class=\"string\">\"brake.emit(1)\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"throttle\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">\"tertiary\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"disableThrottle\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    (<span class=\"attr\">click</span>)=<span class=\"string\">\"throttle.emit(1)\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Claramente son un par de botones que con el evento <code>(click)</code> responden a acciones del usuario. En este caso se manifiesta una intencin de acelerar o frenar el coche. Pero el mtodo del controlador no acta directamente sobre los datos.</p><blockquote><p>Si lo hiciera sera ms difcil gestionar los cambios e imposibilitara el uso de inmutables o tcnicas ms avanzadas de programacin que se vern ms adelante</p></blockquote><p>En su lugar, lo que hace es <strong>emitir un evento</strong> confiando que alguien lo reciba y acte en consecuencia. Por ejemplo la emisin de la instruccin de frenado se realiza mediante la propiedad <code>brake</code> decorada con <code>@Output() public brake new EventEmitter&lt;number&gt;();</code>. Dicha propiedad ser una instancia de un emisor de eventos que mediante el mtodo <code>.next()</code> que emite la seal hacia arriba.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> PedalsComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> disableBrake: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> disableThrottle: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Output</span>() <span class=\"keyword\">public</span> brake = <span class=\"keyword\">new</span> EventEmitter&lt;<span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\">  <span class=\"meta\">@Output</span>() <span class=\"keyword\">public</span> throttle = <span class=\"keyword\">new</span> EventEmitter&lt;<span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Mientras tanto, <strong>en el contenedor la vista se subscribe al evento</strong> <code>(brake)</code> como si este fuese un evento nativo y llama a los mtodos que manipulan los datos de verdad.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-pedals</span> (<span class=\"attr\">brake</span>)=<span class=\"string\">\"onBrake($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">disableBrake</span>]=<span class=\"string\">\"disableBrake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            (<span class=\"attr\">throttle</span>)=<span class=\"string\">\"onThrottle($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">disableThrottle</span>]=<span class=\"string\">\"disableThrottle\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">app-pedals</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Las propiedades <em>output</em> tambin pueden enviar argumentos que sern recibidos mediante el identificador <code>$event</code> propio del framework. Se declaran especificando el tipo del argumento en el genrico del constructor de <code>EventEmitter&lt;any&gt;</code>.</p><p>En el controlador ya podemos operar con los datos. El mtodo <code>onBrake(drive: number)</code> accede y modifica el valor de la velocidad y lo notifica automticamente hacia abajo.</p><p>De esta manera se cierra el crculo. Los componentes de bajo nivel pueden <strong>recibir datos para ser presentados o emitir eventos para modificarlos</strong>. El componente de nivel superior es el <strong>nico responsable de obtener y actuar</strong> sobre los datos.</p><h1 id=\"3-Comunicaciones-entre-paginas-o-estructuras\"><a href=\"#3-Comunicaciones-entre-paginas-o-estructuras\" class=\"headerlink\" title=\"3. Comunicaciones entre pginas o estructuras\"></a>3. Comunicaciones entre pginas o estructuras</h1><h2 id=\"3-1-Comunicacion-entre-distintas-paginas\"><a href=\"#3-1-Comunicacion-entre-distintas-paginas\" class=\"headerlink\" title=\"3.1 Comunicacin entre distintas pginas\"></a>3.1 Comunicacin entre distintas pginas</h2><p>En las aplicaciones hay <strong>comunicaciones de estado ms all de la pgina actual</strong>. La comunicacin entre pginas es responsabilidad del <code>@angular/router</code>. Una vez activada una ruta, el sistema carga un componente en el <code>&lt;router-outlet&gt;</code> correspondiente. No hay forma de comunicarse hacia <em>(arriba) o [abajo]</em> con algo desconocido. De una pgina a otra tampoco es problema pues la comunicacin va mediante los parmetros de la <em>url</em>.</p><p>Ya hemos usado esta comunicacin anteriormente en el tema <a href=\"../paginas-y-rutas-angular-spa/\">2-spa</a> el componente <code>AuthorComponent</code> es capaz de recibir por parmetros una identificacin de un autor. Esa informacin es el resultado de una accin del usuario en la pantalla <code>/about/authors</code> programada en el componente <code>AuthorsComponent</code>. Por tanto es una comunicacin entre componentes, en la que ambos son <em>controladores hermanos</em>.</p><blockquote><p>Desde luego habr que mejorar el acceso y control de los datos que por ahora es muy rudimentario. Lo haremos en prximos pasos. Primero mediante <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a> y despus usando <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a></p></blockquote><h2 id=\"2-2-Comunicacion-entre-estructuras-desacopladas\"><a href=\"#2-2-Comunicacion-entre-estructuras-desacopladas\" class=\"headerlink\" title=\"2.2 Comunicacin entre estructuras desacopladas\"></a>2.2 Comunicacin entre estructuras desacopladas</h2><p>Estando en la misma ruta, no siempre se podrn conocer los componentes, y por tanto no se podrn usar sus <code>[propiedades] y (eventos)</code></p><h3 id=\"2-2-1-El-layout-principal-y-los-componentes-por-ruta-paginas\"><a href=\"#2-2-1-El-layout-principal-y-los-componentes-por-ruta-paginas\" class=\"headerlink\" title=\"2.2.1 El layout principal y los componentes por ruta pginas.\"></a>2.2.1 El layout principal y los componentes por ruta pginas.</h3><p>Una situacin habitual es <strong>comunicar la vista de negocio activa con elementos generales</strong> de la pgina. Por ejemplo podras querer mostrar la velocidad mxima alcanzada en la barra del men o un un mensaje emergente cada vez que se alcance la velocidad lmite. En este caso, el <code>&lt;router-outlet&gt;</code> es una barrera que impide usar el patrn contendor-presentador pues no se puede predecir el contenido dinmico que carga el <code>RouterOutlet</code>.</p><h3 id=\"2-2-2-Multiples-niveles-de-presentadores\"><a href=\"#2-2-2-Multiples-niveles-de-presentadores\" class=\"headerlink\" title=\"2.2.2 Mltiples niveles de presentadores.\"></a>2.2.2 Mltiples niveles de presentadores.</h3><p>Cuando las pantallas se hacen realmente complejas empiezan a surgir <strong>rboles de componentes</strong> de muchos niveles de profundidad. En estas situaciones mantener un nico controlador a nivel raz es poco prctico. Enviar hacia abajo las <code>[propiedades]</code> es tedioso, pero peor an es hacer burbujear los <code>(eventos)</code> por varias capas de presentadores.</p><p>La solucin en ambos casos pasa por permitir que <em>algunos componentes presentadores tengan su propio control de datos</em>. Este tipo de comunicaciones tcnicamente se resuelve mediante <em>Observables</em> y merece un captulo especial que se ver ms adelante en esta serie. Incluso en situaciones complejas habr que optar por patrones avanzados de gestin de estado como pueda ser <em>Redux</em>.</p><p>Por ahora tienes una aplicacin en <em>Angular</em> que comunica datos y cambios entre componentes de una misma pgina. Sigue el tutorial para aadirle <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a> mientras aprendes a programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-4_flow.png\" alt=\"flujo-de-datos-entre-componentes-angular\"></p><p>Los desarrollos profesionales son complicados pero <strong>con Angular tenemos soluciones de comunicacin simples para pantallas complejas</strong>. Mediante el desarrollo de componentes atmicos y reutilizables Angular 7 favorece la implementacin de buenas prcticas.</p><p>Crear y comunicar muchos componentes puede llevarnos a cdigo difcil de seguir. La librera <code>@angular/forms</code> ofrece <em>tuberas de comunicacin</em> para <strong>mantener el flujo de datos bajo control</strong>.</p>","more":"<p>Partiendo de la aplicacin tal cmo qued en <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a>. Al finalizar tendrs una aplicacin que reparte la responsabilidad de recoger y presentar datos en componentes.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/4-flow/car\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/4-flow</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-Comunicacion-entre-componentes\"><a href=\"#1-Comunicacion-entre-componentes\" class=\"headerlink\" title=\"1. Comunicacin entre componentes\"></a>1. Comunicacin entre componentes</h1><p>Las aplicaciones web en las que destaca Angular suelen ser complejas y con mucha variedad funcional en diversas pginas. A menudo esas pginas estn repletas de formularios, informes y botones. La solucin viene de mano del viejo principio <em>divide y vencers</em>: <strong>La componentizacin</strong></p><h2 id=\"1-1-Necesidad-de-comunicacion\"><a href=\"#1-1-Necesidad-de-comunicacion\" class=\"headerlink\" title=\"1.1. Necesidad de comunicacin\"></a>1.1. Necesidad de comunicacin</h2><p>El <em>framework</em> permite y recomienda repartir el trabajo en mltiples componentes de responsabilidad nica. Tambin es prctica comn el crear pginas especficas para situaciones concretas aunque relacionadas. Por supuesto que estructuras como el men de navegacin o secciones de estado general necesitan conocer datos provenientes de las pginas. Nada est completamente asilado. Esto nos enfrenta la problema de <strong>comunicar componentes</strong>.</p><h2 id=\"1-2-Escenarios\"><a href=\"#1-2-Escenarios\" class=\"headerlink\" title=\"1.2. Escenarios\"></a>1.2. Escenarios</h2><p>Las situaciones que te encontrars caern en alguna de estas tres categoras para las que hay soluciones especficas.</p><h3 id=\"Comunicar-componentes-acoplados\"><a href=\"#Comunicar-componentes-acoplados\" class=\"headerlink\" title=\"Comunicar componentes acoplados\"></a>Comunicar componentes acoplados</h3><p>Solemos empezar creando un componente por pgina. Pero es normal que esa pgina se complique y la solucin a la complejidad es la <strong>divisin en componentes y reparto de responsabilidades</strong>. Dado que estn en una misma pgina existe cierto acoplamiento entre ellos y eso nos facilitar la comunicacin.</p><h3 id=\"Comunicar-componentes-en-paginas-distintas\"><a href=\"#Comunicar-componentes-en-paginas-distintas\" class=\"headerlink\" title=\"Comunicar componentes en pginas distintas\"></a>Comunicar componentes en pginas distintas</h3><p>Cuando los componentes se carga en rutas distintas ya no hay forma de comunicarlos directamente. Pero lo resolveremos fcilmente <strong>usando las capacidades del router.</strong></p><h3 id=\"Comunicar-componentes-entre-estructuras-dinamicas\"><a href=\"#Comunicar-componentes-entre-estructuras-dinamicas\" class=\"headerlink\" title=\"Comunicar componentes entre estructuras dinmicas\"></a>Comunicar componentes entre estructuras dinmicas</h3><p>La situacin ms compleja se da cuando queremos comunicar componentes o servicios desacoplados pero sin cambio de pgina. En este caso har falta un <strong>mediador observable</strong>.</p><h1 id=\"2-El-patron-Contendor-Presentadores\"><a href=\"#2-El-patron-Contendor-Presentadores\" class=\"headerlink\" title=\"2. El patrn Contendor / Presentadores\"></a>2. El patrn Contendor / Presentadores</h1><p>En <strong>arquitectura de software</strong> cuando encontramos una solucin a un problema recurrente le ponemos un nombre y tratamos de utilizarlo siempre que podemos. Obviamente es una eleccin del programador y siempre tiene un coste que debe valorar. En este caso la ventaja es clara: <strong>reparto de responsabilidades</strong>.</p><h2 id=\"2-1-El-patron\"><a href=\"#2-1-El-patron\" class=\"headerlink\" title=\"2.1 El patrn\"></a>2.1 El patrn</h2><p>En este caso <strong>el patrn contendor/presentadores</strong> estipula que haya un nico componente responsable de obtener, mutar y guardar el estado. Ser el componente contenedor. Los presentadores sern responsables de.. ejem, presentar la informacin y los elementos de interaccin con el usuario. Las ventajas derivadas son: mayor facilidad para el <em>testeo</em> y mayores posibilidades de reutilizacin de presentadores.</p><blockquote><p>A este patrn a veces se le conoce como parent/children por la jerarqua html que genera.</p></blockquote><p>Veamos una implementacin sencilla. Haremos una interfaz mnima para simular el manejo de un coche. Habr pedales de aceleracin y freno, y un cuadro dnde se refleje la velocidad. Para todo ello vamos a usa el <em>Angular CLI</em> y crear un mdulo y sus componentes base.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m 4-flow/car</span><br><span class=\"line\">ng g c 4-flow/car/car</span><br><span class=\"line\">ng g c 4-flow/car/car/display</span><br><span class=\"line\">ng g c 4-flow/car/car/pedals</span><br></pre></td></tr></table></figure><p>Agregamos una ruta en el enrutador con su enlace en el men.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'car'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"string\">'./car/car.module#CarModule'</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"car\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> 4 - Car<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"2-2-El-contendor\"><a href=\"#2-2-El-contendor\" class=\"headerlink\" title=\"2.2 El contendor\"></a>2.2 El contendor</h2><p>En el componente contenedor tendremos <strong>una vista muy sencilla y un controlador ms complejo</strong>. La vista ser la composicin de los componentes presentadores, pero el controlador tendr que obtener datos, aplicarles lgica de negocio y guardarlos cuando corresponda.</p><blockquote><p>No es habitual asignarle un sufijo al nombre del componente para indicar que es el contendor. Suele ser suficiente el verlo en la raz de la jerarqua de carpetas.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-display</span> [<span class=\"attr\">model</span>]=<span class=\"string\">\"car.name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">currentSpeed</span>]=<span class=\"string\">\"car.currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">topSpeed</span>]=<span class=\"string\">\"car.maxSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">units</span>]=<span class=\"string\">\"'Km/h'\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">app-display</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-pedals</span> (<span class=\"attr\">brake</span>)=<span class=\"string\">\"onBrake($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">disableBrake</span>]=<span class=\"string\">\"disableBrake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            (<span class=\"attr\">throttle</span>)=<span class=\"string\">\"onThrottle($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">disableThrottle</span>]=<span class=\"string\">\"disableThrottle\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">app-pedals</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Vemos que usa los componentes presentadores <code>Display</code> y <code>Pedals</code> envindoles informacin y suscribindose a sus eventos. Concretaremos esta funcionalidad ms adelante.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> car: CarModel;</span><br><span class=\"line\"><span class=\"keyword\">public</span> disableBrake: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> disableThrottle: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.car = &#123; name: <span class=\"string\">'Roadster'</span>, maxSpeed: <span class=\"number\">120</span>, currentSpeed: <span class=\"number\">0</span> &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span> checkLimits() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.disableBrake = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.disableThrottle = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.car.currentSpeed &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.car.currentSpeed = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.disableBrake = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.car.currentSpeed &gt;= <span class=\"keyword\">this</span>.car.maxSpeed) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.car.currentSpeed = <span class=\"keyword\">this</span>.car.maxSpeed;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.disableThrottle = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> onBrake(drive: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.car.currentSpeed -= <span class=\"keyword\">this</span>.getDelta(drive);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> onThrottle(drive: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.car.currentSpeed += <span class=\"keyword\">this</span>.getDelta(drive);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.checkLimits();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span> getDelta = <span class=\"function\">(<span class=\"params\">drive: <span class=\"built_in\">number</span></span>) =&gt;</span></span><br><span class=\"line\">  drive + (<span class=\"keyword\">this</span>.car.maxSpeed - <span class=\"keyword\">this</span>.car.currentSpeed) / <span class=\"number\">10</span>;</span><br></pre></td></tr></table></figure><p>Lo dicho, <em>la clase controladora del componente contendor retiene el grueso de la funcionalidad</em>. En este caso inicializar una instancia de un coche y mantener sus velocidad en los lmites lgicos respondiendo a las acciones del usuario conductor.</p><h2 id=\"2-3-Envio-hacia-el-presentador-con-Input\"><a href=\"#2-3-Envio-hacia-el-presentador-con-Input\" class=\"headerlink\" title=\"2.3 Envo hacia el presentador con @Input()\"></a>2.3 Envo hacia el presentador con @Input()</h2><p>Esta comunicacin <em>hacia abajo</em> enva la informacin <strong>desde el contenedor hacia el presentador</strong>. Es similar a como una plantilla recibe la informacin desde el controlador.</p><h3 id=\"Input\"><a href=\"#Input\" class=\"headerlink\" title=\"@Input()\"></a>@Input()</h3><p>Para que una vista muestre datos tiene que usar directivas como <code></code> asociada a una propiedad pblica de la clase componente. Se supone que dicha clase es la responsable de su valor. Pero tambin puede <strong>recibirlo desde el exterior</strong>. La novedad es hacer que lo reciba va <em>html</em>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> &#123;&#123; model &#125;&#125; <span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> Top speed: &#123;&#123; topSpeed | number:'1.0-0' &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"card\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"section\"</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; currentSpeed | number:'1.2-2' &#125;&#125; &#123;&#123; units &#125;&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">progress</span> [<span class=\"attr\">value</span>]=<span class=\"string\">\"currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">ngClass</span>]=<span class=\"string\">\"getSpeedClass()\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">max</span>]=<span class=\"string\">\"topSpeed\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">progress</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Empieza por decorar con <code>@Input()</code> la propiedad que quieres usar desde fuera. Por ejemplo un cdigo como este del archivo <code>display.component.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> DisplayComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> model: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> currentSpeed: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> topSpeed: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> units: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> getSpeedClass = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.currentSpeed &lt; <span class=\"keyword\">this</span>.getThreshold() ? <span class=\"string\">'primary'</span> : <span class=\"string\">'secondary'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> getThreshold = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.topSpeed * <span class=\"number\">0.8</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora puedes enviarle datos a este componente desde el <em>html</em> de su consumidor. Por ejemplo desde <code>car.component.html</code> le puedo enviar una variable o cualquier expresin evaluable. Recordemos como usa <code>[propiedad]=&quot;expresion&quot;</code> en el elemento presentador.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-display</span> [<span class=\"attr\">model</span>]=<span class=\"string\">\"car.name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">currentSpeed</span>]=<span class=\"string\">\"car.currentSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">topSpeed</span>]=<span class=\"string\">\"car.maxSpeed\"</span></span></span><br><span class=\"line\"><span class=\"tag\">             [<span class=\"attr\">units</span>]=<span class=\"string\">\"'Km/h'\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">app-display</span>&gt;</span></span><br></pre></td></tr></table></figure><p>En la clase controladora del presentador quedan responsabilidades reducidas a temas especficos como determinar las clases <em>css</em> apropiadas o transformar los datos para su presentacin.</p><p>Estoy usando al componente de nivel inferior como un presentador; mientras que el contenedor superior acta como controlador. Este mismo patrn puede y debe repetirse hasta <strong>descomponer las vistas en estructuras simples</strong> que nos eviten repeticiones absurdas en cdigo.</p><p>De esta forma es fcil crear componentes reutilizables; y queda muy limpio el <strong>envo de datos hacia abajo</strong>. Pero, y hacia arriba?.</p><h2 id=\"2-4-Respuesta-del-presentador-con-Output\"><a href=\"#2-4-Respuesta-del-presentador-con-Output\" class=\"headerlink\" title=\"2.4. Respuesta del presentador con @Output()\"></a>2.4. Respuesta del presentador con @Output()</h2><p>Los componentes de nivel inferior no slo se dedican a presentar datos, tambin presentan controles. Con ellos el usuario podr crear, modificar o eliminar los datos que quiera. Aunque no directamente; para hacerlo <strong>comunican el cambio requerido al contenedor de nivel superior</strong>.</p><h3 id=\"Output\"><a href=\"#Output\" class=\"headerlink\" title=\"@Output()\"></a>@Output()</h3><p>Por ejemplo, el componente <code>PedalsComponent</code> permite acelerar y frenar. Bueno, realmente permite que el usuario diga que lo quiere hacer; los cambios se harn ms arriba. Veamos lo bsico del <code>pedals.component.html</code> antes de nada:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> Pedals: <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"brake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">\"secondary\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"disableBrake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    (<span class=\"attr\">click</span>)=<span class=\"string\">\"brake.emit(1)\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"throttle\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">\"tertiary\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"disableThrottle\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    (<span class=\"attr\">click</span>)=<span class=\"string\">\"throttle.emit(1)\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Claramente son un par de botones que con el evento <code>(click)</code> responden a acciones del usuario. En este caso se manifiesta una intencin de acelerar o frenar el coche. Pero el mtodo del controlador no acta directamente sobre los datos.</p><blockquote><p>Si lo hiciera sera ms difcil gestionar los cambios e imposibilitara el uso de inmutables o tcnicas ms avanzadas de programacin que se vern ms adelante</p></blockquote><p>En su lugar, lo que hace es <strong>emitir un evento</strong> confiando que alguien lo reciba y acte en consecuencia. Por ejemplo la emisin de la instruccin de frenado se realiza mediante la propiedad <code>brake</code> decorada con <code>@Output() public brake new EventEmitter&lt;number&gt;();</code>. Dicha propiedad ser una instancia de un emisor de eventos que mediante el mtodo <code>.next()</code> que emite la seal hacia arriba.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> PedalsComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> disableBrake: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Input</span>() <span class=\"keyword\">public</span> disableThrottle: <span class=\"built_in\">boolean</span>;</span><br><span class=\"line\">  <span class=\"meta\">@Output</span>() <span class=\"keyword\">public</span> brake = <span class=\"keyword\">new</span> EventEmitter&lt;<span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\">  <span class=\"meta\">@Output</span>() <span class=\"keyword\">public</span> throttle = <span class=\"keyword\">new</span> EventEmitter&lt;<span class=\"built_in\">number</span>&gt;();</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Mientras tanto, <strong>en el contenedor la vista se subscribe al evento</strong> <code>(brake)</code> como si este fuese un evento nativo y llama a los mtodos que manipulan los datos de verdad.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-pedals</span> (<span class=\"attr\">brake</span>)=<span class=\"string\">\"onBrake($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">disableBrake</span>]=<span class=\"string\">\"disableBrake\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            (<span class=\"attr\">throttle</span>)=<span class=\"string\">\"onThrottle($event)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            [<span class=\"attr\">disableThrottle</span>]=<span class=\"string\">\"disableThrottle\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">app-pedals</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Las propiedades <em>output</em> tambin pueden enviar argumentos que sern recibidos mediante el identificador <code>$event</code> propio del framework. Se declaran especificando el tipo del argumento en el genrico del constructor de <code>EventEmitter&lt;any&gt;</code>.</p><p>En el controlador ya podemos operar con los datos. El mtodo <code>onBrake(drive: number)</code> accede y modifica el valor de la velocidad y lo notifica automticamente hacia abajo.</p><p>De esta manera se cierra el crculo. Los componentes de bajo nivel pueden <strong>recibir datos para ser presentados o emitir eventos para modificarlos</strong>. El componente de nivel superior es el <strong>nico responsable de obtener y actuar</strong> sobre los datos.</p><h1 id=\"3-Comunicaciones-entre-paginas-o-estructuras\"><a href=\"#3-Comunicaciones-entre-paginas-o-estructuras\" class=\"headerlink\" title=\"3. Comunicaciones entre pginas o estructuras\"></a>3. Comunicaciones entre pginas o estructuras</h1><h2 id=\"3-1-Comunicacion-entre-distintas-paginas\"><a href=\"#3-1-Comunicacion-entre-distintas-paginas\" class=\"headerlink\" title=\"3.1 Comunicacin entre distintas pginas\"></a>3.1 Comunicacin entre distintas pginas</h2><p>En las aplicaciones hay <strong>comunicaciones de estado ms all de la pgina actual</strong>. La comunicacin entre pginas es responsabilidad del <code>@angular/router</code>. Una vez activada una ruta, el sistema carga un componente en el <code>&lt;router-outlet&gt;</code> correspondiente. No hay forma de comunicarse hacia <em>(arriba) o [abajo]</em> con algo desconocido. De una pgina a otra tampoco es problema pues la comunicacin va mediante los parmetros de la <em>url</em>.</p><p>Ya hemos usado esta comunicacin anteriormente en el tema <a href=\"../paginas-y-rutas-angular-spa/\">2-spa</a> el componente <code>AuthorComponent</code> es capaz de recibir por parmetros una identificacin de un autor. Esa informacin es el resultado de una accin del usuario en la pantalla <code>/about/authors</code> programada en el componente <code>AuthorsComponent</code>. Por tanto es una comunicacin entre componentes, en la que ambos son <em>controladores hermanos</em>.</p><blockquote><p>Desde luego habr que mejorar el acceso y control de los datos que por ahora es muy rudimentario. Lo haremos en prximos pasos. Primero mediante <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a> y despus usando <a href=\"../comunicaciones-http-en-Angular/\">Comunicaciones HTTP en Angular</a></p></blockquote><h2 id=\"2-2-Comunicacion-entre-estructuras-desacopladas\"><a href=\"#2-2-Comunicacion-entre-estructuras-desacopladas\" class=\"headerlink\" title=\"2.2 Comunicacin entre estructuras desacopladas\"></a>2.2 Comunicacin entre estructuras desacopladas</h2><p>Estando en la misma ruta, no siempre se podrn conocer los componentes, y por tanto no se podrn usar sus <code>[propiedades] y (eventos)</code></p><h3 id=\"2-2-1-El-layout-principal-y-los-componentes-por-ruta-paginas\"><a href=\"#2-2-1-El-layout-principal-y-los-componentes-por-ruta-paginas\" class=\"headerlink\" title=\"2.2.1 El layout principal y los componentes por ruta pginas.\"></a>2.2.1 El layout principal y los componentes por ruta pginas.</h3><p>Una situacin habitual es <strong>comunicar la vista de negocio activa con elementos generales</strong> de la pgina. Por ejemplo podras querer mostrar la velocidad mxima alcanzada en la barra del men o un un mensaje emergente cada vez que se alcance la velocidad lmite. En este caso, el <code>&lt;router-outlet&gt;</code> es una barrera que impide usar el patrn contendor-presentador pues no se puede predecir el contenido dinmico que carga el <code>RouterOutlet</code>.</p><h3 id=\"2-2-2-Multiples-niveles-de-presentadores\"><a href=\"#2-2-2-Multiples-niveles-de-presentadores\" class=\"headerlink\" title=\"2.2.2 Mltiples niveles de presentadores.\"></a>2.2.2 Mltiples niveles de presentadores.</h3><p>Cuando las pantallas se hacen realmente complejas empiezan a surgir <strong>rboles de componentes</strong> de muchos niveles de profundidad. En estas situaciones mantener un nico controlador a nivel raz es poco prctico. Enviar hacia abajo las <code>[propiedades]</code> es tedioso, pero peor an es hacer burbujear los <code>(eventos)</code> por varias capas de presentadores.</p><p>La solucin en ambos casos pasa por permitir que <em>algunos componentes presentadores tengan su propio control de datos</em>. Este tipo de comunicaciones tcnicamente se resuelve mediante <em>Observables</em> y merece un captulo especial que se ver ms adelante en esta serie. Incluso en situaciones complejas habr que optar por patrones avanzados de gestin de estado como pueda ser <em>Redux</em>.</p><p>Por ahora tienes una aplicacin en <em>Angular</em> que comunica datos y cambios entre componentes de una misma pgina. Sigue el tutorial para aadirle <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a> mientras aprendes a programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Comunicaciones http en Angular","date":"2019-02-28T13:06:00.000Z","thumbnail":"/css/images/angular-6_http.png","_content":"\n![comunicaciones-http-en-Angular](/images/tutorial-angular-6_http.png)\n\nLas comunicaciones _http_ son una pieza fundamental del desarrollo web, y en **Angular** siempre han sido potentes y fciles. Siempre?, bueno cuando apareci Angular 2 echbamos en falta algunas cosillas... y adems la librera *RxJS* y sus *streams* son intimidantes para los novatos.\n\nPero en la versin Angular 7 **consumir un servicio REST** puede ser cosa de nios si aprendes a jugar con los _observables_ y los servicios de la librera `@angular/common/http`. Conseguirs realizar **comunicaciones http asncronas en Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/). Al finalizar tendrs una aplicacin que almacena y recupera los datos consumiendo un servicio REST usando las tecnologas de Angular Http.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/6-http](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/6-http/rates)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n# 1. El servicio HttpClient\n\nComo demostracin vamos a consumir un API pblica con datos de [cotizacin de monedas](https://exchangeratesapi.io/). Crear un mdulo y un componente en el que visualizar las divisas y despus las transformaremos para guardarlas en un servicio propio.\n\n```shell\nng g m 6-http/rates --routing true\nng g c 6-http/rates/rates\n```\n\n## 1.1 Importacin y declaracin de servicios\n\nLa librera `@angular/common/http` trae el mdulo `HttpClientModule` con el servicio inyectable `HttpClient`. Lo primero es importar dicho mdulo.\n\n```typescript\nimport { HttpClientModule } from '@angular/common/http';\n\n@NgModule({\n  declarations: [RatesComponent],\n  imports: [HttpClientModule]\n})\nexport class RatesModule { }\n```\n\nEn tu componente tienes que reclamar la dependencia al servicio para poder usarla. Atencin a la importacin pues hay ms clases con el nombre `HttpClient`. Debe quedar algo as:\n\n```typescript\nimport { HttpClient } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-rates',\n  templateUrl: './rates.component.html',\n  styles: []\n})\nexport class RatesComponent implements OnInit {\n  constructor(private httpClient: HttpClient) {}\n\n  ngOnInit() {}\n}\n```\n\nA partir de este momento slo queda invocar los mtodos REST en la propiedad `this.http`.\n\n## 1.2 Obtencin de datos\n\nPara cada verbo _http_ tenemos su mtodo en el servicio `HttpClient`. Su primer parmetro ser la *url* a la que invocar. Empecemos por el `get` que automticamente solicita y devuelve objetos _JSON_ desde un API. Por ejemplo para obtener [las ltimas cotizaciones de las principales divisas](https://api.exchangeratesapi.io/latest?symbols=USD,GBP,CHF,JPY) lo haremos as:\n\n\n```typescript\nexport class RatesComponent implements OnInit {\n  private urlapi\n    = 'https://api.exchangeratesapi.io/latest';\n  public currentEuroRates: any = null;\n\n  constructor(private httpClient: HttpClient) {}\n\n  ngOnInit() {\n    this.getCurrentEuroRates();\n  }\n\n  private getCurrentEuroRates() {\n    const currencies = 'USD,GBP,CHF,JPY';\n    const url = `${this.urlapi}?symbols=${currencies}`;\n    this.httpClient\n      .get(url)\n      .subscribe(apiData => (this.currentEuroRates = apiData));\n  }\n}\n```\n\n> El mtodo _get_ retorna un objeto observable. Los observables _http_ han de consumirse mediante el mtodo _subscribe_ para que realmente se lancen. Dicho mtodo _subscribe_ admite hasta tres _callbacks_: `susbcribe(data, err, end)` para que se ejecuten en respuesta a eventos. En este ejemplo solo hemos usado el primero.\n\nLa presentacin en la vista slo tiene que acceder a la propiedad dnde se hayan cargado las respuestas tratadas en el _callback_ de la suscripcin.\n\n```html\n<h2> Currency Rates. </h2>\n<h3> From Euro to the world </h3>\n<pre>{{ currentEuroRates | json }}</pre>\n```\n\n\n## 1.3 Envo de datos\n\nSupongamos que, una vez recibidas las cotizaciones, pretendemos transformarlas y almacenarlas en otro servicio. El envo en este caso ser con el mtodo _post_ al que se le pasar la ruta del _end point_ y el objeto _payload_ que se enviar al servidor.\n\nVamos a agregar una propiedad y un par de mtodos al `rates-component.ts`. La idea es obtener un array de cotizaciones aa partir del objeto previo, y guardarla una por una.\n\n```typescript\nexport class RatesComponent implements OnInit {\n  private myRatesApi\n    = 'https://api-base.herokuapp.com/api/pub/rates';\n\n  public postRates() {\n    const rates = this.transformData();\n    rates.forEach(rate =>\n      this.httpClient\n        .post(this.myRatesApi, rate)\n        .subscribe()\n    );\n  }\n\n  private transformData() {\n    const current = this.currentEuroRates.rates;\n    return Object.keys(current).map(key => ({\n      date: this.currentEuroRates.date,\n      currency: key,\n      euros: current[key]\n    }));\n  }\n}\n```\n> Atencin a los mtodos `subscribe()`. Aunque vayan vacos son imprescindibles para que se ejecute la llamada.\n\nEn la vista no hay gran cosa que hacer, salvo agregarle un botn para iniciar el proceso:\n\n```html\n<input value=\"Save Rates\" type=\"button\" (click)=\"postRates()\" />\n```\n\n## 1.4 Actualizacin de datos\n\nUn par de ejemplo ms para acabar de entender la mecnica bsica de `HttpClient`. Podemos fijar el tipo de datos esperado en cualquier llamada. De hecho es recomendable que tengas un interfaz para cada respuesta esperada.\n\nEn este tutorial no se ha hecho y no quedamos con el `any`, pero al menos distinguimos entre objetos y arrays. Esto es lo que aado al `RatesComponent` para que muestre los datos guardados en mi API.\n\n```typescript\nexport class RatesComponent implements OnInit {\n private myRatesApi\n  = 'https://api-base.herokuapp.com/api/pub/rates';\n public myRates: any[] = null;\n\n public getMyRates() {\n    this.httpClient\n      .get<any[]>(this.myRatesApi)\n      .subscribe(apiResult => (this.myRates = apiResult));\n  }\n}\n```\nY en la vista, un nuevo botn y una nueva expresin.\n\n```html\n<input value=\"Refresh\" type=\"button\" (click)=\"getMyRates()\" />\n<pre>{{ myRates | json }}</pre>\n```\n\nPor ltimo, en plan repaso, un ejemplo de mtodo para borrar.\n\n```typescript\npublic deleteMyRates() {\n  this.httpClient\n    .delete(this.myRatesApi)\n    .subscribe();\n}\n```\nY su botn en en la vista.\n\n```html\n<input value=\"Delete Rates\" type=\"button\" (click)=\"deleteMyRates()\" />\n```\n\nY hasta aqu lo bsico de comunicaciones *http*. Fcil verdad?. Pero la vida real raramente es tan sencilla. Si quieres enfrentarte a algo ms duro debes prepararte y dominar los observables *RxJS*.\n\nLo que viene a partir de ahora requerir tiempo y concentracin. Si continas adelante esto ya no ser *your grandpas http anymore*.\n\n# 2 Observables\n\nLas **comunicaciones** entre navegadores y servidores son varios rdenes de magnitud ms lentas que las operaciones en memoria. Por tanto deben realizarse de manera asncrona para garantizar una buena experiencia al usuario.\n\nEsta experiencia no siempre fue tan buena para el programador. Sobre todo con las primeras comunicaciones _AJAX_ basadas en el paso de funciones _callback_. La aparicin de las _promises_ mejor la claridad del cdigo, y ahora con los _Observables_ tenemos adems una gran potencia para manipular la **informacin asncrona**.\n\n> El patrn `Observable` fue implementado por Microsoft en la librera [_Reactive Extensions_](http://reactivex.io/intro.html) ms conocida como `RxJs`. El equipo de Angular decidi utilizarla para el desarrollo de las comunicaciones asncronas. Esta extensa librera puede resultar intimidante en un primer vistazo. Pero con muy poco conocimiento puedes programar casi todas las funcionalidades que se te ocurran.\n\nLo primero es importar el cdigo, de forma similar a cualquier otra clase o funcin. Por ejemplo para empezar basta con `import { Observable } from \"rxjs/Observable\";`. Tendremos la clase usada por angular para observar el respuesta *http*.\n\nPero esta es una clase genrica donde sus instancias admiten la manipulacin interna de tipos ms o menos concretos. Por eso ves en el ejemplo que algunas funciones retornan el tipo esperado `: Observable<MyClass>`, o si no saben que tipo esperar se conforman con `: Observable<any>`.\n\nEn cualquier caso, **toda operacin asncrona retornar una instancia observable** a la cual habr que subscribirse para recibir los datos o los errores, cuando termine.\nAunque a veces no se ver el _subscribe_...\n\n## 2.1 Async\n\nPara probar otras formas de presentar datos recibidos desde un API, voy a crear un nuevo componente. El `ObseratesComponent`, mezcla de _observables_ y _rates_.\n\n```shell\nng g c 6-http/rates/obserates\n```\n\nY en su vista HTML usar una funcin propia de Angular llamada `async`. Dicha funcin acta como un _pipe_ en una expresin. Igual que el `| json`. Pero a su izquierda espera que le den algo a lo que suscribirse; espera un observable.\n\n```html\n<h2> Currency Observable Rates. </h2>\n<h3> From Euro to the $ world </h3>\n<pre>{{ currentEuroRates$ | async | json }}</pre>}\n```\n\nEn este caso uso la propiedad `currentEuroRates$` finalizada en **$** por convenio. Esa propiedad se rellena en el controlador con el mtodo `get`, no con los datos futuros, si no con el propio _observable_.\n\n```typeScript\nprivate ratesApi\n  = 'https://api.exchangeratesapi.io/latest';\npublic currentEuroRates$: Observable<any> = null;\n\nconstructor(private httpClient: HttpClient) {}\n\nngOnInit() {\n  this.getCurrentEuroRates();\n}\n\nprivate getCurrentEuroRates() {\n  const currencies = 'USD,GBP,CHF,JPY';\n  const url = `${this.ratesApi}?symbols=${currencies}`;\n  this.currentEuroRates$ = this.httpClient.get(url);\n}\n```\n> Al utilizar el _pipe async_ ya no es necesaria la suscripcin en cdigo. La propia funcin del framework se ocupa de ello. Por tanto la llamada se realiza igualmente aunque no veamos la suscripcin.\n\nEsta es la manera recomendada de consumir datos desde un API. Definir la llamada en el controlador y pasarle el observable a la vista para que lo muestre cuando obtenga los datos.\n\n\n## 2.2 Pipe\n\n### Tuberas en RxJS .pipe()\n\nLos datos devueltos raramente vienen en el formato preciso para usar en la vista. Con frecuencia hay que transformarlos al vuelo en cuanto se reciben. Recordemos que ***HttpClient* no devuelve los datos tal cual sino un *stream* de estados** de dichos datos. La manipulacin ser sobre el *stream* no directamente sobre los datos; y, claro, para manipular un torrente hay que encauzarlo en tuberas.\n\nAqu es donde aparece el mtodo `.pipe(operator1, operator2...)` aplicado a un observable. Suele hacerse en lugar, o antes, del `.susbcribe(okCallback, errCallback)`. Este mtodo canaliza una serie de operadores predefinidos que manipulan el chorro de estados observados.\n\nEl operador ms utilizado es `map(sourceStream => targetStream)`. Este operador recibe una funcin *callBack* que ser invocada ante cada dato recibido. Esa funcin tienen que retornar un valor para sustituir al actual y as transformar el contenido del chorro.\n\n```typescript\npublic myRates$: Observable<any[]> = null;\nprivate getCurrentEuroRates() {\n  const url = `${this.ratesApi}?symbols=USD,GBP,CHF,JPY`;\n  this.currentEuroRates$ = this.httpClient.get(url);\n  this.myRates$ = this.currentEuroRates$.pipe(map(this.transformData));\n}\nprivate transformData(currentRates) {\n  const current = currentRates.rates;\n  return Object.keys(current).map(key => ({\n    date: currentRates.date,\n    currency: key,\n    euros: current[key]\n  }));\n}\n```\n\n> En este ejemplo partimos de nuevo de un objeto recibido y lo queremos ver como un *array* de objetos. Para ello lo transformamos usado el operador `map`. Este operador ha de importarse de `rxjs/operators` y aplicarse a un observable dentro de su mtodo `.pipe()`. Es el ms sencillo y uno de los ms utilizados: recibe y emite datos dentro de un stream de eventos observables. Nada que ver, salvo el nombre, con la sencilla funcin `array.map(callback)`, que recibe y devuelve datos estticos.\n\n```html\n<pre>{{ myRates$ | async | json }}</pre>\n```\nPor lo dems el consumo se hace igual... pero... tendremos que ver ms operadores para solucionar algunos inconvenientes.\n\n## 2.3 Operators\n\nEl cdigo anterior funciona, pero resulta que al haber dos funciones async suscritas provoca que la llamada original se realice dos veces. esto es as porque el segundo observable `myRates$` es una canalizacin del primero `currentEuroRates$`.\n\nEstos y oros problemas se solucionan usando operadores. Vamos a conocer un par de ellos ms y veremos como `pipe(op1, op2,  opn)` los ejecuta a todos en orden.\n\nEl operador `share()` permite compartir el resultado de una primera llamada con subsiguientes suscriptores. Evitando de ese modo la repeticin de costosas peticiones http.\n\n```typescript\nprivate getCurrentEuroRates() {\nconst url = `${this.ratesApi}?symbols=USD,GBP,CHF,JPY`;\n  this.currentEuroRates$ = this.httpClient.get(url)\n      .pipe(share());\n  this.myRates$ = this.currentEuroRates$\n      .pipe(\n        tap(d=>console.log(d)),\n        map(this.transformData),\n        tap(t=>console.log(t))\n      );\n}\n```\n\n> El operador `tap(callback)` es similar en nombre al `map()`. Pero la gran diferencia es que est pensado para no manipular los datos que recibe. Los usa y puede causar otros efectos colaterales, pero nunca modifica el propio stream. Es muy utilizado para inspeccionar o auditar el flujo de otros operadores.\n\n\nReconozco que en un primer vistazo este cdigo pueda resultar complejo. Tmate tu tiempo. Fjate en los datos de entrada y salida de cada funcin. Esto es solo el principio del trabajo con la librera *RxJS* y la manipulacin de *streams de eventos observables*.\n\n# 3. Interceptores\n\nLos interceptores tienen un nombre intimidante pero un propsito sencillo y muy til: **interceptar todas las comunicaciones http** y ejecutar cdigo personalizado para cada uno. Por ejemplo un gestor centralizado de errores http o el control de los tokens de seguridad de la aplicacin.\n\nPero antes de eso habr que aprender unos conceptos bsicos. Vamos a ver un ejemplo sencillo que audite todas las llamadas http. Todo empieza con un servicio:\n\n```console\nng g s rates/AuditInterceptor\n```\n\n## 3.1 La interfaz HttpInterceptor\n\nAl servicio genrico recin creado hay que hacerle cumplir una interfaz `HttpInterceptor` que viene con `HttpClientModule`. Esta interfaz solo necesita un mtodo, el `intercept(req, next)` pero sus tipos e implementacin mnima la hacen complicada de entender a la primera.\n\n```typescript\nimport { HttpEvent, HttpHandler, HttpInterceptor, HttpRequest }\n  from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuditInterceptorService implements HttpInterceptor {\n  public intercept( req: HttpRequest<any>, next: HttpHandler )\n    : Observable<HttpEvent<any>> {\n    return next.handle(req);\n  }\n\n  constructor() { }\n}\n```\n\nTodo este cdigo para nada. Porque eso es lo que hace, nada. Eso s, tampoco rompe ni bloquea nada. Vayamos por partes, primero los parmetros, luego el tipo de la respuesta y por ltimo la implementacin\n\n- `req: HttpRequest<any>`  puntero a la peticin en curso\n- `next: HttpHandler`  puntero a la siguiente funcin que maneje la peticin\n- `: Observable<HttpEvent<any>>` retornamos un stream de eventos http para cada peticin\n- `return next.handle(req);`  que el siguiente procese la peticin, sin hacerle nada en absoluto\n\n> Para entenderlo mejor puede ser til la siguiente analoga. Cuando usas httpClient.get() es como si pides algo a Amazon y te suscribes, es decir esperas el paquete. Pasado el tiempo el paquete llegar o no llegar, pero ya no lo gestionas t. Con los interceptores es como si espiases cada proceso de tu pedido: stock, picking, packaging, shipping... Cada pedido es tratado en una sucesin de eventos. Con un interceptor observas !todos los eventos de todos los pedidos!\n\n## 3.2 Inversin del control va token\n\nTenemos un servicio que cumple una interfaz compleja. Pero dicho servicio debe ser provedo en algn mdulo antes de ser reclamado como dependencias por alguien. Pero por quin?\n\nTcnicamente lo necesita el propio `HttpClient` del framework. Pero, obviamente, no pueden reclamar por tipo una clase que acabo de inventarme yo. Adelante con la **inversin del control**.\n\nRealmente `HttpClient` depende de algo que por convenio llaman token de tipo `HTTP_INTERCEPTORS`. Nuestro trabajo consiste en que cuando reclame su dependencia, le demos la nuestra. El tpico gato por liebre. As en nuestro mdulo pondremos la siguiente configuracin.\n\n```TypeScript\nproviders: [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useClass: AuditInterceptorService,\n    multi: true\n  }\n]\n```\nEl parmetro `multi:true` en este caso le indica que puede haber ms de un interceptor. Concretamente debe aadirlo a la lista y admitir ms. Hecho esto, sobrara el `providedIn: 'root'` autogenerado en el decorador del servicio.\n\n## 3.3 Un auditor de llamadas\n\nPues ya estamos listos para aportar algo de funcionalidad. Nuestro objetivo es escribir en el _log_ un texto para cada llamada terminada y el tiempo que le tom. La idea es aprovechar que todo es un _stream_ observable y canalizarlo en una tubera con una serie de operadores.\n\n```Typescript\nexport class AuditInterceptorService implements HttpInterceptor {\n  constructor() {}\n\n  public intercept(req: HttpRequest<any>, next: HttpHandler){\n    const started = Date.now();\n    return next.handle(req).pipe(\n      filter((event: HttpEvent<any>) => event instanceof HttpResponse),\n      tap((resp: HttpResponse<any>) => this.auditEvent(resp, started))\n    );\n  }\n\n  private auditEvent(resp: HttpResponse<any>, started: number) {\n    const elapsedMs = Date.now() - started;\n    const eventMessage = resp.statusText + ' on ' + resp.url;\n    const message = eventMessage + ' in ' + elapsedMs + 'ms';\n    console.log(message);\n  }\n}\n```\n\nEl operador `filter(any=>bool)` se usa para descartar eventos que no cumplan unos criterios. En mi caso slo me interesan los eventos de recepcin de la peticin, y no necesito los intermedios. Uso de nuevo el `tap(callback)` para hacer cosas con los datos sin modificarlos en absoluto. En este caso los envo al mtodo `auditEvent` para que lo saque por consola. Listo: un auditor para todas las llamadas.\n\nYa tenemos el programa comunicado por _http_ con un servidor; aunque por ahora de forma annima y sin ninguna seguridad. Con el conocimiento actual de los observables, del _httpClient_ y de los interceptores ya estamos cerca de resolverlo. Sigue esta serie para aadirle [vigilancia y seguridad en Angular](../vigilancia-y-seguridad-en-Angular/) mientras aprendes a programar con Angular.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-6-comunicaciones-http-en-angular.md","raw":"---\ntitle: Comunicaciones http en Angular\npermalink: comunicaciones-http-en-Angular\ndate: 2019-02-28 14:06:00\ntags:\n- Angular\n- http\n- RxJS\n- Observables\n- Tutorial\n- Introduccin\n- Angular7\n- Angular2\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-6_http.png\n---\n\n![comunicaciones-http-en-Angular](/images/tutorial-angular-6_http.png)\n\nLas comunicaciones _http_ son una pieza fundamental del desarrollo web, y en **Angular** siempre han sido potentes y fciles. Siempre?, bueno cuando apareci Angular 2 echbamos en falta algunas cosillas... y adems la librera *RxJS* y sus *streams* son intimidantes para los novatos.\n\nPero en la versin Angular 7 **consumir un servicio REST** puede ser cosa de nios si aprendes a jugar con los _observables_ y los servicios de la librera `@angular/common/http`. Conseguirs realizar **comunicaciones http asncronas en Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Servicios inyectables en Angular](../servicios-inyectables-en-Angular/). Al finalizar tendrs una aplicacin que almacena y recupera los datos consumiendo un servicio REST usando las tecnologas de Angular Http.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/6-http](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/6-http/rates)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n# 1. El servicio HttpClient\n\nComo demostracin vamos a consumir un API pblica con datos de [cotizacin de monedas](https://exchangeratesapi.io/). Crear un mdulo y un componente en el que visualizar las divisas y despus las transformaremos para guardarlas en un servicio propio.\n\n```shell\nng g m 6-http/rates --routing true\nng g c 6-http/rates/rates\n```\n\n## 1.1 Importacin y declaracin de servicios\n\nLa librera `@angular/common/http` trae el mdulo `HttpClientModule` con el servicio inyectable `HttpClient`. Lo primero es importar dicho mdulo.\n\n```typescript\nimport { HttpClientModule } from '@angular/common/http';\n\n@NgModule({\n  declarations: [RatesComponent],\n  imports: [HttpClientModule]\n})\nexport class RatesModule { }\n```\n\nEn tu componente tienes que reclamar la dependencia al servicio para poder usarla. Atencin a la importacin pues hay ms clases con el nombre `HttpClient`. Debe quedar algo as:\n\n```typescript\nimport { HttpClient } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-rates',\n  templateUrl: './rates.component.html',\n  styles: []\n})\nexport class RatesComponent implements OnInit {\n  constructor(private httpClient: HttpClient) {}\n\n  ngOnInit() {}\n}\n```\n\nA partir de este momento slo queda invocar los mtodos REST en la propiedad `this.http`.\n\n## 1.2 Obtencin de datos\n\nPara cada verbo _http_ tenemos su mtodo en el servicio `HttpClient`. Su primer parmetro ser la *url* a la que invocar. Empecemos por el `get` que automticamente solicita y devuelve objetos _JSON_ desde un API. Por ejemplo para obtener [las ltimas cotizaciones de las principales divisas](https://api.exchangeratesapi.io/latest?symbols=USD,GBP,CHF,JPY) lo haremos as:\n\n\n```typescript\nexport class RatesComponent implements OnInit {\n  private urlapi\n    = 'https://api.exchangeratesapi.io/latest';\n  public currentEuroRates: any = null;\n\n  constructor(private httpClient: HttpClient) {}\n\n  ngOnInit() {\n    this.getCurrentEuroRates();\n  }\n\n  private getCurrentEuroRates() {\n    const currencies = 'USD,GBP,CHF,JPY';\n    const url = `${this.urlapi}?symbols=${currencies}`;\n    this.httpClient\n      .get(url)\n      .subscribe(apiData => (this.currentEuroRates = apiData));\n  }\n}\n```\n\n> El mtodo _get_ retorna un objeto observable. Los observables _http_ han de consumirse mediante el mtodo _subscribe_ para que realmente se lancen. Dicho mtodo _subscribe_ admite hasta tres _callbacks_: `susbcribe(data, err, end)` para que se ejecuten en respuesta a eventos. En este ejemplo solo hemos usado el primero.\n\nLa presentacin en la vista slo tiene que acceder a la propiedad dnde se hayan cargado las respuestas tratadas en el _callback_ de la suscripcin.\n\n```html\n<h2> Currency Rates. </h2>\n<h3> From Euro to the world </h3>\n<pre>{{ currentEuroRates | json }}</pre>\n```\n\n\n## 1.3 Envo de datos\n\nSupongamos que, una vez recibidas las cotizaciones, pretendemos transformarlas y almacenarlas en otro servicio. El envo en este caso ser con el mtodo _post_ al que se le pasar la ruta del _end point_ y el objeto _payload_ que se enviar al servidor.\n\nVamos a agregar una propiedad y un par de mtodos al `rates-component.ts`. La idea es obtener un array de cotizaciones aa partir del objeto previo, y guardarla una por una.\n\n```typescript\nexport class RatesComponent implements OnInit {\n  private myRatesApi\n    = 'https://api-base.herokuapp.com/api/pub/rates';\n\n  public postRates() {\n    const rates = this.transformData();\n    rates.forEach(rate =>\n      this.httpClient\n        .post(this.myRatesApi, rate)\n        .subscribe()\n    );\n  }\n\n  private transformData() {\n    const current = this.currentEuroRates.rates;\n    return Object.keys(current).map(key => ({\n      date: this.currentEuroRates.date,\n      currency: key,\n      euros: current[key]\n    }));\n  }\n}\n```\n> Atencin a los mtodos `subscribe()`. Aunque vayan vacos son imprescindibles para que se ejecute la llamada.\n\nEn la vista no hay gran cosa que hacer, salvo agregarle un botn para iniciar el proceso:\n\n```html\n<input value=\"Save Rates\" type=\"button\" (click)=\"postRates()\" />\n```\n\n## 1.4 Actualizacin de datos\n\nUn par de ejemplo ms para acabar de entender la mecnica bsica de `HttpClient`. Podemos fijar el tipo de datos esperado en cualquier llamada. De hecho es recomendable que tengas un interfaz para cada respuesta esperada.\n\nEn este tutorial no se ha hecho y no quedamos con el `any`, pero al menos distinguimos entre objetos y arrays. Esto es lo que aado al `RatesComponent` para que muestre los datos guardados en mi API.\n\n```typescript\nexport class RatesComponent implements OnInit {\n private myRatesApi\n  = 'https://api-base.herokuapp.com/api/pub/rates';\n public myRates: any[] = null;\n\n public getMyRates() {\n    this.httpClient\n      .get<any[]>(this.myRatesApi)\n      .subscribe(apiResult => (this.myRates = apiResult));\n  }\n}\n```\nY en la vista, un nuevo botn y una nueva expresin.\n\n```html\n<input value=\"Refresh\" type=\"button\" (click)=\"getMyRates()\" />\n<pre>{{ myRates | json }}</pre>\n```\n\nPor ltimo, en plan repaso, un ejemplo de mtodo para borrar.\n\n```typescript\npublic deleteMyRates() {\n  this.httpClient\n    .delete(this.myRatesApi)\n    .subscribe();\n}\n```\nY su botn en en la vista.\n\n```html\n<input value=\"Delete Rates\" type=\"button\" (click)=\"deleteMyRates()\" />\n```\n\nY hasta aqu lo bsico de comunicaciones *http*. Fcil verdad?. Pero la vida real raramente es tan sencilla. Si quieres enfrentarte a algo ms duro debes prepararte y dominar los observables *RxJS*.\n\nLo que viene a partir de ahora requerir tiempo y concentracin. Si continas adelante esto ya no ser *your grandpas http anymore*.\n\n# 2 Observables\n\nLas **comunicaciones** entre navegadores y servidores son varios rdenes de magnitud ms lentas que las operaciones en memoria. Por tanto deben realizarse de manera asncrona para garantizar una buena experiencia al usuario.\n\nEsta experiencia no siempre fue tan buena para el programador. Sobre todo con las primeras comunicaciones _AJAX_ basadas en el paso de funciones _callback_. La aparicin de las _promises_ mejor la claridad del cdigo, y ahora con los _Observables_ tenemos adems una gran potencia para manipular la **informacin asncrona**.\n\n> El patrn `Observable` fue implementado por Microsoft en la librera [_Reactive Extensions_](http://reactivex.io/intro.html) ms conocida como `RxJs`. El equipo de Angular decidi utilizarla para el desarrollo de las comunicaciones asncronas. Esta extensa librera puede resultar intimidante en un primer vistazo. Pero con muy poco conocimiento puedes programar casi todas las funcionalidades que se te ocurran.\n\nLo primero es importar el cdigo, de forma similar a cualquier otra clase o funcin. Por ejemplo para empezar basta con `import { Observable } from \"rxjs/Observable\";`. Tendremos la clase usada por angular para observar el respuesta *http*.\n\nPero esta es una clase genrica donde sus instancias admiten la manipulacin interna de tipos ms o menos concretos. Por eso ves en el ejemplo que algunas funciones retornan el tipo esperado `: Observable<MyClass>`, o si no saben que tipo esperar se conforman con `: Observable<any>`.\n\nEn cualquier caso, **toda operacin asncrona retornar una instancia observable** a la cual habr que subscribirse para recibir los datos o los errores, cuando termine.\nAunque a veces no se ver el _subscribe_...\n\n## 2.1 Async\n\nPara probar otras formas de presentar datos recibidos desde un API, voy a crear un nuevo componente. El `ObseratesComponent`, mezcla de _observables_ y _rates_.\n\n```shell\nng g c 6-http/rates/obserates\n```\n\nY en su vista HTML usar una funcin propia de Angular llamada `async`. Dicha funcin acta como un _pipe_ en una expresin. Igual que el `| json`. Pero a su izquierda espera que le den algo a lo que suscribirse; espera un observable.\n\n```html\n<h2> Currency Observable Rates. </h2>\n<h3> From Euro to the $ world </h3>\n<pre>{{ currentEuroRates$ | async | json }}</pre>}\n```\n\nEn este caso uso la propiedad `currentEuroRates$` finalizada en **$** por convenio. Esa propiedad se rellena en el controlador con el mtodo `get`, no con los datos futuros, si no con el propio _observable_.\n\n```typeScript\nprivate ratesApi\n  = 'https://api.exchangeratesapi.io/latest';\npublic currentEuroRates$: Observable<any> = null;\n\nconstructor(private httpClient: HttpClient) {}\n\nngOnInit() {\n  this.getCurrentEuroRates();\n}\n\nprivate getCurrentEuroRates() {\n  const currencies = 'USD,GBP,CHF,JPY';\n  const url = `${this.ratesApi}?symbols=${currencies}`;\n  this.currentEuroRates$ = this.httpClient.get(url);\n}\n```\n> Al utilizar el _pipe async_ ya no es necesaria la suscripcin en cdigo. La propia funcin del framework se ocupa de ello. Por tanto la llamada se realiza igualmente aunque no veamos la suscripcin.\n\nEsta es la manera recomendada de consumir datos desde un API. Definir la llamada en el controlador y pasarle el observable a la vista para que lo muestre cuando obtenga los datos.\n\n\n## 2.2 Pipe\n\n### Tuberas en RxJS .pipe()\n\nLos datos devueltos raramente vienen en el formato preciso para usar en la vista. Con frecuencia hay que transformarlos al vuelo en cuanto se reciben. Recordemos que ***HttpClient* no devuelve los datos tal cual sino un *stream* de estados** de dichos datos. La manipulacin ser sobre el *stream* no directamente sobre los datos; y, claro, para manipular un torrente hay que encauzarlo en tuberas.\n\nAqu es donde aparece el mtodo `.pipe(operator1, operator2...)` aplicado a un observable. Suele hacerse en lugar, o antes, del `.susbcribe(okCallback, errCallback)`. Este mtodo canaliza una serie de operadores predefinidos que manipulan el chorro de estados observados.\n\nEl operador ms utilizado es `map(sourceStream => targetStream)`. Este operador recibe una funcin *callBack* que ser invocada ante cada dato recibido. Esa funcin tienen que retornar un valor para sustituir al actual y as transformar el contenido del chorro.\n\n```typescript\npublic myRates$: Observable<any[]> = null;\nprivate getCurrentEuroRates() {\n  const url = `${this.ratesApi}?symbols=USD,GBP,CHF,JPY`;\n  this.currentEuroRates$ = this.httpClient.get(url);\n  this.myRates$ = this.currentEuroRates$.pipe(map(this.transformData));\n}\nprivate transformData(currentRates) {\n  const current = currentRates.rates;\n  return Object.keys(current).map(key => ({\n    date: currentRates.date,\n    currency: key,\n    euros: current[key]\n  }));\n}\n```\n\n> En este ejemplo partimos de nuevo de un objeto recibido y lo queremos ver como un *array* de objetos. Para ello lo transformamos usado el operador `map`. Este operador ha de importarse de `rxjs/operators` y aplicarse a un observable dentro de su mtodo `.pipe()`. Es el ms sencillo y uno de los ms utilizados: recibe y emite datos dentro de un stream de eventos observables. Nada que ver, salvo el nombre, con la sencilla funcin `array.map(callback)`, que recibe y devuelve datos estticos.\n\n```html\n<pre>{{ myRates$ | async | json }}</pre>\n```\nPor lo dems el consumo se hace igual... pero... tendremos que ver ms operadores para solucionar algunos inconvenientes.\n\n## 2.3 Operators\n\nEl cdigo anterior funciona, pero resulta que al haber dos funciones async suscritas provoca que la llamada original se realice dos veces. esto es as porque el segundo observable `myRates$` es una canalizacin del primero `currentEuroRates$`.\n\nEstos y oros problemas se solucionan usando operadores. Vamos a conocer un par de ellos ms y veremos como `pipe(op1, op2,  opn)` los ejecuta a todos en orden.\n\nEl operador `share()` permite compartir el resultado de una primera llamada con subsiguientes suscriptores. Evitando de ese modo la repeticin de costosas peticiones http.\n\n```typescript\nprivate getCurrentEuroRates() {\nconst url = `${this.ratesApi}?symbols=USD,GBP,CHF,JPY`;\n  this.currentEuroRates$ = this.httpClient.get(url)\n      .pipe(share());\n  this.myRates$ = this.currentEuroRates$\n      .pipe(\n        tap(d=>console.log(d)),\n        map(this.transformData),\n        tap(t=>console.log(t))\n      );\n}\n```\n\n> El operador `tap(callback)` es similar en nombre al `map()`. Pero la gran diferencia es que est pensado para no manipular los datos que recibe. Los usa y puede causar otros efectos colaterales, pero nunca modifica el propio stream. Es muy utilizado para inspeccionar o auditar el flujo de otros operadores.\n\n\nReconozco que en un primer vistazo este cdigo pueda resultar complejo. Tmate tu tiempo. Fjate en los datos de entrada y salida de cada funcin. Esto es solo el principio del trabajo con la librera *RxJS* y la manipulacin de *streams de eventos observables*.\n\n# 3. Interceptores\n\nLos interceptores tienen un nombre intimidante pero un propsito sencillo y muy til: **interceptar todas las comunicaciones http** y ejecutar cdigo personalizado para cada uno. Por ejemplo un gestor centralizado de errores http o el control de los tokens de seguridad de la aplicacin.\n\nPero antes de eso habr que aprender unos conceptos bsicos. Vamos a ver un ejemplo sencillo que audite todas las llamadas http. Todo empieza con un servicio:\n\n```console\nng g s rates/AuditInterceptor\n```\n\n## 3.1 La interfaz HttpInterceptor\n\nAl servicio genrico recin creado hay que hacerle cumplir una interfaz `HttpInterceptor` que viene con `HttpClientModule`. Esta interfaz solo necesita un mtodo, el `intercept(req, next)` pero sus tipos e implementacin mnima la hacen complicada de entender a la primera.\n\n```typescript\nimport { HttpEvent, HttpHandler, HttpInterceptor, HttpRequest }\n  from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuditInterceptorService implements HttpInterceptor {\n  public intercept( req: HttpRequest<any>, next: HttpHandler )\n    : Observable<HttpEvent<any>> {\n    return next.handle(req);\n  }\n\n  constructor() { }\n}\n```\n\nTodo este cdigo para nada. Porque eso es lo que hace, nada. Eso s, tampoco rompe ni bloquea nada. Vayamos por partes, primero los parmetros, luego el tipo de la respuesta y por ltimo la implementacin\n\n- `req: HttpRequest<any>`  puntero a la peticin en curso\n- `next: HttpHandler`  puntero a la siguiente funcin que maneje la peticin\n- `: Observable<HttpEvent<any>>` retornamos un stream de eventos http para cada peticin\n- `return next.handle(req);`  que el siguiente procese la peticin, sin hacerle nada en absoluto\n\n> Para entenderlo mejor puede ser til la siguiente analoga. Cuando usas httpClient.get() es como si pides algo a Amazon y te suscribes, es decir esperas el paquete. Pasado el tiempo el paquete llegar o no llegar, pero ya no lo gestionas t. Con los interceptores es como si espiases cada proceso de tu pedido: stock, picking, packaging, shipping... Cada pedido es tratado en una sucesin de eventos. Con un interceptor observas !todos los eventos de todos los pedidos!\n\n## 3.2 Inversin del control va token\n\nTenemos un servicio que cumple una interfaz compleja. Pero dicho servicio debe ser provedo en algn mdulo antes de ser reclamado como dependencias por alguien. Pero por quin?\n\nTcnicamente lo necesita el propio `HttpClient` del framework. Pero, obviamente, no pueden reclamar por tipo una clase que acabo de inventarme yo. Adelante con la **inversin del control**.\n\nRealmente `HttpClient` depende de algo que por convenio llaman token de tipo `HTTP_INTERCEPTORS`. Nuestro trabajo consiste en que cuando reclame su dependencia, le demos la nuestra. El tpico gato por liebre. As en nuestro mdulo pondremos la siguiente configuracin.\n\n```TypeScript\nproviders: [\n  {\n    provide: HTTP_INTERCEPTORS,\n    useClass: AuditInterceptorService,\n    multi: true\n  }\n]\n```\nEl parmetro `multi:true` en este caso le indica que puede haber ms de un interceptor. Concretamente debe aadirlo a la lista y admitir ms. Hecho esto, sobrara el `providedIn: 'root'` autogenerado en el decorador del servicio.\n\n## 3.3 Un auditor de llamadas\n\nPues ya estamos listos para aportar algo de funcionalidad. Nuestro objetivo es escribir en el _log_ un texto para cada llamada terminada y el tiempo que le tom. La idea es aprovechar que todo es un _stream_ observable y canalizarlo en una tubera con una serie de operadores.\n\n```Typescript\nexport class AuditInterceptorService implements HttpInterceptor {\n  constructor() {}\n\n  public intercept(req: HttpRequest<any>, next: HttpHandler){\n    const started = Date.now();\n    return next.handle(req).pipe(\n      filter((event: HttpEvent<any>) => event instanceof HttpResponse),\n      tap((resp: HttpResponse<any>) => this.auditEvent(resp, started))\n    );\n  }\n\n  private auditEvent(resp: HttpResponse<any>, started: number) {\n    const elapsedMs = Date.now() - started;\n    const eventMessage = resp.statusText + ' on ' + resp.url;\n    const message = eventMessage + ' in ' + elapsedMs + 'ms';\n    console.log(message);\n  }\n}\n```\n\nEl operador `filter(any=>bool)` se usa para descartar eventos que no cumplan unos criterios. En mi caso slo me interesan los eventos de recepcin de la peticin, y no necesito los intermedios. Uso de nuevo el `tap(callback)` para hacer cosas con los datos sin modificarlos en absoluto. En este caso los envo al mtodo `auditEvent` para que lo saque por consola. Listo: un auditor para todas las llamadas.\n\nYa tenemos el programa comunicado por _http_ con un servidor; aunque por ahora de forma annima y sin ninguna seguridad. Con el conocimiento actual de los observables, del _httpClient_ y de los interceptores ya estamos cerca de resolverlo. Sigue esta serie para aadirle [vigilancia y seguridad en Angular](../vigilancia-y-seguridad-en-Angular/) mientras aprendes a programar con Angular.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"comunicaciones-http-en-Angular","published":1,"updated":"2019-03-04T08:09:43.972Z","_id":"cjbrwpvin001ziwd3551c6s4a","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-6_http.png\" alt=\"comunicaciones-http-en-Angular\"></p><p>Las comunicaciones <em>http</em> son una pieza fundamental del desarrollo web, y en <strong>Angular</strong> siempre han sido potentes y fciles. Siempre?, bueno cuando apareci Angular 2 echbamos en falta algunas cosillas y adems la librera <em>RxJS</em> y sus <em>streams</em> son intimidantes para los novatos.</p><p>Pero en la versin Angular 7 <strong>consumir un servicio REST</strong> puede ser cosa de nios si aprendes a jugar con los <em>observables</em> y los servicios de la librera <code>@angular/common/http</code>. Conseguirs realizar <strong>comunicaciones http asncronas en Angular</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal cmo qued en <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a>. Al finalizar tendrs una aplicacin que almacena y recupera los datos consumiendo un servicio REST usando las tecnologas de Angular Http.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/6-http/rates\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/6-http</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-El-servicio-HttpClient\"><a href=\"#1-El-servicio-HttpClient\" class=\"headerlink\" title=\"1. El servicio HttpClient\"></a>1. El servicio HttpClient</h1><p>Como demostracin vamos a consumir un API pblica con datos de <a href=\"https://exchangeratesapi.io/\" target=\"_blank\" rel=\"noopener\">cotizacin de monedas</a>. Crear un mdulo y un componente en el que visualizar las divisas y despus las transformaremos para guardarlas en un servicio propio.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m 6-http/rates --routing true</span><br><span class=\"line\">ng g c 6-http/rates/rates</span><br></pre></td></tr></table></figure><h2 id=\"1-1-Importacion-y-declaracion-de-servicios\"><a href=\"#1-1-Importacion-y-declaracion-de-servicios\" class=\"headerlink\" title=\"1.1 Importacin y declaracin de servicios\"></a>1.1 Importacin y declaracin de servicios</h2><p>La librera <code>@angular/common/http</code> trae el mdulo <code>HttpClientModule</code> con el servicio inyectable <code>HttpClient</code>. Lo primero es importar dicho mdulo.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpClientModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [RatesComponent],</span><br><span class=\"line\">  imports: [HttpClientModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesModule &#123; &#125;</span><br></pre></td></tr></table></figure><p>En tu componente tienes que reclamar la dependencia al servicio para poder usarla. Atencin a la importacin pues hay ms clases con el nombre <code>HttpClient</code>. Debe quedar algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpClient &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'app-rates'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./rates.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>A partir de este momento slo queda invocar los mtodos REST en la propiedad <code>this.http</code>.</p><h2 id=\"1-2-Obtencion-de-datos\"><a href=\"#1-2-Obtencion-de-datos\" class=\"headerlink\" title=\"1.2 Obtencin de datos\"></a>1.2 Obtencin de datos</h2><p>Para cada verbo <em>http</em> tenemos su mtodo en el servicio <code>HttpClient</code>. Su primer parmetro ser la <em>url</em> a la que invocar. Empecemos por el <code>get</code> que automticamente solicita y devuelve objetos <em>JSON</em> desde un API. Por ejemplo para obtener <a href=\"https://api.exchangeratesapi.io/latest?symbols=USD,GBP,CHF,JPY\" target=\"_blank\" rel=\"noopener\">las ltimas cotizaciones de las principales divisas</a> lo haremos as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> urlapi</span><br><span class=\"line\">    = <span class=\"string\">'https://api.exchangeratesapi.io/latest'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> currentEuroRates: <span class=\"built_in\">any</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.getCurrentEuroRates();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> getCurrentEuroRates() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> currencies = <span class=\"string\">'USD,GBP,CHF,JPY'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> url = <span class=\"string\">`<span class=\"subst\">$&#123;this.urlapi&#125;</span>?symbols=<span class=\"subst\">$&#123;currencies&#125;</span>`</span>;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">      .get(url)</span><br><span class=\"line\">      .subscribe(<span class=\"function\"><span class=\"params\">apiData</span> =&gt;</span> (<span class=\"keyword\">this</span>.currentEuroRates = apiData));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El mtodo <em>get</em> retorna un objeto observable. Los observables <em>http</em> han de consumirse mediante el mtodo <em>subscribe</em> para que realmente se lancen. Dicho mtodo <em>subscribe</em> admite hasta tres <em>callbacks</em>: <code>susbcribe(data, err, end)</code> para que se ejecuten en respuesta a eventos. En este ejemplo solo hemos usado el primero.</p></blockquote><p>La presentacin en la vista slo tiene que acceder a la propiedad dnde se hayan cargado las respuestas tratadas en el <em>callback</em> de la suscripcin.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> Currency Rates. <span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> From Euro to the world <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; currentEuroRates | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-3-Envio-de-datos\"><a href=\"#1-3-Envio-de-datos\" class=\"headerlink\" title=\"1.3 Envo de datos\"></a>1.3 Envo de datos</h2><p>Supongamos que, una vez recibidas las cotizaciones, pretendemos transformarlas y almacenarlas en otro servicio. El envo en este caso ser con el mtodo <em>post</em> al que se le pasar la ruta del <em>end point</em> y el objeto <em>payload</em> que se enviar al servidor.</p><p>Vamos a agregar una propiedad y un par de mtodos al <code>rates-component.ts</code>. La idea es obtener un array de cotizaciones aa partir del objeto previo, y guardarla una por una.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> myRatesApi</span><br><span class=\"line\">    = <span class=\"string\">'https://api-base.herokuapp.com/api/pub/rates'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> postRates() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> rates = <span class=\"keyword\">this</span>.transformData();</span><br><span class=\"line\">    rates.forEach(<span class=\"function\"><span class=\"params\">rate</span> =&gt;</span></span><br><span class=\"line\">      <span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">        .post(<span class=\"keyword\">this</span>.myRatesApi, rate)</span><br><span class=\"line\">        .subscribe()</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> transformData() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> current = <span class=\"keyword\">this</span>.currentEuroRates.rates;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">Object</span>.keys(current).map(<span class=\"function\"><span class=\"params\">key</span> =&gt;</span> (&#123;</span><br><span class=\"line\">      date: <span class=\"keyword\">this</span>.currentEuroRates.date,</span><br><span class=\"line\">      currency: key,</span><br><span class=\"line\">      euros: current[key]</span><br><span class=\"line\">    &#125;));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Atencin a los mtodos <code>subscribe()</code>. Aunque vayan vacos son imprescindibles para que se ejecute la llamada.</p></blockquote><p>En la vista no hay gran cosa que hacer, salvo agregarle un botn para iniciar el proceso:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Save Rates\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"postRates()\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-4-Actualizacion-de-datos\"><a href=\"#1-4-Actualizacion-de-datos\" class=\"headerlink\" title=\"1.4 Actualizacin de datos\"></a>1.4 Actualizacin de datos</h2><p>Un par de ejemplo ms para acabar de entender la mecnica bsica de <code>HttpClient</code>. Podemos fijar el tipo de datos esperado en cualquier llamada. De hecho es recomendable que tengas un interfaz para cada respuesta esperada.</p><p>En este tutorial no se ha hecho y no quedamos con el <code>any</code>, pero al menos distinguimos entre objetos y arrays. Esto es lo que aado al <code>RatesComponent</code> para que muestre los datos guardados en mi API.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\"> <span class=\"keyword\">private</span> myRatesApi</span><br><span class=\"line\">  = <span class=\"string\">'https://api-base.herokuapp.com/api/pub/rates'</span>;</span><br><span class=\"line\"> <span class=\"keyword\">public</span> myRates: <span class=\"built_in\">any</span>[] = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">public</span> getMyRates() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">      .get&lt;<span class=\"built_in\">any</span>[]&gt;(<span class=\"keyword\">this</span>.myRatesApi)</span><br><span class=\"line\">      .subscribe(<span class=\"function\"><span class=\"params\">apiResult</span> =&gt;</span> (<span class=\"keyword\">this</span>.myRates = apiResult));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y en la vista, un nuevo botn y una nueva expresin.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Refresh\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"getMyRates()\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; myRates | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Por ltimo, en plan repaso, un ejemplo de mtodo para borrar.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> deleteMyRates() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">    .delete(<span class=\"keyword\">this</span>.myRatesApi)</span><br><span class=\"line\">    .subscribe();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y su botn en en la vista.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Delete Rates\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"deleteMyRates()\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>Y hasta aqu lo bsico de comunicaciones <em>http</em>. Fcil verdad?. Pero la vida real raramente es tan sencilla. Si quieres enfrentarte a algo ms duro debes prepararte y dominar los observables <em>RxJS</em>.</p><p>Lo que viene a partir de ahora requerir tiempo y concentracin. Si continas adelante esto ya no ser <em>your grandpas http anymore</em>.</p><h1 id=\"2-Observables\"><a href=\"#2-Observables\" class=\"headerlink\" title=\"2 Observables\"></a>2 Observables</h1><p>Las <strong>comunicaciones</strong> entre navegadores y servidores son varios rdenes de magnitud ms lentas que las operaciones en memoria. Por tanto deben realizarse de manera asncrona para garantizar una buena experiencia al usuario.</p><p>Esta experiencia no siempre fue tan buena para el programador. Sobre todo con las primeras comunicaciones <em>AJAX</em> basadas en el paso de funciones <em>callback</em>. La aparicin de las <em>promises</em> mejor la claridad del cdigo, y ahora con los <em>Observables</em> tenemos adems una gran potencia para manipular la <strong>informacin asncrona</strong>.</p><blockquote><p>El patrn <code>Observable</code> fue implementado por Microsoft en la librera <a href=\"http://reactivex.io/intro.html\" target=\"_blank\" rel=\"noopener\"><em>Reactive Extensions</em></a> ms conocida como <code>RxJs</code>. El equipo de Angular decidi utilizarla para el desarrollo de las comunicaciones asncronas. Esta extensa librera puede resultar intimidante en un primer vistazo. Pero con muy poco conocimiento puedes programar casi todas las funcionalidades que se te ocurran.</p></blockquote><p>Lo primero es importar el cdigo, de forma similar a cualquier otra clase o funcin. Por ejemplo para empezar basta con <code>import { Observable } from &quot;rxjs/Observable&quot;;</code>. Tendremos la clase usada por angular para observar el respuesta <em>http</em>.</p><p>Pero esta es una clase genrica donde sus instancias admiten la manipulacin interna de tipos ms o menos concretos. Por eso ves en el ejemplo que algunas funciones retornan el tipo esperado <code>: Observable&lt;MyClass&gt;</code>, o si no saben que tipo esperar se conforman con <code>: Observable&lt;any&gt;</code>.</p><p>En cualquier caso, <strong>toda operacin asncrona retornar una instancia observable</strong> a la cual habr que subscribirse para recibir los datos o los errores, cuando termine.<br>Aunque a veces no se ver el <em>subscribe</em></p><h2 id=\"2-1-Async\"><a href=\"#2-1-Async\" class=\"headerlink\" title=\"2.1 Async\"></a>2.1 Async</h2><p>Para probar otras formas de presentar datos recibidos desde un API, voy a crear un nuevo componente. El <code>ObseratesComponent</code>, mezcla de <em>observables</em> y <em>rates</em>.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c 6-http/rates/obserates</span><br></pre></td></tr></table></figure><p>Y en su vista HTML usar una funcin propia de Angular llamada <code>async</code>. Dicha funcin acta como un <em>pipe</em> en una expresin. Igual que el <code>| json</code>. Pero a su izquierda espera que le den algo a lo que suscribirse; espera un observable.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> Currency Observable Rates. <span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> From Euro to the $ world <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; currentEuroRates$ | async | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span>&#125;</span><br></pre></td></tr></table></figure><p>En este caso uso la propiedad <code>currentEuroRates$</code> finalizada en <strong>$</strong> por convenio. Esa propiedad se rellena en el controlador con el mtodo <code>get</code>, no con los datos futuros, si no con el propio <em>observable</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> ratesApi</span><br><span class=\"line\">  = <span class=\"string\">'https://api.exchangeratesapi.io/latest'</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> currentEuroRates$: Observable&lt;<span class=\"built_in\">any</span>&gt; = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">ngOnInit() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.getCurrentEuroRates();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> getCurrentEuroRates() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> currencies = <span class=\"string\">'USD,GBP,CHF,JPY'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"string\">`<span class=\"subst\">$&#123;this.ratesApi&#125;</span>?symbols=<span class=\"subst\">$&#123;currencies&#125;</span>`</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.currentEuroRates$ = <span class=\"keyword\">this</span>.httpClient.get(url);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Al utilizar el <em>pipe async</em> ya no es necesaria la suscripcin en cdigo. La propia funcin del framework se ocupa de ello. Por tanto la llamada se realiza igualmente aunque no veamos la suscripcin.</p></blockquote><p>Esta es la manera recomendada de consumir datos desde un API. Definir la llamada en el controlador y pasarle el observable a la vista para que lo muestre cuando obtenga los datos.</p><h2 id=\"2-2-Pipe\"><a href=\"#2-2-Pipe\" class=\"headerlink\" title=\"2.2 Pipe\"></a>2.2 Pipe</h2><h3 id=\"Tuberias-en-RxJS-pipe\"><a href=\"#Tuberias-en-RxJS-pipe\" class=\"headerlink\" title=\"Tuberas en RxJS .pipe()\"></a>Tuberas en RxJS .pipe()</h3><p>Los datos devueltos raramente vienen en el formato preciso para usar en la vista. Con frecuencia hay que transformarlos al vuelo en cuanto se reciben. Recordemos que <strong><em>HttpClient</em> no devuelve los datos tal cual sino un <em>stream</em> de estados</strong> de dichos datos. La manipulacin ser sobre el <em>stream</em> no directamente sobre los datos; y, claro, para manipular un torrente hay que encauzarlo en tuberas.</p><p>Aqu es donde aparece el mtodo <code>.pipe(operator1, operator2...)</code> aplicado a un observable. Suele hacerse en lugar, o antes, del <code>.susbcribe(okCallback, errCallback)</code>. Este mtodo canaliza una serie de operadores predefinidos que manipulan el chorro de estados observados.</p><p>El operador ms utilizado es <code>map(sourceStream =&gt; targetStream)</code>. Este operador recibe una funcin <em>callBack</em> que ser invocada ante cada dato recibido. Esa funcin tienen que retornar un valor para sustituir al actual y as transformar el contenido del chorro.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> myRates$: Observable&lt;<span class=\"built_in\">any</span>[]&gt; = <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"keyword\">private</span> getCurrentEuroRates() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"string\">`<span class=\"subst\">$&#123;this.ratesApi&#125;</span>?symbols=USD,GBP,CHF,JPY`</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.currentEuroRates$ = <span class=\"keyword\">this</span>.httpClient.get(url);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.myRates$ = <span class=\"keyword\">this</span>.currentEuroRates$.pipe(map(<span class=\"keyword\">this</span>.transformData));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span> transformData(currentRates) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> current = currentRates.rates;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"built_in\">Object</span>.keys(current).map(<span class=\"function\"><span class=\"params\">key</span> =&gt;</span> (&#123;</span><br><span class=\"line\">    date: currentRates.date,</span><br><span class=\"line\">    currency: key,</span><br><span class=\"line\">    euros: current[key]</span><br><span class=\"line\">  &#125;));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>En este ejemplo partimos de nuevo de un objeto recibido y lo queremos ver como un <em>array</em> de objetos. Para ello lo transformamos usado el operador <code>map</code>. Este operador ha de importarse de <code>rxjs/operators</code> y aplicarse a un observable dentro de su mtodo <code>.pipe()</code>. Es el ms sencillo y uno de los ms utilizados: recibe y emite datos dentro de un stream de eventos observables. Nada que ver, salvo el nombre, con la sencilla funcin <code>array.map(callback)</code>, que recibe y devuelve datos estticos.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; myRates$ | async | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Por lo dems el consumo se hace igual pero tendremos que ver ms operadores para solucionar algunos inconvenientes.</p><h2 id=\"2-3-Operators\"><a href=\"#2-3-Operators\" class=\"headerlink\" title=\"2.3 Operators\"></a>2.3 Operators</h2><p>El cdigo anterior funciona, pero resulta que al haber dos funciones async suscritas provoca que la llamada original se realice dos veces. esto es as porque el segundo observable <code>myRates$</code> es una canalizacin del primero <code>currentEuroRates$</code>.</p><p>Estos y oros problemas se solucionan usando operadores. Vamos a conocer un par de ellos ms y veremos como <code>pipe(op1, op2, opn)</code> los ejecuta a todos en orden.</p><p>El operador <code>share()</code> permite compartir el resultado de una primera llamada con subsiguientes suscriptores. Evitando de ese modo la repeticin de costosas peticiones http.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> getCurrentEuroRates() &#123;</span><br><span class=\"line\"><span class=\"keyword\">const</span> url = <span class=\"string\">`<span class=\"subst\">$&#123;this.ratesApi&#125;</span>?symbols=USD,GBP,CHF,JPY`</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.currentEuroRates$ = <span class=\"keyword\">this</span>.httpClient.get(url)</span><br><span class=\"line\">      .pipe(share());</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.myRates$ = <span class=\"keyword\">this</span>.currentEuroRates$</span><br><span class=\"line\">      .pipe(</span><br><span class=\"line\">        tap(<span class=\"function\"><span class=\"params\">d</span>=&gt;</span><span class=\"built_in\">console</span>.log(d)),</span><br><span class=\"line\">        map(<span class=\"keyword\">this</span>.transformData),</span><br><span class=\"line\">        tap(<span class=\"function\"><span class=\"params\">t</span>=&gt;</span><span class=\"built_in\">console</span>.log(t))</span><br><span class=\"line\">      );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El operador <code>tap(callback)</code> es similar en nombre al <code>map()</code>. Pero la gran diferencia es que est pensado para no manipular los datos que recibe. Los usa y puede causar otros efectos colaterales, pero nunca modifica el propio stream. Es muy utilizado para inspeccionar o auditar el flujo de otros operadores.</p></blockquote><p>Reconozco que en un primer vistazo este cdigo pueda resultar complejo. Tmate tu tiempo. Fjate en los datos de entrada y salida de cada funcin. Esto es solo el principio del trabajo con la librera <em>RxJS</em> y la manipulacin de <em>streams de eventos observables</em>.</p><h1 id=\"3-Interceptores\"><a href=\"#3-Interceptores\" class=\"headerlink\" title=\"3. Interceptores\"></a>3. Interceptores</h1><p>Los interceptores tienen un nombre intimidante pero un propsito sencillo y muy til: <strong>interceptar todas las comunicaciones http</strong> y ejecutar cdigo personalizado para cada uno. Por ejemplo un gestor centralizado de errores http o el control de los tokens de seguridad de la aplicacin.</p><p>Pero antes de eso habr que aprender unos conceptos bsicos. Vamos a ver un ejemplo sencillo que audite todas las llamadas http. Todo empieza con un servicio:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s rates/AuditInterceptor</span><br></pre></td></tr></table></figure><h2 id=\"3-1-La-interfaz-HttpInterceptor\"><a href=\"#3-1-La-interfaz-HttpInterceptor\" class=\"headerlink\" title=\"3.1 La interfaz HttpInterceptor\"></a>3.1 La interfaz HttpInterceptor</h2><p>Al servicio genrico recin creado hay que hacerle cumplir una interfaz <code>HttpInterceptor</code> que viene con <code>HttpClientModule</code>. Esta interfaz solo necesita un mtodo, el <code>intercept(req, next)</code> pero sus tipos e implementacin mnima la hacen complicada de entender a la primera.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpEvent, HttpHandler, HttpInterceptor, HttpRequest &#125;</span><br><span class=\"line\">  <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Injectable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Observable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'rxjs'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AuditInterceptorService <span class=\"keyword\">implements</span> HttpInterceptor &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> intercept( req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler )</span><br><span class=\"line\">    : Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next.handle(req);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Todo este cdigo para nada. Porque eso es lo que hace, nada. Eso s, tampoco rompe ni bloquea nada. Vayamos por partes, primero los parmetros, luego el tipo de la respuesta y por ltimo la implementacin</p><ul><li><code>req: HttpRequest&lt;any&gt;</code> puntero a la peticin en curso</li><li><code>next: HttpHandler</code> puntero a la siguiente funcin que maneje la peticin</li><li><code>: Observable&lt;HttpEvent&lt;any&gt;&gt;</code> retornamos un stream de eventos http para cada peticin</li><li><code>return next.handle(req);</code> que el siguiente procese la peticin, sin hacerle nada en absoluto</li></ul><blockquote><p>Para entenderlo mejor puede ser til la siguiente analoga. Cuando usas httpClient.get() es como si pides algo a Amazon y te suscribes, es decir esperas el paquete. Pasado el tiempo el paquete llegar o no llegar, pero ya no lo gestionas t. Con los interceptores es como si espiases cada proceso de tu pedido: stock, picking, packaging, shipping Cada pedido es tratado en una sucesin de eventos. Con un interceptor observas !todos los eventos de todos los pedidos!</p></blockquote><h2 id=\"3-2-Inversion-del-control-via-token\"><a href=\"#3-2-Inversion-del-control-via-token\" class=\"headerlink\" title=\"3.2 Inversin del control va token\"></a>3.2 Inversin del control va token</h2><p>Tenemos un servicio que cumple una interfaz compleja. Pero dicho servicio debe ser provedo en algn mdulo antes de ser reclamado como dependencias por alguien. Pero por quin?</p><p>Tcnicamente lo necesita el propio <code>HttpClient</code> del framework. Pero, obviamente, no pueden reclamar por tipo una clase que acabo de inventarme yo. Adelante con la <strong>inversin del control</strong>.</p><p>Realmente <code>HttpClient</code> depende de algo que por convenio llaman token de tipo <code>HTTP_INTERCEPTORS</code>. Nuestro trabajo consiste en que cuando reclame su dependencia, le demos la nuestra. El tpico gato por liebre. As en nuestro mdulo pondremos la siguiente configuracin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">providers: [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    provide: HTTP_INTERCEPTORS,</span><br><span class=\"line\">    useClass: AuditInterceptorService,</span><br><span class=\"line\">    multi: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure><p>El parmetro <code>multi:true</code> en este caso le indica que puede haber ms de un interceptor. Concretamente debe aadirlo a la lista y admitir ms. Hecho esto, sobrara el <code>providedIn: &#39;root&#39;</code> autogenerado en el decorador del servicio.</p><h2 id=\"3-3-Un-auditor-de-llamadas\"><a href=\"#3-3-Un-auditor-de-llamadas\" class=\"headerlink\" title=\"3.3 Un auditor de llamadas\"></a>3.3 Un auditor de llamadas</h2><p>Pues ya estamos listos para aportar algo de funcionalidad. Nuestro objetivo es escribir en el <em>log</em> un texto para cada llamada terminada y el tiempo que le tom. La idea es aprovechar que todo es un <em>stream</em> observable y canalizarlo en una tubera con una serie de operadores.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AuditInterceptorService <span class=\"keyword\">implements</span> HttpInterceptor &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> started = <span class=\"built_in\">Date</span>.now();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next.handle(req).pipe(</span><br><span class=\"line\">      filter(<span class=\"function\">(<span class=\"params\">event: HttpEvent&lt;<span class=\"built_in\">any</span>&gt;</span>) =&gt;</span> event <span class=\"keyword\">instanceof</span> HttpResponse),</span><br><span class=\"line\">      tap(<span class=\"function\">(<span class=\"params\">resp: HttpResponse&lt;<span class=\"built_in\">any</span>&gt;</span>) =&gt;</span> <span class=\"keyword\">this</span>.auditEvent(resp, started))</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> auditEvent(resp: HttpResponse&lt;<span class=\"built_in\">any</span>&gt;, started: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> elapsedMs = <span class=\"built_in\">Date</span>.now() - started;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> eventMessage = resp.statusText + <span class=\"string\">' on '</span> + resp.url;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> message = eventMessage + <span class=\"string\">' in '</span> + elapsedMs + <span class=\"string\">'ms'</span>;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(message);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>El operador <code>filter(any=&gt;bool)</code> se usa para descartar eventos que no cumplan unos criterios. En mi caso slo me interesan los eventos de recepcin de la peticin, y no necesito los intermedios. Uso de nuevo el <code>tap(callback)</code> para hacer cosas con los datos sin modificarlos en absoluto. En este caso los envo al mtodo <code>auditEvent</code> para que lo saque por consola. Listo: un auditor para todas las llamadas.</p><p>Ya tenemos el programa comunicado por <em>http</em> con un servidor; aunque por ahora de forma annima y sin ninguna seguridad. Con el conocimiento actual de los observables, del <em>httpClient</em> y de los interceptores ya estamos cerca de resolverlo. Sigue esta serie para aadirle <a href=\"../vigilancia-y-seguridad-en-Angular/\">vigilancia y seguridad en Angular</a> mientras aprendes a programar con Angular.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-6_http.png\" alt=\"comunicaciones-http-en-Angular\"></p><p>Las comunicaciones <em>http</em> son una pieza fundamental del desarrollo web, y en <strong>Angular</strong> siempre han sido potentes y fciles. Siempre?, bueno cuando apareci Angular 2 echbamos en falta algunas cosillas y adems la librera <em>RxJS</em> y sus <em>streams</em> son intimidantes para los novatos.</p><p>Pero en la versin Angular 7 <strong>consumir un servicio REST</strong> puede ser cosa de nios si aprendes a jugar con los <em>observables</em> y los servicios de la librera <code>@angular/common/http</code>. Conseguirs realizar <strong>comunicaciones http asncronas en Angular</strong>.</p>","more":"<p>Partiendo de la aplicacin tal cmo qued en <a href=\"../servicios-inyectables-en-Angular/\">Servicios inyectables en Angular</a>. Al finalizar tendrs una aplicacin que almacena y recupera los datos consumiendo un servicio REST usando las tecnologas de Angular Http.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/6-http/rates\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/6-http</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-El-servicio-HttpClient\"><a href=\"#1-El-servicio-HttpClient\" class=\"headerlink\" title=\"1. El servicio HttpClient\"></a>1. El servicio HttpClient</h1><p>Como demostracin vamos a consumir un API pblica con datos de <a href=\"https://exchangeratesapi.io/\" target=\"_blank\" rel=\"noopener\">cotizacin de monedas</a>. Crear un mdulo y un componente en el que visualizar las divisas y despus las transformaremos para guardarlas en un servicio propio.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m 6-http/rates --routing true</span><br><span class=\"line\">ng g c 6-http/rates/rates</span><br></pre></td></tr></table></figure><h2 id=\"1-1-Importacion-y-declaracion-de-servicios\"><a href=\"#1-1-Importacion-y-declaracion-de-servicios\" class=\"headerlink\" title=\"1.1 Importacin y declaracin de servicios\"></a>1.1 Importacin y declaracin de servicios</h2><p>La librera <code>@angular/common/http</code> trae el mdulo <code>HttpClientModule</code> con el servicio inyectable <code>HttpClient</code>. Lo primero es importar dicho mdulo.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpClientModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [RatesComponent],</span><br><span class=\"line\">  imports: [HttpClientModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesModule &#123; &#125;</span><br></pre></td></tr></table></figure><p>En tu componente tienes que reclamar la dependencia al servicio para poder usarla. Atencin a la importacin pues hay ms clases con el nombre <code>HttpClient</code>. Debe quedar algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpClient &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'app-rates'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./rates.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>A partir de este momento slo queda invocar los mtodos REST en la propiedad <code>this.http</code>.</p><h2 id=\"1-2-Obtencion-de-datos\"><a href=\"#1-2-Obtencion-de-datos\" class=\"headerlink\" title=\"1.2 Obtencin de datos\"></a>1.2 Obtencin de datos</h2><p>Para cada verbo <em>http</em> tenemos su mtodo en el servicio <code>HttpClient</code>. Su primer parmetro ser la <em>url</em> a la que invocar. Empecemos por el <code>get</code> que automticamente solicita y devuelve objetos <em>JSON</em> desde un API. Por ejemplo para obtener <a href=\"https://api.exchangeratesapi.io/latest?symbols=USD,GBP,CHF,JPY\" target=\"_blank\" rel=\"noopener\">las ltimas cotizaciones de las principales divisas</a> lo haremos as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> urlapi</span><br><span class=\"line\">    = <span class=\"string\">'https://api.exchangeratesapi.io/latest'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> currentEuroRates: <span class=\"built_in\">any</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.getCurrentEuroRates();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> getCurrentEuroRates() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> currencies = <span class=\"string\">'USD,GBP,CHF,JPY'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> url = <span class=\"string\">`<span class=\"subst\">$&#123;this.urlapi&#125;</span>?symbols=<span class=\"subst\">$&#123;currencies&#125;</span>`</span>;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">      .get(url)</span><br><span class=\"line\">      .subscribe(<span class=\"function\"><span class=\"params\">apiData</span> =&gt;</span> (<span class=\"keyword\">this</span>.currentEuroRates = apiData));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El mtodo <em>get</em> retorna un objeto observable. Los observables <em>http</em> han de consumirse mediante el mtodo <em>subscribe</em> para que realmente se lancen. Dicho mtodo <em>subscribe</em> admite hasta tres <em>callbacks</em>: <code>susbcribe(data, err, end)</code> para que se ejecuten en respuesta a eventos. En este ejemplo solo hemos usado el primero.</p></blockquote><p>La presentacin en la vista slo tiene que acceder a la propiedad dnde se hayan cargado las respuestas tratadas en el <em>callback</em> de la suscripcin.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> Currency Rates. <span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> From Euro to the world <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; currentEuroRates | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-3-Envio-de-datos\"><a href=\"#1-3-Envio-de-datos\" class=\"headerlink\" title=\"1.3 Envo de datos\"></a>1.3 Envo de datos</h2><p>Supongamos que, una vez recibidas las cotizaciones, pretendemos transformarlas y almacenarlas en otro servicio. El envo en este caso ser con el mtodo <em>post</em> al que se le pasar la ruta del <em>end point</em> y el objeto <em>payload</em> que se enviar al servidor.</p><p>Vamos a agregar una propiedad y un par de mtodos al <code>rates-component.ts</code>. La idea es obtener un array de cotizaciones aa partir del objeto previo, y guardarla una por una.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> myRatesApi</span><br><span class=\"line\">    = <span class=\"string\">'https://api-base.herokuapp.com/api/pub/rates'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> postRates() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> rates = <span class=\"keyword\">this</span>.transformData();</span><br><span class=\"line\">    rates.forEach(<span class=\"function\"><span class=\"params\">rate</span> =&gt;</span></span><br><span class=\"line\">      <span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">        .post(<span class=\"keyword\">this</span>.myRatesApi, rate)</span><br><span class=\"line\">        .subscribe()</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> transformData() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> current = <span class=\"keyword\">this</span>.currentEuroRates.rates;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">Object</span>.keys(current).map(<span class=\"function\"><span class=\"params\">key</span> =&gt;</span> (&#123;</span><br><span class=\"line\">      date: <span class=\"keyword\">this</span>.currentEuroRates.date,</span><br><span class=\"line\">      currency: key,</span><br><span class=\"line\">      euros: current[key]</span><br><span class=\"line\">    &#125;));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Atencin a los mtodos <code>subscribe()</code>. Aunque vayan vacos son imprescindibles para que se ejecute la llamada.</p></blockquote><p>En la vista no hay gran cosa que hacer, salvo agregarle un botn para iniciar el proceso:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Save Rates\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"postRates()\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-4-Actualizacion-de-datos\"><a href=\"#1-4-Actualizacion-de-datos\" class=\"headerlink\" title=\"1.4 Actualizacin de datos\"></a>1.4 Actualizacin de datos</h2><p>Un par de ejemplo ms para acabar de entender la mecnica bsica de <code>HttpClient</code>. Podemos fijar el tipo de datos esperado en cualquier llamada. De hecho es recomendable que tengas un interfaz para cada respuesta esperada.</p><p>En este tutorial no se ha hecho y no quedamos con el <code>any</code>, pero al menos distinguimos entre objetos y arrays. Esto es lo que aado al <code>RatesComponent</code> para que muestre los datos guardados en mi API.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RatesComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\"> <span class=\"keyword\">private</span> myRatesApi</span><br><span class=\"line\">  = <span class=\"string\">'https://api-base.herokuapp.com/api/pub/rates'</span>;</span><br><span class=\"line\"> <span class=\"keyword\">public</span> myRates: <span class=\"built_in\">any</span>[] = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">public</span> getMyRates() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">      .get&lt;<span class=\"built_in\">any</span>[]&gt;(<span class=\"keyword\">this</span>.myRatesApi)</span><br><span class=\"line\">      .subscribe(<span class=\"function\"><span class=\"params\">apiResult</span> =&gt;</span> (<span class=\"keyword\">this</span>.myRates = apiResult));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y en la vista, un nuevo botn y una nueva expresin.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Refresh\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"getMyRates()\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; myRates | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Por ltimo, en plan repaso, un ejemplo de mtodo para borrar.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> deleteMyRates() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient</span><br><span class=\"line\">    .delete(<span class=\"keyword\">this</span>.myRatesApi)</span><br><span class=\"line\">    .subscribe();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y su botn en en la vista.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Delete Rates\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"deleteMyRates()\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>Y hasta aqu lo bsico de comunicaciones <em>http</em>. Fcil verdad?. Pero la vida real raramente es tan sencilla. Si quieres enfrentarte a algo ms duro debes prepararte y dominar los observables <em>RxJS</em>.</p><p>Lo que viene a partir de ahora requerir tiempo y concentracin. Si continas adelante esto ya no ser <em>your grandpas http anymore</em>.</p><h1 id=\"2-Observables\"><a href=\"#2-Observables\" class=\"headerlink\" title=\"2 Observables\"></a>2 Observables</h1><p>Las <strong>comunicaciones</strong> entre navegadores y servidores son varios rdenes de magnitud ms lentas que las operaciones en memoria. Por tanto deben realizarse de manera asncrona para garantizar una buena experiencia al usuario.</p><p>Esta experiencia no siempre fue tan buena para el programador. Sobre todo con las primeras comunicaciones <em>AJAX</em> basadas en el paso de funciones <em>callback</em>. La aparicin de las <em>promises</em> mejor la claridad del cdigo, y ahora con los <em>Observables</em> tenemos adems una gran potencia para manipular la <strong>informacin asncrona</strong>.</p><blockquote><p>El patrn <code>Observable</code> fue implementado por Microsoft en la librera <a href=\"http://reactivex.io/intro.html\" target=\"_blank\" rel=\"noopener\"><em>Reactive Extensions</em></a> ms conocida como <code>RxJs</code>. El equipo de Angular decidi utilizarla para el desarrollo de las comunicaciones asncronas. Esta extensa librera puede resultar intimidante en un primer vistazo. Pero con muy poco conocimiento puedes programar casi todas las funcionalidades que se te ocurran.</p></blockquote><p>Lo primero es importar el cdigo, de forma similar a cualquier otra clase o funcin. Por ejemplo para empezar basta con <code>import { Observable } from &quot;rxjs/Observable&quot;;</code>. Tendremos la clase usada por angular para observar el respuesta <em>http</em>.</p><p>Pero esta es una clase genrica donde sus instancias admiten la manipulacin interna de tipos ms o menos concretos. Por eso ves en el ejemplo que algunas funciones retornan el tipo esperado <code>: Observable&lt;MyClass&gt;</code>, o si no saben que tipo esperar se conforman con <code>: Observable&lt;any&gt;</code>.</p><p>En cualquier caso, <strong>toda operacin asncrona retornar una instancia observable</strong> a la cual habr que subscribirse para recibir los datos o los errores, cuando termine.<br>Aunque a veces no se ver el <em>subscribe</em></p><h2 id=\"2-1-Async\"><a href=\"#2-1-Async\" class=\"headerlink\" title=\"2.1 Async\"></a>2.1 Async</h2><p>Para probar otras formas de presentar datos recibidos desde un API, voy a crear un nuevo componente. El <code>ObseratesComponent</code>, mezcla de <em>observables</em> y <em>rates</em>.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c 6-http/rates/obserates</span><br></pre></td></tr></table></figure><p>Y en su vista HTML usar una funcin propia de Angular llamada <code>async</code>. Dicha funcin acta como un <em>pipe</em> en una expresin. Igual que el <code>| json</code>. Pero a su izquierda espera que le den algo a lo que suscribirse; espera un observable.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span> Currency Observable Rates. <span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span> From Euro to the $ world <span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; currentEuroRates$ | async | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span>&#125;</span><br></pre></td></tr></table></figure><p>En este caso uso la propiedad <code>currentEuroRates$</code> finalizada en <strong>$</strong> por convenio. Esa propiedad se rellena en el controlador con el mtodo <code>get</code>, no con los datos futuros, si no con el propio <em>observable</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> ratesApi</span><br><span class=\"line\">  = <span class=\"string\">'https://api.exchangeratesapi.io/latest'</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> currentEuroRates$: Observable&lt;<span class=\"built_in\">any</span>&gt; = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> httpClient: HttpClient</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">ngOnInit() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.getCurrentEuroRates();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> getCurrentEuroRates() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> currencies = <span class=\"string\">'USD,GBP,CHF,JPY'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"string\">`<span class=\"subst\">$&#123;this.ratesApi&#125;</span>?symbols=<span class=\"subst\">$&#123;currencies&#125;</span>`</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.currentEuroRates$ = <span class=\"keyword\">this</span>.httpClient.get(url);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Al utilizar el <em>pipe async</em> ya no es necesaria la suscripcin en cdigo. La propia funcin del framework se ocupa de ello. Por tanto la llamada se realiza igualmente aunque no veamos la suscripcin.</p></blockquote><p>Esta es la manera recomendada de consumir datos desde un API. Definir la llamada en el controlador y pasarle el observable a la vista para que lo muestre cuando obtenga los datos.</p><h2 id=\"2-2-Pipe\"><a href=\"#2-2-Pipe\" class=\"headerlink\" title=\"2.2 Pipe\"></a>2.2 Pipe</h2><h3 id=\"Tuberias-en-RxJS-pipe\"><a href=\"#Tuberias-en-RxJS-pipe\" class=\"headerlink\" title=\"Tuberas en RxJS .pipe()\"></a>Tuberas en RxJS .pipe()</h3><p>Los datos devueltos raramente vienen en el formato preciso para usar en la vista. Con frecuencia hay que transformarlos al vuelo en cuanto se reciben. Recordemos que <strong><em>HttpClient</em> no devuelve los datos tal cual sino un <em>stream</em> de estados</strong> de dichos datos. La manipulacin ser sobre el <em>stream</em> no directamente sobre los datos; y, claro, para manipular un torrente hay que encauzarlo en tuberas.</p><p>Aqu es donde aparece el mtodo <code>.pipe(operator1, operator2...)</code> aplicado a un observable. Suele hacerse en lugar, o antes, del <code>.susbcribe(okCallback, errCallback)</code>. Este mtodo canaliza una serie de operadores predefinidos que manipulan el chorro de estados observados.</p><p>El operador ms utilizado es <code>map(sourceStream =&gt; targetStream)</code>. Este operador recibe una funcin <em>callBack</em> que ser invocada ante cada dato recibido. Esa funcin tienen que retornar un valor para sustituir al actual y as transformar el contenido del chorro.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> myRates$: Observable&lt;<span class=\"built_in\">any</span>[]&gt; = <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"keyword\">private</span> getCurrentEuroRates() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"string\">`<span class=\"subst\">$&#123;this.ratesApi&#125;</span>?symbols=USD,GBP,CHF,JPY`</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.currentEuroRates$ = <span class=\"keyword\">this</span>.httpClient.get(url);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.myRates$ = <span class=\"keyword\">this</span>.currentEuroRates$.pipe(map(<span class=\"keyword\">this</span>.transformData));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span> transformData(currentRates) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> current = currentRates.rates;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"built_in\">Object</span>.keys(current).map(<span class=\"function\"><span class=\"params\">key</span> =&gt;</span> (&#123;</span><br><span class=\"line\">    date: currentRates.date,</span><br><span class=\"line\">    currency: key,</span><br><span class=\"line\">    euros: current[key]</span><br><span class=\"line\">  &#125;));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>En este ejemplo partimos de nuevo de un objeto recibido y lo queremos ver como un <em>array</em> de objetos. Para ello lo transformamos usado el operador <code>map</code>. Este operador ha de importarse de <code>rxjs/operators</code> y aplicarse a un observable dentro de su mtodo <code>.pipe()</code>. Es el ms sencillo y uno de los ms utilizados: recibe y emite datos dentro de un stream de eventos observables. Nada que ver, salvo el nombre, con la sencilla funcin <code>array.map(callback)</code>, que recibe y devuelve datos estticos.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>&#123;&#123; myRates$ | async | json &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Por lo dems el consumo se hace igual pero tendremos que ver ms operadores para solucionar algunos inconvenientes.</p><h2 id=\"2-3-Operators\"><a href=\"#2-3-Operators\" class=\"headerlink\" title=\"2.3 Operators\"></a>2.3 Operators</h2><p>El cdigo anterior funciona, pero resulta que al haber dos funciones async suscritas provoca que la llamada original se realice dos veces. esto es as porque el segundo observable <code>myRates$</code> es una canalizacin del primero <code>currentEuroRates$</code>.</p><p>Estos y oros problemas se solucionan usando operadores. Vamos a conocer un par de ellos ms y veremos como <code>pipe(op1, op2, opn)</code> los ejecuta a todos en orden.</p><p>El operador <code>share()</code> permite compartir el resultado de una primera llamada con subsiguientes suscriptores. Evitando de ese modo la repeticin de costosas peticiones http.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> getCurrentEuroRates() &#123;</span><br><span class=\"line\"><span class=\"keyword\">const</span> url = <span class=\"string\">`<span class=\"subst\">$&#123;this.ratesApi&#125;</span>?symbols=USD,GBP,CHF,JPY`</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.currentEuroRates$ = <span class=\"keyword\">this</span>.httpClient.get(url)</span><br><span class=\"line\">      .pipe(share());</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.myRates$ = <span class=\"keyword\">this</span>.currentEuroRates$</span><br><span class=\"line\">      .pipe(</span><br><span class=\"line\">        tap(<span class=\"function\"><span class=\"params\">d</span>=&gt;</span><span class=\"built_in\">console</span>.log(d)),</span><br><span class=\"line\">        map(<span class=\"keyword\">this</span>.transformData),</span><br><span class=\"line\">        tap(<span class=\"function\"><span class=\"params\">t</span>=&gt;</span><span class=\"built_in\">console</span>.log(t))</span><br><span class=\"line\">      );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El operador <code>tap(callback)</code> es similar en nombre al <code>map()</code>. Pero la gran diferencia es que est pensado para no manipular los datos que recibe. Los usa y puede causar otros efectos colaterales, pero nunca modifica el propio stream. Es muy utilizado para inspeccionar o auditar el flujo de otros operadores.</p></blockquote><p>Reconozco que en un primer vistazo este cdigo pueda resultar complejo. Tmate tu tiempo. Fjate en los datos de entrada y salida de cada funcin. Esto es solo el principio del trabajo con la librera <em>RxJS</em> y la manipulacin de <em>streams de eventos observables</em>.</p><h1 id=\"3-Interceptores\"><a href=\"#3-Interceptores\" class=\"headerlink\" title=\"3. Interceptores\"></a>3. Interceptores</h1><p>Los interceptores tienen un nombre intimidante pero un propsito sencillo y muy til: <strong>interceptar todas las comunicaciones http</strong> y ejecutar cdigo personalizado para cada uno. Por ejemplo un gestor centralizado de errores http o el control de los tokens de seguridad de la aplicacin.</p><p>Pero antes de eso habr que aprender unos conceptos bsicos. Vamos a ver un ejemplo sencillo que audite todas las llamadas http. Todo empieza con un servicio:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s rates/AuditInterceptor</span><br></pre></td></tr></table></figure><h2 id=\"3-1-La-interfaz-HttpInterceptor\"><a href=\"#3-1-La-interfaz-HttpInterceptor\" class=\"headerlink\" title=\"3.1 La interfaz HttpInterceptor\"></a>3.1 La interfaz HttpInterceptor</h2><p>Al servicio genrico recin creado hay que hacerle cumplir una interfaz <code>HttpInterceptor</code> que viene con <code>HttpClientModule</code>. Esta interfaz solo necesita un mtodo, el <code>intercept(req, next)</code> pero sus tipos e implementacin mnima la hacen complicada de entender a la primera.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HttpEvent, HttpHandler, HttpInterceptor, HttpRequest &#125;</span><br><span class=\"line\">  <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common/http'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Injectable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Observable &#125; <span class=\"keyword\">from</span> <span class=\"string\">'rxjs'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AuditInterceptorService <span class=\"keyword\">implements</span> HttpInterceptor &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> intercept( req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler )</span><br><span class=\"line\">    : Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next.handle(req);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Todo este cdigo para nada. Porque eso es lo que hace, nada. Eso s, tampoco rompe ni bloquea nada. Vayamos por partes, primero los parmetros, luego el tipo de la respuesta y por ltimo la implementacin</p><ul><li><code>req: HttpRequest&lt;any&gt;</code> puntero a la peticin en curso</li><li><code>next: HttpHandler</code> puntero a la siguiente funcin que maneje la peticin</li><li><code>: Observable&lt;HttpEvent&lt;any&gt;&gt;</code> retornamos un stream de eventos http para cada peticin</li><li><code>return next.handle(req);</code> que el siguiente procese la peticin, sin hacerle nada en absoluto</li></ul><blockquote><p>Para entenderlo mejor puede ser til la siguiente analoga. Cuando usas httpClient.get() es como si pides algo a Amazon y te suscribes, es decir esperas el paquete. Pasado el tiempo el paquete llegar o no llegar, pero ya no lo gestionas t. Con los interceptores es como si espiases cada proceso de tu pedido: stock, picking, packaging, shipping Cada pedido es tratado en una sucesin de eventos. Con un interceptor observas !todos los eventos de todos los pedidos!</p></blockquote><h2 id=\"3-2-Inversion-del-control-via-token\"><a href=\"#3-2-Inversion-del-control-via-token\" class=\"headerlink\" title=\"3.2 Inversin del control va token\"></a>3.2 Inversin del control va token</h2><p>Tenemos un servicio que cumple una interfaz compleja. Pero dicho servicio debe ser provedo en algn mdulo antes de ser reclamado como dependencias por alguien. Pero por quin?</p><p>Tcnicamente lo necesita el propio <code>HttpClient</code> del framework. Pero, obviamente, no pueden reclamar por tipo una clase que acabo de inventarme yo. Adelante con la <strong>inversin del control</strong>.</p><p>Realmente <code>HttpClient</code> depende de algo que por convenio llaman token de tipo <code>HTTP_INTERCEPTORS</code>. Nuestro trabajo consiste en que cuando reclame su dependencia, le demos la nuestra. El tpico gato por liebre. As en nuestro mdulo pondremos la siguiente configuracin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">providers: [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    provide: HTTP_INTERCEPTORS,</span><br><span class=\"line\">    useClass: AuditInterceptorService,</span><br><span class=\"line\">    multi: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure><p>El parmetro <code>multi:true</code> en este caso le indica que puede haber ms de un interceptor. Concretamente debe aadirlo a la lista y admitir ms. Hecho esto, sobrara el <code>providedIn: &#39;root&#39;</code> autogenerado en el decorador del servicio.</p><h2 id=\"3-3-Un-auditor-de-llamadas\"><a href=\"#3-3-Un-auditor-de-llamadas\" class=\"headerlink\" title=\"3.3 Un auditor de llamadas\"></a>3.3 Un auditor de llamadas</h2><p>Pues ya estamos listos para aportar algo de funcionalidad. Nuestro objetivo es escribir en el <em>log</em> un texto para cada llamada terminada y el tiempo que le tom. La idea es aprovechar que todo es un <em>stream</em> observable y canalizarlo en una tubera con una serie de operadores.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AuditInterceptorService <span class=\"keyword\">implements</span> HttpInterceptor &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> started = <span class=\"built_in\">Date</span>.now();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next.handle(req).pipe(</span><br><span class=\"line\">      filter(<span class=\"function\">(<span class=\"params\">event: HttpEvent&lt;<span class=\"built_in\">any</span>&gt;</span>) =&gt;</span> event <span class=\"keyword\">instanceof</span> HttpResponse),</span><br><span class=\"line\">      tap(<span class=\"function\">(<span class=\"params\">resp: HttpResponse&lt;<span class=\"built_in\">any</span>&gt;</span>) =&gt;</span> <span class=\"keyword\">this</span>.auditEvent(resp, started))</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span> auditEvent(resp: HttpResponse&lt;<span class=\"built_in\">any</span>&gt;, started: <span class=\"built_in\">number</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> elapsedMs = <span class=\"built_in\">Date</span>.now() - started;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> eventMessage = resp.statusText + <span class=\"string\">' on '</span> + resp.url;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> message = eventMessage + <span class=\"string\">' in '</span> + elapsedMs + <span class=\"string\">'ms'</span>;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(message);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>El operador <code>filter(any=&gt;bool)</code> se usa para descartar eventos que no cumplan unos criterios. En mi caso slo me interesan los eventos de recepcin de la peticin, y no necesito los intermedios. Uso de nuevo el <code>tap(callback)</code> para hacer cosas con los datos sin modificarlos en absoluto. En este caso los envo al mtodo <code>auditEvent</code> para que lo saque por consola. Listo: un auditor para todas las llamadas.</p><p>Ya tenemos el programa comunicado por <em>http</em> con un servidor; aunque por ahora de forma annima y sin ninguna seguridad. Con el conocimiento actual de los observables, del <em>httpClient</em> y de los interceptores ya estamos cerca de resolverlo. Sigue esta serie para aadirle <a href=\"../vigilancia-y-seguridad-en-Angular/\">vigilancia y seguridad en Angular</a> mientras aprendes a programar con Angular.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"ng* el ecosistema de AngularJS","id":"2","updated":"2015-08-20T12:45:59.000Z","date":"2015-08-15T08:55:14.000Z","_content":"\nLista de componentes para ampliar AngularJS que te ayudarn a mejorar tus proyectos.\n\n- **AngularUI**: Antes de programar nada mira si estos chicos ya lo han hecho antes: utilidades, componentes visuales, *bootstrap* y...\n- **ng-grid**: Si tienes que mostrar datos en forma de tabla, este es tu punto de partida.\n- **ngProgress**: Para incorporar una barra de progreso que informe a tus usuarios de la actividad de la aplicacin.\n- **RestAngular**: Librera especializada para consumir servicios REST de manera avanzada e intensiva.\n- **angular-aop**: El AOP encapsula los *Aspectos* del cdigo relacionados con instrumentacin y seguimiento, liberndolo para la lgica de negocio.\n- **textAngular**: Editor de textos cpn doble binding, formatos, estilos\n- **angular-translate**: Tener una interfaz en distintos idiomas es una tarea cada vez mas comn y complicada. Esta librera es un gran ayuda.\n- **angular-field-splitter**: til para descomponer un campo lgico en varios inputs fsicos: Cdigos de cuenta, telfonos, fechas\n- **angular-gm**: Para mostrar mapas de Google de forma dinmica enlazados con tu modelo\n- **ng-slider**: Una barra con punteros para selecionar rangos de forma visual\n","source":"_posts/ng-el-ecosistema-de-AngularJS.md","raw":"---\ntitle: ng* el ecosistema de AngularJS\ntags: \n- AngularJS\ncategories:\n- Avanzado \npermalink: ng-el-ecosistema-de-angularjs\nid: 2\nupdated: 2015/08/20 14:45:59\ndate: 2015/08/15 10:55:14\n---\n\nLista de componentes para ampliar AngularJS que te ayudarn a mejorar tus proyectos.\n\n- **AngularUI**: Antes de programar nada mira si estos chicos ya lo han hecho antes: utilidades, componentes visuales, *bootstrap* y...\n- **ng-grid**: Si tienes que mostrar datos en forma de tabla, este es tu punto de partida.\n- **ngProgress**: Para incorporar una barra de progreso que informe a tus usuarios de la actividad de la aplicacin.\n- **RestAngular**: Librera especializada para consumir servicios REST de manera avanzada e intensiva.\n- **angular-aop**: El AOP encapsula los *Aspectos* del cdigo relacionados con instrumentacin y seguimiento, liberndolo para la lgica de negocio.\n- **textAngular**: Editor de textos cpn doble binding, formatos, estilos\n- **angular-translate**: Tener una interfaz en distintos idiomas es una tarea cada vez mas comn y complicada. Esta librera es un gran ayuda.\n- **angular-field-splitter**: til para descomponer un campo lgico en varios inputs fsicos: Cdigos de cuenta, telfonos, fechas\n- **angular-gm**: Para mostrar mapas de Google de forma dinmica enlazados con tu modelo\n- **ng-slider**: Una barra con punteros para selecionar rangos de forma visual\n","slug":"ng-el-ecosistema-de-angularjs","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvj30023iwd3eb4hu4n0","content":"<p>Lista de componentes para ampliar AngularJS que te ayudarn a mejorar tus proyectos.</p><ul><li><strong>AngularUI</strong>: Antes de programar nada mira si estos chicos ya lo han hecho antes: utilidades, componentes visuales, <em>bootstrap</em> y</li><li><strong>ng-grid</strong>: Si tienes que mostrar datos en forma de tabla, este es tu punto de partida.</li><li><strong>ngProgress</strong>: Para incorporar una barra de progreso que informe a tus usuarios de la actividad de la aplicacin.</li><li><strong>RestAngular</strong>: Librera especializada para consumir servicios REST de manera avanzada e intensiva.</li><li><strong>angular-aop</strong>: El AOP encapsula los <em>Aspectos</em> del cdigo relacionados con instrumentacin y seguimiento, liberndolo para la lgica de negocio.</li><li><strong>textAngular</strong>: Editor de textos cpn doble binding, formatos, estilos</li><li><strong>angular-translate</strong>: Tener una interfaz en distintos idiomas es una tarea cada vez mas comn y complicada. Esta librera es un gran ayuda.</li><li><strong>angular-field-splitter</strong>: til para descomponer un campo lgico en varios inputs fsicos: Cdigos de cuenta, telfonos, fechas</li><li><strong>angular-gm</strong>: Para mostrar mapas de Google de forma dinmica enlazados con tu modelo</li><li><strong>ng-slider</strong>: Una barra con punteros para selecionar rangos de forma visual</li></ul>","site":{"data":{}},"excerpt":"","more":"<p>Lista de componentes para ampliar AngularJS que te ayudarn a mejorar tus proyectos.</p><ul><li><strong>AngularUI</strong>: Antes de programar nada mira si estos chicos ya lo han hecho antes: utilidades, componentes visuales, <em>bootstrap</em> y</li><li><strong>ng-grid</strong>: Si tienes que mostrar datos en forma de tabla, este es tu punto de partida.</li><li><strong>ngProgress</strong>: Para incorporar una barra de progreso que informe a tus usuarios de la actividad de la aplicacin.</li><li><strong>RestAngular</strong>: Librera especializada para consumir servicios REST de manera avanzada e intensiva.</li><li><strong>angular-aop</strong>: El AOP encapsula los <em>Aspectos</em> del cdigo relacionados con instrumentacin y seguimiento, liberndolo para la lgica de negocio.</li><li><strong>textAngular</strong>: Editor de textos cpn doble binding, formatos, estilos</li><li><strong>angular-translate</strong>: Tener una interfaz en distintos idiomas es una tarea cada vez mas comn y complicada. Esta librera es un gran ayuda.</li><li><strong>angular-field-splitter</strong>: til para descomponer un campo lgico en varios inputs fsicos: Cdigos de cuenta, telfonos, fechas</li><li><strong>angular-gm</strong>: Para mostrar mapas de Google de forma dinmica enlazados con tu modelo</li><li><strong>ng-slider</strong>: Una barra con punteros para selecionar rangos de forma visual</li></ul>"},{"title":"Hola Angular CLI","date":"2019-01-09T11:54:00.000Z","thumbnail":"/css/images/angular-0_cli.png","_content":"\n![hola-angular-cli](/images/tutorial-angular-0_cli.png)\n\n**Angular en su versin 7 es la plataforma perfecta para el desarrollo** profesional de aplicaciones modernas. **El Angular CLI es la herramienta** adecuada para generar aplicaciones Angular. Juntos son imbatibles en cuanto a velocidad en desarrollo y a potencia en ejecucin.\n\n<!-- more -->\n\nEl comnmente conocido como **AngularCLI** o _angular cli_ o _angular-cli_ o _ CLI a secas_ es la herramienta de lnea de comandos estndar para **crear, depurar y publicar aplicaciones Angular**. En su actual **versin 7** es ms potente y verstil que nunca y es muy sencillo dominar los aspectos bsicos.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/0-hello](https://github.com/AcademiaBinaria/angular-board/)\n\n# 1. Instalacin de Angular CLI 7\n\nAngular es una plataforma de desarrollo dogmtica y llave en mano. Para empezar, como en casi cualquier desarrollo **necesitars [NodeJS](https://nodejs.org/en/) y su manejador de de paquetes _npm_**. Tenerlos actualizados es un mandamiento bsico para un desarrollador web. Comprueba tu versin con el siguiente comando:\n\n```console\nnode -v\n```\n\nEmpieza con una **instalacin global** que te permita usar la herramienta desde cualquier directorio. Comprueba la versin instalada y accede a la ayuda en lnea. La ayuda est disponible tanto de modo general como para cada comando que vayas a usar.\n\nInstrucciones para instalar Angular CLI.\n\n```console\n$ npm i -g @angular/cli@latest\n$ ng version\n$ ng help\n$ ng new --help\n```\n\n# 2. Crear y ejecutar una aplicacin Angular 7\n\nUna vez que hayas instalado el CLI de manera global ya puedes empezar a usarlo en tu directorio de trabajo. El primer comando ser `ng new` que te va a **generar toda una aplicacin funcional** y las configuraciones necesarias para su depuracin, pruebas y ejecucin.\n\nComo novedad, en las ltimas versiones, el CLI te preguntar por algunas opciones para crear tu aplicacin. Eso es porque no todos los desarrollos son iguales. Se puede configurar el tipo, el estilo y muchas ms cosas, tanto de forma interactiva como mediante opciones en lnea de comandos.\n\nLo ms habitual es usar la configuracin que viene por defecto, pero tambin se pueden crear soluciones a medida. Te muestro unos ejemplos para que pruebes y te familiarices con la herramienta. Para ms informacin mira la documentacin del comando [ng new](https://angular.io/cli/new).\n\n## 2.1 Normal\n\n```console\nng new normal\ncd normal\nnpm start\n```\n\n## 2.2 Minimalista\n\n```console\nng new minimalista -s -S -t\ncd minimalista\nnpm start\n```\n\n## 2.3 Profesional\n\n```console\nng new profesional -p acme --routing true\ncd profesional\nnpm start\n```\n\n## 2.4 Empresarial\n\n```console\nng new empresarial --create-application false\ncd empresarial\nng generate application compras -p acme --routing true\nnpm start\n```\n\nUna vez finalizada la instalacin de todas las libreras necesarias puedes bajar a la carpeta recin creada y ejecutar el comando standard de _npm_ para el arranque de cualquier aplicacin: `npm start`. Si todo va bien, en unos segundo podrs visitar [http://localhost:4000](http://localhost:4000) para ver en marcha la aplicacin. Lo veremos con ms detalle en el apartado de configuracin.\n\n> ejemplo: La aplicacin que sirve de ejemplo a este tutorial fue creada con este comando:\n\n```console\nng new angular-board --routing true -s -S\n```\n\n# 3. Estructura de una aplicacin Angular\n\nUna vez generada y comprobada la ejecucin, toca estudiar cmo es la estructura de la aplicacin. Para ello revisa carpeta a carpeta. Las malas noticias son que hay **una enorme cantidad de ficheros y carpetas**, las buenas son que como vers, casi todo es **configuracin e infraestructura**.\n\n## 3.1 Visual Studio Code\n\nPara ver y editar los ficheros te vale cualquier editor de cdigo, pero yo uso y te recomiendo [VSCode](https://code.visualstudio.com/). Es un **gran editor, gratuito y multiplataforma**. Viene con un terminal integrado y puedes mejorarlo instalando extensiones desde una galera del propio editor.\n\nTe recomiendo instalar un paquete de extensiones ya configurado y preparado para el desarrollo de aplicaciones con _Angular_, se llama [Angular Essentials](https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials). Con eso y el [Material Icon Theme](https://marketplace.visualstudio.com/items?itemName=PKief.material-icon-theme) vers _Angular en colores_.\n\n## 3.2 Carpetas y Ficheros principales\n\nVolviendo a la **estructura de ficheros y carpetas** te encontrars con muchos archivos de distintos tipos. Si eres completamente nuevo en Angular, te llamar la atencin las extensiones `.ts`. Son para ficheros [_TypeScript_](https://www.typescriptlang.org/), una evolucin del _JavaScript_ con facilidades para el programador. Por ahora slo tienes que familiarizarte con estos:\n\n- **angular.json** _: configuracin del propio CLI. La madre de todos los configuradores_\n- **package.json** _: dependencias de libreras y scripts_\n- **src/** _: la carpeta donde estn los archivos fuentes_\n  - **index.html** _: un fichero HTML ndice estndar_\n  - **main.ts** _: fichero TypeScript de arranque de la aplicacin_\n  - **app/** _: la carpeta con el cdigo especfico de tu aplicacin_\n    - **app.module.ts** _: la aplicacin es un rbol de mdulos, y este es su raz_\n    - **app.component.ts** _: la pgina es un rbol de componentes, y este es su raz_\n    - **app.component.html** _: el componente tiene una parte visual, esta es su vista_\n\nEcha un vistazo a estos ficheros, pronto los modificaremos para sentirnos programadores.\n\n# 4. Edicin\n\nAngular CLI instala y configura un conjunto de herramientas que te harn la vida ms fcil. Entre otras, destaca la capacidad de **recargar la aplicacin en caliente** en cuanto guardas tu trabajo como programador. En esta ltima versin, la 7, se ha mejorado el proceso y es realmente rpido.\n\nPara probarlo slo tienes que dejar arrancada la aplicacin con el comando `npm start`; **cambiar un fichero de cdigo y comprobar el resultado** en el navegador. Te propongo empezar como en cualquier otro lenguaje; por el famoso _hola mundo_.\n\n## 4.1 Hola Mundo\n\nAbre el fichero `app.component.ts` y busca dentro de l una clase llamada `AppComponent`. Encontrars que tiene una propiedad `title`. Asgnale el saludo de rigor: `title = 'actibot: hello world ;-)';`. Guarda y comprueba cmo tu navegador **se habr actualizado automticamente**.\n\nToda **esta magia depende de una cadena de comandos** que lanzan distintas herramientas previamente instaladas y configuradas por el CLI. Entre ellas cabe mencionar a [_WebPack_](https://webpack.github.io/), un coloso que afortunadamente viene instalado y preparado para funcionar de manera transparente.\n\n## 4.2 npm start\n\nEsta es una lista no exhaustiva de lo que sucede.\n\n1. npm start\n2. ng serve\n3. webpack server en http://localhost:4270\n   1. vigilancia de cambios sobre la carpeta src/\n   2. live reload\n   3. compilado de la aplicacin\n   4. recarga del navegador\n\nCambia a tu antojo el `app.component.ts` o su hermano `app.component.html` y comprueba los cambios de manera inmediata en tu navegador.\n\n# 5. Configuracin\n\nEl CLI 7 viene con pilas incluidas, se puede usar desde el primer momento. Slo quedan pequeas mejoras que hacer. Por ejemplo ajustar el `package.json` y agregar libreras de terceros.\n\n## 5.1 Package.json\n\nEl `package.json` es el fichero estndar de _npm_ donde se almacenan las **dependencias de terceros**. Contiene las libreras que necesita la aplicacin para ejecutarse, por ejemplo todas las de _Angular 7_. Y tambin las herramientas que necesita el programador, por ejemplo el propio _AngularCLI_;\n\n```json\n{\n  \"dependencies\": {\n    \"@angular/core\": \"^7.2.0\"\n  },\n  \"devDependencies\": {\n    \"@angular/cli\": \"7.2.0\"\n  }\n}\n```\n\nOtro uso del `package.json` es servir de **contenedor de scripts** para automatizar tareas de operaciones rutinarias. Por ejemplo, el comando estndar `npm start` ejecutar el contenido asignado en el fichero _json_, originalmente `ng serve`. Esto lanza el servidor de pruebas con sus opciones por defecto.\n\nPero el **comando [ng serve](https://angular.io/cli/serve)** admite muchas configuraciones. Te propongo que uses esta para activar un modo de compilacin ms rpido y seguro, y para que se abra el navegador de forma automtica en cuanto lances el servidor. Y adems te recomiendo que uses un puerto especfico para cada aplicacin.\n\nOtras configuraciones en produccin\n\n```json\n{\n  \"start\": \"ng serve --aot -o --port 4270\"\n}\n```\n\n## 5.2 Estilos y libreras de terceros\n\nLas libreras que vienen de fbrica tienen todo lo necesario para crear aplicaciones. Pero raro es el caso en que no necesitemos **algn que otro producto de terceros**. Ya sean utilidades como _[date-fns](https://date-fns.org/)_, libreras grficas como _[chart.js](http://www.chartjs.org/)_ o la aplicacin de estilos y componentes visuales de _frameworks como Bootstrap o MaterialDesign_. Pero todos se instalan de igual forma. Descargndolos con _npm_ y adjuntndolos en el `angular.json`.\n\n> En este tutorial te propongo usar una hoja de estilos muy simple que mejora la apariencia de cualquier aplicacin sin necesidad de usar clases propias. Se llama _[MiniCSS](https://minicss.org/)_ y es apropiada para prototipos, pruebas o pequeos proyectos.\n\nSe descargan e instalan de manera estndar.\n\n```console\nnpm install mini.css --save\n```\n\nPara que se incluyan en la distribucin hay que ir a la configuracin del _CLI_. Entonces se agrega dentro del fichero `.angular.json` a la coleccin de _styles_ o de _scripts_ que corresponda.\n\n```json\n{\n  \"styles\": [\"src/styles.css\", \"./node_modules/mini.css/dist/mini-default.min.css\"]\n}\n```\n\nEstas colecciones de archivos los usa el _cli_ a travs de _webpack_ para incluirlos **minificados y concatenados en un fichero _bundle_ sustituyendo a las clsicas etiquetas html**.Todo, el html y sus estilos, se construir en el cliente a partir de instrucciones JavaScript. De esta forma el fichero `index.html` apenas tendrs que tocarlo, salvo para algunas etiquetas de meta informacin.\n\n```html\n<meta name=\"description\" content=\"A sample project for learning Angular ;-)\" />\n<meta name=\"keywords\" content=\"Angular Sample Tutorial Ejemplo\" />\n<meta name=\"author\" content=\"Alberto Basalo\" />\n```\n\nUna cosa ms, los cambios en los ficheros de configuracin no se auto recargan. Tienes que parar la servidor y volver a lanzarlo para apreciar el estilo _MiniCSS_.\n\n## 5.3 Environments\n\nLa carpeta `environments/` contiene dos ficheros, y puede contener ms, para cada entorno de distribucin necesario. En cdigo siempre importaremos el fichero base, pero durante la compilacin el CLI lo sustituir por el adecuado.\n\n```typescript\ntitle = environment.appName + 'hello world ;-)';\n```\n\n## 5.4 Assets\n\nLos ficheros de la carpeta `assets/` se copian tal cual al despliegue. Es un buen lugar para logos, imgenes y ficheros de datos estticos.\n\nPor ejemplo, en el `app.component.html` he sustituido la imagen incrustada del Angular con un logo propio.\n\n```html\n<img width=\"100\" src=\"./assets/logo.png\" />\n```\n\n# 6. Angular 7, el CLI 7 y su ecosistema\n\nAlgunos consejos y herramientas tiles que rodean al mundo Angular.\n\nPero si la lnea de comandos te suena muy antigua y lo tuyo son las interfaces grficas, ests de suerte. El reciente proyecto [Angular Console](https://angularconsole.com/) te permite generar y ejecutar comandos desde una cmoda interfaz grfica.\n\nUna mejora digna de mencin es la capacidad de presupuestar tamaos de los ficheros generados. De esa forma podemos controlar el peso y tiempo de descarga de la aplicacin.\n\nPara garantizar la limpieza del cdigo conviene usar herramientas como [Prettier](https://prettier.io/) y configurarlas para su compatibilidad con Angular.\n\nLos ltimos toques antes de publicar pueden incluir el _script de analytics_ en el `index.html` y ajustes de retro-compatibilidad en el fichero `polyfills.ts`. Luego un comando y listo para publicar en _github pages_.\n\n> Te recomiendo que te familiarices y uses mucho estos _scripts_ en el `package.json` para poder lanzarlos ms tarde.\n\n```json\n{\n  \"scripts\": {\n    \"build:prod\": \"ng build --prod\",\n    \"build:pub\": \"ng build --prod --output-path docs --base-href https://academiabinaria.github.io/angular-board/\",\n    \"e2e\": \"ng e2e\",\n    \"http-server\": \"http-server ./dist/angular-board/ -c-1 -p4271 -a localhost -o\",\n    \"lint\": \"ng lint\",\n    \"ng\": \"ng\",\n    \"pub\": \"npm run build:pub && npm run push\",\n    \"push\": \"git add * && git commit -m 'pub' && git push\",\n    \"start:prod\": \"npm run build:prod && npm run http-server\",\n    \"start\": \"ng serve --aot -o --port 4270\",\n    \"test\": \"ng test\"\n  }\n}\n```\n\nComprueba las ejecuciones de los distintos _scripts_. Con `npm start` no se generan ficheros fsicos. Todos es en memoria para mayor velocidad de re-compilacin mientras desarrollas. En cambio `npm run build:prod` crear una carpeta `./dist/angular-board` en la que dejar los archivos necesarios para ejecucin. Por ltimo `npm run pub` los prepara para enviar compilados a la carpeta estndar `./docs` listos para publicarse en las _github pages_.\n\nOtros enlaces de inters sobre el ecosistema Angular.\n\n- [Extensiones Esenciales](https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials)\n- [Prettier](https://prettier.io/)\n- [Angular Console](https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console)\n- [Angular Material](https://material.angular.io/)\n- [Bootstrap](https://ng-bootstrap.github.io/#/home)\n- [Augury](https://augury.rangle.io/)\n- [Apollo GraphQL](https://www.apollographql.com/docs/)\n- [Ionic](https://ionicframework.com/)\n- [Angular Console](https://angularconsole.com/)\n\nPara complementar tu conocimiento te recomiendo la [documentacin de Angular/CLI](https://angular.io/cli) y este artculo avanzado que trata la configuracin del CLI en profundidad [Angular CLI under the hood](https://medium.com/dailyjs/angular-cli-6-under-the-hood-builders-demystified-f0690ebcf01)\n\nEsto es slo el principio, _Angular CLI 7_ puede hacer mucho ms por ti; descbrelo en esta serie tutorial para aprender a programar con Angular 7. En el prximo artculo crearemos una [Base para una aplicacin Angular](../base-aplicacion-angular/).\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng_0-Hola-Angular-CLI.md","raw":"---\ntitle: Hola Angular CLI\npermalink: hola-angular-cli\ndate: 2019-01-09 12:54:00\ntags:\n  - Angular\n  - CLI\n  - Tutorial\n  - Introduccin\n  - Angular7\n  - Angular2\ncategories:\n  - [Tutorial, Angular]\nthumbnail: /css/images/angular-0_cli.png\n---\n\n![hola-angular-cli](/images/tutorial-angular-0_cli.png)\n\n**Angular en su versin 7 es la plataforma perfecta para el desarrollo** profesional de aplicaciones modernas. **El Angular CLI es la herramienta** adecuada para generar aplicaciones Angular. Juntos son imbatibles en cuanto a velocidad en desarrollo y a potencia en ejecucin.\n\n<!-- more -->\n\nEl comnmente conocido como **AngularCLI** o _angular cli_ o _angular-cli_ o _ CLI a secas_ es la herramienta de lnea de comandos estndar para **crear, depurar y publicar aplicaciones Angular**. En su actual **versin 7** es ms potente y verstil que nunca y es muy sencillo dominar los aspectos bsicos.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/0-hello](https://github.com/AcademiaBinaria/angular-board/)\n\n# 1. Instalacin de Angular CLI 7\n\nAngular es una plataforma de desarrollo dogmtica y llave en mano. Para empezar, como en casi cualquier desarrollo **necesitars [NodeJS](https://nodejs.org/en/) y su manejador de de paquetes _npm_**. Tenerlos actualizados es un mandamiento bsico para un desarrollador web. Comprueba tu versin con el siguiente comando:\n\n```console\nnode -v\n```\n\nEmpieza con una **instalacin global** que te permita usar la herramienta desde cualquier directorio. Comprueba la versin instalada y accede a la ayuda en lnea. La ayuda est disponible tanto de modo general como para cada comando que vayas a usar.\n\nInstrucciones para instalar Angular CLI.\n\n```console\n$ npm i -g @angular/cli@latest\n$ ng version\n$ ng help\n$ ng new --help\n```\n\n# 2. Crear y ejecutar una aplicacin Angular 7\n\nUna vez que hayas instalado el CLI de manera global ya puedes empezar a usarlo en tu directorio de trabajo. El primer comando ser `ng new` que te va a **generar toda una aplicacin funcional** y las configuraciones necesarias para su depuracin, pruebas y ejecucin.\n\nComo novedad, en las ltimas versiones, el CLI te preguntar por algunas opciones para crear tu aplicacin. Eso es porque no todos los desarrollos son iguales. Se puede configurar el tipo, el estilo y muchas ms cosas, tanto de forma interactiva como mediante opciones en lnea de comandos.\n\nLo ms habitual es usar la configuracin que viene por defecto, pero tambin se pueden crear soluciones a medida. Te muestro unos ejemplos para que pruebes y te familiarices con la herramienta. Para ms informacin mira la documentacin del comando [ng new](https://angular.io/cli/new).\n\n## 2.1 Normal\n\n```console\nng new normal\ncd normal\nnpm start\n```\n\n## 2.2 Minimalista\n\n```console\nng new minimalista -s -S -t\ncd minimalista\nnpm start\n```\n\n## 2.3 Profesional\n\n```console\nng new profesional -p acme --routing true\ncd profesional\nnpm start\n```\n\n## 2.4 Empresarial\n\n```console\nng new empresarial --create-application false\ncd empresarial\nng generate application compras -p acme --routing true\nnpm start\n```\n\nUna vez finalizada la instalacin de todas las libreras necesarias puedes bajar a la carpeta recin creada y ejecutar el comando standard de _npm_ para el arranque de cualquier aplicacin: `npm start`. Si todo va bien, en unos segundo podrs visitar [http://localhost:4000](http://localhost:4000) para ver en marcha la aplicacin. Lo veremos con ms detalle en el apartado de configuracin.\n\n> ejemplo: La aplicacin que sirve de ejemplo a este tutorial fue creada con este comando:\n\n```console\nng new angular-board --routing true -s -S\n```\n\n# 3. Estructura de una aplicacin Angular\n\nUna vez generada y comprobada la ejecucin, toca estudiar cmo es la estructura de la aplicacin. Para ello revisa carpeta a carpeta. Las malas noticias son que hay **una enorme cantidad de ficheros y carpetas**, las buenas son que como vers, casi todo es **configuracin e infraestructura**.\n\n## 3.1 Visual Studio Code\n\nPara ver y editar los ficheros te vale cualquier editor de cdigo, pero yo uso y te recomiendo [VSCode](https://code.visualstudio.com/). Es un **gran editor, gratuito y multiplataforma**. Viene con un terminal integrado y puedes mejorarlo instalando extensiones desde una galera del propio editor.\n\nTe recomiendo instalar un paquete de extensiones ya configurado y preparado para el desarrollo de aplicaciones con _Angular_, se llama [Angular Essentials](https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials). Con eso y el [Material Icon Theme](https://marketplace.visualstudio.com/items?itemName=PKief.material-icon-theme) vers _Angular en colores_.\n\n## 3.2 Carpetas y Ficheros principales\n\nVolviendo a la **estructura de ficheros y carpetas** te encontrars con muchos archivos de distintos tipos. Si eres completamente nuevo en Angular, te llamar la atencin las extensiones `.ts`. Son para ficheros [_TypeScript_](https://www.typescriptlang.org/), una evolucin del _JavaScript_ con facilidades para el programador. Por ahora slo tienes que familiarizarte con estos:\n\n- **angular.json** _: configuracin del propio CLI. La madre de todos los configuradores_\n- **package.json** _: dependencias de libreras y scripts_\n- **src/** _: la carpeta donde estn los archivos fuentes_\n  - **index.html** _: un fichero HTML ndice estndar_\n  - **main.ts** _: fichero TypeScript de arranque de la aplicacin_\n  - **app/** _: la carpeta con el cdigo especfico de tu aplicacin_\n    - **app.module.ts** _: la aplicacin es un rbol de mdulos, y este es su raz_\n    - **app.component.ts** _: la pgina es un rbol de componentes, y este es su raz_\n    - **app.component.html** _: el componente tiene una parte visual, esta es su vista_\n\nEcha un vistazo a estos ficheros, pronto los modificaremos para sentirnos programadores.\n\n# 4. Edicin\n\nAngular CLI instala y configura un conjunto de herramientas que te harn la vida ms fcil. Entre otras, destaca la capacidad de **recargar la aplicacin en caliente** en cuanto guardas tu trabajo como programador. En esta ltima versin, la 7, se ha mejorado el proceso y es realmente rpido.\n\nPara probarlo slo tienes que dejar arrancada la aplicacin con el comando `npm start`; **cambiar un fichero de cdigo y comprobar el resultado** en el navegador. Te propongo empezar como en cualquier otro lenguaje; por el famoso _hola mundo_.\n\n## 4.1 Hola Mundo\n\nAbre el fichero `app.component.ts` y busca dentro de l una clase llamada `AppComponent`. Encontrars que tiene una propiedad `title`. Asgnale el saludo de rigor: `title = 'actibot: hello world ;-)';`. Guarda y comprueba cmo tu navegador **se habr actualizado automticamente**.\n\nToda **esta magia depende de una cadena de comandos** que lanzan distintas herramientas previamente instaladas y configuradas por el CLI. Entre ellas cabe mencionar a [_WebPack_](https://webpack.github.io/), un coloso que afortunadamente viene instalado y preparado para funcionar de manera transparente.\n\n## 4.2 npm start\n\nEsta es una lista no exhaustiva de lo que sucede.\n\n1. npm start\n2. ng serve\n3. webpack server en http://localhost:4270\n   1. vigilancia de cambios sobre la carpeta src/\n   2. live reload\n   3. compilado de la aplicacin\n   4. recarga del navegador\n\nCambia a tu antojo el `app.component.ts` o su hermano `app.component.html` y comprueba los cambios de manera inmediata en tu navegador.\n\n# 5. Configuracin\n\nEl CLI 7 viene con pilas incluidas, se puede usar desde el primer momento. Slo quedan pequeas mejoras que hacer. Por ejemplo ajustar el `package.json` y agregar libreras de terceros.\n\n## 5.1 Package.json\n\nEl `package.json` es el fichero estndar de _npm_ donde se almacenan las **dependencias de terceros**. Contiene las libreras que necesita la aplicacin para ejecutarse, por ejemplo todas las de _Angular 7_. Y tambin las herramientas que necesita el programador, por ejemplo el propio _AngularCLI_;\n\n```json\n{\n  \"dependencies\": {\n    \"@angular/core\": \"^7.2.0\"\n  },\n  \"devDependencies\": {\n    \"@angular/cli\": \"7.2.0\"\n  }\n}\n```\n\nOtro uso del `package.json` es servir de **contenedor de scripts** para automatizar tareas de operaciones rutinarias. Por ejemplo, el comando estndar `npm start` ejecutar el contenido asignado en el fichero _json_, originalmente `ng serve`. Esto lanza el servidor de pruebas con sus opciones por defecto.\n\nPero el **comando [ng serve](https://angular.io/cli/serve)** admite muchas configuraciones. Te propongo que uses esta para activar un modo de compilacin ms rpido y seguro, y para que se abra el navegador de forma automtica en cuanto lances el servidor. Y adems te recomiendo que uses un puerto especfico para cada aplicacin.\n\nOtras configuraciones en produccin\n\n```json\n{\n  \"start\": \"ng serve --aot -o --port 4270\"\n}\n```\n\n## 5.2 Estilos y libreras de terceros\n\nLas libreras que vienen de fbrica tienen todo lo necesario para crear aplicaciones. Pero raro es el caso en que no necesitemos **algn que otro producto de terceros**. Ya sean utilidades como _[date-fns](https://date-fns.org/)_, libreras grficas como _[chart.js](http://www.chartjs.org/)_ o la aplicacin de estilos y componentes visuales de _frameworks como Bootstrap o MaterialDesign_. Pero todos se instalan de igual forma. Descargndolos con _npm_ y adjuntndolos en el `angular.json`.\n\n> En este tutorial te propongo usar una hoja de estilos muy simple que mejora la apariencia de cualquier aplicacin sin necesidad de usar clases propias. Se llama _[MiniCSS](https://minicss.org/)_ y es apropiada para prototipos, pruebas o pequeos proyectos.\n\nSe descargan e instalan de manera estndar.\n\n```console\nnpm install mini.css --save\n```\n\nPara que se incluyan en la distribucin hay que ir a la configuracin del _CLI_. Entonces se agrega dentro del fichero `.angular.json` a la coleccin de _styles_ o de _scripts_ que corresponda.\n\n```json\n{\n  \"styles\": [\"src/styles.css\", \"./node_modules/mini.css/dist/mini-default.min.css\"]\n}\n```\n\nEstas colecciones de archivos los usa el _cli_ a travs de _webpack_ para incluirlos **minificados y concatenados en un fichero _bundle_ sustituyendo a las clsicas etiquetas html**.Todo, el html y sus estilos, se construir en el cliente a partir de instrucciones JavaScript. De esta forma el fichero `index.html` apenas tendrs que tocarlo, salvo para algunas etiquetas de meta informacin.\n\n```html\n<meta name=\"description\" content=\"A sample project for learning Angular ;-)\" />\n<meta name=\"keywords\" content=\"Angular Sample Tutorial Ejemplo\" />\n<meta name=\"author\" content=\"Alberto Basalo\" />\n```\n\nUna cosa ms, los cambios en los ficheros de configuracin no se auto recargan. Tienes que parar la servidor y volver a lanzarlo para apreciar el estilo _MiniCSS_.\n\n## 5.3 Environments\n\nLa carpeta `environments/` contiene dos ficheros, y puede contener ms, para cada entorno de distribucin necesario. En cdigo siempre importaremos el fichero base, pero durante la compilacin el CLI lo sustituir por el adecuado.\n\n```typescript\ntitle = environment.appName + 'hello world ;-)';\n```\n\n## 5.4 Assets\n\nLos ficheros de la carpeta `assets/` se copian tal cual al despliegue. Es un buen lugar para logos, imgenes y ficheros de datos estticos.\n\nPor ejemplo, en el `app.component.html` he sustituido la imagen incrustada del Angular con un logo propio.\n\n```html\n<img width=\"100\" src=\"./assets/logo.png\" />\n```\n\n# 6. Angular 7, el CLI 7 y su ecosistema\n\nAlgunos consejos y herramientas tiles que rodean al mundo Angular.\n\nPero si la lnea de comandos te suena muy antigua y lo tuyo son las interfaces grficas, ests de suerte. El reciente proyecto [Angular Console](https://angularconsole.com/) te permite generar y ejecutar comandos desde una cmoda interfaz grfica.\n\nUna mejora digna de mencin es la capacidad de presupuestar tamaos de los ficheros generados. De esa forma podemos controlar el peso y tiempo de descarga de la aplicacin.\n\nPara garantizar la limpieza del cdigo conviene usar herramientas como [Prettier](https://prettier.io/) y configurarlas para su compatibilidad con Angular.\n\nLos ltimos toques antes de publicar pueden incluir el _script de analytics_ en el `index.html` y ajustes de retro-compatibilidad en el fichero `polyfills.ts`. Luego un comando y listo para publicar en _github pages_.\n\n> Te recomiendo que te familiarices y uses mucho estos _scripts_ en el `package.json` para poder lanzarlos ms tarde.\n\n```json\n{\n  \"scripts\": {\n    \"build:prod\": \"ng build --prod\",\n    \"build:pub\": \"ng build --prod --output-path docs --base-href https://academiabinaria.github.io/angular-board/\",\n    \"e2e\": \"ng e2e\",\n    \"http-server\": \"http-server ./dist/angular-board/ -c-1 -p4271 -a localhost -o\",\n    \"lint\": \"ng lint\",\n    \"ng\": \"ng\",\n    \"pub\": \"npm run build:pub && npm run push\",\n    \"push\": \"git add * && git commit -m 'pub' && git push\",\n    \"start:prod\": \"npm run build:prod && npm run http-server\",\n    \"start\": \"ng serve --aot -o --port 4270\",\n    \"test\": \"ng test\"\n  }\n}\n```\n\nComprueba las ejecuciones de los distintos _scripts_. Con `npm start` no se generan ficheros fsicos. Todos es en memoria para mayor velocidad de re-compilacin mientras desarrollas. En cambio `npm run build:prod` crear una carpeta `./dist/angular-board` en la que dejar los archivos necesarios para ejecucin. Por ltimo `npm run pub` los prepara para enviar compilados a la carpeta estndar `./docs` listos para publicarse en las _github pages_.\n\nOtros enlaces de inters sobre el ecosistema Angular.\n\n- [Extensiones Esenciales](https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials)\n- [Prettier](https://prettier.io/)\n- [Angular Console](https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console)\n- [Angular Material](https://material.angular.io/)\n- [Bootstrap](https://ng-bootstrap.github.io/#/home)\n- [Augury](https://augury.rangle.io/)\n- [Apollo GraphQL](https://www.apollographql.com/docs/)\n- [Ionic](https://ionicframework.com/)\n- [Angular Console](https://angularconsole.com/)\n\nPara complementar tu conocimiento te recomiendo la [documentacin de Angular/CLI](https://angular.io/cli) y este artculo avanzado que trata la configuracin del CLI en profundidad [Angular CLI under the hood](https://medium.com/dailyjs/angular-cli-6-under-the-hood-builders-demystified-f0690ebcf01)\n\nEsto es slo el principio, _Angular CLI 7_ puede hacer mucho ms por ti; descbrelo en esta serie tutorial para aprender a programar con Angular 7. En el prximo artculo crearemos una [Base para una aplicacin Angular](../base-aplicacion-angular/).\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"hola-angular-cli","published":1,"updated":"2019-02-12T16:24:32.016Z","_id":"cjbrwpvji0027iwd3esyp8axx","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-0_cli.png\" alt=\"hola-angular-cli\"></p><p><strong>Angular en su versin 7 es la plataforma perfecta para el desarrollo</strong> profesional de aplicaciones modernas. <strong>El Angular CLI es la herramienta</strong> adecuada para generar aplicaciones Angular. Juntos son imbatibles en cuanto a velocidad en desarrollo y a potencia en ejecucin.</p><a id=\"more\"></a><p>El comnmente conocido como <strong>AngularCLI</strong> o <em>angular cli</em> o <em>angular-cli</em> o _ CLI a secas_ es la herramienta de lnea de comandos estndar para <strong>crear, depurar y publicar aplicaciones Angular</strong>. En su actual <strong>versin 7</strong> es ms potente y verstil que nunca y es muy sencillo dominar los aspectos bsicos.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/0-hello</a></p></blockquote><h1 id=\"1-Instalacion-de-Angular-CLI-7\"><a href=\"#1-Instalacion-de-Angular-CLI-7\" class=\"headerlink\" title=\"1. Instalacin de Angular CLI 7\"></a>1. Instalacin de Angular CLI 7</h1><p>Angular es una plataforma de desarrollo dogmtica y llave en mano. Para empezar, como en casi cualquier desarrollo <strong>necesitars <a href=\"https://nodejs.org/en/\" target=\"_blank\" rel=\"noopener\">NodeJS</a> y su manejador de de paquetes <em>npm</em></strong>. Tenerlos actualizados es un mandamiento bsico para un desarrollador web. Comprueba tu versin con el siguiente comando:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br></pre></td></tr></table></figure><p>Empieza con una <strong>instalacin global</strong> que te permita usar la herramienta desde cualquier directorio. Comprueba la versin instalada y accede a la ayuda en lnea. La ayuda est disponible tanto de modo general como para cada comando que vayas a usar.</p><p>Instrucciones para instalar Angular CLI.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> npm i -g @angular/cli@latest</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng version</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng <span class=\"built_in\">help</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng new --<span class=\"built_in\">help</span></span></span><br></pre></td></tr></table></figure><h1 id=\"2-Crear-y-ejecutar-una-aplicacion-Angular-7\"><a href=\"#2-Crear-y-ejecutar-una-aplicacion-Angular-7\" class=\"headerlink\" title=\"2. Crear y ejecutar una aplicacin Angular 7\"></a>2. Crear y ejecutar una aplicacin Angular 7</h1><p>Una vez que hayas instalado el CLI de manera global ya puedes empezar a usarlo en tu directorio de trabajo. El primer comando ser <code>ng new</code> que te va a <strong>generar toda una aplicacin funcional</strong> y las configuraciones necesarias para su depuracin, pruebas y ejecucin.</p><p>Como novedad, en las ltimas versiones, el CLI te preguntar por algunas opciones para crear tu aplicacin. Eso es porque no todos los desarrollos son iguales. Se puede configurar el tipo, el estilo y muchas ms cosas, tanto de forma interactiva como mediante opciones en lnea de comandos.</p><p>Lo ms habitual es usar la configuracin que viene por defecto, pero tambin se pueden crear soluciones a medida. Te muestro unos ejemplos para que pruebes y te familiarices con la herramienta. Para ms informacin mira la documentacin del comando <a href=\"https://angular.io/cli/new\" target=\"_blank\" rel=\"noopener\">ng new</a>.</p><h2 id=\"2-1-Normal\"><a href=\"#2-1-Normal\" class=\"headerlink\" title=\"2.1 Normal\"></a>2.1 Normal</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new normal</span><br><span class=\"line\">cd normal</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Minimalista\"><a href=\"#2-2-Minimalista\" class=\"headerlink\" title=\"2.2 Minimalista\"></a>2.2 Minimalista</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new minimalista -s -S -t</span><br><span class=\"line\">cd minimalista</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Profesional\"><a href=\"#2-3-Profesional\" class=\"headerlink\" title=\"2.3 Profesional\"></a>2.3 Profesional</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new profesional -p acme --routing true</span><br><span class=\"line\">cd profesional</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-4-Empresarial\"><a href=\"#2-4-Empresarial\" class=\"headerlink\" title=\"2.4 Empresarial\"></a>2.4 Empresarial</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new empresarial --create-application false</span><br><span class=\"line\">cd empresarial</span><br><span class=\"line\">ng generate application compras -p acme --routing true</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><p>Una vez finalizada la instalacin de todas las libreras necesarias puedes bajar a la carpeta recin creada y ejecutar el comando standard de <em>npm</em> para el arranque de cualquier aplicacin: <code>npm start</code>. Si todo va bien, en unos segundo podrs visitar <a href=\"http://localhost:4000\" target=\"_blank\" rel=\"noopener\">http://localhost:4000</a> para ver en marcha la aplicacin. Lo veremos con ms detalle en el apartado de configuracin.</p><blockquote><p>ejemplo: La aplicacin que sirve de ejemplo a este tutorial fue creada con este comando:</p></blockquote><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new angular-board --routing true -s -S</span><br></pre></td></tr></table></figure><h1 id=\"3-Estructura-de-una-aplicacion-Angular\"><a href=\"#3-Estructura-de-una-aplicacion-Angular\" class=\"headerlink\" title=\"3. Estructura de una aplicacin Angular\"></a>3. Estructura de una aplicacin Angular</h1><p>Una vez generada y comprobada la ejecucin, toca estudiar cmo es la estructura de la aplicacin. Para ello revisa carpeta a carpeta. Las malas noticias son que hay <strong>una enorme cantidad de ficheros y carpetas</strong>, las buenas son que como vers, casi todo es <strong>configuracin e infraestructura</strong>.</p><h2 id=\"3-1-Visual-Studio-Code\"><a href=\"#3-1-Visual-Studio-Code\" class=\"headerlink\" title=\"3.1 Visual Studio Code\"></a>3.1 Visual Studio Code</h2><p>Para ver y editar los ficheros te vale cualquier editor de cdigo, pero yo uso y te recomiendo <a href=\"https://code.visualstudio.com/\" target=\"_blank\" rel=\"noopener\">VSCode</a>. Es un <strong>gran editor, gratuito y multiplataforma</strong>. Viene con un terminal integrado y puedes mejorarlo instalando extensiones desde una galera del propio editor.</p><p>Te recomiendo instalar un paquete de extensiones ya configurado y preparado para el desarrollo de aplicaciones con <em>Angular</em>, se llama <a href=\"https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials\" target=\"_blank\" rel=\"noopener\">Angular Essentials</a>. Con eso y el <a href=\"https://marketplace.visualstudio.com/items?itemName=PKief.material-icon-theme\" target=\"_blank\" rel=\"noopener\">Material Icon Theme</a> vers <em>Angular en colores</em>.</p><h2 id=\"3-2-Carpetas-y-Ficheros-principales\"><a href=\"#3-2-Carpetas-y-Ficheros-principales\" class=\"headerlink\" title=\"3.2 Carpetas y Ficheros principales\"></a>3.2 Carpetas y Ficheros principales</h2><p>Volviendo a la <strong>estructura de ficheros y carpetas</strong> te encontrars con muchos archivos de distintos tipos. Si eres completamente nuevo en Angular, te llamar la atencin las extensiones <code>.ts</code>. Son para ficheros <a href=\"https://www.typescriptlang.org/\" target=\"_blank\" rel=\"noopener\"><em>TypeScript</em></a>, una evolucin del <em>JavaScript</em> con facilidades para el programador. Por ahora slo tienes que familiarizarte con estos:</p><ul><li><strong>angular.json</strong> <em>: configuracin del propio CLI. La madre de todos los configuradores</em></li><li><strong>package.json</strong> <em>: dependencias de libreras y scripts</em></li><li><strong>src/</strong> <em>: la carpeta donde estn los archivos fuentes</em><ul><li><strong>index.html</strong> <em>: un fichero HTML ndice estndar</em></li><li><strong>main.ts</strong> <em>: fichero TypeScript de arranque de la aplicacin</em></li><li><strong>app/</strong> <em>: la carpeta con el cdigo especfico de tu aplicacin</em><ul><li><strong>app.module.ts</strong> <em>: la aplicacin es un rbol de mdulos, y este es su raz</em></li><li><strong>app.component.ts</strong> <em>: la pgina es un rbol de componentes, y este es su raz</em></li><li><strong>app.component.html</strong> <em>: el componente tiene una parte visual, esta es su vista</em></li></ul></li></ul></li></ul><p>Echa un vistazo a estos ficheros, pronto los modificaremos para sentirnos programadores.</p><h1 id=\"4-Edicion\"><a href=\"#4-Edicion\" class=\"headerlink\" title=\"4. Edicin\"></a>4. Edicin</h1><p>Angular CLI instala y configura un conjunto de herramientas que te harn la vida ms fcil. Entre otras, destaca la capacidad de <strong>recargar la aplicacin en caliente</strong> en cuanto guardas tu trabajo como programador. En esta ltima versin, la 7, se ha mejorado el proceso y es realmente rpido.</p><p>Para probarlo slo tienes que dejar arrancada la aplicacin con el comando <code>npm start</code>; <strong>cambiar un fichero de cdigo y comprobar el resultado</strong> en el navegador. Te propongo empezar como en cualquier otro lenguaje; por el famoso <em>hola mundo</em>.</p><h2 id=\"4-1-Hola-Mundo\"><a href=\"#4-1-Hola-Mundo\" class=\"headerlink\" title=\"4.1 Hola Mundo\"></a>4.1 Hola Mundo</h2><p>Abre el fichero <code>app.component.ts</code> y busca dentro de l una clase llamada <code>AppComponent</code>. Encontrars que tiene una propiedad <code>title</code>. Asgnale el saludo de rigor: <code>title = &#39;actibot: hello world ;-)&#39;;</code>. Guarda y comprueba cmo tu navegador <strong>se habr actualizado automticamente</strong>.</p><p>Toda <strong>esta magia depende de una cadena de comandos</strong> que lanzan distintas herramientas previamente instaladas y configuradas por el CLI. Entre ellas cabe mencionar a <a href=\"https://webpack.github.io/\" target=\"_blank\" rel=\"noopener\"><em>WebPack</em></a>, un coloso que afortunadamente viene instalado y preparado para funcionar de manera transparente.</p><h2 id=\"4-2-npm-start\"><a href=\"#4-2-npm-start\" class=\"headerlink\" title=\"4.2 npm start\"></a>4.2 npm start</h2><p>Esta es una lista no exhaustiva de lo que sucede.</p><ol><li>npm start</li><li>ng serve</li><li>webpack server en <a href=\"http://localhost:4270\" target=\"_blank\" rel=\"noopener\">http://localhost:4270</a><ol><li>vigilancia de cambios sobre la carpeta src/</li><li>live reload</li><li>compilado de la aplicacin</li><li>recarga del navegador</li></ol></li></ol><p>Cambia a tu antojo el <code>app.component.ts</code> o su hermano <code>app.component.html</code> y comprueba los cambios de manera inmediata en tu navegador.</p><h1 id=\"5-Configuracion\"><a href=\"#5-Configuracion\" class=\"headerlink\" title=\"5. Configuracin\"></a>5. Configuracin</h1><p>El CLI 7 viene con pilas incluidas, se puede usar desde el primer momento. Slo quedan pequeas mejoras que hacer. Por ejemplo ajustar el <code>package.json</code> y agregar libreras de terceros.</p><h2 id=\"5-1-Package-json\"><a href=\"#5-1-Package-json\" class=\"headerlink\" title=\"5.1 Package.json\"></a>5.1 Package.json</h2><p>El <code>package.json</code> es el fichero estndar de <em>npm</em> donde se almacenan las <strong>dependencias de terceros</strong>. Contiene las libreras que necesita la aplicacin para ejecutarse, por ejemplo todas las de <em>Angular 7</em>. Y tambin las herramientas que necesita el programador, por ejemplo el propio <em>AngularCLI</em>;</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"dependencies\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"@angular/core\"</span>: <span class=\"string\">\"^7.2.0\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"devDependencies\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"@angular/cli\"</span>: <span class=\"string\">\"7.2.0\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Otro uso del <code>package.json</code> es servir de <strong>contenedor de scripts</strong> para automatizar tareas de operaciones rutinarias. Por ejemplo, el comando estndar <code>npm start</code> ejecutar el contenido asignado en el fichero <em>json</em>, originalmente <code>ng serve</code>. Esto lanza el servidor de pruebas con sus opciones por defecto.</p><p>Pero el <strong>comando <a href=\"https://angular.io/cli/serve\" target=\"_blank\" rel=\"noopener\">ng serve</a></strong> admite muchas configuraciones. Te propongo que uses esta para activar un modo de compilacin ms rpido y seguro, y para que se abra el navegador de forma automtica en cuanto lances el servidor. Y adems te recomiendo que uses un puerto especfico para cada aplicacin.</p><p>Otras configuraciones en produccin</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"start\"</span>: <span class=\"string\">\"ng serve --aot -o --port 4270\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"5-2-Estilos-y-librerias-de-terceros\"><a href=\"#5-2-Estilos-y-librerias-de-terceros\" class=\"headerlink\" title=\"5.2 Estilos y libreras de terceros\"></a>5.2 Estilos y libreras de terceros</h2><p>Las libreras que vienen de fbrica tienen todo lo necesario para crear aplicaciones. Pero raro es el caso en que no necesitemos <strong>algn que otro producto de terceros</strong>. Ya sean utilidades como <em><a href=\"https://date-fns.org/\" target=\"_blank\" rel=\"noopener\">date-fns</a></em>, libreras grficas como <em><a href=\"http://www.chartjs.org/\" target=\"_blank\" rel=\"noopener\">chart.js</a></em> o la aplicacin de estilos y componentes visuales de <em>frameworks como Bootstrap o MaterialDesign</em>. Pero todos se instalan de igual forma. Descargndolos con <em>npm</em> y adjuntndolos en el <code>angular.json</code>.</p><blockquote><p>En este tutorial te propongo usar una hoja de estilos muy simple que mejora la apariencia de cualquier aplicacin sin necesidad de usar clases propias. Se llama <em><a href=\"https://minicss.org/\" target=\"_blank\" rel=\"noopener\">MiniCSS</a></em> y es apropiada para prototipos, pruebas o pequeos proyectos.</p></blockquote><p>Se descargan e instalan de manera estndar.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install mini.css --save</span><br></pre></td></tr></table></figure><p>Para que se incluyan en la distribucin hay que ir a la configuracin del <em>CLI</em>. Entonces se agrega dentro del fichero <code>.angular.json</code> a la coleccin de <em>styles</em> o de <em>scripts</em> que corresponda.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"styles\"</span>: [<span class=\"string\">\"src/styles.css\"</span>, <span class=\"string\">\"./node_modules/mini.css/dist/mini-default.min.css\"</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Estas colecciones de archivos los usa el <em>cli</em> a travs de <em>webpack</em> para incluirlos <strong>minificados y concatenados en un fichero <em>bundle</em> sustituyendo a las clsicas etiquetas html</strong>.Todo, el html y sus estilos, se construir en el cliente a partir de instrucciones JavaScript. De esta forma el fichero <code>index.html</code> apenas tendrs que tocarlo, salvo para algunas etiquetas de meta informacin.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"description\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"A sample project for learning Angular ;-)\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"keywords\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"Angular Sample Tutorial Ejemplo\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"author\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"Alberto Basalo\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>Una cosa ms, los cambios en los ficheros de configuracin no se auto recargan. Tienes que parar la servidor y volver a lanzarlo para apreciar el estilo <em>MiniCSS</em>.</p><h2 id=\"5-3-Environments\"><a href=\"#5-3-Environments\" class=\"headerlink\" title=\"5.3 Environments\"></a>5.3 Environments</h2><p>La carpeta <code>environments/</code> contiene dos ficheros, y puede contener ms, para cada entorno de distribucin necesario. En cdigo siempre importaremos el fichero base, pero durante la compilacin el CLI lo sustituir por el adecuado.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title = environment.appName + <span class=\"string\">'hello world ;-)'</span>;</span><br></pre></td></tr></table></figure><h2 id=\"5-4-Assets\"><a href=\"#5-4-Assets\" class=\"headerlink\" title=\"5.4 Assets\"></a>5.4 Assets</h2><p>Los ficheros de la carpeta <code>assets/</code> se copian tal cual al despliegue. Es un buen lugar para logos, imgenes y ficheros de datos estticos.</p><p>Por ejemplo, en el <code>app.component.html</code> he sustituido la imagen incrustada del Angular con un logo propio.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">width</span>=<span class=\"string\">\"100\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./assets/logo.png\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"6-Angular-7-el-CLI-7-y-su-ecosistema\"><a href=\"#6-Angular-7-el-CLI-7-y-su-ecosistema\" class=\"headerlink\" title=\"6. Angular 7, el CLI 7 y su ecosistema\"></a>6. Angular 7, el CLI 7 y su ecosistema</h1><p>Algunos consejos y herramientas tiles que rodean al mundo Angular.</p><p>Pero si la lnea de comandos te suena muy antigua y lo tuyo son las interfaces grficas, ests de suerte. El reciente proyecto <a href=\"https://angularconsole.com/\" target=\"_blank\" rel=\"noopener\">Angular Console</a> te permite generar y ejecutar comandos desde una cmoda interfaz grfica.</p><p>Una mejora digna de mencin es la capacidad de presupuestar tamaos de los ficheros generados. De esa forma podemos controlar el peso y tiempo de descarga de la aplicacin.</p><p>Para garantizar la limpieza del cdigo conviene usar herramientas como <a href=\"https://prettier.io/\" target=\"_blank\" rel=\"noopener\">Prettier</a> y configurarlas para su compatibilidad con Angular.</p><p>Los ltimos toques antes de publicar pueden incluir el <em>script de analytics</em> en el <code>index.html</code> y ajustes de retro-compatibilidad en el fichero <code>polyfills.ts</code>. Luego un comando y listo para publicar en <em>github pages</em>.</p><blockquote><p>Te recomiendo que te familiarices y uses mucho estos <em>scripts</em> en el <code>package.json</code> para poder lanzarlos ms tarde.</p></blockquote><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"scripts\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"build:prod\"</span>: <span class=\"string\">\"ng build --prod\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"build:pub\"</span>: <span class=\"string\">\"ng build --prod --output-path docs --base-href https://academiabinaria.github.io/angular-board/\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"e2e\"</span>: <span class=\"string\">\"ng e2e\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"http-server\"</span>: <span class=\"string\">\"http-server ./dist/angular-board/ -c-1 -p4271 -a localhost -o\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"lint\"</span>: <span class=\"string\">\"ng lint\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"ng\"</span>: <span class=\"string\">\"ng\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"pub\"</span>: <span class=\"string\">\"npm run build:pub &amp;&amp; npm run push\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"push\"</span>: <span class=\"string\">\"git add * &amp;&amp; git commit -m 'pub' &amp;&amp; git push\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"start:prod\"</span>: <span class=\"string\">\"npm run build:prod &amp;&amp; npm run http-server\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"start\"</span>: <span class=\"string\">\"ng serve --aot -o --port 4270\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"test\"</span>: <span class=\"string\">\"ng test\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Comprueba las ejecuciones de los distintos <em>scripts</em>. Con <code>npm start</code> no se generan ficheros fsicos. Todos es en memoria para mayor velocidad de re-compilacin mientras desarrollas. En cambio <code>npm run build:prod</code> crear una carpeta <code>./dist/angular-board</code> en la que dejar los archivos necesarios para ejecucin. Por ltimo <code>npm run pub</code> los prepara para enviar compilados a la carpeta estndar <code>./docs</code> listos para publicarse en las <em>github pages</em>.</p><p>Otros enlaces de inters sobre el ecosistema Angular.</p><ul><li><a href=\"https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials\" target=\"_blank\" rel=\"noopener\">Extensiones Esenciales</a></li><li><a href=\"https://prettier.io/\" target=\"_blank\" rel=\"noopener\">Prettier</a></li><li><a href=\"https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console\" target=\"_blank\" rel=\"noopener\">Angular Console</a></li><li><a href=\"https://material.angular.io/\" target=\"_blank\" rel=\"noopener\">Angular Material</a></li><li><a href=\"https://ng-bootstrap.github.io/#/home\" target=\"_blank\" rel=\"noopener\">Bootstrap</a></li><li><a href=\"https://augury.rangle.io/\" target=\"_blank\" rel=\"noopener\">Augury</a></li><li><a href=\"https://www.apollographql.com/docs/\" target=\"_blank\" rel=\"noopener\">Apollo GraphQL</a></li><li><a href=\"https://ionicframework.com/\" target=\"_blank\" rel=\"noopener\">Ionic</a></li><li><a href=\"https://angularconsole.com/\" target=\"_blank\" rel=\"noopener\">Angular Console</a></li></ul><p>Para complementar tu conocimiento te recomiendo la <a href=\"https://angular.io/cli\" target=\"_blank\" rel=\"noopener\">documentacin de Angular/CLI</a> y este artculo avanzado que trata la configuracin del CLI en profundidad <a href=\"https://medium.com/dailyjs/angular-cli-6-under-the-hood-builders-demystified-f0690ebcf01\" target=\"_blank\" rel=\"noopener\">Angular CLI under the hood</a></p><p>Esto es slo el principio, <em>Angular CLI 7</em> puede hacer mucho ms por ti; descbrelo en esta serie tutorial para aprender a programar con Angular 7. En el prximo artculo crearemos una <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a>.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-0_cli.png\" alt=\"hola-angular-cli\"></p><p><strong>Angular en su versin 7 es la plataforma perfecta para el desarrollo</strong> profesional de aplicaciones modernas. <strong>El Angular CLI es la herramienta</strong> adecuada para generar aplicaciones Angular. Juntos son imbatibles en cuanto a velocidad en desarrollo y a potencia en ejecucin.</p>","more":"<p>El comnmente conocido como <strong>AngularCLI</strong> o <em>angular cli</em> o <em>angular-cli</em> o _ CLI a secas_ es la herramienta de lnea de comandos estndar para <strong>crear, depurar y publicar aplicaciones Angular</strong>. En su actual <strong>versin 7</strong> es ms potente y verstil que nunca y es muy sencillo dominar los aspectos bsicos.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/0-hello</a></p></blockquote><h1 id=\"1-Instalacion-de-Angular-CLI-7\"><a href=\"#1-Instalacion-de-Angular-CLI-7\" class=\"headerlink\" title=\"1. Instalacin de Angular CLI 7\"></a>1. Instalacin de Angular CLI 7</h1><p>Angular es una plataforma de desarrollo dogmtica y llave en mano. Para empezar, como en casi cualquier desarrollo <strong>necesitars <a href=\"https://nodejs.org/en/\" target=\"_blank\" rel=\"noopener\">NodeJS</a> y su manejador de de paquetes <em>npm</em></strong>. Tenerlos actualizados es un mandamiento bsico para un desarrollador web. Comprueba tu versin con el siguiente comando:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br></pre></td></tr></table></figure><p>Empieza con una <strong>instalacin global</strong> que te permita usar la herramienta desde cualquier directorio. Comprueba la versin instalada y accede a la ayuda en lnea. La ayuda est disponible tanto de modo general como para cada comando que vayas a usar.</p><p>Instrucciones para instalar Angular CLI.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> npm i -g @angular/cli@latest</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng version</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng <span class=\"built_in\">help</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ng new --<span class=\"built_in\">help</span></span></span><br></pre></td></tr></table></figure><h1 id=\"2-Crear-y-ejecutar-una-aplicacion-Angular-7\"><a href=\"#2-Crear-y-ejecutar-una-aplicacion-Angular-7\" class=\"headerlink\" title=\"2. Crear y ejecutar una aplicacin Angular 7\"></a>2. Crear y ejecutar una aplicacin Angular 7</h1><p>Una vez que hayas instalado el CLI de manera global ya puedes empezar a usarlo en tu directorio de trabajo. El primer comando ser <code>ng new</code> que te va a <strong>generar toda una aplicacin funcional</strong> y las configuraciones necesarias para su depuracin, pruebas y ejecucin.</p><p>Como novedad, en las ltimas versiones, el CLI te preguntar por algunas opciones para crear tu aplicacin. Eso es porque no todos los desarrollos son iguales. Se puede configurar el tipo, el estilo y muchas ms cosas, tanto de forma interactiva como mediante opciones en lnea de comandos.</p><p>Lo ms habitual es usar la configuracin que viene por defecto, pero tambin se pueden crear soluciones a medida. Te muestro unos ejemplos para que pruebes y te familiarices con la herramienta. Para ms informacin mira la documentacin del comando <a href=\"https://angular.io/cli/new\" target=\"_blank\" rel=\"noopener\">ng new</a>.</p><h2 id=\"2-1-Normal\"><a href=\"#2-1-Normal\" class=\"headerlink\" title=\"2.1 Normal\"></a>2.1 Normal</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new normal</span><br><span class=\"line\">cd normal</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Minimalista\"><a href=\"#2-2-Minimalista\" class=\"headerlink\" title=\"2.2 Minimalista\"></a>2.2 Minimalista</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new minimalista -s -S -t</span><br><span class=\"line\">cd minimalista</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Profesional\"><a href=\"#2-3-Profesional\" class=\"headerlink\" title=\"2.3 Profesional\"></a>2.3 Profesional</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new profesional -p acme --routing true</span><br><span class=\"line\">cd profesional</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><h2 id=\"2-4-Empresarial\"><a href=\"#2-4-Empresarial\" class=\"headerlink\" title=\"2.4 Empresarial\"></a>2.4 Empresarial</h2><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new empresarial --create-application false</span><br><span class=\"line\">cd empresarial</span><br><span class=\"line\">ng generate application compras -p acme --routing true</span><br><span class=\"line\">npm start</span><br></pre></td></tr></table></figure><p>Una vez finalizada la instalacin de todas las libreras necesarias puedes bajar a la carpeta recin creada y ejecutar el comando standard de <em>npm</em> para el arranque de cualquier aplicacin: <code>npm start</code>. Si todo va bien, en unos segundo podrs visitar <a href=\"http://localhost:4000\" target=\"_blank\" rel=\"noopener\">http://localhost:4000</a> para ver en marcha la aplicacin. Lo veremos con ms detalle en el apartado de configuracin.</p><blockquote><p>ejemplo: La aplicacin que sirve de ejemplo a este tutorial fue creada con este comando:</p></blockquote><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng new angular-board --routing true -s -S</span><br></pre></td></tr></table></figure><h1 id=\"3-Estructura-de-una-aplicacion-Angular\"><a href=\"#3-Estructura-de-una-aplicacion-Angular\" class=\"headerlink\" title=\"3. Estructura de una aplicacin Angular\"></a>3. Estructura de una aplicacin Angular</h1><p>Una vez generada y comprobada la ejecucin, toca estudiar cmo es la estructura de la aplicacin. Para ello revisa carpeta a carpeta. Las malas noticias son que hay <strong>una enorme cantidad de ficheros y carpetas</strong>, las buenas son que como vers, casi todo es <strong>configuracin e infraestructura</strong>.</p><h2 id=\"3-1-Visual-Studio-Code\"><a href=\"#3-1-Visual-Studio-Code\" class=\"headerlink\" title=\"3.1 Visual Studio Code\"></a>3.1 Visual Studio Code</h2><p>Para ver y editar los ficheros te vale cualquier editor de cdigo, pero yo uso y te recomiendo <a href=\"https://code.visualstudio.com/\" target=\"_blank\" rel=\"noopener\">VSCode</a>. Es un <strong>gran editor, gratuito y multiplataforma</strong>. Viene con un terminal integrado y puedes mejorarlo instalando extensiones desde una galera del propio editor.</p><p>Te recomiendo instalar un paquete de extensiones ya configurado y preparado para el desarrollo de aplicaciones con <em>Angular</em>, se llama <a href=\"https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials\" target=\"_blank\" rel=\"noopener\">Angular Essentials</a>. Con eso y el <a href=\"https://marketplace.visualstudio.com/items?itemName=PKief.material-icon-theme\" target=\"_blank\" rel=\"noopener\">Material Icon Theme</a> vers <em>Angular en colores</em>.</p><h2 id=\"3-2-Carpetas-y-Ficheros-principales\"><a href=\"#3-2-Carpetas-y-Ficheros-principales\" class=\"headerlink\" title=\"3.2 Carpetas y Ficheros principales\"></a>3.2 Carpetas y Ficheros principales</h2><p>Volviendo a la <strong>estructura de ficheros y carpetas</strong> te encontrars con muchos archivos de distintos tipos. Si eres completamente nuevo en Angular, te llamar la atencin las extensiones <code>.ts</code>. Son para ficheros <a href=\"https://www.typescriptlang.org/\" target=\"_blank\" rel=\"noopener\"><em>TypeScript</em></a>, una evolucin del <em>JavaScript</em> con facilidades para el programador. Por ahora slo tienes que familiarizarte con estos:</p><ul><li><strong>angular.json</strong> <em>: configuracin del propio CLI. La madre de todos los configuradores</em></li><li><strong>package.json</strong> <em>: dependencias de libreras y scripts</em></li><li><strong>src/</strong> <em>: la carpeta donde estn los archivos fuentes</em><ul><li><strong>index.html</strong> <em>: un fichero HTML ndice estndar</em></li><li><strong>main.ts</strong> <em>: fichero TypeScript de arranque de la aplicacin</em></li><li><strong>app/</strong> <em>: la carpeta con el cdigo especfico de tu aplicacin</em><ul><li><strong>app.module.ts</strong> <em>: la aplicacin es un rbol de mdulos, y este es su raz</em></li><li><strong>app.component.ts</strong> <em>: la pgina es un rbol de componentes, y este es su raz</em></li><li><strong>app.component.html</strong> <em>: el componente tiene una parte visual, esta es su vista</em></li></ul></li></ul></li></ul><p>Echa un vistazo a estos ficheros, pronto los modificaremos para sentirnos programadores.</p><h1 id=\"4-Edicion\"><a href=\"#4-Edicion\" class=\"headerlink\" title=\"4. Edicin\"></a>4. Edicin</h1><p>Angular CLI instala y configura un conjunto de herramientas que te harn la vida ms fcil. Entre otras, destaca la capacidad de <strong>recargar la aplicacin en caliente</strong> en cuanto guardas tu trabajo como programador. En esta ltima versin, la 7, se ha mejorado el proceso y es realmente rpido.</p><p>Para probarlo slo tienes que dejar arrancada la aplicacin con el comando <code>npm start</code>; <strong>cambiar un fichero de cdigo y comprobar el resultado</strong> en el navegador. Te propongo empezar como en cualquier otro lenguaje; por el famoso <em>hola mundo</em>.</p><h2 id=\"4-1-Hola-Mundo\"><a href=\"#4-1-Hola-Mundo\" class=\"headerlink\" title=\"4.1 Hola Mundo\"></a>4.1 Hola Mundo</h2><p>Abre el fichero <code>app.component.ts</code> y busca dentro de l una clase llamada <code>AppComponent</code>. Encontrars que tiene una propiedad <code>title</code>. Asgnale el saludo de rigor: <code>title = &#39;actibot: hello world ;-)&#39;;</code>. Guarda y comprueba cmo tu navegador <strong>se habr actualizado automticamente</strong>.</p><p>Toda <strong>esta magia depende de una cadena de comandos</strong> que lanzan distintas herramientas previamente instaladas y configuradas por el CLI. Entre ellas cabe mencionar a <a href=\"https://webpack.github.io/\" target=\"_blank\" rel=\"noopener\"><em>WebPack</em></a>, un coloso que afortunadamente viene instalado y preparado para funcionar de manera transparente.</p><h2 id=\"4-2-npm-start\"><a href=\"#4-2-npm-start\" class=\"headerlink\" title=\"4.2 npm start\"></a>4.2 npm start</h2><p>Esta es una lista no exhaustiva de lo que sucede.</p><ol><li>npm start</li><li>ng serve</li><li>webpack server en <a href=\"http://localhost:4270\" target=\"_blank\" rel=\"noopener\">http://localhost:4270</a><ol><li>vigilancia de cambios sobre la carpeta src/</li><li>live reload</li><li>compilado de la aplicacin</li><li>recarga del navegador</li></ol></li></ol><p>Cambia a tu antojo el <code>app.component.ts</code> o su hermano <code>app.component.html</code> y comprueba los cambios de manera inmediata en tu navegador.</p><h1 id=\"5-Configuracion\"><a href=\"#5-Configuracion\" class=\"headerlink\" title=\"5. Configuracin\"></a>5. Configuracin</h1><p>El CLI 7 viene con pilas incluidas, se puede usar desde el primer momento. Slo quedan pequeas mejoras que hacer. Por ejemplo ajustar el <code>package.json</code> y agregar libreras de terceros.</p><h2 id=\"5-1-Package-json\"><a href=\"#5-1-Package-json\" class=\"headerlink\" title=\"5.1 Package.json\"></a>5.1 Package.json</h2><p>El <code>package.json</code> es el fichero estndar de <em>npm</em> donde se almacenan las <strong>dependencias de terceros</strong>. Contiene las libreras que necesita la aplicacin para ejecutarse, por ejemplo todas las de <em>Angular 7</em>. Y tambin las herramientas que necesita el programador, por ejemplo el propio <em>AngularCLI</em>;</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"dependencies\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"@angular/core\"</span>: <span class=\"string\">\"^7.2.0\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"devDependencies\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"@angular/cli\"</span>: <span class=\"string\">\"7.2.0\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Otro uso del <code>package.json</code> es servir de <strong>contenedor de scripts</strong> para automatizar tareas de operaciones rutinarias. Por ejemplo, el comando estndar <code>npm start</code> ejecutar el contenido asignado en el fichero <em>json</em>, originalmente <code>ng serve</code>. Esto lanza el servidor de pruebas con sus opciones por defecto.</p><p>Pero el <strong>comando <a href=\"https://angular.io/cli/serve\" target=\"_blank\" rel=\"noopener\">ng serve</a></strong> admite muchas configuraciones. Te propongo que uses esta para activar un modo de compilacin ms rpido y seguro, y para que se abra el navegador de forma automtica en cuanto lances el servidor. Y adems te recomiendo que uses un puerto especfico para cada aplicacin.</p><p>Otras configuraciones en produccin</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"start\"</span>: <span class=\"string\">\"ng serve --aot -o --port 4270\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"5-2-Estilos-y-librerias-de-terceros\"><a href=\"#5-2-Estilos-y-librerias-de-terceros\" class=\"headerlink\" title=\"5.2 Estilos y libreras de terceros\"></a>5.2 Estilos y libreras de terceros</h2><p>Las libreras que vienen de fbrica tienen todo lo necesario para crear aplicaciones. Pero raro es el caso en que no necesitemos <strong>algn que otro producto de terceros</strong>. Ya sean utilidades como <em><a href=\"https://date-fns.org/\" target=\"_blank\" rel=\"noopener\">date-fns</a></em>, libreras grficas como <em><a href=\"http://www.chartjs.org/\" target=\"_blank\" rel=\"noopener\">chart.js</a></em> o la aplicacin de estilos y componentes visuales de <em>frameworks como Bootstrap o MaterialDesign</em>. Pero todos se instalan de igual forma. Descargndolos con <em>npm</em> y adjuntndolos en el <code>angular.json</code>.</p><blockquote><p>En este tutorial te propongo usar una hoja de estilos muy simple que mejora la apariencia de cualquier aplicacin sin necesidad de usar clases propias. Se llama <em><a href=\"https://minicss.org/\" target=\"_blank\" rel=\"noopener\">MiniCSS</a></em> y es apropiada para prototipos, pruebas o pequeos proyectos.</p></blockquote><p>Se descargan e instalan de manera estndar.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install mini.css --save</span><br></pre></td></tr></table></figure><p>Para que se incluyan en la distribucin hay que ir a la configuracin del <em>CLI</em>. Entonces se agrega dentro del fichero <code>.angular.json</code> a la coleccin de <em>styles</em> o de <em>scripts</em> que corresponda.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"styles\"</span>: [<span class=\"string\">\"src/styles.css\"</span>, <span class=\"string\">\"./node_modules/mini.css/dist/mini-default.min.css\"</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Estas colecciones de archivos los usa el <em>cli</em> a travs de <em>webpack</em> para incluirlos <strong>minificados y concatenados en un fichero <em>bundle</em> sustituyendo a las clsicas etiquetas html</strong>.Todo, el html y sus estilos, se construir en el cliente a partir de instrucciones JavaScript. De esta forma el fichero <code>index.html</code> apenas tendrs que tocarlo, salvo para algunas etiquetas de meta informacin.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"description\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"A sample project for learning Angular ;-)\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"keywords\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"Angular Sample Tutorial Ejemplo\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"author\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"Alberto Basalo\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>Una cosa ms, los cambios en los ficheros de configuracin no se auto recargan. Tienes que parar la servidor y volver a lanzarlo para apreciar el estilo <em>MiniCSS</em>.</p><h2 id=\"5-3-Environments\"><a href=\"#5-3-Environments\" class=\"headerlink\" title=\"5.3 Environments\"></a>5.3 Environments</h2><p>La carpeta <code>environments/</code> contiene dos ficheros, y puede contener ms, para cada entorno de distribucin necesario. En cdigo siempre importaremos el fichero base, pero durante la compilacin el CLI lo sustituir por el adecuado.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title = environment.appName + <span class=\"string\">'hello world ;-)'</span>;</span><br></pre></td></tr></table></figure><h2 id=\"5-4-Assets\"><a href=\"#5-4-Assets\" class=\"headerlink\" title=\"5.4 Assets\"></a>5.4 Assets</h2><p>Los ficheros de la carpeta <code>assets/</code> se copian tal cual al despliegue. Es un buen lugar para logos, imgenes y ficheros de datos estticos.</p><p>Por ejemplo, en el <code>app.component.html</code> he sustituido la imagen incrustada del Angular con un logo propio.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">width</span>=<span class=\"string\">\"100\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./assets/logo.png\"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"6-Angular-7-el-CLI-7-y-su-ecosistema\"><a href=\"#6-Angular-7-el-CLI-7-y-su-ecosistema\" class=\"headerlink\" title=\"6. Angular 7, el CLI 7 y su ecosistema\"></a>6. Angular 7, el CLI 7 y su ecosistema</h1><p>Algunos consejos y herramientas tiles que rodean al mundo Angular.</p><p>Pero si la lnea de comandos te suena muy antigua y lo tuyo son las interfaces grficas, ests de suerte. El reciente proyecto <a href=\"https://angularconsole.com/\" target=\"_blank\" rel=\"noopener\">Angular Console</a> te permite generar y ejecutar comandos desde una cmoda interfaz grfica.</p><p>Una mejora digna de mencin es la capacidad de presupuestar tamaos de los ficheros generados. De esa forma podemos controlar el peso y tiempo de descarga de la aplicacin.</p><p>Para garantizar la limpieza del cdigo conviene usar herramientas como <a href=\"https://prettier.io/\" target=\"_blank\" rel=\"noopener\">Prettier</a> y configurarlas para su compatibilidad con Angular.</p><p>Los ltimos toques antes de publicar pueden incluir el <em>script de analytics</em> en el <code>index.html</code> y ajustes de retro-compatibilidad en el fichero <code>polyfills.ts</code>. Luego un comando y listo para publicar en <em>github pages</em>.</p><blockquote><p>Te recomiendo que te familiarices y uses mucho estos <em>scripts</em> en el <code>package.json</code> para poder lanzarlos ms tarde.</p></blockquote><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"scripts\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"build:prod\"</span>: <span class=\"string\">\"ng build --prod\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"build:pub\"</span>: <span class=\"string\">\"ng build --prod --output-path docs --base-href https://academiabinaria.github.io/angular-board/\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"e2e\"</span>: <span class=\"string\">\"ng e2e\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"http-server\"</span>: <span class=\"string\">\"http-server ./dist/angular-board/ -c-1 -p4271 -a localhost -o\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"lint\"</span>: <span class=\"string\">\"ng lint\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"ng\"</span>: <span class=\"string\">\"ng\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"pub\"</span>: <span class=\"string\">\"npm run build:pub &amp;&amp; npm run push\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"push\"</span>: <span class=\"string\">\"git add * &amp;&amp; git commit -m 'pub' &amp;&amp; git push\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"start:prod\"</span>: <span class=\"string\">\"npm run build:prod &amp;&amp; npm run http-server\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"start\"</span>: <span class=\"string\">\"ng serve --aot -o --port 4270\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"test\"</span>: <span class=\"string\">\"ng test\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Comprueba las ejecuciones de los distintos <em>scripts</em>. Con <code>npm start</code> no se generan ficheros fsicos. Todos es en memoria para mayor velocidad de re-compilacin mientras desarrollas. En cambio <code>npm run build:prod</code> crear una carpeta <code>./dist/angular-board</code> en la que dejar los archivos necesarios para ejecucin. Por ltimo <code>npm run pub</code> los prepara para enviar compilados a la carpeta estndar <code>./docs</code> listos para publicarse en las <em>github pages</em>.</p><p>Otros enlaces de inters sobre el ecosistema Angular.</p><ul><li><a href=\"https://marketplace.visualstudio.com/items?itemName=johnpapa.angular-essentials\" target=\"_blank\" rel=\"noopener\">Extensiones Esenciales</a></li><li><a href=\"https://prettier.io/\" target=\"_blank\" rel=\"noopener\">Prettier</a></li><li><a href=\"https://marketplace.visualstudio.com/items?itemName=nrwl.angular-console\" target=\"_blank\" rel=\"noopener\">Angular Console</a></li><li><a href=\"https://material.angular.io/\" target=\"_blank\" rel=\"noopener\">Angular Material</a></li><li><a href=\"https://ng-bootstrap.github.io/#/home\" target=\"_blank\" rel=\"noopener\">Bootstrap</a></li><li><a href=\"https://augury.rangle.io/\" target=\"_blank\" rel=\"noopener\">Augury</a></li><li><a href=\"https://www.apollographql.com/docs/\" target=\"_blank\" rel=\"noopener\">Apollo GraphQL</a></li><li><a href=\"https://ionicframework.com/\" target=\"_blank\" rel=\"noopener\">Ionic</a></li><li><a href=\"https://angularconsole.com/\" target=\"_blank\" rel=\"noopener\">Angular Console</a></li></ul><p>Para complementar tu conocimiento te recomiendo la <a href=\"https://angular.io/cli\" target=\"_blank\" rel=\"noopener\">documentacin de Angular/CLI</a> y este artculo avanzado que trata la configuracin del CLI en profundidad <a href=\"https://medium.com/dailyjs/angular-cli-6-under-the-hood-builders-demystified-f0690ebcf01\" target=\"_blank\" rel=\"noopener\">Angular CLI under the hood</a></p><p>Esto es slo el principio, <em>Angular CLI 7</em> puede hacer mucho ms por ti; descbrelo en esta serie tutorial para aprender a programar con Angular 7. En el prximo artculo crearemos una <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a>.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Pginas y rutas Angular SPA","date":"2019-01-21T12:41:14.000Z","thumbnail":"/css/images/angular-2_spa.png","_content":"\n![paginas-y-rutas-angular-spa](/images/tutorial-angular-2_spa.png)\n\nLas **aplicaciones Angular 7 son conjuntos de pginas enrutadas** en el propio navegador. Son las conocidas _SPA, Single Page Applications_. Estas apps liberan al servidor de una parte del trabajo, reducen la cantidad de llamadas y mejoran la percepcin de velocidad del usuario.\n\nEn este tutorial aprenders a crear una Angular SPA fcilmente usando `@angular/router`, **el enrutador de Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Base para una aplicacin Angular](../base-aplicacion-angular/). Seguimos usando el concepto de rbol, ahora como analoga de **las rutas y las vistas** asociadas. Al finalizar tendrs una angular SPA con vistas asociadas a sus rutas.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/2-spa](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/2-spa)\n\n# 1. Rutas\n\nAl crear la aplicacin hice uso del flag `routing true` en el comando de generacin del _CLI_. Esto caus la aparicin de no uno, sino dos mdulos gemelos en la raz de la aplicacin. Has estudiado el `AppModule` verdadero mdulo raz, y ahora vers en profundidad a su gemelo: el **mdulo de enrutado** `AppRoutingModule` y el uso que hace del `RouterModule`.\n\n## 1.1 RouterModule\n\nEl _Angular Router_ necesita ser importado y configurado. El mdulo `AppRoutingModule` cumple dos funciones. Por un lado **importa al `RouterModule`** de Angular, el cual contiene toda la lgica necesaria para enrutar en el navegador. Por otro lado, permite la **definicin de rutas** en el array `Routes[]`.\n\n```typescript\nimport { Routes, RouterModule } from '@angular/router';\nconst routes: Routes = [\n  {\n    path: 'heroes',\n    component: HeroesComponent\n  },\n  {\n    path: 'not-found',\n    component: NotFoundComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'not-found'\n  }\n];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nEl array de rutas recibe **objetos ruta** con propiedades de configuracin.\n\nLa primera es `path:` en la que se especifica **la direccin** que resuelve, en este caso la ruta vaca o raz del rbol de rutas. Las otras son opcionales y las veremos poco a poco.\n\n### 1.1.1 Component\n\nVamos a crear un componente donde guardar el contenido que el CLI nos regala de inicio. Los enlaces a las pginas oficiales de Angular y al ejemplo del _Tour Of Heroes_. Para ello crear el componente HeroesComponent.\n\n```bash\nng g c heroes\n```\n\nLo hago en la carpeta raz; algo poco aconsejado si queremos tener una estructura escalable. Pero es un buen anti-ejemplo ;-)\n\nAhora debo decidir qu ruta asociarle... por ejemplo `/heroes`. Eso es lo que se ve en el inicio de la configuracin de rutas. Para no perderme lo ideal es tener un nuevo enlace de navegacin en el `HeaderComponent`\n\n```html\n<header class=\"sticky\">\n  <a routerLink=\"/\" class=\"logo\"> <span class=\"icon-home\"></span> <span>{{ title }}</span> </a>\n  <a routerLink=\"heroes\" routerLinkActive=\"router-link-active\" class=\"button\">\n    <span> Heroes</span>\n  </a>\n</header>\n```\n\nVayamos casi al final y de paso hagamos algo til para no volver a perdernos sin remedio. Un detector de rutas no contempladas, y una ruta a dnde redirigir a los usuarios perdidos. Para ello estudiaremos la propiedad `component` que es fundamental pues indica **el componente** que se debe mostrar cuando esta ruta se active.\n\nAs es cmo funciona el enrutado. Un camino y un componente asociado. La tabla de enrutado se procesa de arriba a abajo y cuando un camino coincide con la ruta actual, se para y se carga el componente.\n\nVamos a crear un componente con la intencin de mostrarlo slo cuando las dems ruta fallen. Se llamar _not found_ Lo creo asociado al `CoreModule` lo cual ayuda a organizar los elementos de la aplicacin.\n\n```bash\nng g c core/not-found\n```\n\nYa podemos asociar dicho componente al camino `not-found`. Pero esto es poca cosa. Hay mucho ms.\n\n### 1.1.2 RedirectTo\n\nLa configuracin de rutas no slo permite asignar componentes a las direcciones. Tambin se pueden hacer **redirecciones de unas direcciones a otras**. Y por supuesto puede haber **rutas no contempladas o errores** por parte del usuario, los infames `404 Not Found`.\n\n> En este caso cuando se escriba la ruta `/not-foud` se mostrar un componente, el `NotFoundComponent`, cuyo contenido indicar al usuario que se ha perdido. Claro que nadie va voluntariamente a esa ruta. Mediante el `path: '**'` le indico que ante cualquier ruta no contemplada anteriormente se ejecute el comando `redirectTo: 'not-found'`, el cual nos lleva a una ruta conocida con un mensaje bien conocido. _Page Not Found_.\n\nPero Cmo es eso de que se mostrar?, Dnde se cargar?. Presentamos a `<router-outlet>`.\n\n## 1.2 Router Outlet\n\nLa idea general de **una SPA es tener una nica pgina que cargue dinmicamente otras vistas**. Normalmente la pgina contenedora mantiene el men de navegacin, el pie de pgina y otras reas comunes. Y deja un espacio para la carga dinmica. Para ello necesitamos saber **qu componente cargar y dnde mostrarlo**. De esto ltimo se ocupa el _router outlet_ mediante la etiqueta `<router-outlet></router-outlet>`.\n\nEn el `main.component.ts` haba un contenido _hard-coded_. Para hacer que el contenido sea dinmico se sustituye por el elemento de Angular `<router-outlet></router-outlet>`. Este elemento del framework inyectar dinmicamente el componente que le corresponda segn la ruta activa. El `MainComponent` queda as:\n\n```html\n<main class=\"container\">\n  <router-outlet></router-outlet>\n  <!-- Dynamic content here! -->\n</main>\n```\n\n## 1.3 Router Link\n\nLos enlaces web tradicionalmente se han resuelto con elementos `<a href=\"\"></a>` dnde en su atributo `href` se asociaba la direccin a la cul navegar ante el click del usuario. **En Angular los enlaces se declaran con un atributo** especial llamado `routerLink`. Este atributo **se compila dando lugar al `href`** oportuno en tiempo de ejecucin.\n\nEn el fichero `not-found.component.ts` pon algo as:\n\n```html\n<h1>Not Found</h1>\n<h2>404</h2>\n<a routerLink=\"/\">Go home</a>\n```\n\n> Por ahora la funcionalidad de `routerLink` no mejora en nada a `href`. Pero lo har. Mientras tanto familiarzate con su sintaxis y... asegrate de importar `RouterModule` en los mdulos en los que lo vayas a usar.\n\nSalgamos de este bucle creando ms rutas y ms componentes. Pero esta vez con un nueva tcnica.\n\n# 2 Lazy Loading\n\nLa web clsica funcionaba con un navegador pidiendo una ruta al servidor. El servidor buscaba o montaba un documento html y se lo devolva al navegador para que lo renderizase. Una nueva ruta significaba repetir todo ese viaje. Hasta que aparecieron las [Single Page Applications](https://en.wikipedia.org/wiki/Single-page_application). En este caso el cdigo cliente es el responsable del contenido asociado a cada ruta. Y eso es mucha responsabilidad.\n\nLas _webs SPA_ se crearon por una razn que casi acaba con ellas: **la velocidad**. Al realizar el enrutado en el cliente y querer evitar todos los viajes posibles hasta el servidor, se carg a la nica pgina web con todo el peso de la aplicacin. Lo cual la hizo terriblemente lenta en la primera visita de cada usuario.\n\nEl **impacto de la primera visita** en una aplicacin de intranet no suele ser un problema grave. Pero en internet esa visita puede ser la primera y si tarda mucho, tambin ser la ltima. La solucin viene de mano del concepto de _lazy loading_ o carga perezosa. Consiste en diferir la carga de la lgica asociada a una direccin hasta el momento en que sea activada dicha ruta. De esa forma, **una pgina no visitada es una pgina que no pesa**. Y la carga inicial se hace mucho ms liviana.\n\nEn Angular el _lazy loading_ es tan sencillo que ya se recomienda implementarlo por defecto. Para hacerlo conoceremos ms comandos del `Router` y algunas herramientas de compilacin usadas por el _Angular CLI_.\n\n## 2.1 Webpack y los bundles por ruta\n\nHay que saber que el _Angular CLI_ usa internamente la herramienta de empaquetado _webpack_. La cual recorre el cdigo _TypeScript_ buscando `imports` y empaquetando su contenido en sacos o _bundles_. Luego introduce las referencias a esos _bundles_ en la seccin se _scripts_ del index.html, haciendo que se descarguen todos nada ms arrancar la aplicacin. Esto puede ser muy pesado en aplicaciones grandes. As que hay que buscar una manera de diferir esa descarga, repartiendo el _bundle_ principal en otros ms pequeos que se cargar bajo demanda.\n\nObjetivo: adelgazar el peso del _bundle_ principal, el `main.js`.Para conseguirlo hay que configurar las rutas de forma que no sea necesario importar los componentes a mostrar. Tal como se ha hecho con el `NotFoundComponent`, de hacerlo as con todos, _webpack_ empaquetara esos componentes como algo necesario... y por tanto seran enviados al navegador en el _bundle_ principal sin que sea seguro su uso. Ese no es el camino, es una excepcin para componentes poco pesados y muy utilizados.\n\nLa solucin que ofrecen el _cli_ y _webpack_ consiste en **delegar la asignacin del componente a otro mdulo, pero sin importarlo** hasta que su ruta principal se active.\n\nHe creado unas vistas para ser usadas en las direcciones `/` y `/about`. Los componentes asociados se llaman `HomeComponent` u `AboutComponent`. Se han **declarado pero no exportado** en sus respectivos mdulos `HomeModule` y `AboutModule`. No es necesario exportarlos porque no sern reclamados directamente por nuestro cdigo.\n\n```bash\nng g m home --routing true\nng g c home/home\nng g m about --routing true\nng g c about/about\n```\n\nEstos mdulos no deben ser importados por el `AppModule`; no queremos saber de su existencia. Simplemente debe usarse su ruta relativa en el mdulo de enrutado `AppRoutingModule` como un valor especial. Vamos a agregarlo al `app-routing.module.ts` que quedar as.\n\n```typescript\nimport { Routes, RouterModule } from '@angular/router';\nconst routes: Routes = [\n  {\n    path: '',\n    loadChildren: './home/home.module#HomeModule'\n  },\n  {\n    path: 'about',\n    loadChildren: './about/about.module#AboutModule'\n  },\n  {\n    path: 'not-found',\n    component: NotFoundComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'not-found'\n  }\n];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nFjate que **la direccin del fichero es una cadena de texto** asignada a una nueva propiedad de objeto _route_, la propiedad `loadChildren:\"\"`. No se est produciendo ninguna importacin en _TypeScript_ como ocurre con el componente `NotFoundComponent`.\n\nCon esta informacin _webpack_ va a generar un _bundle_ especfico para cada mdulo. Si durante la ejecucin se activa la ruta `/` (muy probable porque es la ruta raz) o la ruta `/about` entonces se descarga ese paquete concreto y se ejecuta su contenido. Mientras tanto, se queda almacenado en el servidor.\n\n> Esto hace que la aplicacin de Angular pese menos y responda antes, mejorando el tiempo de pintado inicial. La combinacin de estas y otras tcnicas que veremos en este tutorial sacarn el mejor rendimiento posible a tu aplicacin Angular.\n\n## 2.2 El enrutador delegado\n\nYa sabemos que hasta que no se active la ruta `/` o la `/about` no hay que hacer nada. Pero si se activa, entonces se descarga un _bundle_ que contiene un mdulo y los componentes necesarios. Slo falta escoger dentro de ese mdulo el componente que se asignar a la ruta.\n\nPara eso al crear los mdulos Home y About use el _flag_ `routing true`. Esto hace que se genere un segundo mdulo de enrutado. El `HomeRoutingModule` y el `AboutRoutingModule` son prcticamente idnticos al enrutador raz.\n\n> Digamos que son **enrutadores subordinados** al primero. Slo se llega aqu si en la ruta principal se ha navegado a una direccin concreta. Se hace notar esa distincin durante el proceso de importacin del mdulo de Angular `RouterModule`. En el caso principal se pone `imports: [RouterModule.forRoot(routes)]` y en todos los dems `imports: [RouterModule.forChild(routes)]`.\n\nA nivel subordinado, la direccin `path: \"\"` se agrega al `path: \"\"` de su enrutador padre. Cuidado, es un error comn repetir el _path_ a nivel hijo. En este caso incluso parece redundante. Pero con _about_ no quedan dudas. En el _root_ lleva `path: \"about\"` y en el _child_ solamente `path: \"\"`.\n\nLa ventaja real de este segundo enrutador es que ir empaquetado en el mismo _bundle_ que el mdulo de negocio y sus componentes. Descargando ese peso en el momento que se necesite. Aqu s que asignaremos un componente concreto: el `HomeComponent` o el `AboutComponent`. Por ejemplo el fichero `home-routing.module.ts` quedar ms o menos as:\n\n```typescript\nimport { HomeComponent } from './home/home.component';\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent\n  }\n];\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class HomeRoutingModule {}\n```\n\n## 2.3 Navegacin\n\nAhora que ya tenemos un par de rutas reales, es buen momento para crear un mini men de navegacin. Vayamos al `core/shell/header.component.html` y pongamos algo as:\n\n```html\n<header class=\"sticky\">\n  <a routerLink=\"/\" class=\"logo\"> <span class=\"icon-home\"></span> <span>{{ title }}</span> </a>\n  <a routerLink=\"about\" routerLinkActive=\"router-link-active\" class=\"button\">\n    <img width=\"32\" style=\"vertical-align: -0.5em\" src=\"./assets/logo.png\" /> <span> About us</span>\n  </a>\n</header>\n```\n\n# 3 Rutas anidadas\n\nCuando las interfaces se complican, es habitual que las aplicaciones dispongan de mens de navegacin a distintos niveles. Dentro de una misma pgina podemos querer ver distinto contenido y adems reflejarlo en la _URL_. Para resolver esta situacin en Angular disponemos de la tcnica de las _nested routes_.\n\n> De una manera un tanto forzada la he incluido en la pgina `/about`. La cual disponen de su propio men de navegacin, y lo que es ms importante, su propio `<router-outlet></router-outlet>`.\n\nPara empezar veamos como queda el _html_ del `about.component.ts`. Vamos a dotarlo de dos rutas nuevas `/about/links` y `/about/info`. Cada una mostrar contenido en un componente adecuadamente insertado en el `<router-outlet></router-outlet>` local.\n\n## 3.1 Children\n\nPara repasar conceptos de generacin de componentes\n\n```bash\nng g c about/about/links\nng g c about/about/info\n```\n\nPara que funcione empezamos por crear los dos componentes `LinksComponent` e `InfoComponent` de forma rutinaria. Y los asignamos en el `about-routing.module.ts` como subordinados a la ruta principal con el comando `children:[]`. Los caminos se van agregando sobre la ruta principal activa, la `/about`. Esto es as tanto el `routerLink` como el `path` de los `children`.\n\n```typescript\nconst routes: Routes = [\n  {\n    path: '',\n    component: AboutComponent,\n    children: [\n      {\n        path: 'links',\n        component: LinksComponent\n      },\n      {\n        path: 'info',\n        component: InfoComponent\n      }\n    ]\n  }\n];\n```\n\n## 3.2 RouterOutlet anidado\n\nLos componentes de las rutas `children` se inyectarn en el `<router-outlet>` del componente contenedor `AboutComponent`. Es como si todo volviese a empezar desde aqu.\n\n```html\n<header class=\"sticky\">\n  <a routerLink=\"links\" class=\"button\"> <span> Tutorial Links</span> </a>\n  <a routerLink=\"info\" class=\"button\"> <span> More Info</span> </a>\n</header>\n<router-outlet></router-outlet>\n```\n\nCon estos conceptos y la combinacin de `children, loadChild, component, redirectTo` ... asociadas a `path` podrs configurar tu aplicacin y responder a cualquier _URL_ desde la misma y nica pgina `index.html`.\n\n# 4 Parmetros\n\nLas rutas vistas hasta ahora se consideran estticas pues se han definido usando constantes. Es muy habitual tener **pginas con la misma estructura pero distintos contenidos**. Un blog con sus posts, una tienda con sus productos, o un proyecto con sus tareas... hay miles de ejemplos as.\n\n## 4.1 Variables en la ruta\n\nEse tipo de direcciones se consideran paramtricas, tienen unos segmentos estticos y otros dinmicos. Estos ltimos se definen con parmetros, algo as como **variables dentro de la cadena de la ruta**. Su sintaxis obliga a precederlas de dos puntos. Por ejemplo `countries/:country/cities/:city` resolvera rutas como _countries/usa/cities/new-york_ o _countries/italy/cities/roma_. Rellenando los parmetros `:country` y `:city` con los valores necesarios.\n\n> Esta aplicacin no tiene un propsito de negocio concreto. Iremos creando rutas segn sea necesario por motivos pedaggicos. Empezaremos con unas pginas destinadas a mostrar los autores del proyecto.\n\nVamos a crear rutas como _/authors/albertobasalo_ o _/authors/johndoe_. Para ello necesitamos el segmento principal _/authors_ y una par de componentes.\n\nVamos a agregar los componentes necesarios como hasta ahora.\n\n```bash\nng g c about/about/authors\nng g c about/about/authors/author\n```\n\nEn las rutas del `about-routing.module.ts` agregamos un nuevos _children paths_\n\n```typescript\n{\n  path: '',  component: AboutComponent,\n  children: [\n    {\n      path: 'links', component: LinksComponent\n    },\n    {\n      path: 'info', component: InfoComponent\n    },\n    {\n      path: 'authors', component: AuthorsComponent\n    },\n    {\n      path: 'authors/:id', component: AuthorComponent\n    }\n  ]\n}\n```\n\nEsta configuracin resuelve las rutas `about/links`, `about/info`, `about/authors` y `about/authors/cualquier-otra-cosa`. Y las carga con el componente adecuado. Lo novedoso en el camino `:id`. El prefijo dos puntos indica que es un parmetro. Algo as como una variable en el segundo segmento que se almacenar y ser recogido con el arbitrario nombre `id`.\n\nPara mostrar el uso de los nuevos enlaces he agregado el `authors/` al `AboutComponent` y he creado un listado en el `AuthorsComponent`. Familiarzate con las rutas relativas para componer la ruta completa.\n\n```html\n<a routerLink=\"albertobasalo\" class=\"button\"> <span> Alberto Basalo</span> </a>\n<a routerLink=\"johndoe\" class=\"button\"> <span> John Doe</span> </a>\n```\n\nAn ms interesante es el componente que muestra cada autor de la lista, el `AuthorComponent`. En este caso fjate cmo accede a la ruta, cmo obtiene el valor del parmetro y cmo lo usa para mostrarlo en la web.\n\n## 4.2 ActivatedRoute\n\nEl framework _Angular_ trae muchas libreras para facilitar la vida al programador. Slo hay que saber dnde estn y cmo pedirlas. Para ello volvemos a la tecnologa escogida, _TypeScript_, que permite las **importaciones y la inyeccin de dependencias**. Hay un tema dedicado a conocer en profundidad [los servicios inyectables en Angular](https://academia-binaria.com/servicios-inyectables-en-Angular/). Por ahora una breve introduccin.\n\nContenido del fichero `author.component.ts` relacionado con la obtencin del parmetro de la ruta activa:\n\n```typescript\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\n\nexport class AuthorComponent implements OnInit {\n  public authorId = '';\n  constructor(activateRoute: ActivatedRoute) {\n    this.authorId = activateRoute.snapshot.params['id'];\n  }\n  ngOnInit() {}\n}\n```\n\nLa instruccin `import { ActivatedRoute } from \"@angular/router\";` pone a disposicin del programador el cdigo donde est definida la clase `ActivatedRoute`. Pero no se instancia directamente; en su lugar, se usa como un argumento del constructor de la clase del componente. Ese constructor es invocado por _Angular_, y dinmicamente el propio framework sabe cmo rellenar los argumentos que se pidan en los constructores. Es decir, sabe cmo inyectar instancias en las que dependencias declaradas.\n\nUna vez que han **inyectan las dependencias en el constructor** ya estn listas para ser usadas. En concreto `activateRoute` da acceso a mtodos y propiedades para trabajar con la ruta activa y poder leer sus parmetros.\n\nObtenidos los datos desde la _URL_, ya se muestran en la vista de forma ya conocida. Fichero `/about/authors/author/author.component.html`\n\n```html\n<h2>Author profile</h2>\n<h3>{{ authorId }}</h3>\n```\n\nCon esto tendrs una aplicacin SPA en _Angular_. Sigue esta serie para aadirle [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/) mientras aprendes a programar con Angular7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng_2-Paginas-y-rutas-Angular-SPA.md","raw":"---\ntitle: Pginas y rutas Angular SPA\npermalink: paginas-y-rutas-angular-spa\ndate: 2019-01-21 13:41:14\ntags:\n  - Angular\n  - SPA\n  - Routing\n  - Tutorial\n  - Introduccin\n  - Angular7\n  - Angular2\ncategories:\n  - [Tutorial, Angular]\nthumbnail: /css/images/angular-2_spa.png\n---\n\n![paginas-y-rutas-angular-spa](/images/tutorial-angular-2_spa.png)\n\nLas **aplicaciones Angular 7 son conjuntos de pginas enrutadas** en el propio navegador. Son las conocidas _SPA, Single Page Applications_. Estas apps liberan al servidor de una parte del trabajo, reducen la cantidad de llamadas y mejoran la percepcin de velocidad del usuario.\n\nEn este tutorial aprenders a crear una Angular SPA fcilmente usando `@angular/router`, **el enrutador de Angular**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Base para una aplicacin Angular](../base-aplicacion-angular/). Seguimos usando el concepto de rbol, ahora como analoga de **las rutas y las vistas** asociadas. Al finalizar tendrs una angular SPA con vistas asociadas a sus rutas.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/2-spa](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/2-spa)\n\n# 1. Rutas\n\nAl crear la aplicacin hice uso del flag `routing true` en el comando de generacin del _CLI_. Esto caus la aparicin de no uno, sino dos mdulos gemelos en la raz de la aplicacin. Has estudiado el `AppModule` verdadero mdulo raz, y ahora vers en profundidad a su gemelo: el **mdulo de enrutado** `AppRoutingModule` y el uso que hace del `RouterModule`.\n\n## 1.1 RouterModule\n\nEl _Angular Router_ necesita ser importado y configurado. El mdulo `AppRoutingModule` cumple dos funciones. Por un lado **importa al `RouterModule`** de Angular, el cual contiene toda la lgica necesaria para enrutar en el navegador. Por otro lado, permite la **definicin de rutas** en el array `Routes[]`.\n\n```typescript\nimport { Routes, RouterModule } from '@angular/router';\nconst routes: Routes = [\n  {\n    path: 'heroes',\n    component: HeroesComponent\n  },\n  {\n    path: 'not-found',\n    component: NotFoundComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'not-found'\n  }\n];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nEl array de rutas recibe **objetos ruta** con propiedades de configuracin.\n\nLa primera es `path:` en la que se especifica **la direccin** que resuelve, en este caso la ruta vaca o raz del rbol de rutas. Las otras son opcionales y las veremos poco a poco.\n\n### 1.1.1 Component\n\nVamos a crear un componente donde guardar el contenido que el CLI nos regala de inicio. Los enlaces a las pginas oficiales de Angular y al ejemplo del _Tour Of Heroes_. Para ello crear el componente HeroesComponent.\n\n```bash\nng g c heroes\n```\n\nLo hago en la carpeta raz; algo poco aconsejado si queremos tener una estructura escalable. Pero es un buen anti-ejemplo ;-)\n\nAhora debo decidir qu ruta asociarle... por ejemplo `/heroes`. Eso es lo que se ve en el inicio de la configuracin de rutas. Para no perderme lo ideal es tener un nuevo enlace de navegacin en el `HeaderComponent`\n\n```html\n<header class=\"sticky\">\n  <a routerLink=\"/\" class=\"logo\"> <span class=\"icon-home\"></span> <span>{{ title }}</span> </a>\n  <a routerLink=\"heroes\" routerLinkActive=\"router-link-active\" class=\"button\">\n    <span> Heroes</span>\n  </a>\n</header>\n```\n\nVayamos casi al final y de paso hagamos algo til para no volver a perdernos sin remedio. Un detector de rutas no contempladas, y una ruta a dnde redirigir a los usuarios perdidos. Para ello estudiaremos la propiedad `component` que es fundamental pues indica **el componente** que se debe mostrar cuando esta ruta se active.\n\nAs es cmo funciona el enrutado. Un camino y un componente asociado. La tabla de enrutado se procesa de arriba a abajo y cuando un camino coincide con la ruta actual, se para y se carga el componente.\n\nVamos a crear un componente con la intencin de mostrarlo slo cuando las dems ruta fallen. Se llamar _not found_ Lo creo asociado al `CoreModule` lo cual ayuda a organizar los elementos de la aplicacin.\n\n```bash\nng g c core/not-found\n```\n\nYa podemos asociar dicho componente al camino `not-found`. Pero esto es poca cosa. Hay mucho ms.\n\n### 1.1.2 RedirectTo\n\nLa configuracin de rutas no slo permite asignar componentes a las direcciones. Tambin se pueden hacer **redirecciones de unas direcciones a otras**. Y por supuesto puede haber **rutas no contempladas o errores** por parte del usuario, los infames `404 Not Found`.\n\n> En este caso cuando se escriba la ruta `/not-foud` se mostrar un componente, el `NotFoundComponent`, cuyo contenido indicar al usuario que se ha perdido. Claro que nadie va voluntariamente a esa ruta. Mediante el `path: '**'` le indico que ante cualquier ruta no contemplada anteriormente se ejecute el comando `redirectTo: 'not-found'`, el cual nos lleva a una ruta conocida con un mensaje bien conocido. _Page Not Found_.\n\nPero Cmo es eso de que se mostrar?, Dnde se cargar?. Presentamos a `<router-outlet>`.\n\n## 1.2 Router Outlet\n\nLa idea general de **una SPA es tener una nica pgina que cargue dinmicamente otras vistas**. Normalmente la pgina contenedora mantiene el men de navegacin, el pie de pgina y otras reas comunes. Y deja un espacio para la carga dinmica. Para ello necesitamos saber **qu componente cargar y dnde mostrarlo**. De esto ltimo se ocupa el _router outlet_ mediante la etiqueta `<router-outlet></router-outlet>`.\n\nEn el `main.component.ts` haba un contenido _hard-coded_. Para hacer que el contenido sea dinmico se sustituye por el elemento de Angular `<router-outlet></router-outlet>`. Este elemento del framework inyectar dinmicamente el componente que le corresponda segn la ruta activa. El `MainComponent` queda as:\n\n```html\n<main class=\"container\">\n  <router-outlet></router-outlet>\n  <!-- Dynamic content here! -->\n</main>\n```\n\n## 1.3 Router Link\n\nLos enlaces web tradicionalmente se han resuelto con elementos `<a href=\"\"></a>` dnde en su atributo `href` se asociaba la direccin a la cul navegar ante el click del usuario. **En Angular los enlaces se declaran con un atributo** especial llamado `routerLink`. Este atributo **se compila dando lugar al `href`** oportuno en tiempo de ejecucin.\n\nEn el fichero `not-found.component.ts` pon algo as:\n\n```html\n<h1>Not Found</h1>\n<h2>404</h2>\n<a routerLink=\"/\">Go home</a>\n```\n\n> Por ahora la funcionalidad de `routerLink` no mejora en nada a `href`. Pero lo har. Mientras tanto familiarzate con su sintaxis y... asegrate de importar `RouterModule` en los mdulos en los que lo vayas a usar.\n\nSalgamos de este bucle creando ms rutas y ms componentes. Pero esta vez con un nueva tcnica.\n\n# 2 Lazy Loading\n\nLa web clsica funcionaba con un navegador pidiendo una ruta al servidor. El servidor buscaba o montaba un documento html y se lo devolva al navegador para que lo renderizase. Una nueva ruta significaba repetir todo ese viaje. Hasta que aparecieron las [Single Page Applications](https://en.wikipedia.org/wiki/Single-page_application). En este caso el cdigo cliente es el responsable del contenido asociado a cada ruta. Y eso es mucha responsabilidad.\n\nLas _webs SPA_ se crearon por una razn que casi acaba con ellas: **la velocidad**. Al realizar el enrutado en el cliente y querer evitar todos los viajes posibles hasta el servidor, se carg a la nica pgina web con todo el peso de la aplicacin. Lo cual la hizo terriblemente lenta en la primera visita de cada usuario.\n\nEl **impacto de la primera visita** en una aplicacin de intranet no suele ser un problema grave. Pero en internet esa visita puede ser la primera y si tarda mucho, tambin ser la ltima. La solucin viene de mano del concepto de _lazy loading_ o carga perezosa. Consiste en diferir la carga de la lgica asociada a una direccin hasta el momento en que sea activada dicha ruta. De esa forma, **una pgina no visitada es una pgina que no pesa**. Y la carga inicial se hace mucho ms liviana.\n\nEn Angular el _lazy loading_ es tan sencillo que ya se recomienda implementarlo por defecto. Para hacerlo conoceremos ms comandos del `Router` y algunas herramientas de compilacin usadas por el _Angular CLI_.\n\n## 2.1 Webpack y los bundles por ruta\n\nHay que saber que el _Angular CLI_ usa internamente la herramienta de empaquetado _webpack_. La cual recorre el cdigo _TypeScript_ buscando `imports` y empaquetando su contenido en sacos o _bundles_. Luego introduce las referencias a esos _bundles_ en la seccin se _scripts_ del index.html, haciendo que se descarguen todos nada ms arrancar la aplicacin. Esto puede ser muy pesado en aplicaciones grandes. As que hay que buscar una manera de diferir esa descarga, repartiendo el _bundle_ principal en otros ms pequeos que se cargar bajo demanda.\n\nObjetivo: adelgazar el peso del _bundle_ principal, el `main.js`.Para conseguirlo hay que configurar las rutas de forma que no sea necesario importar los componentes a mostrar. Tal como se ha hecho con el `NotFoundComponent`, de hacerlo as con todos, _webpack_ empaquetara esos componentes como algo necesario... y por tanto seran enviados al navegador en el _bundle_ principal sin que sea seguro su uso. Ese no es el camino, es una excepcin para componentes poco pesados y muy utilizados.\n\nLa solucin que ofrecen el _cli_ y _webpack_ consiste en **delegar la asignacin del componente a otro mdulo, pero sin importarlo** hasta que su ruta principal se active.\n\nHe creado unas vistas para ser usadas en las direcciones `/` y `/about`. Los componentes asociados se llaman `HomeComponent` u `AboutComponent`. Se han **declarado pero no exportado** en sus respectivos mdulos `HomeModule` y `AboutModule`. No es necesario exportarlos porque no sern reclamados directamente por nuestro cdigo.\n\n```bash\nng g m home --routing true\nng g c home/home\nng g m about --routing true\nng g c about/about\n```\n\nEstos mdulos no deben ser importados por el `AppModule`; no queremos saber de su existencia. Simplemente debe usarse su ruta relativa en el mdulo de enrutado `AppRoutingModule` como un valor especial. Vamos a agregarlo al `app-routing.module.ts` que quedar as.\n\n```typescript\nimport { Routes, RouterModule } from '@angular/router';\nconst routes: Routes = [\n  {\n    path: '',\n    loadChildren: './home/home.module#HomeModule'\n  },\n  {\n    path: 'about',\n    loadChildren: './about/about.module#AboutModule'\n  },\n  {\n    path: 'not-found',\n    component: NotFoundComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'not-found'\n  }\n];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nFjate que **la direccin del fichero es una cadena de texto** asignada a una nueva propiedad de objeto _route_, la propiedad `loadChildren:\"\"`. No se est produciendo ninguna importacin en _TypeScript_ como ocurre con el componente `NotFoundComponent`.\n\nCon esta informacin _webpack_ va a generar un _bundle_ especfico para cada mdulo. Si durante la ejecucin se activa la ruta `/` (muy probable porque es la ruta raz) o la ruta `/about` entonces se descarga ese paquete concreto y se ejecuta su contenido. Mientras tanto, se queda almacenado en el servidor.\n\n> Esto hace que la aplicacin de Angular pese menos y responda antes, mejorando el tiempo de pintado inicial. La combinacin de estas y otras tcnicas que veremos en este tutorial sacarn el mejor rendimiento posible a tu aplicacin Angular.\n\n## 2.2 El enrutador delegado\n\nYa sabemos que hasta que no se active la ruta `/` o la `/about` no hay que hacer nada. Pero si se activa, entonces se descarga un _bundle_ que contiene un mdulo y los componentes necesarios. Slo falta escoger dentro de ese mdulo el componente que se asignar a la ruta.\n\nPara eso al crear los mdulos Home y About use el _flag_ `routing true`. Esto hace que se genere un segundo mdulo de enrutado. El `HomeRoutingModule` y el `AboutRoutingModule` son prcticamente idnticos al enrutador raz.\n\n> Digamos que son **enrutadores subordinados** al primero. Slo se llega aqu si en la ruta principal se ha navegado a una direccin concreta. Se hace notar esa distincin durante el proceso de importacin del mdulo de Angular `RouterModule`. En el caso principal se pone `imports: [RouterModule.forRoot(routes)]` y en todos los dems `imports: [RouterModule.forChild(routes)]`.\n\nA nivel subordinado, la direccin `path: \"\"` se agrega al `path: \"\"` de su enrutador padre. Cuidado, es un error comn repetir el _path_ a nivel hijo. En este caso incluso parece redundante. Pero con _about_ no quedan dudas. En el _root_ lleva `path: \"about\"` y en el _child_ solamente `path: \"\"`.\n\nLa ventaja real de este segundo enrutador es que ir empaquetado en el mismo _bundle_ que el mdulo de negocio y sus componentes. Descargando ese peso en el momento que se necesite. Aqu s que asignaremos un componente concreto: el `HomeComponent` o el `AboutComponent`. Por ejemplo el fichero `home-routing.module.ts` quedar ms o menos as:\n\n```typescript\nimport { HomeComponent } from './home/home.component';\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent\n  }\n];\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class HomeRoutingModule {}\n```\n\n## 2.3 Navegacin\n\nAhora que ya tenemos un par de rutas reales, es buen momento para crear un mini men de navegacin. Vayamos al `core/shell/header.component.html` y pongamos algo as:\n\n```html\n<header class=\"sticky\">\n  <a routerLink=\"/\" class=\"logo\"> <span class=\"icon-home\"></span> <span>{{ title }}</span> </a>\n  <a routerLink=\"about\" routerLinkActive=\"router-link-active\" class=\"button\">\n    <img width=\"32\" style=\"vertical-align: -0.5em\" src=\"./assets/logo.png\" /> <span> About us</span>\n  </a>\n</header>\n```\n\n# 3 Rutas anidadas\n\nCuando las interfaces se complican, es habitual que las aplicaciones dispongan de mens de navegacin a distintos niveles. Dentro de una misma pgina podemos querer ver distinto contenido y adems reflejarlo en la _URL_. Para resolver esta situacin en Angular disponemos de la tcnica de las _nested routes_.\n\n> De una manera un tanto forzada la he incluido en la pgina `/about`. La cual disponen de su propio men de navegacin, y lo que es ms importante, su propio `<router-outlet></router-outlet>`.\n\nPara empezar veamos como queda el _html_ del `about.component.ts`. Vamos a dotarlo de dos rutas nuevas `/about/links` y `/about/info`. Cada una mostrar contenido en un componente adecuadamente insertado en el `<router-outlet></router-outlet>` local.\n\n## 3.1 Children\n\nPara repasar conceptos de generacin de componentes\n\n```bash\nng g c about/about/links\nng g c about/about/info\n```\n\nPara que funcione empezamos por crear los dos componentes `LinksComponent` e `InfoComponent` de forma rutinaria. Y los asignamos en el `about-routing.module.ts` como subordinados a la ruta principal con el comando `children:[]`. Los caminos se van agregando sobre la ruta principal activa, la `/about`. Esto es as tanto el `routerLink` como el `path` de los `children`.\n\n```typescript\nconst routes: Routes = [\n  {\n    path: '',\n    component: AboutComponent,\n    children: [\n      {\n        path: 'links',\n        component: LinksComponent\n      },\n      {\n        path: 'info',\n        component: InfoComponent\n      }\n    ]\n  }\n];\n```\n\n## 3.2 RouterOutlet anidado\n\nLos componentes de las rutas `children` se inyectarn en el `<router-outlet>` del componente contenedor `AboutComponent`. Es como si todo volviese a empezar desde aqu.\n\n```html\n<header class=\"sticky\">\n  <a routerLink=\"links\" class=\"button\"> <span> Tutorial Links</span> </a>\n  <a routerLink=\"info\" class=\"button\"> <span> More Info</span> </a>\n</header>\n<router-outlet></router-outlet>\n```\n\nCon estos conceptos y la combinacin de `children, loadChild, component, redirectTo` ... asociadas a `path` podrs configurar tu aplicacin y responder a cualquier _URL_ desde la misma y nica pgina `index.html`.\n\n# 4 Parmetros\n\nLas rutas vistas hasta ahora se consideran estticas pues se han definido usando constantes. Es muy habitual tener **pginas con la misma estructura pero distintos contenidos**. Un blog con sus posts, una tienda con sus productos, o un proyecto con sus tareas... hay miles de ejemplos as.\n\n## 4.1 Variables en la ruta\n\nEse tipo de direcciones se consideran paramtricas, tienen unos segmentos estticos y otros dinmicos. Estos ltimos se definen con parmetros, algo as como **variables dentro de la cadena de la ruta**. Su sintaxis obliga a precederlas de dos puntos. Por ejemplo `countries/:country/cities/:city` resolvera rutas como _countries/usa/cities/new-york_ o _countries/italy/cities/roma_. Rellenando los parmetros `:country` y `:city` con los valores necesarios.\n\n> Esta aplicacin no tiene un propsito de negocio concreto. Iremos creando rutas segn sea necesario por motivos pedaggicos. Empezaremos con unas pginas destinadas a mostrar los autores del proyecto.\n\nVamos a crear rutas como _/authors/albertobasalo_ o _/authors/johndoe_. Para ello necesitamos el segmento principal _/authors_ y una par de componentes.\n\nVamos a agregar los componentes necesarios como hasta ahora.\n\n```bash\nng g c about/about/authors\nng g c about/about/authors/author\n```\n\nEn las rutas del `about-routing.module.ts` agregamos un nuevos _children paths_\n\n```typescript\n{\n  path: '',  component: AboutComponent,\n  children: [\n    {\n      path: 'links', component: LinksComponent\n    },\n    {\n      path: 'info', component: InfoComponent\n    },\n    {\n      path: 'authors', component: AuthorsComponent\n    },\n    {\n      path: 'authors/:id', component: AuthorComponent\n    }\n  ]\n}\n```\n\nEsta configuracin resuelve las rutas `about/links`, `about/info`, `about/authors` y `about/authors/cualquier-otra-cosa`. Y las carga con el componente adecuado. Lo novedoso en el camino `:id`. El prefijo dos puntos indica que es un parmetro. Algo as como una variable en el segundo segmento que se almacenar y ser recogido con el arbitrario nombre `id`.\n\nPara mostrar el uso de los nuevos enlaces he agregado el `authors/` al `AboutComponent` y he creado un listado en el `AuthorsComponent`. Familiarzate con las rutas relativas para componer la ruta completa.\n\n```html\n<a routerLink=\"albertobasalo\" class=\"button\"> <span> Alberto Basalo</span> </a>\n<a routerLink=\"johndoe\" class=\"button\"> <span> John Doe</span> </a>\n```\n\nAn ms interesante es el componente que muestra cada autor de la lista, el `AuthorComponent`. En este caso fjate cmo accede a la ruta, cmo obtiene el valor del parmetro y cmo lo usa para mostrarlo en la web.\n\n## 4.2 ActivatedRoute\n\nEl framework _Angular_ trae muchas libreras para facilitar la vida al programador. Slo hay que saber dnde estn y cmo pedirlas. Para ello volvemos a la tecnologa escogida, _TypeScript_, que permite las **importaciones y la inyeccin de dependencias**. Hay un tema dedicado a conocer en profundidad [los servicios inyectables en Angular](https://academia-binaria.com/servicios-inyectables-en-Angular/). Por ahora una breve introduccin.\n\nContenido del fichero `author.component.ts` relacionado con la obtencin del parmetro de la ruta activa:\n\n```typescript\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\n\nexport class AuthorComponent implements OnInit {\n  public authorId = '';\n  constructor(activateRoute: ActivatedRoute) {\n    this.authorId = activateRoute.snapshot.params['id'];\n  }\n  ngOnInit() {}\n}\n```\n\nLa instruccin `import { ActivatedRoute } from \"@angular/router\";` pone a disposicin del programador el cdigo donde est definida la clase `ActivatedRoute`. Pero no se instancia directamente; en su lugar, se usa como un argumento del constructor de la clase del componente. Ese constructor es invocado por _Angular_, y dinmicamente el propio framework sabe cmo rellenar los argumentos que se pidan en los constructores. Es decir, sabe cmo inyectar instancias en las que dependencias declaradas.\n\nUna vez que han **inyectan las dependencias en el constructor** ya estn listas para ser usadas. En concreto `activateRoute` da acceso a mtodos y propiedades para trabajar con la ruta activa y poder leer sus parmetros.\n\nObtenidos los datos desde la _URL_, ya se muestran en la vista de forma ya conocida. Fichero `/about/authors/author/author.component.html`\n\n```html\n<h2>Author profile</h2>\n<h3>{{ authorId }}</h3>\n```\n\nCon esto tendrs una aplicacin SPA en _Angular_. Sigue esta serie para aadirle [Formularios, tablas y modelos de datos en Angular](../formularios-tablas-y-modelos-de-datos-en-angular/) mientras aprendes a programar con Angular7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"paginas-y-rutas-angular-spa","published":1,"updated":"2019-02-12T16:21:20.818Z","_id":"cjbrwpvji0029iwd3b7w987c4","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-2_spa.png\" alt=\"paginas-y-rutas-angular-spa\"></p><p>Las <strong>aplicaciones Angular 7 son conjuntos de pginas enrutadas</strong> en el propio navegador. Son las conocidas <em>SPA, Single Page Applications</em>. Estas apps liberan al servidor de una parte del trabajo, reducen la cantidad de llamadas y mejoran la percepcin de velocidad del usuario.</p><p>En este tutorial aprenders a crear una Angular SPA fcilmente usando <code>@angular/router</code>, <strong>el enrutador de Angular</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal cmo qued en <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a>. Seguimos usando el concepto de rbol, ahora como analoga de <strong>las rutas y las vistas</strong> asociadas. Al finalizar tendrs una angular SPA con vistas asociadas a sus rutas.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/2-spa\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/2-spa</a></p></blockquote><h1 id=\"1-Rutas\"><a href=\"#1-Rutas\" class=\"headerlink\" title=\"1. Rutas\"></a>1. Rutas</h1><p>Al crear la aplicacin hice uso del flag <code>routing true</code> en el comando de generacin del <em>CLI</em>. Esto caus la aparicin de no uno, sino dos mdulos gemelos en la raz de la aplicacin. Has estudiado el <code>AppModule</code> verdadero mdulo raz, y ahora vers en profundidad a su gemelo: el <strong>mdulo de enrutado</strong> <code>AppRoutingModule</code> y el uso que hace del <code>RouterModule</code>.</p><h2 id=\"1-1-RouterModule\"><a href=\"#1-1-RouterModule\" class=\"headerlink\" title=\"1.1 RouterModule\"></a>1.1 RouterModule</h2><p>El <em>Angular Router</em> necesita ser importado y configurado. El mdulo <code>AppRoutingModule</code> cumple dos funciones. Por un lado <strong>importa al <code>RouterModule</code></strong> de Angular, el cual contiene toda la lgica necesaria para enrutar en el navegador. Por otro lado, permite la <strong>definicin de rutas</strong> en el array <code>Routes[]</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'heroes'</span>,</span><br><span class=\"line\">    component: HeroesComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'not-found'</span>,</span><br><span class=\"line\">    component: NotFoundComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'not-found'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>El array de rutas recibe <strong>objetos ruta</strong> con propiedades de configuracin.</p><p>La primera es <code>path:</code> en la que se especifica <strong>la direccin</strong> que resuelve, en este caso la ruta vaca o raz del rbol de rutas. Las otras son opcionales y las veremos poco a poco.</p><h3 id=\"1-1-1-Component\"><a href=\"#1-1-1-Component\" class=\"headerlink\" title=\"1.1.1 Component\"></a>1.1.1 Component</h3><p>Vamos a crear un componente donde guardar el contenido que el CLI nos regala de inicio. Los enlaces a las pginas oficiales de Angular y al ejemplo del <em>Tour Of Heroes</em>. Para ello crear el componente HeroesComponent.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c heroes</span><br></pre></td></tr></table></figure><p>Lo hago en la carpeta raz; algo poco aconsejado si queremos tener una estructura escalable. Pero es un buen anti-ejemplo ;-)</p><p>Ahora debo decidir qu ruta asociarle por ejemplo <code>/heroes</code>. Eso es lo que se ve en el inicio de la configuracin de rutas. Para no perderme lo ideal es tener un nuevo enlace de navegacin en el <code>HeaderComponent</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span> <span class=\"attr\">class</span>=<span class=\"string\">\"sticky\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"/\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"logo\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"icon-home\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"heroes\"</span> <span class=\"attr\">routerLinkActive</span>=<span class=\"string\">\"router-link-active\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> Heroes<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Vayamos casi al final y de paso hagamos algo til para no volver a perdernos sin remedio. Un detector de rutas no contempladas, y una ruta a dnde redirigir a los usuarios perdidos. Para ello estudiaremos la propiedad <code>component</code> que es fundamental pues indica <strong>el componente</strong> que se debe mostrar cuando esta ruta se active.</p><p>As es cmo funciona el enrutado. Un camino y un componente asociado. La tabla de enrutado se procesa de arriba a abajo y cuando un camino coincide con la ruta actual, se para y se carga el componente.</p><p>Vamos a crear un componente con la intencin de mostrarlo slo cuando las dems ruta fallen. Se llamar <em>not found</em> Lo creo asociado al <code>CoreModule</code> lo cual ayuda a organizar los elementos de la aplicacin.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c core/not-found</span><br></pre></td></tr></table></figure><p>Ya podemos asociar dicho componente al camino <code>not-found</code>. Pero esto es poca cosa. Hay mucho ms.</p><h3 id=\"1-1-2-RedirectTo\"><a href=\"#1-1-2-RedirectTo\" class=\"headerlink\" title=\"1.1.2 RedirectTo\"></a>1.1.2 RedirectTo</h3><p>La configuracin de rutas no slo permite asignar componentes a las direcciones. Tambin se pueden hacer <strong>redirecciones de unas direcciones a otras</strong>. Y por supuesto puede haber <strong>rutas no contempladas o errores</strong> por parte del usuario, los infames <code>404 Not Found</code>.</p><blockquote><p>En este caso cuando se escriba la ruta <code>/not-foud</code> se mostrar un componente, el <code>NotFoundComponent</code>, cuyo contenido indicar al usuario que se ha perdido. Claro que nadie va voluntariamente a esa ruta. Mediante el <code>path: &#39;**&#39;</code> le indico que ante cualquier ruta no contemplada anteriormente se ejecute el comando <code>redirectTo: &#39;not-found&#39;</code>, el cual nos lleva a una ruta conocida con un mensaje bien conocido. <em>Page Not Found</em>.</p></blockquote><p>Pero Cmo es eso de que se mostrar?, Dnde se cargar?. Presentamos a <code>&lt;router-outlet&gt;</code>.</p><h2 id=\"1-2-Router-Outlet\"><a href=\"#1-2-Router-Outlet\" class=\"headerlink\" title=\"1.2 Router Outlet\"></a>1.2 Router Outlet</h2><p>La idea general de <strong>una SPA es tener una nica pgina que cargue dinmicamente otras vistas</strong>. Normalmente la pgina contenedora mantiene el men de navegacin, el pie de pgina y otras reas comunes. Y deja un espacio para la carga dinmica. Para ello necesitamos saber <strong>qu componente cargar y dnde mostrarlo</strong>. De esto ltimo se ocupa el <em>router outlet</em> mediante la etiqueta <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>.</p><p>En el <code>main.component.ts</code> haba un contenido <em>hard-coded</em>. Para hacer que el contenido sea dinmico se sustituye por el elemento de Angular <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>. Este elemento del framework inyectar dinmicamente el componente que le corresponda segn la ruta activa. El <code>MainComponent</code> queda as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">main</span> <span class=\"attr\">class</span>=<span class=\"string\">\"container\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- Dynamic content here! --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">main</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-3-Router-Link\"><a href=\"#1-3-Router-Link\" class=\"headerlink\" title=\"1.3 Router Link\"></a>1.3 Router Link</h2><p>Los enlaces web tradicionalmente se han resuelto con elementos <code>&lt;a href=&quot;&quot;&gt;&lt;/a&gt;</code> dnde en su atributo <code>href</code> se asociaba la direccin a la cul navegar ante el click del usuario. <strong>En Angular los enlaces se declaran con un atributo</strong> especial llamado <code>routerLink</code>. Este atributo <strong>se compila dando lugar al <code>href</code></strong> oportuno en tiempo de ejecucin.</p><p>En el fichero <code>not-found.component.ts</code> pon algo as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Not Found<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>404<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"/\"</span>&gt;</span>Go home<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Por ahora la funcionalidad de <code>routerLink</code> no mejora en nada a <code>href</code>. Pero lo har. Mientras tanto familiarzate con su sintaxis y asegrate de importar <code>RouterModule</code> en los mdulos en los que lo vayas a usar.</p></blockquote><p>Salgamos de este bucle creando ms rutas y ms componentes. Pero esta vez con un nueva tcnica.</p><h1 id=\"2-Lazy-Loading\"><a href=\"#2-Lazy-Loading\" class=\"headerlink\" title=\"2 Lazy Loading\"></a>2 Lazy Loading</h1><p>La web clsica funcionaba con un navegador pidiendo una ruta al servidor. El servidor buscaba o montaba un documento html y se lo devolva al navegador para que lo renderizase. Una nueva ruta significaba repetir todo ese viaje. Hasta que aparecieron las <a href=\"https://en.wikipedia.org/wiki/Single-page_application\" target=\"_blank\" rel=\"noopener\">Single Page Applications</a>. En este caso el cdigo cliente es el responsable del contenido asociado a cada ruta. Y eso es mucha responsabilidad.</p><p>Las <em>webs SPA</em> se crearon por una razn que casi acaba con ellas: <strong>la velocidad</strong>. Al realizar el enrutado en el cliente y querer evitar todos los viajes posibles hasta el servidor, se carg a la nica pgina web con todo el peso de la aplicacin. Lo cual la hizo terriblemente lenta en la primera visita de cada usuario.</p><p>El <strong>impacto de la primera visita</strong> en una aplicacin de intranet no suele ser un problema grave. Pero en internet esa visita puede ser la primera y si tarda mucho, tambin ser la ltima. La solucin viene de mano del concepto de <em>lazy loading</em> o carga perezosa. Consiste en diferir la carga de la lgica asociada a una direccin hasta el momento en que sea activada dicha ruta. De esa forma, <strong>una pgina no visitada es una pgina que no pesa</strong>. Y la carga inicial se hace mucho ms liviana.</p><p>En Angular el <em>lazy loading</em> es tan sencillo que ya se recomienda implementarlo por defecto. Para hacerlo conoceremos ms comandos del <code>Router</code> y algunas herramientas de compilacin usadas por el <em>Angular CLI</em>.</p><h2 id=\"2-1-Webpack-y-los-bundles-por-ruta\"><a href=\"#2-1-Webpack-y-los-bundles-por-ruta\" class=\"headerlink\" title=\"2.1 Webpack y los bundles por ruta\"></a>2.1 Webpack y los bundles por ruta</h2><p>Hay que saber que el <em>Angular CLI</em> usa internamente la herramienta de empaquetado <em>webpack</em>. La cual recorre el cdigo <em>TypeScript</em> buscando <code>imports</code> y empaquetando su contenido en sacos o <em>bundles</em>. Luego introduce las referencias a esos <em>bundles</em> en la seccin se <em>scripts</em> del index.html, haciendo que se descarguen todos nada ms arrancar la aplicacin. Esto puede ser muy pesado en aplicaciones grandes. As que hay que buscar una manera de diferir esa descarga, repartiendo el <em>bundle</em> principal en otros ms pequeos que se cargar bajo demanda.</p><p>Objetivo: adelgazar el peso del <em>bundle</em> principal, el <code>main.js</code>.Para conseguirlo hay que configurar las rutas de forma que no sea necesario importar los componentes a mostrar. Tal como se ha hecho con el <code>NotFoundComponent</code>, de hacerlo as con todos, <em>webpack</em> empaquetara esos componentes como algo necesario y por tanto seran enviados al navegador en el <em>bundle</em> principal sin que sea seguro su uso. Ese no es el camino, es una excepcin para componentes poco pesados y muy utilizados.</p><p>La solucin que ofrecen el <em>cli</em> y <em>webpack</em> consiste en <strong>delegar la asignacin del componente a otro mdulo, pero sin importarlo</strong> hasta que su ruta principal se active.</p><p>He creado unas vistas para ser usadas en las direcciones <code>/</code> y <code>/about</code>. Los componentes asociados se llaman <code>HomeComponent</code> u <code>AboutComponent</code>. Se han <strong>declarado pero no exportado</strong> en sus respectivos mdulos <code>HomeModule</code> y <code>AboutModule</code>. No es necesario exportarlos porque no sern reclamados directamente por nuestro cdigo.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m home --routing <span class=\"literal\">true</span></span><br><span class=\"line\">ng g c home/home</span><br><span class=\"line\">ng g m about --routing <span class=\"literal\">true</span></span><br><span class=\"line\">ng g c about/about</span><br></pre></td></tr></table></figure><p>Estos mdulos no deben ser importados por el <code>AppModule</code>; no queremos saber de su existencia. Simplemente debe usarse su ruta relativa en el mdulo de enrutado <code>AppRoutingModule</code> como un valor especial. Vamos a agregarlo al <code>app-routing.module.ts</code> que quedar as.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"string\">'./home/home.module#HomeModule'</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'about'</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"string\">'./about/about.module#AboutModule'</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'not-found'</span>,</span><br><span class=\"line\">    component: NotFoundComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'not-found'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Fjate que <strong>la direccin del fichero es una cadena de texto</strong> asignada a una nueva propiedad de objeto <em>route</em>, la propiedad <code>loadChildren:&quot;&quot;</code>. No se est produciendo ninguna importacin en <em>TypeScript</em> como ocurre con el componente <code>NotFoundComponent</code>.</p><p>Con esta informacin <em>webpack</em> va a generar un <em>bundle</em> especfico para cada mdulo. Si durante la ejecucin se activa la ruta <code>/</code> (muy probable porque es la ruta raz) o la ruta <code>/about</code> entonces se descarga ese paquete concreto y se ejecuta su contenido. Mientras tanto, se queda almacenado en el servidor.</p><blockquote><p>Esto hace que la aplicacin de Angular pese menos y responda antes, mejorando el tiempo de pintado inicial. La combinacin de estas y otras tcnicas que veremos en este tutorial sacarn el mejor rendimiento posible a tu aplicacin Angular.</p></blockquote><h2 id=\"2-2-El-enrutador-delegado\"><a href=\"#2-2-El-enrutador-delegado\" class=\"headerlink\" title=\"2.2 El enrutador delegado\"></a>2.2 El enrutador delegado</h2><p>Ya sabemos que hasta que no se active la ruta <code>/</code> o la <code>/about</code> no hay que hacer nada. Pero si se activa, entonces se descarga un <em>bundle</em> que contiene un mdulo y los componentes necesarios. Slo falta escoger dentro de ese mdulo el componente que se asignar a la ruta.</p><p>Para eso al crear los mdulos Home y About use el <em>flag</em> <code>routing true</code>. Esto hace que se genere un segundo mdulo de enrutado. El <code>HomeRoutingModule</code> y el <code>AboutRoutingModule</code> son prcticamente idnticos al enrutador raz.</p><blockquote><p>Digamos que son <strong>enrutadores subordinados</strong> al primero. Slo se llega aqu si en la ruta principal se ha navegado a una direccin concreta. Se hace notar esa distincin durante el proceso de importacin del mdulo de Angular <code>RouterModule</code>. En el caso principal se pone <code>imports: [RouterModule.forRoot(routes)]</code> y en todos los dems <code>imports: [RouterModule.forChild(routes)]</code>.</p></blockquote><p>A nivel subordinado, la direccin <code>path: &quot;&quot;</code> se agrega al <code>path: &quot;&quot;</code> de su enrutador padre. Cuidado, es un error comn repetir el <em>path</em> a nivel hijo. En este caso incluso parece redundante. Pero con <em>about</em> no quedan dudas. En el <em>root</em> lleva <code>path: &quot;about&quot;</code> y en el <em>child</em> solamente <code>path: &quot;&quot;</code>.</p><p>La ventaja real de este segundo enrutador es que ir empaquetado en el mismo <em>bundle</em> que el mdulo de negocio y sus componentes. Descargando ese peso en el momento que se necesite. Aqu s que asignaremos un componente concreto: el <code>HomeComponent</code> o el <code>AboutComponent</code>. Por ejemplo el fichero <code>home-routing.module.ts</code> quedar ms o menos as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HomeComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home/home.component'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forChild(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> HomeRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Navegacion\"><a href=\"#2-3-Navegacion\" class=\"headerlink\" title=\"2.3 Navegacin\"></a>2.3 Navegacin</h2><p>Ahora que ya tenemos un par de rutas reales, es buen momento para crear un mini men de navegacin. Vayamos al <code>core/shell/header.component.html</code> y pongamos algo as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span> <span class=\"attr\">class</span>=<span class=\"string\">\"sticky\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"/\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"logo\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"icon-home\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"about\"</span> <span class=\"attr\">routerLinkActive</span>=<span class=\"string\">\"router-link-active\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">width</span>=<span class=\"string\">\"32\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"vertical-align: -0.5em\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./assets/logo.png\"</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> About us<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"3-Rutas-anidadas\"><a href=\"#3-Rutas-anidadas\" class=\"headerlink\" title=\"3 Rutas anidadas\"></a>3 Rutas anidadas</h1><p>Cuando las interfaces se complican, es habitual que las aplicaciones dispongan de mens de navegacin a distintos niveles. Dentro de una misma pgina podemos querer ver distinto contenido y adems reflejarlo en la <em>URL</em>. Para resolver esta situacin en Angular disponemos de la tcnica de las <em>nested routes</em>.</p><blockquote><p>De una manera un tanto forzada la he incluido en la pgina <code>/about</code>. La cual disponen de su propio men de navegacin, y lo que es ms importante, su propio <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>.</p></blockquote><p>Para empezar veamos como queda el <em>html</em> del <code>about.component.ts</code>. Vamos a dotarlo de dos rutas nuevas <code>/about/links</code> y <code>/about/info</code>. Cada una mostrar contenido en un componente adecuadamente insertado en el <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code> local.</p><h2 id=\"3-1-Children\"><a href=\"#3-1-Children\" class=\"headerlink\" title=\"3.1 Children\"></a>3.1 Children</h2><p>Para repasar conceptos de generacin de componentes</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c about/about/links</span><br><span class=\"line\">ng g c about/about/info</span><br></pre></td></tr></table></figure><p>Para que funcione empezamos por crear los dos componentes <code>LinksComponent</code> e <code>InfoComponent</code> de forma rutinaria. Y los asignamos en el <code>about-routing.module.ts</code> como subordinados a la ruta principal con el comando <code>children:[]</code>. Los caminos se van agregando sobre la ruta principal activa, la <code>/about</code>. Esto es as tanto el <code>routerLink</code> como el <code>path</code> de los <code>children</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: AboutComponent,</span><br><span class=\"line\">    children: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        path: <span class=\"string\">'links'</span>,</span><br><span class=\"line\">        component: LinksComponent</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        path: <span class=\"string\">'info'</span>,</span><br><span class=\"line\">        component: InfoComponent</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><h2 id=\"3-2-RouterOutlet-anidado\"><a href=\"#3-2-RouterOutlet-anidado\" class=\"headerlink\" title=\"3.2 RouterOutlet anidado\"></a>3.2 RouterOutlet anidado</h2><p>Los componentes de las rutas <code>children</code> se inyectarn en el <code>&lt;router-outlet&gt;</code> del componente contenedor <code>AboutComponent</code>. Es como si todo volviese a empezar desde aqu.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span> <span class=\"attr\">class</span>=<span class=\"string\">\"sticky\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"links\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> Tutorial Links<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"info\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> More Info<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Con estos conceptos y la combinacin de <code>children, loadChild, component, redirectTo</code>  asociadas a <code>path</code> podrs configurar tu aplicacin y responder a cualquier <em>URL</em> desde la misma y nica pgina <code>index.html</code>.</p><h1 id=\"4-Parametros\"><a href=\"#4-Parametros\" class=\"headerlink\" title=\"4 Parmetros\"></a>4 Parmetros</h1><p>Las rutas vistas hasta ahora se consideran estticas pues se han definido usando constantes. Es muy habitual tener <strong>pginas con la misma estructura pero distintos contenidos</strong>. Un blog con sus posts, una tienda con sus productos, o un proyecto con sus tareas hay miles de ejemplos as.</p><h2 id=\"4-1-Variables-en-la-ruta\"><a href=\"#4-1-Variables-en-la-ruta\" class=\"headerlink\" title=\"4.1 Variables en la ruta\"></a>4.1 Variables en la ruta</h2><p>Ese tipo de direcciones se consideran paramtricas, tienen unos segmentos estticos y otros dinmicos. Estos ltimos se definen con parmetros, algo as como <strong>variables dentro de la cadena de la ruta</strong>. Su sintaxis obliga a precederlas de dos puntos. Por ejemplo <code>countries/:country/cities/:city</code> resolvera rutas como <em>countries/usa/cities/new-york</em> o <em>countries/italy/cities/roma</em>. Rellenando los parmetros <code>:country</code> y <code>:city</code> con los valores necesarios.</p><blockquote><p>Esta aplicacin no tiene un propsito de negocio concreto. Iremos creando rutas segn sea necesario por motivos pedaggicos. Empezaremos con unas pginas destinadas a mostrar los autores del proyecto.</p></blockquote><p>Vamos a crear rutas como <em>/authors/albertobasalo</em> o <em>/authors/johndoe</em>. Para ello necesitamos el segmento principal <em>/authors</em> y una par de componentes.</p><p>Vamos a agregar los componentes necesarios como hasta ahora.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c about/about/authors</span><br><span class=\"line\">ng g c about/about/authors/author</span><br></pre></td></tr></table></figure><p>En las rutas del <code>about-routing.module.ts</code> agregamos un nuevos <em>children paths</em></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">''</span>,  component: AboutComponent,</span><br><span class=\"line\">  children: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      path: <span class=\"string\">'links'</span>, component: LinksComponent</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      path: <span class=\"string\">'info'</span>, component: InfoComponent</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      path: <span class=\"string\">'authors'</span>, component: AuthorsComponent</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      path: <span class=\"string\">'authors/:id'</span>, component: AuthorComponent</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Esta configuracin resuelve las rutas <code>about/links</code>, <code>about/info</code>, <code>about/authors</code> y <code>about/authors/cualquier-otra-cosa</code>. Y las carga con el componente adecuado. Lo novedoso en el camino <code>:id</code>. El prefijo dos puntos indica que es un parmetro. Algo as como una variable en el segundo segmento que se almacenar y ser recogido con el arbitrario nombre <code>id</code>.</p><p>Para mostrar el uso de los nuevos enlaces he agregado el <code>authors/</code> al <code>AboutComponent</code> y he creado un listado en el <code>AuthorsComponent</code>. Familiarzate con las rutas relativas para componer la ruta completa.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"albertobasalo\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> Alberto Basalo<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"johndoe\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> John Doe<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>An ms interesante es el componente que muestra cada autor de la lista, el <code>AuthorComponent</code>. En este caso fjate cmo accede a la ruta, cmo obtiene el valor del parmetro y cmo lo usa para mostrarlo en la web.</p><h2 id=\"4-2-ActivatedRoute\"><a href=\"#4-2-ActivatedRoute\" class=\"headerlink\" title=\"4.2 ActivatedRoute\"></a>4.2 ActivatedRoute</h2><p>El framework <em>Angular</em> trae muchas libreras para facilitar la vida al programador. Slo hay que saber dnde estn y cmo pedirlas. Para ello volvemos a la tecnologa escogida, <em>TypeScript</em>, que permite las <strong>importaciones y la inyeccin de dependencias</strong>. Hay un tema dedicado a conocer en profundidad <a href=\"https://academia-binaria.com/servicios-inyectables-en-Angular/\">los servicios inyectables en Angular</a>. Por ahora una breve introduccin.</p><p>Contenido del fichero <code>author.component.ts</code> relacionado con la obtencin del parmetro de la ruta activa:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; ActivatedRoute &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AuthorComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> authorId = <span class=\"string\">''</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\">activateRoute: ActivatedRoute</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.authorId = activateRoute.snapshot.params[<span class=\"string\">'id'</span>];</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>La instruccin <code>import { ActivatedRoute } from &quot;@angular/router&quot;;</code> pone a disposicin del programador el cdigo donde est definida la clase <code>ActivatedRoute</code>. Pero no se instancia directamente; en su lugar, se usa como un argumento del constructor de la clase del componente. Ese constructor es invocado por <em>Angular</em>, y dinmicamente el propio framework sabe cmo rellenar los argumentos que se pidan en los constructores. Es decir, sabe cmo inyectar instancias en las que dependencias declaradas.</p><p>Una vez que han <strong>inyectan las dependencias en el constructor</strong> ya estn listas para ser usadas. En concreto <code>activateRoute</code> da acceso a mtodos y propiedades para trabajar con la ruta activa y poder leer sus parmetros.</p><p>Obtenidos los datos desde la <em>URL</em>, ya se muestran en la vista de forma ya conocida. Fichero <code>/about/authors/author/author.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Author profile<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>&#123;&#123; authorId &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Con esto tendrs una aplicacin SPA en <em>Angular</em>. Sigue esta serie para aadirle <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a> mientras aprendes a programar con Angular7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-2_spa.png\" alt=\"paginas-y-rutas-angular-spa\"></p><p>Las <strong>aplicaciones Angular 7 son conjuntos de pginas enrutadas</strong> en el propio navegador. Son las conocidas <em>SPA, Single Page Applications</em>. Estas apps liberan al servidor de una parte del trabajo, reducen la cantidad de llamadas y mejoran la percepcin de velocidad del usuario.</p><p>En este tutorial aprenders a crear una Angular SPA fcilmente usando <code>@angular/router</code>, <strong>el enrutador de Angular</strong>.</p>","more":"<p>Partiendo de la aplicacin tal cmo qued en <a href=\"../base-aplicacion-angular/\">Base para una aplicacin Angular</a>. Seguimos usando el concepto de rbol, ahora como analoga de <strong>las rutas y las vistas</strong> asociadas. Al finalizar tendrs una angular SPA con vistas asociadas a sus rutas.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/2-spa\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/2-spa</a></p></blockquote><h1 id=\"1-Rutas\"><a href=\"#1-Rutas\" class=\"headerlink\" title=\"1. Rutas\"></a>1. Rutas</h1><p>Al crear la aplicacin hice uso del flag <code>routing true</code> en el comando de generacin del <em>CLI</em>. Esto caus la aparicin de no uno, sino dos mdulos gemelos en la raz de la aplicacin. Has estudiado el <code>AppModule</code> verdadero mdulo raz, y ahora vers en profundidad a su gemelo: el <strong>mdulo de enrutado</strong> <code>AppRoutingModule</code> y el uso que hace del <code>RouterModule</code>.</p><h2 id=\"1-1-RouterModule\"><a href=\"#1-1-RouterModule\" class=\"headerlink\" title=\"1.1 RouterModule\"></a>1.1 RouterModule</h2><p>El <em>Angular Router</em> necesita ser importado y configurado. El mdulo <code>AppRoutingModule</code> cumple dos funciones. Por un lado <strong>importa al <code>RouterModule</code></strong> de Angular, el cual contiene toda la lgica necesaria para enrutar en el navegador. Por otro lado, permite la <strong>definicin de rutas</strong> en el array <code>Routes[]</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'heroes'</span>,</span><br><span class=\"line\">    component: HeroesComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'not-found'</span>,</span><br><span class=\"line\">    component: NotFoundComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'not-found'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>El array de rutas recibe <strong>objetos ruta</strong> con propiedades de configuracin.</p><p>La primera es <code>path:</code> en la que se especifica <strong>la direccin</strong> que resuelve, en este caso la ruta vaca o raz del rbol de rutas. Las otras son opcionales y las veremos poco a poco.</p><h3 id=\"1-1-1-Component\"><a href=\"#1-1-1-Component\" class=\"headerlink\" title=\"1.1.1 Component\"></a>1.1.1 Component</h3><p>Vamos a crear un componente donde guardar el contenido que el CLI nos regala de inicio. Los enlaces a las pginas oficiales de Angular y al ejemplo del <em>Tour Of Heroes</em>. Para ello crear el componente HeroesComponent.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c heroes</span><br></pre></td></tr></table></figure><p>Lo hago en la carpeta raz; algo poco aconsejado si queremos tener una estructura escalable. Pero es un buen anti-ejemplo ;-)</p><p>Ahora debo decidir qu ruta asociarle por ejemplo <code>/heroes</code>. Eso es lo que se ve en el inicio de la configuracin de rutas. Para no perderme lo ideal es tener un nuevo enlace de navegacin en el <code>HeaderComponent</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span> <span class=\"attr\">class</span>=<span class=\"string\">\"sticky\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"/\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"logo\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"icon-home\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"heroes\"</span> <span class=\"attr\">routerLinkActive</span>=<span class=\"string\">\"router-link-active\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> Heroes<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Vayamos casi al final y de paso hagamos algo til para no volver a perdernos sin remedio. Un detector de rutas no contempladas, y una ruta a dnde redirigir a los usuarios perdidos. Para ello estudiaremos la propiedad <code>component</code> que es fundamental pues indica <strong>el componente</strong> que se debe mostrar cuando esta ruta se active.</p><p>As es cmo funciona el enrutado. Un camino y un componente asociado. La tabla de enrutado se procesa de arriba a abajo y cuando un camino coincide con la ruta actual, se para y se carga el componente.</p><p>Vamos a crear un componente con la intencin de mostrarlo slo cuando las dems ruta fallen. Se llamar <em>not found</em> Lo creo asociado al <code>CoreModule</code> lo cual ayuda a organizar los elementos de la aplicacin.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c core/not-found</span><br></pre></td></tr></table></figure><p>Ya podemos asociar dicho componente al camino <code>not-found</code>. Pero esto es poca cosa. Hay mucho ms.</p><h3 id=\"1-1-2-RedirectTo\"><a href=\"#1-1-2-RedirectTo\" class=\"headerlink\" title=\"1.1.2 RedirectTo\"></a>1.1.2 RedirectTo</h3><p>La configuracin de rutas no slo permite asignar componentes a las direcciones. Tambin se pueden hacer <strong>redirecciones de unas direcciones a otras</strong>. Y por supuesto puede haber <strong>rutas no contempladas o errores</strong> por parte del usuario, los infames <code>404 Not Found</code>.</p><blockquote><p>En este caso cuando se escriba la ruta <code>/not-foud</code> se mostrar un componente, el <code>NotFoundComponent</code>, cuyo contenido indicar al usuario que se ha perdido. Claro que nadie va voluntariamente a esa ruta. Mediante el <code>path: &#39;**&#39;</code> le indico que ante cualquier ruta no contemplada anteriormente se ejecute el comando <code>redirectTo: &#39;not-found&#39;</code>, el cual nos lleva a una ruta conocida con un mensaje bien conocido. <em>Page Not Found</em>.</p></blockquote><p>Pero Cmo es eso de que se mostrar?, Dnde se cargar?. Presentamos a <code>&lt;router-outlet&gt;</code>.</p><h2 id=\"1-2-Router-Outlet\"><a href=\"#1-2-Router-Outlet\" class=\"headerlink\" title=\"1.2 Router Outlet\"></a>1.2 Router Outlet</h2><p>La idea general de <strong>una SPA es tener una nica pgina que cargue dinmicamente otras vistas</strong>. Normalmente la pgina contenedora mantiene el men de navegacin, el pie de pgina y otras reas comunes. Y deja un espacio para la carga dinmica. Para ello necesitamos saber <strong>qu componente cargar y dnde mostrarlo</strong>. De esto ltimo se ocupa el <em>router outlet</em> mediante la etiqueta <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>.</p><p>En el <code>main.component.ts</code> haba un contenido <em>hard-coded</em>. Para hacer que el contenido sea dinmico se sustituye por el elemento de Angular <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>. Este elemento del framework inyectar dinmicamente el componente que le corresponda segn la ruta activa. El <code>MainComponent</code> queda as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">main</span> <span class=\"attr\">class</span>=<span class=\"string\">\"container\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- Dynamic content here! --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">main</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-3-Router-Link\"><a href=\"#1-3-Router-Link\" class=\"headerlink\" title=\"1.3 Router Link\"></a>1.3 Router Link</h2><p>Los enlaces web tradicionalmente se han resuelto con elementos <code>&lt;a href=&quot;&quot;&gt;&lt;/a&gt;</code> dnde en su atributo <code>href</code> se asociaba la direccin a la cul navegar ante el click del usuario. <strong>En Angular los enlaces se declaran con un atributo</strong> especial llamado <code>routerLink</code>. Este atributo <strong>se compila dando lugar al <code>href</code></strong> oportuno en tiempo de ejecucin.</p><p>En el fichero <code>not-found.component.ts</code> pon algo as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Not Found<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>404<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"/\"</span>&gt;</span>Go home<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Por ahora la funcionalidad de <code>routerLink</code> no mejora en nada a <code>href</code>. Pero lo har. Mientras tanto familiarzate con su sintaxis y asegrate de importar <code>RouterModule</code> en los mdulos en los que lo vayas a usar.</p></blockquote><p>Salgamos de este bucle creando ms rutas y ms componentes. Pero esta vez con un nueva tcnica.</p><h1 id=\"2-Lazy-Loading\"><a href=\"#2-Lazy-Loading\" class=\"headerlink\" title=\"2 Lazy Loading\"></a>2 Lazy Loading</h1><p>La web clsica funcionaba con un navegador pidiendo una ruta al servidor. El servidor buscaba o montaba un documento html y se lo devolva al navegador para que lo renderizase. Una nueva ruta significaba repetir todo ese viaje. Hasta que aparecieron las <a href=\"https://en.wikipedia.org/wiki/Single-page_application\" target=\"_blank\" rel=\"noopener\">Single Page Applications</a>. En este caso el cdigo cliente es el responsable del contenido asociado a cada ruta. Y eso es mucha responsabilidad.</p><p>Las <em>webs SPA</em> se crearon por una razn que casi acaba con ellas: <strong>la velocidad</strong>. Al realizar el enrutado en el cliente y querer evitar todos los viajes posibles hasta el servidor, se carg a la nica pgina web con todo el peso de la aplicacin. Lo cual la hizo terriblemente lenta en la primera visita de cada usuario.</p><p>El <strong>impacto de la primera visita</strong> en una aplicacin de intranet no suele ser un problema grave. Pero en internet esa visita puede ser la primera y si tarda mucho, tambin ser la ltima. La solucin viene de mano del concepto de <em>lazy loading</em> o carga perezosa. Consiste en diferir la carga de la lgica asociada a una direccin hasta el momento en que sea activada dicha ruta. De esa forma, <strong>una pgina no visitada es una pgina que no pesa</strong>. Y la carga inicial se hace mucho ms liviana.</p><p>En Angular el <em>lazy loading</em> es tan sencillo que ya se recomienda implementarlo por defecto. Para hacerlo conoceremos ms comandos del <code>Router</code> y algunas herramientas de compilacin usadas por el <em>Angular CLI</em>.</p><h2 id=\"2-1-Webpack-y-los-bundles-por-ruta\"><a href=\"#2-1-Webpack-y-los-bundles-por-ruta\" class=\"headerlink\" title=\"2.1 Webpack y los bundles por ruta\"></a>2.1 Webpack y los bundles por ruta</h2><p>Hay que saber que el <em>Angular CLI</em> usa internamente la herramienta de empaquetado <em>webpack</em>. La cual recorre el cdigo <em>TypeScript</em> buscando <code>imports</code> y empaquetando su contenido en sacos o <em>bundles</em>. Luego introduce las referencias a esos <em>bundles</em> en la seccin se <em>scripts</em> del index.html, haciendo que se descarguen todos nada ms arrancar la aplicacin. Esto puede ser muy pesado en aplicaciones grandes. As que hay que buscar una manera de diferir esa descarga, repartiendo el <em>bundle</em> principal en otros ms pequeos que se cargar bajo demanda.</p><p>Objetivo: adelgazar el peso del <em>bundle</em> principal, el <code>main.js</code>.Para conseguirlo hay que configurar las rutas de forma que no sea necesario importar los componentes a mostrar. Tal como se ha hecho con el <code>NotFoundComponent</code>, de hacerlo as con todos, <em>webpack</em> empaquetara esos componentes como algo necesario y por tanto seran enviados al navegador en el <em>bundle</em> principal sin que sea seguro su uso. Ese no es el camino, es una excepcin para componentes poco pesados y muy utilizados.</p><p>La solucin que ofrecen el <em>cli</em> y <em>webpack</em> consiste en <strong>delegar la asignacin del componente a otro mdulo, pero sin importarlo</strong> hasta que su ruta principal se active.</p><p>He creado unas vistas para ser usadas en las direcciones <code>/</code> y <code>/about</code>. Los componentes asociados se llaman <code>HomeComponent</code> u <code>AboutComponent</code>. Se han <strong>declarado pero no exportado</strong> en sus respectivos mdulos <code>HomeModule</code> y <code>AboutModule</code>. No es necesario exportarlos porque no sern reclamados directamente por nuestro cdigo.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m home --routing <span class=\"literal\">true</span></span><br><span class=\"line\">ng g c home/home</span><br><span class=\"line\">ng g m about --routing <span class=\"literal\">true</span></span><br><span class=\"line\">ng g c about/about</span><br></pre></td></tr></table></figure><p>Estos mdulos no deben ser importados por el <code>AppModule</code>; no queremos saber de su existencia. Simplemente debe usarse su ruta relativa en el mdulo de enrutado <code>AppRoutingModule</code> como un valor especial. Vamos a agregarlo al <code>app-routing.module.ts</code> que quedar as.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"string\">'./home/home.module#HomeModule'</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'about'</span>,</span><br><span class=\"line\">    loadChildren: <span class=\"string\">'./about/about.module#AboutModule'</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'not-found'</span>,</span><br><span class=\"line\">    component: NotFoundComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'not-found'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Fjate que <strong>la direccin del fichero es una cadena de texto</strong> asignada a una nueva propiedad de objeto <em>route</em>, la propiedad <code>loadChildren:&quot;&quot;</code>. No se est produciendo ninguna importacin en <em>TypeScript</em> como ocurre con el componente <code>NotFoundComponent</code>.</p><p>Con esta informacin <em>webpack</em> va a generar un <em>bundle</em> especfico para cada mdulo. Si durante la ejecucin se activa la ruta <code>/</code> (muy probable porque es la ruta raz) o la ruta <code>/about</code> entonces se descarga ese paquete concreto y se ejecuta su contenido. Mientras tanto, se queda almacenado en el servidor.</p><blockquote><p>Esto hace que la aplicacin de Angular pese menos y responda antes, mejorando el tiempo de pintado inicial. La combinacin de estas y otras tcnicas que veremos en este tutorial sacarn el mejor rendimiento posible a tu aplicacin Angular.</p></blockquote><h2 id=\"2-2-El-enrutador-delegado\"><a href=\"#2-2-El-enrutador-delegado\" class=\"headerlink\" title=\"2.2 El enrutador delegado\"></a>2.2 El enrutador delegado</h2><p>Ya sabemos que hasta que no se active la ruta <code>/</code> o la <code>/about</code> no hay que hacer nada. Pero si se activa, entonces se descarga un <em>bundle</em> que contiene un mdulo y los componentes necesarios. Slo falta escoger dentro de ese mdulo el componente que se asignar a la ruta.</p><p>Para eso al crear los mdulos Home y About use el <em>flag</em> <code>routing true</code>. Esto hace que se genere un segundo mdulo de enrutado. El <code>HomeRoutingModule</code> y el <code>AboutRoutingModule</code> son prcticamente idnticos al enrutador raz.</p><blockquote><p>Digamos que son <strong>enrutadores subordinados</strong> al primero. Slo se llega aqu si en la ruta principal se ha navegado a una direccin concreta. Se hace notar esa distincin durante el proceso de importacin del mdulo de Angular <code>RouterModule</code>. En el caso principal se pone <code>imports: [RouterModule.forRoot(routes)]</code> y en todos los dems <code>imports: [RouterModule.forChild(routes)]</code>.</p></blockquote><p>A nivel subordinado, la direccin <code>path: &quot;&quot;</code> se agrega al <code>path: &quot;&quot;</code> de su enrutador padre. Cuidado, es un error comn repetir el <em>path</em> a nivel hijo. En este caso incluso parece redundante. Pero con <em>about</em> no quedan dudas. En el <em>root</em> lleva <code>path: &quot;about&quot;</code> y en el <em>child</em> solamente <code>path: &quot;&quot;</code>.</p><p>La ventaja real de este segundo enrutador es que ir empaquetado en el mismo <em>bundle</em> que el mdulo de negocio y sus componentes. Descargando ese peso en el momento que se necesite. Aqu s que asignaremos un componente concreto: el <code>HomeComponent</code> o el <code>AboutComponent</code>. Por ejemplo el fichero <code>home-routing.module.ts</code> quedar ms o menos as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; HomeComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./home/home.component'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forChild(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> HomeRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-3-Navegacion\"><a href=\"#2-3-Navegacion\" class=\"headerlink\" title=\"2.3 Navegacin\"></a>2.3 Navegacin</h2><p>Ahora que ya tenemos un par de rutas reales, es buen momento para crear un mini men de navegacin. Vayamos al <code>core/shell/header.component.html</code> y pongamos algo as:</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span> <span class=\"attr\">class</span>=<span class=\"string\">\"sticky\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"/\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"logo\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"icon-home\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"about\"</span> <span class=\"attr\">routerLinkActive</span>=<span class=\"string\">\"router-link-active\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">width</span>=<span class=\"string\">\"32\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"vertical-align: -0.5em\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./assets/logo.png\"</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> About us<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"3-Rutas-anidadas\"><a href=\"#3-Rutas-anidadas\" class=\"headerlink\" title=\"3 Rutas anidadas\"></a>3 Rutas anidadas</h1><p>Cuando las interfaces se complican, es habitual que las aplicaciones dispongan de mens de navegacin a distintos niveles. Dentro de una misma pgina podemos querer ver distinto contenido y adems reflejarlo en la <em>URL</em>. Para resolver esta situacin en Angular disponemos de la tcnica de las <em>nested routes</em>.</p><blockquote><p>De una manera un tanto forzada la he incluido en la pgina <code>/about</code>. La cual disponen de su propio men de navegacin, y lo que es ms importante, su propio <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>.</p></blockquote><p>Para empezar veamos como queda el <em>html</em> del <code>about.component.ts</code>. Vamos a dotarlo de dos rutas nuevas <code>/about/links</code> y <code>/about/info</code>. Cada una mostrar contenido en un componente adecuadamente insertado en el <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code> local.</p><h2 id=\"3-1-Children\"><a href=\"#3-1-Children\" class=\"headerlink\" title=\"3.1 Children\"></a>3.1 Children</h2><p>Para repasar conceptos de generacin de componentes</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c about/about/links</span><br><span class=\"line\">ng g c about/about/info</span><br></pre></td></tr></table></figure><p>Para que funcione empezamos por crear los dos componentes <code>LinksComponent</code> e <code>InfoComponent</code> de forma rutinaria. Y los asignamos en el <code>about-routing.module.ts</code> como subordinados a la ruta principal con el comando <code>children:[]</code>. Los caminos se van agregando sobre la ruta principal activa, la <code>/about</code>. Esto es as tanto el <code>routerLink</code> como el <code>path</code> de los <code>children</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: AboutComponent,</span><br><span class=\"line\">    children: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        path: <span class=\"string\">'links'</span>,</span><br><span class=\"line\">        component: LinksComponent</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        path: <span class=\"string\">'info'</span>,</span><br><span class=\"line\">        component: InfoComponent</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><h2 id=\"3-2-RouterOutlet-anidado\"><a href=\"#3-2-RouterOutlet-anidado\" class=\"headerlink\" title=\"3.2 RouterOutlet anidado\"></a>3.2 RouterOutlet anidado</h2><p>Los componentes de las rutas <code>children</code> se inyectarn en el <code>&lt;router-outlet&gt;</code> del componente contenedor <code>AboutComponent</code>. Es como si todo volviese a empezar desde aqu.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">header</span> <span class=\"attr\">class</span>=<span class=\"string\">\"sticky\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"links\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> Tutorial Links<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"info\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> More Info<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Con estos conceptos y la combinacin de <code>children, loadChild, component, redirectTo</code>  asociadas a <code>path</code> podrs configurar tu aplicacin y responder a cualquier <em>URL</em> desde la misma y nica pgina <code>index.html</code>.</p><h1 id=\"4-Parametros\"><a href=\"#4-Parametros\" class=\"headerlink\" title=\"4 Parmetros\"></a>4 Parmetros</h1><p>Las rutas vistas hasta ahora se consideran estticas pues se han definido usando constantes. Es muy habitual tener <strong>pginas con la misma estructura pero distintos contenidos</strong>. Un blog con sus posts, una tienda con sus productos, o un proyecto con sus tareas hay miles de ejemplos as.</p><h2 id=\"4-1-Variables-en-la-ruta\"><a href=\"#4-1-Variables-en-la-ruta\" class=\"headerlink\" title=\"4.1 Variables en la ruta\"></a>4.1 Variables en la ruta</h2><p>Ese tipo de direcciones se consideran paramtricas, tienen unos segmentos estticos y otros dinmicos. Estos ltimos se definen con parmetros, algo as como <strong>variables dentro de la cadena de la ruta</strong>. Su sintaxis obliga a precederlas de dos puntos. Por ejemplo <code>countries/:country/cities/:city</code> resolvera rutas como <em>countries/usa/cities/new-york</em> o <em>countries/italy/cities/roma</em>. Rellenando los parmetros <code>:country</code> y <code>:city</code> con los valores necesarios.</p><blockquote><p>Esta aplicacin no tiene un propsito de negocio concreto. Iremos creando rutas segn sea necesario por motivos pedaggicos. Empezaremos con unas pginas destinadas a mostrar los autores del proyecto.</p></blockquote><p>Vamos a crear rutas como <em>/authors/albertobasalo</em> o <em>/authors/johndoe</em>. Para ello necesitamos el segmento principal <em>/authors</em> y una par de componentes.</p><p>Vamos a agregar los componentes necesarios como hasta ahora.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c about/about/authors</span><br><span class=\"line\">ng g c about/about/authors/author</span><br></pre></td></tr></table></figure><p>En las rutas del <code>about-routing.module.ts</code> agregamos un nuevos <em>children paths</em></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">''</span>,  component: AboutComponent,</span><br><span class=\"line\">  children: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      path: <span class=\"string\">'links'</span>, component: LinksComponent</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      path: <span class=\"string\">'info'</span>, component: InfoComponent</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      path: <span class=\"string\">'authors'</span>, component: AuthorsComponent</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      path: <span class=\"string\">'authors/:id'</span>, component: AuthorComponent</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Esta configuracin resuelve las rutas <code>about/links</code>, <code>about/info</code>, <code>about/authors</code> y <code>about/authors/cualquier-otra-cosa</code>. Y las carga con el componente adecuado. Lo novedoso en el camino <code>:id</code>. El prefijo dos puntos indica que es un parmetro. Algo as como una variable en el segundo segmento que se almacenar y ser recogido con el arbitrario nombre <code>id</code>.</p><p>Para mostrar el uso de los nuevos enlaces he agregado el <code>authors/</code> al <code>AboutComponent</code> y he creado un listado en el <code>AuthorsComponent</code>. Familiarzate con las rutas relativas para componer la ruta completa.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"albertobasalo\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> Alberto Basalo<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"johndoe\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span> John Doe<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>An ms interesante es el componente que muestra cada autor de la lista, el <code>AuthorComponent</code>. En este caso fjate cmo accede a la ruta, cmo obtiene el valor del parmetro y cmo lo usa para mostrarlo en la web.</p><h2 id=\"4-2-ActivatedRoute\"><a href=\"#4-2-ActivatedRoute\" class=\"headerlink\" title=\"4.2 ActivatedRoute\"></a>4.2 ActivatedRoute</h2><p>El framework <em>Angular</em> trae muchas libreras para facilitar la vida al programador. Slo hay que saber dnde estn y cmo pedirlas. Para ello volvemos a la tecnologa escogida, <em>TypeScript</em>, que permite las <strong>importaciones y la inyeccin de dependencias</strong>. Hay un tema dedicado a conocer en profundidad <a href=\"https://academia-binaria.com/servicios-inyectables-en-Angular/\">los servicios inyectables en Angular</a>. Por ahora una breve introduccin.</p><p>Contenido del fichero <code>author.component.ts</code> relacionado con la obtencin del parmetro de la ruta activa:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; ActivatedRoute &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AuthorComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> authorId = <span class=\"string\">''</span>;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\">activateRoute: ActivatedRoute</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.authorId = activateRoute.snapshot.params[<span class=\"string\">'id'</span>];</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>La instruccin <code>import { ActivatedRoute } from &quot;@angular/router&quot;;</code> pone a disposicin del programador el cdigo donde est definida la clase <code>ActivatedRoute</code>. Pero no se instancia directamente; en su lugar, se usa como un argumento del constructor de la clase del componente. Ese constructor es invocado por <em>Angular</em>, y dinmicamente el propio framework sabe cmo rellenar los argumentos que se pidan en los constructores. Es decir, sabe cmo inyectar instancias en las que dependencias declaradas.</p><p>Una vez que han <strong>inyectan las dependencias en el constructor</strong> ya estn listas para ser usadas. En concreto <code>activateRoute</code> da acceso a mtodos y propiedades para trabajar con la ruta activa y poder leer sus parmetros.</p><p>Obtenidos los datos desde la <em>URL</em>, ya se muestran en la vista de forma ya conocida. Fichero <code>/about/authors/author/author.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Author profile<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>&#123;&#123; authorId &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Con esto tendrs una aplicacin SPA en <em>Angular</em>. Sigue esta serie para aadirle <a href=\"../formularios-tablas-y-modelos-de-datos-en-angular/\">Formularios, tablas y modelos de datos en Angular</a> mientras aprendes a programar con Angular7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Base para una aplicacin Angular","date":"2019-01-16T10:57:00.000Z","thumbnail":"/css/images/angular-1_base.png","_content":"\n![base-aplicacion-angular](/images/tutorial-angular-1_base.png)\n\nVamos a crear una **base sobre la que programar una aplicacin Angular 7** profesional. Usaremos el _CLI_ para generar una estructura sobre la que crecer. Ser como una semilla para un desarrollo controlado.\nLa idea de rbol se usa en muchas analogas informticas. La emplearemos en dos conceptos bsicos en Angular: **los mdulos y los componentes**.\n\n<!-- more -->\n\nPartimos de la aplicacin tal cmo la dejamos en el [Hola Mundo en Angular](../hola-angular-cli/). Al finalizar tendrs un esqueleto del que colgar mdulos y componentes funcionales.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/1-base](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app)\n\n# 1. Mdulos\n\nLos mdulos son **contenedores para almacenar los componentes y servicios** de una aplicacin. En Angular cada programa se puede ver como un rbol de mdulos jerrquico. A partir de un mdulo raz se enlazan otros mdulos en un proceso llamado importacin.\n\n## 1.1 Anatoma de un mdulo\n\nAntes de usar cualquier mdulo hay que conocerlo. En Angular **los mdulos de declaran como clases de TypeScript**. Estas clases, habitualmente vacas, son decoradas con una funcin especial. Es la funcin `@NgModule()` que recibe un objeto como nico argumento. En las propiedades de ese objeto es donde se configura el mdulo.\n\nMira el mdulo `AppModule` original que genera el CLI en el fichero `app.module.ts`.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\n### 1.1.1 Importacin de otros mdulos\n\nEl mdulo `App` tambin se conoce como **mdulo raz** porque de l surgen las dems ramas que conforman una aplicacin. La asignacin de los nodos hijos se realiza en la propiedad `imports:[]`, que es un array de punteros a otros mdulos.\n\n> En la situacin original el mdulo principal depende un mdulo _custom_ pre-generado (el `AppRoutingModule` que usars ms adelante) y de otro _del framework_ para la presentacin en el navegador (el `BrowserModule`).\n\nVeremos esto con ms profundidad en el punto 4.\n\n## 1.2 Generacin de mdulos\n\nHasta ahora los mdulos involucrados son libreras de terceros o que se crearon mgicamente con la aplicacin. Es hora de **crear tu primer mdulo**. Para eso usaremos otro comando del _cli_, el `ng generate module`. En una ventana del terminal escribe:\n\n```bash\nng g m core\n```\n\nEsta es la sintaxis abreviada del comando [`ng generate`](https://angular.io/cli/generate) el cual dispone de varios planos de construccin o _blueprints_. El que he usado aqu es el de [`module`](https://angular.io/cli/generate#module-command) para la construccin de mdulos.\n\n> Si no te gusta teclear en la terminal, tambin puedes lanzar estos comandos desde [Angular Console](https://angularconsole.com/)\n\nEl resultado es la creacin del fichero `core/core.module.ts` con la declaracin y decoracin del mdulo `CoreModule`.\nEste mdulo te servir de **contenedor para guardar componentes** y otros servicios esenciales para nuestra aplicacin. Pero eso lo veremos ms adelante.\n\n```typescript\n@NgModule({\n  imports: [],\n  declarations: []\n})\nexport class CoreModule {}\n```\n\nPor ahora hay que asegurar que **este mdulo ser importado por el raz, el AppModule**. Para ello comprobaremos que la lnea de importacin del mdulo principal est parecida a esto:\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, CoreModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\n> El mdulo raz, al igual que como vers ms tarde con el componente raz, es un tanto especial. Su nombre oficial es App, aunque todo la documentacin se refiere a l como raz o root.\n\n# 2. Componentes\n\nLos mdulos son contenedores. Lo primero que vamos a guardar en ellos sern componentes. **Los componentes son los bloques bsicos de construccin de las pginas web en Angular 7**. Contienen una parte visual en html (la Vista) y una funcional en Typescript (el Controlador).\n\n> La aplicacin original que crea el CLI nos regala un primer componente de ejemplo en el fichero `app.component.ts`. Segn la configuracin del CLI este componente puede haber sido creado en un slo fichero o hasta cuatro: (el controlador, con la vista y los estilos en ficheros propios y fichero extra para pruebas unitarias).\n\n## 2.1 Anatoma de un componente\n\nLos componentes, como el resto de artefactos en Angular, sern **clases TypeScript decoradas** con funciones especficas. En este caso la funcin es `@Component()` que recibe un objeto de definicin de componente. Igual que en el caso de los mdulos contiene las propiedades en las que configurar el componente.\n\n```typescript\nimport { Core } from '@angular/core';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styles: []\n})\nexport class AppComponent {}\n```\n\n**Los componentes definen nuevas etiquetas HTML** para ser usados dentro de otros componentes. Excepcionalmente en este caso por ser el componente raz se consume en el pgina `index.html`. El nombre de la nueva etiqueta se conoce como _selector_. En este caso la propiedad `selector: \"app-root\"` permite el uso de este componente dentro de otro con esta invocacin `<app-root></app-root>`. En este caso el componente raz.\n\n> Particularidades del componente raz. Su nombre oficial es `AppComponent`, y su selector debera llamarse `app-app`. Pero su _selector real_ es `app-root`, formado a partir del prefijo de la aplicacin y su supuesto nombre oficioso. Observa el prefijo `app` que se usar en todos los componentes propios, fue asignado por defecto durante la generacin de la aplicacin. Puede personalizarse usando el modificador `--prefix` de `ng new` y en distintos ficheros de configuracin. Volviendo al componente raz; est destinado a ser usado en la pgina principal, en el `index.html`. Eso obliga a registrarlo de una manera especial en el mdulo raz. Hay que incluirlo en el array `bootstrap: [AppComponent]`, es ah donde se incluyen los componentes con la capacidad de lanzar _bootstrap_ la aplicacin.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, CoreModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\nY en el `index.html`\n\n```html\n<body>\n  <app-root></app-root>\n</body>\n```\n\n**La plantilla representa la parte visual** del componente. De forma simplificada, o cuando tiene poco contenido, puede escribirse directamente en la propiedad `template` del objeto decorador. Pero es ms frecuente encontrar la plantilla en su propio fichero _html_ y referenciarlo como una ruta relativa en la propiedad `templateUrl`.\n\nLa propiedad **`styles` y su gemela `stylesUrl` permiten asignar estilos** _CSS, SASS o LESS_ al componente. Estos estilos se incrustan durante la compilacin en los nodos del _DOM_ generado. Son exclusivos del componente y facilitan el diseo y maquetacin granular de las aplicaciones.\n\nLos estilos, ausentes en este ejemplo, podran incluirse como un array de cadenas, o llevarse a un fichero propio como en el caso de la vista.\n\n```html\n<div style=\"text-align:center\">\n  <h1>Welcome to {{ title }}!</h1>\n  <img width=\"100\" src=\"./assets/logo.png\" />\n</div>\n...\n```\n\n**En la clase del componente nos encontraremos la implementacin de su funcionalidad**. Normalmente expondr propiedades y mtodos para ser consumidos e invocados de forma declarativa desde la vista.\n\nUna aplicacin web en Angular se monta como un **rbol de componentes**. El componente raz ya viene creado y convenientemente declarado; ahora toca darle contenido mediante una estructura de pgina y las vistas funcionales.\n\n## 2.2 Generacin de componentes\n\nPara **crear nuevos componentes** vamos a usar de nuevo el comando `generate` del _CLI_ . Pero ahora con los planos para construir un componente. La [sintaxis completa](https://angular.io/cli/generate#component-command) del comando `ng generate component` o abreviadamente `ng g c` permite crear componentes en diversas formas.\n\nCasi **todas las pginas tienen una estructura** similar que de forma simplista queda en tres componentes. Uno para la barra de navegacin, otro para el pie de pgina y otro intermedio para el contenido principal.\n\nEjecuta en una terminal estos comandos para que generen los componentes y comprueba el resultado en el editor.\n\n```shell\nng g c core/shell\nng g c core/shell/header\nng g c core/shell/main\nng g c core/shell/footer\n```\n\nFjate en el componente del fichero `shell.component.ts`. Su estructura es igual a la del componente raz. Destaca que el nombre del componente coincide con el nombre del selector: `app-shell` y `ShellComponent`. Esto ser lo normal a partir de ahora. Slo el componente raz tiene la excepcin de que su nombre `App` no coincide con su selector `root`.\n\n```typescript\nimport { Component, OnInit } from '@angular/core';\n@Component({\n  selector: 'app-shell',\n  templateUrl: './shell.component.html',\n  styles: []\n})\nexport class ShellComponent implements OnInit {\n  constructor() {}\n  ngOnInit() {}\n}\n```\n\nY esta es su vista asociada. La cual es de nuevo una composicin de otros selectores. Estamos creando un frondoso rbol de componentes.\n\n```html\n<app-header></app-header>\n<app-main></app-main>\n<app-footer></app-footer>\n```\n\n# 3 Visibilidad entre componentes\n\nLa clave del cdigo limpio es **exponer funcionalidad de manera expresiva pero ocultar la implementacin**. Esto es sencillo con los lenguajes de POO, pero en HTML no era nada fcil. Con la **programacin basada en componentes** podemos crear pantallas complejas, reutilizables y que a su vez contengan y oculten la complejidad interna a sus consumidores.\n\n## 3.1 Componentes pblicos y privados\n\nLos componentes no deciden por s mismos su **visibilidad**. Cuando un componente es generado se declara en un mdulo contenedor en su propiedad `declares:[]`. Eso lo hace visible y utilizable por cualquier otro componente del mismo mdulo. Pero **si quieres usarlo desde fuera tendrs que exportarlo**. Eso se hace en la propiedad `exports:[]` del mdulo en el que se crea.\n\nLa exportacin debe hacerse a mano incluyendo el componente en el array, o indicarse con el _flag_ `--export` para que lo haga el _cli_. Esto es lo que se ha hecho en el mdulo _Core_ para poder exportar el componente `shell`.\n\n```typescript\n@NgModule({\n  declarations: [ShellComponent, HeaderComponent, MainComponent, FooterComponent],\n  imports: [CommonModule, RouterModule],\n  exports: [ShellComponent]\n})\nexport class CoreModule {}\n```\n\n> **Los componentes privados suelen ser sencillos**. A veces son creados para ser especficamente consumidos dentro de otros componentes. En esas situaciones interesa que sean privados y que generen poco ruido. Incluso, en casos extremadamente simples, si usamos el modificador `--flat` ni siquiera generan carpeta propia.\n\nPor supuesto que `HeaderComponent` necesitar la propiedad `title` y tambin la moveremos desde `app.component.ts`. Dejando de esa manera el componente raz en los huesos.\n\n## 3.2 Importacin y exportacin entre mdulos\n\nQue un componente sea pblico es la primera condicin para que se consuma fuera de su mdulo. Ahora falta que quin lo quiera usar el selector `<app-shell>` importe su mdulo `CoreModule`. Esto lo haremos en el `AppModule` para que lo use el `AppComponent`.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, CoreModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\nComo regla general, **cuando en una plantilla se incruste otro componente**, Angular lo buscar dentro del propio mdulo en el que pretende usarse. Si no lo encuentra entonces lo buscar entre los componentes exportados por los mdulos que hayan sido importados por el actual contenedor.\n\n> Ahora mismo en `AppComponente` slo puedo usar a `ShellComponent`, que es el nico componente accesible. En `ShellComponent` se pueden usar sus vecinos _Header, Main y Footer_. Es un prctica recomendada el mantener el `AppModule` y el `AppComponent` tan simples como sea posible. Para ello movemos todo lo que podemos al mdulo de ayuda `CoreModule` distribuyendo el contenido de `app.component.html` en las plantillas de _Header, Main y Footer_ que corresponda.\n\n### 3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript\n\nSi es la primera vez que ves cdigo TypeScript te llamarn la atencin las primeras lneas de cada fichero. En el `app.module.ts` son algo as:\n\n```typescript\nimport { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\n```\n\nEstas **sentencias de importacin son propias del lenguaje** y nada tienen que ver con Angular. En ellas se indica que este fichero importa el contenido de otros ficheros _TypeScript_. La importacin se realiza en base a convenios personalizables. Si empieza con `./` entonces se busca a travs de la ruta fsica relativa al fichero actual. En otro caso se busca en el directorio `node_modules` y se trata como cdigo de terceros.\n\n> En general no tendrs que preocuparte de estas importaciones fsicas, pues el _VSCode_ y las extensiones esenciales se encargan de hacerlo automticamente segn lo uses en tu cdigo\n\n# 4. Transitividad y Organizacin\n\n## 4.1 Transitividad en una cadena de mdulos\n\nUn problema que reforzar tu conocimiento sobre el sistema modular surgir al mover la etiqueta `<router-outlet></router-outlet>` del `app.component.html` al componente _Main_. En su vista `main.component.html` tendrs algo as.\n\n```html\n<h2>Here are some links to help you start:</h2>\n<ul>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://angular.io/tutorial\">Tour of Heroes</a></h2>\n  </li>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://angular.io/cli\">CLI Documentation</a></h2>\n  </li>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://blog.angular.io/\">Angular blog</a></h2>\n  </li>\n</ul>\n<router-outlet></router-outlet>\n```\n\nTodo son etiquetas _html_ estndar salvo la ltima `<router-outlet></router-outlet>`. El propsito de este componte lo veremos en la prxima leccin dedicada a enrutado. Pero por ahora ms que una ayuda es un dolor de cabeza porque es un desconocido para el mdulo `CoreModule`. Resulta que el `RouterOutletComponent` est declarado en un mdulo del _framework_ llamado `RouterModule`. Dicho mdulo fue importado de manera automtica durante la generacin del cdigo inicial, pero Dnde?.\n\nComo digo el tema del enrutado es un [captulo aparte](../paginas-y-rutas-angular-spa/), pero las relaciones de los mdulos debes conocerlas cuanto antes. Durante la generacin inicial se crearon dos mdulos: el `AppModule`, ya estudiado, y su asistente para enrutado `AppRoutingModule`. Este ltimo an no lo hemos visitado. Su contenido es:\n\n```typescript\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nconst routes: Routes = [];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nObviando la por ahora intil instruccin `.forRoutes(routes)`, llama la atencin que este mdulo es dependiente del famoso `RouterModule`, es decir lo importa en su array `imports:[]`. Pero adems va y lo exporta haciendo uso de la interesante **propiedad transitiva de los mdulos**. Cada mdulo puede exportar sus propios componentes o los de terceros. Incluso puede exportar todo un mdulo al completo. Al hacerlo as, el `AppRoutingModule` estaba poniendo a disposicin del `AppModule` todo el contenido de `RouterModule`, incluido el por ahora fastidioso `RouterOutletComponent`.\n\nPero el mdulo _Core_ no importa al _AppRouting_, as que nada sabe de un selector llamado _router-outlet_. Para solucionarlo slo puedes hacer una cosa: importar al `RouterModule` en el `CoreModule`, que quedar as:\n\n```typescript\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { FooterComponent } from './shell/footer/footer.component';\nimport { HeaderComponent } from './shell/header/header.component';\nimport { MainComponent } from './shell/main/main.component';\nimport { ShellComponent } from './shell/shell.component';\n\n@NgModule({\n  declarations: [ShellComponent, HeaderComponent, MainComponent, FooterComponent],\n  imports: [CommonModule, RouterModule],\n  exports: [ShellComponent]\n})\nexport class CoreModule {}\n```\n\n## 4.2 Organizacin de la aplicacin en mdulos\n\nTodos los programas tiene partes repetitivas. Los principios de **organizacin y cdigo limpio** nos permiten identificarlas y reutilizarlas. Con los componentes ocurre lo mismo. El mdulo y los componentes recin creados suelen ser comunes a casi todas las aplicaciones. Estos y otros muchos surgirn de manera natural durante el desarrollo de una aplicacin para ser utilizados en mltiples pginas.\n\nSon **componentes de infraestructura**. Conviene guardarlos en una carpeta especial. Aqu la he llamado _shared_, pero _tools_, _common_, o _lib_ suelen ser otros nombres habituales. Para reforzar el uso del CLI escribe el siguiente comando que aprovecharemos en el futuro.\n\n```bash\nng g m shared\n```\n\n> Por ahora djalo hurfano, no lo importaremos hasta que tengamos mdulos funcionales. Slo anticiparte que es un mdulo dnde se hace mucho uso de la propiedad transitiva del sistema modular de Angular.\n\nEl caso es **distinguir los componentes de infraestructura de los de negocio** o funcionalidad. Los mdulos _core_ y _shared_ los trataremos como de infraestructura y todos los dems sern de negocio (an no tenemos). El primero es para meter cosas de uso nico esenciales para la aplicacin. El segundo para meter bloques reutilizables durante la construccin de la aplicacin. Recuerda que slo son convenios de arquitectura de software; adptalos a tus necesidades.\n\n> En esta aplicacin hasta ahora no es nada funcional,!y ya tiene seis mdulos y seis componentes!. Puede parecer sobre-ingeniera, pero a la larga le vers sentido. Por ahora te permitir practicar con la creacin de mdulos y componentes.\n\n### El bosque de mdulos a vista de pjaro\n\n```\nAppModule\n|\n+--AppRoutingModule\n|  |\n|  +--RouterModule\n|\n+--BrowseModule\n|\n+--CoreModule\n   |\n   +--RouterModule\n\nSharedModule\n\n```\n\n### El bosque de componentes a vista de pjaro\n\n```\nAppComponent\n|\n+--ShellComponent\n   |\n   +--HeaderComponent\n   |\n   +--MainComponent\n   |  |\n   |  +--RouterOutletComponent\n   |\n   +--FooterComponent\n\n```\n\nCon esto tendrs una base para una aplicacin _Angular 7_. Sigue esta serie para aadirle funcionalidad mediante [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/) mientras aprendes a programar con Angular7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng_1-Base-aplicacion-Angular.md","raw":"---\ntitle: Base para una aplicacin Angular\npermalink: base-aplicacion-angular\ndate: 2019-01-16 11:57:00\ntags:\n  - Angular\n  - CLI\n  - Tutorial\n  - Introduccin\n  - Angular7\n  - Angular2\ncategories:\n  - [Tutorial, Angular]\nthumbnail: /css/images/angular-1_base.png\n---\n\n![base-aplicacion-angular](/images/tutorial-angular-1_base.png)\n\nVamos a crear una **base sobre la que programar una aplicacin Angular 7** profesional. Usaremos el _CLI_ para generar una estructura sobre la que crecer. Ser como una semilla para un desarrollo controlado.\nLa idea de rbol se usa en muchas analogas informticas. La emplearemos en dos conceptos bsicos en Angular: **los mdulos y los componentes**.\n\n<!-- more -->\n\nPartimos de la aplicacin tal cmo la dejamos en el [Hola Mundo en Angular](../hola-angular-cli/). Al finalizar tendrs un esqueleto del que colgar mdulos y componentes funcionales.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/1-base](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app)\n\n# 1. Mdulos\n\nLos mdulos son **contenedores para almacenar los componentes y servicios** de una aplicacin. En Angular cada programa se puede ver como un rbol de mdulos jerrquico. A partir de un mdulo raz se enlazan otros mdulos en un proceso llamado importacin.\n\n## 1.1 Anatoma de un mdulo\n\nAntes de usar cualquier mdulo hay que conocerlo. En Angular **los mdulos de declaran como clases de TypeScript**. Estas clases, habitualmente vacas, son decoradas con una funcin especial. Es la funcin `@NgModule()` que recibe un objeto como nico argumento. En las propiedades de ese objeto es donde se configura el mdulo.\n\nMira el mdulo `AppModule` original que genera el CLI en el fichero `app.module.ts`.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\n### 1.1.1 Importacin de otros mdulos\n\nEl mdulo `App` tambin se conoce como **mdulo raz** porque de l surgen las dems ramas que conforman una aplicacin. La asignacin de los nodos hijos se realiza en la propiedad `imports:[]`, que es un array de punteros a otros mdulos.\n\n> En la situacin original el mdulo principal depende un mdulo _custom_ pre-generado (el `AppRoutingModule` que usars ms adelante) y de otro _del framework_ para la presentacin en el navegador (el `BrowserModule`).\n\nVeremos esto con ms profundidad en el punto 4.\n\n## 1.2 Generacin de mdulos\n\nHasta ahora los mdulos involucrados son libreras de terceros o que se crearon mgicamente con la aplicacin. Es hora de **crear tu primer mdulo**. Para eso usaremos otro comando del _cli_, el `ng generate module`. En una ventana del terminal escribe:\n\n```bash\nng g m core\n```\n\nEsta es la sintaxis abreviada del comando [`ng generate`](https://angular.io/cli/generate) el cual dispone de varios planos de construccin o _blueprints_. El que he usado aqu es el de [`module`](https://angular.io/cli/generate#module-command) para la construccin de mdulos.\n\n> Si no te gusta teclear en la terminal, tambin puedes lanzar estos comandos desde [Angular Console](https://angularconsole.com/)\n\nEl resultado es la creacin del fichero `core/core.module.ts` con la declaracin y decoracin del mdulo `CoreModule`.\nEste mdulo te servir de **contenedor para guardar componentes** y otros servicios esenciales para nuestra aplicacin. Pero eso lo veremos ms adelante.\n\n```typescript\n@NgModule({\n  imports: [],\n  declarations: []\n})\nexport class CoreModule {}\n```\n\nPor ahora hay que asegurar que **este mdulo ser importado por el raz, el AppModule**. Para ello comprobaremos que la lnea de importacin del mdulo principal est parecida a esto:\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, CoreModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\n> El mdulo raz, al igual que como vers ms tarde con el componente raz, es un tanto especial. Su nombre oficial es App, aunque todo la documentacin se refiere a l como raz o root.\n\n# 2. Componentes\n\nLos mdulos son contenedores. Lo primero que vamos a guardar en ellos sern componentes. **Los componentes son los bloques bsicos de construccin de las pginas web en Angular 7**. Contienen una parte visual en html (la Vista) y una funcional en Typescript (el Controlador).\n\n> La aplicacin original que crea el CLI nos regala un primer componente de ejemplo en el fichero `app.component.ts`. Segn la configuracin del CLI este componente puede haber sido creado en un slo fichero o hasta cuatro: (el controlador, con la vista y los estilos en ficheros propios y fichero extra para pruebas unitarias).\n\n## 2.1 Anatoma de un componente\n\nLos componentes, como el resto de artefactos en Angular, sern **clases TypeScript decoradas** con funciones especficas. En este caso la funcin es `@Component()` que recibe un objeto de definicin de componente. Igual que en el caso de los mdulos contiene las propiedades en las que configurar el componente.\n\n```typescript\nimport { Core } from '@angular/core';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styles: []\n})\nexport class AppComponent {}\n```\n\n**Los componentes definen nuevas etiquetas HTML** para ser usados dentro de otros componentes. Excepcionalmente en este caso por ser el componente raz se consume en el pgina `index.html`. El nombre de la nueva etiqueta se conoce como _selector_. En este caso la propiedad `selector: \"app-root\"` permite el uso de este componente dentro de otro con esta invocacin `<app-root></app-root>`. En este caso el componente raz.\n\n> Particularidades del componente raz. Su nombre oficial es `AppComponent`, y su selector debera llamarse `app-app`. Pero su _selector real_ es `app-root`, formado a partir del prefijo de la aplicacin y su supuesto nombre oficioso. Observa el prefijo `app` que se usar en todos los componentes propios, fue asignado por defecto durante la generacin de la aplicacin. Puede personalizarse usando el modificador `--prefix` de `ng new` y en distintos ficheros de configuracin. Volviendo al componente raz; est destinado a ser usado en la pgina principal, en el `index.html`. Eso obliga a registrarlo de una manera especial en el mdulo raz. Hay que incluirlo en el array `bootstrap: [AppComponent]`, es ah donde se incluyen los componentes con la capacidad de lanzar _bootstrap_ la aplicacin.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, CoreModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\nY en el `index.html`\n\n```html\n<body>\n  <app-root></app-root>\n</body>\n```\n\n**La plantilla representa la parte visual** del componente. De forma simplificada, o cuando tiene poco contenido, puede escribirse directamente en la propiedad `template` del objeto decorador. Pero es ms frecuente encontrar la plantilla en su propio fichero _html_ y referenciarlo como una ruta relativa en la propiedad `templateUrl`.\n\nLa propiedad **`styles` y su gemela `stylesUrl` permiten asignar estilos** _CSS, SASS o LESS_ al componente. Estos estilos se incrustan durante la compilacin en los nodos del _DOM_ generado. Son exclusivos del componente y facilitan el diseo y maquetacin granular de las aplicaciones.\n\nLos estilos, ausentes en este ejemplo, podran incluirse como un array de cadenas, o llevarse a un fichero propio como en el caso de la vista.\n\n```html\n<div style=\"text-align:center\">\n  <h1>Welcome to {{ title }}!</h1>\n  <img width=\"100\" src=\"./assets/logo.png\" />\n</div>\n...\n```\n\n**En la clase del componente nos encontraremos la implementacin de su funcionalidad**. Normalmente expondr propiedades y mtodos para ser consumidos e invocados de forma declarativa desde la vista.\n\nUna aplicacin web en Angular se monta como un **rbol de componentes**. El componente raz ya viene creado y convenientemente declarado; ahora toca darle contenido mediante una estructura de pgina y las vistas funcionales.\n\n## 2.2 Generacin de componentes\n\nPara **crear nuevos componentes** vamos a usar de nuevo el comando `generate` del _CLI_ . Pero ahora con los planos para construir un componente. La [sintaxis completa](https://angular.io/cli/generate#component-command) del comando `ng generate component` o abreviadamente `ng g c` permite crear componentes en diversas formas.\n\nCasi **todas las pginas tienen una estructura** similar que de forma simplista queda en tres componentes. Uno para la barra de navegacin, otro para el pie de pgina y otro intermedio para el contenido principal.\n\nEjecuta en una terminal estos comandos para que generen los componentes y comprueba el resultado en el editor.\n\n```shell\nng g c core/shell\nng g c core/shell/header\nng g c core/shell/main\nng g c core/shell/footer\n```\n\nFjate en el componente del fichero `shell.component.ts`. Su estructura es igual a la del componente raz. Destaca que el nombre del componente coincide con el nombre del selector: `app-shell` y `ShellComponent`. Esto ser lo normal a partir de ahora. Slo el componente raz tiene la excepcin de que su nombre `App` no coincide con su selector `root`.\n\n```typescript\nimport { Component, OnInit } from '@angular/core';\n@Component({\n  selector: 'app-shell',\n  templateUrl: './shell.component.html',\n  styles: []\n})\nexport class ShellComponent implements OnInit {\n  constructor() {}\n  ngOnInit() {}\n}\n```\n\nY esta es su vista asociada. La cual es de nuevo una composicin de otros selectores. Estamos creando un frondoso rbol de componentes.\n\n```html\n<app-header></app-header>\n<app-main></app-main>\n<app-footer></app-footer>\n```\n\n# 3 Visibilidad entre componentes\n\nLa clave del cdigo limpio es **exponer funcionalidad de manera expresiva pero ocultar la implementacin**. Esto es sencillo con los lenguajes de POO, pero en HTML no era nada fcil. Con la **programacin basada en componentes** podemos crear pantallas complejas, reutilizables y que a su vez contengan y oculten la complejidad interna a sus consumidores.\n\n## 3.1 Componentes pblicos y privados\n\nLos componentes no deciden por s mismos su **visibilidad**. Cuando un componente es generado se declara en un mdulo contenedor en su propiedad `declares:[]`. Eso lo hace visible y utilizable por cualquier otro componente del mismo mdulo. Pero **si quieres usarlo desde fuera tendrs que exportarlo**. Eso se hace en la propiedad `exports:[]` del mdulo en el que se crea.\n\nLa exportacin debe hacerse a mano incluyendo el componente en el array, o indicarse con el _flag_ `--export` para que lo haga el _cli_. Esto es lo que se ha hecho en el mdulo _Core_ para poder exportar el componente `shell`.\n\n```typescript\n@NgModule({\n  declarations: [ShellComponent, HeaderComponent, MainComponent, FooterComponent],\n  imports: [CommonModule, RouterModule],\n  exports: [ShellComponent]\n})\nexport class CoreModule {}\n```\n\n> **Los componentes privados suelen ser sencillos**. A veces son creados para ser especficamente consumidos dentro de otros componentes. En esas situaciones interesa que sean privados y que generen poco ruido. Incluso, en casos extremadamente simples, si usamos el modificador `--flat` ni siquiera generan carpeta propia.\n\nPor supuesto que `HeaderComponent` necesitar la propiedad `title` y tambin la moveremos desde `app.component.ts`. Dejando de esa manera el componente raz en los huesos.\n\n## 3.2 Importacin y exportacin entre mdulos\n\nQue un componente sea pblico es la primera condicin para que se consuma fuera de su mdulo. Ahora falta que quin lo quiera usar el selector `<app-shell>` importe su mdulo `CoreModule`. Esto lo haremos en el `AppModule` para que lo use el `AppComponent`.\n\n```typescript\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, AppRoutingModule, CoreModule],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n```\n\nComo regla general, **cuando en una plantilla se incruste otro componente**, Angular lo buscar dentro del propio mdulo en el que pretende usarse. Si no lo encuentra entonces lo buscar entre los componentes exportados por los mdulos que hayan sido importados por el actual contenedor.\n\n> Ahora mismo en `AppComponente` slo puedo usar a `ShellComponent`, que es el nico componente accesible. En `ShellComponent` se pueden usar sus vecinos _Header, Main y Footer_. Es un prctica recomendada el mantener el `AppModule` y el `AppComponent` tan simples como sea posible. Para ello movemos todo lo que podemos al mdulo de ayuda `CoreModule` distribuyendo el contenido de `app.component.html` en las plantillas de _Header, Main y Footer_ que corresponda.\n\n### 3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript\n\nSi es la primera vez que ves cdigo TypeScript te llamarn la atencin las primeras lneas de cada fichero. En el `app.module.ts` son algo as:\n\n```typescript\nimport { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\n```\n\nEstas **sentencias de importacin son propias del lenguaje** y nada tienen que ver con Angular. En ellas se indica que este fichero importa el contenido de otros ficheros _TypeScript_. La importacin se realiza en base a convenios personalizables. Si empieza con `./` entonces se busca a travs de la ruta fsica relativa al fichero actual. En otro caso se busca en el directorio `node_modules` y se trata como cdigo de terceros.\n\n> En general no tendrs que preocuparte de estas importaciones fsicas, pues el _VSCode_ y las extensiones esenciales se encargan de hacerlo automticamente segn lo uses en tu cdigo\n\n# 4. Transitividad y Organizacin\n\n## 4.1 Transitividad en una cadena de mdulos\n\nUn problema que reforzar tu conocimiento sobre el sistema modular surgir al mover la etiqueta `<router-outlet></router-outlet>` del `app.component.html` al componente _Main_. En su vista `main.component.html` tendrs algo as.\n\n```html\n<h2>Here are some links to help you start:</h2>\n<ul>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://angular.io/tutorial\">Tour of Heroes</a></h2>\n  </li>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://angular.io/cli\">CLI Documentation</a></h2>\n  </li>\n  <li>\n    <h2><a target=\"_blank\" rel=\"noopener\" href=\"https://blog.angular.io/\">Angular blog</a></h2>\n  </li>\n</ul>\n<router-outlet></router-outlet>\n```\n\nTodo son etiquetas _html_ estndar salvo la ltima `<router-outlet></router-outlet>`. El propsito de este componte lo veremos en la prxima leccin dedicada a enrutado. Pero por ahora ms que una ayuda es un dolor de cabeza porque es un desconocido para el mdulo `CoreModule`. Resulta que el `RouterOutletComponent` est declarado en un mdulo del _framework_ llamado `RouterModule`. Dicho mdulo fue importado de manera automtica durante la generacin del cdigo inicial, pero Dnde?.\n\nComo digo el tema del enrutado es un [captulo aparte](../paginas-y-rutas-angular-spa/), pero las relaciones de los mdulos debes conocerlas cuanto antes. Durante la generacin inicial se crearon dos mdulos: el `AppModule`, ya estudiado, y su asistente para enrutado `AppRoutingModule`. Este ltimo an no lo hemos visitado. Su contenido es:\n\n```typescript\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nconst routes: Routes = [];\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n```\n\nObviando la por ahora intil instruccin `.forRoutes(routes)`, llama la atencin que este mdulo es dependiente del famoso `RouterModule`, es decir lo importa en su array `imports:[]`. Pero adems va y lo exporta haciendo uso de la interesante **propiedad transitiva de los mdulos**. Cada mdulo puede exportar sus propios componentes o los de terceros. Incluso puede exportar todo un mdulo al completo. Al hacerlo as, el `AppRoutingModule` estaba poniendo a disposicin del `AppModule` todo el contenido de `RouterModule`, incluido el por ahora fastidioso `RouterOutletComponent`.\n\nPero el mdulo _Core_ no importa al _AppRouting_, as que nada sabe de un selector llamado _router-outlet_. Para solucionarlo slo puedes hacer una cosa: importar al `RouterModule` en el `CoreModule`, que quedar as:\n\n```typescript\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { FooterComponent } from './shell/footer/footer.component';\nimport { HeaderComponent } from './shell/header/header.component';\nimport { MainComponent } from './shell/main/main.component';\nimport { ShellComponent } from './shell/shell.component';\n\n@NgModule({\n  declarations: [ShellComponent, HeaderComponent, MainComponent, FooterComponent],\n  imports: [CommonModule, RouterModule],\n  exports: [ShellComponent]\n})\nexport class CoreModule {}\n```\n\n## 4.2 Organizacin de la aplicacin en mdulos\n\nTodos los programas tiene partes repetitivas. Los principios de **organizacin y cdigo limpio** nos permiten identificarlas y reutilizarlas. Con los componentes ocurre lo mismo. El mdulo y los componentes recin creados suelen ser comunes a casi todas las aplicaciones. Estos y otros muchos surgirn de manera natural durante el desarrollo de una aplicacin para ser utilizados en mltiples pginas.\n\nSon **componentes de infraestructura**. Conviene guardarlos en una carpeta especial. Aqu la he llamado _shared_, pero _tools_, _common_, o _lib_ suelen ser otros nombres habituales. Para reforzar el uso del CLI escribe el siguiente comando que aprovecharemos en el futuro.\n\n```bash\nng g m shared\n```\n\n> Por ahora djalo hurfano, no lo importaremos hasta que tengamos mdulos funcionales. Slo anticiparte que es un mdulo dnde se hace mucho uso de la propiedad transitiva del sistema modular de Angular.\n\nEl caso es **distinguir los componentes de infraestructura de los de negocio** o funcionalidad. Los mdulos _core_ y _shared_ los trataremos como de infraestructura y todos los dems sern de negocio (an no tenemos). El primero es para meter cosas de uso nico esenciales para la aplicacin. El segundo para meter bloques reutilizables durante la construccin de la aplicacin. Recuerda que slo son convenios de arquitectura de software; adptalos a tus necesidades.\n\n> En esta aplicacin hasta ahora no es nada funcional,!y ya tiene seis mdulos y seis componentes!. Puede parecer sobre-ingeniera, pero a la larga le vers sentido. Por ahora te permitir practicar con la creacin de mdulos y componentes.\n\n### El bosque de mdulos a vista de pjaro\n\n```\nAppModule\n|\n+--AppRoutingModule\n|  |\n|  +--RouterModule\n|\n+--BrowseModule\n|\n+--CoreModule\n   |\n   +--RouterModule\n\nSharedModule\n\n```\n\n### El bosque de componentes a vista de pjaro\n\n```\nAppComponent\n|\n+--ShellComponent\n   |\n   +--HeaderComponent\n   |\n   +--MainComponent\n   |  |\n   |  +--RouterOutletComponent\n   |\n   +--FooterComponent\n\n```\n\nCon esto tendrs una base para una aplicacin _Angular 7_. Sigue esta serie para aadirle funcionalidad mediante [Pginas y rutas Angular SPA](../paginas-y-rutas-angular-spa/) mientras aprendes a programar con Angular7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"base-aplicacion-angular","published":1,"updated":"2019-02-12T16:24:56.264Z","_id":"cjbrwpvji002biwd3ak7z4jrq","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-1_base.png\" alt=\"base-aplicacion-angular\"></p><p>Vamos a crear una <strong>base sobre la que programar una aplicacin Angular 7</strong> profesional. Usaremos el <em>CLI</em> para generar una estructura sobre la que crecer. Ser como una semilla para un desarrollo controlado.<br>La idea de rbol se usa en muchas analogas informticas. La emplearemos en dos conceptos bsicos en Angular: <strong>los mdulos y los componentes</strong>.</p><a id=\"more\"></a><p>Partimos de la aplicacin tal cmo la dejamos en el <a href=\"../hola-angular-cli/\">Hola Mundo en Angular</a>. Al finalizar tendrs un esqueleto del que colgar mdulos y componentes funcionales.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/1-base</a></p></blockquote><h1 id=\"1-Modulos\"><a href=\"#1-Modulos\" class=\"headerlink\" title=\"1. Mdulos\"></a>1. Mdulos</h1><p>Los mdulos son <strong>contenedores para almacenar los componentes y servicios</strong> de una aplicacin. En Angular cada programa se puede ver como un rbol de mdulos jerrquico. A partir de un mdulo raz se enlazan otros mdulos en un proceso llamado importacin.</p><h2 id=\"1-1-Anatomia-de-un-modulo\"><a href=\"#1-1-Anatomia-de-un-modulo\" class=\"headerlink\" title=\"1.1 Anatoma de un mdulo\"></a>1.1 Anatoma de un mdulo</h2><p>Antes de usar cualquier mdulo hay que conocerlo. En Angular <strong>los mdulos de declaran como clases de TypeScript</strong>. Estas clases, habitualmente vacas, son decoradas con una funcin especial. Es la funcin <code>@NgModule()</code> que recibe un objeto como nico argumento. En las propiedades de ese objeto es donde se configura el mdulo.</p><p>Mira el mdulo <code>AppModule</code> original que genera el CLI en el fichero <code>app.module.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id=\"1-1-1-Importacion-de-otros-modulos\"><a href=\"#1-1-1-Importacion-de-otros-modulos\" class=\"headerlink\" title=\"1.1.1 Importacin de otros mdulos\"></a>1.1.1 Importacin de otros mdulos</h3><p>El mdulo <code>App</code> tambin se conoce como <strong>mdulo raz</strong> porque de l surgen las dems ramas que conforman una aplicacin. La asignacin de los nodos hijos se realiza en la propiedad <code>imports:[]</code>, que es un array de punteros a otros mdulos.</p><blockquote><p>En la situacin original el mdulo principal depende un mdulo <em>custom</em> pre-generado (el <code>AppRoutingModule</code> que usars ms adelante) y de otro <em>del framework</em> para la presentacin en el navegador (el <code>BrowserModule</code>).</p></blockquote><p>Veremos esto con ms profundidad en el punto 4.</p><h2 id=\"1-2-Generacion-de-modulos\"><a href=\"#1-2-Generacion-de-modulos\" class=\"headerlink\" title=\"1.2 Generacin de mdulos\"></a>1.2 Generacin de mdulos</h2><p>Hasta ahora los mdulos involucrados son libreras de terceros o que se crearon mgicamente con la aplicacin. Es hora de <strong>crear tu primer mdulo</strong>. Para eso usaremos otro comando del <em>cli</em>, el <code>ng generate module</code>. En una ventana del terminal escribe:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m core</span><br></pre></td></tr></table></figure><p>Esta es la sintaxis abreviada del comando <a href=\"https://angular.io/cli/generate\" target=\"_blank\" rel=\"noopener\"><code>ng generate</code></a> el cual dispone de varios planos de construccin o <em>blueprints</em>. El que he usado aqu es el de <a href=\"https://angular.io/cli/generate#module-command\" target=\"_blank\" rel=\"noopener\"><code>module</code></a> para la construccin de mdulos.</p><blockquote><p>Si no te gusta teclear en la terminal, tambin puedes lanzar estos comandos desde <a href=\"https://angularconsole.com/\" target=\"_blank\" rel=\"noopener\">Angular Console</a></p></blockquote><p>El resultado es la creacin del fichero <code>core/core.module.ts</code> con la declaracin y decoracin del mdulo <code>CoreModule</code>.<br>Este mdulo te servir de <strong>contenedor para guardar componentes</strong> y otros servicios esenciales para nuestra aplicacin. Pero eso lo veremos ms adelante.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [],</span><br><span class=\"line\">  declarations: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CoreModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Por ahora hay que asegurar que <strong>este mdulo ser importado por el raz, el AppModule</strong>. Para ello comprobaremos que la lnea de importacin del mdulo principal est parecida a esto:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, CoreModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El mdulo raz, al igual que como vers ms tarde con el componente raz, es un tanto especial. Su nombre oficial es App, aunque todo la documentacin se refiere a l como raz o root.</p></blockquote><h1 id=\"2-Componentes\"><a href=\"#2-Componentes\" class=\"headerlink\" title=\"2. Componentes\"></a>2. Componentes</h1><p>Los mdulos son contenedores. Lo primero que vamos a guardar en ellos sern componentes. <strong>Los componentes son los bloques bsicos de construccin de las pginas web en Angular 7</strong>. Contienen una parte visual en html (la Vista) y una funcional en Typescript (el Controlador).</p><blockquote><p>La aplicacin original que crea el CLI nos regala un primer componente de ejemplo en el fichero <code>app.component.ts</code>. Segn la configuracin del CLI este componente puede haber sido creado en un slo fichero o hasta cuatro: (el controlador, con la vista y los estilos en ficheros propios y fichero extra para pruebas unitarias).</p></blockquote><h2 id=\"2-1-Anatomia-de-un-componente\"><a href=\"#2-1-Anatomia-de-un-componente\" class=\"headerlink\" title=\"2.1 Anatoma de un componente\"></a>2.1 Anatoma de un componente</h2><p>Los componentes, como el resto de artefactos en Angular, sern <strong>clases TypeScript decoradas</strong> con funciones especficas. En este caso la funcin es <code>@Component()</code> que recibe un objeto de definicin de componente. Igual que en el caso de los mdulos contiene las propiedades en las que configurar el componente.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Core &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'app-root'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./app.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;&#125;</span><br></pre></td></tr></table></figure><p><strong>Los componentes definen nuevas etiquetas HTML</strong> para ser usados dentro de otros componentes. Excepcionalmente en este caso por ser el componente raz se consume en el pgina <code>index.html</code>. El nombre de la nueva etiqueta se conoce como <em>selector</em>. En este caso la propiedad <code>selector: &quot;app-root&quot;</code> permite el uso de este componente dentro de otro con esta invocacin <code>&lt;app-root&gt;&lt;/app-root&gt;</code>. En este caso el componente raz.</p><blockquote><p>Particularidades del componente raz. Su nombre oficial es <code>AppComponent</code>, y su selector debera llamarse <code>app-app</code>. Pero su <em>selector real</em> es <code>app-root</code>, formado a partir del prefijo de la aplicacin y su supuesto nombre oficioso. Observa el prefijo <code>app</code> que se usar en todos los componentes propios, fue asignado por defecto durante la generacin de la aplicacin. Puede personalizarse usando el modificador <code>--prefix</code> de <code>ng new</code> y en distintos ficheros de configuracin. Volviendo al componente raz; est destinado a ser usado en la pgina principal, en el <code>index.html</code>. Eso obliga a registrarlo de una manera especial en el mdulo raz. Hay que incluirlo en el array <code>bootstrap: [AppComponent]</code>, es ah donde se incluyen los componentes con la capacidad de lanzar <em>bootstrap</em> la aplicacin.</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, CoreModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Y en el <code>index.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">app-root</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-root</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>La plantilla representa la parte visual</strong> del componente. De forma simplificada, o cuando tiene poco contenido, puede escribirse directamente en la propiedad <code>template</code> del objeto decorador. Pero es ms frecuente encontrar la plantilla en su propio fichero <em>html</em> y referenciarlo como una ruta relativa en la propiedad <code>templateUrl</code>.</p><p>La propiedad <strong><code>styles</code> y su gemela <code>stylesUrl</code> permiten asignar estilos</strong> <em>CSS, SASS o LESS</em> al componente. Estos estilos se incrustan durante la compilacin en los nodos del <em>DOM</em> generado. Son exclusivos del componente y facilitan el diseo y maquetacin granular de las aplicaciones.</p><p>Los estilos, ausentes en este ejemplo, podran incluirse como un array de cadenas, o llevarse a un fichero propio como en el caso de la vista.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"text-align:center\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Welcome to &#123;&#123; title &#125;&#125;!<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">width</span>=<span class=\"string\">\"100\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./assets/logo.png\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure><p><strong>En la clase del componente nos encontraremos la implementacin de su funcionalidad</strong>. Normalmente expondr propiedades y mtodos para ser consumidos e invocados de forma declarativa desde la vista.</p><p>Una aplicacin web en Angular se monta como un <strong>rbol de componentes</strong>. El componente raz ya viene creado y convenientemente declarado; ahora toca darle contenido mediante una estructura de pgina y las vistas funcionales.</p><h2 id=\"2-2-Generacion-de-componentes\"><a href=\"#2-2-Generacion-de-componentes\" class=\"headerlink\" title=\"2.2 Generacin de componentes\"></a>2.2 Generacin de componentes</h2><p>Para <strong>crear nuevos componentes</strong> vamos a usar de nuevo el comando <code>generate</code> del <em>CLI</em> . Pero ahora con los planos para construir un componente. La <a href=\"https://angular.io/cli/generate#component-command\" target=\"_blank\" rel=\"noopener\">sintaxis completa</a> del comando <code>ng generate component</code> o abreviadamente <code>ng g c</code> permite crear componentes en diversas formas.</p><p>Casi <strong>todas las pginas tienen una estructura</strong> similar que de forma simplista queda en tres componentes. Uno para la barra de navegacin, otro para el pie de pgina y otro intermedio para el contenido principal.</p><p>Ejecuta en una terminal estos comandos para que generen los componentes y comprueba el resultado en el editor.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c core/shell</span><br><span class=\"line\">ng g c core/shell/header</span><br><span class=\"line\">ng g c core/shell/main</span><br><span class=\"line\">ng g c core/shell/footer</span><br></pre></td></tr></table></figure><p>Fjate en el componente del fichero <code>shell.component.ts</code>. Su estructura es igual a la del componente raz. Destaca que el nombre del componente coincide con el nombre del selector: <code>app-shell</code> y <code>ShellComponent</code>. Esto ser lo normal a partir de ahora. Slo el componente raz tiene la excepcin de que su nombre <code>App</code> no coincide con su selector <code>root</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'app-shell'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./shell.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ShellComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y esta es su vista asociada. La cual es de nuevo una composicin de otros selectores. Estamos creando un frondoso rbol de componentes.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-header</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-header</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-main</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-main</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-footer</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-footer</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"3-Visibilidad-entre-componentes\"><a href=\"#3-Visibilidad-entre-componentes\" class=\"headerlink\" title=\"3 Visibilidad entre componentes\"></a>3 Visibilidad entre componentes</h1><p>La clave del cdigo limpio es <strong>exponer funcionalidad de manera expresiva pero ocultar la implementacin</strong>. Esto es sencillo con los lenguajes de POO, pero en HTML no era nada fcil. Con la <strong>programacin basada en componentes</strong> podemos crear pantallas complejas, reutilizables y que a su vez contengan y oculten la complejidad interna a sus consumidores.</p><h2 id=\"3-1-Componentes-publicos-y-privados\"><a href=\"#3-1-Componentes-publicos-y-privados\" class=\"headerlink\" title=\"3.1 Componentes pblicos y privados\"></a>3.1 Componentes pblicos y privados</h2><p>Los componentes no deciden por s mismos su <strong>visibilidad</strong>. Cuando un componente es generado se declara en un mdulo contenedor en su propiedad <code>declares:[]</code>. Eso lo hace visible y utilizable por cualquier otro componente del mismo mdulo. Pero <strong>si quieres usarlo desde fuera tendrs que exportarlo</strong>. Eso se hace en la propiedad <code>exports:[]</code> del mdulo en el que se crea.</p><p>La exportacin debe hacerse a mano incluyendo el componente en el array, o indicarse con el <em>flag</em> <code>--export</code> para que lo haga el <em>cli</em>. Esto es lo que se ha hecho en el mdulo <em>Core</em> para poder exportar el componente <code>shell</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [ShellComponent, HeaderComponent, MainComponent, FooterComponent],</span><br><span class=\"line\">  imports: [CommonModule, RouterModule],</span><br><span class=\"line\">  exports: [ShellComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CoreModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>Los componentes privados suelen ser sencillos</strong>. A veces son creados para ser especficamente consumidos dentro de otros componentes. En esas situaciones interesa que sean privados y que generen poco ruido. Incluso, en casos extremadamente simples, si usamos el modificador <code>--flat</code> ni siquiera generan carpeta propia.</p></blockquote><p>Por supuesto que <code>HeaderComponent</code> necesitar la propiedad <code>title</code> y tambin la moveremos desde <code>app.component.ts</code>. Dejando de esa manera el componente raz en los huesos.</p><h2 id=\"3-2-Importacion-y-exportacion-entre-modulos\"><a href=\"#3-2-Importacion-y-exportacion-entre-modulos\" class=\"headerlink\" title=\"3.2 Importacin y exportacin entre mdulos\"></a>3.2 Importacin y exportacin entre mdulos</h2><p>Que un componente sea pblico es la primera condicin para que se consuma fuera de su mdulo. Ahora falta que quin lo quiera usar el selector <code>&lt;app-shell&gt;</code> importe su mdulo <code>CoreModule</code>. Esto lo haremos en el <code>AppModule</code> para que lo use el <code>AppComponent</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, CoreModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Como regla general, <strong>cuando en una plantilla se incruste otro componente</strong>, Angular lo buscar dentro del propio mdulo en el que pretende usarse. Si no lo encuentra entonces lo buscar entre los componentes exportados por los mdulos que hayan sido importados por el actual contenedor.</p><blockquote><p>Ahora mismo en <code>AppComponente</code> slo puedo usar a <code>ShellComponent</code>, que es el nico componente accesible. En <code>ShellComponent</code> se pueden usar sus vecinos <em>Header, Main y Footer</em>. Es un prctica recomendada el mantener el <code>AppModule</code> y el <code>AppComponent</code> tan simples como sea posible. Para ello movemos todo lo que podemos al mdulo de ayuda <code>CoreModule</code> distribuyendo el contenido de <code>app.component.html</code> en las plantillas de <em>Header, Main y Footer</em> que corresponda.</p></blockquote><h3 id=\"3-2-1-Dos-mundos-paralelos-imports-de-Angular-e-import-de-TypeScript\"><a href=\"#3-2-1-Dos-mundos-paralelos-imports-de-Angular-e-import-de-TypeScript\" class=\"headerlink\" title=\"3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript\"></a>3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript</h3><p>Si es la primera vez que ves cdigo TypeScript te llamarn la atencin las primeras lneas de cada fichero. En el <code>app.module.ts</code> son algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; BrowserModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppRoutingModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app-routing.module'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.component'</span>;</span><br></pre></td></tr></table></figure><p>Estas <strong>sentencias de importacin son propias del lenguaje</strong> y nada tienen que ver con Angular. En ellas se indica que este fichero importa el contenido de otros ficheros <em>TypeScript</em>. La importacin se realiza en base a convenios personalizables. Si empieza con <code>./</code> entonces se busca a travs de la ruta fsica relativa al fichero actual. En otro caso se busca en el directorio <code>node_modules</code> y se trata como cdigo de terceros.</p><blockquote><p>En general no tendrs que preocuparte de estas importaciones fsicas, pues el <em>VSCode</em> y las extensiones esenciales se encargan de hacerlo automticamente segn lo uses en tu cdigo</p></blockquote><h1 id=\"4-Transitividad-y-Organizacion\"><a href=\"#4-Transitividad-y-Organizacion\" class=\"headerlink\" title=\"4. Transitividad y Organizacin\"></a>4. Transitividad y Organizacin</h1><h2 id=\"4-1-Transitividad-en-una-cadena-de-modulos\"><a href=\"#4-1-Transitividad-en-una-cadena-de-modulos\" class=\"headerlink\" title=\"4.1 Transitividad en una cadena de mdulos\"></a>4.1 Transitividad en una cadena de mdulos</h2><p>Un problema que reforzar tu conocimiento sobre el sistema modular surgir al mover la etiqueta <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code> del <code>app.component.html</code> al componente <em>Main</em>. En su vista <code>main.component.html</code> tendrs algo as.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Here are some links to help you start:<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://angular.io/tutorial\"</span>&gt;</span>Tour of Heroes<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://angular.io/cli\"</span>&gt;</span>CLI Documentation<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://blog.angular.io/\"</span>&gt;</span>Angular blog<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Todo son etiquetas <em>html</em> estndar salvo la ltima <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>. El propsito de este componte lo veremos en la prxima leccin dedicada a enrutado. Pero por ahora ms que una ayuda es un dolor de cabeza porque es un desconocido para el mdulo <code>CoreModule</code>. Resulta que el <code>RouterOutletComponent</code> est declarado en un mdulo del <em>framework</em> llamado <code>RouterModule</code>. Dicho mdulo fue importado de manera automtica durante la generacin del cdigo inicial, pero Dnde?.</p><p>Como digo el tema del enrutado es un <a href=\"../paginas-y-rutas-angular-spa/\">captulo aparte</a>, pero las relaciones de los mdulos debes conocerlas cuanto antes. Durante la generacin inicial se crearon dos mdulos: el <code>AppModule</code>, ya estudiado, y su asistente para enrutado <code>AppRoutingModule</code>. Este ltimo an no lo hemos visitado. Su contenido es:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Obviando la por ahora intil instruccin <code>.forRoutes(routes)</code>, llama la atencin que este mdulo es dependiente del famoso <code>RouterModule</code>, es decir lo importa en su array <code>imports:[]</code>. Pero adems va y lo exporta haciendo uso de la interesante <strong>propiedad transitiva de los mdulos</strong>. Cada mdulo puede exportar sus propios componentes o los de terceros. Incluso puede exportar todo un mdulo al completo. Al hacerlo as, el <code>AppRoutingModule</code> estaba poniendo a disposicin del <code>AppModule</code> todo el contenido de <code>RouterModule</code>, incluido el por ahora fastidioso <code>RouterOutletComponent</code>.</p><p>Pero el mdulo <em>Core</em> no importa al <em>AppRouting</em>, as que nada sabe de un selector llamado <em>router-outlet</em>. Para solucionarlo slo puedes hacer una cosa: importar al <code>RouterModule</code> en el <code>CoreModule</code>, que quedar as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; CommonModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; FooterComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./shell/footer/footer.component'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; HeaderComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./shell/header/header.component'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; MainComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./shell/main/main.component'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; ShellComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./shell/shell.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [ShellComponent, HeaderComponent, MainComponent, FooterComponent],</span><br><span class=\"line\">  imports: [CommonModule, RouterModule],</span><br><span class=\"line\">  exports: [ShellComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CoreModule &#123;&#125;</span><br></pre></td></tr></table></figure><h2 id=\"4-2-Organizacion-de-la-aplicacion-en-modulos\"><a href=\"#4-2-Organizacion-de-la-aplicacion-en-modulos\" class=\"headerlink\" title=\"4.2 Organizacin de la aplicacin en mdulos\"></a>4.2 Organizacin de la aplicacin en mdulos</h2><p>Todos los programas tiene partes repetitivas. Los principios de <strong>organizacin y cdigo limpio</strong> nos permiten identificarlas y reutilizarlas. Con los componentes ocurre lo mismo. El mdulo y los componentes recin creados suelen ser comunes a casi todas las aplicaciones. Estos y otros muchos surgirn de manera natural durante el desarrollo de una aplicacin para ser utilizados en mltiples pginas.</p><p>Son <strong>componentes de infraestructura</strong>. Conviene guardarlos en una carpeta especial. Aqu la he llamado <em>shared</em>, pero <em>tools</em>, <em>common</em>, o <em>lib</em> suelen ser otros nombres habituales. Para reforzar el uso del CLI escribe el siguiente comando que aprovecharemos en el futuro.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m shared</span><br></pre></td></tr></table></figure><blockquote><p>Por ahora djalo hurfano, no lo importaremos hasta que tengamos mdulos funcionales. Slo anticiparte que es un mdulo dnde se hace mucho uso de la propiedad transitiva del sistema modular de Angular.</p></blockquote><p>El caso es <strong>distinguir los componentes de infraestructura de los de negocio</strong> o funcionalidad. Los mdulos <em>core</em> y <em>shared</em> los trataremos como de infraestructura y todos los dems sern de negocio (an no tenemos). El primero es para meter cosas de uso nico esenciales para la aplicacin. El segundo para meter bloques reutilizables durante la construccin de la aplicacin. Recuerda que slo son convenios de arquitectura de software; adptalos a tus necesidades.</p><blockquote><p>En esta aplicacin hasta ahora no es nada funcional,!y ya tiene seis mdulos y seis componentes!. Puede parecer sobre-ingeniera, pero a la larga le vers sentido. Por ahora te permitir practicar con la creacin de mdulos y componentes.</p></blockquote><h3 id=\"El-bosque-de-modulos-a-vista-de-pajaro\"><a href=\"#El-bosque-de-modulos-a-vista-de-pajaro\" class=\"headerlink\" title=\"El bosque de mdulos a vista de pjaro\"></a>El bosque de mdulos a vista de pjaro</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AppModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--AppRoutingModule</span><br><span class=\"line\">|  |</span><br><span class=\"line\">|  +--RouterModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--BrowseModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--CoreModule</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--RouterModule</span><br><span class=\"line\"></span><br><span class=\"line\">SharedModule</span><br></pre></td></tr></table></figure><h3 id=\"El-bosque-de-componentes-a-vista-de-pajaro\"><a href=\"#El-bosque-de-componentes-a-vista-de-pajaro\" class=\"headerlink\" title=\"El bosque de componentes a vista de pjaro\"></a>El bosque de componentes a vista de pjaro</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AppComponent</span><br><span class=\"line\">|</span><br><span class=\"line\">+--ShellComponent</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--HeaderComponent</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--MainComponent</span><br><span class=\"line\">   |  |</span><br><span class=\"line\">   |  +--RouterOutletComponent</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--FooterComponent</span><br></pre></td></tr></table></figure><p>Con esto tendrs una base para una aplicacin <em>Angular 7</em>. Sigue esta serie para aadirle funcionalidad mediante <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a> mientras aprendes a programar con Angular7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-1_base.png\" alt=\"base-aplicacion-angular\"></p><p>Vamos a crear una <strong>base sobre la que programar una aplicacin Angular 7</strong> profesional. Usaremos el <em>CLI</em> para generar una estructura sobre la que crecer. Ser como una semilla para un desarrollo controlado.<br>La idea de rbol se usa en muchas analogas informticas. La emplearemos en dos conceptos bsicos en Angular: <strong>los mdulos y los componentes</strong>.</p>","more":"<p>Partimos de la aplicacin tal cmo la dejamos en el <a href=\"../hola-angular-cli/\">Hola Mundo en Angular</a>. Al finalizar tendrs un esqueleto del que colgar mdulos y componentes funcionales.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/1-base</a></p></blockquote><h1 id=\"1-Modulos\"><a href=\"#1-Modulos\" class=\"headerlink\" title=\"1. Mdulos\"></a>1. Mdulos</h1><p>Los mdulos son <strong>contenedores para almacenar los componentes y servicios</strong> de una aplicacin. En Angular cada programa se puede ver como un rbol de mdulos jerrquico. A partir de un mdulo raz se enlazan otros mdulos en un proceso llamado importacin.</p><h2 id=\"1-1-Anatomia-de-un-modulo\"><a href=\"#1-1-Anatomia-de-un-modulo\" class=\"headerlink\" title=\"1.1 Anatoma de un mdulo\"></a>1.1 Anatoma de un mdulo</h2><p>Antes de usar cualquier mdulo hay que conocerlo. En Angular <strong>los mdulos de declaran como clases de TypeScript</strong>. Estas clases, habitualmente vacas, son decoradas con una funcin especial. Es la funcin <code>@NgModule()</code> que recibe un objeto como nico argumento. En las propiedades de ese objeto es donde se configura el mdulo.</p><p>Mira el mdulo <code>AppModule</code> original que genera el CLI en el fichero <code>app.module.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id=\"1-1-1-Importacion-de-otros-modulos\"><a href=\"#1-1-1-Importacion-de-otros-modulos\" class=\"headerlink\" title=\"1.1.1 Importacin de otros mdulos\"></a>1.1.1 Importacin de otros mdulos</h3><p>El mdulo <code>App</code> tambin se conoce como <strong>mdulo raz</strong> porque de l surgen las dems ramas que conforman una aplicacin. La asignacin de los nodos hijos se realiza en la propiedad <code>imports:[]</code>, que es un array de punteros a otros mdulos.</p><blockquote><p>En la situacin original el mdulo principal depende un mdulo <em>custom</em> pre-generado (el <code>AppRoutingModule</code> que usars ms adelante) y de otro <em>del framework</em> para la presentacin en el navegador (el <code>BrowserModule</code>).</p></blockquote><p>Veremos esto con ms profundidad en el punto 4.</p><h2 id=\"1-2-Generacion-de-modulos\"><a href=\"#1-2-Generacion-de-modulos\" class=\"headerlink\" title=\"1.2 Generacin de mdulos\"></a>1.2 Generacin de mdulos</h2><p>Hasta ahora los mdulos involucrados son libreras de terceros o que se crearon mgicamente con la aplicacin. Es hora de <strong>crear tu primer mdulo</strong>. Para eso usaremos otro comando del <em>cli</em>, el <code>ng generate module</code>. En una ventana del terminal escribe:</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m core</span><br></pre></td></tr></table></figure><p>Esta es la sintaxis abreviada del comando <a href=\"https://angular.io/cli/generate\" target=\"_blank\" rel=\"noopener\"><code>ng generate</code></a> el cual dispone de varios planos de construccin o <em>blueprints</em>. El que he usado aqu es el de <a href=\"https://angular.io/cli/generate#module-command\" target=\"_blank\" rel=\"noopener\"><code>module</code></a> para la construccin de mdulos.</p><blockquote><p>Si no te gusta teclear en la terminal, tambin puedes lanzar estos comandos desde <a href=\"https://angularconsole.com/\" target=\"_blank\" rel=\"noopener\">Angular Console</a></p></blockquote><p>El resultado es la creacin del fichero <code>core/core.module.ts</code> con la declaracin y decoracin del mdulo <code>CoreModule</code>.<br>Este mdulo te servir de <strong>contenedor para guardar componentes</strong> y otros servicios esenciales para nuestra aplicacin. Pero eso lo veremos ms adelante.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [],</span><br><span class=\"line\">  declarations: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CoreModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Por ahora hay que asegurar que <strong>este mdulo ser importado por el raz, el AppModule</strong>. Para ello comprobaremos que la lnea de importacin del mdulo principal est parecida a esto:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, CoreModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El mdulo raz, al igual que como vers ms tarde con el componente raz, es un tanto especial. Su nombre oficial es App, aunque todo la documentacin se refiere a l como raz o root.</p></blockquote><h1 id=\"2-Componentes\"><a href=\"#2-Componentes\" class=\"headerlink\" title=\"2. Componentes\"></a>2. Componentes</h1><p>Los mdulos son contenedores. Lo primero que vamos a guardar en ellos sern componentes. <strong>Los componentes son los bloques bsicos de construccin de las pginas web en Angular 7</strong>. Contienen una parte visual en html (la Vista) y una funcional en Typescript (el Controlador).</p><blockquote><p>La aplicacin original que crea el CLI nos regala un primer componente de ejemplo en el fichero <code>app.component.ts</code>. Segn la configuracin del CLI este componente puede haber sido creado en un slo fichero o hasta cuatro: (el controlador, con la vista y los estilos en ficheros propios y fichero extra para pruebas unitarias).</p></blockquote><h2 id=\"2-1-Anatomia-de-un-componente\"><a href=\"#2-1-Anatomia-de-un-componente\" class=\"headerlink\" title=\"2.1 Anatoma de un componente\"></a>2.1 Anatoma de un componente</h2><p>Los componentes, como el resto de artefactos en Angular, sern <strong>clases TypeScript decoradas</strong> con funciones especficas. En este caso la funcin es <code>@Component()</code> que recibe un objeto de definicin de componente. Igual que en el caso de los mdulos contiene las propiedades en las que configurar el componente.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Core &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'app-root'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./app.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;&#125;</span><br></pre></td></tr></table></figure><p><strong>Los componentes definen nuevas etiquetas HTML</strong> para ser usados dentro de otros componentes. Excepcionalmente en este caso por ser el componente raz se consume en el pgina <code>index.html</code>. El nombre de la nueva etiqueta se conoce como <em>selector</em>. En este caso la propiedad <code>selector: &quot;app-root&quot;</code> permite el uso de este componente dentro de otro con esta invocacin <code>&lt;app-root&gt;&lt;/app-root&gt;</code>. En este caso el componente raz.</p><blockquote><p>Particularidades del componente raz. Su nombre oficial es <code>AppComponent</code>, y su selector debera llamarse <code>app-app</code>. Pero su <em>selector real</em> es <code>app-root</code>, formado a partir del prefijo de la aplicacin y su supuesto nombre oficioso. Observa el prefijo <code>app</code> que se usar en todos los componentes propios, fue asignado por defecto durante la generacin de la aplicacin. Puede personalizarse usando el modificador <code>--prefix</code> de <code>ng new</code> y en distintos ficheros de configuracin. Volviendo al componente raz; est destinado a ser usado en la pgina principal, en el <code>index.html</code>. Eso obliga a registrarlo de una manera especial en el mdulo raz. Hay que incluirlo en el array <code>bootstrap: [AppComponent]</code>, es ah donde se incluyen los componentes con la capacidad de lanzar <em>bootstrap</em> la aplicacin.</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, CoreModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Y en el <code>index.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">app-root</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-root</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>La plantilla representa la parte visual</strong> del componente. De forma simplificada, o cuando tiene poco contenido, puede escribirse directamente en la propiedad <code>template</code> del objeto decorador. Pero es ms frecuente encontrar la plantilla en su propio fichero <em>html</em> y referenciarlo como una ruta relativa en la propiedad <code>templateUrl</code>.</p><p>La propiedad <strong><code>styles</code> y su gemela <code>stylesUrl</code> permiten asignar estilos</strong> <em>CSS, SASS o LESS</em> al componente. Estos estilos se incrustan durante la compilacin en los nodos del <em>DOM</em> generado. Son exclusivos del componente y facilitan el diseo y maquetacin granular de las aplicaciones.</p><p>Los estilos, ausentes en este ejemplo, podran incluirse como un array de cadenas, o llevarse a un fichero propio como en el caso de la vista.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"text-align:center\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Welcome to &#123;&#123; title &#125;&#125;!<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">width</span>=<span class=\"string\">\"100\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./assets/logo.png\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure><p><strong>En la clase del componente nos encontraremos la implementacin de su funcionalidad</strong>. Normalmente expondr propiedades y mtodos para ser consumidos e invocados de forma declarativa desde la vista.</p><p>Una aplicacin web en Angular se monta como un <strong>rbol de componentes</strong>. El componente raz ya viene creado y convenientemente declarado; ahora toca darle contenido mediante una estructura de pgina y las vistas funcionales.</p><h2 id=\"2-2-Generacion-de-componentes\"><a href=\"#2-2-Generacion-de-componentes\" class=\"headerlink\" title=\"2.2 Generacin de componentes\"></a>2.2 Generacin de componentes</h2><p>Para <strong>crear nuevos componentes</strong> vamos a usar de nuevo el comando <code>generate</code> del <em>CLI</em> . Pero ahora con los planos para construir un componente. La <a href=\"https://angular.io/cli/generate#component-command\" target=\"_blank\" rel=\"noopener\">sintaxis completa</a> del comando <code>ng generate component</code> o abreviadamente <code>ng g c</code> permite crear componentes en diversas formas.</p><p>Casi <strong>todas las pginas tienen una estructura</strong> similar que de forma simplista queda en tres componentes. Uno para la barra de navegacin, otro para el pie de pgina y otro intermedio para el contenido principal.</p><p>Ejecuta en una terminal estos comandos para que generen los componentes y comprueba el resultado en el editor.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g c core/shell</span><br><span class=\"line\">ng g c core/shell/header</span><br><span class=\"line\">ng g c core/shell/main</span><br><span class=\"line\">ng g c core/shell/footer</span><br></pre></td></tr></table></figure><p>Fjate en el componente del fichero <code>shell.component.ts</code>. Su estructura es igual a la del componente raz. Destaca que el nombre del componente coincide con el nombre del selector: <code>app-shell</code> y <code>ShellComponent</code>. Esto ser lo normal a partir de ahora. Slo el componente raz tiene la excepcin de que su nombre <code>App</code> no coincide con su selector <code>root</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component, OnInit &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'app-shell'</span>,</span><br><span class=\"line\">  templateUrl: <span class=\"string\">'./shell.component.html'</span>,</span><br><span class=\"line\">  styles: []</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> ShellComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y esta es su vista asociada. La cual es de nuevo una composicin de otros selectores. Estamos creando un frondoso rbol de componentes.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-header</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-header</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-main</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-main</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-footer</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-footer</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"3-Visibilidad-entre-componentes\"><a href=\"#3-Visibilidad-entre-componentes\" class=\"headerlink\" title=\"3 Visibilidad entre componentes\"></a>3 Visibilidad entre componentes</h1><p>La clave del cdigo limpio es <strong>exponer funcionalidad de manera expresiva pero ocultar la implementacin</strong>. Esto es sencillo con los lenguajes de POO, pero en HTML no era nada fcil. Con la <strong>programacin basada en componentes</strong> podemos crear pantallas complejas, reutilizables y que a su vez contengan y oculten la complejidad interna a sus consumidores.</p><h2 id=\"3-1-Componentes-publicos-y-privados\"><a href=\"#3-1-Componentes-publicos-y-privados\" class=\"headerlink\" title=\"3.1 Componentes pblicos y privados\"></a>3.1 Componentes pblicos y privados</h2><p>Los componentes no deciden por s mismos su <strong>visibilidad</strong>. Cuando un componente es generado se declara en un mdulo contenedor en su propiedad <code>declares:[]</code>. Eso lo hace visible y utilizable por cualquier otro componente del mismo mdulo. Pero <strong>si quieres usarlo desde fuera tendrs que exportarlo</strong>. Eso se hace en la propiedad <code>exports:[]</code> del mdulo en el que se crea.</p><p>La exportacin debe hacerse a mano incluyendo el componente en el array, o indicarse con el <em>flag</em> <code>--export</code> para que lo haga el <em>cli</em>. Esto es lo que se ha hecho en el mdulo <em>Core</em> para poder exportar el componente <code>shell</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [ShellComponent, HeaderComponent, MainComponent, FooterComponent],</span><br><span class=\"line\">  imports: [CommonModule, RouterModule],</span><br><span class=\"line\">  exports: [ShellComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CoreModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>Los componentes privados suelen ser sencillos</strong>. A veces son creados para ser especficamente consumidos dentro de otros componentes. En esas situaciones interesa que sean privados y que generen poco ruido. Incluso, en casos extremadamente simples, si usamos el modificador <code>--flat</code> ni siquiera generan carpeta propia.</p></blockquote><p>Por supuesto que <code>HeaderComponent</code> necesitar la propiedad <code>title</code> y tambin la moveremos desde <code>app.component.ts</code>. Dejando de esa manera el componente raz en los huesos.</p><h2 id=\"3-2-Importacion-y-exportacion-entre-modulos\"><a href=\"#3-2-Importacion-y-exportacion-entre-modulos\" class=\"headerlink\" title=\"3.2 Importacin y exportacin entre mdulos\"></a>3.2 Importacin y exportacin entre mdulos</h2><p>Que un componente sea pblico es la primera condicin para que se consuma fuera de su mdulo. Ahora falta que quin lo quiera usar el selector <code>&lt;app-shell&gt;</code> importe su mdulo <code>CoreModule</code>. Esto lo haremos en el <code>AppModule</code> para que lo use el <code>AppComponent</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [AppComponent],</span><br><span class=\"line\">  imports: [BrowserModule, AppRoutingModule, CoreModule],</span><br><span class=\"line\">  providers: [],</span><br><span class=\"line\">  bootstrap: [AppComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Como regla general, <strong>cuando en una plantilla se incruste otro componente</strong>, Angular lo buscar dentro del propio mdulo en el que pretende usarse. Si no lo encuentra entonces lo buscar entre los componentes exportados por los mdulos que hayan sido importados por el actual contenedor.</p><blockquote><p>Ahora mismo en <code>AppComponente</code> slo puedo usar a <code>ShellComponent</code>, que es el nico componente accesible. En <code>ShellComponent</code> se pueden usar sus vecinos <em>Header, Main y Footer</em>. Es un prctica recomendada el mantener el <code>AppModule</code> y el <code>AppComponent</code> tan simples como sea posible. Para ello movemos todo lo que podemos al mdulo de ayuda <code>CoreModule</code> distribuyendo el contenido de <code>app.component.html</code> en las plantillas de <em>Header, Main y Footer</em> que corresponda.</p></blockquote><h3 id=\"3-2-1-Dos-mundos-paralelos-imports-de-Angular-e-import-de-TypeScript\"><a href=\"#3-2-1-Dos-mundos-paralelos-imports-de-Angular-e-import-de-TypeScript\" class=\"headerlink\" title=\"3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript\"></a>3.2.1 Dos mundos paralelos: imports de Angular e import de TypeScript</h3><p>Si es la primera vez que ves cdigo TypeScript te llamarn la atencin las primeras lneas de cada fichero. En el <code>app.module.ts</code> son algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; BrowserModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppRoutingModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app-routing.module'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; AppComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./app.component'</span>;</span><br></pre></td></tr></table></figure><p>Estas <strong>sentencias de importacin son propias del lenguaje</strong> y nada tienen que ver con Angular. En ellas se indica que este fichero importa el contenido de otros ficheros <em>TypeScript</em>. La importacin se realiza en base a convenios personalizables. Si empieza con <code>./</code> entonces se busca a travs de la ruta fsica relativa al fichero actual. En otro caso se busca en el directorio <code>node_modules</code> y se trata como cdigo de terceros.</p><blockquote><p>En general no tendrs que preocuparte de estas importaciones fsicas, pues el <em>VSCode</em> y las extensiones esenciales se encargan de hacerlo automticamente segn lo uses en tu cdigo</p></blockquote><h1 id=\"4-Transitividad-y-Organizacion\"><a href=\"#4-Transitividad-y-Organizacion\" class=\"headerlink\" title=\"4. Transitividad y Organizacin\"></a>4. Transitividad y Organizacin</h1><h2 id=\"4-1-Transitividad-en-una-cadena-de-modulos\"><a href=\"#4-1-Transitividad-en-una-cadena-de-modulos\" class=\"headerlink\" title=\"4.1 Transitividad en una cadena de mdulos\"></a>4.1 Transitividad en una cadena de mdulos</h2><p>Un problema que reforzar tu conocimiento sobre el sistema modular surgir al mover la etiqueta <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code> del <code>app.component.html</code> al componente <em>Main</em>. En su vista <code>main.component.html</code> tendrs algo as.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>Here are some links to help you start:<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://angular.io/tutorial\"</span>&gt;</span>Tour of Heroes<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://angular.io/cli\"</span>&gt;</span>CLI Documentation<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"noopener\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://blog.angular.io/\"</span>&gt;</span>Angular blog<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Todo son etiquetas <em>html</em> estndar salvo la ltima <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>. El propsito de este componte lo veremos en la prxima leccin dedicada a enrutado. Pero por ahora ms que una ayuda es un dolor de cabeza porque es un desconocido para el mdulo <code>CoreModule</code>. Resulta que el <code>RouterOutletComponent</code> est declarado en un mdulo del <em>framework</em> llamado <code>RouterModule</code>. Dicho mdulo fue importado de manera automtica durante la generacin del cdigo inicial, pero Dnde?.</p><p>Como digo el tema del enrutado es un <a href=\"../paginas-y-rutas-angular-spa/\">captulo aparte</a>, pero las relaciones de los mdulos debes conocerlas cuanto antes. Durante la generacin inicial se crearon dos mdulos: el <code>AppModule</code>, ya estudiado, y su asistente para enrutado <code>AppRoutingModule</code>. Este ltimo an no lo hemos visitado. Su contenido es:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Routes, RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [];</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [RouterModule.forRoot(routes)],</span><br><span class=\"line\">  exports: [RouterModule]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppRoutingModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Obviando la por ahora intil instruccin <code>.forRoutes(routes)</code>, llama la atencin que este mdulo es dependiente del famoso <code>RouterModule</code>, es decir lo importa en su array <code>imports:[]</code>. Pero adems va y lo exporta haciendo uso de la interesante <strong>propiedad transitiva de los mdulos</strong>. Cada mdulo puede exportar sus propios componentes o los de terceros. Incluso puede exportar todo un mdulo al completo. Al hacerlo as, el <code>AppRoutingModule</code> estaba poniendo a disposicin del <code>AppModule</code> todo el contenido de <code>RouterModule</code>, incluido el por ahora fastidioso <code>RouterOutletComponent</code>.</p><p>Pero el mdulo <em>Core</em> no importa al <em>AppRouting</em>, as que nada sabe de un selector llamado <em>router-outlet</em>. Para solucionarlo slo puedes hacer una cosa: importar al <code>RouterModule</code> en el <code>CoreModule</code>, que quedar as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; CommonModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; NgModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; RouterModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/router'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; FooterComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./shell/footer/footer.component'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; HeaderComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./shell/header/header.component'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; MainComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./shell/main/main.component'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; ShellComponent &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./shell/shell.component'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [ShellComponent, HeaderComponent, MainComponent, FooterComponent],</span><br><span class=\"line\">  imports: [CommonModule, RouterModule],</span><br><span class=\"line\">  exports: [ShellComponent]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> CoreModule &#123;&#125;</span><br></pre></td></tr></table></figure><h2 id=\"4-2-Organizacion-de-la-aplicacion-en-modulos\"><a href=\"#4-2-Organizacion-de-la-aplicacion-en-modulos\" class=\"headerlink\" title=\"4.2 Organizacin de la aplicacin en mdulos\"></a>4.2 Organizacin de la aplicacin en mdulos</h2><p>Todos los programas tiene partes repetitivas. Los principios de <strong>organizacin y cdigo limpio</strong> nos permiten identificarlas y reutilizarlas. Con los componentes ocurre lo mismo. El mdulo y los componentes recin creados suelen ser comunes a casi todas las aplicaciones. Estos y otros muchos surgirn de manera natural durante el desarrollo de una aplicacin para ser utilizados en mltiples pginas.</p><p>Son <strong>componentes de infraestructura</strong>. Conviene guardarlos en una carpeta especial. Aqu la he llamado <em>shared</em>, pero <em>tools</em>, <em>common</em>, o <em>lib</em> suelen ser otros nombres habituales. Para reforzar el uso del CLI escribe el siguiente comando que aprovecharemos en el futuro.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m shared</span><br></pre></td></tr></table></figure><blockquote><p>Por ahora djalo hurfano, no lo importaremos hasta que tengamos mdulos funcionales. Slo anticiparte que es un mdulo dnde se hace mucho uso de la propiedad transitiva del sistema modular de Angular.</p></blockquote><p>El caso es <strong>distinguir los componentes de infraestructura de los de negocio</strong> o funcionalidad. Los mdulos <em>core</em> y <em>shared</em> los trataremos como de infraestructura y todos los dems sern de negocio (an no tenemos). El primero es para meter cosas de uso nico esenciales para la aplicacin. El segundo para meter bloques reutilizables durante la construccin de la aplicacin. Recuerda que slo son convenios de arquitectura de software; adptalos a tus necesidades.</p><blockquote><p>En esta aplicacin hasta ahora no es nada funcional,!y ya tiene seis mdulos y seis componentes!. Puede parecer sobre-ingeniera, pero a la larga le vers sentido. Por ahora te permitir practicar con la creacin de mdulos y componentes.</p></blockquote><h3 id=\"El-bosque-de-modulos-a-vista-de-pajaro\"><a href=\"#El-bosque-de-modulos-a-vista-de-pajaro\" class=\"headerlink\" title=\"El bosque de mdulos a vista de pjaro\"></a>El bosque de mdulos a vista de pjaro</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AppModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--AppRoutingModule</span><br><span class=\"line\">|  |</span><br><span class=\"line\">|  +--RouterModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--BrowseModule</span><br><span class=\"line\">|</span><br><span class=\"line\">+--CoreModule</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--RouterModule</span><br><span class=\"line\"></span><br><span class=\"line\">SharedModule</span><br></pre></td></tr></table></figure><h3 id=\"El-bosque-de-componentes-a-vista-de-pajaro\"><a href=\"#El-bosque-de-componentes-a-vista-de-pajaro\" class=\"headerlink\" title=\"El bosque de componentes a vista de pjaro\"></a>El bosque de componentes a vista de pjaro</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AppComponent</span><br><span class=\"line\">|</span><br><span class=\"line\">+--ShellComponent</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--HeaderComponent</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--MainComponent</span><br><span class=\"line\">   |  |</span><br><span class=\"line\">   |  +--RouterOutletComponent</span><br><span class=\"line\">   |</span><br><span class=\"line\">   +--FooterComponent</span><br></pre></td></tr></table></figure><p>Con esto tendrs una base para una aplicacin <em>Angular 7</em>. Sigue esta serie para aadirle funcionalidad mediante <a href=\"../paginas-y-rutas-angular-spa/\">Pginas y rutas Angular SPA</a> mientras aprendes a programar con Angular7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"npm: de instalador a publicador","id":"10","updated":"2016-04-19T05:01:25.000Z","date":"2016-04-18T14:07:46.000Z","_content":"\nSeguro que ests harto de repetir la mtica instruccin `npm install paquete-x` Pero, has pensado en **publicar tus propios mdulos**?. Es muy recomendable crear soluciones distribuidas y muy fcil publicarlas en [*npm*](https://www.npmjs.com/). \n\nSigue este proceso y te convertirs en un creador de paquetes para *npm* : \n\n## Programa\n\nTodo empieza por tener una necesidad y resolverla **encapsulando su cdigo en un mdulo.** Por supuesto que ese mdulo puede requerir paquetes externos. Y por supuesto que tu cdigo puede, y debe, escribirse en varios mdulos. \n\nAntes de continuar vamos a fijar un par de conceptos:\n\n**- mdulo:** Fichero *.js* que exporta un funcionalidad y oculta su implementacin.\n\n**- paquete:** Uno o ms mdulos, con sus dependientes de otros paquetes que proponen una solucin reutilizable.\n\nConocidos los ingredientes, la receta es sencilla:\n\n1. Debes crear un proyecto para el paquete que vas a publicar. \n2. Has de subir el cdigo a un repositorio pblico. \n3. Y debes rellenar convenientemente el `package.json` de tu proyecto.\n\nEste es un ejemplo que he creado y [publicado en github](https://github.com/AgoraBinaria/ab-ftp) que te puede servir de base. \n\nPresta especial atencin al **nombrado** de tu proyecto porque ha de ser nico en el repositorio de npm. Para reducir riesgos de colisiones de nombre te recomiendo que utilices un *prefijo* con tus iniciales o las de tu empresa.\n\nNo te olvides de incluir un juego de **pruebas y documentacin** necesaria para sus uso.\n\n## Publica\n\nPuedes descargar libreras y herramienta desde el repositorio de *npm* de forma annima. De hecho, eso es lo ms corriente. Pero, como era de esperar, tienes que **registrarte para poder publicar** contenido. El [proceso de registro](https://www.npmjs.com/signup) va web es sencillo y grtis. \n\nUna vez verificado puedes hacer login en la web. Pero tambin en la terminal de tu ordenador: `npm login` te pedir el nombre de usuario y contrasea. A partir de es momento ests identificado y puedes usar las herramientas de autor:\n\n```\nnpm publish\n```\n\nPuedes encontrar [ms informacin](https://docs.npmjs.com/cli/publish) acerca de este mega comando en la documentacin de *npmjs*. Pero siguiendo la mxima de cuanto menos, mejor, la herramienta har con sus valores por defecto un publicacin y actualizacin limpias.\n\nLa clave est en que tu fichero de configuracin `package.json` sea correcto y lo ms completo posible. Escribe un completo `readme.md` que se convertir en portada de tu paquete en el repositorio de npm. Mira en mi ejemplo cmo [el contenido subido a github](https://github.com/AgoraBinaria/ab-ftp) se transforma y se ve en la [pgina de informacin de npm.](https://www.npmjs.com/package/ab-ftp)\n\n\nComprueba en un directorio vaco que `npm install nombre-de-tu-paquete` descarga todo lo necesario... y tmate un caf mientras ves crecer la hierba y las estadsticas de descargas.\n\n\n## Actualiza\n\nCon el tiempo mejorars y corregirs tu solucin. Te recomiendo que sigas el patrn de [nombrado de versiones semntico](http://semver.org/): \n\n**x.y.z = 1.2.3 = ruptura.mejora.parche** \n\nEs bueno que etiquetes tu repositorio con estas mismas versiones para que, una vez desplegadas, se encuentre con facilidad en *github*.\n\n```\ngit tag 0.1.2\ngit push --tags\n```\n\n\n## Disfruta\n\nFinalmente podrs utilizar ese cdigo en todas tus aplicaciones. Sera fantstico que adems otros lo encontrasen til. Y mejor an si te ayudan o al menos te proponen mejoras. Pero en cualquier caso **siempre habrs ganado**. El esfuerzo analtico que requiere se cobra con creces: dividiendo el problema, creando micro soluciones eficientes y reutilizando cdigo siempre es rentable.","source":"_posts/npm-de-instalador-a-publicador.md","raw":"---\ntitle: 'npm: de instalador a publicador'\ntags: \n- NodeJS\ncategories:\n- Avanzado \npermalink: npm-de-instalador-a-publicador\nid: 10\nupdated: '2016-04-19 07:01:25'\ndate: 2016-04-18 16:07:46\n---\n\nSeguro que ests harto de repetir la mtica instruccin `npm install paquete-x` Pero, has pensado en **publicar tus propios mdulos**?. Es muy recomendable crear soluciones distribuidas y muy fcil publicarlas en [*npm*](https://www.npmjs.com/). \n\nSigue este proceso y te convertirs en un creador de paquetes para *npm* : \n\n## Programa\n\nTodo empieza por tener una necesidad y resolverla **encapsulando su cdigo en un mdulo.** Por supuesto que ese mdulo puede requerir paquetes externos. Y por supuesto que tu cdigo puede, y debe, escribirse en varios mdulos. \n\nAntes de continuar vamos a fijar un par de conceptos:\n\n**- mdulo:** Fichero *.js* que exporta un funcionalidad y oculta su implementacin.\n\n**- paquete:** Uno o ms mdulos, con sus dependientes de otros paquetes que proponen una solucin reutilizable.\n\nConocidos los ingredientes, la receta es sencilla:\n\n1. Debes crear un proyecto para el paquete que vas a publicar. \n2. Has de subir el cdigo a un repositorio pblico. \n3. Y debes rellenar convenientemente el `package.json` de tu proyecto.\n\nEste es un ejemplo que he creado y [publicado en github](https://github.com/AgoraBinaria/ab-ftp) que te puede servir de base. \n\nPresta especial atencin al **nombrado** de tu proyecto porque ha de ser nico en el repositorio de npm. Para reducir riesgos de colisiones de nombre te recomiendo que utilices un *prefijo* con tus iniciales o las de tu empresa.\n\nNo te olvides de incluir un juego de **pruebas y documentacin** necesaria para sus uso.\n\n## Publica\n\nPuedes descargar libreras y herramienta desde el repositorio de *npm* de forma annima. De hecho, eso es lo ms corriente. Pero, como era de esperar, tienes que **registrarte para poder publicar** contenido. El [proceso de registro](https://www.npmjs.com/signup) va web es sencillo y grtis. \n\nUna vez verificado puedes hacer login en la web. Pero tambin en la terminal de tu ordenador: `npm login` te pedir el nombre de usuario y contrasea. A partir de es momento ests identificado y puedes usar las herramientas de autor:\n\n```\nnpm publish\n```\n\nPuedes encontrar [ms informacin](https://docs.npmjs.com/cli/publish) acerca de este mega comando en la documentacin de *npmjs*. Pero siguiendo la mxima de cuanto menos, mejor, la herramienta har con sus valores por defecto un publicacin y actualizacin limpias.\n\nLa clave est en que tu fichero de configuracin `package.json` sea correcto y lo ms completo posible. Escribe un completo `readme.md` que se convertir en portada de tu paquete en el repositorio de npm. Mira en mi ejemplo cmo [el contenido subido a github](https://github.com/AgoraBinaria/ab-ftp) se transforma y se ve en la [pgina de informacin de npm.](https://www.npmjs.com/package/ab-ftp)\n\n\nComprueba en un directorio vaco que `npm install nombre-de-tu-paquete` descarga todo lo necesario... y tmate un caf mientras ves crecer la hierba y las estadsticas de descargas.\n\n\n## Actualiza\n\nCon el tiempo mejorars y corregirs tu solucin. Te recomiendo que sigas el patrn de [nombrado de versiones semntico](http://semver.org/): \n\n**x.y.z = 1.2.3 = ruptura.mejora.parche** \n\nEs bueno que etiquetes tu repositorio con estas mismas versiones para que, una vez desplegadas, se encuentre con facilidad en *github*.\n\n```\ngit tag 0.1.2\ngit push --tags\n```\n\n\n## Disfruta\n\nFinalmente podrs utilizar ese cdigo en todas tus aplicaciones. Sera fantstico que adems otros lo encontrasen til. Y mejor an si te ayudan o al menos te proponen mejoras. Pero en cualquier caso **siempre habrs ganado**. El esfuerzo analtico que requiere se cobra con creces: dividiendo el problema, creando micro soluciones eficientes y reutilizando cdigo siempre es rentable.","slug":"npm-de-instalador-a-publicador","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cjbrwpvjy002eiwd3kujb9qqx","content":"<p>Seguro que ests harto de repetir la mtica instruccin <code>npm install paquete-x</code> Pero, has pensado en <strong>publicar tus propios mdulos</strong>?. Es muy recomendable crear soluciones distribuidas y muy fcil publicarlas en <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"external\"><em>npm</em></a>.</p><p>Sigue este proceso y te convertirs en un creador de paquetes para <em>npm</em> :</p><h2 id=\"Programa\"><a href=\"#Programa\" class=\"headerlink\" title=\"Programa\"></a>Programa</h2><p>Todo empieza por tener una necesidad y resolverla <strong>encapsulando su cdigo en un mdulo.</strong> Por supuesto que ese mdulo puede requerir paquetes externos. Y por supuesto que tu cdigo puede, y debe, escribirse en varios mdulos.</p><p>Antes de continuar vamos a fijar un par de conceptos:</p><p><strong>- mdulo:</strong> Fichero <em>.js</em> que exporta un funcionalidad y oculta su implementacin.</p><p><strong>- paquete:</strong> Uno o ms mdulos, con sus dependientes de otros paquetes que proponen una solucin reutilizable.</p><p>Conocidos los ingredientes, la receta es sencilla:</p><ol><li>Debes crear un proyecto para el paquete que vas a publicar.</li><li>Has de subir el cdigo a un repositorio pblico.</li><li>Y debes rellenar convenientemente el <code>package.json</code> de tu proyecto.</li></ol><p>Este es un ejemplo que he creado y <a href=\"https://github.com/AgoraBinaria/ab-ftp\" target=\"_blank\" rel=\"external\">publicado en github</a> que te puede servir de base.</p><p>Presta especial atencin al <strong>nombrado</strong> de tu proyecto porque ha de ser nico en el repositorio de npm. Para reducir riesgos de colisiones de nombre te recomiendo que utilices un <em>prefijo</em> con tus iniciales o las de tu empresa.</p><p>No te olvides de incluir un juego de <strong>pruebas y documentacin</strong> necesaria para sus uso.</p><h2 id=\"Publica\"><a href=\"#Publica\" class=\"headerlink\" title=\"Publica\"></a>Publica</h2><p>Puedes descargar libreras y herramienta desde el repositorio de <em>npm</em> de forma annima. De hecho, eso es lo ms corriente. Pero, como era de esperar, tienes que <strong>registrarte para poder publicar</strong> contenido. El <a href=\"https://www.npmjs.com/signup\" target=\"_blank\" rel=\"external\">proceso de registro</a> va web es sencillo y grtis.</p><p>Una vez verificado puedes hacer login en la web. Pero tambin en la terminal de tu ordenador: <code>npm login</code> te pedir el nombre de usuario y contrasea. A partir de es momento ests identificado y puedes usar las herramientas de autor:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm publish</div></pre></td></tr></table></figure><p>Puedes encontrar <a href=\"https://docs.npmjs.com/cli/publish\" target=\"_blank\" rel=\"external\">ms informacin</a> acerca de este mega comando en la documentacin de <em>npmjs</em>. Pero siguiendo la mxima de cuanto menos, mejor, la herramienta har con sus valores por defecto un publicacin y actualizacin limpias.</p><p>La clave est en que tu fichero de configuracin <code>package.json</code> sea correcto y lo ms completo posible. Escribe un completo <code>readme.md</code> que se convertir en portada de tu paquete en el repositorio de npm. Mira en mi ejemplo cmo <a href=\"https://github.com/AgoraBinaria/ab-ftp\" target=\"_blank\" rel=\"external\">el contenido subido a github</a> se transforma y se ve en la <a href=\"https://www.npmjs.com/package/ab-ftp\" target=\"_blank\" rel=\"external\">pgina de informacin de npm.</a></p><p>Comprueba en un directorio vaco que <code>npm install nombre-de-tu-paquete</code> descarga todo lo necesario y tmate un caf mientras ves crecer la hierba y las estadsticas de descargas.</p><h2 id=\"Actualiza\"><a href=\"#Actualiza\" class=\"headerlink\" title=\"Actualiza\"></a>Actualiza</h2><p>Con el tiempo mejorars y corregirs tu solucin. Te recomiendo que sigas el patrn de <a href=\"http://semver.org/\" target=\"_blank\" rel=\"external\">nombrado de versiones semntico</a>:</p><p><strong>x.y.z = 1.2.3 = ruptura.mejora.parche</strong></p><p>Es bueno que etiquetes tu repositorio con estas mismas versiones para que, una vez desplegadas, se encuentre con facilidad en <em>github</em>.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git tag 0.1.2</div><div class=\"line\">git push --tags</div></pre></td></tr></table></figure><h2 id=\"Disfruta\"><a href=\"#Disfruta\" class=\"headerlink\" title=\"Disfruta\"></a>Disfruta</h2><p>Finalmente podrs utilizar ese cdigo en todas tus aplicaciones. Sera fantstico que adems otros lo encontrasen til. Y mejor an si te ayudan o al menos te proponen mejoras. Pero en cualquier caso <strong>siempre habrs ganado</strong>. El esfuerzo analtico que requiere se cobra con creces: dividiendo el problema, creando micro soluciones eficientes y reutilizando cdigo siempre es rentable.</p>","site":{"data":{}},"excerpt":"","more":"<p>Seguro que ests harto de repetir la mtica instruccin <code>npm install paquete-x</code> Pero, has pensado en <strong>publicar tus propios mdulos</strong>?. Es muy recomendable crear soluciones distribuidas y muy fcil publicarlas en <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"external\"><em>npm</em></a>.</p><p>Sigue este proceso y te convertirs en un creador de paquetes para <em>npm</em> :</p><h2 id=\"Programa\"><a href=\"#Programa\" class=\"headerlink\" title=\"Programa\"></a>Programa</h2><p>Todo empieza por tener una necesidad y resolverla <strong>encapsulando su cdigo en un mdulo.</strong> Por supuesto que ese mdulo puede requerir paquetes externos. Y por supuesto que tu cdigo puede, y debe, escribirse en varios mdulos.</p><p>Antes de continuar vamos a fijar un par de conceptos:</p><p><strong>- mdulo:</strong> Fichero <em>.js</em> que exporta un funcionalidad y oculta su implementacin.</p><p><strong>- paquete:</strong> Uno o ms mdulos, con sus dependientes de otros paquetes que proponen una solucin reutilizable.</p><p>Conocidos los ingredientes, la receta es sencilla:</p><ol><li>Debes crear un proyecto para el paquete que vas a publicar.</li><li>Has de subir el cdigo a un repositorio pblico.</li><li>Y debes rellenar convenientemente el <code>package.json</code> de tu proyecto.</li></ol><p>Este es un ejemplo que he creado y <a href=\"https://github.com/AgoraBinaria/ab-ftp\" target=\"_blank\" rel=\"external\">publicado en github</a> que te puede servir de base.</p><p>Presta especial atencin al <strong>nombrado</strong> de tu proyecto porque ha de ser nico en el repositorio de npm. Para reducir riesgos de colisiones de nombre te recomiendo que utilices un <em>prefijo</em> con tus iniciales o las de tu empresa.</p><p>No te olvides de incluir un juego de <strong>pruebas y documentacin</strong> necesaria para sus uso.</p><h2 id=\"Publica\"><a href=\"#Publica\" class=\"headerlink\" title=\"Publica\"></a>Publica</h2><p>Puedes descargar libreras y herramienta desde el repositorio de <em>npm</em> de forma annima. De hecho, eso es lo ms corriente. Pero, como era de esperar, tienes que <strong>registrarte para poder publicar</strong> contenido. El <a href=\"https://www.npmjs.com/signup\" target=\"_blank\" rel=\"external\">proceso de registro</a> va web es sencillo y grtis.</p><p>Una vez verificado puedes hacer login en la web. Pero tambin en la terminal de tu ordenador: <code>npm login</code> te pedir el nombre de usuario y contrasea. A partir de es momento ests identificado y puedes usar las herramientas de autor:</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm publish</div></pre></td></tr></table></figure><p>Puedes encontrar <a href=\"https://docs.npmjs.com/cli/publish\" target=\"_blank\" rel=\"external\">ms informacin</a> acerca de este mega comando en la documentacin de <em>npmjs</em>. Pero siguiendo la mxima de cuanto menos, mejor, la herramienta har con sus valores por defecto un publicacin y actualizacin limpias.</p><p>La clave est en que tu fichero de configuracin <code>package.json</code> sea correcto y lo ms completo posible. Escribe un completo <code>readme.md</code> que se convertir en portada de tu paquete en el repositorio de npm. Mira en mi ejemplo cmo <a href=\"https://github.com/AgoraBinaria/ab-ftp\" target=\"_blank\" rel=\"external\">el contenido subido a github</a> se transforma y se ve en la <a href=\"https://www.npmjs.com/package/ab-ftp\" target=\"_blank\" rel=\"external\">pgina de informacin de npm.</a></p><p>Comprueba en un directorio vaco que <code>npm install nombre-de-tu-paquete</code> descarga todo lo necesario y tmate un caf mientras ves crecer la hierba y las estadsticas de descargas.</p><h2 id=\"Actualiza\"><a href=\"#Actualiza\" class=\"headerlink\" title=\"Actualiza\"></a>Actualiza</h2><p>Con el tiempo mejorars y corregirs tu solucin. Te recomiendo que sigas el patrn de <a href=\"http://semver.org/\" target=\"_blank\" rel=\"external\">nombrado de versiones semntico</a>:</p><p><strong>x.y.z = 1.2.3 = ruptura.mejora.parche</strong></p><p>Es bueno que etiquetes tu repositorio con estas mismas versiones para que, una vez desplegadas, se encuentre con facilidad en <em>github</em>.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git tag 0.1.2</div><div class=\"line\">git push --tags</div></pre></td></tr></table></figure><h2 id=\"Disfruta\"><a href=\"#Disfruta\" class=\"headerlink\" title=\"Disfruta\"></a>Disfruta</h2><p>Finalmente podrs utilizar ese cdigo en todas tus aplicaciones. Sera fantstico que adems otros lo encontrasen til. Y mejor an si te ayudan o al menos te proponen mejoras. Pero en cualquier caso <strong>siempre habrs ganado</strong>. El esfuerzo analtico que requiere se cobra con creces: dividiendo el problema, creando micro soluciones eficientes y reutilizando cdigo siempre es rentable.</p>"},{"title":"Formularios reactivos con Angular","date":"2019-03-12T09:59:27.000Z","thumbnail":"/css/images/angular-8_reactive.png","_content":"\n![formularios-reactivos-con-Angular](/images/tutorial-angular-8_reactive.png)\n\nEl **doble enlace automtico** entre elementos *html* y propiedades de objetos fue el primer gran xito de **Angular**. Ese _doble-binding_ facilita mucho el desarrollo de formularios. Pero esa magia tienen un coste en escalabilidad; impacta en el tiempo de ejecucin y adems dificulta la validacin y el mantenimiento de formularios complejos.\n\nLa solucin en Angular 7 pasa por desacoplar el modelo y la vista, introduciendo una capa que gestione ese doble enlace. Los servicios y directivas del mdulo `ReactiveFormsModule` que viene en la librera `@angular/forms` permiten programar **formularios reactivos conducidos por el cdigo**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Vigilancia y seguridad en Angular](../vigilancia-y-seguridad-en-Angular/). Al finalizar tendrs una aplicacin con formularios _model driven_ fciles de mantener y validar.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/8-reactive](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/8-reactive/security)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n\n# 1 Desacople entre vista y modelo\n\nLa directiva `[(ngModel)]=\"model.property\"` con su popular _banana in a box_ establece el doble enlace entre el elemento de la vista al que se le aplica y una propiedad del modelo. Los cambios en la vista son trasladados automticamente al modelo, y al revs; cualquier cambio en el modelo se refleja inmediatamente en la vista.\n\nSe pueden establecer validaciones y configurar los eventos que disparan las actualizaciones; pero todo ello usando ms y ms atributos y directivas en la plantilla. Son los formularios _template driven_ que degeneran en un *html* farragoso y difcil de mantener.\n\n> Vamos a crear un formulario de registro de usuarios usando los formularios _model driven_. Para ello voy a crear el mdulo _security_ con el componente _register_ y los enganchar a la ruta _security/register_.\n\nEl mdulo de seguridad y su configuracin lazy en el raz:\n\n```console\nng g m security --routing true\nng g c security/register\n```\n\n```typescript\n{\n  path: 'security',\n  loadChildren: './security/security.module#SecurityModule'\n},\n```\nEl componente de registro y su ruta asignada:\n\n```typescript\nconst routes: Routes = [\n  {\n    path: 'register',\n    component: RegisterComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'register'\n  }\n];\n```\n\n```html\n<a routerLink=\"security/register\" class=\"button\">Register</a>\n```\n\n## 1.1 Form Builder\n\nEntra en accin el  `FormBuilder`, un servicio del que han de depender los componentes que quieran desacoplar el modelo de la vista. Se usa para construir un formulario creando un `FormGroup`, (un grupo de controles) que realiza un seguimiento del valor y estado de cambio y validez de los datos.\n\nPara poder usarlo tenemos que importar el mdulo de Angular en el que viene declarado, el `ReactiveFormModule`.\n\n```typescript\nimport { ReactiveFormsModule } from '@angular/forms';\n@NgModule({\n  declarations: [RegisterComponent],\n  imports: [\n    CommonModule,\n    SecurityRoutingModule,\n    ReactiveFormsModule\n  ]\n})\nexport class SecurityModule { }\n```\n\nVeamos un ejemplo mnimo de su declaracin en `register.component.ts`.\n\n```typescript\nexport class RegisterComponent implements OnInit {\n  public formGroup: FormGroup;\n\n  constructor( private formBuilder: FormBuilder ) { }\n\n  public ngOnInit() {\n    this.buildForm();\n  }\n  private buildForm(){\n    this.formGroup = this.formBuilder.group({});\n  }\n}\n```\n## 1.2 Form control\n\nEl formulario se define como un **grupo de controles**. Cada control tendr un nombre y una configuracin. Esa definicin permite establecer un valor inicial al control.\n\n```typescript\nprivate buildForm() {\n  const dateLength = 10;\n  const today = new Date().toISOString().substring(0, dateLength);\n  const name = 'JOHN DOE';\n  this.formGroup = this.formBuilder.group({\n    registeredOn: today,\n    name: name.toLowerCase(),\n    email: 'john@angular.io',\n    password: ''\n  });\n}\n```\n\nComo ves, es fcil asignar valores por defecto. Incluso es un buen momento para modificar o transformar datos previos para ajustarlos a cmo los ver el usuario; sin necesidad de cambiar los datos de base.\n\n## 1.3 Form view\n\nMientras tanto en la vista html... Este trabajo previo y extra que tienes que hacer en el controlador se recompensa con una **mayor limpieza en la vista**. Lo nico necesario ser asignar por nombre el elemento html con el control _typescript_ que lo gestionar.\n\n>Para ello usaremos dos directivas que vienen dentro del mdulo _reactivo_ son `[formGroup]=\"objetoFormulario\"` para el formulario en su conjunto, y `formControlName=\"nombreDelControl\"` para cada control.\n\n```html\n<form [formGroup]=\"formGroup\">\n  <label for=\"registeredOn\">Registered On</label>\n  <input name=\"registeredOn\"\n        formControlName=\"registeredOn\"\n        type=\"date\" />\n  <label for=\"name\">Name</label>\n  <input name=\"name\"\n        formControlName=\"name\"\n        type=\"text\" />\n  <label for=\"email\">E-mail</label>\n  <input name=\"email\"\n        formControlName=\"email\"\n        type=\"email\" />\n  <label for=\"password\">Password</label>\n  <input name=\"password\"\n        formControlName=\"password\"\n        type=\"password\" />\n</form>\n```\n\n# 2 Validacin y estados\n\nLa validacin es una pieza clave de la entrada de datos en cualquier aplicacin. Es el primer **frente de defensa ante errores de usuarios**; ya sean involuntarios o deliberados.\n\nDichas validaciones se solan realizar agregando atributos html tales como el archiconocido `required`. Pero todo eso ahora se traslada a la configuracin de cada control, donde podrs establecer una o varias reglas de validacin sin mancharte con html.\n\n## 2.1 Validadores predefinidos y personalizados\n\nDe nuevo tienes distintas sobrecargas que te permiten resolver limpiamente casos sencillos de una sola validacin, o usar bateras de reglas que vienen predefinidas como funciones en el objeto `Validators` del _framework_.\n\n```typescript\nprivate buildForm() {\n  const dateLength = 10;\n  const today = new Date().toISOString().substring(0, dateLength);\n  const name = 'JOHN DOE';\n  const minPassLength = 4;\n  this.formGroup = this.formBuilder.group({\n    registeredOn: today,\n    name: [name.toLowerCase(), Validators.required],\n    email: ['john@angular.io', [\n      Validators.required, Validators.email\n    ]],\n    password: ['', [\n      Validators.required, Validators.minLength(minPassLength)\n    ]]\n  });\n}\n```\n\nA estas validaciones integradas se puede aadir otras creadas por el programador. Incluso con ejecucin asncrona para validaciones realizadas en el servidor.\n\nPor ejemplo podemos agregar una validacin especfica a las contraseas\n\n```typescript\npassword: ['', [\n  Validators.required,\n  Validators.minLength(minPassLength),\n  this.validatePassword\n]]\n```\nLo nico que se necesita es una funcin que recibe como argumento el control a validar. El resultado debe ser un `null` si todo va bien. Y cualquier otra cosa en caso de fallo. Te muestro una propuesta para que puedas crear tus propios validadores.\n\n```typescript\nprivate validatePassword(control: AbstractControl) {\n  const password = control.value;\n  let error = null;\n  if (!password.includes('$')) {\n    error = { ...error, dollar: 'needs a dollar symbol' };\n  }\n  if (!parseFloat(password[0])) {\n    error = { ...error, number: 'must start with a number' };\n  }\n  return error;\n}\n```\n\n## 2.2 Estados de cambio y validacin\n\nUna vez establecidas las reglas, es hora de aplicarlas y avisar al usuario en caso de que se incumplan. Los formularios y controles reactivos estn gestionados por **mquinas de estados** que determinan en todo momento la situacin de cada control y del formulario en si mismo.\n\n### 2.2.1 Estados de validacin\n\nAl establecer una o ms reglas para uno o ms controles activamos el sistema de chequeo y control del estado de cada control y del formulario en su conjunto.\n\nLa mquina de estados de validacin contempla los siguientes estados mutuamente excluyentes:\n\n- **VALID**: el control ha pasado todos los chequeos\n- **INVALID**: el control ha fallado al menos en una regla.\n- **PENDING**: el control est en medio de un proceso de validacin\n- **DISABLED**: el control est desactivado y exento de validacin\n\nCuando un control incumple con alguna regla de validacin, estas se reflejan en su propiedad `errors` que ser un objeto con una propiedad por cada regla insatisfecha y un valor o mensaje de ayuda guardado en dicha propiedad.\n\n### 2.2.2 Estados de modificacin\n\nLos controles, y el formulario, se someten a otra mquina de estados que monitoriza el valor del control y sus cambios.\n\nLa mquina de estados de cambio contempla entre otros los siguientes:\n\n- **PRINSTINE**: el valor del control no ha sido cambiado por el usuario\n- **DIRTY**: el usuario ha modificado el valor del control.\n- **TOUCHED**: el usuario ha tocado el control lanzando un evento `blur` al salir.\n- **UNTOUCHED**: el usuario no ha tocado y salido del control lanzando ningn evento `blur`.\n\nComo en el caso de los estados de validacin, el formulario tambin se somete a estos estados en funcin de cmo estn sus controles.\n\nVeamos su aplicacin primero en el caso general del formulario. Uno de los usos ms inmediatos es deshabilitar el botn de envo cuando la validacin de algn control falla.\n\n```html\n<button (click)=\"register()\"\n    [disabled]=\"formGroup.invalid\">Register me!</button>\n```\n\n> Por cierto, este sistema de gestin de los controles del formulario oculta la parte ms valiosa (el valor que se pretende almacenar) en la propiedad `value` del formulario. Contendr un objeto con las mismas propiedades usadas durante la definicin del formulario, cada una con el valor actual del control asociado.\n\n```typescript\npublic register() {\n  const user = this.formGroup.value;\n  console.log(user);\n}\n```\n\nLa validacin particular para cada control permite informar al usuario del fallo concreto. Es una **buena prctica de usabilidad** el esperar a que edite un control antes de mostrarle el fallo. Y tambin es muy habitual usar la misma estrategia para cada control.\n\nLo que no queremos es llevar de vuelta la lgica a la vista; as que lo recomendado es crear una **funcin auxiliar para mostrar los errores** de validacin.\n\n```typescript\npublic getError(controlName: string): string {\n  let error = '';\n  const control = this.formGroup.get(controlName);\n  if (control.touched && control.errors != null) {\n    error = JSON.stringify(control.errors);\n  }\n  return error;\n}\n```\nEn la vista colocaremos adecuadamente los mensajes para facilitarle la correccin al usuario.\n\n```html\n<span>{{ getError('name')}}</span>\n<span>{{ getError('email')}}</span>\n<span>{{ getError('password')}}</span>\n```\n\nYa tenemos formularios reactivos conducidos por los datos que te permitirn construir pantallas complejas manteniendo el control en el modelo y dejando la vista despejada. Como resumen podemos decir que vamos a programar ms en TypeScript que en Html. La ventaja del desacople es que podremos controlar lo que enviamos y recibimos de la vista. As se pueden aplicar formatos, validaciones y transformaciones entre lo que presentamos y lo que enviamos hacia los servicios.\n\n# 3. Un gestor de credenciales\n\nVamos a provechar el conocimiento sobre _Interceptores_ y _Observables_ para montar un pequeo sistema de gestin de credenciales. La idea es detectar respuestas a llamadas no autenticadas y redirigir al usuario a nuestra pantalla de registro.\n\nSi el usuario se registra correctamente recibiremos un _token_ que lo identifica. Lo que haremos ser guardarlo y usarlo en el resto de las llamadas.\n\n## 3.1 Deteccin y redireccin de intrusos\n\nEmpezar por crea un servicio para el interceptor de fallos de seguridad y un componente que invocar deliberadamente a un API protegida.\n\n```console\nng g s security/auth-interceptor\nng g c security/secret\n```\n\nAl componente _secret_ le asignaremos la ruta _security/secret_\n\n```html\n  <a routerLink=\"security/register\" class=\"button\">Register</a>\n```\n\n```typescript\nconst routes: Routes = [\n  {\n    path: 'register',\n    component: RegisterComponent\n  },\n  {\n    path: 'secret',\n    component: SecretComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'secret'\n  }\n];\n```\nEn cuanto al interceptor, haremos como ya hemos visto en el tema [7-watch](../vigilancia-y-seguridad-en-Angular/). Lo primero ser proveerlo invirtiendo el control que nos cede el `HttpClient`.\n\n```typescript\n@NgModule({\n  declarations: [RegisterComponent, SecretComponent],\n  imports: [CommonModule, SecurityRoutingModule, ReactiveFormsModule, HttpClientModule],\n  providers: [\n    {\n      provide: HTTP_INTERCEPTORS,\n      useClass: AuthInterceptorService,\n      multi: true\n    }\n  ]\n})\nexport class SecurityModule {}\n```\n\nLuego codificar la implementacin de la interfaz `HttpInterceptor`. En este caso me interesan las respuestas con **error 401**. Emplear el `Router` de Angular para obligar al usuario a visitar la pgina de registro cuando esto ocurra.\n\n```typescript\nexport class AuthInterceptorService implements HttpInterceptor {\n  constructor(private router: Router) {}\n\n  public intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n    return next.handle(req).pipe(catchError(this.handleError.bind(this)));\n  }\n  private handleError(err) {\n    const unauthorized_code = 401;\n    if (err instanceof HttpErrorResponse) {\n      if (err.status === unauthorized_code) {\n        this.router.navigate(['security/register']);\n      }\n    }\n    return throwError(err);\n  }\n}\n```\n\n## 3.2 Almacenamiento y uso del token\n\nAntes de nada volveremos al tema de los observables y su uso como **intermediarios entre objetos desacoplados**. Para ello crear un servicio para almacenar y distribuir el _token_ de identificacin de usuarios.\n\n```console\nng g s security/token_store\n```\n\n```typescript\nexport class TokenStoreService {\n  private token = '';\n  private token$ = new BehaviorSubject<string>('');\n\n  constructor() {}\n\n  public select$ = () => this.token$.asObservable();\n  public dispatch(token) {\n    this.token = token;\n    this.token$.next(this.token);\n  }\n}\n```\n\nDe vuelta en el componente `RegisterComponent`. Tenemos que enviar las credenciales al API para su aceptacin. Si todo va bien, nos devolvern un _token_ que identifica al usuario. Es momento de usar al `TokenStore` para transmitir la noticia por toda la aplicacin.\n\n```typescript\npublic register() {\n  const url = 'https://api-base.herokuapp.com/api/pub/credentials/registration';\n  const user = this.formGroup.value;\n  this.httpClient.post<any>(url, user)\n    .subscribe(res => this.tokenStore.dispatch(res.token));\n}\n```\n\n---\n\nPor ltimo volvemos al `AuthInterceptorService` en el que nos suscribiremos a los cambios acerca del _token_.\n\n```typescript\nprivate token = '';\nconstructor(private router: Router, private tokenStore: TokenStoreService) {\n  this.tokenStore.select$()\n    .subscribe(token => (this.token = token));\n}\n```\n\nY lo usaremos en las cabeceras de todas las llamadas.\n\n\n```typescript\npublic intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n  const authHeader = { Authorization: 'bearer ' + this.token };\n  const authReq = req.clone({ setHeaders: authHeader });\n  return next.handle(authReq)\n    .pipe(catchError(this.handleError.bind(this)));\n}\n```\n\nYa sabes lo bsico de Angular; pero puedes usar mucho ms conociendo su ecosistema. Sigue esta serie para agregar libreras y usar los esquemas de  [Material Design y CLI de Angular](../Material-Design-y-CLI-de-Angular/) mientras aprendes a programar con Angular.\n\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-8-Formularios-reactivos-con-Angular.md","raw":"---\ntitle: Formularios reactivos con Angular\npermalink: formularios-reactivos-con-Angular\ndate: 2019-03-12 10:59:27\ntags:\n- Angular\n- Angular7\n- Angular2\n- reactiveForms\n- Tutorial\n- Introduccin\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-8_reactive.png\n---\n\n![formularios-reactivos-con-Angular](/images/tutorial-angular-8_reactive.png)\n\nEl **doble enlace automtico** entre elementos *html* y propiedades de objetos fue el primer gran xito de **Angular**. Ese _doble-binding_ facilita mucho el desarrollo de formularios. Pero esa magia tienen un coste en escalabilidad; impacta en el tiempo de ejecucin y adems dificulta la validacin y el mantenimiento de formularios complejos.\n\nLa solucin en Angular 7 pasa por desacoplar el modelo y la vista, introduciendo una capa que gestione ese doble enlace. Los servicios y directivas del mdulo `ReactiveFormsModule` que viene en la librera `@angular/forms` permiten programar **formularios reactivos conducidos por el cdigo**.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Vigilancia y seguridad en Angular](../vigilancia-y-seguridad-en-Angular/). Al finalizar tendrs una aplicacin con formularios _model driven_ fciles de mantener y validar.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/8-reactive](https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/8-reactive/security)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n\n# 1 Desacople entre vista y modelo\n\nLa directiva `[(ngModel)]=\"model.property\"` con su popular _banana in a box_ establece el doble enlace entre el elemento de la vista al que se le aplica y una propiedad del modelo. Los cambios en la vista son trasladados automticamente al modelo, y al revs; cualquier cambio en el modelo se refleja inmediatamente en la vista.\n\nSe pueden establecer validaciones y configurar los eventos que disparan las actualizaciones; pero todo ello usando ms y ms atributos y directivas en la plantilla. Son los formularios _template driven_ que degeneran en un *html* farragoso y difcil de mantener.\n\n> Vamos a crear un formulario de registro de usuarios usando los formularios _model driven_. Para ello voy a crear el mdulo _security_ con el componente _register_ y los enganchar a la ruta _security/register_.\n\nEl mdulo de seguridad y su configuracin lazy en el raz:\n\n```console\nng g m security --routing true\nng g c security/register\n```\n\n```typescript\n{\n  path: 'security',\n  loadChildren: './security/security.module#SecurityModule'\n},\n```\nEl componente de registro y su ruta asignada:\n\n```typescript\nconst routes: Routes = [\n  {\n    path: 'register',\n    component: RegisterComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'register'\n  }\n];\n```\n\n```html\n<a routerLink=\"security/register\" class=\"button\">Register</a>\n```\n\n## 1.1 Form Builder\n\nEntra en accin el  `FormBuilder`, un servicio del que han de depender los componentes que quieran desacoplar el modelo de la vista. Se usa para construir un formulario creando un `FormGroup`, (un grupo de controles) que realiza un seguimiento del valor y estado de cambio y validez de los datos.\n\nPara poder usarlo tenemos que importar el mdulo de Angular en el que viene declarado, el `ReactiveFormModule`.\n\n```typescript\nimport { ReactiveFormsModule } from '@angular/forms';\n@NgModule({\n  declarations: [RegisterComponent],\n  imports: [\n    CommonModule,\n    SecurityRoutingModule,\n    ReactiveFormsModule\n  ]\n})\nexport class SecurityModule { }\n```\n\nVeamos un ejemplo mnimo de su declaracin en `register.component.ts`.\n\n```typescript\nexport class RegisterComponent implements OnInit {\n  public formGroup: FormGroup;\n\n  constructor( private formBuilder: FormBuilder ) { }\n\n  public ngOnInit() {\n    this.buildForm();\n  }\n  private buildForm(){\n    this.formGroup = this.formBuilder.group({});\n  }\n}\n```\n## 1.2 Form control\n\nEl formulario se define como un **grupo de controles**. Cada control tendr un nombre y una configuracin. Esa definicin permite establecer un valor inicial al control.\n\n```typescript\nprivate buildForm() {\n  const dateLength = 10;\n  const today = new Date().toISOString().substring(0, dateLength);\n  const name = 'JOHN DOE';\n  this.formGroup = this.formBuilder.group({\n    registeredOn: today,\n    name: name.toLowerCase(),\n    email: 'john@angular.io',\n    password: ''\n  });\n}\n```\n\nComo ves, es fcil asignar valores por defecto. Incluso es un buen momento para modificar o transformar datos previos para ajustarlos a cmo los ver el usuario; sin necesidad de cambiar los datos de base.\n\n## 1.3 Form view\n\nMientras tanto en la vista html... Este trabajo previo y extra que tienes que hacer en el controlador se recompensa con una **mayor limpieza en la vista**. Lo nico necesario ser asignar por nombre el elemento html con el control _typescript_ que lo gestionar.\n\n>Para ello usaremos dos directivas que vienen dentro del mdulo _reactivo_ son `[formGroup]=\"objetoFormulario\"` para el formulario en su conjunto, y `formControlName=\"nombreDelControl\"` para cada control.\n\n```html\n<form [formGroup]=\"formGroup\">\n  <label for=\"registeredOn\">Registered On</label>\n  <input name=\"registeredOn\"\n        formControlName=\"registeredOn\"\n        type=\"date\" />\n  <label for=\"name\">Name</label>\n  <input name=\"name\"\n        formControlName=\"name\"\n        type=\"text\" />\n  <label for=\"email\">E-mail</label>\n  <input name=\"email\"\n        formControlName=\"email\"\n        type=\"email\" />\n  <label for=\"password\">Password</label>\n  <input name=\"password\"\n        formControlName=\"password\"\n        type=\"password\" />\n</form>\n```\n\n# 2 Validacin y estados\n\nLa validacin es una pieza clave de la entrada de datos en cualquier aplicacin. Es el primer **frente de defensa ante errores de usuarios**; ya sean involuntarios o deliberados.\n\nDichas validaciones se solan realizar agregando atributos html tales como el archiconocido `required`. Pero todo eso ahora se traslada a la configuracin de cada control, donde podrs establecer una o varias reglas de validacin sin mancharte con html.\n\n## 2.1 Validadores predefinidos y personalizados\n\nDe nuevo tienes distintas sobrecargas que te permiten resolver limpiamente casos sencillos de una sola validacin, o usar bateras de reglas que vienen predefinidas como funciones en el objeto `Validators` del _framework_.\n\n```typescript\nprivate buildForm() {\n  const dateLength = 10;\n  const today = new Date().toISOString().substring(0, dateLength);\n  const name = 'JOHN DOE';\n  const minPassLength = 4;\n  this.formGroup = this.formBuilder.group({\n    registeredOn: today,\n    name: [name.toLowerCase(), Validators.required],\n    email: ['john@angular.io', [\n      Validators.required, Validators.email\n    ]],\n    password: ['', [\n      Validators.required, Validators.minLength(minPassLength)\n    ]]\n  });\n}\n```\n\nA estas validaciones integradas se puede aadir otras creadas por el programador. Incluso con ejecucin asncrona para validaciones realizadas en el servidor.\n\nPor ejemplo podemos agregar una validacin especfica a las contraseas\n\n```typescript\npassword: ['', [\n  Validators.required,\n  Validators.minLength(minPassLength),\n  this.validatePassword\n]]\n```\nLo nico que se necesita es una funcin que recibe como argumento el control a validar. El resultado debe ser un `null` si todo va bien. Y cualquier otra cosa en caso de fallo. Te muestro una propuesta para que puedas crear tus propios validadores.\n\n```typescript\nprivate validatePassword(control: AbstractControl) {\n  const password = control.value;\n  let error = null;\n  if (!password.includes('$')) {\n    error = { ...error, dollar: 'needs a dollar symbol' };\n  }\n  if (!parseFloat(password[0])) {\n    error = { ...error, number: 'must start with a number' };\n  }\n  return error;\n}\n```\n\n## 2.2 Estados de cambio y validacin\n\nUna vez establecidas las reglas, es hora de aplicarlas y avisar al usuario en caso de que se incumplan. Los formularios y controles reactivos estn gestionados por **mquinas de estados** que determinan en todo momento la situacin de cada control y del formulario en si mismo.\n\n### 2.2.1 Estados de validacin\n\nAl establecer una o ms reglas para uno o ms controles activamos el sistema de chequeo y control del estado de cada control y del formulario en su conjunto.\n\nLa mquina de estados de validacin contempla los siguientes estados mutuamente excluyentes:\n\n- **VALID**: el control ha pasado todos los chequeos\n- **INVALID**: el control ha fallado al menos en una regla.\n- **PENDING**: el control est en medio de un proceso de validacin\n- **DISABLED**: el control est desactivado y exento de validacin\n\nCuando un control incumple con alguna regla de validacin, estas se reflejan en su propiedad `errors` que ser un objeto con una propiedad por cada regla insatisfecha y un valor o mensaje de ayuda guardado en dicha propiedad.\n\n### 2.2.2 Estados de modificacin\n\nLos controles, y el formulario, se someten a otra mquina de estados que monitoriza el valor del control y sus cambios.\n\nLa mquina de estados de cambio contempla entre otros los siguientes:\n\n- **PRINSTINE**: el valor del control no ha sido cambiado por el usuario\n- **DIRTY**: el usuario ha modificado el valor del control.\n- **TOUCHED**: el usuario ha tocado el control lanzando un evento `blur` al salir.\n- **UNTOUCHED**: el usuario no ha tocado y salido del control lanzando ningn evento `blur`.\n\nComo en el caso de los estados de validacin, el formulario tambin se somete a estos estados en funcin de cmo estn sus controles.\n\nVeamos su aplicacin primero en el caso general del formulario. Uno de los usos ms inmediatos es deshabilitar el botn de envo cuando la validacin de algn control falla.\n\n```html\n<button (click)=\"register()\"\n    [disabled]=\"formGroup.invalid\">Register me!</button>\n```\n\n> Por cierto, este sistema de gestin de los controles del formulario oculta la parte ms valiosa (el valor que se pretende almacenar) en la propiedad `value` del formulario. Contendr un objeto con las mismas propiedades usadas durante la definicin del formulario, cada una con el valor actual del control asociado.\n\n```typescript\npublic register() {\n  const user = this.formGroup.value;\n  console.log(user);\n}\n```\n\nLa validacin particular para cada control permite informar al usuario del fallo concreto. Es una **buena prctica de usabilidad** el esperar a que edite un control antes de mostrarle el fallo. Y tambin es muy habitual usar la misma estrategia para cada control.\n\nLo que no queremos es llevar de vuelta la lgica a la vista; as que lo recomendado es crear una **funcin auxiliar para mostrar los errores** de validacin.\n\n```typescript\npublic getError(controlName: string): string {\n  let error = '';\n  const control = this.formGroup.get(controlName);\n  if (control.touched && control.errors != null) {\n    error = JSON.stringify(control.errors);\n  }\n  return error;\n}\n```\nEn la vista colocaremos adecuadamente los mensajes para facilitarle la correccin al usuario.\n\n```html\n<span>{{ getError('name')}}</span>\n<span>{{ getError('email')}}</span>\n<span>{{ getError('password')}}</span>\n```\n\nYa tenemos formularios reactivos conducidos por los datos que te permitirn construir pantallas complejas manteniendo el control en el modelo y dejando la vista despejada. Como resumen podemos decir que vamos a programar ms en TypeScript que en Html. La ventaja del desacople es que podremos controlar lo que enviamos y recibimos de la vista. As se pueden aplicar formatos, validaciones y transformaciones entre lo que presentamos y lo que enviamos hacia los servicios.\n\n# 3. Un gestor de credenciales\n\nVamos a provechar el conocimiento sobre _Interceptores_ y _Observables_ para montar un pequeo sistema de gestin de credenciales. La idea es detectar respuestas a llamadas no autenticadas y redirigir al usuario a nuestra pantalla de registro.\n\nSi el usuario se registra correctamente recibiremos un _token_ que lo identifica. Lo que haremos ser guardarlo y usarlo en el resto de las llamadas.\n\n## 3.1 Deteccin y redireccin de intrusos\n\nEmpezar por crea un servicio para el interceptor de fallos de seguridad y un componente que invocar deliberadamente a un API protegida.\n\n```console\nng g s security/auth-interceptor\nng g c security/secret\n```\n\nAl componente _secret_ le asignaremos la ruta _security/secret_\n\n```html\n  <a routerLink=\"security/register\" class=\"button\">Register</a>\n```\n\n```typescript\nconst routes: Routes = [\n  {\n    path: 'register',\n    component: RegisterComponent\n  },\n  {\n    path: 'secret',\n    component: SecretComponent\n  },\n  {\n    path: '**',\n    redirectTo: 'secret'\n  }\n];\n```\nEn cuanto al interceptor, haremos como ya hemos visto en el tema [7-watch](../vigilancia-y-seguridad-en-Angular/). Lo primero ser proveerlo invirtiendo el control que nos cede el `HttpClient`.\n\n```typescript\n@NgModule({\n  declarations: [RegisterComponent, SecretComponent],\n  imports: [CommonModule, SecurityRoutingModule, ReactiveFormsModule, HttpClientModule],\n  providers: [\n    {\n      provide: HTTP_INTERCEPTORS,\n      useClass: AuthInterceptorService,\n      multi: true\n    }\n  ]\n})\nexport class SecurityModule {}\n```\n\nLuego codificar la implementacin de la interfaz `HttpInterceptor`. En este caso me interesan las respuestas con **error 401**. Emplear el `Router` de Angular para obligar al usuario a visitar la pgina de registro cuando esto ocurra.\n\n```typescript\nexport class AuthInterceptorService implements HttpInterceptor {\n  constructor(private router: Router) {}\n\n  public intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n    return next.handle(req).pipe(catchError(this.handleError.bind(this)));\n  }\n  private handleError(err) {\n    const unauthorized_code = 401;\n    if (err instanceof HttpErrorResponse) {\n      if (err.status === unauthorized_code) {\n        this.router.navigate(['security/register']);\n      }\n    }\n    return throwError(err);\n  }\n}\n```\n\n## 3.2 Almacenamiento y uso del token\n\nAntes de nada volveremos al tema de los observables y su uso como **intermediarios entre objetos desacoplados**. Para ello crear un servicio para almacenar y distribuir el _token_ de identificacin de usuarios.\n\n```console\nng g s security/token_store\n```\n\n```typescript\nexport class TokenStoreService {\n  private token = '';\n  private token$ = new BehaviorSubject<string>('');\n\n  constructor() {}\n\n  public select$ = () => this.token$.asObservable();\n  public dispatch(token) {\n    this.token = token;\n    this.token$.next(this.token);\n  }\n}\n```\n\nDe vuelta en el componente `RegisterComponent`. Tenemos que enviar las credenciales al API para su aceptacin. Si todo va bien, nos devolvern un _token_ que identifica al usuario. Es momento de usar al `TokenStore` para transmitir la noticia por toda la aplicacin.\n\n```typescript\npublic register() {\n  const url = 'https://api-base.herokuapp.com/api/pub/credentials/registration';\n  const user = this.formGroup.value;\n  this.httpClient.post<any>(url, user)\n    .subscribe(res => this.tokenStore.dispatch(res.token));\n}\n```\n\n---\n\nPor ltimo volvemos al `AuthInterceptorService` en el que nos suscribiremos a los cambios acerca del _token_.\n\n```typescript\nprivate token = '';\nconstructor(private router: Router, private tokenStore: TokenStoreService) {\n  this.tokenStore.select$()\n    .subscribe(token => (this.token = token));\n}\n```\n\nY lo usaremos en las cabeceras de todas las llamadas.\n\n\n```typescript\npublic intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n  const authHeader = { Authorization: 'bearer ' + this.token };\n  const authReq = req.clone({ setHeaders: authHeader });\n  return next.handle(authReq)\n    .pipe(catchError(this.handleError.bind(this)));\n}\n```\n\nYa sabes lo bsico de Angular; pero puedes usar mucho ms conociendo su ecosistema. Sigue esta serie para agregar libreras y usar los esquemas de  [Material Design y CLI de Angular](../Material-Design-y-CLI-de-Angular/) mientras aprendes a programar con Angular.\n\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"formularios-reactivos-con-Angular","published":1,"updated":"2019-03-13T12:08:34.365Z","_id":"cjgqbs5xg00006gs3o2wn0xbp","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-8_reactive.png\" alt=\"formularios-reactivos-con-Angular\"></p><p>El <strong>doble enlace automtico</strong> entre elementos <em>html</em> y propiedades de objetos fue el primer gran xito de <strong>Angular</strong>. Ese <em>doble-binding</em> facilita mucho el desarrollo de formularios. Pero esa magia tienen un coste en escalabilidad; impacta en el tiempo de ejecucin y adems dificulta la validacin y el mantenimiento de formularios complejos.</p><p>La solucin en Angular 7 pasa por desacoplar el modelo y la vista, introduciendo una capa que gestione ese doble enlace. Los servicios y directivas del mdulo <code>ReactiveFormsModule</code> que viene en la librera <code>@angular/forms</code> permiten programar <strong>formularios reactivos conducidos por el cdigo</strong>.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal cmo qued en <a href=\"../vigilancia-y-seguridad-en-Angular/\">Vigilancia y seguridad en Angular</a>. Al finalizar tendrs una aplicacin con formularios <em>model driven</em> fciles de mantener y validar.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/8-reactive/security\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/8-reactive</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-Desacople-entre-vista-y-modelo\"><a href=\"#1-Desacople-entre-vista-y-modelo\" class=\"headerlink\" title=\"1 Desacople entre vista y modelo\"></a>1 Desacople entre vista y modelo</h1><p>La directiva <code>[(ngModel)]=&quot;model.property&quot;</code> con su popular <em>banana in a box</em> establece el doble enlace entre el elemento de la vista al que se le aplica y una propiedad del modelo. Los cambios en la vista son trasladados automticamente al modelo, y al revs; cualquier cambio en el modelo se refleja inmediatamente en la vista.</p><p>Se pueden establecer validaciones y configurar los eventos que disparan las actualizaciones; pero todo ello usando ms y ms atributos y directivas en la plantilla. Son los formularios <em>template driven</em> que degeneran en un <em>html</em> farragoso y difcil de mantener.</p><blockquote><p>Vamos a crear un formulario de registro de usuarios usando los formularios <em>model driven</em>. Para ello voy a crear el mdulo <em>security</em> con el componente <em>register</em> y los enganchar a la ruta <em>security/register</em>.</p></blockquote><p>El mdulo de seguridad y su configuracin lazy en el raz:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m security --routing true</span><br><span class=\"line\">ng g c security/register</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'security'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"string\">'./security/security.module#SecurityModule'</span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><p>El componente de registro y su ruta asignada:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'register'</span>,</span><br><span class=\"line\">    component: RegisterComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'register'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"security/register\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span>Register<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-1-Form-Builder\"><a href=\"#1-1-Form-Builder\" class=\"headerlink\" title=\"1.1 Form Builder\"></a>1.1 Form Builder</h2><p>Entra en accin el <code>FormBuilder</code>, un servicio del que han de depender los componentes que quieran desacoplar el modelo de la vista. Se usa para construir un formulario creando un <code>FormGroup</code>, (un grupo de controles) que realiza un seguimiento del valor y estado de cambio y validez de los datos.</p><p>Para poder usarlo tenemos que importar el mdulo de Angular en el que viene declarado, el <code>ReactiveFormModule</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; ReactiveFormsModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [RegisterComponent],</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    SecurityRoutingModule,</span><br><span class=\"line\">    ReactiveFormsModule</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SecurityModule &#123; &#125;</span><br></pre></td></tr></table></figure><p>Veamos un ejemplo mnimo de su declaracin en <code>register.component.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RegisterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> formGroup: FormGroup;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"> <span class=\"keyword\">private</span> formBuilder: FormBuilder </span>) &#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.buildForm();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> buildForm()&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;&#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"1-2-Form-control\"><a href=\"#1-2-Form-control\" class=\"headerlink\" title=\"1.2 Form control\"></a>1.2 Form control</h2><p>El formulario se define como un <strong>grupo de controles</strong>. Cada control tendr un nombre y una configuracin. Esa definicin permite establecer un valor inicial al control.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> buildForm() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dateLength = <span class=\"number\">10</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> today = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString().substring(<span class=\"number\">0</span>, dateLength);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> name = <span class=\"string\">'JOHN DOE'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;</span><br><span class=\"line\">    registeredOn: today,</span><br><span class=\"line\">    name: name.toLowerCase(),</span><br><span class=\"line\">    email: <span class=\"string\">'john@angular.io'</span>,</span><br><span class=\"line\">    password: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Como ves, es fcil asignar valores por defecto. Incluso es un buen momento para modificar o transformar datos previos para ajustarlos a cmo los ver el usuario; sin necesidad de cambiar los datos de base.</p><h2 id=\"1-3-Form-view\"><a href=\"#1-3-Form-view\" class=\"headerlink\" title=\"1.3 Form view\"></a>1.3 Form view</h2><p>Mientras tanto en la vista html Este trabajo previo y extra que tienes que hacer en el controlador se recompensa con una <strong>mayor limpieza en la vista</strong>. Lo nico necesario ser asignar por nombre el elemento html con el control <em>typescript</em> que lo gestionar.</p><blockquote><p>Para ello usaremos dos directivas que vienen dentro del mdulo <em>reactivo</em> son <code>[formGroup]=&quot;objetoFormulario&quot;</code> para el formulario en su conjunto, y <code>formControlName=&quot;nombreDelControl&quot;</code> para cada control.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> [<span class=\"attr\">formGroup</span>]=<span class=\"string\">\"formGroup\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"registeredOn\"</span>&gt;</span>Registered On<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"registeredOn\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"registeredOn\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"date\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"name\"</span>&gt;</span>Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"email\"</span>&gt;</span>E-mail<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"email\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"email\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"email\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"password\"</span>&gt;</span>Password<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"password\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"password\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"2-Validacion-y-estados\"><a href=\"#2-Validacion-y-estados\" class=\"headerlink\" title=\"2 Validacin y estados\"></a>2 Validacin y estados</h1><p>La validacin es una pieza clave de la entrada de datos en cualquier aplicacin. Es el primer <strong>frente de defensa ante errores de usuarios</strong>; ya sean involuntarios o deliberados.</p><p>Dichas validaciones se solan realizar agregando atributos html tales como el archiconocido <code>required</code>. Pero todo eso ahora se traslada a la configuracin de cada control, donde podrs establecer una o varias reglas de validacin sin mancharte con html.</p><h2 id=\"2-1-Validadores-predefinidos-y-personalizados\"><a href=\"#2-1-Validadores-predefinidos-y-personalizados\" class=\"headerlink\" title=\"2.1 Validadores predefinidos y personalizados\"></a>2.1 Validadores predefinidos y personalizados</h2><p>De nuevo tienes distintas sobrecargas que te permiten resolver limpiamente casos sencillos de una sola validacin, o usar bateras de reglas que vienen predefinidas como funciones en el objeto <code>Validators</code> del <em>framework</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> buildForm() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dateLength = <span class=\"number\">10</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> today = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString().substring(<span class=\"number\">0</span>, dateLength);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> name = <span class=\"string\">'JOHN DOE'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> minPassLength = <span class=\"number\">4</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;</span><br><span class=\"line\">    registeredOn: today,</span><br><span class=\"line\">    name: [name.toLowerCase(), Validators.required],</span><br><span class=\"line\">    email: [<span class=\"string\">'john@angular.io'</span>, [</span><br><span class=\"line\">      Validators.required, Validators.email</span><br><span class=\"line\">    ]],</span><br><span class=\"line\">    password: [<span class=\"string\">''</span>, [</span><br><span class=\"line\">      Validators.required, Validators.minLength(minPassLength)</span><br><span class=\"line\">    ]]</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>A estas validaciones integradas se puede aadir otras creadas por el programador. Incluso con ejecucin asncrona para validaciones realizadas en el servidor.</p><p>Por ejemplo podemos agregar una validacin especfica a las contraseas</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">password: [<span class=\"string\">''</span>, [</span><br><span class=\"line\">  Validators.required,</span><br><span class=\"line\">  Validators.minLength(minPassLength),</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.validatePassword</span><br><span class=\"line\">]]</span><br></pre></td></tr></table></figure><p>Lo nico que se necesita es una funcin que recibe como argumento el control a validar. El resultado debe ser un <code>null</code> si todo va bien. Y cualquier otra cosa en caso de fallo. Te muestro una propuesta para que puedas crear tus propios validadores.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> validatePassword(control: AbstractControl) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> password = control.value;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> error = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!password.includes(<span class=\"string\">'$'</span>)) &#123;</span><br><span class=\"line\">    error = &#123; ...error, dollar: <span class=\"string\">'needs a dollar symbol'</span> &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"built_in\">parseFloat</span>(password[<span class=\"number\">0</span>])) &#123;</span><br><span class=\"line\">    error = &#123; ...error, <span class=\"built_in\">number</span>: <span class=\"string\">'must start with a number'</span> &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> error;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Estados-de-cambio-y-validacion\"><a href=\"#2-2-Estados-de-cambio-y-validacion\" class=\"headerlink\" title=\"2.2 Estados de cambio y validacin\"></a>2.2 Estados de cambio y validacin</h2><p>Una vez establecidas las reglas, es hora de aplicarlas y avisar al usuario en caso de que se incumplan. Los formularios y controles reactivos estn gestionados por <strong>mquinas de estados</strong> que determinan en todo momento la situacin de cada control y del formulario en si mismo.</p><h3 id=\"2-2-1-Estados-de-validacion\"><a href=\"#2-2-1-Estados-de-validacion\" class=\"headerlink\" title=\"2.2.1 Estados de validacin\"></a>2.2.1 Estados de validacin</h3><p>Al establecer una o ms reglas para uno o ms controles activamos el sistema de chequeo y control del estado de cada control y del formulario en su conjunto.</p><p>La mquina de estados de validacin contempla los siguientes estados mutuamente excluyentes:</p><ul><li><strong>VALID</strong>: el control ha pasado todos los chequeos</li><li><strong>INVALID</strong>: el control ha fallado al menos en una regla.</li><li><strong>PENDING</strong>: el control est en medio de un proceso de validacin</li><li><strong>DISABLED</strong>: el control est desactivado y exento de validacin</li></ul><p>Cuando un control incumple con alguna regla de validacin, estas se reflejan en su propiedad <code>errors</code> que ser un objeto con una propiedad por cada regla insatisfecha y un valor o mensaje de ayuda guardado en dicha propiedad.</p><h3 id=\"2-2-2-Estados-de-modificacion\"><a href=\"#2-2-2-Estados-de-modificacion\" class=\"headerlink\" title=\"2.2.2 Estados de modificacin\"></a>2.2.2 Estados de modificacin</h3><p>Los controles, y el formulario, se someten a otra mquina de estados que monitoriza el valor del control y sus cambios.</p><p>La mquina de estados de cambio contempla entre otros los siguientes:</p><ul><li><strong>PRINSTINE</strong>: el valor del control no ha sido cambiado por el usuario</li><li><strong>DIRTY</strong>: el usuario ha modificado el valor del control.</li><li><strong>TOUCHED</strong>: el usuario ha tocado el control lanzando un evento <code>blur</code> al salir.</li><li><strong>UNTOUCHED</strong>: el usuario no ha tocado y salido del control lanzando ningn evento <code>blur</code>.</li></ul><p>Como en el caso de los estados de validacin, el formulario tambin se somete a estos estados en funcin de cmo estn sus controles.</p><p>Veamos su aplicacin primero en el caso general del formulario. Uno de los usos ms inmediatos es deshabilitar el botn de envo cuando la validacin de algn control falla.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"register()\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"formGroup.invalid\"</span>&gt;</span>Register me!<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Por cierto, este sistema de gestin de los controles del formulario oculta la parte ms valiosa (el valor que se pretende almacenar) en la propiedad <code>value</code> del formulario. Contendr un objeto con las mismas propiedades usadas durante la definicin del formulario, cada una con el valor actual del control asociado.</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> register() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> user = <span class=\"keyword\">this</span>.formGroup.value;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(user);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>La validacin particular para cada control permite informar al usuario del fallo concreto. Es una <strong>buena prctica de usabilidad</strong> el esperar a que edite un control antes de mostrarle el fallo. Y tambin es muy habitual usar la misma estrategia para cada control.</p><p>Lo que no queremos es llevar de vuelta la lgica a la vista; as que lo recomendado es crear una <strong>funcin auxiliar para mostrar los errores</strong> de validacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> getError(controlName: <span class=\"built_in\">string</span>): <span class=\"built_in\">string</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> error = <span class=\"string\">''</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> control = <span class=\"keyword\">this</span>.formGroup.get(controlName);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (control.touched &amp;&amp; control.errors != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">    error = <span class=\"built_in\">JSON</span>.stringify(control.errors);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> error;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>En la vista colocaremos adecuadamente los mensajes para facilitarle la correccin al usuario.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('name')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('email')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('password')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Ya tenemos formularios reactivos conducidos por los datos que te permitirn construir pantallas complejas manteniendo el control en el modelo y dejando la vista despejada. Como resumen podemos decir que vamos a programar ms en TypeScript que en Html. La ventaja del desacople es que podremos controlar lo que enviamos y recibimos de la vista. As se pueden aplicar formatos, validaciones y transformaciones entre lo que presentamos y lo que enviamos hacia los servicios.</p><h1 id=\"3-Un-gestor-de-credenciales\"><a href=\"#3-Un-gestor-de-credenciales\" class=\"headerlink\" title=\"3. Un gestor de credenciales\"></a>3. Un gestor de credenciales</h1><p>Vamos a provechar el conocimiento sobre <em>Interceptores</em> y <em>Observables</em> para montar un pequeo sistema de gestin de credenciales. La idea es detectar respuestas a llamadas no autenticadas y redirigir al usuario a nuestra pantalla de registro.</p><p>Si el usuario se registra correctamente recibiremos un <em>token</em> que lo identifica. Lo que haremos ser guardarlo y usarlo en el resto de las llamadas.</p><h2 id=\"3-1-Deteccion-y-redireccion-de-intrusos\"><a href=\"#3-1-Deteccion-y-redireccion-de-intrusos\" class=\"headerlink\" title=\"3.1 Deteccin y redireccin de intrusos\"></a>3.1 Deteccin y redireccin de intrusos</h2><p>Empezar por crea un servicio para el interceptor de fallos de seguridad y un componente que invocar deliberadamente a un API protegida.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s security/auth-interceptor</span><br><span class=\"line\">ng g c security/secret</span><br></pre></td></tr></table></figure><p>Al componente <em>secret</em> le asignaremos la ruta <em>security/secret</em></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"security/register\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span>Register<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'register'</span>,</span><br><span class=\"line\">    component: RegisterComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'secret'</span>,</span><br><span class=\"line\">    component: SecretComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'secret'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>En cuanto al interceptor, haremos como ya hemos visto en el tema <a href=\"../vigilancia-y-seguridad-en-Angular/\">7-watch</a>. Lo primero ser proveerlo invirtiendo el control que nos cede el <code>HttpClient</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [RegisterComponent, SecretComponent],</span><br><span class=\"line\">  imports: [CommonModule, SecurityRoutingModule, ReactiveFormsModule, HttpClientModule],</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: HTTP_INTERCEPTORS,</span><br><span class=\"line\">      useClass: AuthInterceptorService,</span><br><span class=\"line\">      multi: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SecurityModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Luego codificar la implementacin de la interfaz <code>HttpInterceptor</code>. En este caso me interesan las respuestas con <strong>error 401</strong>. Emplear el <code>Router</code> de Angular para obligar al usuario a visitar la pgina de registro cuando esto ocurra.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AuthInterceptorService <span class=\"keyword\">implements</span> HttpInterceptor &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> router: Router</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"keyword\">this</span>.handleError.bind(<span class=\"keyword\">this</span>)));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> handleError(err) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> unauthorized_code = <span class=\"number\">401</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err <span class=\"keyword\">instanceof</span> HttpErrorResponse) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (err.status === unauthorized_code) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.router.navigate([<span class=\"string\">'security/register'</span>]);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> throwError(err);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Almacenamiento-y-uso-del-token\"><a href=\"#3-2-Almacenamiento-y-uso-del-token\" class=\"headerlink\" title=\"3.2 Almacenamiento y uso del token\"></a>3.2 Almacenamiento y uso del token</h2><p>Antes de nada volveremos al tema de los observables y su uso como <strong>intermediarios entre objetos desacoplados</strong>. Para ello crear un servicio para almacenar y distribuir el <em>token</em> de identificacin de usuarios.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s security/token_store</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> TokenStoreService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> token = <span class=\"string\">''</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> token$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">string</span>&gt;(<span class=\"string\">''</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> select$ = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.token$.asObservable();</span><br><span class=\"line\">  <span class=\"keyword\">public</span> dispatch(token) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.token = token;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.token$.next(<span class=\"keyword\">this</span>.token);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>De vuelta en el componente <code>RegisterComponent</code>. Tenemos que enviar las credenciales al API para su aceptacin. Si todo va bien, nos devolvern un <em>token</em> que identifica al usuario. Es momento de usar al <code>TokenStore</code> para transmitir la noticia por toda la aplicacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> register() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"string\">'https://api-base.herokuapp.com/api/pub/credentials/registration'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> user = <span class=\"keyword\">this</span>.formGroup.value;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.post&lt;<span class=\"built_in\">any</span>&gt;(url, user)</span><br><span class=\"line\">    .subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> <span class=\"keyword\">this</span>.tokenStore.dispatch(res.token));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><p>Por ltimo volvemos al <code>AuthInterceptorService</code> en el que nos suscribiremos a los cambios acerca del <em>token</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> token = <span class=\"string\">''</span>;</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> router: Router, <span class=\"keyword\">private</span> tokenStore: TokenStoreService</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.tokenStore.select$()</span><br><span class=\"line\">    .subscribe(<span class=\"function\"><span class=\"params\">token</span> =&gt;</span> (<span class=\"keyword\">this</span>.token = token));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y lo usaremos en las cabeceras de todas las llamadas.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> authHeader = &#123; Authorization: <span class=\"string\">'bearer '</span> + <span class=\"keyword\">this</span>.token &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> authReq = req.clone(&#123; setHeaders: authHeader &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> next.handle(authReq)</span><br><span class=\"line\">    .pipe(catchError(<span class=\"keyword\">this</span>.handleError.bind(<span class=\"keyword\">this</span>)));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ya sabes lo bsico de Angular; pero puedes usar mucho ms conociendo su ecosistema. Sigue esta serie para agregar libreras y usar los esquemas de <a href=\"../Material-Design-y-CLI-de-Angular/\">Material Design y CLI de Angular</a> mientras aprendes a programar con Angular.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-8_reactive.png\" alt=\"formularios-reactivos-con-Angular\"></p><p>El <strong>doble enlace automtico</strong> entre elementos <em>html</em> y propiedades de objetos fue el primer gran xito de <strong>Angular</strong>. Ese <em>doble-binding</em> facilita mucho el desarrollo de formularios. Pero esa magia tienen un coste en escalabilidad; impacta en el tiempo de ejecucin y adems dificulta la validacin y el mantenimiento de formularios complejos.</p><p>La solucin en Angular 7 pasa por desacoplar el modelo y la vista, introduciendo una capa que gestione ese doble enlace. Los servicios y directivas del mdulo <code>ReactiveFormsModule</code> que viene en la librera <code>@angular/forms</code> permiten programar <strong>formularios reactivos conducidos por el cdigo</strong>.</p>","more":"<p>Partiendo de la aplicacin tal cmo qued en <a href=\"../vigilancia-y-seguridad-en-Angular/\">Vigilancia y seguridad en Angular</a>. Al finalizar tendrs una aplicacin con formularios <em>model driven</em> fciles de mantener y validar.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/src/app/8-reactive/security\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/8-reactive</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-Desacople-entre-vista-y-modelo\"><a href=\"#1-Desacople-entre-vista-y-modelo\" class=\"headerlink\" title=\"1 Desacople entre vista y modelo\"></a>1 Desacople entre vista y modelo</h1><p>La directiva <code>[(ngModel)]=&quot;model.property&quot;</code> con su popular <em>banana in a box</em> establece el doble enlace entre el elemento de la vista al que se le aplica y una propiedad del modelo. Los cambios en la vista son trasladados automticamente al modelo, y al revs; cualquier cambio en el modelo se refleja inmediatamente en la vista.</p><p>Se pueden establecer validaciones y configurar los eventos que disparan las actualizaciones; pero todo ello usando ms y ms atributos y directivas en la plantilla. Son los formularios <em>template driven</em> que degeneran en un <em>html</em> farragoso y difcil de mantener.</p><blockquote><p>Vamos a crear un formulario de registro de usuarios usando los formularios <em>model driven</em>. Para ello voy a crear el mdulo <em>security</em> con el componente <em>register</em> y los enganchar a la ruta <em>security/register</em>.</p></blockquote><p>El mdulo de seguridad y su configuracin lazy en el raz:</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g m security --routing true</span><br><span class=\"line\">ng g c security/register</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  path: <span class=\"string\">'security'</span>,</span><br><span class=\"line\">  loadChildren: <span class=\"string\">'./security/security.module#SecurityModule'</span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure><p>El componente de registro y su ruta asignada:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'register'</span>,</span><br><span class=\"line\">    component: RegisterComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'register'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"security/register\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span>Register<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"1-1-Form-Builder\"><a href=\"#1-1-Form-Builder\" class=\"headerlink\" title=\"1.1 Form Builder\"></a>1.1 Form Builder</h2><p>Entra en accin el <code>FormBuilder</code>, un servicio del que han de depender los componentes que quieran desacoplar el modelo de la vista. Se usa para construir un formulario creando un <code>FormGroup</code>, (un grupo de controles) que realiza un seguimiento del valor y estado de cambio y validez de los datos.</p><p>Para poder usarlo tenemos que importar el mdulo de Angular en el que viene declarado, el <code>ReactiveFormModule</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; ReactiveFormsModule &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/forms'</span>;</span><br><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [RegisterComponent],</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    SecurityRoutingModule,</span><br><span class=\"line\">    ReactiveFormsModule</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SecurityModule &#123; &#125;</span><br></pre></td></tr></table></figure><p>Veamos un ejemplo mnimo de su declaracin en <code>register.component.ts</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> RegisterComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> formGroup: FormGroup;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"> <span class=\"keyword\">private</span> formBuilder: FormBuilder </span>) &#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.buildForm();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> buildForm()&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;&#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"1-2-Form-control\"><a href=\"#1-2-Form-control\" class=\"headerlink\" title=\"1.2 Form control\"></a>1.2 Form control</h2><p>El formulario se define como un <strong>grupo de controles</strong>. Cada control tendr un nombre y una configuracin. Esa definicin permite establecer un valor inicial al control.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> buildForm() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dateLength = <span class=\"number\">10</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> today = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString().substring(<span class=\"number\">0</span>, dateLength);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> name = <span class=\"string\">'JOHN DOE'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;</span><br><span class=\"line\">    registeredOn: today,</span><br><span class=\"line\">    name: name.toLowerCase(),</span><br><span class=\"line\">    email: <span class=\"string\">'john@angular.io'</span>,</span><br><span class=\"line\">    password: <span class=\"string\">''</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Como ves, es fcil asignar valores por defecto. Incluso es un buen momento para modificar o transformar datos previos para ajustarlos a cmo los ver el usuario; sin necesidad de cambiar los datos de base.</p><h2 id=\"1-3-Form-view\"><a href=\"#1-3-Form-view\" class=\"headerlink\" title=\"1.3 Form view\"></a>1.3 Form view</h2><p>Mientras tanto en la vista html Este trabajo previo y extra que tienes que hacer en el controlador se recompensa con una <strong>mayor limpieza en la vista</strong>. Lo nico necesario ser asignar por nombre el elemento html con el control <em>typescript</em> que lo gestionar.</p><blockquote><p>Para ello usaremos dos directivas que vienen dentro del mdulo <em>reactivo</em> son <code>[formGroup]=&quot;objetoFormulario&quot;</code> para el formulario en su conjunto, y <code>formControlName=&quot;nombreDelControl&quot;</code> para cada control.</p></blockquote><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> [<span class=\"attr\">formGroup</span>]=<span class=\"string\">\"formGroup\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"registeredOn\"</span>&gt;</span>Registered On<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"registeredOn\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"registeredOn\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"date\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"name\"</span>&gt;</span>Name<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"name\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"email\"</span>&gt;</span>E-mail<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"email\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"email\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"email\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"password\"</span>&gt;</span>Password<span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">formControlName</span>=<span class=\"string\">\"password\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">type</span>=<span class=\"string\">\"password\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id=\"2-Validacion-y-estados\"><a href=\"#2-Validacion-y-estados\" class=\"headerlink\" title=\"2 Validacin y estados\"></a>2 Validacin y estados</h1><p>La validacin es una pieza clave de la entrada de datos en cualquier aplicacin. Es el primer <strong>frente de defensa ante errores de usuarios</strong>; ya sean involuntarios o deliberados.</p><p>Dichas validaciones se solan realizar agregando atributos html tales como el archiconocido <code>required</code>. Pero todo eso ahora se traslada a la configuracin de cada control, donde podrs establecer una o varias reglas de validacin sin mancharte con html.</p><h2 id=\"2-1-Validadores-predefinidos-y-personalizados\"><a href=\"#2-1-Validadores-predefinidos-y-personalizados\" class=\"headerlink\" title=\"2.1 Validadores predefinidos y personalizados\"></a>2.1 Validadores predefinidos y personalizados</h2><p>De nuevo tienes distintas sobrecargas que te permiten resolver limpiamente casos sencillos de una sola validacin, o usar bateras de reglas que vienen predefinidas como funciones en el objeto <code>Validators</code> del <em>framework</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> buildForm() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dateLength = <span class=\"number\">10</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> today = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().toISOString().substring(<span class=\"number\">0</span>, dateLength);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> name = <span class=\"string\">'JOHN DOE'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> minPassLength = <span class=\"number\">4</span>;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.formGroup = <span class=\"keyword\">this</span>.formBuilder.group(&#123;</span><br><span class=\"line\">    registeredOn: today,</span><br><span class=\"line\">    name: [name.toLowerCase(), Validators.required],</span><br><span class=\"line\">    email: [<span class=\"string\">'john@angular.io'</span>, [</span><br><span class=\"line\">      Validators.required, Validators.email</span><br><span class=\"line\">    ]],</span><br><span class=\"line\">    password: [<span class=\"string\">''</span>, [</span><br><span class=\"line\">      Validators.required, Validators.minLength(minPassLength)</span><br><span class=\"line\">    ]]</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>A estas validaciones integradas se puede aadir otras creadas por el programador. Incluso con ejecucin asncrona para validaciones realizadas en el servidor.</p><p>Por ejemplo podemos agregar una validacin especfica a las contraseas</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">password: [<span class=\"string\">''</span>, [</span><br><span class=\"line\">  Validators.required,</span><br><span class=\"line\">  Validators.minLength(minPassLength),</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.validatePassword</span><br><span class=\"line\">]]</span><br></pre></td></tr></table></figure><p>Lo nico que se necesita es una funcin que recibe como argumento el control a validar. El resultado debe ser un <code>null</code> si todo va bien. Y cualquier otra cosa en caso de fallo. Te muestro una propuesta para que puedas crear tus propios validadores.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> validatePassword(control: AbstractControl) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> password = control.value;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> error = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!password.includes(<span class=\"string\">'$'</span>)) &#123;</span><br><span class=\"line\">    error = &#123; ...error, dollar: <span class=\"string\">'needs a dollar symbol'</span> &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"built_in\">parseFloat</span>(password[<span class=\"number\">0</span>])) &#123;</span><br><span class=\"line\">    error = &#123; ...error, <span class=\"built_in\">number</span>: <span class=\"string\">'must start with a number'</span> &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> error;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Estados-de-cambio-y-validacion\"><a href=\"#2-2-Estados-de-cambio-y-validacion\" class=\"headerlink\" title=\"2.2 Estados de cambio y validacin\"></a>2.2 Estados de cambio y validacin</h2><p>Una vez establecidas las reglas, es hora de aplicarlas y avisar al usuario en caso de que se incumplan. Los formularios y controles reactivos estn gestionados por <strong>mquinas de estados</strong> que determinan en todo momento la situacin de cada control y del formulario en si mismo.</p><h3 id=\"2-2-1-Estados-de-validacion\"><a href=\"#2-2-1-Estados-de-validacion\" class=\"headerlink\" title=\"2.2.1 Estados de validacin\"></a>2.2.1 Estados de validacin</h3><p>Al establecer una o ms reglas para uno o ms controles activamos el sistema de chequeo y control del estado de cada control y del formulario en su conjunto.</p><p>La mquina de estados de validacin contempla los siguientes estados mutuamente excluyentes:</p><ul><li><strong>VALID</strong>: el control ha pasado todos los chequeos</li><li><strong>INVALID</strong>: el control ha fallado al menos en una regla.</li><li><strong>PENDING</strong>: el control est en medio de un proceso de validacin</li><li><strong>DISABLED</strong>: el control est desactivado y exento de validacin</li></ul><p>Cuando un control incumple con alguna regla de validacin, estas se reflejan en su propiedad <code>errors</code> que ser un objeto con una propiedad por cada regla insatisfecha y un valor o mensaje de ayuda guardado en dicha propiedad.</p><h3 id=\"2-2-2-Estados-de-modificacion\"><a href=\"#2-2-2-Estados-de-modificacion\" class=\"headerlink\" title=\"2.2.2 Estados de modificacin\"></a>2.2.2 Estados de modificacin</h3><p>Los controles, y el formulario, se someten a otra mquina de estados que monitoriza el valor del control y sus cambios.</p><p>La mquina de estados de cambio contempla entre otros los siguientes:</p><ul><li><strong>PRINSTINE</strong>: el valor del control no ha sido cambiado por el usuario</li><li><strong>DIRTY</strong>: el usuario ha modificado el valor del control.</li><li><strong>TOUCHED</strong>: el usuario ha tocado el control lanzando un evento <code>blur</code> al salir.</li><li><strong>UNTOUCHED</strong>: el usuario no ha tocado y salido del control lanzando ningn evento <code>blur</code>.</li></ul><p>Como en el caso de los estados de validacin, el formulario tambin se somete a estos estados en funcin de cmo estn sus controles.</p><p>Veamos su aplicacin primero en el caso general del formulario. Uno de los usos ms inmediatos es deshabilitar el botn de envo cuando la validacin de algn control falla.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> (<span class=\"attr\">click</span>)=<span class=\"string\">\"register()\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">disabled</span>]=<span class=\"string\">\"formGroup.invalid\"</span>&gt;</span>Register me!<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Por cierto, este sistema de gestin de los controles del formulario oculta la parte ms valiosa (el valor que se pretende almacenar) en la propiedad <code>value</code> del formulario. Contendr un objeto con las mismas propiedades usadas durante la definicin del formulario, cada una con el valor actual del control asociado.</p></blockquote><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> register() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> user = <span class=\"keyword\">this</span>.formGroup.value;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(user);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>La validacin particular para cada control permite informar al usuario del fallo concreto. Es una <strong>buena prctica de usabilidad</strong> el esperar a que edite un control antes de mostrarle el fallo. Y tambin es muy habitual usar la misma estrategia para cada control.</p><p>Lo que no queremos es llevar de vuelta la lgica a la vista; as que lo recomendado es crear una <strong>funcin auxiliar para mostrar los errores</strong> de validacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> getError(controlName: <span class=\"built_in\">string</span>): <span class=\"built_in\">string</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> error = <span class=\"string\">''</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> control = <span class=\"keyword\">this</span>.formGroup.get(controlName);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (control.touched &amp;&amp; control.errors != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">    error = <span class=\"built_in\">JSON</span>.stringify(control.errors);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> error;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>En la vista colocaremos adecuadamente los mensajes para facilitarle la correccin al usuario.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('name')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('email')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123; getError('password')&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Ya tenemos formularios reactivos conducidos por los datos que te permitirn construir pantallas complejas manteniendo el control en el modelo y dejando la vista despejada. Como resumen podemos decir que vamos a programar ms en TypeScript que en Html. La ventaja del desacople es que podremos controlar lo que enviamos y recibimos de la vista. As se pueden aplicar formatos, validaciones y transformaciones entre lo que presentamos y lo que enviamos hacia los servicios.</p><h1 id=\"3-Un-gestor-de-credenciales\"><a href=\"#3-Un-gestor-de-credenciales\" class=\"headerlink\" title=\"3. Un gestor de credenciales\"></a>3. Un gestor de credenciales</h1><p>Vamos a provechar el conocimiento sobre <em>Interceptores</em> y <em>Observables</em> para montar un pequeo sistema de gestin de credenciales. La idea es detectar respuestas a llamadas no autenticadas y redirigir al usuario a nuestra pantalla de registro.</p><p>Si el usuario se registra correctamente recibiremos un <em>token</em> que lo identifica. Lo que haremos ser guardarlo y usarlo en el resto de las llamadas.</p><h2 id=\"3-1-Deteccion-y-redireccion-de-intrusos\"><a href=\"#3-1-Deteccion-y-redireccion-de-intrusos\" class=\"headerlink\" title=\"3.1 Deteccin y redireccin de intrusos\"></a>3.1 Deteccin y redireccin de intrusos</h2><p>Empezar por crea un servicio para el interceptor de fallos de seguridad y un componente que invocar deliberadamente a un API protegida.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s security/auth-interceptor</span><br><span class=\"line\">ng g c security/secret</span><br></pre></td></tr></table></figure><p>Al componente <em>secret</em> le asignaremos la ruta <em>security/secret</em></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">routerLink</span>=<span class=\"string\">\"security/register\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"button\"</span>&gt;</span>Register<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'register'</span>,</span><br><span class=\"line\">    component: RegisterComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'secret'</span>,</span><br><span class=\"line\">    component: SecretComponent</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">'**'</span>,</span><br><span class=\"line\">    redirectTo: <span class=\"string\">'secret'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>En cuanto al interceptor, haremos como ya hemos visto en el tema <a href=\"../vigilancia-y-seguridad-en-Angular/\">7-watch</a>. Lo primero ser proveerlo invirtiendo el control que nos cede el <code>HttpClient</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  declarations: [RegisterComponent, SecretComponent],</span><br><span class=\"line\">  imports: [CommonModule, SecurityRoutingModule, ReactiveFormsModule, HttpClientModule],</span><br><span class=\"line\">  providers: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      provide: HTTP_INTERCEPTORS,</span><br><span class=\"line\">      useClass: AuthInterceptorService,</span><br><span class=\"line\">      multi: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SecurityModule &#123;&#125;</span><br></pre></td></tr></table></figure><p>Luego codificar la implementacin de la interfaz <code>HttpInterceptor</code>. En este caso me interesan las respuestas con <strong>error 401</strong>. Emplear el <code>Router</code> de Angular para obligar al usuario a visitar la pgina de registro cuando esto ocurra.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AuthInterceptorService <span class=\"keyword\">implements</span> HttpInterceptor &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> router: Router</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> next.handle(req).pipe(catchError(<span class=\"keyword\">this</span>.handleError.bind(<span class=\"keyword\">this</span>)));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> handleError(err) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> unauthorized_code = <span class=\"number\">401</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err <span class=\"keyword\">instanceof</span> HttpErrorResponse) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (err.status === unauthorized_code) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.router.navigate([<span class=\"string\">'security/register'</span>]);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> throwError(err);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Almacenamiento-y-uso-del-token\"><a href=\"#3-2-Almacenamiento-y-uso-del-token\" class=\"headerlink\" title=\"3.2 Almacenamiento y uso del token\"></a>3.2 Almacenamiento y uso del token</h2><p>Antes de nada volveremos al tema de los observables y su uso como <strong>intermediarios entre objetos desacoplados</strong>. Para ello crear un servicio para almacenar y distribuir el <em>token</em> de identificacin de usuarios.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g s security/token_store</span><br></pre></td></tr></table></figure><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> TokenStoreService &#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> token = <span class=\"string\">''</span>;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> token$ = <span class=\"keyword\">new</span> BehaviorSubject&lt;<span class=\"built_in\">string</span>&gt;(<span class=\"string\">''</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> select$ = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">this</span>.token$.asObservable();</span><br><span class=\"line\">  <span class=\"keyword\">public</span> dispatch(token) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.token = token;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.token$.next(<span class=\"keyword\">this</span>.token);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>De vuelta en el componente <code>RegisterComponent</code>. Tenemos que enviar las credenciales al API para su aceptacin. Si todo va bien, nos devolvern un <em>token</em> que identifica al usuario. Es momento de usar al <code>TokenStore</code> para transmitir la noticia por toda la aplicacin.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> register() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"string\">'https://api-base.herokuapp.com/api/pub/credentials/registration'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> user = <span class=\"keyword\">this</span>.formGroup.value;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.httpClient.post&lt;<span class=\"built_in\">any</span>&gt;(url, user)</span><br><span class=\"line\">    .subscribe(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> <span class=\"keyword\">this</span>.tokenStore.dispatch(res.token));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><hr><p>Por ltimo volvemos al <code>AuthInterceptorService</code> en el que nos suscribiremos a los cambios acerca del <em>token</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> token = <span class=\"string\">''</span>;</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> router: Router, <span class=\"keyword\">private</span> tokenStore: TokenStoreService</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.tokenStore.select$()</span><br><span class=\"line\">    .subscribe(<span class=\"function\"><span class=\"params\">token</span> =&gt;</span> (<span class=\"keyword\">this</span>.token = token));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y lo usaremos en las cabeceras de todas las llamadas.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> intercept(req: HttpRequest&lt;<span class=\"built_in\">any</span>&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;<span class=\"built_in\">any</span>&gt;&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> authHeader = &#123; Authorization: <span class=\"string\">'bearer '</span> + <span class=\"keyword\">this</span>.token &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> authReq = req.clone(&#123; setHeaders: authHeader &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> next.handle(authReq)</span><br><span class=\"line\">    .pipe(catchError(<span class=\"keyword\">this</span>.handleError.bind(<span class=\"keyword\">this</span>)));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ya sabes lo bsico de Angular; pero puedes usar mucho ms conociendo su ecosistema. Sigue esta serie para agregar libreras y usar los esquemas de <a href=\"../Material-Design-y-CLI-de-Angular/\">Material Design y CLI de Angular</a> mientras aprendes a programar con Angular.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Deteccin del cambio en Angular","date":"2018-09-28T10:09:27.000Z","thumbnail":"/css/images/angular-9_change.png","_content":"\n![deteccion-del-cambio-en-Angular](/images/tutorial-angular-9_change.png)\n\nLa forma en que Angular realiza su renderizado y actualiza sus vistas es un factor clave para el rendimiento de las aplicaciones. Cmo funciona la estrategia de deteccin de cambios de Angular? Pues tiene dos modos: `default` o *automgico* y `onPush` o *mindfullness*.\n\nEs importante tomar consciencia porque es costoso realizar la deteccin ms veces de lo necesario y porque no hacerlo suficientemente implica no ver resultados reales. Con un mayor conocimiento del `changDetectionStrategy` y un poco de trabajo extra tendrs aplicaciones ms eficientes y mantenibles.\n\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Formularios reactivos con Angular](../formularios-reactivos-con-Angular/). Al finalizar tendrs una aplicacin que actualiza la vista slo cuando es necesario, es decir: cuando los datos han cambiado.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/AutoBot/9-change](https://github.com/AcademiaBinaria/autobot/tree/9-change)\n\n\n# 1 Comunicacin de datos entre componentes\n\nLa deteccin de cambios se dispara ante eventos que le ocurren a los componentes. **La deteccin se realiza componente a componete**, as que compensa tener muchos componentes pequeos, para que cada uno por si slo no genere demasiado ruido.\n\n## 1.1 Componentes Contenedores y Presentadores\n\nAl pasar de un nico componente a varios mini-componentes, se propone usar **el patrn contenedor / presentadores**. Se mantiene un componente padre que contiene mltiples componentes presentadores hijos. El contendor es el nico con acceso a los servicios de negocio y datos. Los presentadores reciben los datos y emiten eventos. Los presentadores no obtienen ni modifican por su cuenta.\n\nNomenclatura\n- **Container**: aka *Parent, Smart* \n- **Presenter**: aka *Child, Dumb*\n\n> Este reparto de responsabilidades es aconsejable independientemente de la estrategia de deteccin aplicada.\n\n# 2 Change detectionstrategies\n\nCon la aplicacin bien estructurada en componentes y con la comunicacin estandarizada, habremos reducido el impacto de la deteccin del cambio y estaremos preparados para optimizarlo. Conozcamos en detalle las estratgias de deteccin del cambio.\n\nEl decorador `@Component()` admite en su configuracin la poco conocida propiedad `changeDetection`. Que de forma explcita se usa as:\n\n``` typescript\nimport { ChangeDetectionStrategy, Component } from '@angular/core';\n@Component({\n  changeDetection: ChangeDetectionStrategy.Default,\n  selector: 'app-root',\n  template: `<h1>Changes are wellcome</h1> `\n})\nexport class AppComponent {}\n```\n\n# 2.1 Deteccin automtica, *default*\n\nPor defecto, Angular tiene que ser conservador y verificar cada posible cambio, esto se denomina comprobacin sucia o *dirty checking*. Se dispara **con demasiada frecuencia**, al menos en los siguientes casos: \n\n- Eventos desde el browser\n- Timers, intervals etc..\n- Llamadas http\n- Promesas y cdigo asncrono.\n\nPor si fuera poco, adems de dispararse mucho es **muy costoso**. Determinar que algo ha cambiado implica comparar dos estados: el actual y el anterior.\n\n> La comparacin es valor a valor, en profundidad, para cada objeto de cada array, para cada propiedad de cada objeto.\n\nContod, esta estrategia es cmoda para el programador y suficiente para casos bsicos. Pero demasiada mgia dificulta el control en aplicaciones complejas. Y en pantallas de mucha informacin e interaccin degrada el rendimiento percibido.\n\n# 2.2 Deteccin manual, *onPush*\n\nComo se puede preveer, la deteccin del cambio manual es lanzada por el programador. No siempre va a ser laborioso, pero ser ms consciente pues para que ocurra han de darse alguna de estas circunstancias:\n\n- **Explcitamente** el programador solicita la deteccin llamando a `ChangeDetectorRef.detectChanges();\n- **Implcitamente** al usar el `pipe Async` en la vista se llama a ese mismo mtodo.\n- **Conscientemente** el desarrollador obliga a un componente a repintarse si le cambia la referencia a un `@Input()`.\n\n> En este modo los componentes dejan de evaluar y comparar sus propiedades rutinariamente. Slo atienden a eventos `@Output()` o **cambios de referencia** `@Input()`. Esto relaja mucho al motor de Angular, que ya no tiene que hacer comparaciones odiosas. Sabr que algo ha cambiado porque... es otro objeto. \n\n# 3 Inmutabilidad\n\nComo ya se ha dicho, para que Angular en la estrategia automtica decida que algo ha cambiado necesita hacer una comparacin por valor. Para evitar ese coste usamos la estrategia manual y el programador tienen que cambiar la referencia de algo cuando quiera que Angualar repinte la vista. \n\n## 3.1 Por referencia y por valor\n\nNormalmente tendr que crear un nuevo objeto y reasignarlo en lugar del anterior en un **ciclo de clonacin, mutacin y asignacin**. Por costoso que parezca siempre compensa si evita muchas e innecesarias comparaciones por valor en estructuras profundas.\n\nLa estrategia `onPush` trata a todos los `Inputs` en inmutables, es decir, algo que no espera que cambie. Similar al paso de parmetros por valor, que si cambia es porque s otro puntero.\n\n## 3.2 El clonado\nEl potencialmente pesado trabajo de clonado lo podemos evitar en muchos casos usando alguna de estas tcnicas:\n\n- **Tipos primitivos** que se pasan por valor en las propiedades `@Input()`\n- **Arrays**: muchos mtodos como `.filter() .slice() .sort() .concat()` etc, devuelven nuevas referencias sin modificar el array original.\n- **Observables y el pipe Async**, pues en este caso se subscribe y lanza implcitamente la deteccin del cambio. Sin necesidad de clonar.\n\nPara los dems casos tenemos operadores *TypeScript* sencillos y optimizados para obtener nuevas referencias a partir de otros ya existentes.\n\n```typescript\nconst original = { name:'first', value:1 };\nconst cloned = { ...original };\nconst mutated = { ...original, value:2, newProperty: 'added' };\nconst list = [ original, cloned, mutated ];\nconst clonedList = [ ...list ];\nconst mutatedList = [ ...list, { name: 'new item'} ];\nconst newList = list.filter(i => i.name=='first');\n```\n\n\nYa tienes los conocimientos para acelerar y reducir la incertidumbre sobre el actualizacin de vistas usando el patrn contenedor / presentador junto con la estrategia de deteccin de cambios OnPush.\n\n> Para un ejemplo ms completo de estos conceptos explora los componentes [Home de Autobot](https://github.com/AcademiaBinaria/autobot/tree/9-change/src/app/home). En [Car](https://github.com/AcademiaBinaria/autobot/tree/9-change/src/app/car) tienes un ejemplo de notificacin manual usando `ChangeDetectorRef`.\n\nContina tu formacin avanzada aprendiendo a usar el [patrn Redux con NgRX en Angular](../el-patron-redux-con-ngrx-en-angular/) y vers como aprendes a programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-9-Deteccion-del-cambio-con-RxJS-y-Angular.md","raw":"---\ntitle: Deteccin del cambio en Angular\npermalink: deteccion-del-cambio-en-Angular\ndate: 2018-09-28 12:09:27\ntags:  \n- Angular\n- Angular7\n- Angular6\n- Angular2\n- ChangeDetection\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular] \nthumbnail: /css/images/angular-9_change.png\n---\n\n![deteccion-del-cambio-en-Angular](/images/tutorial-angular-9_change.png)\n\nLa forma en que Angular realiza su renderizado y actualiza sus vistas es un factor clave para el rendimiento de las aplicaciones. Cmo funciona la estrategia de deteccin de cambios de Angular? Pues tiene dos modos: `default` o *automgico* y `onPush` o *mindfullness*.\n\nEs importante tomar consciencia porque es costoso realizar la deteccin ms veces de lo necesario y porque no hacerlo suficientemente implica no ver resultados reales. Con un mayor conocimiento del `changDetectionStrategy` y un poco de trabajo extra tendrs aplicaciones ms eficientes y mantenibles.\n\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Formularios reactivos con Angular](../formularios-reactivos-con-Angular/). Al finalizar tendrs una aplicacin que actualiza la vista slo cuando es necesario, es decir: cuando los datos han cambiado.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/AutoBot/9-change](https://github.com/AcademiaBinaria/autobot/tree/9-change)\n\n\n# 1 Comunicacin de datos entre componentes\n\nLa deteccin de cambios se dispara ante eventos que le ocurren a los componentes. **La deteccin se realiza componente a componete**, as que compensa tener muchos componentes pequeos, para que cada uno por si slo no genere demasiado ruido.\n\n## 1.1 Componentes Contenedores y Presentadores\n\nAl pasar de un nico componente a varios mini-componentes, se propone usar **el patrn contenedor / presentadores**. Se mantiene un componente padre que contiene mltiples componentes presentadores hijos. El contendor es el nico con acceso a los servicios de negocio y datos. Los presentadores reciben los datos y emiten eventos. Los presentadores no obtienen ni modifican por su cuenta.\n\nNomenclatura\n- **Container**: aka *Parent, Smart* \n- **Presenter**: aka *Child, Dumb*\n\n> Este reparto de responsabilidades es aconsejable independientemente de la estrategia de deteccin aplicada.\n\n# 2 Change detectionstrategies\n\nCon la aplicacin bien estructurada en componentes y con la comunicacin estandarizada, habremos reducido el impacto de la deteccin del cambio y estaremos preparados para optimizarlo. Conozcamos en detalle las estratgias de deteccin del cambio.\n\nEl decorador `@Component()` admite en su configuracin la poco conocida propiedad `changeDetection`. Que de forma explcita se usa as:\n\n``` typescript\nimport { ChangeDetectionStrategy, Component } from '@angular/core';\n@Component({\n  changeDetection: ChangeDetectionStrategy.Default,\n  selector: 'app-root',\n  template: `<h1>Changes are wellcome</h1> `\n})\nexport class AppComponent {}\n```\n\n# 2.1 Deteccin automtica, *default*\n\nPor defecto, Angular tiene que ser conservador y verificar cada posible cambio, esto se denomina comprobacin sucia o *dirty checking*. Se dispara **con demasiada frecuencia**, al menos en los siguientes casos: \n\n- Eventos desde el browser\n- Timers, intervals etc..\n- Llamadas http\n- Promesas y cdigo asncrono.\n\nPor si fuera poco, adems de dispararse mucho es **muy costoso**. Determinar que algo ha cambiado implica comparar dos estados: el actual y el anterior.\n\n> La comparacin es valor a valor, en profundidad, para cada objeto de cada array, para cada propiedad de cada objeto.\n\nContod, esta estrategia es cmoda para el programador y suficiente para casos bsicos. Pero demasiada mgia dificulta el control en aplicaciones complejas. Y en pantallas de mucha informacin e interaccin degrada el rendimiento percibido.\n\n# 2.2 Deteccin manual, *onPush*\n\nComo se puede preveer, la deteccin del cambio manual es lanzada por el programador. No siempre va a ser laborioso, pero ser ms consciente pues para que ocurra han de darse alguna de estas circunstancias:\n\n- **Explcitamente** el programador solicita la deteccin llamando a `ChangeDetectorRef.detectChanges();\n- **Implcitamente** al usar el `pipe Async` en la vista se llama a ese mismo mtodo.\n- **Conscientemente** el desarrollador obliga a un componente a repintarse si le cambia la referencia a un `@Input()`.\n\n> En este modo los componentes dejan de evaluar y comparar sus propiedades rutinariamente. Slo atienden a eventos `@Output()` o **cambios de referencia** `@Input()`. Esto relaja mucho al motor de Angular, que ya no tiene que hacer comparaciones odiosas. Sabr que algo ha cambiado porque... es otro objeto. \n\n# 3 Inmutabilidad\n\nComo ya se ha dicho, para que Angular en la estrategia automtica decida que algo ha cambiado necesita hacer una comparacin por valor. Para evitar ese coste usamos la estrategia manual y el programador tienen que cambiar la referencia de algo cuando quiera que Angualar repinte la vista. \n\n## 3.1 Por referencia y por valor\n\nNormalmente tendr que crear un nuevo objeto y reasignarlo en lugar del anterior en un **ciclo de clonacin, mutacin y asignacin**. Por costoso que parezca siempre compensa si evita muchas e innecesarias comparaciones por valor en estructuras profundas.\n\nLa estrategia `onPush` trata a todos los `Inputs` en inmutables, es decir, algo que no espera que cambie. Similar al paso de parmetros por valor, que si cambia es porque s otro puntero.\n\n## 3.2 El clonado\nEl potencialmente pesado trabajo de clonado lo podemos evitar en muchos casos usando alguna de estas tcnicas:\n\n- **Tipos primitivos** que se pasan por valor en las propiedades `@Input()`\n- **Arrays**: muchos mtodos como `.filter() .slice() .sort() .concat()` etc, devuelven nuevas referencias sin modificar el array original.\n- **Observables y el pipe Async**, pues en este caso se subscribe y lanza implcitamente la deteccin del cambio. Sin necesidad de clonar.\n\nPara los dems casos tenemos operadores *TypeScript* sencillos y optimizados para obtener nuevas referencias a partir de otros ya existentes.\n\n```typescript\nconst original = { name:'first', value:1 };\nconst cloned = { ...original };\nconst mutated = { ...original, value:2, newProperty: 'added' };\nconst list = [ original, cloned, mutated ];\nconst clonedList = [ ...list ];\nconst mutatedList = [ ...list, { name: 'new item'} ];\nconst newList = list.filter(i => i.name=='first');\n```\n\n\nYa tienes los conocimientos para acelerar y reducir la incertidumbre sobre el actualizacin de vistas usando el patrn contenedor / presentador junto con la estrategia de deteccin de cambios OnPush.\n\n> Para un ejemplo ms completo de estos conceptos explora los componentes [Home de Autobot](https://github.com/AcademiaBinaria/autobot/tree/9-change/src/app/home). En [Car](https://github.com/AcademiaBinaria/autobot/tree/9-change/src/app/car) tienes un ejemplo de notificacin manual usando `ChangeDetectorRef`.\n\nContina tu formacin avanzada aprendiendo a usar el [patrn Redux con NgRX en Angular](../el-patron-redux-con-ngrx-en-angular/) y vers como aprendes a programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"deteccion-del-cambio-en-Angular","published":1,"updated":"2018-12-03T16:39:36.951Z","_id":"cjmkd6hs90000rks32qduqzm3","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-9_change.png\" alt=\"deteccion-del-cambio-en-Angular\"></p><p>La forma en que Angular realiza su renderizado y actualiza sus vistas es un factor clave para el rendimiento de las aplicaciones. Cmo funciona la estrategia de deteccin de cambios de Angular? Pues tiene dos modos: <code>default</code> o <em>automgico</em> y <code>onPush</code> o <em>mindfullness</em>.</p><p>Es importante tomar consciencia porque es costoso realizar la deteccin ms veces de lo necesario y porque no hacerlo suficientemente implica no ver resultados reales. Con un mayor conocimiento del <code>changDetectionStrategy</code> y un poco de trabajo extra tendrs aplicaciones ms eficientes y mantenibles.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal cmo qued en <a href=\"../formularios-reactivos-con-Angular/\">Formularios reactivos con Angular</a>. Al finalizar tendrs una aplicacin que actualiza la vista slo cuando es necesario, es decir: cuando los datos han cambiado.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/autobot/tree/9-change\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/AutoBot/9-change</a></p></blockquote><h1 id=\"1-Comunicacion-de-datos-entre-componentes\"><a href=\"#1-Comunicacion-de-datos-entre-componentes\" class=\"headerlink\" title=\"1 Comunicacin de datos entre componentes\"></a>1 Comunicacin de datos entre componentes</h1><p>La deteccin de cambios se dispara ante eventos que le ocurren a los componentes. <strong>La deteccin se realiza componente a componete</strong>, as que compensa tener muchos componentes pequeos, para que cada uno por si slo no genere demasiado ruido.</p><h2 id=\"1-1-Componentes-Contenedores-y-Presentadores\"><a href=\"#1-1-Componentes-Contenedores-y-Presentadores\" class=\"headerlink\" title=\"1.1 Componentes Contenedores y Presentadores\"></a>1.1 Componentes Contenedores y Presentadores</h2><p>Al pasar de un nico componente a varios mini-componentes, se propone usar <strong>el patrn contenedor / presentadores</strong>. Se mantiene un componente padre que contiene mltiples componentes presentadores hijos. El contendor es el nico con acceso a los servicios de negocio y datos. Los presentadores reciben los datos y emiten eventos. Los presentadores no obtienen ni modifican por su cuenta.</p><p>Nomenclatura</p><ul><li><strong>Container</strong>: aka <em>Parent, Smart</em></li><li><strong>Presenter</strong>: aka <em>Child, Dumb</em></li></ul><blockquote><p>Este reparto de responsabilidades es aconsejable independientemente de la estrategia de deteccin aplicada.</p></blockquote><h1 id=\"2-Change-detectionstrategies\"><a href=\"#2-Change-detectionstrategies\" class=\"headerlink\" title=\"2 Change detectionstrategies\"></a>2 Change detectionstrategies</h1><p>Con la aplicacin bien estructurada en componentes y con la comunicacin estandarizada, habremos reducido el impacto de la deteccin del cambio y estaremos preparados para optimizarlo. Conozcamos en detalle las estratgias de deteccin del cambio.</p><p>El decorador <code>@Component()</code> admite en su configuracin la poco conocida propiedad <code>changeDetection</code>. Que de forma explcita se usa as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; ChangeDetectionStrategy, Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  changeDetection: ChangeDetectionStrategy.Default,</span><br><span class=\"line\">  selector: <span class=\"string\">'app-root'</span>,</span><br><span class=\"line\">  template: <span class=\"string\">`&lt;h1&gt;Changes are wellcome&lt;/h1&gt; `</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;&#125;</span><br></pre></td></tr></table></figure><h1 id=\"2-1-Deteccion-automatica-default\"><a href=\"#2-1-Deteccion-automatica-default\" class=\"headerlink\" title=\"2.1 Deteccin automtica, default\"></a>2.1 Deteccin automtica, <em>default</em></h1><p>Por defecto, Angular tiene que ser conservador y verificar cada posible cambio, esto se denomina comprobacin sucia o <em>dirty checking</em>. Se dispara <strong>con demasiada frecuencia</strong>, al menos en los siguientes casos:</p><ul><li>Eventos desde el browser</li><li>Timers, intervals etc..</li><li>Llamadas http</li><li>Promesas y cdigo asncrono.</li></ul><p>Por si fuera poco, adems de dispararse mucho es <strong>muy costoso</strong>. Determinar que algo ha cambiado implica comparar dos estados: el actual y el anterior.</p><blockquote><p>La comparacin es valor a valor, en profundidad, para cada objeto de cada array, para cada propiedad de cada objeto.</p></blockquote><p>Contod, esta estrategia es cmoda para el programador y suficiente para casos bsicos. Pero demasiada mgia dificulta el control en aplicaciones complejas. Y en pantallas de mucha informacin e interaccin degrada el rendimiento percibido.</p><h1 id=\"2-2-Deteccion-manual-onPush\"><a href=\"#2-2-Deteccion-manual-onPush\" class=\"headerlink\" title=\"2.2 Deteccin manual, onPush\"></a>2.2 Deteccin manual, <em>onPush</em></h1><p>Como se puede preveer, la deteccin del cambio manual es lanzada por el programador. No siempre va a ser laborioso, pero ser ms consciente pues para que ocurra han de darse alguna de estas circunstancias:</p><ul><li><strong>Explcitamente</strong> el programador solicita la deteccin llamando a `ChangeDetectorRef.detectChanges();</li><li><strong>Implcitamente</strong> al usar el <code>pipe Async</code> en la vista se llama a ese mismo mtodo.</li><li><strong>Conscientemente</strong> el desarrollador obliga a un componente a repintarse si le cambia la referencia a un <code>@Input()</code>.</li></ul><blockquote><p>En este modo los componentes dejan de evaluar y comparar sus propiedades rutinariamente. Slo atienden a eventos <code>@Output()</code> o <strong>cambios de referencia</strong> <code>@Input()</code>. Esto relaja mucho al motor de Angular, que ya no tiene que hacer comparaciones odiosas. Sabr que algo ha cambiado porque es otro objeto.</p></blockquote><h1 id=\"3-Inmutabilidad\"><a href=\"#3-Inmutabilidad\" class=\"headerlink\" title=\"3 Inmutabilidad\"></a>3 Inmutabilidad</h1><p>Como ya se ha dicho, para que Angular en la estrategia automtica decida que algo ha cambiado necesita hacer una comparacin por valor. Para evitar ese coste usamos la estrategia manual y el programador tienen que cambiar la referencia de algo cuando quiera que Angualar repinte la vista.</p><h2 id=\"3-1-Por-referencia-y-por-valor\"><a href=\"#3-1-Por-referencia-y-por-valor\" class=\"headerlink\" title=\"3.1 Por referencia y por valor\"></a>3.1 Por referencia y por valor</h2><p>Normalmente tendr que crear un nuevo objeto y reasignarlo en lugar del anterior en un <strong>ciclo de clonacin, mutacin y asignacin</strong>. Por costoso que parezca siempre compensa si evita muchas e innecesarias comparaciones por valor en estructuras profundas.</p><p>La estrategia <code>onPush</code> trata a todos los <code>Inputs</code> en inmutables, es decir, algo que no espera que cambie. Similar al paso de parmetros por valor, que si cambia es porque s otro puntero.</p><h2 id=\"3-2-El-clonado\"><a href=\"#3-2-El-clonado\" class=\"headerlink\" title=\"3.2 El clonado\"></a>3.2 El clonado</h2><p>El potencialmente pesado trabajo de clonado lo podemos evitar en muchos casos usando alguna de estas tcnicas:</p><ul><li><strong>Tipos primitivos</strong> que se pasan por valor en las propiedades <code>@Input()</code></li><li><strong>Arrays</strong>: muchos mtodos como <code>.filter() .slice() .sort() .concat()</code> etc, devuelven nuevas referencias sin modificar el array original.</li><li><strong>Observables y el pipe Async</strong>, pues en este caso se subscribe y lanza implcitamente la deteccin del cambio. Sin necesidad de clonar.</li></ul><p>Para los dems casos tenemos operadores <em>TypeScript</em> sencillos y optimizados para obtener nuevas referencias a partir de otros ya existentes.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> original = &#123; name:<span class=\"string\">'first'</span>, value:<span class=\"number\">1</span> &#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> cloned = &#123; ...original &#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mutated = &#123; ...original, value:<span class=\"number\">2</span>, newProperty: <span class=\"string\">'added'</span> &#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> list = [ original, cloned, mutated ];</span><br><span class=\"line\"><span class=\"keyword\">const</span> clonedList = [ ...list ];</span><br><span class=\"line\"><span class=\"keyword\">const</span> mutatedList = [ ...list, &#123; name: <span class=\"string\">'new item'</span>&#125; ];</span><br><span class=\"line\"><span class=\"keyword\">const</span> newList = list.filter(<span class=\"function\"><span class=\"params\">i</span> =&gt;</span> i.name==<span class=\"string\">'first'</span>);</span><br></pre></td></tr></table></figure><p>Ya tienes los conocimientos para acelerar y reducir la incertidumbre sobre el actualizacin de vistas usando el patrn contenedor / presentador junto con la estrategia de deteccin de cambios OnPush.</p><blockquote><p>Para un ejemplo ms completo de estos conceptos explora los componentes <a href=\"https://github.com/AcademiaBinaria/autobot/tree/9-change/src/app/home\" target=\"_blank\" rel=\"noopener\">Home de Autobot</a>. En <a href=\"https://github.com/AcademiaBinaria/autobot/tree/9-change/src/app/car\" target=\"_blank\" rel=\"noopener\">Car</a> tienes un ejemplo de notificacin manual usando <code>ChangeDetectorRef</code>.</p></blockquote><p>Contina tu formacin avanzada aprendiendo a usar el <a href=\"../el-patron-redux-con-ngrx-en-angular/\">patrn Redux con NgRX en Angular</a> y vers como aprendes a programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-9_change.png\" alt=\"deteccion-del-cambio-en-Angular\"></p><p>La forma en que Angular realiza su renderizado y actualiza sus vistas es un factor clave para el rendimiento de las aplicaciones. Cmo funciona la estrategia de deteccin de cambios de Angular? Pues tiene dos modos: <code>default</code> o <em>automgico</em> y <code>onPush</code> o <em>mindfullness</em>.</p><p>Es importante tomar consciencia porque es costoso realizar la deteccin ms veces de lo necesario y porque no hacerlo suficientemente implica no ver resultados reales. Con un mayor conocimiento del <code>changDetectionStrategy</code> y un poco de trabajo extra tendrs aplicaciones ms eficientes y mantenibles.</p>","more":"<p>Partiendo de la aplicacin tal cmo qued en <a href=\"../formularios-reactivos-con-Angular/\">Formularios reactivos con Angular</a>. Al finalizar tendrs una aplicacin que actualiza la vista slo cuando es necesario, es decir: cuando los datos han cambiado.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/autobot/tree/9-change\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/AutoBot/9-change</a></p></blockquote><h1 id=\"1-Comunicacion-de-datos-entre-componentes\"><a href=\"#1-Comunicacion-de-datos-entre-componentes\" class=\"headerlink\" title=\"1 Comunicacin de datos entre componentes\"></a>1 Comunicacin de datos entre componentes</h1><p>La deteccin de cambios se dispara ante eventos que le ocurren a los componentes. <strong>La deteccin se realiza componente a componete</strong>, as que compensa tener muchos componentes pequeos, para que cada uno por si slo no genere demasiado ruido.</p><h2 id=\"1-1-Componentes-Contenedores-y-Presentadores\"><a href=\"#1-1-Componentes-Contenedores-y-Presentadores\" class=\"headerlink\" title=\"1.1 Componentes Contenedores y Presentadores\"></a>1.1 Componentes Contenedores y Presentadores</h2><p>Al pasar de un nico componente a varios mini-componentes, se propone usar <strong>el patrn contenedor / presentadores</strong>. Se mantiene un componente padre que contiene mltiples componentes presentadores hijos. El contendor es el nico con acceso a los servicios de negocio y datos. Los presentadores reciben los datos y emiten eventos. Los presentadores no obtienen ni modifican por su cuenta.</p><p>Nomenclatura</p><ul><li><strong>Container</strong>: aka <em>Parent, Smart</em></li><li><strong>Presenter</strong>: aka <em>Child, Dumb</em></li></ul><blockquote><p>Este reparto de responsabilidades es aconsejable independientemente de la estrategia de deteccin aplicada.</p></blockquote><h1 id=\"2-Change-detectionstrategies\"><a href=\"#2-Change-detectionstrategies\" class=\"headerlink\" title=\"2 Change detectionstrategies\"></a>2 Change detectionstrategies</h1><p>Con la aplicacin bien estructurada en componentes y con la comunicacin estandarizada, habremos reducido el impacto de la deteccin del cambio y estaremos preparados para optimizarlo. Conozcamos en detalle las estratgias de deteccin del cambio.</p><p>El decorador <code>@Component()</code> admite en su configuracin la poco conocida propiedad <code>changeDetection</code>. Que de forma explcita se usa as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; ChangeDetectionStrategy, Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  changeDetection: ChangeDetectionStrategy.Default,</span><br><span class=\"line\">  selector: <span class=\"string\">'app-root'</span>,</span><br><span class=\"line\">  template: <span class=\"string\">`&lt;h1&gt;Changes are wellcome&lt;/h1&gt; `</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent &#123;&#125;</span><br></pre></td></tr></table></figure><h1 id=\"2-1-Deteccion-automatica-default\"><a href=\"#2-1-Deteccion-automatica-default\" class=\"headerlink\" title=\"2.1 Deteccin automtica, default\"></a>2.1 Deteccin automtica, <em>default</em></h1><p>Por defecto, Angular tiene que ser conservador y verificar cada posible cambio, esto se denomina comprobacin sucia o <em>dirty checking</em>. Se dispara <strong>con demasiada frecuencia</strong>, al menos en los siguientes casos:</p><ul><li>Eventos desde el browser</li><li>Timers, intervals etc..</li><li>Llamadas http</li><li>Promesas y cdigo asncrono.</li></ul><p>Por si fuera poco, adems de dispararse mucho es <strong>muy costoso</strong>. Determinar que algo ha cambiado implica comparar dos estados: el actual y el anterior.</p><blockquote><p>La comparacin es valor a valor, en profundidad, para cada objeto de cada array, para cada propiedad de cada objeto.</p></blockquote><p>Contod, esta estrategia es cmoda para el programador y suficiente para casos bsicos. Pero demasiada mgia dificulta el control en aplicaciones complejas. Y en pantallas de mucha informacin e interaccin degrada el rendimiento percibido.</p><h1 id=\"2-2-Deteccion-manual-onPush\"><a href=\"#2-2-Deteccion-manual-onPush\" class=\"headerlink\" title=\"2.2 Deteccin manual, onPush\"></a>2.2 Deteccin manual, <em>onPush</em></h1><p>Como se puede preveer, la deteccin del cambio manual es lanzada por el programador. No siempre va a ser laborioso, pero ser ms consciente pues para que ocurra han de darse alguna de estas circunstancias:</p><ul><li><strong>Explcitamente</strong> el programador solicita la deteccin llamando a `ChangeDetectorRef.detectChanges();</li><li><strong>Implcitamente</strong> al usar el <code>pipe Async</code> en la vista se llama a ese mismo mtodo.</li><li><strong>Conscientemente</strong> el desarrollador obliga a un componente a repintarse si le cambia la referencia a un <code>@Input()</code>.</li></ul><blockquote><p>En este modo los componentes dejan de evaluar y comparar sus propiedades rutinariamente. Slo atienden a eventos <code>@Output()</code> o <strong>cambios de referencia</strong> <code>@Input()</code>. Esto relaja mucho al motor de Angular, que ya no tiene que hacer comparaciones odiosas. Sabr que algo ha cambiado porque es otro objeto.</p></blockquote><h1 id=\"3-Inmutabilidad\"><a href=\"#3-Inmutabilidad\" class=\"headerlink\" title=\"3 Inmutabilidad\"></a>3 Inmutabilidad</h1><p>Como ya se ha dicho, para que Angular en la estrategia automtica decida que algo ha cambiado necesita hacer una comparacin por valor. Para evitar ese coste usamos la estrategia manual y el programador tienen que cambiar la referencia de algo cuando quiera que Angualar repinte la vista.</p><h2 id=\"3-1-Por-referencia-y-por-valor\"><a href=\"#3-1-Por-referencia-y-por-valor\" class=\"headerlink\" title=\"3.1 Por referencia y por valor\"></a>3.1 Por referencia y por valor</h2><p>Normalmente tendr que crear un nuevo objeto y reasignarlo en lugar del anterior en un <strong>ciclo de clonacin, mutacin y asignacin</strong>. Por costoso que parezca siempre compensa si evita muchas e innecesarias comparaciones por valor en estructuras profundas.</p><p>La estrategia <code>onPush</code> trata a todos los <code>Inputs</code> en inmutables, es decir, algo que no espera que cambie. Similar al paso de parmetros por valor, que si cambia es porque s otro puntero.</p><h2 id=\"3-2-El-clonado\"><a href=\"#3-2-El-clonado\" class=\"headerlink\" title=\"3.2 El clonado\"></a>3.2 El clonado</h2><p>El potencialmente pesado trabajo de clonado lo podemos evitar en muchos casos usando alguna de estas tcnicas:</p><ul><li><strong>Tipos primitivos</strong> que se pasan por valor en las propiedades <code>@Input()</code></li><li><strong>Arrays</strong>: muchos mtodos como <code>.filter() .slice() .sort() .concat()</code> etc, devuelven nuevas referencias sin modificar el array original.</li><li><strong>Observables y el pipe Async</strong>, pues en este caso se subscribe y lanza implcitamente la deteccin del cambio. Sin necesidad de clonar.</li></ul><p>Para los dems casos tenemos operadores <em>TypeScript</em> sencillos y optimizados para obtener nuevas referencias a partir de otros ya existentes.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> original = &#123; name:<span class=\"string\">'first'</span>, value:<span class=\"number\">1</span> &#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> cloned = &#123; ...original &#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mutated = &#123; ...original, value:<span class=\"number\">2</span>, newProperty: <span class=\"string\">'added'</span> &#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> list = [ original, cloned, mutated ];</span><br><span class=\"line\"><span class=\"keyword\">const</span> clonedList = [ ...list ];</span><br><span class=\"line\"><span class=\"keyword\">const</span> mutatedList = [ ...list, &#123; name: <span class=\"string\">'new item'</span>&#125; ];</span><br><span class=\"line\"><span class=\"keyword\">const</span> newList = list.filter(<span class=\"function\"><span class=\"params\">i</span> =&gt;</span> i.name==<span class=\"string\">'first'</span>);</span><br></pre></td></tr></table></figure><p>Ya tienes los conocimientos para acelerar y reducir la incertidumbre sobre el actualizacin de vistas usando el patrn contenedor / presentador junto con la estrategia de deteccin de cambios OnPush.</p><blockquote><p>Para un ejemplo ms completo de estos conceptos explora los componentes <a href=\"https://github.com/AcademiaBinaria/autobot/tree/9-change/src/app/home\" target=\"_blank\" rel=\"noopener\">Home de Autobot</a>. En <a href=\"https://github.com/AcademiaBinaria/autobot/tree/9-change/src/app/car\" target=\"_blank\" rel=\"noopener\">Car</a> tienes un ejemplo de notificacin manual usando <code>ChangeDetectorRef</code>.</p></blockquote><p>Contina tu formacin avanzada aprendiendo a usar el <a href=\"../el-patron-redux-con-ngrx-en-angular/\">patrn Redux con NgRX en Angular</a> y vers como aprendes a programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"El patrn Redux con NgRx en Angular","date":"2018-10-08T10:50:27.000Z","thumbnail":"/css/images/angular-a_redux.png","_content":"\n![el-patron-redux-con-ngrx-en-angular](/images/tutorial-angular-a_redux.png)\n\nLe pasa a todas las aplicaciones. Crecen y crecen en funcionalidad y complejidad. En Angular estamos preparados para modularizar, componentizar e inyectar servicios. Pero con grandes aplicaciones, o con grandes equipos, parece que nada es suficiente. Se necesita una **gestin del estado centralizada** como la del patrn Redux.\n\n**Redux no hace rpido lo simple, sino mantenible lo complejo**. Y si tienes delante un desarrollo complejo, te recomiendo que uses *NgRX*; la solucin estndar para implementar **Redux con Angular**.\n\n\n<!-- more -->\n\nPartiendo del cdigo tal cmo qued en [Deteccin del cambio en Angular](../deteccion-del-cambio-en-Angular/). Al finalizar tendrs una aplicacin que gestiona centralizadamente los cambios, que permite conocer qu ocurri y predecir lo que ocurrir.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/AutoBot/a-redux](https://github.com/AcademiaBinaria/autobot/tree/a-redux)\n\n\n# 1 El patrn Redux\n\nRedux es como una base de datos, es en un almacn para el estado de la aplicacin. Pero un almacn que gestiona sus cambios de manera predictiva. Combina dos patrones: *Action* para el envio de comandos para actualizar el estado del almacn; y *Observable* para la subscripcin a cambios en el estado del almacn. **Desacopla los emisores de acciones de los receptores de cambios** en los datos.\n\nPara lograrlo tendremos que cumplir una serie de principios y utilizar unos elementos predefinidos. Esto introduce capas de abstraccin y burocracia que inicialmente complican el desarrollo. Pero a medio plazo harn que mantener la aplicacin sea mucho ms sencillo y seguro.\n\n## 1.1 Principios de Redux\n\nTenemos tres principios bsicos que cumplir:\n\n- **Single Source Of Truth**: Cada pieza de informacin se almacena en un nico lugar, independientemente de dnde sea creada, modificada o requerida.\n- **Read Only State**: La informacin ser de slo lectura y slo podr modificarse a travs de conductos oficiales.\n- **Changes By Pure Functions**: Los cambios tienen que poder ser replicados, cancelados y auditados; lo mejor, usar una funcin pura.\n\n## 1.1 Elementos de Redux\n\nEstos son los artificios fundamentales que incorporaremos a nuestro desarrollo:\n\n- **Store**: El sistema que mantiene el estado. Despacha acciones de mutado sobre el mismo y comunica cambios enviando copias de slo lectura a los subscriptores.\n- **State**: rbol de objetos que contienen la nica copia vlida de la informacin. Representa el valor del almacn en un momento determinado.\n- **Actions**: Objetos identificados por un tipo y cargados con un *payload*. Transmiten una intencin de mutacin sobre el estado del *store*. \n- **Reducers** : Son funciones puras, que ostentan la exclusividad de poder mutar el estado. Reciben dos argumentos: el estado actual y una accin con su tipo y su carga. Clonan el estado, realizan los cambios oportunos y devuelven el estado mutado.\n\n> Los funciones reductoras, al ser puras, mezclan la programacin funcional con la orientada a objetos. Un reto pero tambin una demostracin de la coexistencia de paradigmas en un mismo desarrollo.\n\n\n# 2 NgRx\n\nNgRx es el estndar de facto para implementar Redux en Angular. Est basada en *RxJS* y es una librera modular con todo lo necesario para crear grandes aplicaciones. Esto son los mdulos que la componen:\n\n- **store**: Es el mdulo principal con el administrador del estado centralizado y reactivo.\n- **store-devtools**: Instrumentacin para depurar desde el navegador. Vale su peso en oro. \n- **router-Store** : Almacena el estado del *router* de Angular en el *store*, tratando cada evento como una accin Redux.\n- **effects**: Los reductores son funciones puras sin efectos colaterales. Este mdulo es la solucin para comandos asncronos.\n- **schematics, entity, ngrx-data**: Son otros mdulos opcionales con ayudas y plantillas de NgRX.\n\n## 2.1 Instalacin y configuracin\n\nPara agregar *NgRx* a un app te propongo la siguiente receta de comandos. Adems de esto tendrs que instalar en tu navegador las herramientas de diagnstico [Redux DevTools](http://extension.remotedev.io/).\n\n```shell\nnpm i @angular-devkit/schematics --save-dev\nnpm i @ngrx/schematics --save-dev\nng config cli.defaultCollection @ngrx/schematics\nnpm i @ngrx/store --save\nnpm i @ngrx/store-devtools --save \nng g st RootState --root -m app.module.ts --spec false\nnpm install @ngrx/router-store --save \n```\nCon esto habrs instalado y configurado NgRx en tu app. Completa tu mdulo principal para que tenga algo as:\n\n```typescript\n@NgModule({\n  imports: [\n    CommonModule,\n    RouterModule,\n    StoreModule.forRoot(rootReducers, { metaReducers }),\n    StoreRouterConnectingModule.forRoot({ stateKey: 'router' }),\n    !environment.production ? StoreDevtoolsModule.instrument() : []\n  ]\n})\nexport class AppModule {}\n```\n\n> El cdigo generado por `@ngrx/schematics` no es para todos los gustos. Tmalo como un punto de partida y crea la estructura que mejor te encaje. En [Autobot](https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/core/store/state) he empezado por llevarlo todo al `CoreModule` y guardarlo en una carpeta propia convenientemente nombrada `store/state`. Vemosla en detalle.\n\n## 2.2 State y reducers, los cambios de estado mediante reductores\n\nEl estado en *redux* es un objeto tipado a partir de una interfaz, normalmente llamada `State` a secas, aunque yo prefiero identificarla como `RootState`. Tendr propiedades para almacenar objetos ms o menos complejos. Cada propiedad tendr su propio tipo complejo y ser gestionada por una funcin reductora especfica. Se necesita un proceso de mapeo que asigne la funcin reductora a cada propiedad del estado raiz. Eso es lo que hace este cdigo:\n\n```typescript\nexport interface RootState {\n  router: any;\n  global: GlobalState;\n  cars: CarsState;\n}\n\nexport const rootReducers: ActionReducerMap<RootState> = {\n  router: routerReducer,\n  global: globalreducer,\n  cars: carsReducer\n};\n```\n\nLas funciones reductoras pueden estar en cualquier fichero. Son puras y no deben ser includas en ninguna clase. Normalmente tendrs un fichero para cada reductor. El del *router* ya viene hecho por NgRx, todos los dems son cosa tuya. Por ejemplo este es el reductor sobre la propiedad `global: GlobalState`.\n\n```typescript\nexport function globalReducer(state = initialState, action: GlobalActions): GlobalState {\n  switch (action.type) {\n    case GlobalActionTypes.SendUserMessage:\n      return { ...state, userMessage: action.payload };\n    case GlobalActionTypes.IsLoginNeeded:\n      return { ...state, loginNeeded: action.payload };\n    case GlobalActionTypes.StoreToken:\n      return { ...state, token: action.payload };\n    default:\n      return state;\n  }\n}\n```\n\nComo puedes ver esta funcin recibe dos argumento: el estado y la accin que pretende mutarlo. **La accin es un objeto** con dos propiedades. La primera y obligatoria es el tipo y sirve para escoger la lgica que se aplicar. La otra, opcional, es el `payload` que acta como argumento de la accin. El reductor no puede usar nada ms que estos argumentos: **state y action**. Y por ser puro no puede mutar ninguno, por tanto tiene que clonar el estado recibido antes de aplicarle cualquier cambio. Una vez efectuado el cambio, usando el *payload* si es preciso, devolver el clon mutado.\n\n## 2.3 Actions, las acciones permitidas\n\nEl patrn Redux no obliga a grandes cosas respecto a cmo implementar las acciones. Lo nico que de verdad necesitas es crear objetos con una propiedad obligatoria `type` y otra opcional `payoload`.\n\nPero en NgRX han decidido aprovechar al mximo las papacidades del *TypeScript* y proponen usar un cdigo fuertemente tipado. Para empezar crean un `enum` que detalla los posible tipos de una accin y les asigna un texto para que luzcan y faciliten su bsqueda en *logs*. \n\n```typescript\nexport enum GlobalActionTypes {\n  SendUserMessage = '[Global] Show Message',\n  IsLoginNeeded = '[Auth] Is Login Needed',\n  StoreToken = '[Auth] Store Token'\n}\n```\n\nY claro, en un ambiente tipado, la accin ser una clase que ha de cumplir una interfaz. En dicha clase queda ya predetermindo su tipo de accin; y por supuesto que permiten fijar el tipo de datos de la `payload`. Todo ello genera un cdigo como el siguiente.\n\n```typescript\nexport class SendUserMesage implements Action {\n  readonly type = GlobalActionTypes.SendUserMessage;\n  constructor(public payload: string) {}\n}\n```\n\nPara terminar, y ya que habremos de crear un buen nmero de clases para las acciones, tambin nos propone exprimir *TypeScript* para crear un tipo combinado que ofrezca a los consumidores el plantel completo y delimitado de acciones posibles.\n\n```typescript\nexport type GlobalActions = SendUserMesage | IsLoginNeeded | StoreToken;\n```\n\nEs normal que al principio todo este *boilerplate* te parezca un exceso. Pero entre las plantillas, los *snipets* y el *copy and paste* no es tan trabajoso como pudiera parecer. A cambio tienes un cdigo robusto y explcitamente detallado. \n\n## 2.4 Dispatch y Select, despacho de acciones y seleccin de cambios\n\nDesde el resto del cdigo **la comunicacin con este estado centralizado se realizar por dos conductos oficiales : Dispatch y Select**. El primero es un mtodo que recibe como nico parmetro una instancia de una accin. Dicha instancia lleva implcito el tipo y puede ir rellena de una *payload*. As es como se envan los cambios hacia el almacn.\n\n```typescript\nconstructor(private store: Store<RootState>) {\n  this.store.dispatch(new SendUserMesage('Tutorial Angular en Espaol'));\n}\n```\n\nNo esperamos respuesta de este mtodo. Es un mundo de *fire and forget*. Pero en cualquier otro lugar o lugares de nuestro cdigo podremos recibir notificicadciones de cualquier cambio que se haya producido. De forma desacoplada podremos recibir el mensaje con una simple subscripcin *RxJS*.\n\n```typescript\nthis.store\n  .select('global', 'userMessage')\n  .subscribe(userMessage: string => console.log(userMessage));\n```\n\nA este mtodo de consulta asncrona se le enva un argumento con mltiples sobrecargas llamado *selector*. En este caso est formado por dos claves que apuntan a una propiedad concreta en la que estoy interesado: `global.userMessage`.\n\nCon esto tenemos una primera implementacin del patrn Redux en Angular usando NgRx. Pero an hay ms.\n\n# 3 Efectos y mdulos funcionales\n\nLas funciones reductoras, como ya se ha dicho, deben ser puras. La idea es que puedan ser auditadas, re-ejecutadas y testeadas sin que necesiten servicios externos ni causen efectos colaterales. Y esto es un problema con la cantidad de **ejecuciones asncronas en las aplicaciones web**. Cualquier tentacin de lanzar una llamada *AJAX* dentro de un reductor debe ser elimindad de inmediato. \n\n> Dos razones: por un lado en Angular se necesita invocar al *httpClient* de alguna manera para realizar la llamada *AJAX*. Y, ya que la funcin no pertenece a ninguna clase, no puede haber constructor que reclame la inyeccin de dicho servicio. Tampoco las funciones puras tienen permitido usar nada que no venga entre sus argumentos. Por otra parte las funciones puras han de ser predecibles, y una llamada a un servidor remoto no es en absoluto predecible. Puede pasarle de todo, as que los reductores no son pas para procesos asncronos.\n\nLa solucin que proponen *NgRX* es usar un artificio llamado efecto, porque ser encargado de **los efectos secundarios que provocan las las instrucciones asncronas**. De una forma simplista, diremos que las acciones asncronas se multiplicarn por tres. El comando que genera la llamada, y los dos potenciales eventos con la respuesta correcta o el error.\n\nPara manejarlo todo incluyen en la librera el mdulo `EffectsModule` que ha de registrarse junto al `StoreModule`. Desde ese momento *NgRX* activa un sistema de seguimiento que trata las acciones como un stream de *RxJS* y permite subscribirse a la invocacin de dichas acciones y tratarlas adecuadamente. Una vez ms, aprovechan las caratersticas del *TypeScript* y hacen uso de los decoradores para definir las funciones que respondern a la ejecucin de las acciones.\n\n## 3.1 @Effect(), efectos secundarios\n\nEl decorador `@Effect()` se aplica a propiedades de servicios estandar de Angular. *NgRX* invoca esas funciones ante cada accin despachada, as que lo primero que debemos hacer es aplicar un filtro para quedarnos con las acciones del tipo que nos interese. El que lanzar la llamda `http`. \n\n> Todo el trabajo se realizar con *streams* y requiere de un conocimiento previo de la librera *RxJS* y de la mecnica de su mtodo `pipe` y sus operadores reactivos.\n\nCuando llegue una de esas acciones realizaremos la llamada asncrona sin complejos. Recordemos que un efecto forma parte de un servicio inyectable de Angular. No tienen ninguna restriccin funcional por parte de Redux. Obviamente la respuesta debe ser capturada y tratada segn haya sido correcta o no. \n\nSi recibimos una respuesta vlida podremos retornar directamente una nueva accin que actualice el estado con los datos recibidos. En cambio si ha habido un error, habr que reactivar el *stream* con un nuevo observable que emita la accin que procesar el error.\n\n```typescript\n@Effect()\nconstructor(private actions$: Actions, private cars: CarsService) {}\n\npublic loadCarsEffect$: Observable<CarsActions> = this.actions$.pipe(\n  ofType<LoadCars>(CarsActionTypes.LoadCars),\n  mergeMap(() =>\n    this.cars.getCars$().pipe(\n      map((cars: Car[]) => new LoadCarsOK(cars)),\n      catchError(err => of(new LoadCarsError('Error loading cars')))\n    )\n  )\n);\n```\n\nTmate el tiempo necesario para comprender este cdigo. Especialmente los operadores `ofType` de *NgRX* y el `mergeMap` de *RxJS*. Fjate bien en los tipos de los datos recibidos y devueltos. El efecto trata con observables de acciones. Recibe una y devuelve otra que puede ser de alguno de los otros dos tipos previstos. En el caso correcto se cambia una accin por otra, en otro caso se crea un nuevo observable mediante el constructor `of()` antes del retorno.\n\n> Para un ejemplo ms completo de estos conceptos explora la implementacin en el proyecto Autobot. El [RootStore](https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/core) hace uso de efectos en la carpeta `store/state/cars`.\n\n## 3.2 Feature, mdulos funcionales\n\nYa que Redux est especialmente indicado en grandes aplicaciones pero manteniendo un estado centralizado, es fcil que acabemos con un mdulo raiz demasiado pesado que ralentice el inicio de la aplicacin. Para adaptar la gestin central a un entorno con mdulos cargado con  *lazyloading* necesitamos una ltima ayuda, de la mano de `FeatureModule`.\n\nEsencialmente es una nuevo *store* supeditado al principal pero que no se define, y por tanto no pesa, hasta que no es necesario. En Autobot el [CarModule](https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/car) es un buen ejemplo de *store* cargado de forma dinmica como una `Feature`.\n\nYa tienes los conocimientos para gestionar de manera centralizada, auditable y predecible el estado de tus programas. El patrn Redux lucir ms cuanto ms grande y compleja sea tu aplicacin.\n\nContina tu formacin avanzada para crear aplicaciones [PWA, entre la web y las apps con Angular](../pwa-entre-la-web-y-las-apps-con-angular) y vers como aprendes a programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-a-El-patron-Redux-con-NgRx-en-Angular.md","raw":"---\ntitle: El patrn Redux con NgRx en Angular\npermalink: el-patron-redux-con-ngrx-en-angular\ndate: 2018-10-08 12:50:27\ntags:  \n- Angular\n- Angular7\n- Angular6\n- Angular2\n- Redux\n- NgRx\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular] \nthumbnail: /css/images/angular-a_redux.png\n---\n\n![el-patron-redux-con-ngrx-en-angular](/images/tutorial-angular-a_redux.png)\n\nLe pasa a todas las aplicaciones. Crecen y crecen en funcionalidad y complejidad. En Angular estamos preparados para modularizar, componentizar e inyectar servicios. Pero con grandes aplicaciones, o con grandes equipos, parece que nada es suficiente. Se necesita una **gestin del estado centralizada** como la del patrn Redux.\n\n**Redux no hace rpido lo simple, sino mantenible lo complejo**. Y si tienes delante un desarrollo complejo, te recomiendo que uses *NgRX*; la solucin estndar para implementar **Redux con Angular**.\n\n\n<!-- more -->\n\nPartiendo del cdigo tal cmo qued en [Deteccin del cambio en Angular](../deteccion-del-cambio-en-Angular/). Al finalizar tendrs una aplicacin que gestiona centralizadamente los cambios, que permite conocer qu ocurri y predecir lo que ocurrir.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/AutoBot/a-redux](https://github.com/AcademiaBinaria/autobot/tree/a-redux)\n\n\n# 1 El patrn Redux\n\nRedux es como una base de datos, es en un almacn para el estado de la aplicacin. Pero un almacn que gestiona sus cambios de manera predictiva. Combina dos patrones: *Action* para el envio de comandos para actualizar el estado del almacn; y *Observable* para la subscripcin a cambios en el estado del almacn. **Desacopla los emisores de acciones de los receptores de cambios** en los datos.\n\nPara lograrlo tendremos que cumplir una serie de principios y utilizar unos elementos predefinidos. Esto introduce capas de abstraccin y burocracia que inicialmente complican el desarrollo. Pero a medio plazo harn que mantener la aplicacin sea mucho ms sencillo y seguro.\n\n## 1.1 Principios de Redux\n\nTenemos tres principios bsicos que cumplir:\n\n- **Single Source Of Truth**: Cada pieza de informacin se almacena en un nico lugar, independientemente de dnde sea creada, modificada o requerida.\n- **Read Only State**: La informacin ser de slo lectura y slo podr modificarse a travs de conductos oficiales.\n- **Changes By Pure Functions**: Los cambios tienen que poder ser replicados, cancelados y auditados; lo mejor, usar una funcin pura.\n\n## 1.1 Elementos de Redux\n\nEstos son los artificios fundamentales que incorporaremos a nuestro desarrollo:\n\n- **Store**: El sistema que mantiene el estado. Despacha acciones de mutado sobre el mismo y comunica cambios enviando copias de slo lectura a los subscriptores.\n- **State**: rbol de objetos que contienen la nica copia vlida de la informacin. Representa el valor del almacn en un momento determinado.\n- **Actions**: Objetos identificados por un tipo y cargados con un *payload*. Transmiten una intencin de mutacin sobre el estado del *store*. \n- **Reducers** : Son funciones puras, que ostentan la exclusividad de poder mutar el estado. Reciben dos argumentos: el estado actual y una accin con su tipo y su carga. Clonan el estado, realizan los cambios oportunos y devuelven el estado mutado.\n\n> Los funciones reductoras, al ser puras, mezclan la programacin funcional con la orientada a objetos. Un reto pero tambin una demostracin de la coexistencia de paradigmas en un mismo desarrollo.\n\n\n# 2 NgRx\n\nNgRx es el estndar de facto para implementar Redux en Angular. Est basada en *RxJS* y es una librera modular con todo lo necesario para crear grandes aplicaciones. Esto son los mdulos que la componen:\n\n- **store**: Es el mdulo principal con el administrador del estado centralizado y reactivo.\n- **store-devtools**: Instrumentacin para depurar desde el navegador. Vale su peso en oro. \n- **router-Store** : Almacena el estado del *router* de Angular en el *store*, tratando cada evento como una accin Redux.\n- **effects**: Los reductores son funciones puras sin efectos colaterales. Este mdulo es la solucin para comandos asncronos.\n- **schematics, entity, ngrx-data**: Son otros mdulos opcionales con ayudas y plantillas de NgRX.\n\n## 2.1 Instalacin y configuracin\n\nPara agregar *NgRx* a un app te propongo la siguiente receta de comandos. Adems de esto tendrs que instalar en tu navegador las herramientas de diagnstico [Redux DevTools](http://extension.remotedev.io/).\n\n```shell\nnpm i @angular-devkit/schematics --save-dev\nnpm i @ngrx/schematics --save-dev\nng config cli.defaultCollection @ngrx/schematics\nnpm i @ngrx/store --save\nnpm i @ngrx/store-devtools --save \nng g st RootState --root -m app.module.ts --spec false\nnpm install @ngrx/router-store --save \n```\nCon esto habrs instalado y configurado NgRx en tu app. Completa tu mdulo principal para que tenga algo as:\n\n```typescript\n@NgModule({\n  imports: [\n    CommonModule,\n    RouterModule,\n    StoreModule.forRoot(rootReducers, { metaReducers }),\n    StoreRouterConnectingModule.forRoot({ stateKey: 'router' }),\n    !environment.production ? StoreDevtoolsModule.instrument() : []\n  ]\n})\nexport class AppModule {}\n```\n\n> El cdigo generado por `@ngrx/schematics` no es para todos los gustos. Tmalo como un punto de partida y crea la estructura que mejor te encaje. En [Autobot](https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/core/store/state) he empezado por llevarlo todo al `CoreModule` y guardarlo en una carpeta propia convenientemente nombrada `store/state`. Vemosla en detalle.\n\n## 2.2 State y reducers, los cambios de estado mediante reductores\n\nEl estado en *redux* es un objeto tipado a partir de una interfaz, normalmente llamada `State` a secas, aunque yo prefiero identificarla como `RootState`. Tendr propiedades para almacenar objetos ms o menos complejos. Cada propiedad tendr su propio tipo complejo y ser gestionada por una funcin reductora especfica. Se necesita un proceso de mapeo que asigne la funcin reductora a cada propiedad del estado raiz. Eso es lo que hace este cdigo:\n\n```typescript\nexport interface RootState {\n  router: any;\n  global: GlobalState;\n  cars: CarsState;\n}\n\nexport const rootReducers: ActionReducerMap<RootState> = {\n  router: routerReducer,\n  global: globalreducer,\n  cars: carsReducer\n};\n```\n\nLas funciones reductoras pueden estar en cualquier fichero. Son puras y no deben ser includas en ninguna clase. Normalmente tendrs un fichero para cada reductor. El del *router* ya viene hecho por NgRx, todos los dems son cosa tuya. Por ejemplo este es el reductor sobre la propiedad `global: GlobalState`.\n\n```typescript\nexport function globalReducer(state = initialState, action: GlobalActions): GlobalState {\n  switch (action.type) {\n    case GlobalActionTypes.SendUserMessage:\n      return { ...state, userMessage: action.payload };\n    case GlobalActionTypes.IsLoginNeeded:\n      return { ...state, loginNeeded: action.payload };\n    case GlobalActionTypes.StoreToken:\n      return { ...state, token: action.payload };\n    default:\n      return state;\n  }\n}\n```\n\nComo puedes ver esta funcin recibe dos argumento: el estado y la accin que pretende mutarlo. **La accin es un objeto** con dos propiedades. La primera y obligatoria es el tipo y sirve para escoger la lgica que se aplicar. La otra, opcional, es el `payload` que acta como argumento de la accin. El reductor no puede usar nada ms que estos argumentos: **state y action**. Y por ser puro no puede mutar ninguno, por tanto tiene que clonar el estado recibido antes de aplicarle cualquier cambio. Una vez efectuado el cambio, usando el *payload* si es preciso, devolver el clon mutado.\n\n## 2.3 Actions, las acciones permitidas\n\nEl patrn Redux no obliga a grandes cosas respecto a cmo implementar las acciones. Lo nico que de verdad necesitas es crear objetos con una propiedad obligatoria `type` y otra opcional `payoload`.\n\nPero en NgRX han decidido aprovechar al mximo las papacidades del *TypeScript* y proponen usar un cdigo fuertemente tipado. Para empezar crean un `enum` que detalla los posible tipos de una accin y les asigna un texto para que luzcan y faciliten su bsqueda en *logs*. \n\n```typescript\nexport enum GlobalActionTypes {\n  SendUserMessage = '[Global] Show Message',\n  IsLoginNeeded = '[Auth] Is Login Needed',\n  StoreToken = '[Auth] Store Token'\n}\n```\n\nY claro, en un ambiente tipado, la accin ser una clase que ha de cumplir una interfaz. En dicha clase queda ya predetermindo su tipo de accin; y por supuesto que permiten fijar el tipo de datos de la `payload`. Todo ello genera un cdigo como el siguiente.\n\n```typescript\nexport class SendUserMesage implements Action {\n  readonly type = GlobalActionTypes.SendUserMessage;\n  constructor(public payload: string) {}\n}\n```\n\nPara terminar, y ya que habremos de crear un buen nmero de clases para las acciones, tambin nos propone exprimir *TypeScript* para crear un tipo combinado que ofrezca a los consumidores el plantel completo y delimitado de acciones posibles.\n\n```typescript\nexport type GlobalActions = SendUserMesage | IsLoginNeeded | StoreToken;\n```\n\nEs normal que al principio todo este *boilerplate* te parezca un exceso. Pero entre las plantillas, los *snipets* y el *copy and paste* no es tan trabajoso como pudiera parecer. A cambio tienes un cdigo robusto y explcitamente detallado. \n\n## 2.4 Dispatch y Select, despacho de acciones y seleccin de cambios\n\nDesde el resto del cdigo **la comunicacin con este estado centralizado se realizar por dos conductos oficiales : Dispatch y Select**. El primero es un mtodo que recibe como nico parmetro una instancia de una accin. Dicha instancia lleva implcito el tipo y puede ir rellena de una *payload*. As es como se envan los cambios hacia el almacn.\n\n```typescript\nconstructor(private store: Store<RootState>) {\n  this.store.dispatch(new SendUserMesage('Tutorial Angular en Espaol'));\n}\n```\n\nNo esperamos respuesta de este mtodo. Es un mundo de *fire and forget*. Pero en cualquier otro lugar o lugares de nuestro cdigo podremos recibir notificicadciones de cualquier cambio que se haya producido. De forma desacoplada podremos recibir el mensaje con una simple subscripcin *RxJS*.\n\n```typescript\nthis.store\n  .select('global', 'userMessage')\n  .subscribe(userMessage: string => console.log(userMessage));\n```\n\nA este mtodo de consulta asncrona se le enva un argumento con mltiples sobrecargas llamado *selector*. En este caso est formado por dos claves que apuntan a una propiedad concreta en la que estoy interesado: `global.userMessage`.\n\nCon esto tenemos una primera implementacin del patrn Redux en Angular usando NgRx. Pero an hay ms.\n\n# 3 Efectos y mdulos funcionales\n\nLas funciones reductoras, como ya se ha dicho, deben ser puras. La idea es que puedan ser auditadas, re-ejecutadas y testeadas sin que necesiten servicios externos ni causen efectos colaterales. Y esto es un problema con la cantidad de **ejecuciones asncronas en las aplicaciones web**. Cualquier tentacin de lanzar una llamada *AJAX* dentro de un reductor debe ser elimindad de inmediato. \n\n> Dos razones: por un lado en Angular se necesita invocar al *httpClient* de alguna manera para realizar la llamada *AJAX*. Y, ya que la funcin no pertenece a ninguna clase, no puede haber constructor que reclame la inyeccin de dicho servicio. Tampoco las funciones puras tienen permitido usar nada que no venga entre sus argumentos. Por otra parte las funciones puras han de ser predecibles, y una llamada a un servidor remoto no es en absoluto predecible. Puede pasarle de todo, as que los reductores no son pas para procesos asncronos.\n\nLa solucin que proponen *NgRX* es usar un artificio llamado efecto, porque ser encargado de **los efectos secundarios que provocan las las instrucciones asncronas**. De una forma simplista, diremos que las acciones asncronas se multiplicarn por tres. El comando que genera la llamada, y los dos potenciales eventos con la respuesta correcta o el error.\n\nPara manejarlo todo incluyen en la librera el mdulo `EffectsModule` que ha de registrarse junto al `StoreModule`. Desde ese momento *NgRX* activa un sistema de seguimiento que trata las acciones como un stream de *RxJS* y permite subscribirse a la invocacin de dichas acciones y tratarlas adecuadamente. Una vez ms, aprovechan las caratersticas del *TypeScript* y hacen uso de los decoradores para definir las funciones que respondern a la ejecucin de las acciones.\n\n## 3.1 @Effect(), efectos secundarios\n\nEl decorador `@Effect()` se aplica a propiedades de servicios estandar de Angular. *NgRX* invoca esas funciones ante cada accin despachada, as que lo primero que debemos hacer es aplicar un filtro para quedarnos con las acciones del tipo que nos interese. El que lanzar la llamda `http`. \n\n> Todo el trabajo se realizar con *streams* y requiere de un conocimiento previo de la librera *RxJS* y de la mecnica de su mtodo `pipe` y sus operadores reactivos.\n\nCuando llegue una de esas acciones realizaremos la llamada asncrona sin complejos. Recordemos que un efecto forma parte de un servicio inyectable de Angular. No tienen ninguna restriccin funcional por parte de Redux. Obviamente la respuesta debe ser capturada y tratada segn haya sido correcta o no. \n\nSi recibimos una respuesta vlida podremos retornar directamente una nueva accin que actualice el estado con los datos recibidos. En cambio si ha habido un error, habr que reactivar el *stream* con un nuevo observable que emita la accin que procesar el error.\n\n```typescript\n@Effect()\nconstructor(private actions$: Actions, private cars: CarsService) {}\n\npublic loadCarsEffect$: Observable<CarsActions> = this.actions$.pipe(\n  ofType<LoadCars>(CarsActionTypes.LoadCars),\n  mergeMap(() =>\n    this.cars.getCars$().pipe(\n      map((cars: Car[]) => new LoadCarsOK(cars)),\n      catchError(err => of(new LoadCarsError('Error loading cars')))\n    )\n  )\n);\n```\n\nTmate el tiempo necesario para comprender este cdigo. Especialmente los operadores `ofType` de *NgRX* y el `mergeMap` de *RxJS*. Fjate bien en los tipos de los datos recibidos y devueltos. El efecto trata con observables de acciones. Recibe una y devuelve otra que puede ser de alguno de los otros dos tipos previstos. En el caso correcto se cambia una accin por otra, en otro caso se crea un nuevo observable mediante el constructor `of()` antes del retorno.\n\n> Para un ejemplo ms completo de estos conceptos explora la implementacin en el proyecto Autobot. El [RootStore](https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/core) hace uso de efectos en la carpeta `store/state/cars`.\n\n## 3.2 Feature, mdulos funcionales\n\nYa que Redux est especialmente indicado en grandes aplicaciones pero manteniendo un estado centralizado, es fcil que acabemos con un mdulo raiz demasiado pesado que ralentice el inicio de la aplicacin. Para adaptar la gestin central a un entorno con mdulos cargado con  *lazyloading* necesitamos una ltima ayuda, de la mano de `FeatureModule`.\n\nEsencialmente es una nuevo *store* supeditado al principal pero que no se define, y por tanto no pesa, hasta que no es necesario. En Autobot el [CarModule](https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/car) es un buen ejemplo de *store* cargado de forma dinmica como una `Feature`.\n\nYa tienes los conocimientos para gestionar de manera centralizada, auditable y predecible el estado de tus programas. El patrn Redux lucir ms cuanto ms grande y compleja sea tu aplicacin.\n\nContina tu formacin avanzada para crear aplicaciones [PWA, entre la web y las apps con Angular](../pwa-entre-la-web-y-las-apps-con-angular) y vers como aprendes a programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"el-patron-redux-con-ngrx-en-angular","published":1,"updated":"2018-12-03T16:40:17.371Z","_id":"cjmup7oul0000ags3jfqqyx7e","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-a_redux.png\" alt=\"el-patron-redux-con-ngrx-en-angular\"></p><p>Le pasa a todas las aplicaciones. Crecen y crecen en funcionalidad y complejidad. En Angular estamos preparados para modularizar, componentizar e inyectar servicios. Pero con grandes aplicaciones, o con grandes equipos, parece que nada es suficiente. Se necesita una <strong>gestin del estado centralizada</strong> como la del patrn Redux.</p><p><strong>Redux no hace rpido lo simple, sino mantenible lo complejo</strong>. Y si tienes delante un desarrollo complejo, te recomiendo que uses <em>NgRX</em>; la solucin estndar para implementar <strong>Redux con Angular</strong>.</p><a id=\"more\"></a><p>Partiendo del cdigo tal cmo qued en <a href=\"../deteccion-del-cambio-en-Angular/\">Deteccin del cambio en Angular</a>. Al finalizar tendrs una aplicacin que gestiona centralizadamente los cambios, que permite conocer qu ocurri y predecir lo que ocurrir.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/autobot/tree/a-redux\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/AutoBot/a-redux</a></p></blockquote><h1 id=\"1-El-patron-Redux\"><a href=\"#1-El-patron-Redux\" class=\"headerlink\" title=\"1 El patrn Redux\"></a>1 El patrn Redux</h1><p>Redux es como una base de datos, es en un almacn para el estado de la aplicacin. Pero un almacn que gestiona sus cambios de manera predictiva. Combina dos patrones: <em>Action</em> para el envio de comandos para actualizar el estado del almacn; y <em>Observable</em> para la subscripcin a cambios en el estado del almacn. <strong>Desacopla los emisores de acciones de los receptores de cambios</strong> en los datos.</p><p>Para lograrlo tendremos que cumplir una serie de principios y utilizar unos elementos predefinidos. Esto introduce capas de abstraccin y burocracia que inicialmente complican el desarrollo. Pero a medio plazo harn que mantener la aplicacin sea mucho ms sencillo y seguro.</p><h2 id=\"1-1-Principios-de-Redux\"><a href=\"#1-1-Principios-de-Redux\" class=\"headerlink\" title=\"1.1 Principios de Redux\"></a>1.1 Principios de Redux</h2><p>Tenemos tres principios bsicos que cumplir:</p><ul><li><strong>Single Source Of Truth</strong>: Cada pieza de informacin se almacena en un nico lugar, independientemente de dnde sea creada, modificada o requerida.</li><li><strong>Read Only State</strong>: La informacin ser de slo lectura y slo podr modificarse a travs de conductos oficiales.</li><li><strong>Changes By Pure Functions</strong>: Los cambios tienen que poder ser replicados, cancelados y auditados; lo mejor, usar una funcin pura.</li></ul><h2 id=\"1-1-Elementos-de-Redux\"><a href=\"#1-1-Elementos-de-Redux\" class=\"headerlink\" title=\"1.1 Elementos de Redux\"></a>1.1 Elementos de Redux</h2><p>Estos son los artificios fundamentales que incorporaremos a nuestro desarrollo:</p><ul><li><strong>Store</strong>: El sistema que mantiene el estado. Despacha acciones de mutado sobre el mismo y comunica cambios enviando copias de slo lectura a los subscriptores.</li><li><strong>State</strong>: rbol de objetos que contienen la nica copia vlida de la informacin. Representa el valor del almacn en un momento determinado.</li><li><strong>Actions</strong>: Objetos identificados por un tipo y cargados con un <em>payload</em>. Transmiten una intencin de mutacin sobre el estado del <em>store</em>.</li><li><strong>Reducers</strong> : Son funciones puras, que ostentan la exclusividad de poder mutar el estado. Reciben dos argumentos: el estado actual y una accin con su tipo y su carga. Clonan el estado, realizan los cambios oportunos y devuelven el estado mutado.</li></ul><blockquote><p>Los funciones reductoras, al ser puras, mezclan la programacin funcional con la orientada a objetos. Un reto pero tambin una demostracin de la coexistencia de paradigmas en un mismo desarrollo.</p></blockquote><h1 id=\"2-NgRx\"><a href=\"#2-NgRx\" class=\"headerlink\" title=\"2 NgRx\"></a>2 NgRx</h1><p>NgRx es el estndar de facto para implementar Redux en Angular. Est basada en <em>RxJS</em> y es una librera modular con todo lo necesario para crear grandes aplicaciones. Esto son los mdulos que la componen:</p><ul><li><strong>store</strong>: Es el mdulo principal con el administrador del estado centralizado y reactivo.</li><li><strong>store-devtools</strong>: Instrumentacin para depurar desde el navegador. Vale su peso en oro.</li><li><strong>router-Store</strong> : Almacena el estado del <em>router</em> de Angular en el <em>store</em>, tratando cada evento como una accin Redux.</li><li><strong>effects</strong>: Los reductores son funciones puras sin efectos colaterales. Este mdulo es la solucin para comandos asncronos.</li><li><strong>schematics, entity, ngrx-data</strong>: Son otros mdulos opcionales con ayudas y plantillas de NgRX.</li></ul><h2 id=\"2-1-Instalacion-y-configuracion\"><a href=\"#2-1-Instalacion-y-configuracion\" class=\"headerlink\" title=\"2.1 Instalacin y configuracin\"></a>2.1 Instalacin y configuracin</h2><p>Para agregar <em>NgRx</em> a un app te propongo la siguiente receta de comandos. Adems de esto tendrs que instalar en tu navegador las herramientas de diagnstico <a href=\"http://extension.remotedev.io/\" target=\"_blank\" rel=\"noopener\">Redux DevTools</a>.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i @angular-devkit/schematics --save-dev</span><br><span class=\"line\">npm i @ngrx/schematics --save-dev</span><br><span class=\"line\">ng config cli.defaultCollection @ngrx/schematics</span><br><span class=\"line\">npm i @ngrx/store --save</span><br><span class=\"line\">npm i @ngrx/store-devtools --save </span><br><span class=\"line\">ng g st RootState --root -m app.module.ts --spec false</span><br><span class=\"line\">npm install @ngrx/router-store --save</span><br></pre></td></tr></table></figure><p>Con esto habrs instalado y configurado NgRx en tu app. Completa tu mdulo principal para que tenga algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    RouterModule,</span><br><span class=\"line\">    StoreModule.forRoot(rootReducers, &#123; metaReducers &#125;),</span><br><span class=\"line\">    StoreRouterConnectingModule.forRoot(&#123; stateKey: <span class=\"string\">'router'</span> &#125;),</span><br><span class=\"line\">    !environment.production ? StoreDevtoolsModule.instrument() : []</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El cdigo generado por <code>@ngrx/schematics</code> no es para todos los gustos. Tmalo como un punto de partida y crea la estructura que mejor te encaje. En <a href=\"https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/core/store/state\" target=\"_blank\" rel=\"noopener\">Autobot</a> he empezado por llevarlo todo al <code>CoreModule</code> y guardarlo en una carpeta propia convenientemente nombrada <code>store/state</code>. Vemosla en detalle.</p></blockquote><h2 id=\"2-2-State-y-reducers-los-cambios-de-estado-mediante-reductores\"><a href=\"#2-2-State-y-reducers-los-cambios-de-estado-mediante-reductores\" class=\"headerlink\" title=\"2.2 State y reducers, los cambios de estado mediante reductores\"></a>2.2 State y reducers, los cambios de estado mediante reductores</h2><p>El estado en <em>redux</em> es un objeto tipado a partir de una interfaz, normalmente llamada <code>State</code> a secas, aunque yo prefiero identificarla como <code>RootState</code>. Tendr propiedades para almacenar objetos ms o menos complejos. Cada propiedad tendr su propio tipo complejo y ser gestionada por una funcin reductora especfica. Se necesita un proceso de mapeo que asigne la funcin reductora a cada propiedad del estado raiz. Eso es lo que hace este cdigo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> RootState &#123;</span><br><span class=\"line\">  router: <span class=\"built_in\">any</span>;</span><br><span class=\"line\">  global: GlobalState;</span><br><span class=\"line\">  cars: CarsState;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> rootReducers: ActionReducerMap&lt;RootState&gt; = &#123;</span><br><span class=\"line\">  router: routerReducer,</span><br><span class=\"line\">  global: globalreducer,</span><br><span class=\"line\">  cars: carsReducer</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure><p>Las funciones reductoras pueden estar en cualquier fichero. Son puras y no deben ser includas en ninguna clase. Normalmente tendrs un fichero para cada reductor. El del <em>router</em> ya viene hecho por NgRx, todos los dems son cosa tuya. Por ejemplo este es el reductor sobre la propiedad <code>global: GlobalState</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">globalReducer</span>(<span class=\"params\">state = initialState, action: GlobalActions</span>): <span class=\"title\">GlobalState</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">switch</span> (action.type) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> GlobalActionTypes.SendUserMessage:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &#123; ...state, userMessage: action.payload &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> GlobalActionTypes.IsLoginNeeded:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &#123; ...state, loginNeeded: action.payload &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> GlobalActionTypes.StoreToken:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &#123; ...state, token: action.payload &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">default</span>:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> state;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Como puedes ver esta funcin recibe dos argumento: el estado y la accin que pretende mutarlo. <strong>La accin es un objeto</strong> con dos propiedades. La primera y obligatoria es el tipo y sirve para escoger la lgica que se aplicar. La otra, opcional, es el <code>payload</code> que acta como argumento de la accin. El reductor no puede usar nada ms que estos argumentos: <strong>state y action</strong>. Y por ser puro no puede mutar ninguno, por tanto tiene que clonar el estado recibido antes de aplicarle cualquier cambio. Una vez efectuado el cambio, usando el <em>payload</em> si es preciso, devolver el clon mutado.</p><h2 id=\"2-3-Actions-las-acciones-permitidas\"><a href=\"#2-3-Actions-las-acciones-permitidas\" class=\"headerlink\" title=\"2.3 Actions, las acciones permitidas\"></a>2.3 Actions, las acciones permitidas</h2><p>El patrn Redux no obliga a grandes cosas respecto a cmo implementar las acciones. Lo nico que de verdad necesitas es crear objetos con una propiedad obligatoria <code>type</code> y otra opcional <code>payoload</code>.</p><p>Pero en NgRX han decidido aprovechar al mximo las papacidades del <em>TypeScript</em> y proponen usar un cdigo fuertemente tipado. Para empezar crean un <code>enum</code> que detalla los posible tipos de una accin y les asigna un texto para que luzcan y faciliten su bsqueda en <em>logs</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">enum</span> GlobalActionTypes &#123;</span><br><span class=\"line\">  SendUserMessage = <span class=\"string\">'[Global] Show Message'</span>,</span><br><span class=\"line\">  IsLoginNeeded = <span class=\"string\">'[Auth] Is Login Needed'</span>,</span><br><span class=\"line\">  StoreToken = <span class=\"string\">'[Auth] Store Token'</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y claro, en un ambiente tipado, la accin ser una clase que ha de cumplir una interfaz. En dicha clase queda ya predetermindo su tipo de accin; y por supuesto que permiten fijar el tipo de datos de la <code>payload</code>. Todo ello genera un cdigo como el siguiente.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SendUserMesage <span class=\"keyword\">implements</span> Action &#123;</span><br><span class=\"line\">  readonly <span class=\"keyword\">type</span> = GlobalActionTypes.SendUserMessage;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">public</span> payload: <span class=\"built_in\">string</span></span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Para terminar, y ya que habremos de crear un buen nmero de clases para las acciones, tambin nos propone exprimir <em>TypeScript</em> para crear un tipo combinado que ofrezca a los consumidores el plantel completo y delimitado de acciones posibles.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">type</span> GlobalActions = SendUserMesage | IsLoginNeeded | StoreToken;</span><br></pre></td></tr></table></figure><p>Es normal que al principio todo este <em>boilerplate</em> te parezca un exceso. Pero entre las plantillas, los <em>snipets</em> y el <em>copy and paste</em> no es tan trabajoso como pudiera parecer. A cambio tienes un cdigo robusto y explcitamente detallado.</p><h2 id=\"2-4-Dispatch-y-Select-despacho-de-acciones-y-seleccion-de-cambios\"><a href=\"#2-4-Dispatch-y-Select-despacho-de-acciones-y-seleccion-de-cambios\" class=\"headerlink\" title=\"2.4 Dispatch y Select, despacho de acciones y seleccin de cambios\"></a>2.4 Dispatch y Select, despacho de acciones y seleccin de cambios</h2><p>Desde el resto del cdigo <strong>la comunicacin con este estado centralizado se realizar por dos conductos oficiales : Dispatch y Select</strong>. El primero es un mtodo que recibe como nico parmetro una instancia de una accin. Dicha instancia lleva implcito el tipo y puede ir rellena de una <em>payload</em>. As es como se envan los cambios hacia el almacn.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> store: Store&lt;RootState&gt;</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.store.dispatch(<span class=\"keyword\">new</span> SendUserMesage(<span class=\"string\">'Tutorial Angular en Espaol'</span>));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>No esperamos respuesta de este mtodo. Es un mundo de <em>fire and forget</em>. Pero en cualquier otro lugar o lugares de nuestro cdigo podremos recibir notificicadciones de cualquier cambio que se haya producido. De forma desacoplada podremos recibir el mensaje con una simple subscripcin <em>RxJS</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">this</span>.store</span><br><span class=\"line\">  .select(<span class=\"string\">'global'</span>, <span class=\"string\">'userMessage'</span>)</span><br><span class=\"line\">  .subscribe(userMessage: <span class=\"function\"><span class=\"params\">string</span> =&gt;</span> <span class=\"built_in\">console</span>.log(userMessage));</span><br></pre></td></tr></table></figure><p>A este mtodo de consulta asncrona se le enva un argumento con mltiples sobrecargas llamado <em>selector</em>. En este caso est formado por dos claves que apuntan a una propiedad concreta en la que estoy interesado: <code>global.userMessage</code>.</p><p>Con esto tenemos una primera implementacin del patrn Redux en Angular usando NgRx. Pero an hay ms.</p><h1 id=\"3-Efectos-y-modulos-funcionales\"><a href=\"#3-Efectos-y-modulos-funcionales\" class=\"headerlink\" title=\"3 Efectos y mdulos funcionales\"></a>3 Efectos y mdulos funcionales</h1><p>Las funciones reductoras, como ya se ha dicho, deben ser puras. La idea es que puedan ser auditadas, re-ejecutadas y testeadas sin que necesiten servicios externos ni causen efectos colaterales. Y esto es un problema con la cantidad de <strong>ejecuciones asncronas en las aplicaciones web</strong>. Cualquier tentacin de lanzar una llamada <em>AJAX</em> dentro de un reductor debe ser elimindad de inmediato.</p><blockquote><p>Dos razones: por un lado en Angular se necesita invocar al <em>httpClient</em> de alguna manera para realizar la llamada <em>AJAX</em>. Y, ya que la funcin no pertenece a ninguna clase, no puede haber constructor que reclame la inyeccin de dicho servicio. Tampoco las funciones puras tienen permitido usar nada que no venga entre sus argumentos. Por otra parte las funciones puras han de ser predecibles, y una llamada a un servidor remoto no es en absoluto predecible. Puede pasarle de todo, as que los reductores no son pas para procesos asncronos.</p></blockquote><p>La solucin que proponen <em>NgRX</em> es usar un artificio llamado efecto, porque ser encargado de <strong>los efectos secundarios que provocan las las instrucciones asncronas</strong>. De una forma simplista, diremos que las acciones asncronas se multiplicarn por tres. El comando que genera la llamada, y los dos potenciales eventos con la respuesta correcta o el error.</p><p>Para manejarlo todo incluyen en la librera el mdulo <code>EffectsModule</code> que ha de registrarse junto al <code>StoreModule</code>. Desde ese momento <em>NgRX</em> activa un sistema de seguimiento que trata las acciones como un stream de <em>RxJS</em> y permite subscribirse a la invocacin de dichas acciones y tratarlas adecuadamente. Una vez ms, aprovechan las caratersticas del <em>TypeScript</em> y hacen uso de los decoradores para definir las funciones que respondern a la ejecucin de las acciones.</p><h2 id=\"3-1-Effect-efectos-secundarios\"><a href=\"#3-1-Effect-efectos-secundarios\" class=\"headerlink\" title=\"3.1 @Effect(), efectos secundarios\"></a>3.1 @Effect(), efectos secundarios</h2><p>El decorador <code>@Effect()</code> se aplica a propiedades de servicios estandar de Angular. <em>NgRX</em> invoca esas funciones ante cada accin despachada, as que lo primero que debemos hacer es aplicar un filtro para quedarnos con las acciones del tipo que nos interese. El que lanzar la llamda <code>http</code>.</p><blockquote><p>Todo el trabajo se realizar con <em>streams</em> y requiere de un conocimiento previo de la librera <em>RxJS</em> y de la mecnica de su mtodo <code>pipe</code> y sus operadores reactivos.</p></blockquote><p>Cuando llegue una de esas acciones realizaremos la llamada asncrona sin complejos. Recordemos que un efecto forma parte de un servicio inyectable de Angular. No tienen ninguna restriccin funcional por parte de Redux. Obviamente la respuesta debe ser capturada y tratada segn haya sido correcta o no.</p><p>Si recibimos una respuesta vlida podremos retornar directamente una nueva accin que actualice el estado con los datos recibidos. En cambio si ha habido un error, habr que reactivar el <em>stream</em> con un nuevo observable que emita la accin que procesar el error.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Effect</span>()</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> actions$: Actions, <span class=\"keyword\">private</span> cars: CarsService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> loadCarsEffect$: Observable&lt;CarsActions&gt; = <span class=\"keyword\">this</span>.actions$.pipe(</span><br><span class=\"line\">  ofType&lt;LoadCars&gt;(CarsActionTypes.LoadCars),</span><br><span class=\"line\">  mergeMap(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.cars.getCars$().pipe(</span><br><span class=\"line\">      map(<span class=\"function\">(<span class=\"params\">cars: Car[]</span>) =&gt;</span> <span class=\"keyword\">new</span> LoadCarsOK(cars)),</span><br><span class=\"line\">      catchError(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> of(<span class=\"keyword\">new</span> LoadCarsError(<span class=\"string\">'Error loading cars'</span>)))</span><br><span class=\"line\">    )</span><br><span class=\"line\">  )</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Tmate el tiempo necesario para comprender este cdigo. Especialmente los operadores <code>ofType</code> de <em>NgRX</em> y el <code>mergeMap</code> de <em>RxJS</em>. Fjate bien en los tipos de los datos recibidos y devueltos. El efecto trata con observables de acciones. Recibe una y devuelve otra que puede ser de alguno de los otros dos tipos previstos. En el caso correcto se cambia una accin por otra, en otro caso se crea un nuevo observable mediante el constructor <code>of()</code> antes del retorno.</p><blockquote><p>Para un ejemplo ms completo de estos conceptos explora la implementacin en el proyecto Autobot. El <a href=\"https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/core\" target=\"_blank\" rel=\"noopener\">RootStore</a> hace uso de efectos en la carpeta <code>store/state/cars</code>.</p></blockquote><h2 id=\"3-2-Feature-modulos-funcionales\"><a href=\"#3-2-Feature-modulos-funcionales\" class=\"headerlink\" title=\"3.2 Feature, mdulos funcionales\"></a>3.2 Feature, mdulos funcionales</h2><p>Ya que Redux est especialmente indicado en grandes aplicaciones pero manteniendo un estado centralizado, es fcil que acabemos con un mdulo raiz demasiado pesado que ralentice el inicio de la aplicacin. Para adaptar la gestin central a un entorno con mdulos cargado con <em>lazyloading</em> necesitamos una ltima ayuda, de la mano de <code>FeatureModule</code>.</p><p>Esencialmente es una nuevo <em>store</em> supeditado al principal pero que no se define, y por tanto no pesa, hasta que no es necesario. En Autobot el <a href=\"https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/car\" target=\"_blank\" rel=\"noopener\">CarModule</a> es un buen ejemplo de <em>store</em> cargado de forma dinmica como una <code>Feature</code>.</p><p>Ya tienes los conocimientos para gestionar de manera centralizada, auditable y predecible el estado de tus programas. El patrn Redux lucir ms cuanto ms grande y compleja sea tu aplicacin.</p><p>Contina tu formacin avanzada para crear aplicaciones <a href=\"../pwa-entre-la-web-y-las-apps-con-angular\">PWA, entre la web y las apps con Angular</a> y vers como aprendes a programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-a_redux.png\" alt=\"el-patron-redux-con-ngrx-en-angular\"></p><p>Le pasa a todas las aplicaciones. Crecen y crecen en funcionalidad y complejidad. En Angular estamos preparados para modularizar, componentizar e inyectar servicios. Pero con grandes aplicaciones, o con grandes equipos, parece que nada es suficiente. Se necesita una <strong>gestin del estado centralizada</strong> como la del patrn Redux.</p><p><strong>Redux no hace rpido lo simple, sino mantenible lo complejo</strong>. Y si tienes delante un desarrollo complejo, te recomiendo que uses <em>NgRX</em>; la solucin estndar para implementar <strong>Redux con Angular</strong>.</p>","more":"<p>Partiendo del cdigo tal cmo qued en <a href=\"../deteccion-del-cambio-en-Angular/\">Deteccin del cambio en Angular</a>. Al finalizar tendrs una aplicacin que gestiona centralizadamente los cambios, que permite conocer qu ocurri y predecir lo que ocurrir.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/autobot/tree/a-redux\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/AutoBot/a-redux</a></p></blockquote><h1 id=\"1-El-patron-Redux\"><a href=\"#1-El-patron-Redux\" class=\"headerlink\" title=\"1 El patrn Redux\"></a>1 El patrn Redux</h1><p>Redux es como una base de datos, es en un almacn para el estado de la aplicacin. Pero un almacn que gestiona sus cambios de manera predictiva. Combina dos patrones: <em>Action</em> para el envio de comandos para actualizar el estado del almacn; y <em>Observable</em> para la subscripcin a cambios en el estado del almacn. <strong>Desacopla los emisores de acciones de los receptores de cambios</strong> en los datos.</p><p>Para lograrlo tendremos que cumplir una serie de principios y utilizar unos elementos predefinidos. Esto introduce capas de abstraccin y burocracia que inicialmente complican el desarrollo. Pero a medio plazo harn que mantener la aplicacin sea mucho ms sencillo y seguro.</p><h2 id=\"1-1-Principios-de-Redux\"><a href=\"#1-1-Principios-de-Redux\" class=\"headerlink\" title=\"1.1 Principios de Redux\"></a>1.1 Principios de Redux</h2><p>Tenemos tres principios bsicos que cumplir:</p><ul><li><strong>Single Source Of Truth</strong>: Cada pieza de informacin se almacena en un nico lugar, independientemente de dnde sea creada, modificada o requerida.</li><li><strong>Read Only State</strong>: La informacin ser de slo lectura y slo podr modificarse a travs de conductos oficiales.</li><li><strong>Changes By Pure Functions</strong>: Los cambios tienen que poder ser replicados, cancelados y auditados; lo mejor, usar una funcin pura.</li></ul><h2 id=\"1-1-Elementos-de-Redux\"><a href=\"#1-1-Elementos-de-Redux\" class=\"headerlink\" title=\"1.1 Elementos de Redux\"></a>1.1 Elementos de Redux</h2><p>Estos son los artificios fundamentales que incorporaremos a nuestro desarrollo:</p><ul><li><strong>Store</strong>: El sistema que mantiene el estado. Despacha acciones de mutado sobre el mismo y comunica cambios enviando copias de slo lectura a los subscriptores.</li><li><strong>State</strong>: rbol de objetos que contienen la nica copia vlida de la informacin. Representa el valor del almacn en un momento determinado.</li><li><strong>Actions</strong>: Objetos identificados por un tipo y cargados con un <em>payload</em>. Transmiten una intencin de mutacin sobre el estado del <em>store</em>.</li><li><strong>Reducers</strong> : Son funciones puras, que ostentan la exclusividad de poder mutar el estado. Reciben dos argumentos: el estado actual y una accin con su tipo y su carga. Clonan el estado, realizan los cambios oportunos y devuelven el estado mutado.</li></ul><blockquote><p>Los funciones reductoras, al ser puras, mezclan la programacin funcional con la orientada a objetos. Un reto pero tambin una demostracin de la coexistencia de paradigmas en un mismo desarrollo.</p></blockquote><h1 id=\"2-NgRx\"><a href=\"#2-NgRx\" class=\"headerlink\" title=\"2 NgRx\"></a>2 NgRx</h1><p>NgRx es el estndar de facto para implementar Redux en Angular. Est basada en <em>RxJS</em> y es una librera modular con todo lo necesario para crear grandes aplicaciones. Esto son los mdulos que la componen:</p><ul><li><strong>store</strong>: Es el mdulo principal con el administrador del estado centralizado y reactivo.</li><li><strong>store-devtools</strong>: Instrumentacin para depurar desde el navegador. Vale su peso en oro.</li><li><strong>router-Store</strong> : Almacena el estado del <em>router</em> de Angular en el <em>store</em>, tratando cada evento como una accin Redux.</li><li><strong>effects</strong>: Los reductores son funciones puras sin efectos colaterales. Este mdulo es la solucin para comandos asncronos.</li><li><strong>schematics, entity, ngrx-data</strong>: Son otros mdulos opcionales con ayudas y plantillas de NgRX.</li></ul><h2 id=\"2-1-Instalacion-y-configuracion\"><a href=\"#2-1-Instalacion-y-configuracion\" class=\"headerlink\" title=\"2.1 Instalacin y configuracin\"></a>2.1 Instalacin y configuracin</h2><p>Para agregar <em>NgRx</em> a un app te propongo la siguiente receta de comandos. Adems de esto tendrs que instalar en tu navegador las herramientas de diagnstico <a href=\"http://extension.remotedev.io/\" target=\"_blank\" rel=\"noopener\">Redux DevTools</a>.</p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i @angular-devkit/schematics --save-dev</span><br><span class=\"line\">npm i @ngrx/schematics --save-dev</span><br><span class=\"line\">ng config cli.defaultCollection @ngrx/schematics</span><br><span class=\"line\">npm i @ngrx/store --save</span><br><span class=\"line\">npm i @ngrx/store-devtools --save </span><br><span class=\"line\">ng g st RootState --root -m app.module.ts --spec false</span><br><span class=\"line\">npm install @ngrx/router-store --save</span><br></pre></td></tr></table></figure><p>Con esto habrs instalado y configurado NgRx en tu app. Completa tu mdulo principal para que tenga algo as:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NgModule</span>(&#123;</span><br><span class=\"line\">  imports: [</span><br><span class=\"line\">    CommonModule,</span><br><span class=\"line\">    RouterModule,</span><br><span class=\"line\">    StoreModule.forRoot(rootReducers, &#123; metaReducers &#125;),</span><br><span class=\"line\">    StoreRouterConnectingModule.forRoot(&#123; stateKey: <span class=\"string\">'router'</span> &#125;),</span><br><span class=\"line\">    !environment.production ? StoreDevtoolsModule.instrument() : []</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>El cdigo generado por <code>@ngrx/schematics</code> no es para todos los gustos. Tmalo como un punto de partida y crea la estructura que mejor te encaje. En <a href=\"https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/core/store/state\" target=\"_blank\" rel=\"noopener\">Autobot</a> he empezado por llevarlo todo al <code>CoreModule</code> y guardarlo en una carpeta propia convenientemente nombrada <code>store/state</code>. Vemosla en detalle.</p></blockquote><h2 id=\"2-2-State-y-reducers-los-cambios-de-estado-mediante-reductores\"><a href=\"#2-2-State-y-reducers-los-cambios-de-estado-mediante-reductores\" class=\"headerlink\" title=\"2.2 State y reducers, los cambios de estado mediante reductores\"></a>2.2 State y reducers, los cambios de estado mediante reductores</h2><p>El estado en <em>redux</em> es un objeto tipado a partir de una interfaz, normalmente llamada <code>State</code> a secas, aunque yo prefiero identificarla como <code>RootState</code>. Tendr propiedades para almacenar objetos ms o menos complejos. Cada propiedad tendr su propio tipo complejo y ser gestionada por una funcin reductora especfica. Se necesita un proceso de mapeo que asigne la funcin reductora a cada propiedad del estado raiz. Eso es lo que hace este cdigo:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> RootState &#123;</span><br><span class=\"line\">  router: <span class=\"built_in\">any</span>;</span><br><span class=\"line\">  global: GlobalState;</span><br><span class=\"line\">  cars: CarsState;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> rootReducers: ActionReducerMap&lt;RootState&gt; = &#123;</span><br><span class=\"line\">  router: routerReducer,</span><br><span class=\"line\">  global: globalreducer,</span><br><span class=\"line\">  cars: carsReducer</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure><p>Las funciones reductoras pueden estar en cualquier fichero. Son puras y no deben ser includas en ninguna clase. Normalmente tendrs un fichero para cada reductor. El del <em>router</em> ya viene hecho por NgRx, todos los dems son cosa tuya. Por ejemplo este es el reductor sobre la propiedad <code>global: GlobalState</code>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">globalReducer</span>(<span class=\"params\">state = initialState, action: GlobalActions</span>): <span class=\"title\">GlobalState</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">switch</span> (action.type) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> GlobalActionTypes.SendUserMessage:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &#123; ...state, userMessage: action.payload &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> GlobalActionTypes.IsLoginNeeded:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &#123; ...state, loginNeeded: action.payload &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> GlobalActionTypes.StoreToken:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &#123; ...state, token: action.payload &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">default</span>:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> state;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Como puedes ver esta funcin recibe dos argumento: el estado y la accin que pretende mutarlo. <strong>La accin es un objeto</strong> con dos propiedades. La primera y obligatoria es el tipo y sirve para escoger la lgica que se aplicar. La otra, opcional, es el <code>payload</code> que acta como argumento de la accin. El reductor no puede usar nada ms que estos argumentos: <strong>state y action</strong>. Y por ser puro no puede mutar ninguno, por tanto tiene que clonar el estado recibido antes de aplicarle cualquier cambio. Una vez efectuado el cambio, usando el <em>payload</em> si es preciso, devolver el clon mutado.</p><h2 id=\"2-3-Actions-las-acciones-permitidas\"><a href=\"#2-3-Actions-las-acciones-permitidas\" class=\"headerlink\" title=\"2.3 Actions, las acciones permitidas\"></a>2.3 Actions, las acciones permitidas</h2><p>El patrn Redux no obliga a grandes cosas respecto a cmo implementar las acciones. Lo nico que de verdad necesitas es crear objetos con una propiedad obligatoria <code>type</code> y otra opcional <code>payoload</code>.</p><p>Pero en NgRX han decidido aprovechar al mximo las papacidades del <em>TypeScript</em> y proponen usar un cdigo fuertemente tipado. Para empezar crean un <code>enum</code> que detalla los posible tipos de una accin y les asigna un texto para que luzcan y faciliten su bsqueda en <em>logs</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">enum</span> GlobalActionTypes &#123;</span><br><span class=\"line\">  SendUserMessage = <span class=\"string\">'[Global] Show Message'</span>,</span><br><span class=\"line\">  IsLoginNeeded = <span class=\"string\">'[Auth] Is Login Needed'</span>,</span><br><span class=\"line\">  StoreToken = <span class=\"string\">'[Auth] Store Token'</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Y claro, en un ambiente tipado, la accin ser una clase que ha de cumplir una interfaz. En dicha clase queda ya predetermindo su tipo de accin; y por supuesto que permiten fijar el tipo de datos de la <code>payload</code>. Todo ello genera un cdigo como el siguiente.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> SendUserMesage <span class=\"keyword\">implements</span> Action &#123;</span><br><span class=\"line\">  readonly <span class=\"keyword\">type</span> = GlobalActionTypes.SendUserMessage;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">public</span> payload: <span class=\"built_in\">string</span></span>) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Para terminar, y ya que habremos de crear un buen nmero de clases para las acciones, tambin nos propone exprimir <em>TypeScript</em> para crear un tipo combinado que ofrezca a los consumidores el plantel completo y delimitado de acciones posibles.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">type</span> GlobalActions = SendUserMesage | IsLoginNeeded | StoreToken;</span><br></pre></td></tr></table></figure><p>Es normal que al principio todo este <em>boilerplate</em> te parezca un exceso. Pero entre las plantillas, los <em>snipets</em> y el <em>copy and paste</em> no es tan trabajoso como pudiera parecer. A cambio tienes un cdigo robusto y explcitamente detallado.</p><h2 id=\"2-4-Dispatch-y-Select-despacho-de-acciones-y-seleccion-de-cambios\"><a href=\"#2-4-Dispatch-y-Select-despacho-de-acciones-y-seleccion-de-cambios\" class=\"headerlink\" title=\"2.4 Dispatch y Select, despacho de acciones y seleccin de cambios\"></a>2.4 Dispatch y Select, despacho de acciones y seleccin de cambios</h2><p>Desde el resto del cdigo <strong>la comunicacin con este estado centralizado se realizar por dos conductos oficiales : Dispatch y Select</strong>. El primero es un mtodo que recibe como nico parmetro una instancia de una accin. Dicha instancia lleva implcito el tipo y puede ir rellena de una <em>payload</em>. As es como se envan los cambios hacia el almacn.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> store: Store&lt;RootState&gt;</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.store.dispatch(<span class=\"keyword\">new</span> SendUserMesage(<span class=\"string\">'Tutorial Angular en Espaol'</span>));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>No esperamos respuesta de este mtodo. Es un mundo de <em>fire and forget</em>. Pero en cualquier otro lugar o lugares de nuestro cdigo podremos recibir notificicadciones de cualquier cambio que se haya producido. De forma desacoplada podremos recibir el mensaje con una simple subscripcin <em>RxJS</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">this</span>.store</span><br><span class=\"line\">  .select(<span class=\"string\">'global'</span>, <span class=\"string\">'userMessage'</span>)</span><br><span class=\"line\">  .subscribe(userMessage: <span class=\"function\"><span class=\"params\">string</span> =&gt;</span> <span class=\"built_in\">console</span>.log(userMessage));</span><br></pre></td></tr></table></figure><p>A este mtodo de consulta asncrona se le enva un argumento con mltiples sobrecargas llamado <em>selector</em>. En este caso est formado por dos claves que apuntan a una propiedad concreta en la que estoy interesado: <code>global.userMessage</code>.</p><p>Con esto tenemos una primera implementacin del patrn Redux en Angular usando NgRx. Pero an hay ms.</p><h1 id=\"3-Efectos-y-modulos-funcionales\"><a href=\"#3-Efectos-y-modulos-funcionales\" class=\"headerlink\" title=\"3 Efectos y mdulos funcionales\"></a>3 Efectos y mdulos funcionales</h1><p>Las funciones reductoras, como ya se ha dicho, deben ser puras. La idea es que puedan ser auditadas, re-ejecutadas y testeadas sin que necesiten servicios externos ni causen efectos colaterales. Y esto es un problema con la cantidad de <strong>ejecuciones asncronas en las aplicaciones web</strong>. Cualquier tentacin de lanzar una llamada <em>AJAX</em> dentro de un reductor debe ser elimindad de inmediato.</p><blockquote><p>Dos razones: por un lado en Angular se necesita invocar al <em>httpClient</em> de alguna manera para realizar la llamada <em>AJAX</em>. Y, ya que la funcin no pertenece a ninguna clase, no puede haber constructor que reclame la inyeccin de dicho servicio. Tampoco las funciones puras tienen permitido usar nada que no venga entre sus argumentos. Por otra parte las funciones puras han de ser predecibles, y una llamada a un servidor remoto no es en absoluto predecible. Puede pasarle de todo, as que los reductores no son pas para procesos asncronos.</p></blockquote><p>La solucin que proponen <em>NgRX</em> es usar un artificio llamado efecto, porque ser encargado de <strong>los efectos secundarios que provocan las las instrucciones asncronas</strong>. De una forma simplista, diremos que las acciones asncronas se multiplicarn por tres. El comando que genera la llamada, y los dos potenciales eventos con la respuesta correcta o el error.</p><p>Para manejarlo todo incluyen en la librera el mdulo <code>EffectsModule</code> que ha de registrarse junto al <code>StoreModule</code>. Desde ese momento <em>NgRX</em> activa un sistema de seguimiento que trata las acciones como un stream de <em>RxJS</em> y permite subscribirse a la invocacin de dichas acciones y tratarlas adecuadamente. Una vez ms, aprovechan las caratersticas del <em>TypeScript</em> y hacen uso de los decoradores para definir las funciones que respondern a la ejecucin de las acciones.</p><h2 id=\"3-1-Effect-efectos-secundarios\"><a href=\"#3-1-Effect-efectos-secundarios\" class=\"headerlink\" title=\"3.1 @Effect(), efectos secundarios\"></a>3.1 @Effect(), efectos secundarios</h2><p>El decorador <code>@Effect()</code> se aplica a propiedades de servicios estandar de Angular. <em>NgRX</em> invoca esas funciones ante cada accin despachada, as que lo primero que debemos hacer es aplicar un filtro para quedarnos con las acciones del tipo que nos interese. El que lanzar la llamda <code>http</code>.</p><blockquote><p>Todo el trabajo se realizar con <em>streams</em> y requiere de un conocimiento previo de la librera <em>RxJS</em> y de la mecnica de su mtodo <code>pipe</code> y sus operadores reactivos.</p></blockquote><p>Cuando llegue una de esas acciones realizaremos la llamada asncrona sin complejos. Recordemos que un efecto forma parte de un servicio inyectable de Angular. No tienen ninguna restriccin funcional por parte de Redux. Obviamente la respuesta debe ser capturada y tratada segn haya sido correcta o no.</p><p>Si recibimos una respuesta vlida podremos retornar directamente una nueva accin que actualice el estado con los datos recibidos. En cambio si ha habido un error, habr que reactivar el <em>stream</em> con un nuevo observable que emita la accin que procesar el error.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Effect</span>()</span><br><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> actions$: Actions, <span class=\"keyword\">private</span> cars: CarsService</span>) &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> loadCarsEffect$: Observable&lt;CarsActions&gt; = <span class=\"keyword\">this</span>.actions$.pipe(</span><br><span class=\"line\">  ofType&lt;LoadCars&gt;(CarsActionTypes.LoadCars),</span><br><span class=\"line\">  mergeMap(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.cars.getCars$().pipe(</span><br><span class=\"line\">      map(<span class=\"function\">(<span class=\"params\">cars: Car[]</span>) =&gt;</span> <span class=\"keyword\">new</span> LoadCarsOK(cars)),</span><br><span class=\"line\">      catchError(<span class=\"function\"><span class=\"params\">err</span> =&gt;</span> of(<span class=\"keyword\">new</span> LoadCarsError(<span class=\"string\">'Error loading cars'</span>)))</span><br><span class=\"line\">    )</span><br><span class=\"line\">  )</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure><p>Tmate el tiempo necesario para comprender este cdigo. Especialmente los operadores <code>ofType</code> de <em>NgRX</em> y el <code>mergeMap</code> de <em>RxJS</em>. Fjate bien en los tipos de los datos recibidos y devueltos. El efecto trata con observables de acciones. Recibe una y devuelve otra que puede ser de alguno de los otros dos tipos previstos. En el caso correcto se cambia una accin por otra, en otro caso se crea un nuevo observable mediante el constructor <code>of()</code> antes del retorno.</p><blockquote><p>Para un ejemplo ms completo de estos conceptos explora la implementacin en el proyecto Autobot. El <a href=\"https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/core\" target=\"_blank\" rel=\"noopener\">RootStore</a> hace uso de efectos en la carpeta <code>store/state/cars</code>.</p></blockquote><h2 id=\"3-2-Feature-modulos-funcionales\"><a href=\"#3-2-Feature-modulos-funcionales\" class=\"headerlink\" title=\"3.2 Feature, mdulos funcionales\"></a>3.2 Feature, mdulos funcionales</h2><p>Ya que Redux est especialmente indicado en grandes aplicaciones pero manteniendo un estado centralizado, es fcil que acabemos con un mdulo raiz demasiado pesado que ralentice el inicio de la aplicacin. Para adaptar la gestin central a un entorno con mdulos cargado con <em>lazyloading</em> necesitamos una ltima ayuda, de la mano de <code>FeatureModule</code>.</p><p>Esencialmente es una nuevo <em>store</em> supeditado al principal pero que no se define, y por tanto no pesa, hasta que no es necesario. En Autobot el <a href=\"https://github.com/AcademiaBinaria/autobot/tree/a-redux/src/app/car\" target=\"_blank\" rel=\"noopener\">CarModule</a> es un buen ejemplo de <em>store</em> cargado de forma dinmica como una <code>Feature</code>.</p><p>Ya tienes los conocimientos para gestionar de manera centralizada, auditable y predecible el estado de tus programas. El patrn Redux lucir ms cuanto ms grande y compleja sea tu aplicacin.</p><p>Contina tu formacin avanzada para crear aplicaciones <a href=\"../pwa-entre-la-web-y-las-apps-con-angular\">PWA, entre la web y las apps con Angular</a> y vers como aprendes a programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"PWA, Entre la web y las apps con Angular","date":"2018-10-15T10:50:27.000Z","thumbnail":"/css/images/angular-b_pwa.png","_content":"\n![pwa-entre-la-web-y-las-apps-con-angular](/images/tutorial-angular-b_pwa.png)\n\nLas aplicaciones web han evolucionado desde el contenido esttico al dinmico, luego al adaptable y ahora se acercan **progresivamente a la experiencia y rendimiento de aplicaciones nativas**. En Angular se incorporan esas capacidades desde el propio *framework*.\n \nMediante la librera `@ngular/pwa` dispondremos de todo lo necesario para ofrecer instalacin en escritorio, actualizar la aplicacin controladamente, recibir notificaciones del servidor e incluso mejoras en la cach de comunicaciones que pudieran permitir un funcionamiento *offline*.\n\n\n<!-- more -->\n\nPartiendo del cdigo tal cmo qued en [El patrn Redux con NgRx en Angular](../el-patron-redux-con-ngrx-en-angular/). Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/AutoBot/b-pwa](https://github.com/AcademiaBinaria/autobot/tree/b-pwa)\n\n\n# 1 Las herramientas de la librera PWA\n\nAprovechando las nuevas caractersticas del *Angular CLI 7* tenemos el comando `ng add @angular/pwa` que instala los paquetes y configura cualquier aplicacin Angular conviertindola en una *PWA* bsica.\n\nEstos son los actores y ficheros involucrados en este proceso tras la agregacin del paquete `pwa`.\n\n- ServiceWorkerModule \n- ./angular.json { \"serviceWorker\": true } \n- ./ngsw-config.json \n- ./src/manifest.json\n- ./src/index.html\n- ./assets/icons/..\n\nCon todo instalado y configurado, querrs probar que funciona. Pero, a primera vista no ocurre nada. **Las caractersticas *PWA* estn preparadas para funcionar en modo produccin**. As que lo primero ser ejecutar el comando `ng build --prod` y lanzar un servidor sobre la carpeta de distribucin recin creada.\n\nDe entre los nuevos ficheros que aparecen hay dos que debes conocer especialmente, **el *manifest* y el *service worker***.\n\n## 1.1 El manifest.json\n\nEste sencillo documento acompaa al `index.html` y le da indicaciones al navegador para que trate esta aplicacin de menera especial. El fichero en s contiene una *metadata* con textos descriptivos, colores e iconos para ser usados por el navegador y el sistema operativo y **ofrecerle al usuario que instale la *web* como una *app***. \n\nCasi todo es cosmtico, pero merece la pena prestar especial atencin a los iconos. Por defecto el *CLI* instala distintas versiones del logo ofical de Angular. Una forma cmoda de sustituirlo por los tuyos es usar la herramienta *ngx-pwa-icons* \n\n```json\n{\n  \"name\": \"Play with cars, learning Angular\",\n  \"short_name\": \"autobot\",\n  \"theme_color\": \"#1976d2\",\n  \"background_color\": \"#fafafa\",\n  \"display\": \"standalone\",\n  \"scope\": \"/\",\n  \"start_url\": \"/autobot/?utm_source=homescreen\",\n  \"icons\": [\n    {\n      \"src\": \"assets/icons/icon-72x72.png\",\n      \"sizes\": \"72x72\",\n      \"type\": \"image/png\"\n    },\n    ...\n   ]\n} \n```\n\n> Asegrate de que en la `start_url` apunte a la pgina de inicio correcta y despliega en modo produccin en un servidor seguro con *https*. Prubalo varias veces en distintos navegadores y vers las distintas experiencias de instalacin que ofrecen. \n\n## 1.2 El ngsw-worker.js\n\nEl otro gran fichero, y ms importante para los desarrolladores, es **el configurador del *Service Worker***. Cuando un navegador ejecuta un *script* lo hace en *thread* dedicado a la interaccin con el usuario y la manipulacin del *DOM*. Normalmente ese hilo est muy ocupado, cuando no est saturado. La solucin para agilizar los procesos est en usar ms *threads*. Presentamos el *worker thread*. \n\nSe le llama as a los hilos creados a partir del principal y que le ayudan en tareas en segundo plano. Esos hilos tienen **prohibido el acceso al DOM, ni lo escuchan ni lo manipulan**. Pero a cambio estn muy liberados para realizar clculos complejos o llamadas a servicios. Se comunican con el *thread* principal a traves de un sencillo protocolo de eventos y subscripciones. \n\nUna de las tareas para las que ms se les utiliza es para la gestin inteligente de las comunicaciones. Este fichero viene pre programado para realizar las siguientes **funciones PWA de Angular**: \n\n- Cach de contenido esttico para funcionamiento offline \n- Cach de datos dinmicos para mayor velocidad \n- Gestin de instalaciones y versiones \n- Notificaciones de datos push \n\nTodo lo que hay que hacer es configurar estas funciones en un fichero, el `ngsw-config.json`, ya generado con valores por defecto. El *CLI*, durante el proceso de construccin en modo produccin, copiar y manipular los scripts y sus configuraciones. En ejecucin, el `ServiceModule` registrar el script en el navegador, se subscribir a sus eventos y ejecutar lo configurado por el programador en el *json*.   \n\n\n# 2 Comunicaciones y cach\n\n**El service worker de Angular** est especialmente diseado para hacerse cargo de las comunicaciones con el servidor. Digamos que se convierte en un **interceptor transparente de todas las peticiones http**. Tanto de los ficheros propios de la aplicacin como de las comunicaciones de datos. \n\n## 2.1 Descarga y actualizacin de la aplicacin\n\nUna vez descargado el *index.html* con el contenido mnimo de Angular, diramos que la aplicacin se ha instalado y est lista para ejecutarse. A partir de ese momento el *ngsw* toma el control y puede pre descargar ficheros en segundo plano; de forma que **cuando sean reclamados ya estn disponibles** y mejoren la experiencia del usuario.\n\nRutinariamente el servicio se ocupar de consultar novedades en el servidor para mantener los ficheros locales actualizados. Todo ello se configura en la seccin `assetGroups` del  `ngsw-config.json`.\n\n```json\n{\n \"assetGroups\": [\n    {\n      \"name\": \"app\",\n      \"installMode\": \"prefetch\",\n      \"updateMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\n          \"/favicon.ico\",\n          \"/index.html\",\n          \"/*.css\",\n          \"/common*.js\",\n          \"/main*.js\",\n          \"/ngsw*.js\",\n          \"/woker*.js\",\n          \"/polyfills*.js\",\n          \"/runtime*.js\",\n          \"/fontawesome*\"\n        ]\n      }\n    }, {\n      \"name\": \"assets\",\n      \"installMode\": \"lazy\",\n      \"updateMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\n          \"/assets/logo.png\",\n          \"/assets/icons/**\",\n          \"/*.js\"\n        ]\n      }\n    }],\n}\n```\n\n\n## 2.2 Cach inteligente de datos\n\nEl control de la **recepcin de datos dinmicos** es la otra gran tarea del *service worker*. En este caso para tener una cach que acelere la presentacin de datos o que incluso permita un funcionamiento *offline*.\n\nMediante **dos estrategias complementarias que tratan de mantener los datos actualizados y disponibles** en todo momento. En este caso configurandolo en los `dataGroups`. \n\n> La idea del *cache-first* es tener el dato ya listo para ser usado cuanto antes. Mientras que con *api-first* se pretende tener la versin ms actual posible, y usar la ltima descargada en caso de problemas o desconexin total.\n\n```json\n{\n dataGroups\": [\n   {\n      \"name\": \"cache-first\",\n      \"urls\":[\n        \"https://academiabinaria.github.io/autobot/assets/data/cars.json\"        \n      ],\n      \"cacheConfig\":{\n        \"strategy\":\"performance\",\n        \"maxSize\":10,\n        \"maxAge\":\"1d\"\n      }\n    }\n    ,{\n      \"name\": \"api-first\",\n      \"urls\":[\n        \"https://api-base.herokuapp.com/api/priv/travels/**\"\n      ],\n      \"cacheConfig\":{\n        \"strategy\" : \"freshness\",\n        \"maxSize\": 100,\n        \"maxAge\" : \"1h\",\n        \"timeout\" : \"5s\"\n      }\n    }\n  ]\n}\n```\n\n\n# 3 Servicios\n\nLa librera `@angular/pwa` publica el mdulo `ServiceWorkerModule` que contiene la lgica de registro del *service worker* y dos servicios programables con los que interactuar desde el cdigo de tu aplicacin Angular.\n\n## 3.1 Actualizacin con el SwUpdate\n\nCuando despliegas una nueva versin seguro que ests deseando que los usuarios disfruten cuanto antes de las mejoras o correcciones. Pero en las aplicaciones SPA resulta que **la actualizacin no es tan inmediata** como pudiera parecer. Al no forzar la recarga del documento en las navegaciones internas, el `index.html` puede residir sin cambios ms de lo debido. Confiar en que lo hagan el navegador o el usuario puede no ser una opcin.\n\nLa solucin PWA es usar el `ServiceWorker` para detectar nuevas versiones en el servidor. Para ello utiliza un sistema propio de *hashes* que le permite comparar la versin descargada y la disponible en el servidor.** Cuando detecta un cambio emite un evento al que te puedes subscribir** usando el servicio `SwUpdate`. En ese momento puedes consultar al usuario, o forzar a lo bestia la recarga ;-).\n\n\n```typescript\nconstructor(private swUpdate: SwUpdate) {\n  if (this.swUpdate.isEnabled) {\n    this.swUpdate.available.subscribe((event: UpdateAvailableEvent) => {\n      if (confirm(`Do you want to update?`)) {\n        window.location.reload();\n      }\n    });\n  }\n}\n```\n\n## 3.2 Notificaciones con el SwPush\n\nUna caractersitca de las *apps* nativas muy aprecia por los usuarios es la capacidad de mostrar **mensajes recibidos va *push* por parte del servidor**. Pueden ser avisos, novedades o simple marketing. Pero lo importante es que lo recibe el sistema operativo, la aplicacin no necesita estar en marcha y el mensaje se muestra de forma nativa.\n\n> Obviamente para ello hay que involucrar cdigo de servidor y un servicio de mensajera de terceros. Pero la parte Angular del desarrollo es muy sencilla. Consite en registrar al usuario, que voluntariamente decide ser notificado, y luego escuchar los mensajes provenientes en forma de eventos. Todo ello reclamando una dependencia al servicio de notificaciones `constructor(private swPush: SwPush)`.\n\nYa tienes una web que se comporta progresivamente como una App nativa, una *Progressive Web Application*. Las mejoras en rendimiento y experiencia de usuario son recompensa ms que suficiente para que le des una oportunidad a las **Angular PWA**.\n\nContina tu formacin avanzada para crear aplicaciones con mayor [Velocidad y SEO con el SSR de Angular Universal](../velocidad-y-seo-con-el-ssr-de-angular-universal) y vers como aprendes a programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-b-PWA-Entre-la-web-y-las-apps-con-Angular.md","raw":"---\ntitle: PWA, Entre la web y las apps con Angular\npermalink: pwa-entre-la-web-y-las-apps-con-angular\ndate: 2018-10-15 12:50:27\ntags:  \n- Angular\n- Angular7\n- Angular6\n- Angular2\n- PWA\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular] \nthumbnail: /css/images/angular-b_pwa.png\n---\n\n![pwa-entre-la-web-y-las-apps-con-angular](/images/tutorial-angular-b_pwa.png)\n\nLas aplicaciones web han evolucionado desde el contenido esttico al dinmico, luego al adaptable y ahora se acercan **progresivamente a la experiencia y rendimiento de aplicaciones nativas**. En Angular se incorporan esas capacidades desde el propio *framework*.\n \nMediante la librera `@ngular/pwa` dispondremos de todo lo necesario para ofrecer instalacin en escritorio, actualizar la aplicacin controladamente, recibir notificaciones del servidor e incluso mejoras en la cach de comunicaciones que pudieran permitir un funcionamiento *offline*.\n\n\n<!-- more -->\n\nPartiendo del cdigo tal cmo qued en [El patrn Redux con NgRx en Angular](../el-patron-redux-con-ngrx-en-angular/). Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/AutoBot/b-pwa](https://github.com/AcademiaBinaria/autobot/tree/b-pwa)\n\n\n# 1 Las herramientas de la librera PWA\n\nAprovechando las nuevas caractersticas del *Angular CLI 7* tenemos el comando `ng add @angular/pwa` que instala los paquetes y configura cualquier aplicacin Angular conviertindola en una *PWA* bsica.\n\nEstos son los actores y ficheros involucrados en este proceso tras la agregacin del paquete `pwa`.\n\n- ServiceWorkerModule \n- ./angular.json { \"serviceWorker\": true } \n- ./ngsw-config.json \n- ./src/manifest.json\n- ./src/index.html\n- ./assets/icons/..\n\nCon todo instalado y configurado, querrs probar que funciona. Pero, a primera vista no ocurre nada. **Las caractersticas *PWA* estn preparadas para funcionar en modo produccin**. As que lo primero ser ejecutar el comando `ng build --prod` y lanzar un servidor sobre la carpeta de distribucin recin creada.\n\nDe entre los nuevos ficheros que aparecen hay dos que debes conocer especialmente, **el *manifest* y el *service worker***.\n\n## 1.1 El manifest.json\n\nEste sencillo documento acompaa al `index.html` y le da indicaciones al navegador para que trate esta aplicacin de menera especial. El fichero en s contiene una *metadata* con textos descriptivos, colores e iconos para ser usados por el navegador y el sistema operativo y **ofrecerle al usuario que instale la *web* como una *app***. \n\nCasi todo es cosmtico, pero merece la pena prestar especial atencin a los iconos. Por defecto el *CLI* instala distintas versiones del logo ofical de Angular. Una forma cmoda de sustituirlo por los tuyos es usar la herramienta *ngx-pwa-icons* \n\n```json\n{\n  \"name\": \"Play with cars, learning Angular\",\n  \"short_name\": \"autobot\",\n  \"theme_color\": \"#1976d2\",\n  \"background_color\": \"#fafafa\",\n  \"display\": \"standalone\",\n  \"scope\": \"/\",\n  \"start_url\": \"/autobot/?utm_source=homescreen\",\n  \"icons\": [\n    {\n      \"src\": \"assets/icons/icon-72x72.png\",\n      \"sizes\": \"72x72\",\n      \"type\": \"image/png\"\n    },\n    ...\n   ]\n} \n```\n\n> Asegrate de que en la `start_url` apunte a la pgina de inicio correcta y despliega en modo produccin en un servidor seguro con *https*. Prubalo varias veces en distintos navegadores y vers las distintas experiencias de instalacin que ofrecen. \n\n## 1.2 El ngsw-worker.js\n\nEl otro gran fichero, y ms importante para los desarrolladores, es **el configurador del *Service Worker***. Cuando un navegador ejecuta un *script* lo hace en *thread* dedicado a la interaccin con el usuario y la manipulacin del *DOM*. Normalmente ese hilo est muy ocupado, cuando no est saturado. La solucin para agilizar los procesos est en usar ms *threads*. Presentamos el *worker thread*. \n\nSe le llama as a los hilos creados a partir del principal y que le ayudan en tareas en segundo plano. Esos hilos tienen **prohibido el acceso al DOM, ni lo escuchan ni lo manipulan**. Pero a cambio estn muy liberados para realizar clculos complejos o llamadas a servicios. Se comunican con el *thread* principal a traves de un sencillo protocolo de eventos y subscripciones. \n\nUna de las tareas para las que ms se les utiliza es para la gestin inteligente de las comunicaciones. Este fichero viene pre programado para realizar las siguientes **funciones PWA de Angular**: \n\n- Cach de contenido esttico para funcionamiento offline \n- Cach de datos dinmicos para mayor velocidad \n- Gestin de instalaciones y versiones \n- Notificaciones de datos push \n\nTodo lo que hay que hacer es configurar estas funciones en un fichero, el `ngsw-config.json`, ya generado con valores por defecto. El *CLI*, durante el proceso de construccin en modo produccin, copiar y manipular los scripts y sus configuraciones. En ejecucin, el `ServiceModule` registrar el script en el navegador, se subscribir a sus eventos y ejecutar lo configurado por el programador en el *json*.   \n\n\n# 2 Comunicaciones y cach\n\n**El service worker de Angular** est especialmente diseado para hacerse cargo de las comunicaciones con el servidor. Digamos que se convierte en un **interceptor transparente de todas las peticiones http**. Tanto de los ficheros propios de la aplicacin como de las comunicaciones de datos. \n\n## 2.1 Descarga y actualizacin de la aplicacin\n\nUna vez descargado el *index.html* con el contenido mnimo de Angular, diramos que la aplicacin se ha instalado y est lista para ejecutarse. A partir de ese momento el *ngsw* toma el control y puede pre descargar ficheros en segundo plano; de forma que **cuando sean reclamados ya estn disponibles** y mejoren la experiencia del usuario.\n\nRutinariamente el servicio se ocupar de consultar novedades en el servidor para mantener los ficheros locales actualizados. Todo ello se configura en la seccin `assetGroups` del  `ngsw-config.json`.\n\n```json\n{\n \"assetGroups\": [\n    {\n      \"name\": \"app\",\n      \"installMode\": \"prefetch\",\n      \"updateMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\n          \"/favicon.ico\",\n          \"/index.html\",\n          \"/*.css\",\n          \"/common*.js\",\n          \"/main*.js\",\n          \"/ngsw*.js\",\n          \"/woker*.js\",\n          \"/polyfills*.js\",\n          \"/runtime*.js\",\n          \"/fontawesome*\"\n        ]\n      }\n    }, {\n      \"name\": \"assets\",\n      \"installMode\": \"lazy\",\n      \"updateMode\": \"prefetch\",\n      \"resources\": {\n        \"files\": [\n          \"/assets/logo.png\",\n          \"/assets/icons/**\",\n          \"/*.js\"\n        ]\n      }\n    }],\n}\n```\n\n\n## 2.2 Cach inteligente de datos\n\nEl control de la **recepcin de datos dinmicos** es la otra gran tarea del *service worker*. En este caso para tener una cach que acelere la presentacin de datos o que incluso permita un funcionamiento *offline*.\n\nMediante **dos estrategias complementarias que tratan de mantener los datos actualizados y disponibles** en todo momento. En este caso configurandolo en los `dataGroups`. \n\n> La idea del *cache-first* es tener el dato ya listo para ser usado cuanto antes. Mientras que con *api-first* se pretende tener la versin ms actual posible, y usar la ltima descargada en caso de problemas o desconexin total.\n\n```json\n{\n dataGroups\": [\n   {\n      \"name\": \"cache-first\",\n      \"urls\":[\n        \"https://academiabinaria.github.io/autobot/assets/data/cars.json\"        \n      ],\n      \"cacheConfig\":{\n        \"strategy\":\"performance\",\n        \"maxSize\":10,\n        \"maxAge\":\"1d\"\n      }\n    }\n    ,{\n      \"name\": \"api-first\",\n      \"urls\":[\n        \"https://api-base.herokuapp.com/api/priv/travels/**\"\n      ],\n      \"cacheConfig\":{\n        \"strategy\" : \"freshness\",\n        \"maxSize\": 100,\n        \"maxAge\" : \"1h\",\n        \"timeout\" : \"5s\"\n      }\n    }\n  ]\n}\n```\n\n\n# 3 Servicios\n\nLa librera `@angular/pwa` publica el mdulo `ServiceWorkerModule` que contiene la lgica de registro del *service worker* y dos servicios programables con los que interactuar desde el cdigo de tu aplicacin Angular.\n\n## 3.1 Actualizacin con el SwUpdate\n\nCuando despliegas una nueva versin seguro que ests deseando que los usuarios disfruten cuanto antes de las mejoras o correcciones. Pero en las aplicaciones SPA resulta que **la actualizacin no es tan inmediata** como pudiera parecer. Al no forzar la recarga del documento en las navegaciones internas, el `index.html` puede residir sin cambios ms de lo debido. Confiar en que lo hagan el navegador o el usuario puede no ser una opcin.\n\nLa solucin PWA es usar el `ServiceWorker` para detectar nuevas versiones en el servidor. Para ello utiliza un sistema propio de *hashes* que le permite comparar la versin descargada y la disponible en el servidor.** Cuando detecta un cambio emite un evento al que te puedes subscribir** usando el servicio `SwUpdate`. En ese momento puedes consultar al usuario, o forzar a lo bestia la recarga ;-).\n\n\n```typescript\nconstructor(private swUpdate: SwUpdate) {\n  if (this.swUpdate.isEnabled) {\n    this.swUpdate.available.subscribe((event: UpdateAvailableEvent) => {\n      if (confirm(`Do you want to update?`)) {\n        window.location.reload();\n      }\n    });\n  }\n}\n```\n\n## 3.2 Notificaciones con el SwPush\n\nUna caractersitca de las *apps* nativas muy aprecia por los usuarios es la capacidad de mostrar **mensajes recibidos va *push* por parte del servidor**. Pueden ser avisos, novedades o simple marketing. Pero lo importante es que lo recibe el sistema operativo, la aplicacin no necesita estar en marcha y el mensaje se muestra de forma nativa.\n\n> Obviamente para ello hay que involucrar cdigo de servidor y un servicio de mensajera de terceros. Pero la parte Angular del desarrollo es muy sencilla. Consite en registrar al usuario, que voluntariamente decide ser notificado, y luego escuchar los mensajes provenientes en forma de eventos. Todo ello reclamando una dependencia al servicio de notificaciones `constructor(private swPush: SwPush)`.\n\nYa tienes una web que se comporta progresivamente como una App nativa, una *Progressive Web Application*. Las mejoras en rendimiento y experiencia de usuario son recompensa ms que suficiente para que le des una oportunidad a las **Angular PWA**.\n\nContina tu formacin avanzada para crear aplicaciones con mayor [Velocidad y SEO con el SSR de Angular Universal](../velocidad-y-seo-con-el-ssr-de-angular-universal) y vers como aprendes a programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"pwa-entre-la-web-y-las-apps-con-angular","published":1,"updated":"2018-12-03T16:38:39.288Z","_id":"cjn310lsu0000rks3jcut76z6","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-b_pwa.png\" alt=\"pwa-entre-la-web-y-las-apps-con-angular\"></p><p>Las aplicaciones web han evolucionado desde el contenido esttico al dinmico, luego al adaptable y ahora se acercan <strong>progresivamente a la experiencia y rendimiento de aplicaciones nativas</strong>. En Angular se incorporan esas capacidades desde el propio <em>framework</em>.</p><p>Mediante la librera <code>@ngular/pwa</code> dispondremos de todo lo necesario para ofrecer instalacin en escritorio, actualizar la aplicacin controladamente, recibir notificaciones del servidor e incluso mejoras en la cach de comunicaciones que pudieran permitir un funcionamiento <em>offline</em>.</p><a id=\"more\"></a><p>Partiendo del cdigo tal cmo qued en <a href=\"../el-patron-redux-con-ngrx-en-angular/\">El patrn Redux con NgRx en Angular</a>. Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/autobot/tree/b-pwa\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/AutoBot/b-pwa</a></p></blockquote><h1 id=\"1-Las-herramientas-de-la-libreria-PWA\"><a href=\"#1-Las-herramientas-de-la-libreria-PWA\" class=\"headerlink\" title=\"1 Las herramientas de la librera PWA\"></a>1 Las herramientas de la librera PWA</h1><p>Aprovechando las nuevas caractersticas del <em>Angular CLI 7</em> tenemos el comando <code>ng add @angular/pwa</code> que instala los paquetes y configura cualquier aplicacin Angular conviertindola en una <em>PWA</em> bsica.</p><p>Estos son los actores y ficheros involucrados en este proceso tras la agregacin del paquete <code>pwa</code>.</p><ul><li>ServiceWorkerModule</li><li>./angular.json { serviceWorker: true }</li><li>./ngsw-config.json</li><li>./src/manifest.json</li><li>./src/index.html</li><li>./assets/icons/..</li></ul><p>Con todo instalado y configurado, querrs probar que funciona. Pero, a primera vista no ocurre nada. <strong>Las caractersticas <em>PWA</em> estn preparadas para funcionar en modo produccin</strong>. As que lo primero ser ejecutar el comando <code>ng build --prod</code> y lanzar un servidor sobre la carpeta de distribucin recin creada.</p><p>De entre los nuevos ficheros que aparecen hay dos que debes conocer especialmente, <strong>el <em>manifest</em> y el <em>service worker</em></strong>.</p><h2 id=\"1-1-El-manifest-json\"><a href=\"#1-1-El-manifest-json\" class=\"headerlink\" title=\"1.1 El manifest.json\"></a>1.1 El manifest.json</h2><p>Este sencillo documento acompaa al <code>index.html</code> y le da indicaciones al navegador para que trate esta aplicacin de menera especial. El fichero en s contiene una <em>metadata</em> con textos descriptivos, colores e iconos para ser usados por el navegador y el sistema operativo y <strong>ofrecerle al usuario que instale la <em>web</em> como una <em>app</em></strong>.</p><p>Casi todo es cosmtico, pero merece la pena prestar especial atencin a los iconos. Por defecto el <em>CLI</em> instala distintas versiones del logo ofical de Angular. Una forma cmoda de sustituirlo por los tuyos es usar la herramienta <em>ngx-pwa-icons</em></p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"Play with cars, learning Angular\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"short_name\"</span>: <span class=\"string\">\"autobot\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"theme_color\"</span>: <span class=\"string\">\"#1976d2\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"background_color\"</span>: <span class=\"string\">\"#fafafa\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"display\"</span>: <span class=\"string\">\"standalone\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"scope\"</span>: <span class=\"string\">\"/\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"start_url\"</span>: <span class=\"string\">\"/autobot/?utm_source=homescreen\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"icons\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"src\"</span>: <span class=\"string\">\"assets/icons/icon-72x72.png\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"sizes\"</span>: <span class=\"string\">\"72x72\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"image/png\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    ...</span><br><span class=\"line\">   ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Asegrate de que en la <code>start_url</code> apunte a la pgina de inicio correcta y despliega en modo produccin en un servidor seguro con <em>https</em>. Prubalo varias veces en distintos navegadores y vers las distintas experiencias de instalacin que ofrecen.</p></blockquote><h2 id=\"1-2-El-ngsw-worker-js\"><a href=\"#1-2-El-ngsw-worker-js\" class=\"headerlink\" title=\"1.2 El ngsw-worker.js\"></a>1.2 El ngsw-worker.js</h2><p>El otro gran fichero, y ms importante para los desarrolladores, es <strong>el configurador del <em>Service Worker</em></strong>. Cuando un navegador ejecuta un <em>script</em> lo hace en <em>thread</em> dedicado a la interaccin con el usuario y la manipulacin del <em>DOM</em>. Normalmente ese hilo est muy ocupado, cuando no est saturado. La solucin para agilizar los procesos est en usar ms <em>threads</em>. Presentamos el <em>worker thread</em>.</p><p>Se le llama as a los hilos creados a partir del principal y que le ayudan en tareas en segundo plano. Esos hilos tienen <strong>prohibido el acceso al DOM, ni lo escuchan ni lo manipulan</strong>. Pero a cambio estn muy liberados para realizar clculos complejos o llamadas a servicios. Se comunican con el <em>thread</em> principal a traves de un sencillo protocolo de eventos y subscripciones.</p><p>Una de las tareas para las que ms se les utiliza es para la gestin inteligente de las comunicaciones. Este fichero viene pre programado para realizar las siguientes <strong>funciones PWA de Angular</strong>:</p><ul><li>Cach de contenido esttico para funcionamiento offline</li><li>Cach de datos dinmicos para mayor velocidad</li><li>Gestin de instalaciones y versiones</li><li>Notificaciones de datos push</li></ul><p>Todo lo que hay que hacer es configurar estas funciones en un fichero, el <code>ngsw-config.json</code>, ya generado con valores por defecto. El <em>CLI</em>, durante el proceso de construccin en modo produccin, copiar y manipular los scripts y sus configuraciones. En ejecucin, el <code>ServiceModule</code> registrar el script en el navegador, se subscribir a sus eventos y ejecutar lo configurado por el programador en el <em>json</em>.</p><h1 id=\"2-Comunicaciones-y-cache\"><a href=\"#2-Comunicaciones-y-cache\" class=\"headerlink\" title=\"2 Comunicaciones y cach\"></a>2 Comunicaciones y cach</h1><p><strong>El service worker de Angular</strong> est especialmente diseado para hacerse cargo de las comunicaciones con el servidor. Digamos que se convierte en un <strong>interceptor transparente de todas las peticiones http</strong>. Tanto de los ficheros propios de la aplicacin como de las comunicaciones de datos.</p><h2 id=\"2-1-Descarga-y-actualizacion-de-la-aplicacion\"><a href=\"#2-1-Descarga-y-actualizacion-de-la-aplicacion\" class=\"headerlink\" title=\"2.1 Descarga y actualizacin de la aplicacin\"></a>2.1 Descarga y actualizacin de la aplicacin</h2><p>Una vez descargado el <em>index.html</em> con el contenido mnimo de Angular, diramos que la aplicacin se ha instalado y est lista para ejecutarse. A partir de ese momento el <em>ngsw</em> toma el control y puede pre descargar ficheros en segundo plano; de forma que <strong>cuando sean reclamados ya estn disponibles</strong> y mejoren la experiencia del usuario.</p><p>Rutinariamente el servicio se ocupar de consultar novedades en el servidor para mantener los ficheros locales actualizados. Todo ello se configura en la seccin <code>assetGroups</code> del <code>ngsw-config.json</code>.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\"> <span class=\"attr\">\"assetGroups\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"app\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"updateMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"files\"</span>: [</span><br><span class=\"line\">          <span class=\"string\">\"/favicon.ico\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/index.html\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/*.css\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/common*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/main*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/ngsw*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/woker*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/polyfills*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/runtime*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/fontawesome*\"</span></span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;, &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"assets\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"lazy\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"updateMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"files\"</span>: [</span><br><span class=\"line\">          <span class=\"string\">\"/assets/logo.png\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/assets/icons/**\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/*.js\"</span></span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Cache-inteligente-de-datos\"><a href=\"#2-2-Cache-inteligente-de-datos\" class=\"headerlink\" title=\"2.2 Cach inteligente de datos\"></a>2.2 Cach inteligente de datos</h2><p>El control de la <strong>recepcin de datos dinmicos</strong> es la otra gran tarea del <em>service worker</em>. En este caso para tener una cach que acelere la presentacin de datos o que incluso permita un funcionamiento <em>offline</em>.</p><p>Mediante <strong>dos estrategias complementarias que tratan de mantener los datos actualizados y disponibles</strong> en todo momento. En este caso configurandolo en los <code>dataGroups</code>.</p><blockquote><p>La idea del <em>cache-first</em> es tener el dato ya listo para ser usado cuanto antes. Mientras que con <em>api-first</em> se pretende tener la versin ms actual posible, y usar la ltima descargada en caso de problemas o desconexin total.</p></blockquote><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\"> dataGroups\": [</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"cache-first\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"urls\"</span>:[</span><br><span class=\"line\">        <span class=\"string\">\"https://academiabinaria.github.io/autobot/assets/data/cars.json\"</span>        </span><br><span class=\"line\">      ],</span><br><span class=\"line\">      <span class=\"attr\">\"cacheConfig\"</span>:&#123;</span><br><span class=\"line\">        <span class=\"attr\">\"strategy\"</span>:<span class=\"string\">\"performance\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"maxSize\"</span>:<span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"maxAge\"</span>:<span class=\"string\">\"1d\"</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ,&#123;</span><br><span class=\"line\">      \"name\": \"api-first\",</span><br><span class=\"line\">      \"urls\":[</span><br><span class=\"line\">        <span class=\"string\">\"https://api-base.herokuapp.com/api/priv/travels/**\"</span></span><br><span class=\"line\">      ],</span><br><span class=\"line\">      \"cacheConfig\":&#123;</span><br><span class=\"line\">        \"strategy\" : \"freshness\",</span><br><span class=\"line\">        \"maxSize\": 100,</span><br><span class=\"line\">        \"maxAge\" : \"1h\",</span><br><span class=\"line\">        \"timeout\" : \"5s\"</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"3-Servicios\"><a href=\"#3-Servicios\" class=\"headerlink\" title=\"3 Servicios\"></a>3 Servicios</h1><p>La librera <code>@angular/pwa</code> publica el mdulo <code>ServiceWorkerModule</code> que contiene la lgica de registro del <em>service worker</em> y dos servicios programables con los que interactuar desde el cdigo de tu aplicacin Angular.</p><h2 id=\"3-1-Actualizacion-con-el-SwUpdate\"><a href=\"#3-1-Actualizacion-con-el-SwUpdate\" class=\"headerlink\" title=\"3.1 Actualizacin con el SwUpdate\"></a>3.1 Actualizacin con el SwUpdate</h2><p>Cuando despliegas una nueva versin seguro que ests deseando que los usuarios disfruten cuanto antes de las mejoras o correcciones. Pero en las aplicaciones SPA resulta que <strong>la actualizacin no es tan inmediata</strong> como pudiera parecer. Al no forzar la recarga del documento en las navegaciones internas, el <code>index.html</code> puede residir sin cambios ms de lo debido. Confiar en que lo hagan el navegador o el usuario puede no ser una opcin.</p><p>La solucin PWA es usar el <code>ServiceWorker</code> para detectar nuevas versiones en el servidor. Para ello utiliza un sistema propio de <em>hashes</em> que le permite comparar la versin descargada y la disponible en el servidor.<strong> Cuando detecta un cambio emite un evento al que te puedes subscribir</strong> usando el servicio <code>SwUpdate</code>. En ese momento puedes consultar al usuario, o forzar a lo bestia la recarga ;-).</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> swUpdate: SwUpdate</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.swUpdate.isEnabled) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.swUpdate.available.subscribe(<span class=\"function\">(<span class=\"params\">event: UpdateAvailableEvent</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (confirm(<span class=\"string\">`Do you want to update?`</span>)) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">window</span>.location.reload();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Notificaciones-con-el-SwPush\"><a href=\"#3-2-Notificaciones-con-el-SwPush\" class=\"headerlink\" title=\"3.2 Notificaciones con el SwPush\"></a>3.2 Notificaciones con el SwPush</h2><p>Una caractersitca de las <em>apps</em> nativas muy aprecia por los usuarios es la capacidad de mostrar <strong>mensajes recibidos va <em>push</em> por parte del servidor</strong>. Pueden ser avisos, novedades o simple marketing. Pero lo importante es que lo recibe el sistema operativo, la aplicacin no necesita estar en marcha y el mensaje se muestra de forma nativa.</p><blockquote><p>Obviamente para ello hay que involucrar cdigo de servidor y un servicio de mensajera de terceros. Pero la parte Angular del desarrollo es muy sencilla. Consite en registrar al usuario, que voluntariamente decide ser notificado, y luego escuchar los mensajes provenientes en forma de eventos. Todo ello reclamando una dependencia al servicio de notificaciones <code>constructor(private swPush: SwPush)</code>.</p></blockquote><p>Ya tienes una web que se comporta progresivamente como una App nativa, una <em>Progressive Web Application</em>. Las mejoras en rendimiento y experiencia de usuario son recompensa ms que suficiente para que le des una oportunidad a las <strong>Angular PWA</strong>.</p><p>Contina tu formacin avanzada para crear aplicaciones con mayor <a href=\"../velocidad-y-seo-con-el-ssr-de-angular-universal\">Velocidad y SEO con el SSR de Angular Universal</a> y vers como aprendes a programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-b_pwa.png\" alt=\"pwa-entre-la-web-y-las-apps-con-angular\"></p><p>Las aplicaciones web han evolucionado desde el contenido esttico al dinmico, luego al adaptable y ahora se acercan <strong>progresivamente a la experiencia y rendimiento de aplicaciones nativas</strong>. En Angular se incorporan esas capacidades desde el propio <em>framework</em>.</p><p>Mediante la librera <code>@ngular/pwa</code> dispondremos de todo lo necesario para ofrecer instalacin en escritorio, actualizar la aplicacin controladamente, recibir notificaciones del servidor e incluso mejoras en la cach de comunicaciones que pudieran permitir un funcionamiento <em>offline</em>.</p>","more":"<p>Partiendo del cdigo tal cmo qued en <a href=\"../el-patron-redux-con-ngrx-en-angular/\">El patrn Redux con NgRx en Angular</a>. Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/autobot/tree/b-pwa\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/AutoBot/b-pwa</a></p></blockquote><h1 id=\"1-Las-herramientas-de-la-libreria-PWA\"><a href=\"#1-Las-herramientas-de-la-libreria-PWA\" class=\"headerlink\" title=\"1 Las herramientas de la librera PWA\"></a>1 Las herramientas de la librera PWA</h1><p>Aprovechando las nuevas caractersticas del <em>Angular CLI 7</em> tenemos el comando <code>ng add @angular/pwa</code> que instala los paquetes y configura cualquier aplicacin Angular conviertindola en una <em>PWA</em> bsica.</p><p>Estos son los actores y ficheros involucrados en este proceso tras la agregacin del paquete <code>pwa</code>.</p><ul><li>ServiceWorkerModule</li><li>./angular.json { serviceWorker: true }</li><li>./ngsw-config.json</li><li>./src/manifest.json</li><li>./src/index.html</li><li>./assets/icons/..</li></ul><p>Con todo instalado y configurado, querrs probar que funciona. Pero, a primera vista no ocurre nada. <strong>Las caractersticas <em>PWA</em> estn preparadas para funcionar en modo produccin</strong>. As que lo primero ser ejecutar el comando <code>ng build --prod</code> y lanzar un servidor sobre la carpeta de distribucin recin creada.</p><p>De entre los nuevos ficheros que aparecen hay dos que debes conocer especialmente, <strong>el <em>manifest</em> y el <em>service worker</em></strong>.</p><h2 id=\"1-1-El-manifest-json\"><a href=\"#1-1-El-manifest-json\" class=\"headerlink\" title=\"1.1 El manifest.json\"></a>1.1 El manifest.json</h2><p>Este sencillo documento acompaa al <code>index.html</code> y le da indicaciones al navegador para que trate esta aplicacin de menera especial. El fichero en s contiene una <em>metadata</em> con textos descriptivos, colores e iconos para ser usados por el navegador y el sistema operativo y <strong>ofrecerle al usuario que instale la <em>web</em> como una <em>app</em></strong>.</p><p>Casi todo es cosmtico, pero merece la pena prestar especial atencin a los iconos. Por defecto el <em>CLI</em> instala distintas versiones del logo ofical de Angular. Una forma cmoda de sustituirlo por los tuyos es usar la herramienta <em>ngx-pwa-icons</em></p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"Play with cars, learning Angular\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"short_name\"</span>: <span class=\"string\">\"autobot\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"theme_color\"</span>: <span class=\"string\">\"#1976d2\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"background_color\"</span>: <span class=\"string\">\"#fafafa\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"display\"</span>: <span class=\"string\">\"standalone\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"scope\"</span>: <span class=\"string\">\"/\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"start_url\"</span>: <span class=\"string\">\"/autobot/?utm_source=homescreen\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"icons\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"src\"</span>: <span class=\"string\">\"assets/icons/icon-72x72.png\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"sizes\"</span>: <span class=\"string\">\"72x72\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"image/png\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    ...</span><br><span class=\"line\">   ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Asegrate de que en la <code>start_url</code> apunte a la pgina de inicio correcta y despliega en modo produccin en un servidor seguro con <em>https</em>. Prubalo varias veces en distintos navegadores y vers las distintas experiencias de instalacin que ofrecen.</p></blockquote><h2 id=\"1-2-El-ngsw-worker-js\"><a href=\"#1-2-El-ngsw-worker-js\" class=\"headerlink\" title=\"1.2 El ngsw-worker.js\"></a>1.2 El ngsw-worker.js</h2><p>El otro gran fichero, y ms importante para los desarrolladores, es <strong>el configurador del <em>Service Worker</em></strong>. Cuando un navegador ejecuta un <em>script</em> lo hace en <em>thread</em> dedicado a la interaccin con el usuario y la manipulacin del <em>DOM</em>. Normalmente ese hilo est muy ocupado, cuando no est saturado. La solucin para agilizar los procesos est en usar ms <em>threads</em>. Presentamos el <em>worker thread</em>.</p><p>Se le llama as a los hilos creados a partir del principal y que le ayudan en tareas en segundo plano. Esos hilos tienen <strong>prohibido el acceso al DOM, ni lo escuchan ni lo manipulan</strong>. Pero a cambio estn muy liberados para realizar clculos complejos o llamadas a servicios. Se comunican con el <em>thread</em> principal a traves de un sencillo protocolo de eventos y subscripciones.</p><p>Una de las tareas para las que ms se les utiliza es para la gestin inteligente de las comunicaciones. Este fichero viene pre programado para realizar las siguientes <strong>funciones PWA de Angular</strong>:</p><ul><li>Cach de contenido esttico para funcionamiento offline</li><li>Cach de datos dinmicos para mayor velocidad</li><li>Gestin de instalaciones y versiones</li><li>Notificaciones de datos push</li></ul><p>Todo lo que hay que hacer es configurar estas funciones en un fichero, el <code>ngsw-config.json</code>, ya generado con valores por defecto. El <em>CLI</em>, durante el proceso de construccin en modo produccin, copiar y manipular los scripts y sus configuraciones. En ejecucin, el <code>ServiceModule</code> registrar el script en el navegador, se subscribir a sus eventos y ejecutar lo configurado por el programador en el <em>json</em>.</p><h1 id=\"2-Comunicaciones-y-cache\"><a href=\"#2-Comunicaciones-y-cache\" class=\"headerlink\" title=\"2 Comunicaciones y cach\"></a>2 Comunicaciones y cach</h1><p><strong>El service worker de Angular</strong> est especialmente diseado para hacerse cargo de las comunicaciones con el servidor. Digamos que se convierte en un <strong>interceptor transparente de todas las peticiones http</strong>. Tanto de los ficheros propios de la aplicacin como de las comunicaciones de datos.</p><h2 id=\"2-1-Descarga-y-actualizacion-de-la-aplicacion\"><a href=\"#2-1-Descarga-y-actualizacion-de-la-aplicacion\" class=\"headerlink\" title=\"2.1 Descarga y actualizacin de la aplicacin\"></a>2.1 Descarga y actualizacin de la aplicacin</h2><p>Una vez descargado el <em>index.html</em> con el contenido mnimo de Angular, diramos que la aplicacin se ha instalado y est lista para ejecutarse. A partir de ese momento el <em>ngsw</em> toma el control y puede pre descargar ficheros en segundo plano; de forma que <strong>cuando sean reclamados ya estn disponibles</strong> y mejoren la experiencia del usuario.</p><p>Rutinariamente el servicio se ocupar de consultar novedades en el servidor para mantener los ficheros locales actualizados. Todo ello se configura en la seccin <code>assetGroups</code> del <code>ngsw-config.json</code>.</p><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\"> <span class=\"attr\">\"assetGroups\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"app\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"updateMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"files\"</span>: [</span><br><span class=\"line\">          <span class=\"string\">\"/favicon.ico\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/index.html\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/*.css\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/common*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/main*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/ngsw*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/woker*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/polyfills*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/runtime*.js\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/fontawesome*\"</span></span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;, &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"assets\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"installMode\"</span>: <span class=\"string\">\"lazy\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"updateMode\"</span>: <span class=\"string\">\"prefetch\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"resources\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"files\"</span>: [</span><br><span class=\"line\">          <span class=\"string\">\"/assets/logo.png\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/assets/icons/**\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"/*.js\"</span></span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"2-2-Cache-inteligente-de-datos\"><a href=\"#2-2-Cache-inteligente-de-datos\" class=\"headerlink\" title=\"2.2 Cach inteligente de datos\"></a>2.2 Cach inteligente de datos</h2><p>El control de la <strong>recepcin de datos dinmicos</strong> es la otra gran tarea del <em>service worker</em>. En este caso para tener una cach que acelere la presentacin de datos o que incluso permita un funcionamiento <em>offline</em>.</p><p>Mediante <strong>dos estrategias complementarias que tratan de mantener los datos actualizados y disponibles</strong> en todo momento. En este caso configurandolo en los <code>dataGroups</code>.</p><blockquote><p>La idea del <em>cache-first</em> es tener el dato ya listo para ser usado cuanto antes. Mientras que con <em>api-first</em> se pretende tener la versin ms actual posible, y usar la ltima descargada en caso de problemas o desconexin total.</p></blockquote><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\"> dataGroups\": [</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"cache-first\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"urls\"</span>:[</span><br><span class=\"line\">        <span class=\"string\">\"https://academiabinaria.github.io/autobot/assets/data/cars.json\"</span>        </span><br><span class=\"line\">      ],</span><br><span class=\"line\">      <span class=\"attr\">\"cacheConfig\"</span>:&#123;</span><br><span class=\"line\">        <span class=\"attr\">\"strategy\"</span>:<span class=\"string\">\"performance\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"maxSize\"</span>:<span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"maxAge\"</span>:<span class=\"string\">\"1d\"</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ,&#123;</span><br><span class=\"line\">      \"name\": \"api-first\",</span><br><span class=\"line\">      \"urls\":[</span><br><span class=\"line\">        <span class=\"string\">\"https://api-base.herokuapp.com/api/priv/travels/**\"</span></span><br><span class=\"line\">      ],</span><br><span class=\"line\">      \"cacheConfig\":&#123;</span><br><span class=\"line\">        \"strategy\" : \"freshness\",</span><br><span class=\"line\">        \"maxSize\": 100,</span><br><span class=\"line\">        \"maxAge\" : \"1h\",</span><br><span class=\"line\">        \"timeout\" : \"5s\"</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"3-Servicios\"><a href=\"#3-Servicios\" class=\"headerlink\" title=\"3 Servicios\"></a>3 Servicios</h1><p>La librera <code>@angular/pwa</code> publica el mdulo <code>ServiceWorkerModule</code> que contiene la lgica de registro del <em>service worker</em> y dos servicios programables con los que interactuar desde el cdigo de tu aplicacin Angular.</p><h2 id=\"3-1-Actualizacion-con-el-SwUpdate\"><a href=\"#3-1-Actualizacion-con-el-SwUpdate\" class=\"headerlink\" title=\"3.1 Actualizacin con el SwUpdate\"></a>3.1 Actualizacin con el SwUpdate</h2><p>Cuando despliegas una nueva versin seguro que ests deseando que los usuarios disfruten cuanto antes de las mejoras o correcciones. Pero en las aplicaciones SPA resulta que <strong>la actualizacin no es tan inmediata</strong> como pudiera parecer. Al no forzar la recarga del documento en las navegaciones internas, el <code>index.html</code> puede residir sin cambios ms de lo debido. Confiar en que lo hagan el navegador o el usuario puede no ser una opcin.</p><p>La solucin PWA es usar el <code>ServiceWorker</code> para detectar nuevas versiones en el servidor. Para ello utiliza un sistema propio de <em>hashes</em> que le permite comparar la versin descargada y la disponible en el servidor.<strong> Cuando detecta un cambio emite un evento al que te puedes subscribir</strong> usando el servicio <code>SwUpdate</code>. En ese momento puedes consultar al usuario, o forzar a lo bestia la recarga ;-).</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> swUpdate: SwUpdate</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.swUpdate.isEnabled) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.swUpdate.available.subscribe(<span class=\"function\">(<span class=\"params\">event: UpdateAvailableEvent</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (confirm(<span class=\"string\">`Do you want to update?`</span>)) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">window</span>.location.reload();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h2 id=\"3-2-Notificaciones-con-el-SwPush\"><a href=\"#3-2-Notificaciones-con-el-SwPush\" class=\"headerlink\" title=\"3.2 Notificaciones con el SwPush\"></a>3.2 Notificaciones con el SwPush</h2><p>Una caractersitca de las <em>apps</em> nativas muy aprecia por los usuarios es la capacidad de mostrar <strong>mensajes recibidos va <em>push</em> por parte del servidor</strong>. Pueden ser avisos, novedades o simple marketing. Pero lo importante es que lo recibe el sistema operativo, la aplicacin no necesita estar en marcha y el mensaje se muestra de forma nativa.</p><blockquote><p>Obviamente para ello hay que involucrar cdigo de servidor y un servicio de mensajera de terceros. Pero la parte Angular del desarrollo es muy sencilla. Consite en registrar al usuario, que voluntariamente decide ser notificado, y luego escuchar los mensajes provenientes en forma de eventos. Todo ello reclamando una dependencia al servicio de notificaciones <code>constructor(private swPush: SwPush)</code>.</p></blockquote><p>Ya tienes una web que se comporta progresivamente como una App nativa, una <em>Progressive Web Application</em>. Las mejoras en rendimiento y experiencia de usuario son recompensa ms que suficiente para que le des una oportunidad a las <strong>Angular PWA</strong>.</p><p>Contina tu formacin avanzada para crear aplicaciones con mayor <a href=\"../velocidad-y-seo-con-el-ssr-de-angular-universal\">Velocidad y SEO con el SSR de Angular Universal</a> y vers como aprendes a programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Velocidad y SEO con el SSR de Angular Universal","date":"2018-10-30T11:50:27.000Z","thumbnail":"/css/images/angular-c_universal.png","_content":"\n![velocidad-y-seo-con-el-ssr-de-angular-universal](/images/tutorial-angular-c_universal.png)\n\nLas *SPA JavaScript*, muy balanceadas hacia el navegador, nacieron para **crear con tecnologa web aplicaciones de negocio**. Normalmente se desplegaban en *intranets*, o en internet para usuarios autorizados. Eran aplicaciones de uso intensivo, visita recurrente y alto rendimiento diario. El xito tecnolgico de *frameworks* como Angular las llev a ser usadas para desarrollar webs clsicas de internet y ser utilizadas por visitantes ocasionales. \n \nPero en esta situacin presentaron dos problemas para los que inicialmente no estaban preparadas. Por un lado la primera visita de un humano obligaba a la descarga completa de la aplicacin antes de poder ver nada. Y nada era lo que vean los visitantes robticos que pretendan indexar un sitio. Las soluciones a estos problemas incluyen, entre otras medidas, **una vuelta al servidor**. Lo que en Angular se conoce como **aplicacin universal**. \n\n\n<!-- more -->\n\nPartiendo del cdigo tal cmo qued en [El patrn Redux con NgRx en Angular](../el-patron-redux-con-ngrx-en-angular/). Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/AutoBot/c-universal](https://github.com/AcademiaBinaria/autobot/tree/c-universal) y en el proyecto demo [AcademiaBinaria/Astrobot](https://github.com/AcademiaBinaria/astrobot)\n\n# 1 Velocidad, primera visita y sucesivas\n\nEl reto est en mantener lo bueno de las aplicaciones *javascript* como es la transicin fluida entre pginas, la interactividad o la descarga de datos bajo demanda. Pero combinado con una mejor primera experiencia. Para ello la descarga del `index.html` tiene que venir con un documento html ya preparado con algo para mostrar y tardar lo menos posible en permitir la interaccin. \n\nEl **tiempo para el primer pintado** se ve penalizado por el tamao del *bundle* principal de Angular, pues en l reside habitualmente el componente *app* que acta de raiz. Por supuesto que utilizar la carga diferida de mdulos es una manera obligada de reducir el peso del *main*. Todas las rutas, includa la ruta base, deben ser *lazy* para retrasar la navegacin y que la descarga se produzca ms tarde. Slo el componente raiz con la *shell* de navegacin bsica debera venir en el *bundle* principal.\n\nPero ni con eso es suficiente. El usuario no ver nada hasta que Angular se descargue, reclame el *bundle main*, lo procese y renderece ese *shell*. Hay usar alguna estrategia extra para reducir el tiempo de espera y entretener al usaurio.\n\n## 1.1 Prerenderizado esttico\n\nLa ms sencilla es hacer que el `index.html`, habitualmente vaco, se rellene con un **contenido visualizable mientras el proceso principal de Angular no arranca**. En ocasiones basta con poner a mano algn mensaje o animacin que indique que estamos cargando. Pero cuanto ms se parezca esa primera visin al resultado final mejor para el usuario. As que lo propio sera que el `index.html` ya bajase con el *shell* real de la aplicacin.\n\nMontar eso a mano no es la mejor opcin. La solucin parte de **renderizar el *html* durante el proceso de *deploy***. Se trata de configurar el CLI para que ejecute la aplicacin en la mquina del desarrollador sobre una ruta predefinida; y que copie el resultado sobre el `index.html` que enviar a distribucin.\n\nEste trabajo se ha automatizado y se resuelve con un par de comandos del Angular CLI. \n\n```bash\nng g app-shell --client-project astrobot --universal-project server-astrobot\n```\n\nEl efecto de este comando se materializa especialmente con la aparicin de nuevos *targets para los builders* del CLI en el fichero [angular.json](https://github.com/AcademiaBinaria/astrobot/blob/fff2a9f2c38f4b333489063b6f812a3b614fe173/angular.json#L141). \n\nCon el comando `ng run astrobot:app-shell` podrs generar una versin especial de distribucin en al que el `index.html` ya va prerenderizado con el contenido del componente asociado a la ruta *shell*. Realmente lo que hace es ejecutar tu aplicacin sobre una ruta predefinida, tomar el *html* resultado e inyectarlo en el *body* del `index.html` que ir a distribucin.\n\nComprubalo en la ejecucin de [Astrobot](https://academiabinaria.github.io/astrobot/), viendo el cdigo fuente de la pgina descargada.\n\n> Por cierto, esta tcnica no obliga a disponer de ningn servidor web especial. Sigue funcinando con un servidor esttico de ficheros pues la prerenderizacin se produjo en la mquina del programador.\n\n## 1.2 Renderizar en el servidor con SSR\n\nClaro que esto es slo un truco para que ese primer momento de espera se reduzca y no perdamos potenciales visitantes. Si queremos algo ms, como por ejemplo que el contenido a descargar sea ms fresco, entonces necesitaremos **renderizar en el servidor**. Y para ello necesitaremos un servidor de verdad. El propuesto y mejor documentado es *Express de NodeJS*.\n\nPara empezar tendrs que instalar y registrar las librerias necesarias. Adems habr que crear el pequeo servidor *Express*, y configurar al CLI para que haga el despliegue de ambos: cliente y servidor. Este laborioso trabajo se ha automatizado y ahora mismo se resuelve casi todo con un par de instrucciones.\n\n```bash\nng add @nguniversal/express-engine\nnpm run build:ssr && npm run serve:ssr\n```\n\nEl resultado es un servidor *Node* que a cada peticin web responde enviando el `index.html`. Pero, y esta es la clave, resolver la ruta ejecutando la aplicacin Angular antes de responder al navegador. De esa forma el `index.html` ir recin generado con el contenido tal cual lo vera el usuario tras la ejecucin de Angular en local. As que **la espera al primer pintado significativo se reduce** y eso es bueno.\n\nPor si fuera poco, la principal ventaja al usar este mtodo es que al traer informacin dinmica puede usarse para indexar el contenido real del sitio. Esto es dblemente bueno, porque ahora todos **los robots indexadores podrn catalogar tu *site*** como si de una web clsica se tratase. Y los usuarios humanos podrn continuar la ejecucin en local disfrutando de las ventajas de una SPA.\n\nDe todas formas tengo que advertirte de que tomes todo esto con cautela por varios motivos:\n- Tecnologa compleja estable pero con carencias\n- Herramientas de generacin buenas pero incompletas\n- Transferencia de estado manual para evitar llamadas repetidas al API\n\nTampoco es sencilla la convivencia con librerias propias del *browser*, y menos si se trata de una PWA. Yo procuro usar un servicio que aisle al servidor de ciertas llamadas slo disponibles en el navegador, como por ejemplo todo lo relativo al *localStorage*.\n\n```typescript\nimport { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniversalService {\n  constructor(@Inject(PLATFORM_ID) private platformId: string) {}\n  public isBrowser() => isPlatformBrowser(this.platformId);\n  public isServer() => isPlatformServer(this.platformId);\n\n  public saveOnStorage(key, value) {\n    if (this.isBrowser()) {\n      sessionStorage.setItem(key, value);\n    } else {\n    }\n  }\n  public loadFromStorage(key) {\n    if (this.isBrowser()) {\n      sessionStorage.getItem(key);\n    } else {\n      return null;\n    }\n  }\n}\n```\n\n# 2 SEO en la pgina, en el navegador y en el servidor\n\nCon lo visto hasta ahora tu apliacin estar ms que cubierta en cuanto a ofrecer la mejor experiencia para usuarios al tiempo que enva contenido indexable para robots... Pero falta algo.\n\nHabitualmente las aplicaciones Angular manejan el contenido visible de una pgina web; es decir, el *body*. Para **acceder y cambiar el contenido del *header***, tan utilizado por los robots de redes sociales, hay que usar algo ms.\n\n## 2.1 Titulo y meta etiquetas de pgina\n\nComo parte del *framework* viene la librera *platform-browser* dnde tenemos un par de servicios para manipular el ttulo y cualquier etiqueta de meta informacin de la pgina.\n\nPara ello suele usarse un cdigo similar a este en el componente raiz de la aplicacion. Es muy sencillo pero te dar una idea del potencial de estos servicios:\n\n```typescript\nimport { Meta, Title } from '@angular/platform-browser';\n@Component({\n  selector: 'app-root',\n  template: `<p>Aprende a usar el framework Angular</p>`,\n})\nexport class AppComponent implements OnInit {\n  constructor(private title: Title, private meta: Meta) {}\n  ngOnInit() {\n    this.title.setTitle('My title');\n    this.meta.addTag({ property: 'og:title', content: 'My title' }, true);\n  }\n}\n```\n\nAhora ya tienes una aplicacin que satisface a usuarios y robots por igual. Contina tu formacin avanzada para crear aplicaciones Angular siguiendo la serie del [tutorial avanzado de desarrollo con Angular](../tag/Avanzado/) y vers como aprendes a programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","source":"_posts/ng-c-velocidad-y-seo-con-el-ssr-de-angular-universal.md","raw":"---\ntitle: Velocidad y SEO con el SSR de Angular Universal\npermalink: velocidad-y-seo-con-el-ssr-de-angular-universal\ndate: 2018-10-30 12:50:27\ntags:  \n- Angular\n- Angular7\n- Angular6\n- Angular2\n- Universal\n- SSR\n- Tutorial\n- Avanzado\ncategories:\n- [Tutorial, Angular] \nthumbnail: /css/images/angular-c_universal.png\n---\n\n![velocidad-y-seo-con-el-ssr-de-angular-universal](/images/tutorial-angular-c_universal.png)\n\nLas *SPA JavaScript*, muy balanceadas hacia el navegador, nacieron para **crear con tecnologa web aplicaciones de negocio**. Normalmente se desplegaban en *intranets*, o en internet para usuarios autorizados. Eran aplicaciones de uso intensivo, visita recurrente y alto rendimiento diario. El xito tecnolgico de *frameworks* como Angular las llev a ser usadas para desarrollar webs clsicas de internet y ser utilizadas por visitantes ocasionales. \n \nPero en esta situacin presentaron dos problemas para los que inicialmente no estaban preparadas. Por un lado la primera visita de un humano obligaba a la descarga completa de la aplicacin antes de poder ver nada. Y nada era lo que vean los visitantes robticos que pretendan indexar un sitio. Las soluciones a estos problemas incluyen, entre otras medidas, **una vuelta al servidor**. Lo que en Angular se conoce como **aplicacin universal**. \n\n\n<!-- more -->\n\nPartiendo del cdigo tal cmo qued en [El patrn Redux con NgRx en Angular](../el-patron-redux-con-ngrx-en-angular/). Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/AutoBot/c-universal](https://github.com/AcademiaBinaria/autobot/tree/c-universal) y en el proyecto demo [AcademiaBinaria/Astrobot](https://github.com/AcademiaBinaria/astrobot)\n\n# 1 Velocidad, primera visita y sucesivas\n\nEl reto est en mantener lo bueno de las aplicaciones *javascript* como es la transicin fluida entre pginas, la interactividad o la descarga de datos bajo demanda. Pero combinado con una mejor primera experiencia. Para ello la descarga del `index.html` tiene que venir con un documento html ya preparado con algo para mostrar y tardar lo menos posible en permitir la interaccin. \n\nEl **tiempo para el primer pintado** se ve penalizado por el tamao del *bundle* principal de Angular, pues en l reside habitualmente el componente *app* que acta de raiz. Por supuesto que utilizar la carga diferida de mdulos es una manera obligada de reducir el peso del *main*. Todas las rutas, includa la ruta base, deben ser *lazy* para retrasar la navegacin y que la descarga se produzca ms tarde. Slo el componente raiz con la *shell* de navegacin bsica debera venir en el *bundle* principal.\n\nPero ni con eso es suficiente. El usuario no ver nada hasta que Angular se descargue, reclame el *bundle main*, lo procese y renderece ese *shell*. Hay usar alguna estrategia extra para reducir el tiempo de espera y entretener al usaurio.\n\n## 1.1 Prerenderizado esttico\n\nLa ms sencilla es hacer que el `index.html`, habitualmente vaco, se rellene con un **contenido visualizable mientras el proceso principal de Angular no arranca**. En ocasiones basta con poner a mano algn mensaje o animacin que indique que estamos cargando. Pero cuanto ms se parezca esa primera visin al resultado final mejor para el usuario. As que lo propio sera que el `index.html` ya bajase con el *shell* real de la aplicacin.\n\nMontar eso a mano no es la mejor opcin. La solucin parte de **renderizar el *html* durante el proceso de *deploy***. Se trata de configurar el CLI para que ejecute la aplicacin en la mquina del desarrollador sobre una ruta predefinida; y que copie el resultado sobre el `index.html` que enviar a distribucin.\n\nEste trabajo se ha automatizado y se resuelve con un par de comandos del Angular CLI. \n\n```bash\nng g app-shell --client-project astrobot --universal-project server-astrobot\n```\n\nEl efecto de este comando se materializa especialmente con la aparicin de nuevos *targets para los builders* del CLI en el fichero [angular.json](https://github.com/AcademiaBinaria/astrobot/blob/fff2a9f2c38f4b333489063b6f812a3b614fe173/angular.json#L141). \n\nCon el comando `ng run astrobot:app-shell` podrs generar una versin especial de distribucin en al que el `index.html` ya va prerenderizado con el contenido del componente asociado a la ruta *shell*. Realmente lo que hace es ejecutar tu aplicacin sobre una ruta predefinida, tomar el *html* resultado e inyectarlo en el *body* del `index.html` que ir a distribucin.\n\nComprubalo en la ejecucin de [Astrobot](https://academiabinaria.github.io/astrobot/), viendo el cdigo fuente de la pgina descargada.\n\n> Por cierto, esta tcnica no obliga a disponer de ningn servidor web especial. Sigue funcinando con un servidor esttico de ficheros pues la prerenderizacin se produjo en la mquina del programador.\n\n## 1.2 Renderizar en el servidor con SSR\n\nClaro que esto es slo un truco para que ese primer momento de espera se reduzca y no perdamos potenciales visitantes. Si queremos algo ms, como por ejemplo que el contenido a descargar sea ms fresco, entonces necesitaremos **renderizar en el servidor**. Y para ello necesitaremos un servidor de verdad. El propuesto y mejor documentado es *Express de NodeJS*.\n\nPara empezar tendrs que instalar y registrar las librerias necesarias. Adems habr que crear el pequeo servidor *Express*, y configurar al CLI para que haga el despliegue de ambos: cliente y servidor. Este laborioso trabajo se ha automatizado y ahora mismo se resuelve casi todo con un par de instrucciones.\n\n```bash\nng add @nguniversal/express-engine\nnpm run build:ssr && npm run serve:ssr\n```\n\nEl resultado es un servidor *Node* que a cada peticin web responde enviando el `index.html`. Pero, y esta es la clave, resolver la ruta ejecutando la aplicacin Angular antes de responder al navegador. De esa forma el `index.html` ir recin generado con el contenido tal cual lo vera el usuario tras la ejecucin de Angular en local. As que **la espera al primer pintado significativo se reduce** y eso es bueno.\n\nPor si fuera poco, la principal ventaja al usar este mtodo es que al traer informacin dinmica puede usarse para indexar el contenido real del sitio. Esto es dblemente bueno, porque ahora todos **los robots indexadores podrn catalogar tu *site*** como si de una web clsica se tratase. Y los usuarios humanos podrn continuar la ejecucin en local disfrutando de las ventajas de una SPA.\n\nDe todas formas tengo que advertirte de que tomes todo esto con cautela por varios motivos:\n- Tecnologa compleja estable pero con carencias\n- Herramientas de generacin buenas pero incompletas\n- Transferencia de estado manual para evitar llamadas repetidas al API\n\nTampoco es sencilla la convivencia con librerias propias del *browser*, y menos si se trata de una PWA. Yo procuro usar un servicio que aisle al servidor de ciertas llamadas slo disponibles en el navegador, como por ejemplo todo lo relativo al *localStorage*.\n\n```typescript\nimport { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniversalService {\n  constructor(@Inject(PLATFORM_ID) private platformId: string) {}\n  public isBrowser() => isPlatformBrowser(this.platformId);\n  public isServer() => isPlatformServer(this.platformId);\n\n  public saveOnStorage(key, value) {\n    if (this.isBrowser()) {\n      sessionStorage.setItem(key, value);\n    } else {\n    }\n  }\n  public loadFromStorage(key) {\n    if (this.isBrowser()) {\n      sessionStorage.getItem(key);\n    } else {\n      return null;\n    }\n  }\n}\n```\n\n# 2 SEO en la pgina, en el navegador y en el servidor\n\nCon lo visto hasta ahora tu apliacin estar ms que cubierta en cuanto a ofrecer la mejor experiencia para usuarios al tiempo que enva contenido indexable para robots... Pero falta algo.\n\nHabitualmente las aplicaciones Angular manejan el contenido visible de una pgina web; es decir, el *body*. Para **acceder y cambiar el contenido del *header***, tan utilizado por los robots de redes sociales, hay que usar algo ms.\n\n## 2.1 Titulo y meta etiquetas de pgina\n\nComo parte del *framework* viene la librera *platform-browser* dnde tenemos un par de servicios para manipular el ttulo y cualquier etiqueta de meta informacin de la pgina.\n\nPara ello suele usarse un cdigo similar a este en el componente raiz de la aplicacion. Es muy sencillo pero te dar una idea del potencial de estos servicios:\n\n```typescript\nimport { Meta, Title } from '@angular/platform-browser';\n@Component({\n  selector: 'app-root',\n  template: `<p>Aprende a usar el framework Angular</p>`,\n})\nexport class AppComponent implements OnInit {\n  constructor(private title: Title, private meta: Meta) {}\n  ngOnInit() {\n    this.title.setTitle('My title');\n    this.meta.addTag({ property: 'og:title', content: 'My title' }, true);\n  }\n}\n```\n\nAhora ya tienes una aplicacin que satisface a usuarios y robots por igual. Contina tu formacin avanzada para crear aplicaciones Angular siguiendo la serie del [tutorial avanzado de desarrollo con Angular](../tag/Avanzado/) y vers como aprendes a programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>","slug":"velocidad-y-seo-con-el-ssr-de-angular-universal","published":1,"updated":"2018-12-03T16:37:55.771Z","_id":"cjnpve3cj0000h0s3b4e7m4xk","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-c_universal.png\" alt=\"velocidad-y-seo-con-el-ssr-de-angular-universal\"></p><p>Las <em>SPA JavaScript</em>, muy balanceadas hacia el navegador, nacieron para <strong>crear con tecnologa web aplicaciones de negocio</strong>. Normalmente se desplegaban en <em>intranets</em>, o en internet para usuarios autorizados. Eran aplicaciones de uso intensivo, visita recurrente y alto rendimiento diario. El xito tecnolgico de <em>frameworks</em> como Angular las llev a ser usadas para desarrollar webs clsicas de internet y ser utilizadas por visitantes ocasionales.</p><p>Pero en esta situacin presentaron dos problemas para los que inicialmente no estaban preparadas. Por un lado la primera visita de un humano obligaba a la descarga completa de la aplicacin antes de poder ver nada. Y nada era lo que vean los visitantes robticos que pretendan indexar un sitio. Las soluciones a estos problemas incluyen, entre otras medidas, <strong>una vuelta al servidor</strong>. Lo que en Angular se conoce como <strong>aplicacin universal</strong>.</p><a id=\"more\"></a><p>Partiendo del cdigo tal cmo qued en <a href=\"../el-patron-redux-con-ngrx-en-angular/\">El patrn Redux con NgRx en Angular</a>. Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/autobot/tree/c-universal\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/AutoBot/c-universal</a> y en el proyecto demo <a href=\"https://github.com/AcademiaBinaria/astrobot\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/Astrobot</a></p></blockquote><h1 id=\"1-Velocidad-primera-visita-y-sucesivas\"><a href=\"#1-Velocidad-primera-visita-y-sucesivas\" class=\"headerlink\" title=\"1 Velocidad, primera visita y sucesivas\"></a>1 Velocidad, primera visita y sucesivas</h1><p>El reto est en mantener lo bueno de las aplicaciones <em>javascript</em> como es la transicin fluida entre pginas, la interactividad o la descarga de datos bajo demanda. Pero combinado con una mejor primera experiencia. Para ello la descarga del <code>index.html</code> tiene que venir con un documento html ya preparado con algo para mostrar y tardar lo menos posible en permitir la interaccin.</p><p>El <strong>tiempo para el primer pintado</strong> se ve penalizado por el tamao del <em>bundle</em> principal de Angular, pues en l reside habitualmente el componente <em>app</em> que acta de raiz. Por supuesto que utilizar la carga diferida de mdulos es una manera obligada de reducir el peso del <em>main</em>. Todas las rutas, includa la ruta base, deben ser <em>lazy</em> para retrasar la navegacin y que la descarga se produzca ms tarde. Slo el componente raiz con la <em>shell</em> de navegacin bsica debera venir en el <em>bundle</em> principal.</p><p>Pero ni con eso es suficiente. El usuario no ver nada hasta que Angular se descargue, reclame el <em>bundle main</em>, lo procese y renderece ese <em>shell</em>. Hay usar alguna estrategia extra para reducir el tiempo de espera y entretener al usaurio.</p><h2 id=\"1-1-Prerenderizado-estatico\"><a href=\"#1-1-Prerenderizado-estatico\" class=\"headerlink\" title=\"1.1 Prerenderizado esttico\"></a>1.1 Prerenderizado esttico</h2><p>La ms sencilla es hacer que el <code>index.html</code>, habitualmente vaco, se rellene con un <strong>contenido visualizable mientras el proceso principal de Angular no arranca</strong>. En ocasiones basta con poner a mano algn mensaje o animacin que indique que estamos cargando. Pero cuanto ms se parezca esa primera visin al resultado final mejor para el usuario. As que lo propio sera que el <code>index.html</code> ya bajase con el <em>shell</em> real de la aplicacin.</p><p>Montar eso a mano no es la mejor opcin. La solucin parte de <strong>renderizar el <em>html</em> durante el proceso de <em>deploy</em></strong>. Se trata de configurar el CLI para que ejecute la aplicacin en la mquina del desarrollador sobre una ruta predefinida; y que copie el resultado sobre el <code>index.html</code> que enviar a distribucin.</p><p>Este trabajo se ha automatizado y se resuelve con un par de comandos del Angular CLI.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g app-shell --client-project astrobot --universal-project server-astrobot</span><br></pre></td></tr></table></figure><p>El efecto de este comando se materializa especialmente con la aparicin de nuevos <em>targets para los builders</em> del CLI en el fichero <a href=\"https://github.com/AcademiaBinaria/astrobot/blob/fff2a9f2c38f4b333489063b6f812a3b614fe173/angular.json#L141\" target=\"_blank\" rel=\"noopener\">angular.json</a>.</p><p>Con el comando <code>ng run astrobot:app-shell</code> podrs generar una versin especial de distribucin en al que el <code>index.html</code> ya va prerenderizado con el contenido del componente asociado a la ruta <em>shell</em>. Realmente lo que hace es ejecutar tu aplicacin sobre una ruta predefinida, tomar el <em>html</em> resultado e inyectarlo en el <em>body</em> del <code>index.html</code> que ir a distribucin.</p><p>Comprubalo en la ejecucin de <a href=\"https://academiabinaria.github.io/astrobot/\" target=\"_blank\" rel=\"noopener\">Astrobot</a>, viendo el cdigo fuente de la pgina descargada.</p><blockquote><p>Por cierto, esta tcnica no obliga a disponer de ningn servidor web especial. Sigue funcinando con un servidor esttico de ficheros pues la prerenderizacin se produjo en la mquina del programador.</p></blockquote><h2 id=\"1-2-Renderizar-en-el-servidor-con-SSR\"><a href=\"#1-2-Renderizar-en-el-servidor-con-SSR\" class=\"headerlink\" title=\"1.2 Renderizar en el servidor con SSR\"></a>1.2 Renderizar en el servidor con SSR</h2><p>Claro que esto es slo un truco para que ese primer momento de espera se reduzca y no perdamos potenciales visitantes. Si queremos algo ms, como por ejemplo que el contenido a descargar sea ms fresco, entonces necesitaremos <strong>renderizar en el servidor</strong>. Y para ello necesitaremos un servidor de verdad. El propuesto y mejor documentado es <em>Express de NodeJS</em>.</p><p>Para empezar tendrs que instalar y registrar las librerias necesarias. Adems habr que crear el pequeo servidor <em>Express</em>, y configurar al CLI para que haga el despliegue de ambos: cliente y servidor. Este laborioso trabajo se ha automatizado y ahora mismo se resuelve casi todo con un par de instrucciones.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng add @nguniversal/express-engine</span><br><span class=\"line\">npm run build:ssr &amp;&amp; npm run serve:ssr</span><br></pre></td></tr></table></figure><p>El resultado es un servidor <em>Node</em> que a cada peticin web responde enviando el <code>index.html</code>. Pero, y esta es la clave, resolver la ruta ejecutando la aplicacin Angular antes de responder al navegador. De esa forma el <code>index.html</code> ir recin generado con el contenido tal cual lo vera el usuario tras la ejecucin de Angular en local. As que <strong>la espera al primer pintado significativo se reduce</strong> y eso es bueno.</p><p>Por si fuera poco, la principal ventaja al usar este mtodo es que al traer informacin dinmica puede usarse para indexar el contenido real del sitio. Esto es dblemente bueno, porque ahora todos <strong>los robots indexadores podrn catalogar tu <em>site</em></strong> como si de una web clsica se tratase. Y los usuarios humanos podrn continuar la ejecucin en local disfrutando de las ventajas de una SPA.</p><p>De todas formas tengo que advertirte de que tomes todo esto con cautela por varios motivos:</p><ul><li>Tecnologa compleja estable pero con carencias</li><li>Herramientas de generacin buenas pero incompletas</li><li>Transferencia de estado manual para evitar llamadas repetidas al API</li></ul><p>Tampoco es sencilla la convivencia con librerias propias del <em>browser</em>, y menos si se trata de una PWA. Yo procuro usar un servicio que aisle al servidor de ciertas llamadas slo disponibles en el navegador, como por ejemplo todo lo relativo al <em>localStorage</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; isPlatformBrowser, isPlatformServer &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Inject, Injectable, PLATFORM_ID &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> UniversalService &#123;</span><br><span class=\"line\">  constructor(@Inject(PLATFORM_ID) private platformId: string) &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> isBrowser() =&gt; isPlatformBrowser(<span class=\"keyword\">this</span>.platformId);</span><br><span class=\"line\">  <span class=\"keyword\">public</span> isServer() =&gt; isPlatformServer(<span class=\"keyword\">this</span>.platformId);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> saveOnStorage(key, value) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.isBrowser()) &#123;</span><br><span class=\"line\">      sessionStorage.setItem(key, value);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> loadFromStorage(key) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.isBrowser()) &#123;</span><br><span class=\"line\">      sessionStorage.getItem(key);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"2-SEO-en-la-pagina-en-el-navegador-y-en-el-servidor\"><a href=\"#2-SEO-en-la-pagina-en-el-navegador-y-en-el-servidor\" class=\"headerlink\" title=\"2 SEO en la pgina, en el navegador y en el servidor\"></a>2 SEO en la pgina, en el navegador y en el servidor</h1><p>Con lo visto hasta ahora tu apliacin estar ms que cubierta en cuanto a ofrecer la mejor experiencia para usuarios al tiempo que enva contenido indexable para robots Pero falta algo.</p><p>Habitualmente las aplicaciones Angular manejan el contenido visible de una pgina web; es decir, el <em>body</em>. Para <strong>acceder y cambiar el contenido del <em>header</em></strong>, tan utilizado por los robots de redes sociales, hay que usar algo ms.</p><h2 id=\"2-1-Titulo-y-meta-etiquetas-de-pagina\"><a href=\"#2-1-Titulo-y-meta-etiquetas-de-pagina\" class=\"headerlink\" title=\"2.1 Titulo y meta etiquetas de pgina\"></a>2.1 Titulo y meta etiquetas de pgina</h2><p>Como parte del <em>framework</em> viene la librera <em>platform-browser</em> dnde tenemos un par de servicios para manipular el ttulo y cualquier etiqueta de meta informacin de la pgina.</p><p>Para ello suele usarse un cdigo similar a este en el componente raiz de la aplicacion. Es muy sencillo pero te dar una idea del potencial de estos servicios:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Meta, Title &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'app-root'</span>,</span><br><span class=\"line\">  template: <span class=\"string\">`&lt;p&gt;Aprende a usar el framework Angular&lt;/p&gt;`</span>,</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> title: Title, <span class=\"keyword\">private</span> meta: Meta</span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.title.setTitle(<span class=\"string\">'My title'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.meta.addTag(&#123; property: <span class=\"string\">'og:title'</span>, content: <span class=\"string\">'My title'</span> &#125;, <span class=\"literal\">true</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora ya tienes una aplicacin que satisface a usuarios y robots por igual. Contina tu formacin avanzada para crear aplicaciones Angular siguiendo la serie del <a href=\"../tag/Avanzado/\">tutorial avanzado de desarrollo con Angular</a> y vers como aprendes a programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-c_universal.png\" alt=\"velocidad-y-seo-con-el-ssr-de-angular-universal\"></p><p>Las <em>SPA JavaScript</em>, muy balanceadas hacia el navegador, nacieron para <strong>crear con tecnologa web aplicaciones de negocio</strong>. Normalmente se desplegaban en <em>intranets</em>, o en internet para usuarios autorizados. Eran aplicaciones de uso intensivo, visita recurrente y alto rendimiento diario. El xito tecnolgico de <em>frameworks</em> como Angular las llev a ser usadas para desarrollar webs clsicas de internet y ser utilizadas por visitantes ocasionales.</p><p>Pero en esta situacin presentaron dos problemas para los que inicialmente no estaban preparadas. Por un lado la primera visita de un humano obligaba a la descarga completa de la aplicacin antes de poder ver nada. Y nada era lo que vean los visitantes robticos que pretendan indexar un sitio. Las soluciones a estos problemas incluyen, entre otras medidas, <strong>una vuelta al servidor</strong>. Lo que en Angular se conoce como <strong>aplicacin universal</strong>.</p>","more":"<p>Partiendo del cdigo tal cmo qued en <a href=\"../el-patron-redux-con-ngrx-en-angular/\">El patrn Redux con NgRx en Angular</a>. Al finalizar tendrs una aplicacin que se instala, actualiza y comporta como una aplicacin nativa.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/autobot/tree/c-universal\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/AutoBot/c-universal</a> y en el proyecto demo <a href=\"https://github.com/AcademiaBinaria/astrobot\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/Astrobot</a></p></blockquote><h1 id=\"1-Velocidad-primera-visita-y-sucesivas\"><a href=\"#1-Velocidad-primera-visita-y-sucesivas\" class=\"headerlink\" title=\"1 Velocidad, primera visita y sucesivas\"></a>1 Velocidad, primera visita y sucesivas</h1><p>El reto est en mantener lo bueno de las aplicaciones <em>javascript</em> como es la transicin fluida entre pginas, la interactividad o la descarga de datos bajo demanda. Pero combinado con una mejor primera experiencia. Para ello la descarga del <code>index.html</code> tiene que venir con un documento html ya preparado con algo para mostrar y tardar lo menos posible en permitir la interaccin.</p><p>El <strong>tiempo para el primer pintado</strong> se ve penalizado por el tamao del <em>bundle</em> principal de Angular, pues en l reside habitualmente el componente <em>app</em> que acta de raiz. Por supuesto que utilizar la carga diferida de mdulos es una manera obligada de reducir el peso del <em>main</em>. Todas las rutas, includa la ruta base, deben ser <em>lazy</em> para retrasar la navegacin y que la descarga se produzca ms tarde. Slo el componente raiz con la <em>shell</em> de navegacin bsica debera venir en el <em>bundle</em> principal.</p><p>Pero ni con eso es suficiente. El usuario no ver nada hasta que Angular se descargue, reclame el <em>bundle main</em>, lo procese y renderece ese <em>shell</em>. Hay usar alguna estrategia extra para reducir el tiempo de espera y entretener al usaurio.</p><h2 id=\"1-1-Prerenderizado-estatico\"><a href=\"#1-1-Prerenderizado-estatico\" class=\"headerlink\" title=\"1.1 Prerenderizado esttico\"></a>1.1 Prerenderizado esttico</h2><p>La ms sencilla es hacer que el <code>index.html</code>, habitualmente vaco, se rellene con un <strong>contenido visualizable mientras el proceso principal de Angular no arranca</strong>. En ocasiones basta con poner a mano algn mensaje o animacin que indique que estamos cargando. Pero cuanto ms se parezca esa primera visin al resultado final mejor para el usuario. As que lo propio sera que el <code>index.html</code> ya bajase con el <em>shell</em> real de la aplicacin.</p><p>Montar eso a mano no es la mejor opcin. La solucin parte de <strong>renderizar el <em>html</em> durante el proceso de <em>deploy</em></strong>. Se trata de configurar el CLI para que ejecute la aplicacin en la mquina del desarrollador sobre una ruta predefinida; y que copie el resultado sobre el <code>index.html</code> que enviar a distribucin.</p><p>Este trabajo se ha automatizado y se resuelve con un par de comandos del Angular CLI.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g app-shell --client-project astrobot --universal-project server-astrobot</span><br></pre></td></tr></table></figure><p>El efecto de este comando se materializa especialmente con la aparicin de nuevos <em>targets para los builders</em> del CLI en el fichero <a href=\"https://github.com/AcademiaBinaria/astrobot/blob/fff2a9f2c38f4b333489063b6f812a3b614fe173/angular.json#L141\" target=\"_blank\" rel=\"noopener\">angular.json</a>.</p><p>Con el comando <code>ng run astrobot:app-shell</code> podrs generar una versin especial de distribucin en al que el <code>index.html</code> ya va prerenderizado con el contenido del componente asociado a la ruta <em>shell</em>. Realmente lo que hace es ejecutar tu aplicacin sobre una ruta predefinida, tomar el <em>html</em> resultado e inyectarlo en el <em>body</em> del <code>index.html</code> que ir a distribucin.</p><p>Comprubalo en la ejecucin de <a href=\"https://academiabinaria.github.io/astrobot/\" target=\"_blank\" rel=\"noopener\">Astrobot</a>, viendo el cdigo fuente de la pgina descargada.</p><blockquote><p>Por cierto, esta tcnica no obliga a disponer de ningn servidor web especial. Sigue funcinando con un servidor esttico de ficheros pues la prerenderizacin se produjo en la mquina del programador.</p></blockquote><h2 id=\"1-2-Renderizar-en-el-servidor-con-SSR\"><a href=\"#1-2-Renderizar-en-el-servidor-con-SSR\" class=\"headerlink\" title=\"1.2 Renderizar en el servidor con SSR\"></a>1.2 Renderizar en el servidor con SSR</h2><p>Claro que esto es slo un truco para que ese primer momento de espera se reduzca y no perdamos potenciales visitantes. Si queremos algo ms, como por ejemplo que el contenido a descargar sea ms fresco, entonces necesitaremos <strong>renderizar en el servidor</strong>. Y para ello necesitaremos un servidor de verdad. El propuesto y mejor documentado es <em>Express de NodeJS</em>.</p><p>Para empezar tendrs que instalar y registrar las librerias necesarias. Adems habr que crear el pequeo servidor <em>Express</em>, y configurar al CLI para que haga el despliegue de ambos: cliente y servidor. Este laborioso trabajo se ha automatizado y ahora mismo se resuelve casi todo con un par de instrucciones.</p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng add @nguniversal/express-engine</span><br><span class=\"line\">npm run build:ssr &amp;&amp; npm run serve:ssr</span><br></pre></td></tr></table></figure><p>El resultado es un servidor <em>Node</em> que a cada peticin web responde enviando el <code>index.html</code>. Pero, y esta es la clave, resolver la ruta ejecutando la aplicacin Angular antes de responder al navegador. De esa forma el <code>index.html</code> ir recin generado con el contenido tal cual lo vera el usuario tras la ejecucin de Angular en local. As que <strong>la espera al primer pintado significativo se reduce</strong> y eso es bueno.</p><p>Por si fuera poco, la principal ventaja al usar este mtodo es que al traer informacin dinmica puede usarse para indexar el contenido real del sitio. Esto es dblemente bueno, porque ahora todos <strong>los robots indexadores podrn catalogar tu <em>site</em></strong> como si de una web clsica se tratase. Y los usuarios humanos podrn continuar la ejecucin en local disfrutando de las ventajas de una SPA.</p><p>De todas formas tengo que advertirte de que tomes todo esto con cautela por varios motivos:</p><ul><li>Tecnologa compleja estable pero con carencias</li><li>Herramientas de generacin buenas pero incompletas</li><li>Transferencia de estado manual para evitar llamadas repetidas al API</li></ul><p>Tampoco es sencilla la convivencia con librerias propias del <em>browser</em>, y menos si se trata de una PWA. Yo procuro usar un servicio que aisle al servidor de ciertas llamadas slo disponibles en el navegador, como por ejemplo todo lo relativo al <em>localStorage</em>.</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; isPlatformBrowser, isPlatformServer &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/common'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; Inject, Injectable, PLATFORM_ID &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/core'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Injectable</span>(&#123;</span><br><span class=\"line\">  providedIn: <span class=\"string\">'root'</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> UniversalService &#123;</span><br><span class=\"line\">  constructor(@Inject(PLATFORM_ID) private platformId: string) &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> isBrowser() =&gt; isPlatformBrowser(<span class=\"keyword\">this</span>.platformId);</span><br><span class=\"line\">  <span class=\"keyword\">public</span> isServer() =&gt; isPlatformServer(<span class=\"keyword\">this</span>.platformId);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> saveOnStorage(key, value) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.isBrowser()) &#123;</span><br><span class=\"line\">      sessionStorage.setItem(key, value);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> loadFromStorage(key) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.isBrowser()) &#123;</span><br><span class=\"line\">      sessionStorage.getItem(key);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><h1 id=\"2-SEO-en-la-pagina-en-el-navegador-y-en-el-servidor\"><a href=\"#2-SEO-en-la-pagina-en-el-navegador-y-en-el-servidor\" class=\"headerlink\" title=\"2 SEO en la pgina, en el navegador y en el servidor\"></a>2 SEO en la pgina, en el navegador y en el servidor</h1><p>Con lo visto hasta ahora tu apliacin estar ms que cubierta en cuanto a ofrecer la mejor experiencia para usuarios al tiempo que enva contenido indexable para robots Pero falta algo.</p><p>Habitualmente las aplicaciones Angular manejan el contenido visible de una pgina web; es decir, el <em>body</em>. Para <strong>acceder y cambiar el contenido del <em>header</em></strong>, tan utilizado por los robots de redes sociales, hay que usar algo ms.</p><h2 id=\"2-1-Titulo-y-meta-etiquetas-de-pagina\"><a href=\"#2-1-Titulo-y-meta-etiquetas-de-pagina\" class=\"headerlink\" title=\"2.1 Titulo y meta etiquetas de pgina\"></a>2.1 Titulo y meta etiquetas de pgina</h2><p>Como parte del <em>framework</em> viene la librera <em>platform-browser</em> dnde tenemos un par de servicios para manipular el ttulo y cualquier etiqueta de meta informacin de la pgina.</p><p>Para ello suele usarse un cdigo similar a este en el componente raiz de la aplicacion. Es muy sencillo pero te dar una idea del potencial de estos servicios:</p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Meta, Title &#125; <span class=\"keyword\">from</span> <span class=\"string\">'@angular/platform-browser'</span>;</span><br><span class=\"line\"><span class=\"meta\">@Component</span>(&#123;</span><br><span class=\"line\">  selector: <span class=\"string\">'app-root'</span>,</span><br><span class=\"line\">  template: <span class=\"string\">`&lt;p&gt;Aprende a usar el framework Angular&lt;/p&gt;`</span>,</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> AppComponent <span class=\"keyword\">implements</span> OnInit &#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(<span class=\"params\"><span class=\"keyword\">private</span> title: Title, <span class=\"keyword\">private</span> meta: Meta</span>) &#123;&#125;</span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.title.setTitle(<span class=\"string\">'My title'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.meta.addTag(&#123; property: <span class=\"string\">'og:title'</span>, content: <span class=\"string\">'My title'</span> &#125;, <span class=\"literal\">true</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>Ahora ya tienes una aplicacin que satisface a usuarios y robots por igual. Contina tu formacin avanzada para crear aplicaciones Angular siguiendo la serie del <a href=\"../tag/Avanzado/\">tutorial avanzado de desarrollo con Angular</a> y vers como aprendes a programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"},{"title":"Material Design y CLI de Angular","date":"2019-03-14T17:59:27.000Z","thumbnail":"/css/images/angular-9_material.png","_content":"\n![Material-Design-y-CLI-de-Angular](/images/tutorial-angular-9_material.png)\n\nEl _ecosistema_ de Angular est repleto de libreras para desarrolladores profesionales. Algunas hacen uso de los **schematics**, y entre ellas destaca [Angular Material](https://material.angular.io/). Esta implementacin de la casa de la gua de diseo _Material Design_ de Google usa las capacidades de estas plantillas del CLI que permiten agregar libreras y generar cdigo.\n\nUn programador Angular debe **dominar el CLI** y debe conocer los beneficios que aporta un repositorio de multi-proyecto. Hay escenarios complejos muy adecuaos para estos _mono-repos_. Pero con el CLI es muy sencillo crear y usar nuevas aplicaciones dentro de un repositorio.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Formularios reactivos con Angular](../formularios-reactivos-con-Angular/). Al finalizar tendrs, en el mismo repositorio, una nueva aplicacin con la apariencia y usabilidad de _Material design_.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/projects/schemat/](https://github.com/AcademiaBinaria/angular-board/tree/master/projects/schemat)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n# 1. Repositorio multi-proyecto\n\nEl primer comando que se usa al empezar con angular es `ng new mi-aplicacion`. Desde ese momento tu mundo es la carpeta `/src` en la que se genera el cdigo y en la que vas a desarrollar.\n\nPero con el tiempo, ciertos proyectos crecen hay que dividirlos. O quizs surjan proyectos hermanos. Angular CLI permite disponer de ms de un proyecto compartiendo repositorio y configuracin.\n\n## 1.1 Carpetas src y projects\n\nDado un repositorio inicial, para agregar una nueva aplicacin usaremos el viejo comando _generate_. Por ejemplo voy a crear una aplicacin en la que usar las capacidades de los **schematics** y de **material**; la llamar _schemat_\n\n```console\nng g application schemat --routing\n```\n\nEsta aplicacin comparte la configuracin bsica de `angular.json` y las dependencias y scripts de `package.json`. Su cdigo especfico va en la carpeta `projects` destinada a los nuevos proyectos generados tras haber creado el repo inicial.\n\n\n## 1.2 Compilacin multi - proyecto\n\nA partir de ahora cada comando del CLI debera ir asociado a un proyecto concreto. Digo debera porque an `angular.json` puedes establecer un proyecto por defecto, que si no dices lo contrario ser el inicial.\n\nPero, es buena prctica crear scripts especficos en el `package.json` para iniciar y compilar cada proyecto.\n\n```\n\"start:schemat\": \"ng serve schemat --aot -o --port 4271\",\n\"build:prod:schemat\": \"ng build schemat --prod\",\n```\n\n# 2. Instalacin y configuracin de Material\n\nPor muchas funcionalidades que aporte un _framework_ como Angular, siempre necesitaremos echar mano de alguna **librera de terceros**. Normalmente eso implica instalarla con _npm_, importar sus mdulos en Angular y en ocasiones alguna configuracin extra.\n\nPero algunos proyectos ha adoptado la librera _schematics_ para facilitar la adopcin de sus libreras. Es el caso de **Angular Material**.\n\n## 2.1 Agregar dependencias con schematics\n\nPara agregar _Material_ un proyecto basta con usar el comando `add` del CLI.\n\n```console\nng add @angular/material --project=schemat\n```\n\nEsto instalar y anotar la dependencia de `@angular/material` y otros paquetes necesarios. Pero adems los registrar en `AppModule` y lo configurar.\n\n## 2.2 Estilos, iconos y temas bsicos\n\nEn el `index.html` se insertarn los enlaces a las hojas de estilos con fuentes e iconos. En el `styles.css` podremos importar el tema de _Material_ que nos guste.\n\n```css\n@import '~@angular/material/prebuilt-themes/indigo-pink.css';\n```\n\n# 3. Componentes bsicos\n\n**Angular Material** es mucho ms que un _css_. El proyecto te ofrece ms de una docena de componentes visuales para crear pginas web de aspecto y comportamiento profesional.\n\nPor si fuera poco, ofrece sus propias plantillas de _schematics_, de forma que podemos crear pantallas con el CLI y luego trabajar sobre ellas.\n\n## 3.1 Navegacin y layout\n\nPara empezar vamos a crear el armazn de la aplicacin, con su men y su espacio para cargar contenido. Despus pondremos la primera piedra con un dashboard en la raz de la web.\n\n### 3.1.1 Navegacin\n\nAl control que har de _shell_ le llaman `nav` por sus capacidades de navegacin. Lo usaremos para generar un componente. La novedad ser que la plantilla a partir de la cual se crea no viene por defecto y tenemos que especificarla ms.\n\n``` console\nng g @angular/material:nav shell --project=schemat\n```\nEL resultado es un componente normal, muy adecuado para sustituir todo lo pre-generado por el cli en`app.component.html`\n\n```html\n<app-shell></app-shell>\n```\n\n### 3.1.2 Dashboard\n\nPara la ruta raz eleg un cuadro de mando. De nuevo es una generacin a partir de una plantilla especfica. En este caso le he llamado `Home`.\n\n``` console\nng g @angular/material:dashboard home --project=schemat\n```\n\nAsociamos el componente a la ruta en `app-routing`\n\n```typescript\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent\n  }\n];\n```\nY le buscamos un lugar tanto al enlace como al `RouterOutlet` en el previamente generado `shell.component.html`.\n\n```html\n<a mat-list-item [routerLink]=\"['/']\">Home</a>\n<!-- Add Content Here -->\n<router-outlet></router-outlet>\n```\n\n## 3.2 Componentes bsicos\n\nPor supuesto que una librera de esta envergadura tienen soluciones para todo tipo de situaciones visuales. Para las ms comunes incluso ofrecen una plantilla en sus _schematics_ que permite generar prototipos funcionales de formularios, tablas y hasta rboles.\n\n### 3.2.1 Formularios\n\nPuedes generar un **formulario** para crear contactos y despus modificarlo o usarlo como gua para crear cualquier otro.\n\n``` console\nng g @angular/material:address-form contact --project=schemat\n```\n\n### 3.2.2 Tablas\n\nTambin nos muestran cmo hacer **listados**, con datos de ejemplo incluidos.\n\n``` console\nng g @angular/material:table elements --project=schemat\n```\nEl ejemplo permite adems ver los datos en pginas y configurar su comportamiento.\n\n```html\n<mat-paginator #paginator\n    [length]=\"dataSource.data.length\"\n    [pageIndex]=\"0\"\n    [pageSize]=\"5\"\n    [pageSizeOptions]=\"[5, 10, 15, 20]\">\n</mat-paginator>\n```\n### 3.2.3 rboles\n\nTermino con un ejemplo de algo reciente, **el rbol**. Este componente se resisti pero por peticin popular acabaron integrndolo y ahora puedes mostrar datos jerrquicos como ms les gusta a los usuarios: en forma de rboles.\n\n``` console\nng g @angular/material:tree source --project=schemat\n```\nPor supuesto que hay ms opciones, todas bien explicadas en la [documentacin de Angular Material](https://material.angular.io/components/categories). Es una solucin muy recomendable para aplicaciones de gestin, o simplemente para que se vean muy bien en Android y recuerden al _look and feel_ de todo lo que hace Google.\n\nCon este conocimiento finalizas tu [introduccin a Angular](../tag/Introduccion/).  En el tutorial avanzado aprenders ms cosas para programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","source":"_posts/ng-9-Material-Design-y-CLI-de-Angular.md","raw":"---\ntitle: Material Design y CLI de Angular\npermalink: Material-Design-y-CLI-de-Angular\ndate: 2019-03-14 18:59:27\ntags:\n- Angular\n- Angular7\n- Angular2\n- material\n- Tutorial\n- Introduccin\ncategories:\n- [Tutorial, Angular]\nthumbnail: /css/images/angular-9_material.png\n---\n\n![Material-Design-y-CLI-de-Angular](/images/tutorial-angular-9_material.png)\n\nEl _ecosistema_ de Angular est repleto de libreras para desarrolladores profesionales. Algunas hacen uso de los **schematics**, y entre ellas destaca [Angular Material](https://material.angular.io/). Esta implementacin de la casa de la gua de diseo _Material Design_ de Google usa las capacidades de estas plantillas del CLI que permiten agregar libreras y generar cdigo.\n\nUn programador Angular debe **dominar el CLI** y debe conocer los beneficios que aporta un repositorio de multi-proyecto. Hay escenarios complejos muy adecuaos para estos _mono-repos_. Pero con el CLI es muy sencillo crear y usar nuevas aplicaciones dentro de un repositorio.\n\n<!-- more -->\n\nPartiendo de la aplicacin tal cmo qued en [Formularios reactivos con Angular](../formularios-reactivos-con-Angular/). Al finalizar tendrs, en el mismo repositorio, una nueva aplicacin con la apariencia y usabilidad de _Material design_.\n\n> Cdigo asociado a este artculo en _GitHub_: [AcademiaBinaria/angular-board/projects/schemat/](https://github.com/AcademiaBinaria/angular-board/tree/master/projects/schemat)\n>\n> > Tienes una versin desplegada operativa para probar [Angular Board](https://academiabinaria.github.io/angular-board/)\n\n# 1. Repositorio multi-proyecto\n\nEl primer comando que se usa al empezar con angular es `ng new mi-aplicacion`. Desde ese momento tu mundo es la carpeta `/src` en la que se genera el cdigo y en la que vas a desarrollar.\n\nPero con el tiempo, ciertos proyectos crecen hay que dividirlos. O quizs surjan proyectos hermanos. Angular CLI permite disponer de ms de un proyecto compartiendo repositorio y configuracin.\n\n## 1.1 Carpetas src y projects\n\nDado un repositorio inicial, para agregar una nueva aplicacin usaremos el viejo comando _generate_. Por ejemplo voy a crear una aplicacin en la que usar las capacidades de los **schematics** y de **material**; la llamar _schemat_\n\n```console\nng g application schemat --routing\n```\n\nEsta aplicacin comparte la configuracin bsica de `angular.json` y las dependencias y scripts de `package.json`. Su cdigo especfico va en la carpeta `projects` destinada a los nuevos proyectos generados tras haber creado el repo inicial.\n\n\n## 1.2 Compilacin multi - proyecto\n\nA partir de ahora cada comando del CLI debera ir asociado a un proyecto concreto. Digo debera porque an `angular.json` puedes establecer un proyecto por defecto, que si no dices lo contrario ser el inicial.\n\nPero, es buena prctica crear scripts especficos en el `package.json` para iniciar y compilar cada proyecto.\n\n```\n\"start:schemat\": \"ng serve schemat --aot -o --port 4271\",\n\"build:prod:schemat\": \"ng build schemat --prod\",\n```\n\n# 2. Instalacin y configuracin de Material\n\nPor muchas funcionalidades que aporte un _framework_ como Angular, siempre necesitaremos echar mano de alguna **librera de terceros**. Normalmente eso implica instalarla con _npm_, importar sus mdulos en Angular y en ocasiones alguna configuracin extra.\n\nPero algunos proyectos ha adoptado la librera _schematics_ para facilitar la adopcin de sus libreras. Es el caso de **Angular Material**.\n\n## 2.1 Agregar dependencias con schematics\n\nPara agregar _Material_ un proyecto basta con usar el comando `add` del CLI.\n\n```console\nng add @angular/material --project=schemat\n```\n\nEsto instalar y anotar la dependencia de `@angular/material` y otros paquetes necesarios. Pero adems los registrar en `AppModule` y lo configurar.\n\n## 2.2 Estilos, iconos y temas bsicos\n\nEn el `index.html` se insertarn los enlaces a las hojas de estilos con fuentes e iconos. En el `styles.css` podremos importar el tema de _Material_ que nos guste.\n\n```css\n@import '~@angular/material/prebuilt-themes/indigo-pink.css';\n```\n\n# 3. Componentes bsicos\n\n**Angular Material** es mucho ms que un _css_. El proyecto te ofrece ms de una docena de componentes visuales para crear pginas web de aspecto y comportamiento profesional.\n\nPor si fuera poco, ofrece sus propias plantillas de _schematics_, de forma que podemos crear pantallas con el CLI y luego trabajar sobre ellas.\n\n## 3.1 Navegacin y layout\n\nPara empezar vamos a crear el armazn de la aplicacin, con su men y su espacio para cargar contenido. Despus pondremos la primera piedra con un dashboard en la raz de la web.\n\n### 3.1.1 Navegacin\n\nAl control que har de _shell_ le llaman `nav` por sus capacidades de navegacin. Lo usaremos para generar un componente. La novedad ser que la plantilla a partir de la cual se crea no viene por defecto y tenemos que especificarla ms.\n\n``` console\nng g @angular/material:nav shell --project=schemat\n```\nEL resultado es un componente normal, muy adecuado para sustituir todo lo pre-generado por el cli en`app.component.html`\n\n```html\n<app-shell></app-shell>\n```\n\n### 3.1.2 Dashboard\n\nPara la ruta raz eleg un cuadro de mando. De nuevo es una generacin a partir de una plantilla especfica. En este caso le he llamado `Home`.\n\n``` console\nng g @angular/material:dashboard home --project=schemat\n```\n\nAsociamos el componente a la ruta en `app-routing`\n\n```typescript\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomeComponent\n  }\n];\n```\nY le buscamos un lugar tanto al enlace como al `RouterOutlet` en el previamente generado `shell.component.html`.\n\n```html\n<a mat-list-item [routerLink]=\"['/']\">Home</a>\n<!-- Add Content Here -->\n<router-outlet></router-outlet>\n```\n\n## 3.2 Componentes bsicos\n\nPor supuesto que una librera de esta envergadura tienen soluciones para todo tipo de situaciones visuales. Para las ms comunes incluso ofrecen una plantilla en sus _schematics_ que permite generar prototipos funcionales de formularios, tablas y hasta rboles.\n\n### 3.2.1 Formularios\n\nPuedes generar un **formulario** para crear contactos y despus modificarlo o usarlo como gua para crear cualquier otro.\n\n``` console\nng g @angular/material:address-form contact --project=schemat\n```\n\n### 3.2.2 Tablas\n\nTambin nos muestran cmo hacer **listados**, con datos de ejemplo incluidos.\n\n``` console\nng g @angular/material:table elements --project=schemat\n```\nEl ejemplo permite adems ver los datos en pginas y configurar su comportamiento.\n\n```html\n<mat-paginator #paginator\n    [length]=\"dataSource.data.length\"\n    [pageIndex]=\"0\"\n    [pageSize]=\"5\"\n    [pageSizeOptions]=\"[5, 10, 15, 20]\">\n</mat-paginator>\n```\n### 3.2.3 rboles\n\nTermino con un ejemplo de algo reciente, **el rbol**. Este componente se resisti pero por peticin popular acabaron integrndolo y ahora puedes mostrar datos jerrquicos como ms les gusta a los usuarios: en forma de rboles.\n\n``` console\nng g @angular/material:tree source --project=schemat\n```\nPor supuesto que hay ms opciones, todas bien explicadas en la [documentacin de Angular Material](https://material.angular.io/components/categories). Es una solucin muy recomendable para aplicaciones de gestin, o simplemente para que se vean muy bien en Android y recuerden al _look and feel_ de todo lo que hace Google.\n\nCon este conocimiento finalizas tu [introduccin a Angular](../tag/Introduccion/).  En el tutorial avanzado aprenders ms cosas para programar con Angular 7.\n\n> Aprender, programar, disfrutar, repetir.\n> -- <cite>Saludos, Alberto Basalo</cite>\n","slug":"Material-Design-y-CLI-de-Angular","published":1,"updated":"2019-03-13T17:50:56.926Z","_id":"cjt76ams30000kwtmpxmblysb","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/tutorial-angular-9_material.png\" alt=\"Material-Design-y-CLI-de-Angular\"></p><p>El <em>ecosistema</em> de Angular est repleto de libreras para desarrolladores profesionales. Algunas hacen uso de los <strong>schematics</strong>, y entre ellas destaca <a href=\"https://material.angular.io/\" target=\"_blank\" rel=\"noopener\">Angular Material</a>. Esta implementacin de la casa de la gua de diseo <em>Material Design</em> de Google usa las capacidades de estas plantillas del CLI que permiten agregar libreras y generar cdigo.</p><p>Un programador Angular debe <strong>dominar el CLI</strong> y debe conocer los beneficios que aporta un repositorio de multi-proyecto. Hay escenarios complejos muy adecuaos para estos <em>mono-repos</em>. Pero con el CLI es muy sencillo crear y usar nuevas aplicaciones dentro de un repositorio.</p><a id=\"more\"></a><p>Partiendo de la aplicacin tal cmo qued en <a href=\"../formularios-reactivos-con-Angular/\">Formularios reactivos con Angular</a>. Al finalizar tendrs, en el mismo repositorio, una nueva aplicacin con la apariencia y usabilidad de <em>Material design</em>.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/projects/schemat\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/projects/schemat/</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-Repositorio-multi-proyecto\"><a href=\"#1-Repositorio-multi-proyecto\" class=\"headerlink\" title=\"1. Repositorio multi-proyecto\"></a>1. Repositorio multi-proyecto</h1><p>El primer comando que se usa al empezar con angular es <code>ng new mi-aplicacion</code>. Desde ese momento tu mundo es la carpeta <code>/src</code> en la que se genera el cdigo y en la que vas a desarrollar.</p><p>Pero con el tiempo, ciertos proyectos crecen hay que dividirlos. O quizs surjan proyectos hermanos. Angular CLI permite disponer de ms de un proyecto compartiendo repositorio y configuracin.</p><h2 id=\"1-1-Carpetas-src-y-projects\"><a href=\"#1-1-Carpetas-src-y-projects\" class=\"headerlink\" title=\"1.1 Carpetas src y projects\"></a>1.1 Carpetas src y projects</h2><p>Dado un repositorio inicial, para agregar una nueva aplicacin usaremos el viejo comando <em>generate</em>. Por ejemplo voy a crear una aplicacin en la que usar las capacidades de los <strong>schematics</strong> y de <strong>material</strong>; la llamar <em>schemat</em></p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g application schemat --routing</span><br></pre></td></tr></table></figure><p>Esta aplicacin comparte la configuracin bsica de <code>angular.json</code> y las dependencias y scripts de <code>package.json</code>. Su cdigo especfico va en la carpeta <code>projects</code> destinada a los nuevos proyectos generados tras haber creado el repo inicial.</p><h2 id=\"1-2-Compilacion-multi-proyecto\"><a href=\"#1-2-Compilacion-multi-proyecto\" class=\"headerlink\" title=\"1.2 Compilacin multi - proyecto\"></a>1.2 Compilacin multi - proyecto</h2><p>A partir de ahora cada comando del CLI debera ir asociado a un proyecto concreto. Digo debera porque an <code>angular.json</code> puedes establecer un proyecto por defecto, que si no dices lo contrario ser el inicial.</p><p>Pero, es buena prctica crear scripts especficos en el <code>package.json</code> para iniciar y compilar cada proyecto.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;start:schemat&quot;: &quot;ng serve schemat --aot -o --port 4271&quot;,</span><br><span class=\"line\">&quot;build:prod:schemat&quot;: &quot;ng build schemat --prod&quot;,</span><br></pre></td></tr></table></figure><h1 id=\"2-Instalacion-y-configuracion-de-Material\"><a href=\"#2-Instalacion-y-configuracion-de-Material\" class=\"headerlink\" title=\"2. Instalacin y configuracin de Material\"></a>2. Instalacin y configuracin de Material</h1><p>Por muchas funcionalidades que aporte un <em>framework</em> como Angular, siempre necesitaremos echar mano de alguna <strong>librera de terceros</strong>. Normalmente eso implica instalarla con <em>npm</em>, importar sus mdulos en Angular y en ocasiones alguna configuracin extra.</p><p>Pero algunos proyectos ha adoptado la librera <em>schematics</em> para facilitar la adopcin de sus libreras. Es el caso de <strong>Angular Material</strong>.</p><h2 id=\"2-1-Agregar-dependencias-con-schematics\"><a href=\"#2-1-Agregar-dependencias-con-schematics\" class=\"headerlink\" title=\"2.1 Agregar dependencias con schematics\"></a>2.1 Agregar dependencias con schematics</h2><p>Para agregar <em>Material</em> un proyecto basta con usar el comando <code>add</code> del CLI.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng add @angular/material --project=schemat</span><br></pre></td></tr></table></figure><p>Esto instalar y anotar la dependencia de <code>@angular/material</code> y otros paquetes necesarios. Pero adems los registrar en <code>AppModule</code> y lo configurar.</p><h2 id=\"2-2-Estilos-iconos-y-temas-basicos\"><a href=\"#2-2-Estilos-iconos-y-temas-basicos\" class=\"headerlink\" title=\"2.2 Estilos, iconos y temas bsicos\"></a>2.2 Estilos, iconos y temas bsicos</h2><p>En el <code>index.html</code> se insertarn los enlaces a las hojas de estilos con fuentes e iconos. En el <code>styles.css</code> podremos importar el tema de <em>Material</em> que nos guste.</p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@<span class=\"keyword\">import</span> <span class=\"string\">'~@angular/material/prebuilt-themes/indigo-pink.css'</span>;</span><br></pre></td></tr></table></figure><h1 id=\"3-Componentes-basicos\"><a href=\"#3-Componentes-basicos\" class=\"headerlink\" title=\"3. Componentes bsicos\"></a>3. Componentes bsicos</h1><p><strong>Angular Material</strong> es mucho ms que un <em>css</em>. El proyecto te ofrece ms de una docena de componentes visuales para crear pginas web de aspecto y comportamiento profesional.</p><p>Por si fuera poco, ofrece sus propias plantillas de <em>schematics</em>, de forma que podemos crear pantallas con el CLI y luego trabajar sobre ellas.</p><h2 id=\"3-1-Navegacion-y-layout\"><a href=\"#3-1-Navegacion-y-layout\" class=\"headerlink\" title=\"3.1 Navegacin y layout\"></a>3.1 Navegacin y layout</h2><p>Para empezar vamos a crear el armazn de la aplicacin, con su men y su espacio para cargar contenido. Despus pondremos la primera piedra con un dashboard en la raz de la web.</p><h3 id=\"3-1-1-Navegacion\"><a href=\"#3-1-1-Navegacion\" class=\"headerlink\" title=\"3.1.1 Navegacin\"></a>3.1.1 Navegacin</h3><p>Al control que har de <em>shell</em> le llaman <code>nav</code> por sus capacidades de navegacin. Lo usaremos para generar un componente. La novedad ser que la plantilla a partir de la cual se crea no viene por defecto y tenemos que especificarla ms.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:nav shell --project=schemat</span><br></pre></td></tr></table></figure><p>EL resultado es un componente normal, muy adecuado para sustituir todo lo pre-generado por el cli en<code>app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-shell</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-shell</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"3-1-2-Dashboard\"><a href=\"#3-1-2-Dashboard\" class=\"headerlink\" title=\"3.1.2 Dashboard\"></a>3.1.2 Dashboard</h3><p>Para la ruta raz eleg un cuadro de mando. De nuevo es una generacin a partir de una plantilla especfica. En este caso le he llamado <code>Home</code>.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:dashboard home --project=schemat</span><br></pre></td></tr></table></figure><p>Asociamos el componente a la ruta en <code>app-routing</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>Y le buscamos un lugar tanto al enlace como al <code>RouterOutlet</code> en el previamente generado <code>shell.component.html</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">mat-list-item</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/']\"</span>&gt;</span>Home<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Add Content Here --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"3-2-Componentes-basicos\"><a href=\"#3-2-Componentes-basicos\" class=\"headerlink\" title=\"3.2 Componentes bsicos\"></a>3.2 Componentes bsicos</h2><p>Por supuesto que una librera de esta envergadura tienen soluciones para todo tipo de situaciones visuales. Para las ms comunes incluso ofrecen una plantilla en sus <em>schematics</em> que permite generar prototipos funcionales de formularios, tablas y hasta rboles.</p><h3 id=\"3-2-1-Formularios\"><a href=\"#3-2-1-Formularios\" class=\"headerlink\" title=\"3.2.1 Formularios\"></a>3.2.1 Formularios</h3><p>Puedes generar un <strong>formulario</strong> para crear contactos y despus modificarlo o usarlo como gua para crear cualquier otro.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:address-form contact --project=schemat</span><br></pre></td></tr></table></figure><h3 id=\"3-2-2-Tablas\"><a href=\"#3-2-2-Tablas\" class=\"headerlink\" title=\"3.2.2 Tablas\"></a>3.2.2 Tablas</h3><p>Tambin nos muestran cmo hacer <strong>listados</strong>, con datos de ejemplo incluidos.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:table elements --project=schemat</span><br></pre></td></tr></table></figure><p>El ejemplo permite adems ver los datos en pginas y configurar su comportamiento.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mat-paginator</span> #<span class=\"attr\">paginator</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">length</span>]=<span class=\"string\">\"dataSource.data.length\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageIndex</span>]=<span class=\"string\">\"0\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageSize</span>]=<span class=\"string\">\"5\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageSizeOptions</span>]=<span class=\"string\">\"[5, 10, 15, 20]\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mat-paginator</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"3-2-3-Arboles\"><a href=\"#3-2-3-Arboles\" class=\"headerlink\" title=\"3.2.3 rboles\"></a>3.2.3 rboles</h3><p>Termino con un ejemplo de algo reciente, <strong>el rbol</strong>. Este componente se resisti pero por peticin popular acabaron integrndolo y ahora puedes mostrar datos jerrquicos como ms les gusta a los usuarios: en forma de rboles.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:tree source --project=schemat</span><br></pre></td></tr></table></figure><p>Por supuesto que hay ms opciones, todas bien explicadas en la <a href=\"https://material.angular.io/components/categories\" target=\"_blank\" rel=\"noopener\">documentacin de Angular Material</a>. Es una solucin muy recomendable para aplicaciones de gestin, o simplemente para que se vean muy bien en Android y recuerden al <em>look and feel</em> de todo lo que hace Google.</p><p>Con este conocimiento finalizas tu <a href=\"../tag/Introduccion/\">introduccin a Angular</a>. En el tutorial avanzado aprenders ms cosas para programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>","site":{"data":{}},"excerpt":"<p><img src=\"/images/tutorial-angular-9_material.png\" alt=\"Material-Design-y-CLI-de-Angular\"></p><p>El <em>ecosistema</em> de Angular est repleto de libreras para desarrolladores profesionales. Algunas hacen uso de los <strong>schematics</strong>, y entre ellas destaca <a href=\"https://material.angular.io/\" target=\"_blank\" rel=\"noopener\">Angular Material</a>. Esta implementacin de la casa de la gua de diseo <em>Material Design</em> de Google usa las capacidades de estas plantillas del CLI que permiten agregar libreras y generar cdigo.</p><p>Un programador Angular debe <strong>dominar el CLI</strong> y debe conocer los beneficios que aporta un repositorio de multi-proyecto. Hay escenarios complejos muy adecuaos para estos <em>mono-repos</em>. Pero con el CLI es muy sencillo crear y usar nuevas aplicaciones dentro de un repositorio.</p>","more":"<p>Partiendo de la aplicacin tal cmo qued en <a href=\"../formularios-reactivos-con-Angular/\">Formularios reactivos con Angular</a>. Al finalizar tendrs, en el mismo repositorio, una nueva aplicacin con la apariencia y usabilidad de <em>Material design</em>.</p><blockquote><p>Cdigo asociado a este artculo en <em>GitHub</em>: <a href=\"https://github.com/AcademiaBinaria/angular-board/tree/master/projects/schemat\" target=\"_blank\" rel=\"noopener\">AcademiaBinaria/angular-board/projects/schemat/</a></p><blockquote><p>Tienes una versin desplegada operativa para probar <a href=\"https://academiabinaria.github.io/angular-board/\" target=\"_blank\" rel=\"noopener\">Angular Board</a></p></blockquote></blockquote><h1 id=\"1-Repositorio-multi-proyecto\"><a href=\"#1-Repositorio-multi-proyecto\" class=\"headerlink\" title=\"1. Repositorio multi-proyecto\"></a>1. Repositorio multi-proyecto</h1><p>El primer comando que se usa al empezar con angular es <code>ng new mi-aplicacion</code>. Desde ese momento tu mundo es la carpeta <code>/src</code> en la que se genera el cdigo y en la que vas a desarrollar.</p><p>Pero con el tiempo, ciertos proyectos crecen hay que dividirlos. O quizs surjan proyectos hermanos. Angular CLI permite disponer de ms de un proyecto compartiendo repositorio y configuracin.</p><h2 id=\"1-1-Carpetas-src-y-projects\"><a href=\"#1-1-Carpetas-src-y-projects\" class=\"headerlink\" title=\"1.1 Carpetas src y projects\"></a>1.1 Carpetas src y projects</h2><p>Dado un repositorio inicial, para agregar una nueva aplicacin usaremos el viejo comando <em>generate</em>. Por ejemplo voy a crear una aplicacin en la que usar las capacidades de los <strong>schematics</strong> y de <strong>material</strong>; la llamar <em>schemat</em></p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g application schemat --routing</span><br></pre></td></tr></table></figure><p>Esta aplicacin comparte la configuracin bsica de <code>angular.json</code> y las dependencias y scripts de <code>package.json</code>. Su cdigo especfico va en la carpeta <code>projects</code> destinada a los nuevos proyectos generados tras haber creado el repo inicial.</p><h2 id=\"1-2-Compilacion-multi-proyecto\"><a href=\"#1-2-Compilacion-multi-proyecto\" class=\"headerlink\" title=\"1.2 Compilacin multi - proyecto\"></a>1.2 Compilacin multi - proyecto</h2><p>A partir de ahora cada comando del CLI debera ir asociado a un proyecto concreto. Digo debera porque an <code>angular.json</code> puedes establecer un proyecto por defecto, que si no dices lo contrario ser el inicial.</p><p>Pero, es buena prctica crear scripts especficos en el <code>package.json</code> para iniciar y compilar cada proyecto.</p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;start:schemat&quot;: &quot;ng serve schemat --aot -o --port 4271&quot;,</span><br><span class=\"line\">&quot;build:prod:schemat&quot;: &quot;ng build schemat --prod&quot;,</span><br></pre></td></tr></table></figure><h1 id=\"2-Instalacion-y-configuracion-de-Material\"><a href=\"#2-Instalacion-y-configuracion-de-Material\" class=\"headerlink\" title=\"2. Instalacin y configuracin de Material\"></a>2. Instalacin y configuracin de Material</h1><p>Por muchas funcionalidades que aporte un <em>framework</em> como Angular, siempre necesitaremos echar mano de alguna <strong>librera de terceros</strong>. Normalmente eso implica instalarla con <em>npm</em>, importar sus mdulos en Angular y en ocasiones alguna configuracin extra.</p><p>Pero algunos proyectos ha adoptado la librera <em>schematics</em> para facilitar la adopcin de sus libreras. Es el caso de <strong>Angular Material</strong>.</p><h2 id=\"2-1-Agregar-dependencias-con-schematics\"><a href=\"#2-1-Agregar-dependencias-con-schematics\" class=\"headerlink\" title=\"2.1 Agregar dependencias con schematics\"></a>2.1 Agregar dependencias con schematics</h2><p>Para agregar <em>Material</em> un proyecto basta con usar el comando <code>add</code> del CLI.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng add @angular/material --project=schemat</span><br></pre></td></tr></table></figure><p>Esto instalar y anotar la dependencia de <code>@angular/material</code> y otros paquetes necesarios. Pero adems los registrar en <code>AppModule</code> y lo configurar.</p><h2 id=\"2-2-Estilos-iconos-y-temas-basicos\"><a href=\"#2-2-Estilos-iconos-y-temas-basicos\" class=\"headerlink\" title=\"2.2 Estilos, iconos y temas bsicos\"></a>2.2 Estilos, iconos y temas bsicos</h2><p>En el <code>index.html</code> se insertarn los enlaces a las hojas de estilos con fuentes e iconos. En el <code>styles.css</code> podremos importar el tema de <em>Material</em> que nos guste.</p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@<span class=\"keyword\">import</span> <span class=\"string\">'~@angular/material/prebuilt-themes/indigo-pink.css'</span>;</span><br></pre></td></tr></table></figure><h1 id=\"3-Componentes-basicos\"><a href=\"#3-Componentes-basicos\" class=\"headerlink\" title=\"3. Componentes bsicos\"></a>3. Componentes bsicos</h1><p><strong>Angular Material</strong> es mucho ms que un <em>css</em>. El proyecto te ofrece ms de una docena de componentes visuales para crear pginas web de aspecto y comportamiento profesional.</p><p>Por si fuera poco, ofrece sus propias plantillas de <em>schematics</em>, de forma que podemos crear pantallas con el CLI y luego trabajar sobre ellas.</p><h2 id=\"3-1-Navegacion-y-layout\"><a href=\"#3-1-Navegacion-y-layout\" class=\"headerlink\" title=\"3.1 Navegacin y layout\"></a>3.1 Navegacin y layout</h2><p>Para empezar vamos a crear el armazn de la aplicacin, con su men y su espacio para cargar contenido. Despus pondremos la primera piedra con un dashboard en la raz de la web.</p><h3 id=\"3-1-1-Navegacion\"><a href=\"#3-1-1-Navegacion\" class=\"headerlink\" title=\"3.1.1 Navegacin\"></a>3.1.1 Navegacin</h3><p>Al control que har de <em>shell</em> le llaman <code>nav</code> por sus capacidades de navegacin. Lo usaremos para generar un componente. La novedad ser que la plantilla a partir de la cual se crea no viene por defecto y tenemos que especificarla ms.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:nav shell --project=schemat</span><br></pre></td></tr></table></figure><p>EL resultado es un componente normal, muy adecuado para sustituir todo lo pre-generado por el cli en<code>app.component.html</code></p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">app-shell</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">app-shell</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"3-1-2-Dashboard\"><a href=\"#3-1-2-Dashboard\" class=\"headerlink\" title=\"3.1.2 Dashboard\"></a>3.1.2 Dashboard</h3><p>Para la ruta raz eleg un cuadro de mando. De nuevo es una generacin a partir de una plantilla especfica. En este caso le he llamado <code>Home</code>.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:dashboard home --project=schemat</span><br></pre></td></tr></table></figure><p>Asociamos el componente a la ruta en <code>app-routing</code></p><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> routes: Routes = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    path: <span class=\"string\">''</span>,</span><br><span class=\"line\">    component: HomeComponent</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure><p>Y le buscamos un lugar tanto al enlace como al <code>RouterOutlet</code> en el previamente generado <code>shell.component.html</code>.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">mat-list-item</span> [<span class=\"attr\">routerLink</span>]=<span class=\"string\">\"['/']\"</span>&gt;</span>Home<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Add Content Here --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-outlet</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id=\"3-2-Componentes-basicos\"><a href=\"#3-2-Componentes-basicos\" class=\"headerlink\" title=\"3.2 Componentes bsicos\"></a>3.2 Componentes bsicos</h2><p>Por supuesto que una librera de esta envergadura tienen soluciones para todo tipo de situaciones visuales. Para las ms comunes incluso ofrecen una plantilla en sus <em>schematics</em> que permite generar prototipos funcionales de formularios, tablas y hasta rboles.</p><h3 id=\"3-2-1-Formularios\"><a href=\"#3-2-1-Formularios\" class=\"headerlink\" title=\"3.2.1 Formularios\"></a>3.2.1 Formularios</h3><p>Puedes generar un <strong>formulario</strong> para crear contactos y despus modificarlo o usarlo como gua para crear cualquier otro.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:address-form contact --project=schemat</span><br></pre></td></tr></table></figure><h3 id=\"3-2-2-Tablas\"><a href=\"#3-2-2-Tablas\" class=\"headerlink\" title=\"3.2.2 Tablas\"></a>3.2.2 Tablas</h3><p>Tambin nos muestran cmo hacer <strong>listados</strong>, con datos de ejemplo incluidos.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:table elements --project=schemat</span><br></pre></td></tr></table></figure><p>El ejemplo permite adems ver los datos en pginas y configurar su comportamiento.</p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mat-paginator</span> #<span class=\"attr\">paginator</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">length</span>]=<span class=\"string\">\"dataSource.data.length\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageIndex</span>]=<span class=\"string\">\"0\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageSize</span>]=<span class=\"string\">\"5\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    [<span class=\"attr\">pageSizeOptions</span>]=<span class=\"string\">\"[5, 10, 15, 20]\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mat-paginator</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id=\"3-2-3-Arboles\"><a href=\"#3-2-3-Arboles\" class=\"headerlink\" title=\"3.2.3 rboles\"></a>3.2.3 rboles</h3><p>Termino con un ejemplo de algo reciente, <strong>el rbol</strong>. Este componente se resisti pero por peticin popular acabaron integrndolo y ahora puedes mostrar datos jerrquicos como ms les gusta a los usuarios: en forma de rboles.</p><figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ng g @angular/material:tree source --project=schemat</span><br></pre></td></tr></table></figure><p>Por supuesto que hay ms opciones, todas bien explicadas en la <a href=\"https://material.angular.io/components/categories\" target=\"_blank\" rel=\"noopener\">documentacin de Angular Material</a>. Es una solucin muy recomendable para aplicaciones de gestin, o simplemente para que se vean muy bien en Android y recuerden al <em>look and feel</em> de todo lo que hace Google.</p><p>Con este conocimiento finalizas tu <a href=\"../tag/Introduccion/\">introduccin a Angular</a>. En el tutorial avanzado aprenders ms cosas para programar con Angular 7.</p><blockquote><p>Aprender, programar, disfrutar, repetir.<br> <cite>Saludos, Alberto Basalo</cite></p></blockquote>"}],"PostAsset":[],"PostCategory":[{"post_id":"cjbrwpvf6000aiwd3funll6pp","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvg1000kiwd3ncix4g8w"},{"post_id":"cjbrwpvdb0002iwd3s3hm2ey2","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvg1000piwd3c5k3f06j"},{"post_id":"cjbrwpvf6000ciwd3yh7x0xku","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvg1000siwd399iticgz"},{"post_id":"cjbrwpvfm000hiwd3kjqdf4ac","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvgh000viwd31it5or35"},{"post_id":"cjbrwpvee0004iwd33m6qo4qf","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvgh000yiwd3zis908bp"},{"post_id":"cjbrwpvg1000jiwd31vpe6o8t","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvgx0011iwd3rquxanwz"},{"post_id":"cjbrwpvg1000oiwd3iw0obsh1","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvhc0013iwd3wh15xj9l"},{"post_id":"cjbrwpveq0008iwd321bv9dux","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvhc0016iwd30dznaoev"},{"post_id":"cjbrwpvg1000riwd3xv00rnbm","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvhs001aiwd3y2m3uz0q"},{"post_id":"cjbrwpvgh000uiwd3oi8jqncw","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvhs001eiwd39etoi0n8"},{"post_id":"cjbrwpvgh000xiwd30fgjttck","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvi7001iiwd3r4gt3g62"},{"post_id":"cjbrwpvgx0010iwd3wg1uhspm","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvi7001miwd3ijyzzz9a"},{"post_id":"cjbrwpvhc0015iwd3isv7fz8o","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvi7001oiwd3hlzqwu9x"},{"post_id":"cjbrwpvhs001diwd3sjrli39w","category_id":"cjbrwpvhc0018iwd35xk9dihj","_id":"cjbrwpvi7001qiwd3h242snl9"},{"post_id":"cjbrwpvgx0012iwd36zjlkr34","category_id":"cjbrwpvhc0018iwd35xk9dihj","_id":"cjbrwpvin001uiwd37h2iby6e"},{"post_id":"cjbrwpvhs001giwd3e9p6o803","category_id":"cjbrwpvhc0018iwd35xk9dihj","_id":"cjbrwpvin001wiwd3u6hjabjo"},{"post_id":"cjbrwpvi7001liwd3mxs167tt","category_id":"cjbrwpvel0005iwd3drbh7j0w","_id":"cjbrwpvj30020iwd3y1qr8n5b"},{"post_id":"cjbrwpvhs0019iwd3xtobv2q2","category_id":"cjbrwpvhc0018iwd35xk9dihj","_id":"cjbrwpvj30024iwd3zdpiqgrh"},{"post_id":"cjbrwpvin001viwd3a5fd3f8a","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjbrwpvke002miwd3ti987hnh"},{"post_id":"cjbrwpvin001viwd3a5fd3f8a","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjbrwpvke002piwd37gzqbc2z"},{"post_id":"cjbrwpvi7001niwd3srhzdu8j","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjbrwpvke002siwd34fghtdc1"},{"post_id":"cjbrwpvi7001niwd3srhzdu8j","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjbrwpvkt002uiwd3jmhqihdl"},{"post_id":"cjbrwpvin001ziwd3551c6s4a","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjbrwpvkt002xiwd3ex2t5klp"},{"post_id":"cjbrwpvin001ziwd3551c6s4a","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjbrwpvkt0030iwd3fp8apa94"},{"post_id":"cjbrwpvj30023iwd3eb4hu4n0","category_id":"cjbrwpvke002riwd3gys3x6vg","_id":"cjbrwpvl90033iwd37f3nceeb"},{"post_id":"cjbrwpvi7001piwd3nglxcwnn","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjbrwpvl90038iwd33o7x5cst"},{"post_id":"cjbrwpvi7001piwd3nglxcwnn","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjbrwpvl9003aiwd3qnwx3end"},{"post_id":"cjbrwpvji0027iwd3esyp8axx","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjbrwpvl9003diwd3vg7e6bau"},{"post_id":"cjbrwpvji0027iwd3esyp8axx","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjbrwpvl9003giwd3wd8c028d"},{"post_id":"cjbrwpvji0029iwd3b7w987c4","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjbrwpvlo003jiwd3zr497nk3"},{"post_id":"cjbrwpvji0029iwd3b7w987c4","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjbrwpvlo003miwd3iun0zbj2"},{"post_id":"cjbrwpvi7001siwd3xpxrryku","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjbrwpvlo003piwd3e70k6zbv"},{"post_id":"cjbrwpvi7001siwd3xpxrryku","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjbrwpvlo003qiwd3sz2by5b7"},{"post_id":"cjbrwpvjy002eiwd3kujb9qqx","category_id":"cjbrwpvke002riwd3gys3x6vg","_id":"cjbrwpvm4003wiwd341c1652q"},{"post_id":"cjmkd6hs90000rks32qduqzm3","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjmkd6hss0002rks3mwk1v9ga"},{"post_id":"cjmkd6hs90000rks32qduqzm3","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjmkd6hsv0004rks3wmobjbba"},{"post_id":"cjmup7oul0000ags3jfqqyx7e","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjmup7ova0003ags3h6sw0x78"},{"post_id":"cjmup7oul0000ags3jfqqyx7e","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjmup7ovb0004ags373unq7po"},{"post_id":"cjn310lsu0000rks3jcut76z6","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjn310lt40004rks3ez8tfprp"},{"post_id":"cjn310lsu0000rks3jcut76z6","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjn310lt50006rks3032t8lve"},{"post_id":"cjnpve3cj0000h0s3b4e7m4xk","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjnpve3ee0003h0s3lrl6qzhq"},{"post_id":"cjnpve3cj0000h0s3b4e7m4xk","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjnpve3ef0004h0s35eqfacp3"},{"post_id":"cjbrwpvji002biwd3ak7z4jrq","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjqz21s9u0003t8s3ok6hmitr"},{"post_id":"cjbrwpvji002biwd3ak7z4jrq","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjqz21s9v0005t8s38wewclwe"},{"post_id":"cjgqbs5xg00006gs3o2wn0xbp","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjt4n3jzt00033cs388t4fnlg"},{"post_id":"cjgqbs5xg00006gs3o2wn0xbp","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjt4n3jzt00053cs3qtw0ncpn"},{"post_id":"cjt76ams30000kwtmpxmblysb","category_id":"cjbrwpvin001tiwd3d4s3d3xu","_id":"cjt76amsc0002kwtmbabmr2aj"},{"post_id":"cjt76ams30000kwtmpxmblysb","category_id":"cjbrwpvjy002diwd3equpwx2y","_id":"cjt76amsc0004kwtm9kl7k19z"}],"PostTag":[{"post_id":"cjbrwpvdb0002iwd3s3hm2ey2","tag_id":"cjbrwpveq0006iwd3mx0r73ql","_id":"cjbrwpvfm000fiwd3181lvqks"},{"post_id":"cjbrwpvee0004iwd33m6qo4qf","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvg1000qiwd346mzj5ht"},{"post_id":"cjbrwpvg1000riwd3xv00rnbm","tag_id":"cjbrwpveq0006iwd3mx0r73ql","_id":"cjbrwpvgh000wiwd3g0a44gke"},{"post_id":"cjbrwpveq0008iwd321bv9dux","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvhc0017iwd384ptnz98"},{"post_id":"cjbrwpveq0008iwd321bv9dux","tag_id":"cjbrwpvgh000tiwd3v94qv1ae","_id":"cjbrwpvhs001biwd3xup26vk1"},{"post_id":"cjbrwpveq0008iwd321bv9dux","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvhs001fiwd3ekinwdcz"},{"post_id":"cjbrwpvf6000aiwd3funll6pp","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvi7001jiwd33viufola"},{"post_id":"cjbrwpvf6000ciwd3yh7x0xku","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvin001yiwd3a5801mwq"},{"post_id":"cjbrwpvf6000ciwd3yh7x0xku","tag_id":"cjbrwpvi7001kiwd37pepzyjm","_id":"cjbrwpvj30022iwd3mkth6mam"},{"post_id":"cjbrwpvf6000ciwd3yh7x0xku","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvji0026iwd3sxzk8ilp"},{"post_id":"cjbrwpvfm000hiwd3kjqdf4ac","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvjy002ciwd3jhfi3jmz"},{"post_id":"cjbrwpvfm000hiwd3kjqdf4ac","tag_id":"cjbrwpvin001xiwd3qzmu2hgu","_id":"cjbrwpvjy002fiwd3r3i49q2q"},{"post_id":"cjbrwpvfm000hiwd3kjqdf4ac","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvjy002hiwd3jf15by2i"},{"post_id":"cjbrwpvg1000jiwd31vpe6o8t","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvjy002kiwd3m8cf4xi2"},{"post_id":"cjbrwpvg1000jiwd31vpe6o8t","tag_id":"cjbrwpvji002aiwd3hht5b7pc","_id":"cjbrwpvke002niwd3cfoilsjs"},{"post_id":"cjbrwpvg1000jiwd31vpe6o8t","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvke002qiwd3uidc6ten"},{"post_id":"cjbrwpvg1000oiwd3iw0obsh1","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvkt002viwd3a7fumkzj"},{"post_id":"cjbrwpvg1000oiwd3iw0obsh1","tag_id":"cjbrwpvin001xiwd3qzmu2hgu","_id":"cjbrwpvkt002yiwd3eas8q21h"},{"post_id":"cjbrwpvg1000oiwd3iw0obsh1","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvkt0031iwd3dqke61or"},{"post_id":"cjbrwpvgh000uiwd3oi8jqncw","tag_id":"cjbrwpvke002tiwd3671s8s4y","_id":"cjbrwpvl90034iwd3uu2t9xp6"},{"post_id":"cjbrwpvgh000xiwd30fgjttck","tag_id":"cjbrwpvkt002ziwd3mp9aadnw","_id":"cjbrwpvl90037iwd3d9v5kr66"},{"post_id":"cjbrwpvgx0010iwd3wg1uhspm","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvl9003ciwd3gtdmzt34"},{"post_id":"cjbrwpvgx0010iwd3wg1uhspm","tag_id":"cjbrwpvji002aiwd3hht5b7pc","_id":"cjbrwpvl9003eiwd3851c3eve"},{"post_id":"cjbrwpvgx0010iwd3wg1uhspm","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvlo003iiwd3ob5elfep"},{"post_id":"cjbrwpvgx0012iwd36zjlkr34","tag_id":"cjbrwpvl90039iwd3zsvjskmp","_id":"cjbrwpvlo003kiwd3b5iejmrt"},{"post_id":"cjbrwpvhc0015iwd3isv7fz8o","tag_id":"cjbrwpvkt002ziwd3mp9aadnw","_id":"cjbrwpvlo003oiwd3tyim5lxu"},{"post_id":"cjbrwpvhs0019iwd3xtobv2q2","tag_id":"cjbrwpvlo003liwd3bl4ttnek","_id":"cjbrwpvm4003viwd3meueqky7"},{"post_id":"cjbrwpvhs0019iwd3xtobv2q2","tag_id":"cjbrwpvl90039iwd3zsvjskmp","_id":"cjbrwpvm4003xiwd39nrdu9k3"},{"post_id":"cjbrwpvhs001diwd3sjrli39w","tag_id":"cjbrwpvm4003uiwd31niwz9d0","_id":"cjbrwpvm40041iwd3kmlbrre6"},{"post_id":"cjbrwpvhs001diwd3sjrli39w","tag_id":"cjbrwpvkt002ziwd3mp9aadnw","_id":"cjbrwpvm40042iwd3lfwteh4p"},{"post_id":"cjbrwpvhs001diwd3sjrli39w","tag_id":"cjbrwpvke002tiwd3671s8s4y","_id":"cjbrwpvm40044iwd396gf3j3i"},{"post_id":"cjbrwpvhs001giwd3e9p6o803","tag_id":"cjbrwpvm40040iwd3ek0w7quz","_id":"cjbrwpvm40045iwd38nv5ix6k"},{"post_id":"cjbrwpvi7001liwd3mxs167tt","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvmk0047iwd3kk1re80i"},{"post_id":"cjbrwpvi7001liwd3mxs167tt","tag_id":"cjbrwpvm40043iwd3lq55emn8","_id":"cjbrwpvmk0048iwd3bojxyvds"},{"post_id":"cjbrwpvi7001liwd3mxs167tt","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvmk004aiwd3p90mpf5l"},{"post_id":"cjbrwpvi7001niwd3srhzdu8j","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjbrwpvmk004eiwd3a49kjkop"},{"post_id":"cjbrwpvi7001niwd3srhzdu8j","tag_id":"cjbrwpvin001xiwd3qzmu2hgu","_id":"cjbrwpvmz004iiwd3w4671emn"},{"post_id":"cjbrwpvi7001niwd3srhzdu8j","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvmz004kiwd34r5raa27"},{"post_id":"cjbrwpvi7001niwd3srhzdu8j","tag_id":"cjbrwpvmk004ciwd3um2auy0r","_id":"cjbrwpvmz004liwd3zbjq39th"},{"post_id":"cjbrwpvi7001piwd3nglxcwnn","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjbrwpvmz004niwd32h68p4fl"},{"post_id":"cjbrwpvi7001piwd3nglxcwnn","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvmz004qiwd3y7cag4hr"},{"post_id":"cjbrwpvi7001piwd3nglxcwnn","tag_id":"cjbrwpvgh000tiwd3v94qv1ae","_id":"cjbrwpvmz004riwd3leged8uj"},{"post_id":"cjbrwpvi7001piwd3nglxcwnn","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvmz004tiwd3fdutg7fz"},{"post_id":"cjbrwpvi7001piwd3nglxcwnn","tag_id":"cjbrwpvmk004ciwd3um2auy0r","_id":"cjbrwpvmz004uiwd3n826xqa2"},{"post_id":"cjbrwpvi7001siwd3xpxrryku","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjbrwpvmz004xiwd34qr5yr63"},{"post_id":"cjbrwpvi7001siwd3xpxrryku","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvnf0050iwd3ve4hyty4"},{"post_id":"cjbrwpvi7001siwd3xpxrryku","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvnf0053iwd329qbq56a"},{"post_id":"cjbrwpvi7001siwd3xpxrryku","tag_id":"cjbrwpvmk004ciwd3um2auy0r","_id":"cjbrwpvnf0054iwd3920s2cu0"},{"post_id":"cjbrwpvin001viwd3a5fd3f8a","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjbrwpvnf0057iwd3bgap5i2y"},{"post_id":"cjbrwpvin001viwd3a5fd3f8a","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvnv005diwd3smol2q80"},{"post_id":"cjbrwpvin001viwd3a5fd3f8a","tag_id":"cjbrwpvmk004ciwd3um2auy0r","_id":"cjbrwpvnv005eiwd3dno3b2xj"},{"post_id":"cjbrwpvin001ziwd3551c6s4a","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjbrwpvnv005giwd3r4t4byyl"},{"post_id":"cjbrwpvin001ziwd3551c6s4a","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjbrwpvnv005jiwd3wlqwvbjc"},{"post_id":"cjbrwpvin001ziwd3551c6s4a","tag_id":"cjbrwpvi7001kiwd37pepzyjm","_id":"cjbrwpvnv005kiwd32wfi8lgx"},{"post_id":"cjbrwpvin001ziwd3551c6s4a","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvnv005miwd3s1lvyezx"},{"post_id":"cjbrwpvin001ziwd3551c6s4a","tag_id":"cjbrwpvmk004ciwd3um2auy0r","_id":"cjbrwpvnv005niwd3mmrufjxc"},{"post_id":"cjbrwpvj30023iwd3eb4hu4n0","tag_id":"cjbrwpvl90039iwd3zsvjskmp","_id":"cjbrwpvoa005piwd312w78419"},{"post_id":"cjbrwpvji0027iwd3esyp8axx","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjbrwpvoa005siwd3n7g59avd"},{"post_id":"cjbrwpvji0027iwd3esyp8axx","tag_id":"cjbrwpvji002aiwd3hht5b7pc","_id":"cjbrwpvoa005wiwd3lwpc3dnh"},{"post_id":"cjbrwpvji0027iwd3esyp8axx","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvoa005yiwd39wtquete"},{"post_id":"cjbrwpvji0027iwd3esyp8axx","tag_id":"cjbrwpvmk004ciwd3um2auy0r","_id":"cjbrwpvoa005ziwd3h4zgswxi"},{"post_id":"cjbrwpvji0029iwd3b7w987c4","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjbrwpvoa0062iwd3wzzcqzet"},{"post_id":"cjbrwpvji0029iwd3b7w987c4","tag_id":"cjbrwpvm40043iwd3lq55emn8","_id":"cjbrwpvos0066iwd3qhjenjtc"},{"post_id":"cjbrwpvji0029iwd3b7w987c4","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjbrwpvow0068iwd32vg78aya"},{"post_id":"cjbrwpvji0029iwd3b7w987c4","tag_id":"cjbrwpvmk004ciwd3um2auy0r","_id":"cjbrwpvow0069iwd3rwyt16vs"},{"post_id":"cjbrwpvjy002eiwd3kujb9qqx","tag_id":"cjbrwpvkt002ziwd3mp9aadnw","_id":"cjbrwpvp4006hiwd39i98qnfi"},{"post_id":"cjbrwpvji0029iwd3b7w987c4","tag_id":"cjl7utvls0000lgs32ph7r4uf","_id":"cjl7utvm80001lgs3nsk6ynqk"},{"post_id":"cjbrwpvin001viwd3a5fd3f8a","tag_id":"cjlqqecc80000iws3armzxwx0","_id":"cjlqqeccs0001iws38xyhffkj"},{"post_id":"cjbrwpvin001viwd3a5fd3f8a","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjlqsmzfx000284s3ejzpg4eb"},{"post_id":"cjbrwpvi7001niwd3srhzdu8j","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjlqsmzgd000584s3qbdrwwpn"},{"post_id":"cjbrwpvji0027iwd3esyp8axx","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjlqsmzgd000b84s3kq6npxo9"},{"post_id":"cjbrwpvji0029iwd3b7w987c4","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjlqsmzgd000e84s3li5epze5"},{"post_id":"cjbrwpvi7001piwd3nglxcwnn","tag_id":"cjlw6ugnv0000zws3apbpvacv","_id":"cjlw6ugo40001zws3akaruprh"},{"post_id":"cjbrwpvin001ziwd3551c6s4a","tag_id":"cjm1sd6de0000ogs3co52ib1p","_id":"cjm1sd6du0001ogs3xp2472xx"},{"post_id":"cjbrwpvi7001siwd3xpxrryku","tag_id":"cjbrwpvi7001kiwd37pepzyjm","_id":"cjm8w2tjl0000b4s34sjkff48"},{"post_id":"cjbrwpvi7001siwd3xpxrryku","tag_id":"cjm1sd6de0000ogs3co52ib1p","_id":"cjm8w2tjl0001b4s3zrx4wlcz"},{"post_id":"cjbrwpvin001ziwd3551c6s4a","tag_id":"cjm903ao6000084s3lmp87cky","_id":"cjm903ao9000184s3h6dkn9o4"},{"post_id":"cjmkd6hs90000rks32qduqzm3","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjmkd6hsv0003rks3dnxp05v6"},{"post_id":"cjmkd6hs90000rks32qduqzm3","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjmkd6hsv0005rks3beaje607"},{"post_id":"cjmkd6hs90000rks32qduqzm3","tag_id":"cjgqbs5xv00016gs3o8sy742m","_id":"cjmkd6hsx0006rks3c1cfkfbt"},{"post_id":"cjmkd6hs90000rks32qduqzm3","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjmkd6hsx0008rks3545vsbfe"},{"post_id":"cjmkd6hs90000rks32qduqzm3","tag_id":"cjmkd6hsi0001rks3zeughe6i","_id":"cjmkd6hsy000brks3kihvk0zx"},{"post_id":"cjmkd6hs90000rks32qduqzm3","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjmkd6hsy000crks3rxz0na4f"},{"post_id":"cjmkd6hs90000rks32qduqzm3","tag_id":"cjmajgd990000sks3fot53xan","_id":"cjmkd6hsy000drks3baf2h8i6"},{"post_id":"cjmup7oul0000ags3jfqqyx7e","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjmup7ovf0005ags32ryjg70r"},{"post_id":"cjmup7oul0000ags3jfqqyx7e","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjmup7ovg0006ags3a9dxk8xv"},{"post_id":"cjmup7oul0000ags3jfqqyx7e","tag_id":"cjgqbs5xv00016gs3o8sy742m","_id":"cjmup7ovg0007ags3gwc5uii7"},{"post_id":"cjmup7oul0000ags3jfqqyx7e","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjmup7ovh0009ags3ki69n6te"},{"post_id":"cjmup7oul0000ags3jfqqyx7e","tag_id":"cjmup7ouw0001ags3yr5qdluz","_id":"cjmup7ovh000aags366f14xey"},{"post_id":"cjmup7oul0000ags3jfqqyx7e","tag_id":"cjmup7ov90002ags36zfa68e1","_id":"cjmup7ovh000bags3k23cth97"},{"post_id":"cjmup7oul0000ags3jfqqyx7e","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjmup7ovi000cags3pwstsh0d"},{"post_id":"cjmup7oul0000ags3jfqqyx7e","tag_id":"cjmajgd990000sks3fot53xan","_id":"cjmup7ovi000dags3mr6lg9e6"},{"post_id":"cjn310lsu0000rks3jcut76z6","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjn310lt30001rks3npf168cg"},{"post_id":"cjn310lsu0000rks3jcut76z6","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjn310lt30002rks30cofsshj"},{"post_id":"cjn310lsu0000rks3jcut76z6","tag_id":"cjgqbs5xv00016gs3o8sy742m","_id":"cjn310lt40003rks3zl7xufcq"},{"post_id":"cjn310lsu0000rks3jcut76z6","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjn310lt50007rks390dbodxv"},{"post_id":"cjn310lsu0000rks3jcut76z6","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjn310lt7000arks3riyvsimg"},{"post_id":"cjn310lsu0000rks3jcut76z6","tag_id":"cjmajgd990000sks3fot53xan","_id":"cjn310lt7000brks3c36tkq10"},{"post_id":"cjn310lsu0000rks3jcut76z6","tag_id":"cjn31401x000crks3d1ad609n","_id":"cjn314020000drks3dpnpoeac"},{"post_id":"cjnpve3cj0000h0s3b4e7m4xk","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjnpve3en0005h0s3s4rpq0x5"},{"post_id":"cjnpve3cj0000h0s3b4e7m4xk","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjnpve3eo0006h0s3lh8egb4o"},{"post_id":"cjnpve3cj0000h0s3b4e7m4xk","tag_id":"cjgqbs5xv00016gs3o8sy742m","_id":"cjnpve3eo0007h0s3cfyrxqwn"},{"post_id":"cjnpve3cj0000h0s3b4e7m4xk","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjnpve3ep0009h0s3tdpitx1j"},{"post_id":"cjnpve3cj0000h0s3b4e7m4xk","tag_id":"cjnpve3do0001h0s36p65dyfe","_id":"cjnpve3ep000ah0s399snvq5b"},{"post_id":"cjnpve3cj0000h0s3b4e7m4xk","tag_id":"cjnpve3ed0002h0s32ktcij83","_id":"cjnpve3eq000bh0s3kqgttqf0"},{"post_id":"cjnpve3cj0000h0s3b4e7m4xk","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjnpve3eq000ch0s32gxeum0d"},{"post_id":"cjnpve3cj0000h0s3b4e7m4xk","tag_id":"cjmajgd990000sks3fot53xan","_id":"cjnpve3er000dh0s3i1xkwlnm"},{"post_id":"cjbrwpvi7001niwd3srhzdu8j","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjp8jn3g60000dgs3m533mqzp"},{"post_id":"cjbrwpvin001viwd3a5fd3f8a","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjp8jn3g80001dgs3exy3j9gs"},{"post_id":"cjbrwpvi7001piwd3nglxcwnn","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjp8jn3gc0002dgs3u4u59u9p"},{"post_id":"cjbrwpvin001ziwd3551c6s4a","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjp8jn3gk0003dgs3q1qf4w9i"},{"post_id":"cjbrwpvi7001siwd3xpxrryku","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjp8jn3go0004dgs3ogvsuqb9"},{"post_id":"cjbrwpvji0027iwd3esyp8axx","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjp8jn3h10005dgs30fz6l1sv"},{"post_id":"cjbrwpvji0029iwd3b7w987c4","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjp8jn3hu0007dgs3avvtn39h"},{"post_id":"cjbrwpvji002biwd3ak7z4jrq","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjqz21s9s0000t8s3v3szlc1l"},{"post_id":"cjbrwpvji002biwd3ak7z4jrq","tag_id":"cjbrwpvji002aiwd3hht5b7pc","_id":"cjqz21s9t0001t8s3tr8fyrx1"},{"post_id":"cjbrwpvji002biwd3ak7z4jrq","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjqz21s9u0002t8s3uoshn1ap"},{"post_id":"cjbrwpvji002biwd3ak7z4jrq","tag_id":"cjbrwpvmk004ciwd3um2auy0r","_id":"cjqz21s9u0004t8s3zekn7vvl"},{"post_id":"cjbrwpvji002biwd3ak7z4jrq","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjqz21s9v0006t8s3ty404l43"},{"post_id":"cjbrwpvji002biwd3ak7z4jrq","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjqz21s9v0007t8s3b5r2l54o"},{"post_id":"cjgqbs5xg00006gs3o2wn0xbp","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjt4n3jzs00003cs38ht97nu4"},{"post_id":"cjgqbs5xg00006gs3o2wn0xbp","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjt4n3jzs00013cs3hcuu24k6"},{"post_id":"cjgqbs5xg00006gs3o2wn0xbp","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjt4n3jzt00023cs3utbkpe9m"},{"post_id":"cjgqbs5xg00006gs3o2wn0xbp","tag_id":"cjgqbs5y100026gs35y0p0hxz","_id":"cjt4n3jzt00043cs37mq2tn0j"},{"post_id":"cjgqbs5xg00006gs3o2wn0xbp","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjt4n3jzt00063cs3pbtd5emz"},{"post_id":"cjgqbs5xg00006gs3o2wn0xbp","tag_id":"cjbrwpvmk004ciwd3um2auy0r","_id":"cjt4n3jzu00073cs3kf1g2y40"},{"post_id":"cjt76ams30000kwtmpxmblysb","tag_id":"cjbrwpvmk0046iwd3jgv16jo3","_id":"cjt76amsc0003kwtmjjc4egf8"},{"post_id":"cjt76ams30000kwtmpxmblysb","tag_id":"cjmhujiay0000h0s3ght60x8t","_id":"cjt76amsc0005kwtm9xpo63ba"},{"post_id":"cjt76ams30000kwtmpxmblysb","tag_id":"cjbrwpvf6000eiwd3cq18xpoc","_id":"cjt76amsd0006kwtm0s9isos7"},{"post_id":"cjt76ams30000kwtmpxmblysb","tag_id":"cjt76ams70001kwtmac39bmlv","_id":"cjt76amsd0007kwtmepwfdqki"},{"post_id":"cjt76ams30000kwtmpxmblysb","tag_id":"cjbrwpvgh000ziwd30n9o8ljl","_id":"cjt76amsd0008kwtmadwn4kas"},{"post_id":"cjt76ams30000kwtmpxmblysb","tag_id":"cjbrwpvmk004ciwd3um2auy0r","_id":"cjt76amsd0009kwtmvx8ks2fg"}],"Tag":[{"name":"Bootstrap","_id":"cjbrwpveq0006iwd3mx0r73ql"},{"name":"Angular2","_id":"cjbrwpvf6000eiwd3cq18xpoc"},{"name":"DI","_id":"cjbrwpvgh000tiwd3v94qv1ae"},{"name":"Tutorial","_id":"cjbrwpvgh000ziwd30n9o8ljl"},{"name":"http","_id":"cjbrwpvi7001kiwd37pepzyjm"},{"name":"Forms","_id":"cjbrwpvin001xiwd3qzmu2hgu"},{"name":"CLI","_id":"cjbrwpvji002aiwd3hht5b7pc"},{"name":"MongoDB","_id":"cjbrwpvke002tiwd3671s8s4y"},{"name":"NodeJS","_id":"cjbrwpvkt002ziwd3mp9aadnw"},{"name":"AngularJS","_id":"cjbrwpvl90039iwd3zsvjskmp"},{"name":"FrontEnd","_id":"cjbrwpvlo003liwd3bl4ttnek"},{"name":"BackEnd","_id":"cjbrwpvm4003uiwd31niwz9d0"},{"name":"TypeScript","_id":"cjbrwpvm40040iwd3ek0w7quz"},{"name":"SPA","_id":"cjbrwpvm40043iwd3lq55emn8"},{"name":"Angular","_id":"cjbrwpvmk0046iwd3jgv16jo3"},{"name":"Angular5","_id":"cjbrwpvmk0049iwd3gsdmo61n"},{"name":"Introduccin","_id":"cjbrwpvmk004ciwd3um2auy0r"},{"name":"observables","_id":"cjbrwpvmz004siwd38nko48yj"},{"name":"Angular6","_id":"cjgqbs5xv00016gs3o8sy742m"},{"name":"reactiveForms","_id":"cjgqbs5y100026gs35y0p0hxz"},{"name":"Routing","_id":"cjl7utvls0000lgs32ph7r4uf"},{"name":"Components","_id":"cjlqqecc80000iws3armzxwx0"},{"name":"Servicios","_id":"cjlw6ugnv0000zws3apbpvacv"},{"name":"Observables","_id":"cjm1sd6de0000ogs3co52ib1p"},{"name":"RxJS","_id":"cjm903ao6000084s3lmp87cky"},{"name":"Avanzado","_id":"cjmajgd990000sks3fot53xan"},{"name":"Angular7","_id":"cjmhujiay0000h0s3ght60x8t"},{"name":"ChangeDetection","_id":"cjmkd6hsi0001rks3zeughe6i"},{"name":"Redux","_id":"cjmup7ouw0001ags3yr5qdluz"},{"name":"NgRx","_id":"cjmup7ov90002ags36zfa68e1"},{"name":"PWA","_id":"cjn31401x000crks3d1ad609n"},{"name":"Universal","_id":"cjnpve3do0001h0s36p65dyfe"},{"name":"SSR","_id":"cjnpve3ed0002h0s32ktcij83"},{"name":"material","_id":"cjt76ams70001kwtmac39bmlv"}]}}